{
  "version": 3,
  "sources": ["../node_modules/object-assign/index.js", "../node_modules/react/cjs/react.production.min.js", "../node_modules/react/index.js", "../node_modules/react-dom/node_modules/scheduler/cjs/scheduler.production.min.js", "../node_modules/react-dom/node_modules/scheduler/index.js", "../node_modules/react-dom/cjs/react-dom.production.min.js", "../node_modules/react-dom/index.js", "../node_modules/react/cjs/react-jsx-runtime.production.min.js", "../node_modules/react/jsx-runtime.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/ISurveyInfo.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IActivityListener.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/ISurvey.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/ISurveyComponent.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IEcsAdapter.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IFloodgateSettingIdMap.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IFloodgateStorageProvider.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IFloodgateStringProvider.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IMultipleChoiceComponent.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IPrompt.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/INlqsSurvey.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/INpsSurvey.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/ICVSurvey.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IDynamicUxClient.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IGovernanceServiceClient.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/Ecs/IModels.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/index.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/ISurveyEvent.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Campaign/UxSchema/IUxSchema.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Campaign/UxSchema/IQuestion.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Campaign/UxSchema/IBranchingRules.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Campaign/UxSchema/IUxSchemaAdditionalCapabilities.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Campaign/UxSchema/Validation/SurveyRestrictions.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Campaign/UxSchema/index.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Governance/CampaignDefinitions.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Governance/GovernedChannel.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/DynamicUx/IDynamicUxCommonInitOptions.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/DynamicUx/IFloodgateHostPlatform.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/DynamicUx/AlignmentType.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/DynamicUx/ISurveyCSSParams.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/src/Core/Petrol/ManifestType.js", "../node_modules/@ms-ofb/floodgate-shared-typings/dist/index.js", "../node_modules/synctasks/dist/SyncTasks.js", "../node_modules/subscribableevent/dist-cjs/SubscribableEvent.js", "../node_modules/@skype/ecsclient/dist/AllowBackgroundFetchData.js", "../node_modules/@skype/ecsclient/dist/AppActiveData.js", "../node_modules/@skype/ecsclient/dist/Models.js", "../node_modules/@skype/ecsclient/dist/Cache.js", "../node_modules/@skype/ecsclient/dist/Config.js", "../node_modules/simplerestclients/dist/utils.js", "../node_modules/simplerestclients/dist/ExponentialTime.js", "../node_modules/simplerestclients/dist/SimpleWebRequest.js", "../node_modules/simplerestclients/dist/GenericRestClient.js", "../node_modules/simplerestclients/dist/SimpleRestClients.js", "../node_modules/simplerestclients/index.js", "../node_modules/@skype/ecsclient/dist/TelemetryEventBase.js", "../node_modules/@skype/ecsclient/dist/TelemetryEvents.js", "../node_modules/@skype/ecsclient/dist/RestClient.js", "../node_modules/@skype/ecsclient/dist/Scheduler.js", "../node_modules/@skype/ecsclient/dist/SkypeTokenData.js", "../node_modules/@skype/ecsclient/dist/TelemetryManager.js", "../node_modules/@skype/ecsclient/dist/EcsClient.js", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/Utils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/Constants.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/TelemetryLogger.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/UserFact/src/UserFact/UserFact.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/UserFact/src/UserFact/UserFactHelper.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Campaign/src/Campaign/CampaignDefinitionProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/SurveyStatCollection.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/SurveyStatCollectionActivation.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/StateProviderHelpers.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/GovernedChannelStateProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/SurveyStatCollectionEventActivity.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/GovernanceUtils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/ActivityTrackingContract.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Campaign/src/Campaign/CampaignStateProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/ActivityTrackingData.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/ActivityTrackingSet.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/SurveyEvents.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/SurveyMetadata.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/Survey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/SurveyDataSource.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/DialogSurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/SurveyComponents/src/SurveyComponents/CommentComponent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/SurveyComponents/src/SurveyComponents/CVSurveyComponent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/SurveyComponents/src/SurveyComponents/MultipleChoiceComponent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/SurveyComponents/src/SurveyComponents/PromptComponent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/SurveyComponents/src/SurveyComponents/RatingComponent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/FpsSurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/GenericMessagingSurfaceSurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/SurveyComponents/src/SurveyComponents/InterceptComponent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/InterceptSurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/NlqsSurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Surveys/src/Surveys/NpsSurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Campaign/src/Campaign/CampaignSurveyFactory.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/FeatureGateProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Campaign/src/Campaign/CampaignManager.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/FloodgateSettings.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/ActivityTracker.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/IndexedTracker.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/SurveyActivityListener.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/Transport/src/Transport/HttpTransport.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/FloodgateSurveyCdn/src/FloodgateSurveyCdn/FloodgateSurveyCdnClient.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/OrchestrationEngine/src/OrchestrationEngine/Api.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/GovernedChannel.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/Governor.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/OrchestrationEngine/src/OrchestrationEngine/OrchestrationEngine.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/src/src/FloodgateEngine.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/node_modules/@ms-ofb/officefloodgatecore/dist/index.ts", "../node_modules/gatecrash/dist/types.js", "../node_modules/gatecrash/src/constants.ts", "../node_modules/gatecrash/src/Util.ts", "../node_modules/gatecrash/src/SurveyEmbed.ts", "../node_modules/gatecrash/src/SurveyStyleManager.ts", "../node_modules/gatecrash/src/CVSurvey.ts", "../node_modules/gatecrash/src/index.ts", "../node_modules/es6-promise/dist/config/versionTemplate.txt", "../node_modules/es6-promise/dist/lib/es6-promise/utils.js", "../node_modules/es6-promise/dist/lib/es6-promise/asap.js", "../node_modules/es6-promise/dist/lib/es6-promise/then.js", "../node_modules/es6-promise/dist/lib/es6-promise/promise/resolve.js", "../node_modules/es6-promise/dist/lib/es6-promise/-internal.js", "../node_modules/es6-promise/dist/lib/es6-promise/enumerator.js", "../node_modules/es6-promise/dist/lib/es6-promise/promise/all.js", "../node_modules/es6-promise/dist/lib/es6-promise/promise/race.js", "../node_modules/es6-promise/dist/lib/es6-promise/promise/reject.js", "../node_modules/es6-promise/dist/lib/es6-promise/promise.js", "../node_modules/es6-promise/dist/lib/es6-promise/polyfill.js", "../node_modules/es6-promise/dist/lib/es6-promise.js", "../node_modules/es6-promise/auto.js", "../node_modules/@ms/centro-hvc-loader/package.json", "../src/index.jsx", "../src/App.jsx", "../packages/core/src/constants.ts", "../node_modules/@emotion/hash/dist/emotion-hash.esm.js", "../packages/core/src/runtime/utils/hashSequence.ts", "../packages/core/src/runtime/reduceToClassNameForSlots.ts", "../packages/core/src/mergeClasses.ts", "../packages/core/src/runtime/utils/normalizeCSSBucketEntry.ts", "../packages/core/src/renderer/createIsomorphicStyleSheet.ts", "../packages/core/src/renderer/getStyleSheetForBucket.ts", "../packages/core/src/renderer/safeInsertRule.ts", "../packages/core/src/renderer/createDOMRenderer.ts", "../packages/core/src/insertionFactory.ts", "../packages/core/src/__styles.ts", "../packages/react/src/RendererContext.tsx", "../packages/react/src/TextDirectionContext.tsx", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/createCSSRuleFromTheme.js", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/FluentProvider.js", "../node_modules/@fluentui/react-utilities/lib/compose/slot.js", "../node_modules/@fluentui/react-utilities/lib/compose/constants.js", "../node_modules/@fluentui/react-utilities/lib/compose/isSlot.js", "../node_modules/@fluentui/react-utilities/lib/compose/getIntrinsicElementProps.js", "../node_modules/@fluentui/react-utilities/lib/utils/getNativeElementProps.js", "../node_modules/@fluentui/react-utilities/lib/utils/properties.js", "../node_modules/@fluentui/react-shared-contexts/lib/ThemeContext/ThemeContext.js", "../node_modules/@fluentui/react-shared-contexts/lib/ThemeClassNameContext/ThemeClassNameContext.js", "../node_modules/@fluentui/react-shared-contexts/lib/TooltipVisibilityContext/TooltipContext.js", "../node_modules/@fluentui/react-shared-contexts/lib/ProviderContext/ProviderContext.js", "../node_modules/@fluentui/react-shared-contexts/lib/OverridesContext/OverridesContext.js", "../node_modules/@fluentui/react-shared-contexts/lib/CustomStyleHooksContext/CustomStyleHooksContext.js", "../node_modules/@fluentui/react-utilities/lib/hooks/useIsomorphicLayoutEffect.js", "../node_modules/@fluentui/react-utilities/lib/ssr/canUseDOM.js", "../node_modules/@fluentui/react-utilities/lib/ssr/SSRContext.js", "../node_modules/@fluentui/react-utilities/lib/hooks/useId.js", "../node_modules/@fluentui/react-utilities/lib/hooks/useMergedRefs.js", "../node_modules/@fluentui/react-utilities/lib/utils/isHTMLElement.js", "../node_modules/@fluentui/react-jsx-runtime/lib/jsx/createJSX.js", "../node_modules/@fluentui/react-jsx-runtime/lib/utils/createCompatSlotComponent.js", "../node_modules/@fluentui/react-jsx-runtime/lib/jsx/jsxSlot.js", "../node_modules/@fluentui/react-jsx-runtime/lib/utils/getMetadataFromSlotComponent.js", "../node_modules/@fluentui/react-jsx-runtime/lib/utils/Runtime.js", "../node_modules/@fluentui/react-jsx-runtime/lib/jsx/jsxsSlot.js", "../node_modules/@fluentui/react-jsx-runtime/lib/jsx-runtime.js", "../node_modules/@fluentui/react-icons/lib/contexts/IconDirectionContext.js", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/renderFluentProvider.js", "../node_modules/keyborg/src/WeakRefInstance.ts", "../node_modules/keyborg/src/FocusEvent.ts", "../node_modules/keyborg/src/Keyborg.ts", "../node_modules/keyborg/src/index.ts", "../node_modules/@fluentui/react-tabster/lib/hooks/useFocusVisible.js", "../node_modules/@fluentui/react-tabster/lib/focus/constants.js", "../node_modules/@fluentui/react-tabster/lib/focus/focusVisiblePolyfill.js", "../node_modules/@fluentui/tokens/lib/global/colors.js", "../node_modules/@fluentui/tokens/lib/global/colorPalette.js", "../node_modules/@fluentui/tokens/lib/sharedColorNames.js", "../node_modules/@fluentui/tokens/lib/statusColorMapping.js", "../node_modules/@fluentui/tokens/lib/alias/lightColorPalette.js", "../node_modules/@fluentui/tokens/lib/alias/lightColor.js", "../node_modules/@fluentui/tokens/lib/global/borderRadius.js", "../node_modules/@fluentui/tokens/lib/global/curves.js", "../node_modules/@fluentui/tokens/lib/global/durations.js", "../node_modules/@fluentui/tokens/lib/global/fonts.js", "../node_modules/@fluentui/tokens/lib/global/spacings.js", "../node_modules/@fluentui/tokens/lib/global/strokeWidths.js", "../node_modules/@fluentui/tokens/lib/utils/shadows.js", "../node_modules/@fluentui/tokens/lib/utils/createLightTheme.js", "../node_modules/@fluentui/tokens/lib/global/brandColors.js", "../node_modules/@fluentui/tokens/lib/themes/web/lightTheme.js", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/useFluentProvider.js", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/useFluentProviderThemeStyleTag.js", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/useFluentProviderStyles.styles.js", "../node_modules/@fluentui/react-provider/lib/components/FluentProvider/useFluentProviderContextValues.js", "../src/providers/FloodgateProvider.jsx", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Window/scripts/app/Window/Window.ts", "../node_modules/@microsoft/oteljs/src/DataFieldHelper.ts", "../node_modules/@microsoft/oteljs/src/Contracts.ts", "../node_modules/tslib/tslib.es6.mjs", "../node_modules/@microsoft/oteljs/src/OTelNotifications.ts", "../node_modules/@microsoft/oteljs/src/TenantTokenManager.ts", "../node_modules/@microsoft/oteljs/src/TelemetryEventValidator.ts", "../node_modules/@microsoft/oteljs/src/Version.ts", "../node_modules/@microsoft/oteljs/src/SimpleTelemetryLogger.ts", "../node_modules/@microsoft/oteljs/src/Activity.ts", "../node_modules/@microsoft/oteljs/src/CorrelationVector.ts", "../node_modules/@microsoft/oteljs/src/InternalContracts.ts", "../node_modules/@microsoft/oteljs/src/TelemetryLogger.ts", "../node_modules/@microsoft/oteljs-1ds/src/DataModels.ts", "../node_modules/@microsoft/applicationinsights-shims/src/Constants.ts", "../node_modules/@microsoft/applicationinsights-shims/src/Helpers.ts", "../node_modules/@microsoft/applicationinsights-shims/src/TsLibShims.ts", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/__DynamicConstants.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/InternalConstants.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/HelperFuncs.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK.Enums/EnumHelperFuncs.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK.Enums/EventsDiscardedReason.js", "../node_modules/@microsoft/dynamicproto-js/lib/out/lib/src/DynamicProto.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/EnvUtils.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/DbgExtensionUtils.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/DiagnosticLogger.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/PerfManager.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/RandomHelper.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/DataCacheHelper.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/CookieMgr.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/EventHelpers.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/CoreUtils.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/W3cTraceParent.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/TelemetryHelpers.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/ProcessTelemetryContext.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/ChannelController.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/UnloadHandlerContainer.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/BaseTelemetryPlugin.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/TelemetryInitializerPlugin.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/BaseCore.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/NotificationManager.js", "../node_modules/@microsoft/applicationinsights-core-js/dist-esm/JavaScriptSDK/AppInsightsCore.js", "../node_modules/@microsoft/1ds-core-js/dist-esm/src/InternalConstants.js", "../node_modules/@microsoft/1ds-core-js/dist-esm/src/Utils.js", "../node_modules/@microsoft/1ds-core-js/dist-esm/src/AppInsightsCore.js", "../node_modules/@microsoft/oteljs-1ds/src/InternalUtils.ts", "../node_modules/@microsoft/oteljs-1ds/src/OneDSHelper.ts", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/DataModels.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/InternalConstants.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/EventBatch.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/ClockSkewManager.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/KillSwitch.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/RetryPolicy.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/Serializer.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/HttpManager.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/TimeoutOverrideWrapper.js", "../node_modules/@microsoft/1ds-post-js/dist-esm/src/PostChannel.js", "../node_modules/@microsoft/oteljs-1ds/src/PerfManager.ts", "../node_modules/@microsoft/oteljs-1ds/src/ApplicationInsights.ts", "../node_modules/@microsoft/oteljs-1ds/src/OneDSSink.ts", "../src/logging/TelemetrySinkProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedback-ext-dynamic-campaign/src/lib/EcsClient.ts", "../node_modules/@ms-ofb/officebrowserfeedback-ext-dynamic-campaign/src/lib/Utils.ts", "../node_modules/@ms-ofb/officebrowserfeedback-ext-dynamic-campaign/src/lib/StorageProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedback-ext-dynamic-campaign/dist/esm/package.json", "../node_modules/@ms-ofb/officebrowserfeedback-ext-dynamic-campaign/src/lib/DefaultConfig.ts", "../node_modules/@ms-ofb/officebrowserfeedback-ext-dynamic-campaign/src/lib/TelemetryEvents.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/App_Floodgate.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Polyfills/scripts/app/Polyfills/Promise.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Logging/Logger.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Configuration/Configuration.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Common/Settings.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Utils/Window.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Utils/Storage.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Utils/Caching.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Facts/Constants.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Facts/UserFactManifest.ts", "../node_modules/whatwg-fetch/fetch.js", "../node_modules/@ms-ofb/officepersonalization/dist/src/Utils/Utils.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Utils/Transport.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Common/ContentType.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Facts/CachedUserFacts.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Facts/UserFactsClient.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Facts/UserFacts.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Common/Init.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/Constants.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/Localization.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/Utils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Configuration/scripts/app/Configuration/IInitOptions.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Configuration/scripts/app/Configuration/Configuration.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/FeatureGateProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/FloodgateStorageProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Logging/scripts/app/Logging/Logging.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Configuration/DynamicConfiguration.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Logging/Telemetry/scripts/app/Logging/Telemetry/Contracts.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Logging/Telemetry/scripts/app/Logging/Telemetry/OtelTelemetryLogger.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Logging/Telemetry/scripts/app/Logging/Telemetry/TelemetryLoggerFactory.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Logging/scripts/app/Logging/Constants.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Configuration/scripts/app/Configuration/ReadCacheOverrides.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/TargetedMessaging/scripts/app/TargetedMessaging/PersonalizationLogger.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/DynamicUx/scripts/app/UI/DynamicUx/CentroConstants.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/scripts/app/UI/UiConstants.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/Version.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/CommonApp.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/GovernanceService/scripts/app/GovernanceService/GovernanceServiceClient.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/DynamicContent/scripts/app/DynamicContent/DynamicContentTransport.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Personalizer/scripts/app/Personalizer/PersonalizerClient.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/CommonFloodgate.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/AdaptiveSurveyLauncherFactory.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/GenericMessagingLauncherFactory.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Utils/UrlUtils.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/TargetedMessaging/TargetedMessagingConstants.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/Common/ContentResponse.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/TargetedMessaging/TargetedMessagingClient.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/TargetedMessaging/scripts/app/TargetedMessaging/AssetsProvider.ts", "../node_modules/dompurify/src/utils.ts", "../node_modules/dompurify/src/tags.ts", "../node_modules/dompurify/src/attrs.ts", "../node_modules/dompurify/src/regexp.ts", "../node_modules/dompurify/src/purify.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Window/scripts/app/Window/TrustedTypesPolicyUtils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Window/scripts/app/Window/DomUtils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/RudeSurveyLauncherFactory.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/DynamicUx/scripts/app/UI/DynamicUx/DynamicUxClient.ts", "../node_modules/@ms/centro-hvc-loader/dist/runtime/data/requestFunction.types.js", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/scripts/app/UI/Utils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/DynamicUx/scripts/app/UI/DynamicUx/CentroCoreDataSource.ts", "../node_modules/@ms/centro-hvc-loader/dist/runtime/logging/log.types.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/logging/broadcastLogger.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/bootstrap/scriptLoader.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/configuration/runtimeDataSources.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/routing/history.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/logging/loggingUtils.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/logging/macKustoLogger.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/public/utils/uuid.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/bootstrap/trustedTypesPolicy.js", "../node_modules/@ms/centro-hvc-loader/dist/hvc-loader/foreignEnvLoader.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/configuration/staticDataSource.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/configuration/dataSources.js", "../node_modules/@ms/centro-hvc-loader/dist/runtime/bootstrap/adapter.types.js", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/DynamicUx/scripts/app/UI/DynamicUx/CentroLoaderWrapper.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/DynamicUx/scripts/app/UI/DynamicUx/CentroLogger.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/DynamicUx/scripts/app/UI/DynamicUx/CentroThemeDataSource.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/UISurvey/scripts/app/FloodgateCore/UISurvey/UISurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/FloodgateEnvironmentProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UIStrings/scripts/app/UIStrings/UIStrings.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/FloodgateStringProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Transport/scripts/app/Transport/Petrol.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Transport/Files/scripts/app/Transport/Files/Screenshot.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Transport/Files/scripts/app/Transport/Files/Manifest.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Transport/scripts/app/Transport/Transport.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/TransporterFactory.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/TargetedMessaging/scripts/app/TargetedMessaging/TargetedMessagingCampaignDefinitionProvider.ts", "../node_modules/@ms-ofb/officepersonalization/dist/src/TargetedMessaging/LocalUserFactHelper.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/TargetedMessaging/scripts/app/TargetedMessaging/UserFactsProvider.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/TargetedMessaging/scripts/app/TargetedMessaging/ProcessTelemetryEvent.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/TargetedMessaging/scripts/app/TargetedMessaging/SendUserFact.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/Theme.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/scripts/app/CommonUI.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/Logging/scripts/app/Logging/utils.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/scripts/app/FloodgateCore/FloodgateTelemetryLogger.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/UISurvey/scripts/app/FloodgateCore/UISurvey/CustomUISurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/FloodgateCore/UISurvey/scripts/app/FloodgateCore/UISurvey/DummyUISurvey.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/Toast/scripts/app/UI/Toast/CVToast.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/Toast/scripts/app/UI/Toast/Events.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/scripts/app/UI/SpinnerControl.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/Toast/scripts/app/UI/Toast/Layout.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/scripts/app/UI/ChoiceGroupControl.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/scripts/app/UI/Renderer.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/scripts/app/UI/Toast/scripts/app/UI/Toast/Toast.ts", "../node_modules/@ms-ofb/officebrowserfeedbacknpm/Floodgate.ts", "../src/utils/app-constants.js", "../src/sdk/officeBrowserFeedbackSetup.ts", "../src/freemarker-variables.ts", "../src/components/FloodgateTrigger.jsx"],
  "sourcesContent": ["/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n", "/** @license React v17.0.2\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=require(\"object-assign\"),n=60103,p=60106;exports.Fragment=60107;exports.StrictMode=60108;exports.Profiler=60114;var q=60109,r=60110,t=60112;exports.Suspense=60113;var u=60115,v=60116;\nif(\"function\"===typeof Symbol&&Symbol.for){var w=Symbol.for;n=w(\"react.element\");p=w(\"react.portal\");exports.Fragment=w(\"react.fragment\");exports.StrictMode=w(\"react.strict_mode\");exports.Profiler=w(\"react.profiler\");q=w(\"react.provider\");r=w(\"react.context\");t=w(\"react.forward_ref\");exports.Suspense=w(\"react.suspense\");u=w(\"react.memo\");v=w(\"react.lazy\")}var x=\"function\"===typeof Symbol&&Symbol.iterator;\nfunction y(a){if(null===a||\"object\"!==typeof a)return null;a=x&&a[x]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}function z(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}\nvar A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B={};function C(a,b,c){this.props=a;this.context=b;this.refs=B;this.updater=c||A}C.prototype.isReactComponent={};C.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(z(85));this.updater.enqueueSetState(this,a,b,\"setState\")};C.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};\nfunction D(){}D.prototype=C.prototype;function E(a,b,c){this.props=a;this.context=b;this.refs=B;this.updater=c||A}var F=E.prototype=new D;F.constructor=E;l(F,C.prototype);F.isPureReactComponent=!0;var G={current:null},H=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};\nfunction J(a,b,c){var e,d={},k=null,h=null;if(null!=b)for(e in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)H.call(b,e)&&!I.hasOwnProperty(e)&&(d[e]=b[e]);var g=arguments.length-2;if(1===g)d.children=c;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];d.children=f}if(a&&a.defaultProps)for(e in g=a.defaultProps,g)void 0===d[e]&&(d[e]=g[e]);return{$$typeof:n,type:a,key:k,ref:h,props:d,_owner:G.current}}\nfunction K(a,b){return{$$typeof:n,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function L(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===n}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var M=/\\/+/g;function N(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction O(a,b,c,e,d){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case n:case p:h=!0}}if(h)return h=a,d=d(h),a=\"\"===e?\".\"+N(h,0):e,Array.isArray(d)?(c=\"\",null!=a&&(c=a.replace(M,\"$&/\")+\"/\"),O(d,b,c,\"\",function(a){return a})):null!=d&&(L(d)&&(d=K(d,c+(!d.key||h&&h.key===d.key?\"\":(\"\"+d.key).replace(M,\"$&/\")+\"/\")+a)),b.push(d)),1;h=0;e=\"\"===e?\".\":e+\":\";if(Array.isArray(a))for(var g=\n0;g<a.length;g++){k=a[g];var f=e+N(k,g);h+=O(k,b,c,f,d)}else if(f=y(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=e+N(k,g++),h+=O(k,b,c,f,d);else if(\"object\"===k)throw b=\"\"+a,Error(z(31,\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b));return h}function P(a,b,c){if(null==a)return a;var e=[],d=0;O(a,e,\"\",\"\",function(a){return b.call(c,a,d++)});return e}\nfunction Q(a){if(-1===a._status){var b=a._result;b=b();a._status=0;a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}if(1===a._status)return a._result;throw a._result;}var R={current:null};function S(){var a=R.current;if(null===a)throw Error(z(321));return a}var T={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:G,IsSomeRendererActing:{current:!1},assign:l};\nexports.Children={map:P,forEach:function(a,b,c){P(a,function(){b.apply(this,arguments)},c)},count:function(a){var b=0;P(a,function(){b++});return b},toArray:function(a){return P(a,function(a){return a})||[]},only:function(a){if(!L(a))throw Error(z(143));return a}};exports.Component=C;exports.PureComponent=E;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T;\nexports.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(z(267,a));var e=l({},a.props),d=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=G.current);void 0!==b.key&&(d=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)H.call(b,f)&&!I.hasOwnProperty(f)&&(e[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)e.children=c;else if(1<f){g=Array(f);for(var m=0;m<f;m++)g[m]=arguments[m+2];e.children=g}return{$$typeof:n,type:a.type,\nkey:d,ref:k,props:e,_owner:h}};exports.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:r,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:q,_context:a};return a.Consumer=a};exports.createElement=J;exports.createFactory=function(a){var b=J.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};exports.forwardRef=function(a){return{$$typeof:t,render:a}};exports.isValidElement=L;\nexports.lazy=function(a){return{$$typeof:v,_payload:{_status:-1,_result:a},_init:Q}};exports.memo=function(a,b){return{$$typeof:u,type:a,compare:void 0===b?null:b}};exports.useCallback=function(a,b){return S().useCallback(a,b)};exports.useContext=function(a,b){return S().useContext(a,b)};exports.useDebugValue=function(){};exports.useEffect=function(a,b){return S().useEffect(a,b)};exports.useImperativeHandle=function(a,b,c){return S().useImperativeHandle(a,b,c)};\nexports.useLayoutEffect=function(a,b){return S().useLayoutEffect(a,b)};exports.useMemo=function(a,b){return S().useMemo(a,b)};exports.useReducer=function(a,b,c){return S().useReducer(a,b,c)};exports.useRef=function(a){return S().useRef(a)};exports.useState=function(a){return S().useState(a)};exports.version=\"17.0.2\";\n", "'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n", "/** @license React v0.20.2\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f,g,h,k;if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}\nif(\"undefined\"===typeof window||\"function\"!==typeof MessageChannel){var t=null,u=null,w=function(){if(null!==t)try{var a=exports.unstable_now();t(!0,a);t=null}catch(b){throw setTimeout(w,0),b;}};f=function(a){null!==t?setTimeout(f,0,a):(t=a,setTimeout(w,0))};g=function(a,b){u=setTimeout(a,b)};h=function(){clearTimeout(u)};exports.unstable_shouldYield=function(){return!1};k=exports.unstable_forceFrameRate=function(){}}else{var x=window.setTimeout,y=window.clearTimeout;if(\"undefined\"!==typeof console){var z=\nwindow.cancelAnimationFrame;\"function\"!==typeof window.requestAnimationFrame&&console.error(\"This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills\");\"function\"!==typeof z&&console.error(\"This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills\")}var A=!1,B=null,C=-1,D=5,E=0;exports.unstable_shouldYield=function(){return exports.unstable_now()>=\nE};k=function(){};exports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):D=0<a?Math.floor(1E3/a):5};var F=new MessageChannel,G=F.port2;F.port1.onmessage=function(){if(null!==B){var a=exports.unstable_now();E=a+D;try{B(!0,a)?G.postMessage(null):(A=!1,B=null)}catch(b){throw G.postMessage(null),b;}}else A=!1};f=function(a){B=a;A||(A=!0,G.postMessage(null))};g=function(a,b){C=\nx(function(){a(exports.unstable_now())},b)};h=function(){y(C);C=-1}}function H(a,b){var c=a.length;a.push(b);a:for(;;){var d=c-1>>>1,e=a[d];if(void 0!==e&&0<I(e,b))a[d]=b,a[c]=e,c=d;else break a}}function J(a){a=a[0];return void 0===a?null:a}\nfunction K(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length;d<e;){var m=2*(d+1)-1,n=a[m],v=m+1,r=a[v];if(void 0!==n&&0>I(n,c))void 0!==r&&0>I(r,n)?(a[d]=r,a[v]=c,d=v):(a[d]=n,a[m]=c,d=m);else if(void 0!==r&&0>I(r,c))a[d]=r,a[v]=c,d=v;else break a}}return b}return null}function I(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}var L=[],M=[],N=1,O=null,P=3,Q=!1,R=!1,S=!1;\nfunction T(a){for(var b=J(M);null!==b;){if(null===b.callback)K(M);else if(b.startTime<=a)K(M),b.sortIndex=b.expirationTime,H(L,b);else break;b=J(M)}}function U(a){S=!1;T(a);if(!R)if(null!==J(L))R=!0,f(V);else{var b=J(M);null!==b&&g(U,b.startTime-a)}}\nfunction V(a,b){R=!1;S&&(S=!1,h());Q=!0;var c=P;try{T(b);for(O=J(L);null!==O&&(!(O.expirationTime>b)||a&&!exports.unstable_shouldYield());){var d=O.callback;if(\"function\"===typeof d){O.callback=null;P=O.priorityLevel;var e=d(O.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?O.callback=e:O===J(L)&&K(L);T(b)}else K(L);O=J(L)}if(null!==O)var m=!0;else{var n=J(M);null!==n&&g(U,n.startTime-b);m=!1}return m}finally{O=null,P=c,Q=!1}}var W=k;exports.unstable_IdlePriority=5;\nexports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){R||Q||(R=!0,f(V))};exports.unstable_getCurrentPriorityLevel=function(){return P};exports.unstable_getFirstCallbackNode=function(){return J(L)};\nexports.unstable_next=function(a){switch(P){case 1:case 2:case 3:var b=3;break;default:b=P}var c=P;P=b;try{return a()}finally{P=c}};exports.unstable_pauseExecution=function(){};exports.unstable_requestPaint=W;exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=P;P=a;try{return b()}finally{P=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:N++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,H(M,a),null===J(L)&&a===J(M)&&(S?h():S=!0,g(U,c-d))):(a.sortIndex=e,H(L,a),R||Q||(R=!0,f(V)));return a};\nexports.unstable_wrapCallback=function(a){var b=P;return function(){var c=P;P=b;try{return a.apply(this,arguments)}finally{P=c}}};\n", "'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n", "/** @license React v17.0.2\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),m=require(\"object-assign\"),r=require(\"scheduler\");function y(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}if(!aa)throw Error(y(227));var ba=new Set,ca={};function da(a,b){ea(a,b);ea(a+\"Capture\",b)}\nfunction ea(a,b){ca[a]=b;for(a=0;a<b.length;a++)ba.add(b[a])}\nvar fa=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),ha=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,ia=Object.prototype.hasOwnProperty,\nja={},ka={};function la(a){if(ia.call(ka,a))return!0;if(ia.call(ja,a))return!1;if(ha.test(a))return ka[a]=!0;ja[a]=!0;return!1}function ma(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction na(a,b,c,d){if(null===b||\"undefined\"===typeof b||ma(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function B(a,b,c,d,e,f,g){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f;this.removeEmptyString=g}var D={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){D[a]=new B(a,0,!1,a,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];D[b]=new B(b,1,!1,a[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){D[a]=new B(a,2,!1,a.toLowerCase(),null,!1,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){D[a]=new B(a,2,!1,a,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){D[a]=new B(a,3,!1,a.toLowerCase(),null,!1,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){D[a]=new B(a,3,!0,a,null,!1,!1)});[\"capture\",\"download\"].forEach(function(a){D[a]=new B(a,4,!1,a,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){D[a]=new B(a,6,!1,a,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(a){D[a]=new B(a,5,!1,a.toLowerCase(),null,!1,!1)});var oa=/[\\-:]([a-z])/g;function pa(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(oa,\npa);D[b]=new B(b,1,!1,a,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(oa,pa);D[b]=new B(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(oa,pa);D[b]=new B(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){D[a]=new B(a,1,!1,a.toLowerCase(),null,!1,!1)});\nD.xlinkHref=new B(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){D[a]=new B(a,1,!1,a.toLowerCase(),null,!0,!0)});\nfunction qa(a,b,c,d){var e=D.hasOwnProperty(b)?D[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1]?!1:!0;f||(na(b,c,e,d)&&(c=null),d||null===e?la(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}\nvar ra=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sa=60103,ta=60106,ua=60107,wa=60108,xa=60114,ya=60109,za=60110,Aa=60112,Ba=60113,Ca=60120,Da=60115,Ea=60116,Fa=60121,Ga=60128,Ha=60129,Ia=60130,Ja=60131;\nif(\"function\"===typeof Symbol&&Symbol.for){var E=Symbol.for;sa=E(\"react.element\");ta=E(\"react.portal\");ua=E(\"react.fragment\");wa=E(\"react.strict_mode\");xa=E(\"react.profiler\");ya=E(\"react.provider\");za=E(\"react.context\");Aa=E(\"react.forward_ref\");Ba=E(\"react.suspense\");Ca=E(\"react.suspense_list\");Da=E(\"react.memo\");Ea=E(\"react.lazy\");Fa=E(\"react.block\");E(\"react.scope\");Ga=E(\"react.opaque.id\");Ha=E(\"react.debug_trace_mode\");Ia=E(\"react.offscreen\");Ja=E(\"react.legacy_hidden\")}\nvar Ka=\"function\"===typeof Symbol&&Symbol.iterator;function La(a){if(null===a||\"object\"!==typeof a)return null;a=Ka&&a[Ka]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}var Ma;function Na(a){if(void 0===Ma)try{throw Error();}catch(c){var b=c.stack.trim().match(/\\n( *(at )?)/);Ma=b&&b[1]||\"\"}return\"\\n\"+Ma+a}var Oa=!1;\nfunction Pa(a,b){if(!a||Oa)return\"\";Oa=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error();},Object.defineProperty(b.prototype,\"props\",{set:function(){throw Error();}}),\"object\"===typeof Reflect&&Reflect.construct){try{Reflect.construct(b,[])}catch(k){var d=k}Reflect.construct(a,[],b)}else{try{b.call()}catch(k){d=k}a.call(b.prototype)}else{try{throw Error();}catch(k){d=k}a()}}catch(k){if(k&&d&&\"string\"===typeof k.stack){for(var e=k.stack.split(\"\\n\"),\nf=d.stack.split(\"\\n\"),g=e.length-1,h=f.length-1;1<=g&&0<=h&&e[g]!==f[h];)h--;for(;1<=g&&0<=h;g--,h--)if(e[g]!==f[h]){if(1!==g||1!==h){do if(g--,h--,0>h||e[g]!==f[h])return\"\\n\"+e[g].replace(\" at new \",\" at \");while(1<=g&&0<=h)}break}}}finally{Oa=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:\"\")?Na(a):\"\"}\nfunction Qa(a){switch(a.tag){case 5:return Na(a.type);case 16:return Na(\"Lazy\");case 13:return Na(\"Suspense\");case 19:return Na(\"SuspenseList\");case 0:case 2:case 15:return a=Pa(a.type,!1),a;case 11:return a=Pa(a.type.render,!1),a;case 22:return a=Pa(a.type._render,!1),a;case 1:return a=Pa(a.type,!0),a;default:return\"\"}}\nfunction Ra(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ua:return\"Fragment\";case ta:return\"Portal\";case xa:return\"Profiler\";case wa:return\"StrictMode\";case Ba:return\"Suspense\";case Ca:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case za:return(a.displayName||\"Context\")+\".Consumer\";case ya:return(a._context.displayName||\"Context\")+\".Provider\";case Aa:var b=a.render;b=b.displayName||b.name||\"\";\nreturn a.displayName||(\"\"!==b?\"ForwardRef(\"+b+\")\":\"ForwardRef\");case Da:return Ra(a.type);case Fa:return Ra(a._render);case Ea:b=a._payload;a=a._init;try{return Ra(a(b))}catch(c){}}return null}function Sa(a){switch(typeof a){case \"boolean\":case \"number\":case \"object\":case \"string\":case \"undefined\":return a;default:return\"\"}}function Ta(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ua(a){var b=Ta(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Ta(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Xa(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}\nfunction Ya(a,b){var c=b.checked;return m({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Za(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Sa(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function $a(a,b){b=b.checked;null!=b&&qa(a,\"checked\",b,!1)}\nfunction ab(a,b){$a(a,b);var c=Sa(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?bb(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&bb(a,b.type,Sa(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction cb(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction bb(a,b,c){if(\"number\"!==b||Xa(a.ownerDocument)!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}function db(a){var b=\"\";aa.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function eb(a,b){a=m({children:void 0},b);if(b=db(b.children))a.children=b;return a}\nfunction fb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+Sa(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction gb(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(y(91));return m({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function hb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(y(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(y(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:Sa(c)}}\nfunction ib(a,b){var c=Sa(b.value),d=Sa(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function jb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}var kb={html:\"http://www.w3.org/1999/xhtml\",mathml:\"http://www.w3.org/1998/Math/MathML\",svg:\"http://www.w3.org/2000/svg\"};\nfunction lb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function mb(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?lb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar nb,ob=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(a.namespaceURI!==kb.svg||\"innerHTML\"in a)a.innerHTML=b;else{nb=nb||document.createElement(\"div\");nb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=nb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction pb(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar qb={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,\nfloodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rb=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(qb).forEach(function(a){rb.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);qb[b]=qb[a]})});function sb(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||qb.hasOwnProperty(a)&&qb[a]?(\"\"+b).trim():b+\"px\"}\nfunction tb(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=sb(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var ub=m({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction vb(a,b){if(b){if(ub[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(y(137,a));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(y(60));if(!(\"object\"===typeof b.dangerouslySetInnerHTML&&\"__html\"in b.dangerouslySetInnerHTML))throw Error(y(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(y(62));}}\nfunction wb(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}function xb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}var yb=null,zb=null,Ab=null;\nfunction Bb(a){if(a=Cb(a)){if(\"function\"!==typeof yb)throw Error(y(280));var b=a.stateNode;b&&(b=Db(b),yb(a.stateNode,a.type,b))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,b=Ab;Ab=zb=null;Bb(a);if(b)for(a=0;a<b.length;a++)Bb(b[a])}}function Gb(a,b){return a(b)}function Hb(a,b,c,d,e){return a(b,c,d,e)}function Ib(){}var Jb=Gb,Kb=!1,Lb=!1;function Mb(){if(null!==zb||null!==Ab)Ib(),Fb()}\nfunction Nb(a,b,c){if(Lb)return a(b,c);Lb=!0;try{return Jb(a,b,c)}finally{Lb=!1,Mb()}}\nfunction Ob(a,b){var c=a.stateNode;if(null===c)return null;var d=Db(c);if(null===d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==\ntypeof c)throw Error(y(231,b,typeof c));return c}var Pb=!1;if(fa)try{var Qb={};Object.defineProperty(Qb,\"passive\",{get:function(){Pb=!0}});window.addEventListener(\"test\",Qb,Qb);window.removeEventListener(\"test\",Qb,Qb)}catch(a){Pb=!1}function Rb(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(n){this.onError(n)}}var Sb=!1,Tb=null,Ub=!1,Vb=null,Wb={onError:function(a){Sb=!0;Tb=a}};function Xb(a,b,c,d,e,f,g,h,k){Sb=!1;Tb=null;Rb.apply(Wb,arguments)}\nfunction Yb(a,b,c,d,e,f,g,h,k){Xb.apply(this,arguments);if(Sb){if(Sb){var l=Tb;Sb=!1;Tb=null}else throw Error(y(198));Ub||(Ub=!0,Vb=l)}}function Zb(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.flags&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function $b(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function ac(a){if(Zb(a)!==a)throw Error(y(188));}\nfunction bc(a){var b=a.alternate;if(!b){b=Zb(a);if(null===b)throw Error(y(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return ac(e),a;if(f===d)return ac(e),b;f=f.sibling}throw Error(y(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(y(189));}}if(c.alternate!==d)throw Error(y(190));}if(3!==c.tag)throw Error(y(188));return c.stateNode.current===c?a:b}function cc(a){a=bc(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}\nfunction dc(a,b){for(var c=a.alternate;null!==b;){if(b===a||b===c)return!0;b=b.return}return!1}var ec,fc,gc,hc,ic=!1,jc=[],kc=null,lc=null,mc=null,nc=new Map,oc=new Map,pc=[],qc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");\nfunction rc(a,b,c,d,e){return{blockedOn:a,domEventName:b,eventSystemFlags:c|16,nativeEvent:e,targetContainers:[d]}}function sc(a,b){switch(a){case \"focusin\":case \"focusout\":kc=null;break;case \"dragenter\":case \"dragleave\":lc=null;break;case \"mouseover\":case \"mouseout\":mc=null;break;case \"pointerover\":case \"pointerout\":nc.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":oc.delete(b.pointerId)}}\nfunction tc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=rc(b,c,d,e,f),null!==b&&(b=Cb(b),null!==b&&fc(b)),a;a.eventSystemFlags|=d;b=a.targetContainers;null!==e&&-1===b.indexOf(e)&&b.push(e);return a}\nfunction uc(a,b,c,d,e){switch(b){case \"focusin\":return kc=tc(kc,a,b,c,d,e),!0;case \"dragenter\":return lc=tc(lc,a,b,c,d,e),!0;case \"mouseover\":return mc=tc(mc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;nc.set(f,tc(nc.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,oc.set(f,tc(oc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction vc(a){var b=wc(a.target);if(null!==b){var c=Zb(b);if(null!==c)if(b=c.tag,13===b){if(b=$b(c),null!==b){a.blockedOn=b;hc(a.lanePriority,function(){r.unstable_runWithPriority(a.priority,function(){gc(c)})});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}\nfunction xc(a){if(null!==a.blockedOn)return!1;for(var b=a.targetContainers;0<b.length;){var c=yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null!==c)return b=Cb(c),null!==b&&fc(b),a.blockedOn=c,!1;b.shift()}return!0}function zc(a,b,c){xc(a)&&c.delete(b)}\nfunction Ac(){for(ic=!1;0<jc.length;){var a=jc[0];if(null!==a.blockedOn){a=Cb(a.blockedOn);null!==a&&ec(a);break}for(var b=a.targetContainers;0<b.length;){var c=yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null!==c){a.blockedOn=c;break}b.shift()}null===a.blockedOn&&jc.shift()}null!==kc&&xc(kc)&&(kc=null);null!==lc&&xc(lc)&&(lc=null);null!==mc&&xc(mc)&&(mc=null);nc.forEach(zc);oc.forEach(zc)}\nfunction Bc(a,b){a.blockedOn===b&&(a.blockedOn=null,ic||(ic=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ac)))}\nfunction Cc(a){function b(b){return Bc(b,a)}if(0<jc.length){Bc(jc[0],a);for(var c=1;c<jc.length;c++){var d=jc[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==kc&&Bc(kc,a);null!==lc&&Bc(lc,a);null!==mc&&Bc(mc,a);nc.forEach(b);oc.forEach(b);for(c=0;c<pc.length;c++)d=pc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<pc.length&&(c=pc[0],null===c.blockedOn);)vc(c),null===c.blockedOn&&pc.shift()}\nfunction Dc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var Ec={animationend:Dc(\"Animation\",\"AnimationEnd\"),animationiteration:Dc(\"Animation\",\"AnimationIteration\"),animationstart:Dc(\"Animation\",\"AnimationStart\"),transitionend:Dc(\"Transition\",\"TransitionEnd\")},Fc={},Gc={};\nfa&&(Gc=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete Ec.animationend.animation,delete Ec.animationiteration.animation,delete Ec.animationstart.animation),\"TransitionEvent\"in window||delete Ec.transitionend.transition);function Hc(a){if(Fc[a])return Fc[a];if(!Ec[a])return a;var b=Ec[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Gc)return Fc[a]=b[c];return a}\nvar Ic=Hc(\"animationend\"),Jc=Hc(\"animationiteration\"),Kc=Hc(\"animationstart\"),Lc=Hc(\"transitionend\"),Mc=new Map,Nc=new Map,Oc=[\"abort\",\"abort\",Ic,\"animationEnd\",Jc,\"animationIteration\",Kc,\"animationStart\",\"canplay\",\"canPlay\",\"canplaythrough\",\"canPlayThrough\",\"durationchange\",\"durationChange\",\"emptied\",\"emptied\",\"encrypted\",\"encrypted\",\"ended\",\"ended\",\"error\",\"error\",\"gotpointercapture\",\"gotPointerCapture\",\"load\",\"load\",\"loadeddata\",\"loadedData\",\"loadedmetadata\",\"loadedMetadata\",\"loadstart\",\"loadStart\",\n\"lostpointercapture\",\"lostPointerCapture\",\"playing\",\"playing\",\"progress\",\"progress\",\"seeking\",\"seeking\",\"stalled\",\"stalled\",\"suspend\",\"suspend\",\"timeupdate\",\"timeUpdate\",Lc,\"transitionEnd\",\"waiting\",\"waiting\"];function Pc(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1];e=\"on\"+(e[0].toUpperCase()+e.slice(1));Nc.set(d,b);Mc.set(d,e);da(e,[d])}}var Qc=r.unstable_now;Qc();var F=8;\nfunction Rc(a){if(0!==(1&a))return F=15,1;if(0!==(2&a))return F=14,2;if(0!==(4&a))return F=13,4;var b=24&a;if(0!==b)return F=12,b;if(0!==(a&32))return F=11,32;b=192&a;if(0!==b)return F=10,b;if(0!==(a&256))return F=9,256;b=3584&a;if(0!==b)return F=8,b;if(0!==(a&4096))return F=7,4096;b=4186112&a;if(0!==b)return F=6,b;b=62914560&a;if(0!==b)return F=5,b;if(a&67108864)return F=4,67108864;if(0!==(a&134217728))return F=3,134217728;b=805306368&a;if(0!==b)return F=2,b;if(0!==(1073741824&a))return F=1,1073741824;\nF=8;return a}function Sc(a){switch(a){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}function Tc(a){switch(a){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(y(358,a));}}\nfunction Uc(a,b){var c=a.pendingLanes;if(0===c)return F=0;var d=0,e=0,f=a.expiredLanes,g=a.suspendedLanes,h=a.pingedLanes;if(0!==f)d=f,e=F=15;else if(f=c&134217727,0!==f){var k=f&~g;0!==k?(d=Rc(k),e=F):(h&=f,0!==h&&(d=Rc(h),e=F))}else f=c&~g,0!==f?(d=Rc(f),e=F):0!==h&&(d=Rc(h),e=F);if(0===d)return 0;d=31-Vc(d);d=c&((0>d?0:1<<d)<<1)-1;if(0!==b&&b!==d&&0===(b&g)){Rc(b);if(e<=F)return b;F=e}b=a.entangledLanes;if(0!==b)for(a=a.entanglements,b&=d;0<b;)c=31-Vc(b),e=1<<c,d|=a[c],b&=~e;return d}\nfunction Wc(a){a=a.pendingLanes&-1073741825;return 0!==a?a:a&1073741824?1073741824:0}function Xc(a,b){switch(a){case 15:return 1;case 14:return 2;case 12:return a=Yc(24&~b),0===a?Xc(10,b):a;case 10:return a=Yc(192&~b),0===a?Xc(8,b):a;case 8:return a=Yc(3584&~b),0===a&&(a=Yc(4186112&~b),0===a&&(a=512)),a;case 2:return b=Yc(805306368&~b),0===b&&(b=268435456),b}throw Error(y(358,a));}function Yc(a){return a&-a}function Zc(a){for(var b=[],c=0;31>c;c++)b.push(a);return b}\nfunction $c(a,b,c){a.pendingLanes|=b;var d=b-1;a.suspendedLanes&=d;a.pingedLanes&=d;a=a.eventTimes;b=31-Vc(b);a[b]=c}var Vc=Math.clz32?Math.clz32:ad,bd=Math.log,cd=Math.LN2;function ad(a){return 0===a?32:31-(bd(a)/cd|0)|0}var dd=r.unstable_UserBlockingPriority,ed=r.unstable_runWithPriority,fd=!0;function gd(a,b,c,d){Kb||Ib();var e=hd,f=Kb;Kb=!0;try{Hb(e,a,b,c,d)}finally{(Kb=f)||Mb()}}function id(a,b,c,d){ed(dd,hd.bind(null,a,b,c,d))}\nfunction hd(a,b,c,d){if(fd){var e;if((e=0===(b&4))&&0<jc.length&&-1<qc.indexOf(a))a=rc(null,a,b,c,d),jc.push(a);else{var f=yc(a,b,c,d);if(null===f)e&&sc(a,d);else{if(e){if(-1<qc.indexOf(a)){a=rc(f,a,b,c,d);jc.push(a);return}if(uc(f,a,b,c,d))return;sc(a,d)}jd(a,b,d,null,c)}}}}\nfunction yc(a,b,c,d){var e=xb(d);e=wc(e);if(null!==e){var f=Zb(e);if(null===f)e=null;else{var g=f.tag;if(13===g){e=$b(f);if(null!==e)return e;e=null}else if(3===g){if(f.stateNode.hydrate)return 3===f.tag?f.stateNode.containerInfo:null;e=null}else f!==e&&(e=null)}}jd(a,b,d,e,c);return null}var kd=null,ld=null,md=null;\nfunction nd(){if(md)return md;var a,b=ld,c=b.length,d,e=\"value\"in kd?kd.value:kd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return md=e.slice(a,1<d?1-d:void 0)}function od(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function pd(){return!0}function qd(){return!1}\nfunction rd(a){function b(b,d,e,f,g){this._reactName=b;this._targetInst=e;this.type=d;this.nativeEvent=f;this.target=g;this.currentTarget=null;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b?b(f):f[c]);this.isDefaultPrevented=(null!=f.defaultPrevented?f.defaultPrevented:!1===f.returnValue)?pd:qd;this.isPropagationStopped=qd;return this}m(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&\n(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd});return b}\nvar sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=m({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=m({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return void 0===a.relatedTarget?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){if(\"movementX\"in\na)return a.movementX;a!==yd&&(yd&&\"mousemove\"===a.type?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a);return wd},movementY:function(a){return\"movementY\"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=m({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=m({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=m({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=m({},sd,{clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=m({},sd,{data:0}),Ld=rd(Kd),Md={Esc:\"Escape\",\nSpacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Nd={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",\n119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Od={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Od[a])?!!b[a]:!1}function zd(){return Pd}\nvar Qd=m({},ud,{key:function(a){if(a.key){var b=Md[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=od(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Nd[a.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return\"keypress\"===a.type?od(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===\na.type?od(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Rd=rd(Qd),Sd=m({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=m({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=m({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=m({},Ad,{deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in a?-a.wheelDeltaX:0},\ndeltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=fa&&\"CompositionEvent\"in window,be=null;fa&&\"documentMode\"in document&&(be=document.documentMode);var ce=fa&&\"TextEvent\"in window&&!be,de=fa&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;\nfunction ge(a,b){switch(a){case \"keyup\":return-1!==$d.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"focusout\":return!0;default:return!1}}function he(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var ie=!1;function je(a,b){switch(a){case \"compositionend\":return he(b);case \"keypress\":if(32!==b.which)return null;fe=!0;return ee;case \"textInput\":return a=b.data,a===ee&&fe?null:a;default:return null}}\nfunction ke(a,b){if(ie)return\"compositionend\"===a||!ae&&ge(a,b)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return de&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar le={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!le[a.type]:\"textarea\"===b?!0:!1}function ne(a,b,c,d){Eb(d);b=oe(b,\"onChange\");0<b.length&&(c=new td(\"onChange\",\"change\",null,c,d),a.push({event:c,listeners:b}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var b=ue(a);if(Wa(b))return a}\nfunction ve(a,b){if(\"change\"===a)return b}var we=!1;if(fa){var xe;if(fa){var ye=\"oninput\"in document;if(!ye){var ze=document.createElement(\"div\");ze.setAttribute(\"oninput\",\"return;\");ye=\"function\"===typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent(\"onpropertychange\",Be),qe=pe=null)}function Be(a){if(\"value\"===a.propertyName&&te(qe)){var b=[];ne(b,qe,a,xb(a));a=re;if(Kb)a(b);else{Kb=!0;try{Gb(a,b)}finally{Kb=!1,Mb()}}}}\nfunction Ce(a,b,c){\"focusin\"===a?(Ae(),pe=b,qe=c,pe.attachEvent(\"onpropertychange\",Be)):\"focusout\"===a&&Ae()}function De(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return te(qe)}function Ee(a,b){if(\"click\"===a)return te(b)}function Fe(a,b){if(\"input\"===a||\"change\"===a)return te(b)}function Ge(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var He=\"function\"===typeof Object.is?Object.is:Ge,Ie=Object.prototype.hasOwnProperty;\nfunction Je(a,b){if(He(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!Ie.call(b,c[d])||!He(a[c[d]],b[c[d]]))return!1;return!0}function Ke(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Le(a,b){var c=Ke(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Ke(c)}}function Me(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Me(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Ne(){for(var a=window,b=Xa();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Xa(a.document)}return b}function Oe(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nvar Pe=fa&&\"documentMode\"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;\nfunction Ue(a,b,c){var d=c.window===c?c.document:9===c.nodeType?c:c.ownerDocument;Te||null==Qe||Qe!==Xa(d)||(d=Qe,\"selectionStart\"in d&&Oe(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Je(Se,d)||(Se=d,d=oe(Re,\"onSelect\"),0<d.length&&(b=new td(\"onSelect\",\"select\",null,b,c),a.push({event:b,listeners:d}),b.target=Qe)))}\nPc(\"cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange\".split(\" \"),\n0);Pc(\"drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel\".split(\" \"),1);Pc(Oc,2);for(var Ve=\"change selectionchange textInput compositionstart compositionend compositionupdate\".split(\" \"),We=0;We<Ve.length;We++)Nc.set(Ve[We],0);ea(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);\nea(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);ea(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);ea(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);da(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));da(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));da(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);da(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));\nda(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));da(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var Xe=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),Ye=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(Xe));\nfunction Ze(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=c;Yb(d,b,void 0,a);a.currentTarget=null}\nfunction se(a,b){b=0!==(b&4);for(var c=0;c<a.length;c++){var d=a[c],e=d.event;d=d.listeners;a:{var f=void 0;if(b)for(var g=d.length-1;0<=g;g--){var h=d[g],k=h.instance,l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;Ze(e,h,l);f=k}else for(g=0;g<d.length;g++){h=d[g];k=h.instance;l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;Ze(e,h,l);f=k}}}if(Ub)throw a=Vb,Ub=!1,Vb=null,a;}\nfunction G(a,b){var c=$e(b),d=a+\"__bubble\";c.has(d)||(af(b,a,2,!1),c.add(d))}var bf=\"_reactListening\"+Math.random().toString(36).slice(2);function cf(a){a[bf]||(a[bf]=!0,ba.forEach(function(b){Ye.has(b)||df(b,!1,a,null);df(b,!0,a,null)}))}\nfunction df(a,b,c,d){var e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,f=c;\"selectionchange\"===a&&9!==c.nodeType&&(f=c.ownerDocument);if(null!==d&&!b&&Ye.has(a)){if(\"scroll\"!==a)return;e|=2;f=d}var g=$e(f),h=a+\"__\"+(b?\"capture\":\"bubble\");g.has(h)||(b&&(e|=4),af(f,a,e,b),g.add(h))}\nfunction af(a,b,c,d){var e=Nc.get(b);switch(void 0===e?2:e){case 0:e=gd;break;case 1:e=id;break;default:e=hd}c=e.bind(null,b,c,a);e=void 0;!Pb||\"touchstart\"!==b&&\"touchmove\"!==b&&\"wheel\"!==b||(e=!0);d?void 0!==e?a.addEventListener(b,c,{capture:!0,passive:e}):a.addEventListener(b,c,!0):void 0!==e?a.addEventListener(b,c,{passive:e}):a.addEventListener(b,c,!1)}\nfunction jd(a,b,c,d,e){var f=d;if(0===(b&1)&&0===(b&2)&&null!==d)a:for(;;){if(null===d)return;var g=d.tag;if(3===g||4===g){var h=d.stateNode.containerInfo;if(h===e||8===h.nodeType&&h.parentNode===e)break;if(4===g)for(g=d.return;null!==g;){var k=g.tag;if(3===k||4===k)if(k=g.stateNode.containerInfo,k===e||8===k.nodeType&&k.parentNode===e)return;g=g.return}for(;null!==h;){g=wc(h);if(null===g)return;k=g.tag;if(5===k||6===k){d=f=g;continue a}h=h.parentNode}}d=d.return}Nb(function(){var d=f,e=xb(c),g=[];\na:{var h=Mc.get(a);if(void 0!==h){var k=td,x=a;switch(a){case \"keypress\":if(0===od(c))break a;case \"keydown\":case \"keyup\":k=Rd;break;case \"focusin\":x=\"focus\";k=Fd;break;case \"focusout\":x=\"blur\";k=Fd;break;case \"beforeblur\":case \"afterblur\":k=Fd;break;case \"click\":if(2===c.button)break a;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":k=Bd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":k=\nDd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":k=Vd;break;case Ic:case Jc:case Kc:k=Hd;break;case Lc:k=Xd;break;case \"scroll\":k=vd;break;case \"wheel\":k=Zd;break;case \"copy\":case \"cut\":case \"paste\":k=Jd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":k=Td}var w=0!==(b&4),z=!w&&\"scroll\"===a,u=w?null!==h?h+\"Capture\":null:h;w=[];for(var t=d,q;null!==\nt;){q=t;var v=q.stateNode;5===q.tag&&null!==v&&(q=v,null!==u&&(v=Ob(t,u),null!=v&&w.push(ef(t,v,q))));if(z)break;t=t.return}0<w.length&&(h=new k(h,x,null,c,e),g.push({event:h,listeners:w}))}}if(0===(b&7)){a:{h=\"mouseover\"===a||\"pointerover\"===a;k=\"mouseout\"===a||\"pointerout\"===a;if(h&&0===(b&16)&&(x=c.relatedTarget||c.fromElement)&&(wc(x)||x[ff]))break a;if(k||h){h=e.window===e?e:(h=e.ownerDocument)?h.defaultView||h.parentWindow:window;if(k){if(x=c.relatedTarget||c.toElement,k=d,x=x?wc(x):null,null!==\nx&&(z=Zb(x),x!==z||5!==x.tag&&6!==x.tag))x=null}else k=null,x=d;if(k!==x){w=Bd;v=\"onMouseLeave\";u=\"onMouseEnter\";t=\"mouse\";if(\"pointerout\"===a||\"pointerover\"===a)w=Td,v=\"onPointerLeave\",u=\"onPointerEnter\",t=\"pointer\";z=null==k?h:ue(k);q=null==x?h:ue(x);h=new w(v,t+\"leave\",k,c,e);h.target=z;h.relatedTarget=q;v=null;wc(e)===d&&(w=new w(u,t+\"enter\",x,c,e),w.target=q,w.relatedTarget=z,v=w);z=v;if(k&&x)b:{w=k;u=x;t=0;for(q=w;q;q=gf(q))t++;q=0;for(v=u;v;v=gf(v))q++;for(;0<t-q;)w=gf(w),t--;for(;0<q-t;)u=\ngf(u),q--;for(;t--;){if(w===u||null!==u&&w===u.alternate)break b;w=gf(w);u=gf(u)}w=null}else w=null;null!==k&&hf(g,h,k,w,!1);null!==x&&null!==z&&hf(g,z,x,w,!0)}}}a:{h=d?ue(d):window;k=h.nodeName&&h.nodeName.toLowerCase();if(\"select\"===k||\"input\"===k&&\"file\"===h.type)var J=ve;else if(me(h))if(we)J=Fe;else{J=De;var K=Ce}else(k=h.nodeName)&&\"input\"===k.toLowerCase()&&(\"checkbox\"===h.type||\"radio\"===h.type)&&(J=Ee);if(J&&(J=J(a,d))){ne(g,J,c,e);break a}K&&K(a,h,d);\"focusout\"===a&&(K=h._wrapperState)&&\nK.controlled&&\"number\"===h.type&&bb(h,\"number\",h.value)}K=d?ue(d):window;switch(a){case \"focusin\":if(me(K)||\"true\"===K.contentEditable)Qe=K,Re=d,Se=null;break;case \"focusout\":Se=Re=Qe=null;break;case \"mousedown\":Te=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":Te=!1;Ue(g,c,e);break;case \"selectionchange\":if(Pe)break;case \"keydown\":case \"keyup\":Ue(g,c,e)}var Q;if(ae)b:{switch(a){case \"compositionstart\":var L=\"onCompositionStart\";break b;case \"compositionend\":L=\"onCompositionEnd\";break b;\ncase \"compositionupdate\":L=\"onCompositionUpdate\";break b}L=void 0}else ie?ge(a,c)&&(L=\"onCompositionEnd\"):\"keydown\"===a&&229===c.keyCode&&(L=\"onCompositionStart\");L&&(de&&\"ko\"!==c.locale&&(ie||\"onCompositionStart\"!==L?\"onCompositionEnd\"===L&&ie&&(Q=nd()):(kd=e,ld=\"value\"in kd?kd.value:kd.textContent,ie=!0)),K=oe(d,L),0<K.length&&(L=new Ld(L,a,null,c,e),g.push({event:L,listeners:K}),Q?L.data=Q:(Q=he(c),null!==Q&&(L.data=Q))));if(Q=ce?je(a,c):ke(a,c))d=oe(d,\"onBeforeInput\"),0<d.length&&(e=new Ld(\"onBeforeInput\",\n\"beforeinput\",null,c,e),g.push({event:e,listeners:d}),e.data=Q)}se(g,b)})}function ef(a,b,c){return{instance:a,listener:b,currentTarget:c}}function oe(a,b){for(var c=b+\"Capture\",d=[];null!==a;){var e=a,f=e.stateNode;5===e.tag&&null!==f&&(e=f,f=Ob(a,c),null!=f&&d.unshift(ef(a,f,e)),f=Ob(a,b),null!=f&&d.push(ef(a,f,e)));a=a.return}return d}function gf(a){if(null===a)return null;do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction hf(a,b,c,d,e){for(var f=b._reactName,g=[];null!==c&&c!==d;){var h=c,k=h.alternate,l=h.stateNode;if(null!==k&&k===d)break;5===h.tag&&null!==l&&(h=l,e?(k=Ob(c,f),null!=k&&g.unshift(ef(c,k,h))):e||(k=Ob(c,f),null!=k&&g.push(ef(c,k,h))));c=c.return}0!==g.length&&a.push({event:b,listeners:g})}function jf(){}var kf=null,lf=null;function mf(a,b){switch(a){case \"button\":case \"input\":case \"select\":case \"textarea\":return!!b.autoFocus}return!1}\nfunction nf(a,b){return\"textarea\"===a||\"option\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}var of=\"function\"===typeof setTimeout?setTimeout:void 0,pf=\"function\"===typeof clearTimeout?clearTimeout:void 0;function qf(a){1===a.nodeType?a.textContent=\"\":9===a.nodeType&&(a=a.body,null!=a&&(a.textContent=\"\"))}\nfunction rf(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function sf(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(\"$\"===c||\"$!\"===c||\"$?\"===c){if(0===b)return a;b--}else\"/$\"===c&&b++}a=a.previousSibling}return null}var tf=0;function uf(a){return{$$typeof:Ga,toString:a,valueOf:a}}var vf=Math.random().toString(36).slice(2),wf=\"__reactFiber$\"+vf,xf=\"__reactProps$\"+vf,ff=\"__reactContainer$\"+vf,yf=\"__reactEvents$\"+vf;\nfunction wc(a){var b=a[wf];if(b)return b;for(var c=a.parentNode;c;){if(b=c[ff]||c[wf]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=sf(a);null!==a;){if(c=a[wf])return c;a=sf(a)}return b}a=c;c=a.parentNode}return null}function Cb(a){a=a[wf]||a[ff];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function ue(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(y(33));}function Db(a){return a[xf]||null}\nfunction $e(a){var b=a[yf];void 0===b&&(b=a[yf]=new Set);return b}var zf=[],Af=-1;function Bf(a){return{current:a}}function H(a){0>Af||(a.current=zf[Af],zf[Af]=null,Af--)}function I(a,b){Af++;zf[Af]=a.current;a.current=b}var Cf={},M=Bf(Cf),N=Bf(!1),Df=Cf;\nfunction Ef(a,b){var c=a.type.contextTypes;if(!c)return Cf;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function Ff(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Gf(){H(N);H(M)}function Hf(a,b,c){if(M.current!==Cf)throw Error(y(168));I(M,b);I(N,c)}\nfunction If(a,b,c){var d=a.stateNode;a=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(y(108,Ra(b)||\"Unknown\",e));return m({},c,d)}function Jf(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Cf;Df=M.current;I(M,a);I(N,N.current);return!0}function Kf(a,b,c){var d=a.stateNode;if(!d)throw Error(y(169));c?(a=If(a,b,Df),d.__reactInternalMemoizedMergedChildContext=a,H(N),H(M),I(M,a)):H(N);I(N,c)}\nvar Lf=null,Mf=null,Nf=r.unstable_runWithPriority,Of=r.unstable_scheduleCallback,Pf=r.unstable_cancelCallback,Qf=r.unstable_shouldYield,Rf=r.unstable_requestPaint,Sf=r.unstable_now,Tf=r.unstable_getCurrentPriorityLevel,Uf=r.unstable_ImmediatePriority,Vf=r.unstable_UserBlockingPriority,Wf=r.unstable_NormalPriority,Xf=r.unstable_LowPriority,Yf=r.unstable_IdlePriority,Zf={},$f=void 0!==Rf?Rf:function(){},ag=null,bg=null,cg=!1,dg=Sf(),O=1E4>dg?Sf:function(){return Sf()-dg};\nfunction eg(){switch(Tf()){case Uf:return 99;case Vf:return 98;case Wf:return 97;case Xf:return 96;case Yf:return 95;default:throw Error(y(332));}}function fg(a){switch(a){case 99:return Uf;case 98:return Vf;case 97:return Wf;case 96:return Xf;case 95:return Yf;default:throw Error(y(332));}}function gg(a,b){a=fg(a);return Nf(a,b)}function hg(a,b,c){a=fg(a);return Of(a,b,c)}function ig(){if(null!==bg){var a=bg;bg=null;Pf(a)}jg()}\nfunction jg(){if(!cg&&null!==ag){cg=!0;var a=0;try{var b=ag;gg(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});ag=null}catch(c){throw null!==ag&&(ag=ag.slice(a+1)),Of(Uf,ig),c;}finally{cg=!1}}}var kg=ra.ReactCurrentBatchConfig;function lg(a,b){if(a&&a.defaultProps){b=m({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c]);return b}return b}var mg=Bf(null),ng=null,og=null,pg=null;function qg(){pg=og=ng=null}\nfunction rg(a){var b=mg.current;H(mg);a.type._context._currentValue=b}function sg(a,b){for(;null!==a;){var c=a.alternate;if((a.childLanes&b)===b)if(null===c||(c.childLanes&b)===b)break;else c.childLanes|=b;else a.childLanes|=b,null!==c&&(c.childLanes|=b);a=a.return}}function tg(a,b){ng=a;pg=og=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(0!==(a.lanes&b)&&(ug=!0),a.firstContext=null)}\nfunction vg(a,b){if(pg!==a&&!1!==b&&0!==b){if(\"number\"!==typeof b||1073741823===b)pg=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===og){if(null===ng)throw Error(y(308));og=b;ng.dependencies={lanes:0,firstContext:b,responders:null}}else og=og.next=b}return a._currentValue}var wg=!1;function xg(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}\nfunction yg(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function zg(a,b){return{eventTime:a,lane:b,tag:0,payload:null,callback:null,next:null}}function Ag(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}\nfunction Bg(a,b){var c=a.updateQueue,d=a.alternate;if(null!==d&&(d=d.updateQueue,c===d)){var e=null,f=null;c=c.firstBaseUpdate;if(null!==c){do{var g={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};null===f?e=f=g:f=f.next=g;c=c.next}while(null!==c);null===f?e=f=b:f=f.next=b}else e=f=b;c={baseState:d.baseState,firstBaseUpdate:e,lastBaseUpdate:f,shared:d.shared,effects:d.effects};a.updateQueue=c;return}a=c.lastBaseUpdate;null===a?c.firstBaseUpdate=b:a.next=\nb;c.lastBaseUpdate=b}\nfunction Cg(a,b,c,d){var e=a.updateQueue;wg=!1;var f=e.firstBaseUpdate,g=e.lastBaseUpdate,h=e.shared.pending;if(null!==h){e.shared.pending=null;var k=h,l=k.next;k.next=null;null===g?f=l:g.next=l;g=k;var n=a.alternate;if(null!==n){n=n.updateQueue;var A=n.lastBaseUpdate;A!==g&&(null===A?n.firstBaseUpdate=l:A.next=l,n.lastBaseUpdate=k)}}if(null!==f){A=e.baseState;g=0;n=l=k=null;do{h=f.lane;var p=f.eventTime;if((d&h)===h){null!==n&&(n=n.next={eventTime:p,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,\nnext:null});a:{var C=a,x=f;h=b;p=c;switch(x.tag){case 1:C=x.payload;if(\"function\"===typeof C){A=C.call(p,A,h);break a}A=C;break a;case 3:C.flags=C.flags&-4097|64;case 0:C=x.payload;h=\"function\"===typeof C?C.call(p,A,h):C;if(null===h||void 0===h)break a;A=m({},A,h);break a;case 2:wg=!0}}null!==f.callback&&(a.flags|=32,h=e.effects,null===h?e.effects=[f]:h.push(f))}else p={eventTime:p,lane:h,tag:f.tag,payload:f.payload,callback:f.callback,next:null},null===n?(l=n=p,k=A):n=n.next=p,g|=h;f=f.next;if(null===\nf)if(h=e.shared.pending,null===h)break;else f=h.next,h.next=null,e.lastBaseUpdate=h,e.shared.pending=null}while(1);null===n&&(k=A);e.baseState=k;e.firstBaseUpdate=l;e.lastBaseUpdate=n;Dg|=g;a.lanes=g;a.memoizedState=A}}function Eg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=c;if(\"function\"!==typeof e)throw Error(y(191,e));e.call(d)}}}var Fg=(new aa.Component).refs;\nfunction Gg(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:m({},b,c);a.memoizedState=c;0===a.lanes&&(a.updateQueue.baseState=c)}\nvar Kg={isMounted:function(a){return(a=a._reactInternals)?Zb(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternals;var d=Hg(),e=Ig(a),f=zg(d,e);f.payload=b;void 0!==c&&null!==c&&(f.callback=c);Ag(a,f);Jg(a,e,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternals;var d=Hg(),e=Ig(a),f=zg(d,e);f.tag=1;f.payload=b;void 0!==c&&null!==c&&(f.callback=c);Ag(a,f);Jg(a,e,d)},enqueueForceUpdate:function(a,b){a=a._reactInternals;var c=Hg(),d=Ig(a),e=zg(c,d);e.tag=2;void 0!==b&&null!==b&&(e.callback=\nb);Ag(a,e);Jg(a,d,c)}};function Lg(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Je(c,d)||!Je(e,f):!0}\nfunction Mg(a,b,c){var d=!1,e=Cf;var f=b.contextType;\"object\"===typeof f&&null!==f?f=vg(f):(e=Ff(b)?Df:M.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Ef(a,e):Cf);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Kg;a.stateNode=b;b._reactInternals=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Ng(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Kg.enqueueReplaceState(b,b.state,null)}\nfunction Og(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=Fg;xg(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=vg(f):(f=Ff(b)?Df:M.current,e.context=Ef(a,f));Cg(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Gg(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||\n(b=e.state,\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Kg.enqueueReplaceState(e,e.state,null),Cg(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.flags|=4)}var Pg=Array.isArray;\nfunction Qg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(y(309));var d=c.stateNode}if(!d)throw Error(y(147,a));var e=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===Fg&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if(\"string\"!==typeof a)throw Error(y(284));if(!c._owner)throw Error(y(290,a));}return a}\nfunction Rg(a,b){if(\"textarea\"!==a.type)throw Error(y(31,\"[object Object]\"===Object.prototype.toString.call(b)?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":b));}\nfunction Sg(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.flags=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Tg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.flags=2,\nc):d;b.flags=2;return c}function g(b){a&&null===b.alternate&&(b.flags=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Ug(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Qg(a,b,c),d.return=a,d;d=Vg(c.type,c.key,c.props,null,a.mode,d);d.ref=Qg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=\nWg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function n(a,b,c,d,f){if(null===b||7!==b.tag)return b=Xg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function A(a,b,c){if(\"string\"===typeof b||\"number\"===typeof b)return b=Ug(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case sa:return c=Vg(b.type,b.key,b.props,null,a.mode,c),c.ref=Qg(a,null,b),c.return=a,c;case ta:return b=Wg(b,a.mode,c),b.return=a,b}if(Pg(b)||La(b))return b=Xg(b,\na.mode,c,null),b.return=a,b;Rg(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case sa:return c.key===e?c.type===ua?n(a,b,c.props.children,d,e):k(a,b,c,d):null;case ta:return c.key===e?l(a,b,c,d):null}if(Pg(c)||La(c))return null!==e?null:n(a,b,c,d,null);Rg(a,c)}return null}function C(a,b,c,d,e){if(\"string\"===typeof d||\"number\"===typeof d)return a=a.get(c)||\nnull,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case sa:return a=a.get(null===d.key?c:d.key)||null,d.type===ua?n(b,a,d.props.children,e,d.key):k(b,a,d,e);case ta:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e)}if(Pg(d)||La(d))return a=a.get(c)||null,n(b,a,d,e,null);Rg(b,d)}return null}function x(e,g,h,k){for(var l=null,t=null,u=g,z=g=0,q=null;null!==u&&z<h.length;z++){u.index>z?(q=u,u=null):q=u.sibling;var n=p(e,u,h[z],k);if(null===n){null===u&&(u=q);break}a&&u&&null===\nn.alternate&&b(e,u);g=f(n,g,z);null===t?l=n:t.sibling=n;t=n;u=q}if(z===h.length)return c(e,u),l;if(null===u){for(;z<h.length;z++)u=A(e,h[z],k),null!==u&&(g=f(u,g,z),null===t?l=u:t.sibling=u,t=u);return l}for(u=d(e,u);z<h.length;z++)q=C(u,e,z,h[z],k),null!==q&&(a&&null!==q.alternate&&u.delete(null===q.key?z:q.key),g=f(q,g,z),null===t?l=q:t.sibling=q,t=q);a&&u.forEach(function(a){return b(e,a)});return l}function w(e,g,h,k){var l=La(h);if(\"function\"!==typeof l)throw Error(y(150));h=l.call(h);if(null==\nh)throw Error(y(151));for(var t=l=null,u=g,z=g=0,q=null,n=h.next();null!==u&&!n.done;z++,n=h.next()){u.index>z?(q=u,u=null):q=u.sibling;var w=p(e,u,n.value,k);if(null===w){null===u&&(u=q);break}a&&u&&null===w.alternate&&b(e,u);g=f(w,g,z);null===t?l=w:t.sibling=w;t=w;u=q}if(n.done)return c(e,u),l;if(null===u){for(;!n.done;z++,n=h.next())n=A(e,n.value,k),null!==n&&(g=f(n,g,z),null===t?l=n:t.sibling=n,t=n);return l}for(u=d(e,u);!n.done;z++,n=h.next())n=C(u,e,z,n.value,k),null!==n&&(a&&null!==n.alternate&&\nu.delete(null===n.key?z:n.key),g=f(n,g,z),null===t?l=n:t.sibling=n,t=n);a&&u.forEach(function(a){return b(e,a)});return l}return function(a,d,f,h){var k=\"object\"===typeof f&&null!==f&&f.type===ua&&null===f.key;k&&(f=f.props.children);var l=\"object\"===typeof f&&null!==f;if(l)switch(f.$$typeof){case sa:a:{l=f.key;for(k=d;null!==k;){if(k.key===l){switch(k.tag){case 7:if(f.type===ua){c(a,k.sibling);d=e(k,f.props.children);d.return=a;a=d;break a}break;default:if(k.elementType===f.type){c(a,k.sibling);\nd=e(k,f.props);d.ref=Qg(a,k,f);d.return=a;a=d;break a}}c(a,k);break}else b(a,k);k=k.sibling}f.type===ua?(d=Xg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Vg(f.type,f.key,f.props,null,a.mode,h),h.ref=Qg(a,d,f),h.return=a,a=h)}return g(a);case ta:a:{for(k=f.key;null!==d;){if(d.key===k)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=\nWg(f,a.mode,h);d.return=a;a=d}return g(a)}if(\"string\"===typeof f||\"number\"===typeof f)return f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=Ug(f,a.mode,h),d.return=a,a=d),g(a);if(Pg(f))return x(a,d,f,h);if(La(f))return w(a,d,f,h);l&&Rg(a,f);if(\"undefined\"===typeof f&&!k)switch(a.tag){case 1:case 22:case 0:case 11:case 15:throw Error(y(152,Ra(a.type)||\"Component\"));}return c(a,d)}}var Yg=Sg(!0),Zg=Sg(!1),$g={},ah=Bf($g),bh=Bf($g),ch=Bf($g);\nfunction dh(a){if(a===$g)throw Error(y(174));return a}function eh(a,b){I(ch,b);I(bh,a);I(ah,$g);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:mb(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=mb(b,a)}H(ah);I(ah,b)}function fh(){H(ah);H(bh);H(ch)}function gh(a){dh(ch.current);var b=dh(ah.current);var c=mb(b,a.type);b!==c&&(I(bh,a),I(ah,c))}function hh(a){bh.current===a&&(H(ah),H(bh))}var P=Bf(0);\nfunction ih(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||\"$?\"===c.data||\"$!\"===c.data))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.flags&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}var jh=null,kh=null,lh=!1;\nfunction mh(a,b){var c=nh(5,null,null,0);c.elementType=\"DELETED\";c.type=\"DELETED\";c.stateNode=b;c.return=a;c.flags=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function oh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}\nfunction ph(a){if(lh){var b=kh;if(b){var c=b;if(!oh(a,b)){b=rf(c.nextSibling);if(!b||!oh(a,b)){a.flags=a.flags&-1025|2;lh=!1;jh=a;return}mh(jh,c)}jh=a;kh=rf(b.firstChild)}else a.flags=a.flags&-1025|2,lh=!1,jh=a}}function qh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;jh=a}\nfunction rh(a){if(a!==jh)return!1;if(!lh)return qh(a),lh=!0,!1;var b=a.type;if(5!==a.tag||\"head\"!==b&&\"body\"!==b&&!nf(b,a.memoizedProps))for(b=kh;b;)mh(a,b),b=rf(b.nextSibling);qh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(y(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(\"/$\"===c){if(0===b){kh=rf(a.nextSibling);break a}b--}else\"$\"!==c&&\"$!\"!==c&&\"$?\"!==c||b++}a=a.nextSibling}kh=null}}else kh=jh?rf(a.stateNode.nextSibling):null;return!0}\nfunction sh(){kh=jh=null;lh=!1}var th=[];function uh(){for(var a=0;a<th.length;a++)th[a]._workInProgressVersionPrimary=null;th.length=0}var vh=ra.ReactCurrentDispatcher,wh=ra.ReactCurrentBatchConfig,xh=0,R=null,S=null,T=null,yh=!1,zh=!1;function Ah(){throw Error(y(321));}function Bh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!He(a[c],b[c]))return!1;return!0}\nfunction Ch(a,b,c,d,e,f){xh=f;R=b;b.memoizedState=null;b.updateQueue=null;b.lanes=0;vh.current=null===a||null===a.memoizedState?Dh:Eh;a=c(d,e);if(zh){f=0;do{zh=!1;if(!(25>f))throw Error(y(301));f+=1;T=S=null;b.updateQueue=null;vh.current=Fh;a=c(d,e)}while(zh)}vh.current=Gh;b=null!==S&&null!==S.next;xh=0;T=S=R=null;yh=!1;if(b)throw Error(y(300));return a}function Hh(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===T?R.memoizedState=T=a:T=T.next=a;return T}\nfunction Ih(){if(null===S){var a=R.alternate;a=null!==a?a.memoizedState:null}else a=S.next;var b=null===T?R.memoizedState:T.next;if(null!==b)T=b,S=a;else{if(null===a)throw Error(y(310));S=a;a={memoizedState:S.memoizedState,baseState:S.baseState,baseQueue:S.baseQueue,queue:S.queue,next:null};null===T?R.memoizedState=T=a:T=T.next=a}return T}function Jh(a,b){return\"function\"===typeof b?b(a):b}\nfunction Kh(a){var b=Ih(),c=b.queue;if(null===c)throw Error(y(311));c.lastRenderedReducer=a;var d=S,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,k=e;do{var l=k.lane;if((xh&l)===l)null!==h&&(h=h.next={lane:0,action:k.action,eagerReducer:k.eagerReducer,eagerState:k.eagerState,next:null}),d=k.eagerReducer===a?k.eagerState:a(d,k.action);else{var n={lane:l,action:k.action,eagerReducer:k.eagerReducer,\neagerState:k.eagerState,next:null};null===h?(g=h=n,f=d):h=h.next=n;R.lanes|=l;Dg|=l}k=k.next}while(null!==k&&k!==e);null===h?f=d:h.next=g;He(d,b.memoizedState)||(ug=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,c.dispatch]}\nfunction Lh(a){var b=Ih(),c=b.queue;if(null===c)throw Error(y(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);He(f,b.memoizedState)||(ug=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}\nfunction Mh(a,b,c){var d=b._getVersion;d=d(b._source);var e=b._workInProgressVersionPrimary;if(null!==e)a=e===d;else if(a=a.mutableReadLanes,a=(xh&a)===a)b._workInProgressVersionPrimary=d,th.push(b);if(a)return c(b._source);th.push(b);throw Error(y(350));}\nfunction Nh(a,b,c,d){var e=U;if(null===e)throw Error(y(349));var f=b._getVersion,g=f(b._source),h=vh.current,k=h.useState(function(){return Mh(e,b,c)}),l=k[1],n=k[0];k=T;var A=a.memoizedState,p=A.refs,C=p.getSnapshot,x=A.source;A=A.subscribe;var w=R;a.memoizedState={refs:p,source:b,subscribe:d};h.useEffect(function(){p.getSnapshot=c;p.setSnapshot=l;var a=f(b._source);if(!He(g,a)){a=c(b._source);He(n,a)||(l(a),a=Ig(w),e.mutableReadLanes|=a&e.pendingLanes);a=e.mutableReadLanes;e.entangledLanes|=a;for(var d=\ne.entanglements,h=a;0<h;){var k=31-Vc(h),v=1<<k;d[k]|=a;h&=~v}}},[c,b,d]);h.useEffect(function(){return d(b._source,function(){var a=p.getSnapshot,c=p.setSnapshot;try{c(a(b._source));var d=Ig(w);e.mutableReadLanes|=d&e.pendingLanes}catch(q){c(function(){throw q;})}})},[b,d]);He(C,c)&&He(x,b)&&He(A,d)||(a={pending:null,dispatch:null,lastRenderedReducer:Jh,lastRenderedState:n},a.dispatch=l=Oh.bind(null,R,a),k.queue=a,k.baseQueue=null,n=Mh(e,b,c),k.memoizedState=k.baseState=n);return n}\nfunction Ph(a,b,c){var d=Ih();return Nh(d,a,b,c)}function Qh(a){var b=Hh();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Jh,lastRenderedState:a};a=a.dispatch=Oh.bind(null,R,a);return[b.memoizedState,a]}\nfunction Rh(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=R.updateQueue;null===b?(b={lastEffect:null},R.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function Sh(a){var b=Hh();a={current:a};return b.memoizedState=a}function Th(){return Ih().memoizedState}function Uh(a,b,c,d){var e=Hh();R.flags|=a;e.memoizedState=Rh(1|b,c,void 0,void 0===d?null:d)}\nfunction Vh(a,b,c,d){var e=Ih();d=void 0===d?null:d;var f=void 0;if(null!==S){var g=S.memoizedState;f=g.destroy;if(null!==d&&Bh(d,g.deps)){Rh(b,c,f,d);return}}R.flags|=a;e.memoizedState=Rh(1|b,c,f,d)}function Wh(a,b){return Uh(516,4,a,b)}function Xh(a,b){return Vh(516,4,a,b)}function Yh(a,b){return Vh(4,2,a,b)}function Zh(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}\nfunction $h(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Vh(4,2,Zh.bind(null,b,a),c)}function ai(){}function bi(a,b){var c=Ih();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Bh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function ci(a,b){var c=Ih();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Bh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}\nfunction di(a,b){var c=eg();gg(98>c?98:c,function(){a(!0)});gg(97<c?97:c,function(){var c=wh.transition;wh.transition=1;try{a(!1),b()}finally{wh.transition=c}})}\nfunction Oh(a,b,c){var d=Hg(),e=Ig(a),f={lane:e,action:c,eagerReducer:null,eagerState:null,next:null},g=b.pending;null===g?f.next=f:(f.next=g.next,g.next=f);b.pending=f;g=a.alternate;if(a===R||null!==g&&g===R)zh=yh=!0;else{if(0===a.lanes&&(null===g||0===g.lanes)&&(g=b.lastRenderedReducer,null!==g))try{var h=b.lastRenderedState,k=g(h,c);f.eagerReducer=g;f.eagerState=k;if(He(k,h))return}catch(l){}finally{}Jg(a,e,d)}}\nvar Gh={readContext:vg,useCallback:Ah,useContext:Ah,useEffect:Ah,useImperativeHandle:Ah,useLayoutEffect:Ah,useMemo:Ah,useReducer:Ah,useRef:Ah,useState:Ah,useDebugValue:Ah,useDeferredValue:Ah,useTransition:Ah,useMutableSource:Ah,useOpaqueIdentifier:Ah,unstable_isNewReconciler:!1},Dh={readContext:vg,useCallback:function(a,b){Hh().memoizedState=[a,void 0===b?null:b];return a},useContext:vg,useEffect:Wh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return Uh(4,2,Zh.bind(null,\nb,a),c)},useLayoutEffect:function(a,b){return Uh(4,2,a,b)},useMemo:function(a,b){var c=Hh();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=Hh();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=Oh.bind(null,R,a);return[d.memoizedState,a]},useRef:Sh,useState:Qh,useDebugValue:ai,useDeferredValue:function(a){var b=Qh(a),c=b[0],d=b[1];Wh(function(){var b=wh.transition;\nwh.transition=1;try{d(a)}finally{wh.transition=b}},[a]);return c},useTransition:function(){var a=Qh(!1),b=a[0];a=di.bind(null,a[1]);Sh(a);return[a,b]},useMutableSource:function(a,b,c){var d=Hh();d.memoizedState={refs:{getSnapshot:b,setSnapshot:null},source:a,subscribe:c};return Nh(d,a,b,c)},useOpaqueIdentifier:function(){if(lh){var a=!1,b=uf(function(){a||(a=!0,c(\"r:\"+(tf++).toString(36)));throw Error(y(355));}),c=Qh(b)[1];0===(R.mode&2)&&(R.flags|=516,Rh(5,function(){c(\"r:\"+(tf++).toString(36))},\nvoid 0,null));return b}b=\"r:\"+(tf++).toString(36);Qh(b);return b},unstable_isNewReconciler:!1},Eh={readContext:vg,useCallback:bi,useContext:vg,useEffect:Xh,useImperativeHandle:$h,useLayoutEffect:Yh,useMemo:ci,useReducer:Kh,useRef:Th,useState:function(){return Kh(Jh)},useDebugValue:ai,useDeferredValue:function(a){var b=Kh(Jh),c=b[0],d=b[1];Xh(function(){var b=wh.transition;wh.transition=1;try{d(a)}finally{wh.transition=b}},[a]);return c},useTransition:function(){var a=Kh(Jh)[0];return[Th().current,\na]},useMutableSource:Ph,useOpaqueIdentifier:function(){return Kh(Jh)[0]},unstable_isNewReconciler:!1},Fh={readContext:vg,useCallback:bi,useContext:vg,useEffect:Xh,useImperativeHandle:$h,useLayoutEffect:Yh,useMemo:ci,useReducer:Lh,useRef:Th,useState:function(){return Lh(Jh)},useDebugValue:ai,useDeferredValue:function(a){var b=Lh(Jh),c=b[0],d=b[1];Xh(function(){var b=wh.transition;wh.transition=1;try{d(a)}finally{wh.transition=b}},[a]);return c},useTransition:function(){var a=Lh(Jh)[0];return[Th().current,\na]},useMutableSource:Ph,useOpaqueIdentifier:function(){return Lh(Jh)[0]},unstable_isNewReconciler:!1},ei=ra.ReactCurrentOwner,ug=!1;function fi(a,b,c,d){b.child=null===a?Zg(b,null,c,d):Yg(b,a.child,c,d)}function gi(a,b,c,d,e){c=c.render;var f=b.ref;tg(b,e);d=Ch(a,b,c,d,f,e);if(null!==a&&!ug)return b.updateQueue=a.updateQueue,b.flags&=-517,a.lanes&=~e,hi(a,b,e);b.flags|=1;fi(a,b,d,e);return b.child}\nfunction ii(a,b,c,d,e,f){if(null===a){var g=c.type;if(\"function\"===typeof g&&!ji(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ki(a,b,g,d,e,f);a=Vg(c.type,null,d,b,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(0===(e&f)&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Je,c(e,d)&&a.ref===b.ref))return hi(a,b,f);b.flags|=1;a=Tg(g,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction ki(a,b,c,d,e,f){if(null!==a&&Je(a.memoizedProps,d)&&a.ref===b.ref)if(ug=!1,0!==(f&e))0!==(a.flags&16384)&&(ug=!0);else return b.lanes=a.lanes,hi(a,b,f);return li(a,b,c,d,f)}\nfunction mi(a,b,c){var d=b.pendingProps,e=d.children,f=null!==a?a.memoizedState:null;if(\"hidden\"===d.mode||\"unstable-defer-without-hiding\"===d.mode)if(0===(b.mode&4))b.memoizedState={baseLanes:0},ni(b,c);else if(0!==(c&1073741824))b.memoizedState={baseLanes:0},ni(b,null!==f?f.baseLanes:c);else return a=null!==f?f.baseLanes|c:c,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:a},ni(b,a),null;else null!==f?(d=f.baseLanes|c,b.memoizedState=null):d=c,ni(b,d);fi(a,b,e,c);return b.child}\nfunction oi(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.flags|=128}function li(a,b,c,d,e){var f=Ff(c)?Df:M.current;f=Ef(b,f);tg(b,e);c=Ch(a,b,c,d,f,e);if(null!==a&&!ug)return b.updateQueue=a.updateQueue,b.flags&=-517,a.lanes&=~e,hi(a,b,e);b.flags|=1;fi(a,b,c,e);return b.child}\nfunction pi(a,b,c,d,e){if(Ff(c)){var f=!0;Jf(b)}else f=!1;tg(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2),Mg(b,c,d),Og(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=vg(l):(l=Ff(c)?Df:M.current,l=Ef(b,l));var n=c.getDerivedStateFromProps,A=\"function\"===typeof n||\"function\"===typeof g.getSnapshotBeforeUpdate;A||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\n\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Ng(b,g,d,l);wg=!1;var p=b.memoizedState;g.state=p;Cg(b,d,g,e);k=b.memoizedState;h!==d||p!==k||N.current||wg?(\"function\"===typeof n&&(Gg(b,c,n,d),k=b.memoizedState),(h=wg||Lg(b,c,h,d,p,k,l))?(A||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===\ntypeof g.componentDidMount&&(b.flags|=4)):(\"function\"===typeof g.componentDidMount&&(b.flags|=4),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.flags|=4),d=!1)}else{g=b.stateNode;yg(a,b);h=b.memoizedProps;l=b.type===b.elementType?h:lg(b.type,h);g.props=l;A=b.pendingProps;p=g.context;k=c.contextType;\"object\"===typeof k&&null!==k?k=vg(k):(k=Ff(c)?Df:M.current,k=Ef(b,k));var C=c.getDerivedStateFromProps;(n=\"function\"===typeof C||\n\"function\"===typeof g.getSnapshotBeforeUpdate)||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==A||p!==k)&&Ng(b,g,d,k);wg=!1;p=b.memoizedState;g.state=p;Cg(b,d,g,e);var x=b.memoizedState;h!==A||p!==x||N.current||wg?(\"function\"===typeof C&&(Gg(b,c,C,d),x=b.memoizedState),(l=wg||Lg(b,c,l,d,p,x,k))?(n||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,\nx,k),\"function\"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,x,k)),\"function\"===typeof g.componentDidUpdate&&(b.flags|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.flags|=256)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&p===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&p===a.memoizedState||(b.flags|=256),b.memoizedProps=d,b.memoizedState=x),g.props=d,g.state=x,g.context=k,d=l):(\"function\"!==typeof g.componentDidUpdate||\nh===a.memoizedProps&&p===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&p===a.memoizedState||(b.flags|=256),d=!1)}return qi(a,b,c,d,f,e)}\nfunction qi(a,b,c,d,e,f){oi(a,b);var g=0!==(b.flags&64);if(!d&&!g)return e&&Kf(b,c,!1),hi(a,b,f);d=b.stateNode;ei.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.flags|=1;null!==a&&g?(b.child=Yg(b,a.child,null,f),b.child=Yg(b,null,h,f)):fi(a,b,h,f);b.memoizedState=d.state;e&&Kf(b,c,!0);return b.child}function ri(a){var b=a.stateNode;b.pendingContext?Hf(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Hf(a,b.context,!1);eh(a,b.containerInfo)}\nvar si={dehydrated:null,retryLane:0};\nfunction ti(a,b,c){var d=b.pendingProps,e=P.current,f=!1,g;(g=0!==(b.flags&64))||(g=null!==a&&null===a.memoizedState?!1:0!==(e&2));g?(f=!0,b.flags&=-65):null!==a&&null===a.memoizedState||void 0===d.fallback||!0===d.unstable_avoidThisFallback||(e|=1);I(P,e&1);if(null===a){void 0!==d.fallback&&ph(b);a=d.children;e=d.fallback;if(f)return a=ui(b,a,e,c),b.child.memoizedState={baseLanes:c},b.memoizedState=si,a;if(\"number\"===typeof d.unstable_expectedLoadTime)return a=ui(b,a,e,c),b.child.memoizedState={baseLanes:c},\nb.memoizedState=si,b.lanes=33554432,a;c=vi({mode:\"visible\",children:a},b.mode,c,null);c.return=b;return b.child=c}if(null!==a.memoizedState){if(f)return d=wi(a,b,d.children,d.fallback,c),f=b.child,e=a.child.memoizedState,f.memoizedState=null===e?{baseLanes:c}:{baseLanes:e.baseLanes|c},f.childLanes=a.childLanes&~c,b.memoizedState=si,d;c=xi(a,b,d.children,c);b.memoizedState=null;return c}if(f)return d=wi(a,b,d.children,d.fallback,c),f=b.child,e=a.child.memoizedState,f.memoizedState=null===e?{baseLanes:c}:\n{baseLanes:e.baseLanes|c},f.childLanes=a.childLanes&~c,b.memoizedState=si,d;c=xi(a,b,d.children,c);b.memoizedState=null;return c}function ui(a,b,c,d){var e=a.mode,f=a.child;b={mode:\"hidden\",children:b};0===(e&2)&&null!==f?(f.childLanes=0,f.pendingProps=b):f=vi(b,e,0,null);c=Xg(c,e,d,null);f.return=a;c.return=a;f.sibling=c;a.child=f;return c}\nfunction xi(a,b,c,d){var e=a.child;a=e.sibling;c=Tg(e,{mode:\"visible\",children:c});0===(b.mode&2)&&(c.lanes=d);c.return=b;c.sibling=null;null!==a&&(a.nextEffect=null,a.flags=8,b.firstEffect=b.lastEffect=a);return b.child=c}\nfunction wi(a,b,c,d,e){var f=b.mode,g=a.child;a=g.sibling;var h={mode:\"hidden\",children:c};0===(f&2)&&b.child!==g?(c=b.child,c.childLanes=0,c.pendingProps=h,g=c.lastEffect,null!==g?(b.firstEffect=c.firstEffect,b.lastEffect=g,g.nextEffect=null):b.firstEffect=b.lastEffect=null):c=Tg(g,h);null!==a?d=Tg(a,d):(d=Xg(d,f,e,null),d.flags|=2);d.return=b;c.return=b;c.sibling=d;b.child=c;return d}function yi(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);sg(a.return,b)}\nfunction zi(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:e,lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailMode=e,g.lastEffect=f)}\nfunction Ai(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;fi(a,b,d.children,c);d=P.current;if(0!==(d&2))d=d&1|2,b.flags|=64;else{if(null!==a&&0!==(a.flags&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&yi(a,c);else if(19===a.tag)yi(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}I(P,d);if(0===(b.mode&2))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===ih(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);zi(b,!1,e,c,f,b.lastEffect);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===ih(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}zi(b,!0,c,null,f,b.lastEffect);break;case \"together\":zi(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}\nfunction hi(a,b,c){null!==a&&(b.dependencies=a.dependencies);Dg|=b.lanes;if(0!==(c&b.childLanes)){if(null!==a&&b.child!==a.child)throw Error(y(153));if(null!==b.child){a=b.child;c=Tg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Tg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}return null}var Bi,Ci,Di,Ei;\nBi=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Ci=function(){};\nDi=function(a,b,c,d){var e=a.memoizedProps;if(e!==d){a=b.stateNode;dh(ah.current);var f=null;switch(c){case \"input\":e=Ya(a,e);d=Ya(a,d);f=[];break;case \"option\":e=eb(a,e);d=eb(a,d);f=[];break;case \"select\":e=m({},e,{value:void 0});d=m({},d,{value:void 0});f=[];break;case \"textarea\":e=gb(a,e);d=gb(a,d);f=[];break;default:\"function\"!==typeof e.onClick&&\"function\"===typeof d.onClick&&(a.onclick=jf)}vb(c,d);var g;c=null;for(l in e)if(!d.hasOwnProperty(l)&&e.hasOwnProperty(l)&&null!=e[l])if(\"style\"===\nl){var h=e[l];for(g in h)h.hasOwnProperty(g)&&(c||(c={}),c[g]=\"\")}else\"dangerouslySetInnerHTML\"!==l&&\"children\"!==l&&\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&\"autoFocus\"!==l&&(ca.hasOwnProperty(l)?f||(f=[]):(f=f||[]).push(l,null));for(l in d){var k=d[l];h=null!=e?e[l]:void 0;if(d.hasOwnProperty(l)&&k!==h&&(null!=k||null!=h))if(\"style\"===l)if(h){for(g in h)!h.hasOwnProperty(g)||k&&k.hasOwnProperty(g)||(c||(c={}),c[g]=\"\");for(g in k)k.hasOwnProperty(g)&&h[g]!==k[g]&&(c||\n(c={}),c[g]=k[g])}else c||(f||(f=[]),f.push(l,c)),c=k;else\"dangerouslySetInnerHTML\"===l?(k=k?k.__html:void 0,h=h?h.__html:void 0,null!=k&&h!==k&&(f=f||[]).push(l,k)):\"children\"===l?\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(l,\"\"+k):\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&(ca.hasOwnProperty(l)?(null!=k&&\"onScroll\"===l&&G(\"scroll\",a),f||h===k||(f=[])):\"object\"===typeof k&&null!==k&&k.$$typeof===Ga?k.toString():(f=f||[]).push(l,k))}c&&(f=f||[]).push(\"style\",\nc);var l=f;if(b.updateQueue=l)b.flags|=4}};Ei=function(a,b,c,d){c!==d&&(b.flags|=4)};function Fi(a,b){if(!lh)switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction Gi(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return Ff(b.type)&&Gf(),null;case 3:fh();H(N);H(M);uh();d=b.stateNode;d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)rh(b)?b.flags|=4:d.hydrate||(b.flags|=256);Ci(b);return null;case 5:hh(b);var e=dh(ch.current);c=b.type;if(null!==a&&null!=b.stateNode)Di(a,b,c,d,e),a.ref!==b.ref&&(b.flags|=128);else{if(!d){if(null===\nb.stateNode)throw Error(y(166));return null}a=dh(ah.current);if(rh(b)){d=b.stateNode;c=b.type;var f=b.memoizedProps;d[wf]=b;d[xf]=f;switch(c){case \"dialog\":G(\"cancel\",d);G(\"close\",d);break;case \"iframe\":case \"object\":case \"embed\":G(\"load\",d);break;case \"video\":case \"audio\":for(a=0;a<Xe.length;a++)G(Xe[a],d);break;case \"source\":G(\"error\",d);break;case \"img\":case \"image\":case \"link\":G(\"error\",d);G(\"load\",d);break;case \"details\":G(\"toggle\",d);break;case \"input\":Za(d,f);G(\"invalid\",d);break;case \"select\":d._wrapperState=\n{wasMultiple:!!f.multiple};G(\"invalid\",d);break;case \"textarea\":hb(d,f),G(\"invalid\",d)}vb(c,f);a=null;for(var g in f)f.hasOwnProperty(g)&&(e=f[g],\"children\"===g?\"string\"===typeof e?d.textContent!==e&&(a=[\"children\",e]):\"number\"===typeof e&&d.textContent!==\"\"+e&&(a=[\"children\",\"\"+e]):ca.hasOwnProperty(g)&&null!=e&&\"onScroll\"===g&&G(\"scroll\",d));switch(c){case \"input\":Va(d);cb(d,f,!0);break;case \"textarea\":Va(d);jb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&(d.onclick=\njf)}d=a;b.updateQueue=d;null!==d&&(b.flags|=4)}else{g=9===e.nodeType?e:e.ownerDocument;a===kb.html&&(a=lb(c));a===kb.html?\"script\"===c?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\"string\"===typeof d.is?a=g.createElement(c,{is:d.is}):(a=g.createElement(c),\"select\"===c&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,c);a[wf]=b;a[xf]=d;Bi(a,b,!1,!1);b.stateNode=a;g=wb(c,d);switch(c){case \"dialog\":G(\"cancel\",a);G(\"close\",a);\ne=d;break;case \"iframe\":case \"object\":case \"embed\":G(\"load\",a);e=d;break;case \"video\":case \"audio\":for(e=0;e<Xe.length;e++)G(Xe[e],a);e=d;break;case \"source\":G(\"error\",a);e=d;break;case \"img\":case \"image\":case \"link\":G(\"error\",a);G(\"load\",a);e=d;break;case \"details\":G(\"toggle\",a);e=d;break;case \"input\":Za(a,d);e=Ya(a,d);G(\"invalid\",a);break;case \"option\":e=eb(a,d);break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};e=m({},d,{value:void 0});G(\"invalid\",a);break;case \"textarea\":hb(a,d);e=\ngb(a,d);G(\"invalid\",a);break;default:e=d}vb(c,e);var h=e;for(f in h)if(h.hasOwnProperty(f)){var k=h[f];\"style\"===f?tb(a,k):\"dangerouslySetInnerHTML\"===f?(k=k?k.__html:void 0,null!=k&&ob(a,k)):\"children\"===f?\"string\"===typeof k?(\"textarea\"!==c||\"\"!==k)&&pb(a,k):\"number\"===typeof k&&pb(a,\"\"+k):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(ca.hasOwnProperty(f)?null!=k&&\"onScroll\"===f&&G(\"scroll\",a):null!=k&&qa(a,f,k,g))}switch(c){case \"input\":Va(a);cb(a,d,!1);\nbreak;case \"textarea\":Va(a);jb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+Sa(d.value));break;case \"select\":a.multiple=!!d.multiple;f=d.value;null!=f?fb(a,!!d.multiple,f,!1):null!=d.defaultValue&&fb(a,!!d.multiple,d.defaultValue,!0);break;default:\"function\"===typeof e.onClick&&(a.onclick=jf)}mf(c,d)&&(b.flags|=4)}null!==b.ref&&(b.flags|=128)}return null;case 6:if(a&&null!=b.stateNode)Ei(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(y(166));\nc=dh(ch.current);dh(ah.current);rh(b)?(d=b.stateNode,c=b.memoizedProps,d[wf]=b,d.nodeValue!==c&&(b.flags|=4)):(d=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),d[wf]=b,b.stateNode=d)}return null;case 13:H(P);d=b.memoizedState;if(0!==(b.flags&64))return b.lanes=c,b;d=null!==d;c=!1;null===a?void 0!==b.memoizedProps.fallback&&rh(b):c=null!==a.memoizedState;if(d&&!c&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||0!==(P.current&1))0===V&&(V=3);else{if(0===V||3===V)V=\n4;null===U||0===(Dg&134217727)&&0===(Hi&134217727)||Ii(U,W)}if(d||c)b.flags|=4;return null;case 4:return fh(),Ci(b),null===a&&cf(b.stateNode.containerInfo),null;case 10:return rg(b),null;case 17:return Ff(b.type)&&Gf(),null;case 19:H(P);d=b.memoizedState;if(null===d)return null;f=0!==(b.flags&64);g=d.rendering;if(null===g)if(f)Fi(d,!1);else{if(0!==V||null!==a&&0!==(a.flags&64))for(a=b.child;null!==a;){g=ih(a);if(null!==g){b.flags|=64;Fi(d,!1);f=g.updateQueue;null!==f&&(b.updateQueue=f,b.flags|=4);\nnull===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;d=c;for(c=b.child;null!==c;)f=c,a=d,f.flags&=2,f.nextEffect=null,f.firstEffect=null,f.lastEffect=null,g=f.alternate,null===g?(f.childLanes=0,f.lanes=a,f.child=null,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=g.childLanes,f.lanes=g.lanes,f.child=g.child,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,f.type=g.type,a=g.dependencies,\nf.dependencies=null===a?null:{lanes:a.lanes,firstContext:a.firstContext}),c=c.sibling;I(P,P.current&1|2);return b.child}a=a.sibling}null!==d.tail&&O()>Ji&&(b.flags|=64,f=!0,Fi(d,!1),b.lanes=33554432)}else{if(!f)if(a=ih(g),null!==a){if(b.flags|=64,f=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.flags|=4),Fi(d,!0),null===d.tail&&\"hidden\"===d.tailMode&&!g.alternate&&!lh)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*O()-d.renderingStartTime>Ji&&1073741824!==c&&(b.flags|=\n64,f=!0,Fi(d,!1),b.lanes=33554432);d.isBackwards?(g.sibling=b.child,b.child=g):(c=d.last,null!==c?c.sibling=g:b.child=g,d.last=g)}return null!==d.tail?(c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=O(),c.sibling=null,b=P.current,I(P,f?b&1|2:b&1),c):null;case 23:case 24:return Ki(),null!==a&&null!==a.memoizedState!==(null!==b.memoizedState)&&\"unstable-defer-without-hiding\"!==d.mode&&(b.flags|=4),null}throw Error(y(156,b.tag));}\nfunction Li(a){switch(a.tag){case 1:Ff(a.type)&&Gf();var b=a.flags;return b&4096?(a.flags=b&-4097|64,a):null;case 3:fh();H(N);H(M);uh();b=a.flags;if(0!==(b&64))throw Error(y(285));a.flags=b&-4097|64;return a;case 5:return hh(a),null;case 13:return H(P),b=a.flags,b&4096?(a.flags=b&-4097|64,a):null;case 19:return H(P),null;case 4:return fh(),null;case 10:return rg(a),null;case 23:case 24:return Ki(),null;default:return null}}\nfunction Mi(a,b){try{var c=\"\",d=b;do c+=Qa(d),d=d.return;while(d);var e=c}catch(f){e=\"\\nError generating stack: \"+f.message+\"\\n\"+f.stack}return{value:a,source:b,stack:e}}function Ni(a,b){try{console.error(b.value)}catch(c){setTimeout(function(){throw c;})}}var Oi=\"function\"===typeof WeakMap?WeakMap:Map;function Pi(a,b,c){c=zg(-1,c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Qi||(Qi=!0,Ri=d);Ni(a,b)};return c}\nfunction Si(a,b,c){c=zg(-1,c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){Ni(a,b);return d(e)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){\"function\"!==typeof d&&(null===Ti?Ti=new Set([this]):Ti.add(this),Ni(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}var Ui=\"function\"===typeof WeakSet?WeakSet:Set;\nfunction Vi(a){var b=a.ref;if(null!==b)if(\"function\"===typeof b)try{b(null)}catch(c){Wi(a,c)}else b.current=null}function Xi(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.flags&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===b.type?c:lg(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:b.flags&256&&qf(b.stateNode.containerInfo);return;case 5:case 6:case 4:case 17:return}throw Error(y(163));}\nfunction Yi(a,b,c){switch(c.tag){case 0:case 11:case 15:case 22:b=c.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){a=b=b.next;do{if(3===(a.tag&3)){var d=a.create;a.destroy=d()}a=a.next}while(a!==b)}b=c.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){a=b=b.next;do{var e=a;d=e.next;e=e.tag;0!==(e&4)&&0!==(e&1)&&(Zi(c,a),$i(c,a));a=d}while(a!==b)}return;case 1:a=c.stateNode;c.flags&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:lg(c.type,b.memoizedProps),a.componentDidUpdate(d,\nb.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Eg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Eg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.flags&4&&mf(c.type,c.memoizedProps)&&a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&Cc(c))));\nreturn;case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(y(163));}\nfunction aj(a,b){for(var c=a;;){if(5===c.tag){var d=c.stateNode;if(b)d=d.style,\"function\"===typeof d.setProperty?d.setProperty(\"display\",\"none\",\"important\"):d.display=\"none\";else{d=c.stateNode;var e=c.memoizedProps.style;e=void 0!==e&&null!==e&&e.hasOwnProperty(\"display\")?e.display:null;d.style.display=sb(\"display\",e)}}else if(6===c.tag)c.stateNode.nodeValue=b?\"\":c.memoizedProps;else if((23!==c.tag&&24!==c.tag||null===c.memoizedState||c===a)&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===\na)break;for(;null===c.sibling;){if(null===c.return||c.return===a)return;c=c.return}c.sibling.return=c.return;c=c.sibling}}\nfunction bj(a,b){if(Mf&&\"function\"===typeof Mf.onCommitFiberUnmount)try{Mf.onCommitFiberUnmount(Lf,b)}catch(f){}switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var c=a=a.next;do{var d=c,e=d.destroy;d=d.tag;if(void 0!==e)if(0!==(d&4))Zi(b,c);else{d=b;try{e()}catch(f){Wi(d,f)}}c=c.next}while(c!==a)}break;case 1:Vi(b);a=b.stateNode;if(\"function\"===typeof a.componentWillUnmount)try{a.props=b.memoizedProps,a.state=b.memoizedState,a.componentWillUnmount()}catch(f){Wi(b,\nf)}break;case 5:Vi(b);break;case 4:cj(a,b)}}function dj(a){a.alternate=null;a.child=null;a.dependencies=null;a.firstEffect=null;a.lastEffect=null;a.memoizedProps=null;a.memoizedState=null;a.pendingProps=null;a.return=null;a.updateQueue=null}function ej(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction fj(a){a:{for(var b=a.return;null!==b;){if(ej(b))break a;b=b.return}throw Error(y(160));}var c=b;b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(y(161));}c.flags&16&&(pb(b,\"\"),c.flags&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||ej(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.flags&2)continue b;if(null===\nc.child||4===c.tag)continue b;else c.child.return=c,c=c.child}if(!(c.flags&2)){c=c.stateNode;break a}}d?gj(a,c,b):hj(a,c,b)}\nfunction gj(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=jf));else if(4!==d&&(a=a.child,null!==a))for(gj(a,b,c),a=a.sibling;null!==a;)gj(a,b,c),a=a.sibling}\nfunction hj(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(hj(a,b,c),a=a.sibling;null!==a;)hj(a,b,c),a=a.sibling}\nfunction cj(a,b){for(var c=b,d=!1,e,f;;){if(!d){d=c.return;a:for(;;){if(null===d)throw Error(y(160));e=d.stateNode;switch(d.tag){case 5:f=!1;break a;case 3:e=e.containerInfo;f=!0;break a;case 4:e=e.containerInfo;f=!0;break a}d=d.return}d=!0}if(5===c.tag||6===c.tag){a:for(var g=a,h=c,k=h;;)if(bj(g,k),null!==k.child&&4!==k.tag)k.child.return=k,k=k.child;else{if(k===h)break a;for(;null===k.sibling;){if(null===k.return||k.return===h)break a;k=k.return}k.sibling.return=k.return;k=k.sibling}f?(g=e,h=c.stateNode,\n8===g.nodeType?g.parentNode.removeChild(h):g.removeChild(h)):e.removeChild(c.stateNode)}else if(4===c.tag){if(null!==c.child){e=c.stateNode.containerInfo;f=!0;c.child.return=c;c=c.child;continue}}else if(bj(a,c),null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return;4===c.tag&&(d=!1)}c.sibling.return=c.return;c=c.sibling}}\nfunction ij(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:var c=b.updateQueue;c=null!==c?c.lastEffect:null;if(null!==c){var d=c=c.next;do 3===(d.tag&3)&&(a=d.destroy,d.destroy=void 0,void 0!==a&&a()),d=d.next;while(d!==c)}return;case 1:return;case 5:c=b.stateNode;if(null!=c){d=b.memoizedProps;var e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[xf]=d;\"input\"===a&&\"radio\"===d.type&&null!=d.name&&$a(c,d);wb(a,e);b=wb(a,d);for(e=0;e<f.length;e+=\n2){var g=f[e],h=f[e+1];\"style\"===g?tb(c,h):\"dangerouslySetInnerHTML\"===g?ob(c,h):\"children\"===g?pb(c,h):qa(c,g,h,b)}switch(a){case \"input\":ab(c,d);break;case \"textarea\":ib(c,d);break;case \"select\":a=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,f=d.value,null!=f?fb(c,!!d.multiple,f,!1):a!==!!d.multiple&&(null!=d.defaultValue?fb(c,!!d.multiple,d.defaultValue,!0):fb(c,!!d.multiple,d.multiple?[]:\"\",!1))}}}return;case 6:if(null===b.stateNode)throw Error(y(162));b.stateNode.nodeValue=\nb.memoizedProps;return;case 3:c=b.stateNode;c.hydrate&&(c.hydrate=!1,Cc(c.containerInfo));return;case 12:return;case 13:null!==b.memoizedState&&(jj=O(),aj(b.child,!0));kj(b);return;case 19:kj(b);return;case 17:return;case 23:case 24:aj(b,null!==b.memoizedState);return}throw Error(y(163));}function kj(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Ui);b.forEach(function(b){var d=lj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nfunction mj(a,b){return null!==a&&(a=a.memoizedState,null===a||null!==a.dehydrated)?(b=b.memoizedState,null!==b&&null===b.dehydrated):!1}var nj=Math.ceil,oj=ra.ReactCurrentDispatcher,pj=ra.ReactCurrentOwner,X=0,U=null,Y=null,W=0,qj=0,rj=Bf(0),V=0,sj=null,tj=0,Dg=0,Hi=0,uj=0,vj=null,jj=0,Ji=Infinity;function wj(){Ji=O()+500}var Z=null,Qi=!1,Ri=null,Ti=null,xj=!1,yj=null,zj=90,Aj=[],Bj=[],Cj=null,Dj=0,Ej=null,Fj=-1,Gj=0,Hj=0,Ij=null,Jj=!1;function Hg(){return 0!==(X&48)?O():-1!==Fj?Fj:Fj=O()}\nfunction Ig(a){a=a.mode;if(0===(a&2))return 1;if(0===(a&4))return 99===eg()?1:2;0===Gj&&(Gj=tj);if(0!==kg.transition){0!==Hj&&(Hj=null!==vj?vj.pendingLanes:0);a=Gj;var b=4186112&~Hj;b&=-b;0===b&&(a=4186112&~a,b=a&-a,0===b&&(b=8192));return b}a=eg();0!==(X&4)&&98===a?a=Xc(12,Gj):(a=Sc(a),a=Xc(a,Gj));return a}\nfunction Jg(a,b,c){if(50<Dj)throw Dj=0,Ej=null,Error(y(185));a=Kj(a,b);if(null===a)return null;$c(a,b,c);a===U&&(Hi|=b,4===V&&Ii(a,W));var d=eg();1===b?0!==(X&8)&&0===(X&48)?Lj(a):(Mj(a,c),0===X&&(wj(),ig())):(0===(X&4)||98!==d&&99!==d||(null===Cj?Cj=new Set([a]):Cj.add(a)),Mj(a,c));vj=a}function Kj(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);c=a;for(a=a.return;null!==a;)a.childLanes|=b,c=a.alternate,null!==c&&(c.childLanes|=b),c=a,a=a.return;return 3===c.tag?c.stateNode:null}\nfunction Mj(a,b){for(var c=a.callbackNode,d=a.suspendedLanes,e=a.pingedLanes,f=a.expirationTimes,g=a.pendingLanes;0<g;){var h=31-Vc(g),k=1<<h,l=f[h];if(-1===l){if(0===(k&d)||0!==(k&e)){l=b;Rc(k);var n=F;f[h]=10<=n?l+250:6<=n?l+5E3:-1}}else l<=b&&(a.expiredLanes|=k);g&=~k}d=Uc(a,a===U?W:0);b=F;if(0===d)null!==c&&(c!==Zf&&Pf(c),a.callbackNode=null,a.callbackPriority=0);else{if(null!==c){if(a.callbackPriority===b)return;c!==Zf&&Pf(c)}15===b?(c=Lj.bind(null,a),null===ag?(ag=[c],bg=Of(Uf,jg)):ag.push(c),\nc=Zf):14===b?c=hg(99,Lj.bind(null,a)):(c=Tc(b),c=hg(c,Nj.bind(null,a)));a.callbackPriority=b;a.callbackNode=c}}\nfunction Nj(a){Fj=-1;Hj=Gj=0;if(0!==(X&48))throw Error(y(327));var b=a.callbackNode;if(Oj()&&a.callbackNode!==b)return null;var c=Uc(a,a===U?W:0);if(0===c)return null;var d=c;var e=X;X|=16;var f=Pj();if(U!==a||W!==d)wj(),Qj(a,d);do try{Rj();break}catch(h){Sj(a,h)}while(1);qg();oj.current=f;X=e;null!==Y?d=0:(U=null,W=0,d=V);if(0!==(tj&Hi))Qj(a,0);else if(0!==d){2===d&&(X|=64,a.hydrate&&(a.hydrate=!1,qf(a.containerInfo)),c=Wc(a),0!==c&&(d=Tj(a,c)));if(1===d)throw b=sj,Qj(a,0),Ii(a,c),Mj(a,O()),b;a.finishedWork=\na.current.alternate;a.finishedLanes=c;switch(d){case 0:case 1:throw Error(y(345));case 2:Uj(a);break;case 3:Ii(a,c);if((c&62914560)===c&&(d=jj+500-O(),10<d)){if(0!==Uc(a,0))break;e=a.suspendedLanes;if((e&c)!==c){Hg();a.pingedLanes|=a.suspendedLanes&e;break}a.timeoutHandle=of(Uj.bind(null,a),d);break}Uj(a);break;case 4:Ii(a,c);if((c&4186112)===c)break;d=a.eventTimes;for(e=-1;0<c;){var g=31-Vc(c);f=1<<g;g=d[g];g>e&&(e=g);c&=~f}c=e;c=O()-c;c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3E3>c?3E3:4320>\nc?4320:1960*nj(c/1960))-c;if(10<c){a.timeoutHandle=of(Uj.bind(null,a),c);break}Uj(a);break;case 5:Uj(a);break;default:throw Error(y(329));}}Mj(a,O());return a.callbackNode===b?Nj.bind(null,a):null}function Ii(a,b){b&=~uj;b&=~Hi;a.suspendedLanes|=b;a.pingedLanes&=~b;for(a=a.expirationTimes;0<b;){var c=31-Vc(b),d=1<<c;a[c]=-1;b&=~d}}\nfunction Lj(a){if(0!==(X&48))throw Error(y(327));Oj();if(a===U&&0!==(a.expiredLanes&W)){var b=W;var c=Tj(a,b);0!==(tj&Hi)&&(b=Uc(a,b),c=Tj(a,b))}else b=Uc(a,0),c=Tj(a,b);0!==a.tag&&2===c&&(X|=64,a.hydrate&&(a.hydrate=!1,qf(a.containerInfo)),b=Wc(a),0!==b&&(c=Tj(a,b)));if(1===c)throw c=sj,Qj(a,0),Ii(a,b),Mj(a,O()),c;a.finishedWork=a.current.alternate;a.finishedLanes=b;Uj(a);Mj(a,O());return null}\nfunction Vj(){if(null!==Cj){var a=Cj;Cj=null;a.forEach(function(a){a.expiredLanes|=24&a.pendingLanes;Mj(a,O())})}ig()}function Wj(a,b){var c=X;X|=1;try{return a(b)}finally{X=c,0===X&&(wj(),ig())}}function Xj(a,b){var c=X;X&=-2;X|=8;try{return a(b)}finally{X=c,0===X&&(wj(),ig())}}function ni(a,b){I(rj,qj);qj|=b;tj|=b}function Ki(){qj=rj.current;H(rj)}\nfunction Qj(a,b){a.finishedWork=null;a.finishedLanes=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,pf(c));if(null!==Y)for(c=Y.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&Gf();break;case 3:fh();H(N);H(M);uh();break;case 5:hh(d);break;case 4:fh();break;case 13:H(P);break;case 19:H(P);break;case 10:rg(d);break;case 23:case 24:Ki()}c=c.return}U=a;Y=Tg(a.current,null);W=qj=tj=b;V=0;sj=null;uj=Hi=Dg=0}\nfunction Sj(a,b){do{var c=Y;try{qg();vh.current=Gh;if(yh){for(var d=R.memoizedState;null!==d;){var e=d.queue;null!==e&&(e.pending=null);d=d.next}yh=!1}xh=0;T=S=R=null;zh=!1;pj.current=null;if(null===c||null===c.return){V=1;sj=b;Y=null;break}a:{var f=a,g=c.return,h=c,k=b;b=W;h.flags|=2048;h.firstEffect=h.lastEffect=null;if(null!==k&&\"object\"===typeof k&&\"function\"===typeof k.then){var l=k;if(0===(h.mode&2)){var n=h.alternate;n?(h.updateQueue=n.updateQueue,h.memoizedState=n.memoizedState,h.lanes=n.lanes):\n(h.updateQueue=null,h.memoizedState=null)}var A=0!==(P.current&1),p=g;do{var C;if(C=13===p.tag){var x=p.memoizedState;if(null!==x)C=null!==x.dehydrated?!0:!1;else{var w=p.memoizedProps;C=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:A?!1:!0}}if(C){var z=p.updateQueue;if(null===z){var u=new Set;u.add(l);p.updateQueue=u}else z.add(l);if(0===(p.mode&2)){p.flags|=64;h.flags|=16384;h.flags&=-2981;if(1===h.tag)if(null===h.alternate)h.tag=17;else{var t=zg(-1,1);t.tag=2;Ag(h,t)}h.lanes|=1;break a}k=\nvoid 0;h=b;var q=f.pingCache;null===q?(q=f.pingCache=new Oi,k=new Set,q.set(l,k)):(k=q.get(l),void 0===k&&(k=new Set,q.set(l,k)));if(!k.has(h)){k.add(h);var v=Yj.bind(null,f,l,h);l.then(v,v)}p.flags|=4096;p.lanes=b;break a}p=p.return}while(null!==p);k=Error((Ra(h.type)||\"A React component\")+\" suspended while rendering, but no fallback UI was specified.\\n\\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.\")}5!==V&&(V=2);k=Mi(k,h);p=\ng;do{switch(p.tag){case 3:f=k;p.flags|=4096;b&=-b;p.lanes|=b;var J=Pi(p,f,b);Bg(p,J);break a;case 1:f=k;var K=p.type,Q=p.stateNode;if(0===(p.flags&64)&&(\"function\"===typeof K.getDerivedStateFromError||null!==Q&&\"function\"===typeof Q.componentDidCatch&&(null===Ti||!Ti.has(Q)))){p.flags|=4096;b&=-b;p.lanes|=b;var L=Si(p,f,b);Bg(p,L);break a}}p=p.return}while(null!==p)}Zj(c)}catch(va){b=va;Y===c&&null!==c&&(Y=c=c.return);continue}break}while(1)}\nfunction Pj(){var a=oj.current;oj.current=Gh;return null===a?Gh:a}function Tj(a,b){var c=X;X|=16;var d=Pj();U===a&&W===b||Qj(a,b);do try{ak();break}catch(e){Sj(a,e)}while(1);qg();X=c;oj.current=d;if(null!==Y)throw Error(y(261));U=null;W=0;return V}function ak(){for(;null!==Y;)bk(Y)}function Rj(){for(;null!==Y&&!Qf();)bk(Y)}function bk(a){var b=ck(a.alternate,a,qj);a.memoizedProps=a.pendingProps;null===b?Zj(a):Y=b;pj.current=null}\nfunction Zj(a){var b=a;do{var c=b.alternate;a=b.return;if(0===(b.flags&2048)){c=Gi(c,b,qj);if(null!==c){Y=c;return}c=b;if(24!==c.tag&&23!==c.tag||null===c.memoizedState||0!==(qj&1073741824)||0===(c.mode&4)){for(var d=0,e=c.child;null!==e;)d|=e.lanes|e.childLanes,e=e.sibling;c.childLanes=d}null!==a&&0===(a.flags&2048)&&(null===a.firstEffect&&(a.firstEffect=b.firstEffect),null!==b.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=b.firstEffect),a.lastEffect=b.lastEffect),1<b.flags&&(null!==\na.lastEffect?a.lastEffect.nextEffect=b:a.firstEffect=b,a.lastEffect=b))}else{c=Li(b);if(null!==c){c.flags&=2047;Y=c;return}null!==a&&(a.firstEffect=a.lastEffect=null,a.flags|=2048)}b=b.sibling;if(null!==b){Y=b;return}Y=b=a}while(null!==b);0===V&&(V=5)}function Uj(a){var b=eg();gg(99,dk.bind(null,a,b));return null}\nfunction dk(a,b){do Oj();while(null!==yj);if(0!==(X&48))throw Error(y(327));var c=a.finishedWork;if(null===c)return null;a.finishedWork=null;a.finishedLanes=0;if(c===a.current)throw Error(y(177));a.callbackNode=null;var d=c.lanes|c.childLanes,e=d,f=a.pendingLanes&~e;a.pendingLanes=e;a.suspendedLanes=0;a.pingedLanes=0;a.expiredLanes&=e;a.mutableReadLanes&=e;a.entangledLanes&=e;e=a.entanglements;for(var g=a.eventTimes,h=a.expirationTimes;0<f;){var k=31-Vc(f),l=1<<k;e[k]=0;g[k]=-1;h[k]=-1;f&=~l}null!==\nCj&&0===(d&24)&&Cj.has(a)&&Cj.delete(a);a===U&&(Y=U=null,W=0);1<c.flags?null!==c.lastEffect?(c.lastEffect.nextEffect=c,d=c.firstEffect):d=c:d=c.firstEffect;if(null!==d){e=X;X|=32;pj.current=null;kf=fd;g=Ne();if(Oe(g)){if(\"selectionStart\"in g)h={start:g.selectionStart,end:g.selectionEnd};else a:if(h=(h=g.ownerDocument)&&h.defaultView||window,(l=h.getSelection&&h.getSelection())&&0!==l.rangeCount){h=l.anchorNode;f=l.anchorOffset;k=l.focusNode;l=l.focusOffset;try{h.nodeType,k.nodeType}catch(va){h=null;\nbreak a}var n=0,A=-1,p=-1,C=0,x=0,w=g,z=null;b:for(;;){for(var u;;){w!==h||0!==f&&3!==w.nodeType||(A=n+f);w!==k||0!==l&&3!==w.nodeType||(p=n+l);3===w.nodeType&&(n+=w.nodeValue.length);if(null===(u=w.firstChild))break;z=w;w=u}for(;;){if(w===g)break b;z===h&&++C===f&&(A=n);z===k&&++x===l&&(p=n);if(null!==(u=w.nextSibling))break;w=z;z=w.parentNode}w=u}h=-1===A||-1===p?null:{start:A,end:p}}else h=null;h=h||{start:0,end:0}}else h=null;lf={focusedElem:g,selectionRange:h};fd=!1;Ij=null;Jj=!1;Z=d;do try{ek()}catch(va){if(null===\nZ)throw Error(y(330));Wi(Z,va);Z=Z.nextEffect}while(null!==Z);Ij=null;Z=d;do try{for(g=a;null!==Z;){var t=Z.flags;t&16&&pb(Z.stateNode,\"\");if(t&128){var q=Z.alternate;if(null!==q){var v=q.ref;null!==v&&(\"function\"===typeof v?v(null):v.current=null)}}switch(t&1038){case 2:fj(Z);Z.flags&=-3;break;case 6:fj(Z);Z.flags&=-3;ij(Z.alternate,Z);break;case 1024:Z.flags&=-1025;break;case 1028:Z.flags&=-1025;ij(Z.alternate,Z);break;case 4:ij(Z.alternate,Z);break;case 8:h=Z;cj(g,h);var J=h.alternate;dj(h);null!==\nJ&&dj(J)}Z=Z.nextEffect}}catch(va){if(null===Z)throw Error(y(330));Wi(Z,va);Z=Z.nextEffect}while(null!==Z);v=lf;q=Ne();t=v.focusedElem;g=v.selectionRange;if(q!==t&&t&&t.ownerDocument&&Me(t.ownerDocument.documentElement,t)){null!==g&&Oe(t)&&(q=g.start,v=g.end,void 0===v&&(v=q),\"selectionStart\"in t?(t.selectionStart=q,t.selectionEnd=Math.min(v,t.value.length)):(v=(q=t.ownerDocument||document)&&q.defaultView||window,v.getSelection&&(v=v.getSelection(),h=t.textContent.length,J=Math.min(g.start,h),g=void 0===\ng.end?J:Math.min(g.end,h),!v.extend&&J>g&&(h=g,g=J,J=h),h=Le(t,J),f=Le(t,g),h&&f&&(1!==v.rangeCount||v.anchorNode!==h.node||v.anchorOffset!==h.offset||v.focusNode!==f.node||v.focusOffset!==f.offset)&&(q=q.createRange(),q.setStart(h.node,h.offset),v.removeAllRanges(),J>g?(v.addRange(q),v.extend(f.node,f.offset)):(q.setEnd(f.node,f.offset),v.addRange(q))))));q=[];for(v=t;v=v.parentNode;)1===v.nodeType&&q.push({element:v,left:v.scrollLeft,top:v.scrollTop});\"function\"===typeof t.focus&&t.focus();for(t=\n0;t<q.length;t++)v=q[t],v.element.scrollLeft=v.left,v.element.scrollTop=v.top}fd=!!kf;lf=kf=null;a.current=c;Z=d;do try{for(t=a;null!==Z;){var K=Z.flags;K&36&&Yi(t,Z.alternate,Z);if(K&128){q=void 0;var Q=Z.ref;if(null!==Q){var L=Z.stateNode;switch(Z.tag){case 5:q=L;break;default:q=L}\"function\"===typeof Q?Q(q):Q.current=q}}Z=Z.nextEffect}}catch(va){if(null===Z)throw Error(y(330));Wi(Z,va);Z=Z.nextEffect}while(null!==Z);Z=null;$f();X=e}else a.current=c;if(xj)xj=!1,yj=a,zj=b;else for(Z=d;null!==Z;)b=\nZ.nextEffect,Z.nextEffect=null,Z.flags&8&&(K=Z,K.sibling=null,K.stateNode=null),Z=b;d=a.pendingLanes;0===d&&(Ti=null);1===d?a===Ej?Dj++:(Dj=0,Ej=a):Dj=0;c=c.stateNode;if(Mf&&\"function\"===typeof Mf.onCommitFiberRoot)try{Mf.onCommitFiberRoot(Lf,c,void 0,64===(c.current.flags&64))}catch(va){}Mj(a,O());if(Qi)throw Qi=!1,a=Ri,Ri=null,a;if(0!==(X&8))return null;ig();return null}\nfunction ek(){for(;null!==Z;){var a=Z.alternate;Jj||null===Ij||(0!==(Z.flags&8)?dc(Z,Ij)&&(Jj=!0):13===Z.tag&&mj(a,Z)&&dc(Z,Ij)&&(Jj=!0));var b=Z.flags;0!==(b&256)&&Xi(a,Z);0===(b&512)||xj||(xj=!0,hg(97,function(){Oj();return null}));Z=Z.nextEffect}}function Oj(){if(90!==zj){var a=97<zj?97:zj;zj=90;return gg(a,fk)}return!1}function $i(a,b){Aj.push(b,a);xj||(xj=!0,hg(97,function(){Oj();return null}))}function Zi(a,b){Bj.push(b,a);xj||(xj=!0,hg(97,function(){Oj();return null}))}\nfunction fk(){if(null===yj)return!1;var a=yj;yj=null;if(0!==(X&48))throw Error(y(331));var b=X;X|=32;var c=Bj;Bj=[];for(var d=0;d<c.length;d+=2){var e=c[d],f=c[d+1],g=e.destroy;e.destroy=void 0;if(\"function\"===typeof g)try{g()}catch(k){if(null===f)throw Error(y(330));Wi(f,k)}}c=Aj;Aj=[];for(d=0;d<c.length;d+=2){e=c[d];f=c[d+1];try{var h=e.create;e.destroy=h()}catch(k){if(null===f)throw Error(y(330));Wi(f,k)}}for(h=a.current.firstEffect;null!==h;)a=h.nextEffect,h.nextEffect=null,h.flags&8&&(h.sibling=\nnull,h.stateNode=null),h=a;X=b;ig();return!0}function gk(a,b,c){b=Mi(c,b);b=Pi(a,b,1);Ag(a,b);b=Hg();a=Kj(a,1);null!==a&&($c(a,1,b),Mj(a,b))}\nfunction Wi(a,b){if(3===a.tag)gk(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){gk(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if(\"function\"===typeof c.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Ti||!Ti.has(d))){a=Mi(b,a);var e=Si(c,a,1);Ag(c,e);e=Hg();c=Kj(c,1);if(null!==c)$c(c,1,e),Mj(c,e);else if(\"function\"===typeof d.componentDidCatch&&(null===Ti||!Ti.has(d)))try{d.componentDidCatch(b,a)}catch(f){}break}}c=c.return}}\nfunction Yj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);b=Hg();a.pingedLanes|=a.suspendedLanes&c;U===a&&(W&c)===c&&(4===V||3===V&&(W&62914560)===W&&500>O()-jj?Qj(a,0):uj|=c);Mj(a,b)}function lj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=a.mode,0===(b&2)?b=1:0===(b&4)?b=99===eg()?1:2:(0===Gj&&(Gj=tj),b=Yc(62914560&~Gj),0===b&&(b=4194304)));c=Hg();a=Kj(a,b);null!==a&&($c(a,b,c),Mj(a,c))}var ck;\nck=function(a,b,c){var d=b.lanes;if(null!==a)if(a.memoizedProps!==b.pendingProps||N.current)ug=!0;else if(0!==(c&d))ug=0!==(a.flags&16384)?!0:!1;else{ug=!1;switch(b.tag){case 3:ri(b);sh();break;case 5:gh(b);break;case 1:Ff(b.type)&&Jf(b);break;case 4:eh(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;var e=b.type._context;I(mg,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){if(0!==(c&b.child.childLanes))return ti(a,b,c);I(P,P.current&1);b=hi(a,b,c);return null!==\nb?b.sibling:null}I(P,P.current&1);break;case 19:d=0!==(c&b.childLanes);if(0!==(a.flags&64)){if(d)return Ai(a,b,c);b.flags|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null,e.lastEffect=null);I(P,P.current);if(d)break;else return null;case 23:case 24:return b.lanes=0,mi(a,b,c)}return hi(a,b,c)}else ug=!1;b.lanes=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2);a=b.pendingProps;e=Ef(b,M.current);tg(b,c);e=Ch(null,b,d,a,e,c);b.flags|=1;if(\"object\"===\ntypeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(Ff(d)){var f=!0;Jf(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;xg(b);var g=d.getDerivedStateFromProps;\"function\"===typeof g&&Gg(b,d,g,a);e.updater=Kg;b.stateNode=e;e._reactInternals=b;Og(b,d,a,c);b=qi(null,b,d,!0,f,c)}else b.tag=0,fi(null,b,e,c),b=b.child;return b;case 16:e=b.elementType;a:{null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2);\na=b.pendingProps;f=e._init;e=f(e._payload);b.type=e;f=b.tag=hk(e);a=lg(e,a);switch(f){case 0:b=li(null,b,e,a,c);break a;case 1:b=pi(null,b,e,a,c);break a;case 11:b=gi(null,b,e,a,c);break a;case 14:b=ii(null,b,e,lg(e.type,a),d,c);break a}throw Error(y(306,e,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:lg(d,e),li(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:lg(d,e),pi(a,b,d,e,c);case 3:ri(b);d=b.updateQueue;if(null===a||null===d)throw Error(y(282));\nd=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;yg(a,b);Cg(b,d,null,c);d=b.memoizedState.element;if(d===e)sh(),b=hi(a,b,c);else{e=b.stateNode;if(f=e.hydrate)kh=rf(b.stateNode.containerInfo.firstChild),jh=b,f=lh=!0;if(f){a=e.mutableSourceEagerHydrationData;if(null!=a)for(e=0;e<a.length;e+=2)f=a[e],f._workInProgressVersionPrimary=a[e+1],th.push(f);c=Zg(b,null,d,c);for(b.child=c;c;)c.flags=c.flags&-3|1024,c=c.sibling}else fi(a,b,d,c),sh();b=b.child}return b;case 5:return gh(b),null===a&&\nph(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,nf(d,e)?g=null:null!==f&&nf(d,f)&&(b.flags|=16),oi(a,b),fi(a,b,g,c),b.child;case 6:return null===a&&ph(b),null;case 13:return ti(a,b,c);case 4:return eh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Yg(b,null,d,c):fi(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:lg(d,e),gi(a,b,d,e,c);case 7:return fi(a,b,b.pendingProps,c),b.child;case 8:return fi(a,b,b.pendingProps.children,\nc),b.child;case 12:return fi(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;I(mg,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=He(h,f)?0:(\"function\"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!N.current){b=hi(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var k=h.dependencies;if(null!==k){g=h.child;for(var l=\nk.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=zg(-1,c&-c),l.tag=2,Ag(h,l));h.lanes|=c;l=h.alternate;null!==l&&(l.lanes|=c);sg(h.return,c);k.lanes|=c;break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=g}fi(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,tg(b,c),e=vg(e,\nf.unstable_observedBits),d=d(e),b.flags|=1,fi(a,b,d,c),b.child;case 14:return e=b.type,f=lg(e,b.pendingProps),f=lg(e.type,f),ii(a,b,e,f,d,c);case 15:return ki(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:lg(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2),b.tag=1,Ff(d)?(a=!0,Jf(b)):a=!1,tg(b,c),Mg(b,d,e),Og(b,d,e,c),qi(null,b,d,!0,a,c);case 19:return Ai(a,b,c);case 23:return mi(a,b,c);case 24:return mi(a,b,c)}throw Error(y(156,b.tag));\n};function ik(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.flags=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childLanes=this.lanes=0;this.alternate=null}function nh(a,b,c,d){return new ik(a,b,c,d)}function ji(a){a=a.prototype;return!(!a||!a.isReactComponent)}\nfunction hk(a){if(\"function\"===typeof a)return ji(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===Aa)return 11;if(a===Da)return 14}return 2}\nfunction Tg(a,b){var c=a.alternate;null===c?(c=nh(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.type=a.type,c.flags=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null);c.childLanes=a.childLanes;c.lanes=a.lanes;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{lanes:b.lanes,firstContext:b.firstContext};\nc.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction Vg(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)ji(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ua:return Xg(c.children,e,f,b);case Ha:g=8;e|=16;break;case wa:g=8;e|=1;break;case xa:return a=nh(12,c,b,e|8),a.elementType=xa,a.type=xa,a.lanes=f,a;case Ba:return a=nh(13,c,b,e),a.type=Ba,a.elementType=Ba,a.lanes=f,a;case Ca:return a=nh(19,c,b,e),a.elementType=Ca,a.lanes=f,a;case Ia:return vi(c,e,f,b);case Ja:return a=nh(24,c,b,e),a.elementType=Ja,a.lanes=f,a;default:if(\"object\"===\ntypeof a&&null!==a)switch(a.$$typeof){case ya:g=10;break a;case za:g=9;break a;case Aa:g=11;break a;case Da:g=14;break a;case Ea:g=16;d=null;break a;case Fa:g=22;break a}throw Error(y(130,null==a?a:typeof a,\"\"));}b=nh(g,c,b,e);b.elementType=a;b.type=d;b.lanes=f;return b}function Xg(a,b,c,d){a=nh(7,a,d,b);a.lanes=c;return a}function vi(a,b,c,d){a=nh(23,a,d,b);a.elementType=Ia;a.lanes=c;return a}function Ug(a,b,c){a=nh(6,a,null,b);a.lanes=c;return a}\nfunction Wg(a,b,c){b=nh(4,null!==a.children?a.children:[],a.key,b);b.lanes=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction jk(a,b,c){this.tag=b;this.containerInfo=a;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=0;this.eventTimes=Zc(0);this.expirationTimes=Zc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=Zc(0);this.mutableSourceEagerHydrationData=null}\nfunction kk(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:ta,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nfunction lk(a,b,c,d){var e=b.current,f=Hg(),g=Ig(e);a:if(c){c=c._reactInternals;b:{if(Zb(c)!==c||1!==c.tag)throw Error(y(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(Ff(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(y(171));}if(1===c.tag){var k=c.type;if(Ff(k)){c=If(c,k,h);break a}}c=h}else c=Cf;null===b.context?b.context=c:b.pendingContext=c;b=zg(f,g);b.payload={element:a};d=void 0===d?null:d;null!==\nd&&(b.callback=d);Ag(e,b);Jg(e,g,f);return g}function mk(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function nk(a,b){a=a.memoizedState;if(null!==a&&null!==a.dehydrated){var c=a.retryLane;a.retryLane=0!==c&&c<b?c:b}}function ok(a,b){nk(a,b);(a=a.alternate)&&nk(a,b)}function pk(){return null}\nfunction qk(a,b,c){var d=null!=c&&null!=c.hydrationOptions&&c.hydrationOptions.mutableSources||null;c=new jk(a,b,null!=c&&!0===c.hydrate);b=nh(3,null,null,2===b?7:1===b?3:0);c.current=b;b.stateNode=c;xg(b);a[ff]=c.current;cf(8===a.nodeType?a.parentNode:a);if(d)for(a=0;a<d.length;a++){b=d[a];var e=b._getVersion;e=e(b._source);null==c.mutableSourceEagerHydrationData?c.mutableSourceEagerHydrationData=[b,e]:c.mutableSourceEagerHydrationData.push(b,e)}this._internalRoot=c}\nqk.prototype.render=function(a){lk(a,this._internalRoot,null,null)};qk.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;lk(null,a,null,function(){b[ff]=null})};function rk(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}\nfunction sk(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute(\"data-reactroot\")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new qk(a,0,b?{hydrate:!0}:void 0)}\nfunction tk(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;if(\"function\"===typeof e){var h=e;e=function(){var a=mk(g);h.call(a)}}lk(b,g,a,e)}else{f=c._reactRootContainer=sk(c,d);g=f._internalRoot;if(\"function\"===typeof e){var k=e;e=function(){var a=mk(g);k.call(a)}}Xj(function(){lk(b,g,a,e)})}return mk(g)}ec=function(a){if(13===a.tag){var b=Hg();Jg(a,4,b);ok(a,4)}};fc=function(a){if(13===a.tag){var b=Hg();Jg(a,67108864,b);ok(a,67108864)}};\ngc=function(a){if(13===a.tag){var b=Hg(),c=Ig(a);Jg(a,c,b);ok(a,c)}};hc=function(a,b){return b()};\nyb=function(a,b,c){switch(b){case \"input\":ab(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Db(d);if(!e)throw Error(y(90));Wa(d);ab(d,e)}}}break;case \"textarea\":ib(a,c);break;case \"select\":b=c.value,null!=b&&fb(a,!!c.multiple,b,!1)}};Gb=Wj;\nHb=function(a,b,c,d,e){var f=X;X|=4;try{return gg(98,a.bind(null,b,c,d,e))}finally{X=f,0===X&&(wj(),ig())}};Ib=function(){0===(X&49)&&(Vj(),Oj())};Jb=function(a,b){var c=X;X|=2;try{return a(b)}finally{X=c,0===X&&(wj(),ig())}};function uk(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!rk(b))throw Error(y(200));return kk(a,b,null,c)}var vk={Events:[Cb,ue,Db,Eb,Fb,Oj,{current:!1}]},wk={findFiberByHostInstance:wc,bundleType:0,version:\"17.0.2\",rendererPackageName:\"react-dom\"};\nvar xk={bundleType:wk.bundleType,version:wk.version,rendererPackageName:wk.rendererPackageName,rendererConfig:wk.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ra.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=cc(a);return null===a?null:a.stateNode},findFiberByHostInstance:wk.findFiberByHostInstance||\npk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if(\"undefined\"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var yk=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yk.isDisabled&&yk.supportsFiber)try{Lf=yk.inject(xk),Mf=yk}catch(a){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vk;exports.createPortal=uk;\nexports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternals;if(void 0===b){if(\"function\"===typeof a.render)throw Error(y(188));throw Error(y(268,Object.keys(a)));}a=cc(b);a=null===a?null:a.stateNode;return a};exports.flushSync=function(a,b){var c=X;if(0!==(c&48))return a(b);X|=1;try{if(a)return gg(99,a.bind(null,b))}finally{X=c,ig()}};exports.hydrate=function(a,b,c){if(!rk(b))throw Error(y(200));return tk(null,a,b,!0,c)};\nexports.render=function(a,b,c){if(!rk(b))throw Error(y(200));return tk(null,a,b,!1,c)};exports.unmountComponentAtNode=function(a){if(!rk(a))throw Error(y(40));return a._reactRootContainer?(Xj(function(){tk(null,null,a,!1,function(){a._reactRootContainer=null;a[ff]=null})}),!0):!1};exports.unstable_batchedUpdates=Wj;exports.unstable_createPortal=function(a,b){return uk(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!rk(c))throw Error(y(200));if(null==a||void 0===a._reactInternals)throw Error(y(38));return tk(a,b,c,!1,d)};exports.version=\"17.0.2\";\n", "'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n", "/** @license React v17.0.2\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';require(\"object-assign\");var f=require(\"react\"),g=60103;exports.Fragment=60107;if(\"function\"===typeof Symbol&&Symbol.for){var h=Symbol.for;g=h(\"react.element\");exports.Fragment=h(\"react.fragment\")}var m=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n=Object.prototype.hasOwnProperty,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,k){var b,d={},e=null,l=null;void 0!==k&&(e=\"\"+k);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(l=a.ref);for(b in a)n.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:g,type:c,key:e,ref:l,props:d,_owner:m.current}}exports.jsx=q;exports.jsxs=q;\n", "'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.JSON_ID_KEYNAME = exports.JSON_SURVEY_KEYNAME = exports.DOM_ID_TAGNAME = exports.DOM_TYPE_VALUE = exports.DOM_TYPE_TAGNAME = exports.SurveyInfoBusinessLevel = void 0;\r\nvar SurveyInfoBusinessLevel;\r\n(function (SurveyInfoBusinessLevel) {\r\n    SurveyInfoBusinessLevel[SurveyInfoBusinessLevel[\"None\"] = 0] = \"None\";\r\n    SurveyInfoBusinessLevel[SurveyInfoBusinessLevel[\"Critical\"] = 1] = \"Critical\";\r\n})(SurveyInfoBusinessLevel = exports.SurveyInfoBusinessLevel || (exports.SurveyInfoBusinessLevel = {}));\r\nexports.DOM_TYPE_TAGNAME = \"Type\";\r\nexports.DOM_TYPE_VALUE = \"Survey\";\r\nexports.DOM_ID_TAGNAME = \"SurveyID\";\r\nexports.JSON_SURVEY_KEYNAME = \"survey\";\r\nexports.JSON_ID_KEYNAME = \"surveyId\";\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ActivityName = void 0;\r\nvar ActivityName = (function () {\r\n    function ActivityName() {\r\n    }\r\n    ActivityName.AppLaunch = \"AppLaunch\";\r\n    ActivityName.AppUsageTime = \"AppUsageTime\";\r\n    ActivityName.AppResume = \"AppResume\";\r\n    return ActivityName;\r\n}());\r\nexports.ActivityName = ActivityName;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LAUNCHER_TYPE_DEFAULT = exports.DOM_INTERCEPT_TAGNAME = exports.DOM_NLQS_TAGNAME = exports.DOM_FPS_TAGNAME = exports.DOM_BPS_TAGNAME = exports.DOM_PSAT_TAGNAME = exports.DOM_NPS_TAGNAME = exports.DOM_FEEDBACKSURVEY_TAGNAME = exports.SurveyType = void 0;\r\nvar SurveyType;\r\n(function (SurveyType) {\r\n    SurveyType[SurveyType[\"Feedback\"] = 0] = \"Feedback\";\r\n    SurveyType[SurveyType[\"Nps\"] = 1] = \"Nps\";\r\n    SurveyType[SurveyType[\"Psat\"] = 2] = \"Psat\";\r\n    SurveyType[SurveyType[\"Bps\"] = 3] = \"Bps\";\r\n    SurveyType[SurveyType[\"Fps\"] = 4] = \"Fps\";\r\n    SurveyType[SurveyType[\"Nlqs\"] = 5] = \"Nlqs\";\r\n    SurveyType[SurveyType[\"Intercept\"] = 6] = \"Intercept\";\r\n    SurveyType[SurveyType[\"GenericMessagingSurface\"] = 12] = \"GenericMessagingSurface\";\r\n    SurveyType[SurveyType[\"Dialog\"] = 15] = \"Dialog\";\r\n})(SurveyType = exports.SurveyType || (exports.SurveyType = {}));\r\nexports.DOM_FEEDBACKSURVEY_TAGNAME = \"FeedbackSurvey\";\r\nexports.DOM_NPS_TAGNAME = \"Nps\";\r\nexports.DOM_PSAT_TAGNAME = \"Psat\";\r\nexports.DOM_BPS_TAGNAME = \"Bps\";\r\nexports.DOM_FPS_TAGNAME = \"Fps\";\r\nexports.DOM_NLQS_TAGNAME = \"Nlqs\";\r\nexports.DOM_INTERCEPT_TAGNAME = \"Intercept\";\r\nexports.LAUNCHER_TYPE_DEFAULT = \"survey\";\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.JSON_SURVEYSPECIFICDATA_KEYNAME = exports.JSON_SURVEYSTRINGS_KEYNAME = exports.JSON_EXTENDEDMANIFESTDATA_KEYNAME = exports.JSON_APPLICATION_KEYNAME = exports.JSON_MULTIPLECHOICE_KEYNAME = exports.JSON_QUESTION_KEYNAME = exports.JSON_TITLE_KEYNAME = exports.JSON_CVSURVEYPLATFORM_KEYNAME = exports.JSON_CVSURVEYUIHOST_KEYNAME = exports.JSON_CVSURVEYPRODUCTNAME_KEYNAME = exports.JSON_RATINGOPTIONS_KEYNAME = exports.JSON_CVSURVEYTHEME_KEYNAME = exports.JSON_CVSURVEYFORMID_KEYNAME = exports.JSON_CVSURVEY_KEYNAME = exports.JSON_RATING_KEYNAME = exports.JSON_COMMENT_KEYNAME = exports.JSON_PROMPTNOTEXT_KEYNAME = exports.JSON_PROMPTYESTEXT_KEYNAME = exports.JSON_PROMPT_KEYNAME = exports.JSON_INTERCEPTURL_KEYNAME = exports.JSON_INTERCEPT_KEYNAME = exports.DOM_MULTIPLECHOICE_TAGNAME = exports.DOM_CVSURVEY_TAGNAME = exports.DOM_RATING_TAGNAME = exports.DOM_COMMENT_TAGNAME = exports.DOM_PROMPT_TAGNAME = void 0;\r\nexports.DOM_PROMPT_TAGNAME = \"Prompt\";\r\nexports.DOM_COMMENT_TAGNAME = \"Comment\";\r\nexports.DOM_RATING_TAGNAME = \"Rating\";\r\nexports.DOM_CVSURVEY_TAGNAME = \"CVSurvey\";\r\nexports.DOM_MULTIPLECHOICE_TAGNAME = \"MultipleChoice\";\r\nexports.JSON_INTERCEPT_KEYNAME = \"intercept\";\r\nexports.JSON_INTERCEPTURL_KEYNAME = \"url\";\r\nexports.JSON_PROMPT_KEYNAME = \"prompt\";\r\nexports.JSON_PROMPTYESTEXT_KEYNAME = \"yesButtonText\";\r\nexports.JSON_PROMPTNOTEXT_KEYNAME = \"noButtonText\";\r\nexports.JSON_COMMENT_KEYNAME = \"comment\";\r\nexports.JSON_RATING_KEYNAME = \"rating\";\r\nexports.JSON_CVSURVEY_KEYNAME = \"cvSurvey\";\r\nexports.JSON_CVSURVEYFORMID_KEYNAME = \"formId\";\r\nexports.JSON_CVSURVEYTHEME_KEYNAME = \"theme\";\r\nexports.JSON_RATINGOPTIONS_KEYNAME = \"options\";\r\nexports.JSON_CVSURVEYPRODUCTNAME_KEYNAME = \"productName\";\r\nexports.JSON_CVSURVEYUIHOST_KEYNAME = \"uiHost\";\r\nexports.JSON_CVSURVEYPLATFORM_KEYNAME = \"platform\";\r\nexports.JSON_TITLE_KEYNAME = \"title\";\r\nexports.JSON_QUESTION_KEYNAME = \"question\";\r\nexports.JSON_MULTIPLECHOICE_KEYNAME = \"multipleChoice\";\r\nexports.JSON_APPLICATION_KEYNAME = \"application\";\r\nexports.JSON_EXTENDEDMANIFESTDATA_KEYNAME = \"extendedManifestData\";\r\nexports.JSON_SURVEYSTRINGS_KEYNAME = \"surveyStrings\";\r\nexports.JSON_SURVEYSPECIFICDATA_KEYNAME = \"surveySpecificData\";\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.RoamingSettingIdMap = void 0;\r\nexports.RoamingSettingIdMap = {\r\n    CampaignStates: 1258,\r\n    GovernedChannelStates: 1257,\r\n    SurveyActivationStats: 1259,\r\n};\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.FloodgateStorageProviderFileType = void 0;\r\nvar FloodgateStorageProviderFileType;\r\n(function (FloodgateStorageProviderFileType) {\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"FloodgateSettings\"] = 0] = \"FloodgateSettings\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"SurveyActivationStats\"] = 1] = \"SurveyActivationStats\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"SurveyEventActivityStats\"] = 2] = \"SurveyEventActivityStats\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"CampaignDefinitions\"] = 3] = \"CampaignDefinitions\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"CampaignStates\"] = 4] = \"CampaignStates\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"GovernedChannelStates\"] = 5] = \"GovernedChannelStates\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"TmsCache_MessageMetadata\"] = 6] = \"TmsCache_MessageMetadata\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"TmsCache_UserGovernance\"] = 7] = \"TmsCache_UserGovernance\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"TmsCache_CampaignContent\"] = 8] = \"TmsCache_CampaignContent\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"Tms_DynamicSettings\"] = 9] = \"Tms_DynamicSettings\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"LogLevelSettings\"] = 10] = \"LogLevelSettings\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"UserFacts\"] = 11] = \"UserFacts\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"DebugOverrides\"] = 12] = \"DebugOverrides\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"DynamicCampaignDefinitions\"] = 13] = \"DynamicCampaignDefinitions\";\r\n    FloodgateStorageProviderFileType[FloodgateStorageProviderFileType[\"FeatureGateOverrides\"] = 14] = \"FeatureGateOverrides\";\r\n})(FloodgateStorageProviderFileType = exports.FloodgateStorageProviderFileType || (exports.FloodgateStorageProviderFileType = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.GovernanceServiceClientState = exports.GovernanceServiceSurveyType = void 0;\r\nvar GovernanceServiceSurveyType;\r\n(function (GovernanceServiceSurveyType) {\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Unknown\"] = 0] = \"Unknown\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Feedback\"] = 1] = \"Feedback\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Nps\"] = 2] = \"Nps\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Psat\"] = 4] = \"Psat\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Bps\"] = 6] = \"Bps\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Fps\"] = 8] = \"Fps\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Nlqs\"] = 18] = \"Nlqs\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"GenericMessagingSurface\"] = 22] = \"GenericMessagingSurface\";\r\n    GovernanceServiceSurveyType[GovernanceServiceSurveyType[\"Intercept\"] = 24] = \"Intercept\";\r\n})(GovernanceServiceSurveyType = exports.GovernanceServiceSurveyType || (exports.GovernanceServiceSurveyType = {}));\r\nvar GovernanceServiceClientState;\r\n(function (GovernanceServiceClientState) {\r\n    GovernanceServiceClientState[GovernanceServiceClientState[\"Disabled\"] = 0] = \"Disabled\";\r\n    GovernanceServiceClientState[GovernanceServiceClientState[\"InitializationFailed\"] = 1] = \"InitializationFailed\";\r\n    GovernanceServiceClientState[GovernanceServiceClientState[\"Enabled\"] = 2] = \"Enabled\";\r\n})(GovernanceServiceClientState = exports.GovernanceServiceClientState || (exports.GovernanceServiceClientState = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.EcsConfigType = void 0;\r\nvar EcsConfigType;\r\n(function (EcsConfigType) {\r\n    EcsConfigType[EcsConfigType[\"Default\"] = 0] = \"Default\";\r\n    EcsConfigType[EcsConfigType[\"User\"] = 1] = \"User\";\r\n})(EcsConfigType = exports.EcsConfigType || (exports.EcsConfigType = {}));\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__exportStar(require(\"./../ISurveyInfo\"), exports);\r\n__exportStar(require(\"./IActivityListener\"), exports);\r\n__exportStar(require(\"./ISurvey\"), exports);\r\n__exportStar(require(\"./ISurveyComponent\"), exports);\r\n__exportStar(require(\"./IEcsAdapter\"), exports);\r\n__exportStar(require(\"./IFloodgateSettingIdMap\"), exports);\r\n__exportStar(require(\"./IFloodgateStorageProvider\"), exports);\r\n__exportStar(require(\"./IFloodgateStringProvider\"), exports);\r\n__exportStar(require(\"./IMultipleChoiceComponent\"), exports);\r\n__exportStar(require(\"./IPrompt\"), exports);\r\n__exportStar(require(\"./INlqsSurvey\"), exports);\r\n__exportStar(require(\"./INpsSurvey\"), exports);\r\n__exportStar(require(\"./ICVSurvey\"), exports);\r\n__exportStar(require(\"./IDynamicUxClient\"), exports);\r\n__exportStar(require(\"./IGovernanceServiceClient\"), exports);\r\n__exportStar(require(\"./Ecs/IModels\"), exports);\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.QuestionType = void 0;\r\nvar QuestionType;\r\n(function (QuestionType) {\r\n    QuestionType[\"Comment\"] = \"Comment\";\r\n    QuestionType[\"ContactMe\"] = \"ContactMe\";\r\n    QuestionType[\"MultipleChoice\"] = \"MultipleChoice\";\r\n    QuestionType[\"Label\"] = \"Label\";\r\n    QuestionType[\"Rating\"] = \"Rating\";\r\n    QuestionType[\"SingleSelect\"] = \"SingleSelect\";\r\n    QuestionType[\"Likert\"] = \"Likert\";\r\n})(QuestionType = exports.QuestionType || (exports.QuestionType = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.BranchingTargetType = exports.ConditionSourceType = exports.ConditionType = void 0;\r\nvar ConditionType;\r\n(function (ConditionType) {\r\n    ConditionType[\"Equals\"] = \"Equals\";\r\n    ConditionType[\"NotEquals\"] = \"NotEquals\";\r\n    ConditionType[\"GreaterThan\"] = \"GreaterThan\";\r\n    ConditionType[\"GreaterThanOrEqual\"] = \"GreaterThanOrEqual\";\r\n    ConditionType[\"LessThan\"] = \"LessThan\";\r\n    ConditionType[\"LessThanOrEqual\"] = \"LessThanOrEqual\";\r\n    ConditionType[\"IsAnswered\"] = \"IsAnswered\";\r\n})(ConditionType = exports.ConditionType || (exports.ConditionType = {}));\r\nvar ConditionSourceType;\r\n(function (ConditionSourceType) {\r\n    ConditionSourceType[\"Question\"] = \"Question\";\r\n    ConditionSourceType[\"Variable\"] = \"Variable\";\r\n})(ConditionSourceType = exports.ConditionSourceType || (exports.ConditionSourceType = {}));\r\nvar BranchingTargetType;\r\n(function (BranchingTargetType) {\r\n    BranchingTargetType[\"Page\"] = \"Page\";\r\n    BranchingTargetType[\"Override\"] = \"Override\";\r\n})(BranchingTargetType = exports.BranchingTargetType || (exports.BranchingTargetType = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.IUxSchemaAdditionalCapabilitiesTypes = void 0;\r\nvar IUxSchemaAdditionalCapabilitiesTypes;\r\n(function (IUxSchemaAdditionalCapabilitiesTypes) {\r\n    IUxSchemaAdditionalCapabilitiesTypes[\"Email\"] = \"email\";\r\n    IUxSchemaAdditionalCapabilitiesTypes[\"Screenshot\"] = \"screenshot\";\r\n    IUxSchemaAdditionalCapabilitiesTypes[\"Diagnostics\"] = \"diagnostics\";\r\n})(IUxSchemaAdditionalCapabilitiesTypes = exports.IUxSchemaAdditionalCapabilitiesTypes || (exports.IUxSchemaAdditionalCapabilitiesTypes = {}));\r\n", "\"use strict\";\r\nvar _a;\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.SurveyRestrictions = exports.MAX_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS = exports.MIN_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS = exports.MAX_VERTICAL_OPTIONS_LIKERT_QUESTIONS = exports.MIN_VERTICAL_OPTIONS_LIKERT_QUESTIONS = exports.MAX_OPTIONS_NON_LIKERT_QUESTIONS = exports.MIN_OPTIONS_NON_LIKERT_QUESTIONS = void 0;\r\nvar ISurvey_1 = require(\"../../../Api/ISurvey\");\r\nexports.MIN_OPTIONS_NON_LIKERT_QUESTIONS = 2;\r\nexports.MAX_OPTIONS_NON_LIKERT_QUESTIONS = 11;\r\nexports.MIN_VERTICAL_OPTIONS_LIKERT_QUESTIONS = 2;\r\nexports.MAX_VERTICAL_OPTIONS_LIKERT_QUESTIONS = 7;\r\nexports.MIN_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS = 1;\r\nexports.MAX_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS = 10;\r\nexports.SurveyRestrictions = (_a = {},\r\n    _a[ISurvey_1.SurveyType.Fps] = { MinNumberOfPages: 2, AllowedFirstTemplateIds: [\r\n            \"0e19ac6f-d831-499c-9e83-a709e27784b6\",\r\n            '51e6db44-1070-45e6-be30-8c14a5b9e55a'\r\n        ] },\r\n    _a);\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__exportStar(require(\"./IUxSchema\"), exports);\r\n__exportStar(require(\"./IQuestion\"), exports);\r\n__exportStar(require(\"./IBranchingRules\"), exports);\r\n__exportStar(require(\"./IUxSchemaAdditionalCapabilities\"), exports);\r\n__exportStar(require(\"./Validation/SurveyRestrictions\"), exports);\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.ICampaignDefinitions = void 0;\r\nvar ICampaignDefinitions = (function () {\r\n    function ICampaignDefinitions() {\r\n    }\r\n    return ICampaignDefinitions;\r\n}());\r\nexports.ICampaignDefinitions = ICampaignDefinitions;\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.GovernedChannelType = void 0;\r\nvar GovernedChannelType;\r\n(function (GovernedChannelType) {\r\n    GovernedChannelType[GovernedChannelType[\"Standard\"] = 0] = \"Standard\";\r\n    GovernedChannelType[GovernedChannelType[\"Urgent\"] = 1] = \"Urgent\";\r\n    GovernedChannelType[GovernedChannelType[\"Banner\"] = 2] = \"Banner\";\r\n    GovernedChannelType[GovernedChannelType[\"TeachingMessage\"] = 3] = \"TeachingMessage\";\r\n    GovernedChannelType[GovernedChannelType[\"BusinessBar\"] = 4] = \"BusinessBar\";\r\n    GovernedChannelType[GovernedChannelType[\"Dialog\"] = 8] = \"Dialog\";\r\n})(GovernedChannelType = exports.GovernedChannelType || (exports.GovernedChannelType = {}));\r\n(function (GovernedChannelType) {\r\n    function getDefault() { return GovernedChannelType.Standard; }\r\n    GovernedChannelType.getDefault = getDefault;\r\n})(GovernedChannelType = exports.GovernedChannelType || (exports.GovernedChannelType = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.IFloodgateHostPlatform = void 0;\r\nvar IFloodgateHostPlatform;\r\n(function (IFloodgateHostPlatform) {\r\n    IFloodgateHostPlatform[\"Web\"] = \"Web\";\r\n    IFloodgateHostPlatform[\"Android\"] = \"Android\";\r\n    IFloodgateHostPlatform[\"Win32\"] = \"Win32\";\r\n    IFloodgateHostPlatform[\"iOS\"] = \"iOS\";\r\n})(IFloodgateHostPlatform = exports.IFloodgateHostPlatform || (exports.IFloodgateHostPlatform = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.AlignmentType = void 0;\r\nvar AlignmentType;\r\n(function (AlignmentType) {\r\n    AlignmentType[AlignmentType[\"Left\"] = 0] = \"Left\";\r\n    AlignmentType[AlignmentType[\"Right\"] = 1] = \"Right\";\r\n})(AlignmentType = exports.AlignmentType || (exports.AlignmentType = {}));\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.AuthenticationType = void 0;\r\nvar AuthenticationType;\r\n(function (AuthenticationType) {\r\n    AuthenticationType[AuthenticationType[\"MSA\"] = 0] = \"MSA\";\r\n    AuthenticationType[AuthenticationType[\"AAD\"] = 1] = \"AAD\";\r\n    AuthenticationType[AuthenticationType[\"Unauthenticated\"] = 2] = \"Unauthenticated\";\r\n})(AuthenticationType = exports.AuthenticationType || (exports.AuthenticationType = {}));\r\n", "\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.IFloodgateHostPlatform = exports.GovernedChannelType = exports.ICampaignDefinitions = exports.Api = void 0;\r\n__exportStar(require(\"./src/Core/Api\"), exports);\r\nexports.Api = require(\"./src/Core/Api\");\r\n__exportStar(require(\"./src/Core/ISurveyInfo\"), exports);\r\n__exportStar(require(\"./src/Core/ISurveyEvent\"), exports);\r\n__exportStar(require(\"./src/Core/Campaign/UxSchema\"), exports);\r\nvar CampaignDefinitions_1 = require(\"./src/Core/Governance/CampaignDefinitions\");\r\nObject.defineProperty(exports, \"ICampaignDefinitions\", { enumerable: true, get: function () { return CampaignDefinitions_1.ICampaignDefinitions; } });\r\nvar GovernedChannel_1 = require(\"./src/Core/Governance/GovernedChannel\");\r\nObject.defineProperty(exports, \"GovernedChannelType\", { enumerable: true, get: function () { return GovernedChannel_1.GovernedChannelType; } });\r\n__exportStar(require(\"./src/Core/DynamicUx/IDynamicUxCommonInitOptions\"), exports);\r\nvar IFloodgateHostPlatform_1 = require(\"./src/Core/DynamicUx/IFloodgateHostPlatform\");\r\nObject.defineProperty(exports, \"IFloodgateHostPlatform\", { enumerable: true, get: function () { return IFloodgateHostPlatform_1.IFloodgateHostPlatform; } });\r\n__exportStar(require(\"./src/Core/DynamicUx/AlignmentType\"), exports);\r\n__exportStar(require(\"./src/Core/DynamicUx/ISurveyCSSParams\"), exports);\r\n__exportStar(require(\"./src/Core/Petrol/ManifestType\"), exports);\r\n", "\"use strict\";\r\n/**\r\n * SyncTasks.ts\r\n * Author: David de Regt\r\n * Copyright: Microsoft 2015\r\n *\r\n * A very simple promise library that resolves all promises synchronously instead of\r\n * kicking them back to the main ticking thread.  This affirmatively rejects the A+\r\n * standard for promises, and is used for a combination of performance (wrapping\r\n * things back to the main thread is really slow) and because indexeddb loses\r\n * context for its calls if you send them around the event loop and transactions\r\n * automatically close.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.config = {\r\n    // If we catch exceptions in success/fail blocks, it silently falls back to the fail case of the outer promise.\r\n    // If this is global variable is true, it will also spit out a console.error with the exception for debugging.\r\n    exceptionsToConsole: true,\r\n    // Whether or not to actually attempt to catch exceptions with try/catch blocks inside the resolution cases.\r\n    // Disable this for debugging when you'd rather the debugger caught the exception synchronously rather than\r\n    // digging through a stack trace.\r\n    catchExceptions: true,\r\n    // Use this option in order to debug double resolution asserts locally.\r\n    // Enabling this option in the release would have a negative impact on the application performance.\r\n    traceEnabled: false,\r\n    exceptionHandler: undefined,\r\n    // If an ErrorFunc is not added to the task (then, catch, always) before the task rejects or synchonously\r\n    // after that, then this function is called with the error. Default throws the error.\r\n    unhandledErrorHandler: (function (err) { throw err; })\r\n};\r\nfunction fromThenable(thenable) {\r\n    var deferred = Defer();\r\n    // NOTE: The {} around the error handling is critical to ensure that\r\n    // we do not trigger \"Possible unhandled rejection\" warnings. By adding\r\n    // the braces, the error handler rejects the outer promise, but returns\r\n    // void. If we remove the braces, it would *also* return something which\r\n    // would be unhandled\r\n    thenable.then(function (value) { deferred.resolve(value); }, function (err) { deferred.reject(err); });\r\n    // Force async before this promise resolves to prevent ES6 promises from catching thrown exceptions downstream\r\n    return deferred.promise().thenAsync(function (x) { return x; });\r\n}\r\nexports.fromThenable = fromThenable;\r\nfunction isThenable(object) {\r\n    return object !== null && object !== void 0 && typeof object.then === 'function';\r\n}\r\nfunction isCancelable(object) {\r\n    return object !== null && object !== void 0 && typeof object.cancel === 'function';\r\n}\r\n// Runs trier(). If config.catchExceptions is set then any exception is caught and handed to catcher.\r\nfunction run(trier, catcher) {\r\n    if (exports.config.catchExceptions) {\r\n        // Any try/catch/finally block in a function makes the entire function ineligible for optimization is most JS engines.\r\n        // Make sure this stays in a small/quick function, or break out into its own function.\r\n        try {\r\n            return trier();\r\n        }\r\n        catch (e) {\r\n            return catcher(e);\r\n        }\r\n    }\r\n    else {\r\n        return trier();\r\n    }\r\n}\r\nvar asyncCallbacks = [];\r\n// Ideally, we use setImmediate, but that's only supported on some environments.\r\n// Suggestion: Use the \"setimmediate\" NPM package to polyfill where it's not available.\r\nvar useSetImmediate = typeof setImmediate !== 'undefined';\r\n/**\r\n * This function will defer callback of the specified callback lambda until the next JS tick, simulating standard A+ promise behavior\r\n */\r\nfunction asyncCallback(callback) {\r\n    asyncCallbacks.push(callback);\r\n    if (asyncCallbacks.length === 1) {\r\n        // Start a callback for the next tick\r\n        if (useSetImmediate) {\r\n            setImmediate(resolveAsyncCallbacks);\r\n        }\r\n        else {\r\n            setTimeout(resolveAsyncCallbacks, 0);\r\n        }\r\n    }\r\n}\r\nexports.asyncCallback = asyncCallback;\r\nfunction resolveAsyncCallbacks() {\r\n    var savedCallbacks = asyncCallbacks;\r\n    asyncCallbacks = [];\r\n    for (var i = 0; i < savedCallbacks.length; i++) {\r\n        savedCallbacks[i]();\r\n    }\r\n}\r\nvar Internal;\r\n(function (Internal) {\r\n    var SyncTask = /** @class */ (function () {\r\n        function SyncTask() {\r\n            this._completedSuccess = false;\r\n            this._completedFail = false;\r\n            this._traceEnabled = false;\r\n            this._cancelCallbacks = [];\r\n            this._wasCanceled = false;\r\n            // The owner of this promise should not call cancel twice. However, cancellation through bubbling is independent of this.\r\n            this._wasExplicitlyCanceled = false;\r\n            this._resolving = false;\r\n            this._storedCallbackSets = [];\r\n            // 'Handled' just means there was a callback set added.\r\n            // Note: If that callback does not handle the error then that callback's task will be 'unhandled' instead of this one.\r\n            this._mustHandleError = true;\r\n        }\r\n        SyncTask.prototype._addCallbackSet = function (set, callbackWillChain) {\r\n            var _this = this;\r\n            var task = new SyncTask();\r\n            task.onCancel(function (context) {\r\n                set.wasCanceled = true;\r\n                set.cancelContext = context;\r\n                // Note: Cancel due to bubbling should not throw if the public cancel is called before/after.\r\n                _this._cancelInternal(context);\r\n            });\r\n            set.task = task;\r\n            this._storedCallbackSets.push(set);\r\n            if (callbackWillChain) {\r\n                // The callback inherits responsibility for \"handling\" errors.\r\n                this._mustHandleError = false;\r\n            }\r\n            else {\r\n                // The callback can never \"handle\" errors since nothing can chain to it.\r\n                task._mustHandleError = false;\r\n            }\r\n            // The _resolve* functions handle callbacks being added while they are running.\r\n            if (!this._resolving) {\r\n                if (this._completedSuccess) {\r\n                    this._resolveSuccesses();\r\n                }\r\n                else if (this._completedFail) {\r\n                    this._resolveFailures();\r\n                }\r\n            }\r\n            return task.promise();\r\n        };\r\n        SyncTask.prototype.onCancel = function (callback) {\r\n            // Only register cancel callback handler on promise that hasn't been completed\r\n            if (!this._completedSuccess && !this._completedFail) {\r\n                if (this._wasCanceled) {\r\n                    callback(this._cancelContext);\r\n                }\r\n                else {\r\n                    this._cancelCallbacks.push(callback);\r\n                }\r\n            }\r\n            return this;\r\n        };\r\n        SyncTask.prototype.then = function (successFunc, errorFunc) {\r\n            return this._addCallbackSet({\r\n                successFunc: successFunc,\r\n                failFunc: errorFunc\r\n            }, true);\r\n        };\r\n        SyncTask.prototype.thenAsync = function (successFunc, errorFunc) {\r\n            return this._addCallbackSet({\r\n                successFunc: successFunc,\r\n                failFunc: errorFunc,\r\n                asyncCallback: true\r\n            }, true);\r\n        };\r\n        SyncTask.prototype.catch = function (errorFunc) {\r\n            return this._addCallbackSet({\r\n                failFunc: errorFunc\r\n            }, true);\r\n        };\r\n        SyncTask.prototype.always = function (func) {\r\n            return this._addCallbackSet({\r\n                successFunc: func,\r\n                failFunc: func\r\n            }, true);\r\n        };\r\n        SyncTask.prototype.setTracingEnabled = function (enabled) {\r\n            this._traceEnabled = enabled;\r\n            return this;\r\n        };\r\n        // Finally should let you inspect the value of the promise as it passes through without affecting the then chaining\r\n        // i.e. a failed promise with a finally after it should then chain to the fail case of the next then\r\n        SyncTask.prototype.finally = function (func) {\r\n            this._addCallbackSet({\r\n                successFunc: func,\r\n                failFunc: func\r\n            }, false);\r\n            return this;\r\n        };\r\n        SyncTask.prototype.done = function (successFunc) {\r\n            this._addCallbackSet({\r\n                successFunc: successFunc\r\n            }, false);\r\n            return this;\r\n        };\r\n        SyncTask.prototype.fail = function (errorFunc) {\r\n            this._addCallbackSet({\r\n                failFunc: errorFunc\r\n            }, false);\r\n            return this;\r\n        };\r\n        SyncTask.prototype.resolve = function (obj) {\r\n            this._checkState(true);\r\n            this._completedSuccess = true;\r\n            this._storedResolution = obj;\r\n            // Cannot cancel resolved promise - nuke chain\r\n            this._cancelCallbacks = [];\r\n            this._resolveSuccesses();\r\n            return this;\r\n        };\r\n        SyncTask.prototype.reject = function (obj) {\r\n            this._checkState(false);\r\n            this._completedFail = true;\r\n            this._storedErrResolution = obj;\r\n            // Cannot cancel resolved promise - nuke chain\r\n            this._cancelCallbacks = [];\r\n            this._resolveFailures();\r\n            SyncTask._enforceErrorHandled(this);\r\n            return this;\r\n        };\r\n        SyncTask.prototype._checkState = function (resolve) {\r\n            if (this._completedSuccess || this._completedFail) {\r\n                if (this._completeStack) {\r\n                    console.error(this._completeStack.message, this._completeStack.stack);\r\n                }\r\n                var message = 'Failed to ' + (resolve ? 'resolve' : 'reject') +\r\n                    ': the task is already ' + (this._completedSuccess ? 'resolved' : 'rejected');\r\n                throw new Error(message);\r\n            }\r\n            if (exports.config.traceEnabled || this._traceEnabled) {\r\n                this._completeStack = new Error('Initial ' + resolve ? 'resolve' : 'reject');\r\n            }\r\n        };\r\n        // Make sure any rejected task has its failured handled.\r\n        SyncTask._enforceErrorHandled = function (task) {\r\n            if (!task._mustHandleError) {\r\n                return;\r\n            }\r\n            SyncTask._rejectedTasks.push(task);\r\n            // Wait for some async time in the future to check these tasks.\r\n            if (!SyncTask._enforceErrorHandledTimer) {\r\n                SyncTask._enforceErrorHandledTimer = setTimeout(function () {\r\n                    SyncTask._enforceErrorHandledTimer = undefined;\r\n                    var rejectedTasks = SyncTask._rejectedTasks;\r\n                    SyncTask._rejectedTasks = [];\r\n                    rejectedTasks.forEach(function (rejectedTask, i) {\r\n                        if (rejectedTask._mustHandleError) {\r\n                            // Unhandled!\r\n                            exports.config.unhandledErrorHandler(rejectedTask._storedErrResolution);\r\n                        }\r\n                    });\r\n                }, 0);\r\n            }\r\n        };\r\n        SyncTask.prototype.cancel = function (context) {\r\n            if (this._wasExplicitlyCanceled) {\r\n                throw new Error('Already Canceled');\r\n            }\r\n            this._wasExplicitlyCanceled = true;\r\n            this._cancelInternal(context);\r\n        };\r\n        SyncTask.prototype._cancelInternal = function (context) {\r\n            var _this = this;\r\n            if (this._wasCanceled) {\r\n                return;\r\n            }\r\n            this._wasCanceled = true;\r\n            this._cancelContext = context;\r\n            var callbacks = this._cancelCallbacks;\r\n            this._cancelCallbacks = [];\r\n            if (callbacks.length > 0) {\r\n                callbacks.forEach(function (callback) {\r\n                    if (!_this._completedSuccess && !_this._completedFail) {\r\n                        callback(_this._cancelContext);\r\n                    }\r\n                });\r\n            }\r\n        };\r\n        SyncTask.cancelOtherInternal = function (promise, context) {\r\n            // Warning: this cast is a bit dirty, but we need to avoid .cancel for SyncTasks.\r\n            // Note: Cancel due to bubbling should not throw if the public cancel is called before/after.\r\n            var task = promise;\r\n            if (task._storedCallbackSets && task._cancelInternal) {\r\n                // Is probably a SyncTask.\r\n                task._cancelInternal(context);\r\n            }\r\n            else {\r\n                promise.cancel(context);\r\n            }\r\n        };\r\n        SyncTask.prototype.promise = function () {\r\n            return this;\r\n        };\r\n        SyncTask.prototype._resolveSuccesses = function () {\r\n            var _this = this;\r\n            this._resolving = true;\r\n            // New callbacks can be added as the current callbacks run: use a loop to get through all of them.\r\n            while (this._storedCallbackSets.length) {\r\n                // Only iterate over the current list of callbacks.\r\n                var callbacks = this._storedCallbackSets;\r\n                this._storedCallbackSets = [];\r\n                callbacks.forEach(function (callback) {\r\n                    if (callback.asyncCallback) {\r\n                        asyncCallback(function () { return _this._resolveSuccessCallback(callback); });\r\n                    }\r\n                    else {\r\n                        _this._resolveSuccessCallback(callback);\r\n                    }\r\n                });\r\n            }\r\n            this._resolving = false;\r\n        };\r\n        SyncTask.prototype._resolveSuccessCallback = function (callback) {\r\n            var _this = this;\r\n            if (callback.successFunc) {\r\n                run(function () {\r\n                    var ret = callback.successFunc(_this._storedResolution);\r\n                    if (isCancelable(ret)) {\r\n                        if (callback.wasCanceled) {\r\n                            SyncTask.cancelOtherInternal(ret, callback.cancelContext);\r\n                        }\r\n                        else {\r\n                            callback.task.onCancel(function (context) { return SyncTask.cancelOtherInternal(ret, context); });\r\n                        }\r\n                        // Note: don't care if ret is canceled. We don't need to bubble out since this is already resolved.\r\n                    }\r\n                    if (isThenable(ret)) {\r\n                        // The success block of a then returned a new promise, so\r\n                        ret.then(function (r) { callback.task.resolve(r); }, function (e) { callback.task.reject(e); });\r\n                    }\r\n                    else {\r\n                        callback.task.resolve(ret);\r\n                    }\r\n                }, function (e) {\r\n                    _this._handleException(e, 'SyncTask caught exception in success block: ' + e.toString());\r\n                    callback.task.reject(e);\r\n                });\r\n            }\r\n            else {\r\n                callback.task.resolve(this._storedResolution);\r\n            }\r\n        };\r\n        SyncTask.prototype._resolveFailures = function () {\r\n            var _this = this;\r\n            this._resolving = true;\r\n            // New callbacks can be added as the current callbacks run: use a loop to get through all of them.\r\n            while (this._storedCallbackSets.length) {\r\n                // Only iterate over the current list of callbacks.\r\n                var callbacks = this._storedCallbackSets;\r\n                this._storedCallbackSets = [];\r\n                callbacks.forEach(function (callback) {\r\n                    if (callback.asyncCallback) {\r\n                        asyncCallback(function () { return _this._resolveFailureCallback(callback); });\r\n                    }\r\n                    else {\r\n                        _this._resolveFailureCallback(callback);\r\n                    }\r\n                });\r\n            }\r\n            this._resolving = false;\r\n        };\r\n        SyncTask.prototype._resolveFailureCallback = function (callback) {\r\n            var _this = this;\r\n            if (callback.failFunc) {\r\n                run(function () {\r\n                    var ret = callback.failFunc(_this._storedErrResolution);\r\n                    if (isCancelable(ret)) {\r\n                        if (callback.wasCanceled) {\r\n                            SyncTask.cancelOtherInternal(ret, callback.cancelContext);\r\n                        }\r\n                        else {\r\n                            callback.task.onCancel(function (context) { return SyncTask.cancelOtherInternal(ret, context); });\r\n                        }\r\n                        // Note: don't care if ret is canceled. We don't need to bubble out since this is already rejected.\r\n                    }\r\n                    if (isThenable(ret)) {\r\n                        ret.then(function (r) { callback.task.resolve(r); }, function (e) { callback.task.reject(e); });\r\n                    }\r\n                    else {\r\n                        // The failure has been handled: ret is the resolved value.\r\n                        callback.task.resolve(ret);\r\n                    }\r\n                }, function (e) {\r\n                    _this._handleException(e, 'SyncTask caught exception in failure block: ' + e.toString());\r\n                    callback.task.reject(e);\r\n                });\r\n            }\r\n            else {\r\n                callback.task.reject(this._storedErrResolution);\r\n            }\r\n        };\r\n        SyncTask.prototype._handleException = function (e, message) {\r\n            if (exports.config.exceptionsToConsole) {\r\n                console.error(message);\r\n            }\r\n            if (exports.config.exceptionHandler) {\r\n                exports.config.exceptionHandler(e);\r\n            }\r\n        };\r\n        SyncTask.prototype.toEs6Promise = function () {\r\n            var _this = this;\r\n            return new Promise(function (resolve, reject) { return _this.then(resolve, reject); });\r\n        };\r\n        SyncTask._rejectedTasks = [];\r\n        return SyncTask;\r\n    }());\r\n    Internal.SyncTask = SyncTask;\r\n})(Internal || (Internal = {}));\r\nfunction all(items) {\r\n    if (items.length === 0) {\r\n        return Resolved([]);\r\n    }\r\n    var outTask = Defer();\r\n    var countRemaining = items.length;\r\n    var foundError;\r\n    var results = Array(items.length);\r\n    outTask.onCancel(function (val) {\r\n        items.forEach(function (item) {\r\n            if (isCancelable(item)) {\r\n                Internal.SyncTask.cancelOtherInternal(item, val);\r\n            }\r\n        });\r\n    });\r\n    var checkFinish = function () {\r\n        if (--countRemaining === 0) {\r\n            if (foundError !== undefined) {\r\n                outTask.reject(foundError);\r\n            }\r\n            else {\r\n                outTask.resolve(results);\r\n            }\r\n        }\r\n    };\r\n    items.forEach(function (item, index) {\r\n        if (isThenable(item)) {\r\n            var task = item;\r\n            task.then(function (res) {\r\n                results[index] = res;\r\n                checkFinish();\r\n            }, function (err) {\r\n                if (foundError === undefined) {\r\n                    foundError = (err !== undefined) ? err : true;\r\n                }\r\n                checkFinish();\r\n            });\r\n        }\r\n        else {\r\n            // Not a task, so resolve directly with the item\r\n            results[index] = item;\r\n            checkFinish();\r\n        }\r\n    });\r\n    return outTask.promise();\r\n}\r\nexports.all = all;\r\nfunction Defer() {\r\n    return new Internal.SyncTask();\r\n}\r\nexports.Defer = Defer;\r\nfunction Resolved(val) {\r\n    return new Internal.SyncTask().resolve(val).promise();\r\n}\r\nexports.Resolved = Resolved;\r\nfunction Rejected(val) {\r\n    return new Internal.SyncTask().reject(val).promise();\r\n}\r\nexports.Rejected = Rejected;\r\nfunction race(items) {\r\n    var outTask = Defer();\r\n    var hasSettled = false;\r\n    outTask.onCancel(function (val) {\r\n        items.forEach(function (item) {\r\n            if (isCancelable(item)) {\r\n                Internal.SyncTask.cancelOtherInternal(item, val);\r\n            }\r\n        });\r\n    });\r\n    items.forEach(function (item) {\r\n        if (isThenable(item)) {\r\n            var task = item;\r\n            task.then(function (res) {\r\n                if (!hasSettled) {\r\n                    hasSettled = true;\r\n                    outTask.resolve(res);\r\n                }\r\n            }, function (err) {\r\n                if (!hasSettled) {\r\n                    hasSettled = true;\r\n                    outTask.reject(err);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            // Not a task, so resolve directly with the item\r\n            if (!hasSettled) {\r\n                hasSettled = true;\r\n                outTask.resolve(item);\r\n            }\r\n        }\r\n    });\r\n    return outTask.promise();\r\n}\r\nexports.race = race;\r\nfunction raceTimer(promise, timeMs) {\r\n    var timerDef = Defer();\r\n    var token = setTimeout(function () {\r\n        timerDef.resolve({ timedOut: true });\r\n    }, timeMs);\r\n    var adaptedPromise = promise.then(function (resp) {\r\n        clearTimeout(token);\r\n        return { timedOut: false, result: resp };\r\n    });\r\n    return race([adaptedPromise, timerDef.promise()]);\r\n}\r\nexports.raceTimer = raceTimer;\r\n", "\"use strict\";\n/**\n * SubscribableEvent.ts\n *\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT license.\n *\n * A simple strongly-typed pub/sub/fire eventing system.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SubscriptionToken = /** @class */ (function () {\n    function SubscriptionToken(_event, _callback) {\n        this._event = _event;\n        this._callback = _callback;\n    }\n    SubscriptionToken.prototype.unsubscribe = function () {\n        this._event.unsubscribe(this._callback);\n    };\n    return SubscriptionToken;\n}());\nexports.SubscriptionToken = SubscriptionToken;\nvar SubscribableEvent = /** @class */ (function () {\n    // By default, SubscribableEvent will fire to all subscribers regardless of any conditions.\n    // If you enable allowStopPropagation, then a subscription callback can return a truthy response and it will halt further callbacks.\n    function SubscribableEvent(_allowStopPropagation) {\n        if (_allowStopPropagation === void 0) { _allowStopPropagation = false; }\n        var _this = this;\n        this._allowStopPropagation = _allowStopPropagation;\n        this.fire = (function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            // Keep reference to the original readonly array. We don't want to have it change while we're firing\n            var subs = _this._subscribers;\n            // Execute handlers in the reverse order in which they were registered.\n            for (var i = subs.length - 1; i >= 0; i--) {\n                var ret = subs[i].apply(null, args);\n                if (_this._allowStopPropagation && !!ret) {\n                    // If the value was handled, early out.\n                    return true;\n                }\n            }\n            return false;\n        });\n        this._subscribers = [];\n    }\n    SubscribableEvent.prototype.dispose = function () {\n        this._subscribers = [];\n    };\n    SubscribableEvent.prototype.subscribe = function (callback) {\n        this._subscribers = this._subscribers.concat(callback);\n        return new SubscriptionToken(this, callback);\n    };\n    SubscribableEvent.prototype.unsubscribe = function (callback) {\n        this._subscribers = this._subscribers.filter(function (value) { return value !== callback; });\n    };\n    return SubscribableEvent;\n}());\nexports.default = SubscribableEvent;\n", "\"use strict\";\r\n/**\r\n* AllowBackgroundFetchData.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Holder for information if background fetch is allowed\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SyncTasks = require(\"synctasks\");\r\nvar AllowBackgroundFetchData = /** @class */ (function () {\r\n    function AllowBackgroundFetchData() {\r\n        this._isAllowed = false;\r\n    }\r\n    AllowBackgroundFetchData.prototype.putBackgroundFetchAllowed = function (isAllowed) {\r\n        this._isAllowed = isAllowed;\r\n        if (this.isBackgroundFetchAllowed() && this._isAllowedDeferral) {\r\n            var deferral = this._isAllowedDeferral;\r\n            this._isAllowedDeferral = undefined;\r\n            deferral.resolve(void 0);\r\n        }\r\n    };\r\n    AllowBackgroundFetchData.prototype.isBackgroundFetchAllowed = function () {\r\n        return this._isAllowed;\r\n    };\r\n    AllowBackgroundFetchData.prototype.waitForBackgroundFetchAllowed = function () {\r\n        if (this.isBackgroundFetchAllowed()) {\r\n            return SyncTasks.Resolved();\r\n        }\r\n        // Set up deferral to wait until background fetch is allowed\r\n        if (!this._isAllowedDeferral) {\r\n            this._isAllowedDeferral = SyncTasks.Defer();\r\n        }\r\n        return this._isAllowedDeferral.promise();\r\n    };\r\n    return AllowBackgroundFetchData;\r\n}());\r\nexports.default = AllowBackgroundFetchData;\r\n", "\"use strict\";\r\n/**\r\n* AppActiveData.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Holder for App Active (foreground/background) information\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar SyncTasks = require(\"synctasks\");\r\nvar AppActiveData = /** @class */ (function () {\r\n    function AppActiveData() {\r\n        this._isActive = false;\r\n    }\r\n    AppActiveData.prototype.putAppActive = function (isActive) {\r\n        this._isActive = isActive;\r\n        if (this.isAppActive() && this._appActiveDeferral) {\r\n            var deferral = this._appActiveDeferral;\r\n            this._appActiveDeferral = undefined;\r\n            deferral.resolve(void 0);\r\n        }\r\n    };\r\n    AppActiveData.prototype.isAppActive = function () {\r\n        return this._isActive;\r\n    };\r\n    AppActiveData.prototype.waitForAppActive = function () {\r\n        if (this.isAppActive()) {\r\n            return SyncTasks.Resolved();\r\n        }\r\n        // Set up deferral to wait for app to become active\r\n        if (!this._appActiveDeferral) {\r\n            this._appActiveDeferral = SyncTasks.Defer();\r\n        }\r\n        return this._appActiveDeferral.promise();\r\n    };\r\n    return AppActiveData;\r\n}());\r\nexports.default = AppActiveData;\r\n", "\"use strict\";\r\n/**\r\n* Models.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* ECS models\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EcsConfigType;\r\n(function (EcsConfigType) {\r\n    EcsConfigType[EcsConfigType[\"Default\"] = 0] = \"Default\";\r\n    EcsConfigType[EcsConfigType[\"User\"] = 1] = \"User\";\r\n})(EcsConfigType = exports.EcsConfigType || (exports.EcsConfigType = {}));\r\n", "\"use strict\";\r\n/**\r\n* Cache.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* ECS data cache\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscribableevent_1 = require(\"subscribableevent\");\r\nvar SyncTasks = require(\"synctasks\");\r\nvar Models_1 = require(\"./Models\");\r\nvar Cache = /** @class */ (function () {\r\n    function Cache(_config) {\r\n        this._config = _config;\r\n        this.configUpdated = new subscribableevent_1.default();\r\n        this._cachedConfigs = {};\r\n        // noop\r\n    }\r\n    Cache.prototype.initialize = function () {\r\n        return this.updateConfigsToFetch();\r\n    };\r\n    Cache.prototype.updateConfigsToFetch = function () {\r\n        var _this = this;\r\n        var _a = this._config.getConfig(), databaseInterface = _a.databaseInterface, configsToFetch = _a.configsToFetch;\r\n        // If we don't have DB support, we can't pre-populate any cache\r\n        if (!databaseInterface) {\r\n            return SyncTasks.Resolved();\r\n        }\r\n        var dbFetchPromises = [];\r\n        var _loop_1 = function (configType) {\r\n            // If we've already retrieved from the cache, don't fetch again\r\n            if (this_1._cachedConfigs[configType]) {\r\n                return \"continue\";\r\n            }\r\n            dbFetchPromises.push(databaseInterface.getData(configType).then(function (ecsConfig) {\r\n                if (ecsConfig) {\r\n                    _this._cachedConfigs[configType] = ecsConfig;\r\n                }\r\n            }).catch(function () {\r\n                // Return resolved no matter what happens\r\n                return SyncTasks.Resolved();\r\n            }));\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, configsToFetch_1 = configsToFetch; _i < configsToFetch_1.length; _i++) {\r\n            var configType = configsToFetch_1[_i];\r\n            _loop_1(configType);\r\n        }\r\n        return SyncTasks.all(dbFetchPromises).then(function () {\r\n            // If we fetched 1 or more configs, trigger a change\r\n            if (dbFetchPromises.length > 0) {\r\n                _this.configUpdated.fire();\r\n            }\r\n        });\r\n    };\r\n    Cache.prototype.getEcsConfig = function () {\r\n        // Try user, then fallback to default\r\n        return (this._cachedConfigs[Models_1.EcsConfigType.User] || this._cachedConfigs[Models_1.EcsConfigType.Default]);\r\n    };\r\n    Cache.prototype.getEcsConfigByType = function (configType) {\r\n        return this._cachedConfigs[configType];\r\n    };\r\n    Cache.prototype.putConfig = function (ecsConfig) {\r\n        // Store the config that we used before putting\r\n        var oldEcsConfig = this.getEcsConfig();\r\n        // Store new config\r\n        this._cachedConfigs[ecsConfig.configType] = ecsConfig;\r\n        var currentEcsConfig = this.getEcsConfig();\r\n        // Only notify if the config of the same type changed or we've changed config types\r\n        if (currentEcsConfig && currentEcsConfig.configType === ecsConfig.configType ||\r\n            (oldEcsConfig && currentEcsConfig && oldEcsConfig.configType !== currentEcsConfig.configType)) {\r\n            this.configUpdated.fire();\r\n        }\r\n        var databaseInterface = this._config.getConfig().databaseInterface;\r\n        // If we don't have DB support, we can't pre-populate any cache\r\n        if (!databaseInterface) {\r\n            return SyncTasks.Resolved();\r\n        }\r\n        return databaseInterface.putData(ecsConfig.configType, ecsConfig);\r\n    };\r\n    return Cache;\r\n}());\r\nexports.default = Cache;\r\n", "\"use strict\";\r\n/**\r\n* Config.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* ECS global configuration\r\n*/\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Config = /** @class */ (function () {\r\n    function Config() {\r\n    }\r\n    Config.prototype.initialize = function (config) {\r\n        if (this._config) {\r\n            throw new Error('ECS Configuration already initialized');\r\n        }\r\n        this._config = config;\r\n    };\r\n    Config.prototype.getConfig = function () {\r\n        if (!this._config) {\r\n            throw new Error('ECS Configuration not yet initialized');\r\n        }\r\n        return this._config;\r\n    };\r\n    Config.prototype.setConfigsToFetch = function (configsToFetch) {\r\n        // Create a new config object since it's fully read-only\r\n        if (!this._config) {\r\n            throw new Error('ECS Configuration not yet initialized');\r\n        }\r\n        this._config = __assign(__assign({}, this._config), { configsToFetch: configsToFetch });\r\n    };\r\n    Config.prototype.setFetchTimeout = function (fetchTimeout) {\r\n        // Create a new config object since it's fully read-only\r\n        if (!this._config) {\r\n            throw new Error('ECS Configuration not yet initialized');\r\n        }\r\n        this._config = __assign(__assign({}, this._config), { fetchTimeout: fetchTimeout });\r\n    };\r\n    return Config;\r\n}());\r\nexports.default = Config;\r\n", "\"use strict\";\n/**\n * utils.ts\n * Copyright: Microsoft 2019\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.assert = function (cond, message) {\n    if (!cond) {\n        throw new Error(message);\n    }\n};\nexports.isObject = function (value) { return (value !== null && typeof value === 'object'); };\nexports.isString = function (value) { return (typeof value === 'string'); };\nexports.attempt = function (func) {\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    try {\n        return func.apply(void 0, args);\n    }\n    catch (e) {\n        return new Error(e);\n    }\n};\nexports.remove = function (array, value) {\n    for (var i = array.length - 1; i >= 0; i--) {\n        if (array[i] === value) {\n            array.splice(i, 1);\n        }\n    }\n};\nexports.clone = function (value) {\n    if (Array.isArray(value)) {\n        return value.map(exports.clone);\n    }\n    if (exports.isObject(value)) {\n        return Object.keys(value)\n            .reduce(function (res, key) {\n            var _a;\n            return (__assign(__assign({}, res), (_a = {}, _a[key] = exports.clone(value[key]), _a)));\n        }, {});\n    }\n    return value;\n};\n", "\"use strict\";\n/**\n * ExponentialTime.ts\n * Author: David de Regt\n * Copyright: Microsoft 2016\n *\n * Timer to be used for exponential backoff.  Integrates jitter so as to not slam all services at the same time after backoffs.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nexports.DEFAULT_TIME_GROW_FACTOR = 2.7182818284590451;\nexports.DEFAULT_TIME_JITTER = 0.11962656472;\nvar ExponentialTime = /** @class */ (function () {\n    /**\n     * @param initialTime  multiplier of exponent\n     * @param maxTime      delays won't be greater than this\n     * @param growFactor   base of exponent\n     * @param jitterFactor\n     */\n    function ExponentialTime(_initialTime, _maxTime, _growFactor, _jitterFactor) {\n        if (_growFactor === void 0) { _growFactor = exports.DEFAULT_TIME_GROW_FACTOR; }\n        if (_jitterFactor === void 0) { _jitterFactor = exports.DEFAULT_TIME_JITTER; }\n        this._initialTime = _initialTime;\n        this._maxTime = _maxTime;\n        this._growFactor = _growFactor;\n        this._jitterFactor = _jitterFactor;\n        utils_1.assert(this._initialTime > 0, 'Initial delay must be positive');\n        utils_1.assert(this._maxTime > 0, 'Delay upper bound must be positive');\n        utils_1.assert(this._growFactor >= 0, 'Ratio must be non-negative');\n        utils_1.assert(this._jitterFactor >= 0, 'Jitter factor must be non-negative');\n        this.reset();\n    }\n    ExponentialTime.prototype.reset = function () {\n        this._incrementCount = 0;\n        // Differ from java impl -- give it some initial jitter\n        this._currentTime = Math.round(this._initialTime * (1 + Math.random() * this._jitterFactor));\n    };\n    ExponentialTime.prototype.getTime = function () {\n        return this._currentTime;\n    };\n    ExponentialTime.prototype.getIncrementCount = function () {\n        return this._incrementCount;\n    };\n    ExponentialTime.prototype.calculateNext = function () {\n        var delay = this._currentTime * this._growFactor;\n        if (delay > this._maxTime) {\n            delay = this._maxTime;\n        }\n        if (this._jitterFactor < 0.00001) {\n            this._currentTime = delay;\n        }\n        else {\n            this._currentTime = Math.round(Math.random() * delay * this._jitterFactor + delay);\n        }\n        if (this._currentTime < this._initialTime) {\n            this._currentTime = this._initialTime;\n        }\n        if (this._currentTime > this._maxTime) {\n            this._currentTime = this._maxTime;\n        }\n        this._incrementCount++;\n        return this._currentTime;\n    };\n    /**\n     * @return first call returns initialTime, next calls will return initialTime*growFactor^n + jitter\n     */\n    ExponentialTime.prototype.getTimeAndCalculateNext = function () {\n        var res = this.getTime();\n        this.calculateNext();\n        return res;\n    };\n    return ExponentialTime;\n}());\nexports.ExponentialTime = ExponentialTime;\n", "\"use strict\";\n/**\n * SimpleWebRequest.ts\n * Author: David de Regt\n * Copyright: Microsoft 2016\n *\n * Simple client for issuing web requests.\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar SyncTasks = require(\"synctasks\");\nvar utils_1 = require(\"./utils\");\nvar ExponentialTime_1 = require(\"./ExponentialTime\");\nvar WebRequestPriority;\n(function (WebRequestPriority) {\n    WebRequestPriority[WebRequestPriority[\"DontCare\"] = 0] = \"DontCare\";\n    WebRequestPriority[WebRequestPriority[\"Low\"] = 1] = \"Low\";\n    WebRequestPriority[WebRequestPriority[\"Normal\"] = 2] = \"Normal\";\n    WebRequestPriority[WebRequestPriority[\"High\"] = 3] = \"High\";\n    WebRequestPriority[WebRequestPriority[\"Critical\"] = 4] = \"Critical\";\n})(WebRequestPriority = exports.WebRequestPriority || (exports.WebRequestPriority = {}));\nvar ErrorHandlingType;\n(function (ErrorHandlingType) {\n    // Ignore retry policy, if any, and fail immediately\n    ErrorHandlingType[ErrorHandlingType[\"DoNotRetry\"] = 0] = \"DoNotRetry\";\n    // Retry immediately, without counting it as a failure (used when you've made some sort of change to the )\n    ErrorHandlingType[ErrorHandlingType[\"RetryUncountedImmediately\"] = 1] = \"RetryUncountedImmediately\";\n    // Retry with exponential backoff, but don't count it as a failure (for 429 handling)\n    ErrorHandlingType[ErrorHandlingType[\"RetryUncountedWithBackoff\"] = 2] = \"RetryUncountedWithBackoff\";\n    // Use standard retry policy (count it as a failure, exponential backoff as policy dictates)\n    ErrorHandlingType[ErrorHandlingType[\"RetryCountedWithBackoff\"] = 3] = \"RetryCountedWithBackoff\";\n    // Return this if you need to satisfy some condition before this request will retry (then call .resumeRetrying()).\n    ErrorHandlingType[ErrorHandlingType[\"PauseUntilResumed\"] = 4] = \"PauseUntilResumed\";\n})(ErrorHandlingType = exports.ErrorHandlingType || (exports.ErrorHandlingType = {}));\nfunction isJsonContentType(ct) {\n    return !!ct && ct.indexOf('application/json') === 0;\n}\nfunction isFormContentType(ct) {\n    return !!ct && ct.indexOf('application/x-www-form-urlencoded') === 0;\n}\nfunction isFormDataContentType(ct) {\n    return !!ct && ct.indexOf('multipart/form-data') === 0;\n}\nexports.DefaultOptions = {\n    priority: WebRequestPriority.Normal,\n};\nexports.SimpleWebRequestOptions = {\n    MaxSimultaneousRequests: 5,\n    HungRequestCleanupIntervalMs: 10000,\n    setTimeout: function (callback, timeoutMs) { return setTimeout(callback, timeoutMs); },\n    clearTimeout: function (id) { return clearTimeout(id); },\n};\nfunction DefaultErrorHandler(webRequest, errResp) {\n    if (errResp.canceled || !errResp.statusCode || errResp.statusCode >= 400 && errResp.statusCode < 600) {\n        // Fail canceled/0/4xx/5xx requests immediately.\n        // These are permenent failures, and shouldn't have retry logic applied to them.\n        return ErrorHandlingType.DoNotRetry;\n    }\n    // Possible transient failure -- just retry as normal with backoff.\n    return ErrorHandlingType.RetryCountedWithBackoff;\n}\nexports.DefaultErrorHandler = DefaultErrorHandler;\n// List of pending requests, sorted from most important to least important (numerically descending)\nvar requestQueue = [];\n// List of requests blocked on _blockUNtil promises\nvar blockedList = [];\n// List of executing (non-finished) requests -- only to keep track of number of requests to compare to the max\nvar executingList = [];\nvar hungRequestCleanupTimer;\n// Feature flag checkers for whether the current environment supports various types of XMLHttpRequest features\nvar onLoadErrorSupportStatus = 0 /* Unknown */;\nvar timeoutSupportStatus = 0 /* Unknown */;\nvar SimpleWebRequestBase = /** @class */ (function () {\n    function SimpleWebRequestBase(_action, _url, options, _getHeaders, _blockRequestUntil) {\n        this._action = _action;\n        this._url = _url;\n        this.options = options;\n        this._getHeaders = _getHeaders;\n        this._blockRequestUntil = _blockRequestUntil;\n        this._aborted = false;\n        this._timedOut = false;\n        this._paused = false;\n        this._created = Date.now();\n        // De-dupe result handling for two reasons so far:\n        // 1. Various platforms have bugs where they double-resolves aborted xmlhttprequests\n        // 2. Safari seems to have a bug where sometimes it double-resolves happily-completed xmlhttprequests\n        this._finishHandled = false;\n        this._retryExponentialTime = new ExponentialTime_1.ExponentialTime(1000, 300000);\n        this._options = __assign(__assign({}, exports.DefaultOptions), options);\n    }\n    SimpleWebRequestBase.prototype.getPriority = function () {\n        return this._options.priority || WebRequestPriority.DontCare;\n    };\n    SimpleWebRequestBase.checkQueueProcessing = function () {\n        var _loop_1 = function () {\n            var req = requestQueue.shift();\n            blockedList.push(req);\n            var blockPromise = (req._blockRequestUntil && req._blockRequestUntil()) || SyncTasks.Resolved();\n            blockPromise.finally(function () {\n                utils_1.remove(blockedList, req);\n            }).then(function () {\n                if (executingList.length < exports.SimpleWebRequestOptions.MaxSimultaneousRequests && !req._aborted) {\n                    executingList.push(req);\n                    SimpleWebRequest._scheduleHungRequestCleanupIfNeeded();\n                    req._fire();\n                }\n                else {\n                    req._enqueue();\n                }\n            }, function (err) {\n                // fail the request if the block promise is rejected\n                req._respond('_blockRequestUntil rejected: ' + err);\n            });\n        };\n        while (requestQueue.length > 0 && executingList.length < exports.SimpleWebRequestOptions.MaxSimultaneousRequests) {\n            _loop_1();\n        }\n    };\n    SimpleWebRequestBase._scheduleHungRequestCleanupIfNeeded = function () {\n        // Schedule a cleanup timer if needed\n        if (executingList.length > 0 && hungRequestCleanupTimer === undefined) {\n            hungRequestCleanupTimer = exports.SimpleWebRequestOptions.setTimeout(this._hungRequestCleanupTimerCallback, exports.SimpleWebRequestOptions.HungRequestCleanupIntervalMs);\n        }\n        else if (executingList.length === 0 && hungRequestCleanupTimer) {\n            exports.SimpleWebRequestOptions.clearTimeout(hungRequestCleanupTimer);\n            hungRequestCleanupTimer = undefined;\n        }\n    };\n    SimpleWebRequestBase.prototype._removeFromQueue = function () {\n        // Only pull from request queue and executing queue here - pulling from the blocked queue can result in requests\n        // being queued up multiple times if _respond fires more than once (it shouldn't, but does happen in the wild)\n        utils_1.remove(executingList, this);\n        utils_1.remove(requestQueue, this);\n    };\n    SimpleWebRequestBase.prototype._assertAndClean = function (expression, message) {\n        if (!expression) {\n            this._removeFromQueue();\n            console.error(message);\n            utils_1.assert(expression, message);\n        }\n    };\n    // TSLint thinks that this function is unused.  Silly tslint.\n    // tslint:disable-next-line\n    SimpleWebRequestBase.prototype._fire = function () {\n        var _this = this;\n        this._xhr = new XMLHttpRequest();\n        this._xhrRequestHeaders = {};\n        // xhr.open() can throw an exception for a CSP violation.\n        var openError = utils_1.attempt(function () {\n            // Apparently you're supposed to open the connection before adding events to it.  If you don't, the node.js implementation\n            // of XHR actually calls this.abort() at the start of open()...  Bad implementations, hooray.\n            _this._xhr.open(_this._action, _this._url, true);\n        });\n        if (openError) {\n            this._respond(openError.toString());\n            return;\n        }\n        if (this._options.timeout) {\n            var timeoutSupported_1 = timeoutSupportStatus;\n            // Use manual timer if we don't know about timeout support\n            if (timeoutSupported_1 !== 3 /* Supported */) {\n                this._assertAndClean(!this._requestTimeoutTimer, 'Double-fired requestTimeoutTimer');\n                this._requestTimeoutTimer = exports.SimpleWebRequestOptions.setTimeout(function () {\n                    _this._requestTimeoutTimer = undefined;\n                    _this._timedOut = true;\n                    _this.abort();\n                }, this._options.timeout);\n            }\n            // This is our first completed request. Use it for feature detection\n            if (timeoutSupported_1 === 3 /* Supported */ || timeoutSupported_1 <= 1 /* Detecting */) {\n                // timeout and ontimeout are part of the XMLHttpRequest Level 2 spec, should be supported in most modern browsers\n                this._xhr.timeout = this._options.timeout;\n                this._xhr.ontimeout = function () {\n                    timeoutSupportStatus = 3 /* Supported */;\n                    if (timeoutSupported_1 !== 3 /* Supported */) {\n                        // When this request initially fired we didn't know about support, bail & let the fallback method handle this\n                        return;\n                    }\n                    _this._timedOut = true;\n                    // Set aborted flag to match simple timer approach, which aborts the request and results in an _respond call\n                    _this._aborted = true;\n                    _this._respond('TimedOut');\n                };\n            }\n        }\n        var onLoadErrorSupported = onLoadErrorSupportStatus;\n        // Use onreadystatechange if we don't know about onload support or it onload is not supported\n        if (onLoadErrorSupported !== 3 /* Supported */) {\n            if (onLoadErrorSupported === 0 /* Unknown */) {\n                // Set global status to detecting, leave local state so we can set a timer on finish\n                onLoadErrorSupportStatus = 1 /* Detecting */;\n            }\n            this._xhr.onreadystatechange = function () {\n                if (!_this._xhr) {\n                    return;\n                }\n                if (_this._xhr.readyState === 3 && _this._options.streamingDownloadProgress && !_this._aborted) {\n                    // This callback may result in cancelling the connection, so keep that in mind with any handling after it\n                    // if we decide to stop using the return after this someday down the line.  i.e. this._xhr may be undefined\n                    // when we come back from this call.\n                    _this._options.streamingDownloadProgress(_this._xhr.responseText);\n                    return;\n                }\n                if (_this._xhr.readyState !== 4) {\n                    // Wait for it to finish\n                    return;\n                }\n                // This is the first request completed (unknown status when fired, detecting now), use it for detection\n                if (onLoadErrorSupported === 0 /* Unknown */ &&\n                    onLoadErrorSupportStatus === 1 /* Detecting */) {\n                    // If onload hasn't fired within 10 seconds of completion, detect as not supported\n                    exports.SimpleWebRequestOptions.setTimeout(function () {\n                        if (onLoadErrorSupportStatus !== 3 /* Supported */) {\n                            onLoadErrorSupportStatus = 2 /* NotSupported */;\n                        }\n                    }, 10000);\n                }\n                _this._respond();\n            };\n        }\n        else if (this._options.streamingDownloadProgress) {\n            // If we support onload and such, but have a streaming download handler, still trap the oRSC.\n            this._xhr.onreadystatechange = function () {\n                if (!_this._xhr) {\n                    return;\n                }\n                if (_this._xhr.readyState === 3 && _this._options.streamingDownloadProgress && !_this._aborted) {\n                    // This callback may result in cancelling the connection, so keep that in mind with any handling after it\n                    // if we decide to stop using the return after this someday down the line.  i.e. this._xhr may be undefined\n                    // when we come back from this call.\n                    _this._options.streamingDownloadProgress(_this._xhr.responseText);\n                }\n            };\n        }\n        if (onLoadErrorSupported !== 2 /* NotSupported */) {\n            // onLoad and onError are part of the XMLHttpRequest Level 2 spec, should be supported in most modern browsers\n            this._xhr.onload = function () {\n                onLoadErrorSupportStatus = 3 /* Supported */;\n                if (onLoadErrorSupported !== 3 /* Supported */) {\n                    // When this request initially fired we didn't know about support, bail & let the fallback method handle this\n                    return;\n                }\n                _this._respond();\n            };\n            this._xhr.onerror = function () {\n                onLoadErrorSupportStatus = 3 /* Supported */;\n                if (onLoadErrorSupported !== 3 /* Supported */) {\n                    // When this request initially fired we didn't know about support, bail & let the fallback method handle this\n                    return;\n                }\n                _this._respond();\n            };\n        }\n        this._xhr.onabort = function () {\n            // If the browser cancels us (page navigation or whatever), it sometimes calls both the readystatechange and this,\n            // so make sure we know that this is an abort.\n            _this._aborted = true;\n            _this._respond('Aborted');\n        };\n        if (this._xhr.upload && this._options.onProgress) {\n            this._xhr.upload.onprogress = this._options.onProgress;\n        }\n        var acceptType = this._options.acceptType || 'json';\n        var responseType = this._options.customResponseType || SimpleWebRequestBase._getResponseType(acceptType);\n        var responseTypeError = utils_1.attempt(function () {\n            _this._xhr.responseType = responseType;\n        });\n        if (responseTypeError) {\n            // WebKit added support for the json responseType value on 09/03/2013\n            // https://bugs.webkit.org/show_bug.cgi?id=73648.\n            // Versions of Safari prior to 7 and Android 4 Samsung borwsers are\n            // known to throw an Error when setting the value \"json\" as the response type.\n            //\n            // The json response type can be ignored if not supported, because JSON payloads\n            // are handled by mapBody anyway\n            if (responseType !== 'json') {\n                throw responseTypeError;\n            }\n        }\n        SimpleWebRequest._setRequestHeader(this._xhr, this._xhrRequestHeaders, 'Accept', SimpleWebRequestBase.mapContentType(acceptType));\n        this._xhr.withCredentials = !!this._options.withCredentials;\n        var nextHeaders = this.getRequestHeaders();\n        // check/process headers\n        var headersCheck = {};\n        Object.keys(nextHeaders).forEach(function (key) {\n            var value = nextHeaders[key];\n            var headerLower = key.toLowerCase();\n            if (headerLower === 'content-type') {\n                _this._assertAndClean(false, \"Don't set Content-Type with options.headers -- use it with the options.contentType property\");\n                return;\n            }\n            if (headerLower === 'accept') {\n                _this._assertAndClean(false, \"Don't set Accept with options.headers -- use it with the options.acceptType property\");\n                return;\n            }\n            _this._assertAndClean(!headersCheck[headerLower], \"Setting duplicate header key: \" + headersCheck[headerLower] + \" and \" + key);\n            if (value === undefined || value === null) {\n                console.warn(\"Tried to set header \\\"\" + key + \"\\\" on request with \\\"\" + value + \"\\\" value, header will be dropped\");\n                return;\n            }\n            headersCheck[headerLower] = true;\n            SimpleWebRequest._setRequestHeader(_this._xhr, _this._xhrRequestHeaders, key, value);\n        });\n        if (this._options.sendData) {\n            var contentType = SimpleWebRequestBase.mapContentType(this._options.contentType || 'json');\n            SimpleWebRequest._setRequestHeader(this._xhr, this._xhrRequestHeaders, 'Content-Type', contentType);\n            var sendData = SimpleWebRequestBase.mapBody(this._options.sendData, contentType);\n            this._xhr.send(sendData);\n        }\n        else {\n            this._xhr.send();\n        }\n    };\n    SimpleWebRequestBase._setRequestHeader = function (xhr, xhrRequestHeaders, key, val) {\n        xhr.setRequestHeader(key, val);\n        xhrRequestHeaders[key] = val;\n    };\n    SimpleWebRequestBase.mapContentType = function (contentType) {\n        if (contentType === 'json') {\n            return 'application/json';\n        }\n        else if (contentType === 'form') {\n            return 'application/x-www-form-urlencoded';\n        }\n        else {\n            return contentType;\n        }\n    };\n    SimpleWebRequestBase.mapBody = function (sendData, contentType) {\n        if (isJsonContentType(contentType)) {\n            if (!utils_1.isString(sendData)) {\n                return JSON.stringify(sendData);\n            }\n        }\n        else if (isFormContentType(contentType)) {\n            if (!utils_1.isString(sendData) && utils_1.isObject(sendData)) {\n                var params_1 = sendData;\n                return Object.keys(params_1)\n                    .map(function (param) { return encodeURIComponent(param) + (params_1[param] ? '=' + encodeURIComponent(params_1[param].toString()) : ''); })\n                    .join('&');\n            }\n        }\n        else if (isFormDataContentType(contentType)) {\n            if (utils_1.isObject(sendData)) {\n                // Note: This only works for IE10 and above.\n                var formData_1 = new FormData();\n                var params_2 = sendData;\n                Object.keys(params_2)\n                    .forEach(function (param) { return formData_1.append(param, params_2[param]); });\n                return formData_1;\n            }\n            else {\n                utils_1.assert(false, 'contentType multipart/form-data must include an object as sendData');\n            }\n        }\n        return sendData;\n    };\n    SimpleWebRequestBase.prototype.setUrl = function (newUrl) {\n        this._url = newUrl;\n    };\n    SimpleWebRequestBase.prototype.setHeader = function (key, val) {\n        if (!this._options.augmentHeaders) {\n            this._options.augmentHeaders = {};\n        }\n        if (val) {\n            this._options.augmentHeaders[key] = val;\n        }\n        else {\n            delete this._options.augmentHeaders[key];\n        }\n    };\n    SimpleWebRequestBase.prototype.getRequestHeaders = function () {\n        var headers = {};\n        if (this._getHeaders && !this._options.overrideGetHeaders && !this._options.headers) {\n            headers = __assign(__assign({}, headers), this._getHeaders());\n        }\n        if (this._options.overrideGetHeaders) {\n            headers = __assign(__assign({}, headers), this._options.overrideGetHeaders);\n        }\n        if (this._options.headers) {\n            headers = __assign(__assign({}, headers), this._options.headers);\n        }\n        if (this._options.augmentHeaders) {\n            headers = __assign(__assign({}, headers), this._options.augmentHeaders);\n        }\n        return headers;\n    };\n    SimpleWebRequestBase.prototype.getOptions = function () {\n        return utils_1.clone(this._options);\n    };\n    SimpleWebRequestBase.prototype.setPriority = function (newPriority) {\n        if (this._options.priority === newPriority) {\n            return;\n        }\n        this._options.priority = newPriority;\n        if (this._paused) {\n            return;\n        }\n        if (this._xhr) {\n            // Already fired -- wait for it to retry for the new priority to matter\n            return;\n        }\n        // Remove and re-queue\n        utils_1.remove(requestQueue, this);\n        this._enqueue();\n    };\n    SimpleWebRequestBase.prototype.resumeRetrying = function () {\n        if (!this._paused) {\n            utils_1.assert(false, 'resumeRetrying() called but not paused!');\n            return;\n        }\n        this._paused = false;\n        this._enqueue();\n    };\n    SimpleWebRequestBase.prototype._enqueue = function () {\n        var _this = this;\n        // It's possible for a request to be canceled before it's queued since onCancel fires synchronously and we set up the listener\n        // before queueing for execution\n        // An aborted request should never be queued for execution\n        if (this._aborted) {\n            return;\n        }\n        // Check if the current queues, if the request is already in there, nothing to enqueue\n        if (executingList.indexOf(this) >= 0 || blockedList.indexOf(this) >= 0 || requestQueue.indexOf(this) >= 0) {\n            return;\n        }\n        // Throw it on the queue\n        var index = requestQueue.findIndex(function (request) {\n            // find a request with the same priority, but newer\n            return (request.getPriority() === _this.getPriority() && request._created > _this._created) ||\n                // or a request with lower priority\n                (request.getPriority() < _this.getPriority());\n        });\n        if (index > -1) {\n            // add me before the found request\n            requestQueue.splice(index, 0, this);\n        }\n        else {\n            // add me at the end\n            requestQueue.push(this);\n        }\n        // See if it's time to execute it\n        SimpleWebRequestBase.checkQueueProcessing();\n    };\n    SimpleWebRequestBase._getResponseType = function (acceptType) {\n        if (acceptType === 'blob') {\n            return 'arraybuffer';\n        }\n        if (acceptType === 'text/xml' || acceptType === 'application/xml') {\n            return 'document';\n        }\n        if (acceptType === 'text/plain') {\n            return 'text';\n        }\n        return 'json';\n    };\n    SimpleWebRequestBase._hungRequestCleanupTimerCallback = function () {\n        hungRequestCleanupTimer = undefined;\n        executingList.filter(function (request) {\n            if (request._xhr && request._xhr.readyState === 4) {\n                console.warn('SimpleWebRequests found a completed XHR that hasn\\'t invoked it\\'s callback functions, manually responding');\n                return true;\n            }\n            return false;\n        }).forEach(function (request) {\n            // We need to respond outside of the initial iteration across the array since _respond mutates exeutingList\n            request._respond();\n        });\n        SimpleWebRequest._scheduleHungRequestCleanupIfNeeded();\n    };\n    return SimpleWebRequestBase;\n}());\nexports.SimpleWebRequestBase = SimpleWebRequestBase;\nvar SimpleWebRequest = /** @class */ (function (_super) {\n    __extends(SimpleWebRequest, _super);\n    function SimpleWebRequest(action, url, options, getHeaders, blockRequestUntil) {\n        return _super.call(this, action, url, options, getHeaders, blockRequestUntil) || this;\n    }\n    SimpleWebRequest.prototype.abort = function () {\n        if (this._aborted) {\n            utils_1.assert(false, 'Already aborted ' + this._action + ' request to ' + this._url);\n            return;\n        }\n        this._aborted = true;\n        if (this._retryTimer) {\n            exports.SimpleWebRequestOptions.clearTimeout(this._retryTimer);\n            this._retryTimer = undefined;\n        }\n        if (this._requestTimeoutTimer) {\n            exports.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer);\n            this._requestTimeoutTimer = undefined;\n        }\n        if (!this._deferred) {\n            utils_1.assert(false, 'Haven\\'t even fired start() yet -- can\\'t abort');\n            return;\n        }\n        // Cannot rely on this._xhr.abort() to trigger this._xhr.onAbort() synchronously, thus we must trigger an early response here\n        this._respond('Aborted');\n        if (this._xhr) {\n            // Abort the in-flight request\n            this._xhr.abort();\n        }\n    };\n    SimpleWebRequest.prototype.start = function () {\n        var _this = this;\n        if (this._deferred) {\n            utils_1.assert(false, 'WebRequest already started');\n            return SyncTasks.Rejected('WebRequest already started');\n        }\n        this._deferred = SyncTasks.Defer();\n        this._deferred.onCancel(function () {\n            // Abort the XHR -- this should chain through to the fail case on readystatechange\n            _this.abort();\n        });\n        this._enqueue();\n        return this._deferred.promise();\n    };\n    SimpleWebRequest.prototype._respond = function (errorStatusText) {\n        var _this = this;\n        if (this._finishHandled) {\n            // Aborted web requests often double-finish due to odd browser behavior, but non-aborted requests shouldn't...\n            // Unfortunately, this assertion fires frequently in the Safari browser, presumably due to a non-standard\n            // XHR implementation, so we need to comment it out.\n            // This also might get hit during browser feature detection process\n            // assert(this._aborted || this._timedOut, 'Double-finished XMLHttpRequest');\n            return;\n        }\n        this._finishHandled = true;\n        this._removeFromQueue();\n        if (this._retryTimer) {\n            exports.SimpleWebRequestOptions.clearTimeout(this._retryTimer);\n            this._retryTimer = undefined;\n        }\n        if (this._requestTimeoutTimer) {\n            exports.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer);\n            this._requestTimeoutTimer = undefined;\n        }\n        var statusCode = 0;\n        var statusText;\n        if (this._xhr) {\n            try {\n                statusCode = this._xhr.status;\n                statusText = this._xhr.statusText || errorStatusText;\n            }\n            catch (e) {\n                // Some browsers error when you try to read status off aborted requests\n            }\n        }\n        else {\n            statusText = errorStatusText || 'Browser Error - Possible CORS or Connectivity Issue';\n        }\n        var headers = {};\n        var body;\n        var responseParsingException;\n        // Build the response info\n        if (this._xhr) {\n            // Parse out headers\n            var headerLines = (this._xhr.getAllResponseHeaders() || '').split(/\\r?\\n/);\n            headerLines.forEach(function (line) {\n                if (line.length === 0) {\n                    return;\n                }\n                var index = line.indexOf(':');\n                if (index === -1) {\n                    headers[line] = '';\n                }\n                else {\n                    headers[line.substr(0, index).toLowerCase()] = line.substr(index + 1).trim();\n                }\n            });\n            // Some browsers apparently don't set the content-type header in some error conditions from getAllResponseHeaders but do return\n            // it from the normal getResponseHeader.  No clue why, but superagent mentions it as well so it's best to just conform.\n            if (!headers['content-type']) {\n                var check = this._xhr.getResponseHeader('content-type');\n                if (check) {\n                    headers['content-type'] = check;\n                }\n            }\n            body = this._xhr.response;\n            if (headers['content-type'] && isJsonContentType(headers['content-type'])) {\n                if (!body || !utils_1.isObject(body)) {\n                    // Response can be null if the responseType does not match what the server actually sends\n                    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseType\n                    // Only access responseText if responseType is \"text\" or \"\", otherwise it will throw\n                    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseText\n                    if ((this._xhr.responseType === 'text' || this._xhr.responseType === '') && this._xhr.responseText) {\n                        try {\n                            body = JSON.parse(this._xhr.responseText);\n                        }\n                        catch (ex) {\n                            // If a service returns invalid JSON in a payload, we can end up here - don't crash\n                            // responseParsingException flag will indicate that we got response from the server that was corrupted.\n                            // This will be manifested as null on receipient side and flag can help in understanding the problem.\n                            responseParsingException = ex;\n                            console.warn('Failed to parse XHR JSON response');\n                        }\n                    }\n                }\n            }\n        }\n        if (this._xhr && this._xhr.readyState === 4 && ((statusCode >= 200 && statusCode < 300) || statusCode === 304)) {\n            // Happy path!\n            var resp = {\n                url: this._xhr.responseURL || this._url,\n                method: this._action,\n                requestOptions: this._options,\n                requestHeaders: this._xhrRequestHeaders || {},\n                statusCode: statusCode,\n                statusText: statusText,\n                headers: headers,\n                body: body,\n                responseParsingException: responseParsingException,\n            };\n            this._deferred.resolve(resp);\n        }\n        else {\n            var errResp = {\n                url: (this._xhr ? this._xhr.responseURL : undefined) || this._url,\n                method: this._action,\n                requestOptions: this._options,\n                requestHeaders: this._xhrRequestHeaders || {},\n                statusCode: statusCode,\n                statusText: statusText,\n                headers: headers,\n                body: body,\n                canceled: this._aborted,\n                timedOut: this._timedOut,\n                responseParsingException: responseParsingException,\n            };\n            if (this._options.augmentErrorResponse) {\n                this._options.augmentErrorResponse(errResp);\n            }\n            // Policy-adaptable failure\n            var handleResponse = this._options.customErrorHandler\n                ? this._options.customErrorHandler(this, errResp)\n                : DefaultErrorHandler(this, errResp);\n            var retry = handleResponse !== ErrorHandlingType.DoNotRetry && ((this._options.retries && this._options.retries > 0) ||\n                handleResponse === ErrorHandlingType.PauseUntilResumed ||\n                handleResponse === ErrorHandlingType.RetryUncountedImmediately ||\n                handleResponse === ErrorHandlingType.RetryUncountedWithBackoff);\n            if (retry) {\n                if (handleResponse === ErrorHandlingType.RetryCountedWithBackoff) {\n                    this._options.retries--;\n                }\n                if (this._requestTimeoutTimer) {\n                    exports.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer);\n                    this._requestTimeoutTimer = undefined;\n                }\n                this._aborted = false;\n                this._timedOut = false;\n                this._finishHandled = false;\n                // Clear the XHR since we technically just haven't started again yet...\n                if (this._xhr) {\n                    this._xhr.onabort = null;\n                    this._xhr.onerror = null;\n                    this._xhr.onload = null;\n                    this._xhr.onprogress = null;\n                    this._xhr.onreadystatechange = null;\n                    this._xhr.ontimeout = null;\n                    this._xhr = undefined;\n                    this._xhrRequestHeaders = undefined;\n                }\n                if (handleResponse === ErrorHandlingType.PauseUntilResumed) {\n                    this._paused = true;\n                }\n                else if (handleResponse === ErrorHandlingType.RetryUncountedImmediately) {\n                    this._enqueue();\n                }\n                else {\n                    this._retryTimer = exports.SimpleWebRequestOptions.setTimeout(function () {\n                        _this._retryTimer = undefined;\n                        _this._enqueue();\n                    }, this._retryExponentialTime.getTimeAndCalculateNext());\n                }\n            }\n            else {\n                // No more retries -- fail.\n                this._deferred.reject(errResp);\n            }\n        }\n        // Freed up a spot, so let's see if there's other stuff pending\n        SimpleWebRequestBase.checkQueueProcessing();\n    };\n    return SimpleWebRequest;\n}(SimpleWebRequestBase));\nexports.SimpleWebRequest = SimpleWebRequest;\n", "\"use strict\";\n/**\n * GenericRestClient.ts\n * Author: David de Regt\n * Copyright: Microsoft 2015\n *\n * Base client type for accessing RESTful services\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nvar SimpleWebRequest_1 = require(\"./SimpleWebRequest\");\nvar GenericRestClient = /** @class */ (function () {\n    function GenericRestClient(endpointUrl) {\n        this._defaultOptions = {\n            excludeEndpointUrl: false,\n            withCredentials: false,\n            retries: 0,\n        };\n        this._endpointUrl = endpointUrl;\n    }\n    GenericRestClient.prototype._performApiCall = function (apiPath, action, objToPost, givenOptions) {\n        var _this = this;\n        if (givenOptions === void 0) { givenOptions = {}; }\n        var options = __assign(__assign({}, this._defaultOptions), givenOptions);\n        if (objToPost) {\n            options.sendData = objToPost;\n        }\n        if (options.eTag) {\n            if (!options.augmentHeaders) {\n                options.augmentHeaders = {};\n            }\n            options.augmentHeaders['If-None-Match'] = options.eTag;\n        }\n        if (!options.contentType) {\n            options.contentType = utils_1.isString(options.sendData) ? 'form' : 'json';\n        }\n        var finalUrl = options.excludeEndpointUrl ? apiPath : this._endpointUrl + apiPath;\n        return new SimpleWebRequest_1.SimpleWebRequest(action, finalUrl, options, function () { return _this._getHeaders(options); }, function () { return _this._blockRequestUntil(options); })\n            .start()\n            .then(function (response) {\n            _this._processSuccessResponse(response);\n            return response;\n        });\n    };\n    GenericRestClient.prototype._getHeaders = function (options) {\n        // Virtual function -- No-op by default\n        return {};\n    };\n    // Override (but make sure to call super and chain appropriately) this function if you want to add more blocking criteria.\n    // Also, this might be called multiple times to check if the conditions changed\n    GenericRestClient.prototype._blockRequestUntil = function (options) {\n        // No-op by default\n        return undefined;\n    };\n    // Override this function to process any generic headers that come down with a successful response\n    GenericRestClient.prototype._processSuccessResponse = function (resp) {\n        // No-op by default\n    };\n    GenericRestClient.prototype.performApiGet = function (apiPath, options) {\n        return this\n            .performApiGetDetailed(apiPath, options)\n            .then(function (resp) { return resp.body; });\n    };\n    GenericRestClient.prototype.performApiGetDetailed = function (apiPath, options) {\n        return this._performApiCall(apiPath, 'GET', undefined, options);\n    };\n    GenericRestClient.prototype.performApiPost = function (apiPath, objToPost, options) {\n        return this\n            .performApiPostDetailed(apiPath, objToPost, options)\n            .then(function (resp) { return resp.body; });\n    };\n    GenericRestClient.prototype.performApiPostDetailed = function (apiPath, objToPost, options) {\n        return this._performApiCall(apiPath, 'POST', objToPost, options);\n    };\n    GenericRestClient.prototype.performApiPatch = function (apiPath, objToPatch, options) {\n        return this\n            .performApiPatchDetailed(apiPath, objToPatch, options)\n            .then(function (resp) { return resp.body; });\n    };\n    GenericRestClient.prototype.performApiPatchDetailed = function (apiPath, objToPatch, options) {\n        return this._performApiCall(apiPath, 'PATCH', objToPatch, options);\n    };\n    GenericRestClient.prototype.performApiPut = function (apiPath, objToPut, options) {\n        return this\n            .performApiPutDetailed(apiPath, objToPut, options)\n            .then(function (resp) { return resp.body; });\n    };\n    GenericRestClient.prototype.performApiPutDetailed = function (apiPath, objToPut, options) {\n        return this._performApiCall(apiPath, 'PUT', objToPut, options);\n    };\n    GenericRestClient.prototype.performApiDelete = function (apiPath, objToDelete, options) {\n        return this\n            .performApiDeleteDetailed(apiPath, objToDelete, options)\n            .then(function (resp) { return resp.body; });\n    };\n    GenericRestClient.prototype.performApiDeleteDetailed = function (apiPath, objToDelete, options) {\n        return this._performApiCall(apiPath, 'DELETE', objToDelete, options);\n    };\n    return GenericRestClient;\n}());\nexports.GenericRestClient = GenericRestClient;\n", "\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./ExponentialTime\"));\n__export(require(\"./GenericRestClient\"));\n__export(require(\"./SimpleWebRequest\"));\n", "/**\n* index.js\n* Copyright: Microsoft 2016\n*\n* Points at typescript source for using with webpack/TSC.\n*/\n\nmodule.exports = require('./dist/SimpleRestClients');\n", "\"use strict\";\r\n/**\r\n* TelemetryEventBase.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Holds ECS client telemetry event base\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar TelemetryEventBase = /** @class */ (function () {\r\n    function TelemetryEventBase() {\r\n    }\r\n    TelemetryEventBase.prototype.getAttributes = function () {\r\n        var attributes = {\r\n            'Source': 'ecs_client'\r\n        };\r\n        return attributes;\r\n    };\r\n    return TelemetryEventBase;\r\n}());\r\nexports.TelemetryEventBase = TelemetryEventBase;\r\n", "\"use strict\";\r\n/**\r\n* TelemetryEvents.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* All the ECS client telemetry events\r\n*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar TelemetryEventBase_1 = require(\"./TelemetryEventBase\");\r\nvar EcsConfigFetchResponse = /** @class */ (function (_super) {\r\n    __extends(EcsConfigFetchResponse, _super);\r\n    function EcsConfigFetchResponse(_responseTime, _responseCode, _fetchAttempts, _hasValidToken, _serverEndpoint, _fetchDurationValid, _cacheAvailable, _responseSize, _configAge, _configExpired, _fetchStart, _fetchEnd, _isUserConfig, _etag, _timedOut, _responseParsingException, _errorMessage) {\r\n        var _this = _super.call(this) || this;\r\n        _this._responseTime = _responseTime;\r\n        _this._responseCode = _responseCode;\r\n        _this._fetchAttempts = _fetchAttempts;\r\n        _this._hasValidToken = _hasValidToken;\r\n        _this._serverEndpoint = _serverEndpoint;\r\n        _this._fetchDurationValid = _fetchDurationValid;\r\n        _this._cacheAvailable = _cacheAvailable;\r\n        _this._responseSize = _responseSize;\r\n        _this._configAge = _configAge;\r\n        _this._configExpired = _configExpired;\r\n        _this._fetchStart = _fetchStart;\r\n        _this._fetchEnd = _fetchEnd;\r\n        _this._isUserConfig = _isUserConfig;\r\n        _this._etag = _etag;\r\n        _this._timedOut = _timedOut;\r\n        _this._responseParsingException = _responseParsingException;\r\n        _this._errorMessage = _errorMessage;\r\n        return _this;\r\n    }\r\n    EcsConfigFetchResponse.prototype.getEventName = function () {\r\n        return 'ecs_tsclient_fetch_config';\r\n    };\r\n    EcsConfigFetchResponse.prototype.getAttributes = function () {\r\n        var attributes = _super.prototype.getAttributes.call(this);\r\n        attributes['fetch_delay_ms'] = this._responseTime;\r\n        attributes['fetch_response_code'] = this._responseCode;\r\n        attributes['fetch_attempts'] = this._fetchAttempts;\r\n        attributes['authenticated_user'] = this._hasValidToken;\r\n        attributes['url'] = this._serverEndpoint;\r\n        attributes['fetch_duration_valid'] = this._fetchDurationValid;\r\n        attributes['cache_available'] = this._cacheAvailable;\r\n        attributes['response_size'] = this._responseSize;\r\n        attributes['config_age'] = this._configAge;\r\n        attributes['config_expired'] = this._configExpired;\r\n        attributes['fetch_start'] = this._fetchStart;\r\n        attributes['fetch_end'] = this._fetchEnd;\r\n        attributes['is_user_config'] = this._isUserConfig;\r\n        if (this._etag) {\r\n            attributes['fetched_etag'] = this._etag;\r\n        }\r\n        if (this._timedOut !== undefined) {\r\n            attributes['fetch_timed_out'] = this._timedOut;\r\n        }\r\n        if (this._responseParsingException) {\r\n            attributes['fetch_response_parsing_error'] = this._responseParsingException.message;\r\n        }\r\n        if (this._errorMessage) {\r\n            attributes['fetch_error_message'] = this._errorMessage;\r\n        }\r\n        return attributes;\r\n    };\r\n    return EcsConfigFetchResponse;\r\n}(TelemetryEventBase_1.TelemetryEventBase));\r\nexports.EcsConfigFetchResponse = EcsConfigFetchResponse;\r\n", "\"use strict\";\r\n/**\r\n* RestClient.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Client helper for accessing ECS.\r\n*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar simplerestclients_1 = require(\"simplerestclients\");\r\nvar SyncTasks = require(\"synctasks\");\r\nvar Models_1 = require(\"./Models\");\r\nvar TelemetryEvents = require(\"./TelemetryEvents\");\r\nvar ForceFetchTimeout = (48 * 60 * 60 * 1000); // Fetch every 48 hours at a minimum\r\nvar EcsExpirationFallbackDuration = 30 * 60 * 1000; // 30 minutes\r\nvar EcsFetchDurationLimit = (365 * 24 * 60 * 60 * 1000); // fetch duration beyond 1 year is considered invalid\r\nvar EcsMinFetchTimeout = (30 * 1000); // Fail-safe lower bound for the fetchTimeout config parameter\r\nvar lastResponseTime;\r\nvar currentRequestTime;\r\n// Fetches the ECS configuration from a specific ECS endpoint and project\r\nvar EcsFetcher = /** @class */ (function (_super) {\r\n    __extends(EcsFetcher, _super);\r\n    function EcsFetcher(url, _config, _skypeTokenData, _appActiveData, _allowBackgroundFetchData, _etag, _getUserConfig, parameters) {\r\n        var _this = _super.call(this, url) || this;\r\n        _this._config = _config;\r\n        _this._skypeTokenData = _skypeTokenData;\r\n        _this._appActiveData = _appActiveData;\r\n        _this._allowBackgroundFetchData = _allowBackgroundFetchData;\r\n        _this._etag = _etag;\r\n        _this._getUserConfig = _getUserConfig;\r\n        var config = _this._config.getConfig();\r\n        _this._apiPath = config.clientTeam\r\n            ? \"/config/v1/\" + config.clientName + \"/\" + config.clientVersion + \"/\" + config.clientTeam\r\n            : \"/config/v1/\" + config.clientName + \"/\" + config.clientVersion;\r\n        if (parameters) {\r\n            var paramList = Object.keys(parameters).map(function (key) {\r\n                return encodeURIComponent(key) + '=' + encodeURIComponent(parameters[key].toString());\r\n            });\r\n            if (paramList) {\r\n                _this._apiPath += '?' + paramList.join('&');\r\n            }\r\n        }\r\n        return _this;\r\n    }\r\n    EcsFetcher.prototype._blockRequestUntil = function (options) {\r\n        var _this = this;\r\n        if (this._getUserConfig && !this._skypeTokenData.isSkypeTokenValid()) {\r\n            console.log('ECS - Delaying User config fetch until we have a valid SkypeToken');\r\n        }\r\n        if (!this._appActiveData.isAppActive() && !this._allowBackgroundFetchData.isBackgroundFetchAllowed()) {\r\n            var configType = this._getUserConfig ? 'User config' : 'config';\r\n            console.log(\"ECS - Delaying \" + configType + \" fetch until the app is active (or background fetch is allowed)\");\r\n        }\r\n        return SyncTasks.race([\r\n            this._appActiveData.waitForAppActive(),\r\n            this._allowBackgroundFetchData.waitForBackgroundFetchAllowed()\r\n        ]).then(function () {\r\n            if (_this._getUserConfig) {\r\n                return _this._skypeTokenData.waitForValidSkypeToken();\r\n            }\r\n        }).then(function () {\r\n            currentRequestTime = Date.now();\r\n        });\r\n    };\r\n    EcsFetcher.prototype._getHeaders = function () {\r\n        var headers = {};\r\n        if (this._etag) {\r\n            headers['If-None-Match'] = this._etag;\r\n        }\r\n        if (this._getUserConfig) {\r\n            headers['Authorization'] = this._skypeTokenData.getSkypeToken();\r\n        }\r\n        return headers;\r\n    };\r\n    EcsFetcher.prototype.getConfig = function () {\r\n        // Make sure the timeout is undefined, 0, or at least EcsMinFetchTimeout\r\n        var timeout = this._config.getConfig().fetchTimeout;\r\n        if (timeout !== undefined) {\r\n            if (timeout < 0) {\r\n                timeout = 0;\r\n            }\r\n            else if (timeout > 0 && timeout < EcsMinFetchTimeout) {\r\n                timeout = EcsMinFetchTimeout;\r\n            }\r\n        }\r\n        return _super.prototype.performApiGetDetailed.call(this, this._apiPath, { timeout: timeout });\r\n    };\r\n    return EcsFetcher;\r\n}(simplerestclients_1.GenericRestClient));\r\n// Main ECS client. Supports alternate ECS backend URLs and configuration fetch retries.\r\nvar EcsClient = /** @class */ (function () {\r\n    function EcsClient(_config, _skypeTokenData, _appActiveData, _allowBackgroundFetchData, _telemetryManager) {\r\n        this._config = _config;\r\n        this._skypeTokenData = _skypeTokenData;\r\n        this._appActiveData = _appActiveData;\r\n        this._allowBackgroundFetchData = _allowBackgroundFetchData;\r\n        this._telemetryManager = _telemetryManager;\r\n        this._ecsFailureBackoffTimer = new simplerestclients_1.ExponentialTime(1000, 300000);\r\n        this._cacheMaxAgeRegex = /.*max-age=(\\d+).*/ig;\r\n        this._serverIndex = NaN;\r\n    }\r\n    EcsClient.prototype.getConfig = function (oldConfig, userConfig, parameters) {\r\n        var _this = this;\r\n        var urls = this._config.getConfig().hosts;\r\n        // Randomly select the ECS server url to issue the first request against and store the index\r\n        if (isNaN(this._serverIndex) || this._serverIndex > urls.length - 1) {\r\n            this._serverIndex = Math.floor(Math.random() * urls.length);\r\n        }\r\n        if (!urls || !urls.length) {\r\n            return SyncTasks.Rejected(new Error('no configuration service endpoint'));\r\n        }\r\n        var deferred = SyncTasks.Defer();\r\n        var fetchAttempts = 0;\r\n        // Keep trying to fetch config (w/ Exponential Backoff) until it's fetched succesfully\r\n        var callConfigServer = function () {\r\n            var etag = oldConfig && oldConfig.eTag ? oldConfig.eTag : undefined;\r\n            var fetcher = new EcsFetcher(urls[_this._serverIndex], _this._config, _this._skypeTokenData, _this._appActiveData, _this._allowBackgroundFetchData, etag, userConfig, parameters);\r\n            fetchAttempts++;\r\n            fetcher.getConfig().then(function (res) {\r\n                var eTagHeader = res.headers['etag'];\r\n                var expirationHeader = res.headers['expires'];\r\n                if (res.body && res.body.Headers) {\r\n                    // If the service headers are missing, try to get them from the response body\r\n                    if (!eTagHeader) {\r\n                        eTagHeader = res.body.Headers.ETag;\r\n                    }\r\n                    if (!expirationHeader) {\r\n                        expirationHeader = res.body.Headers.Expires;\r\n                    }\r\n                }\r\n                var responseTimeInfo = _this._calculateResponseTimeInfo(oldConfig);\r\n                // As per ECS guidance, if ETag or expiration are missing, treat as a failure.\r\n                if (!eTagHeader || !expirationHeader) {\r\n                    console.warn('ECS - Service returned an empty ETag or Expiration header: ' +\r\n                        JSON.stringify(res));\r\n                    return SyncTasks.Rejected({\r\n                        timedOut: false,\r\n                        responseParsingException: new Error('ECS Service returned empty ETag or Expiration header'),\r\n                        responseCode: res.statusCode\r\n                    });\r\n                }\r\n                // Override to deal with client clock skew.\r\n                var updatedExpiration = new Date(_this._calculateExpirationDate(res.headers)).getTime();\r\n                var ecsData;\r\n                if (res.statusCode === 304 && oldConfig) {\r\n                    // Etag matched, so no change. Use old config values and continue as normal.\r\n                    // Use a shallow clone since we don't need to make a full clone of the config data.\r\n                    ecsData = __assign({}, oldConfig);\r\n                    ecsData.configType = userConfig ? Models_1.EcsConfigType.User : Models_1.EcsConfigType.Default;\r\n                    ecsData.eTag = eTagHeader;\r\n                    ecsData.expiration = updatedExpiration;\r\n                    ecsData.cacheUpdateTime = responseTimeInfo.lastResponseTime;\r\n                    ecsData.lastFetchTokenHash = _this._skypeTokenData.getSkypeTokenHash(res.requestHeaders['Authorization']);\r\n                }\r\n                else {\r\n                    if (typeof res.body !== 'object') {\r\n                        console.warn('ECS - Service returned invalid response ' + JSON.stringify(res));\r\n                        return SyncTasks.Rejected({\r\n                            timedOut: false,\r\n                            responseParsingException: new Error('ECS Service returned invalid response body'),\r\n                            responseCode: res.statusCode\r\n                        });\r\n                    }\r\n                    // Take from response\r\n                    ecsData = {\r\n                        config: res.body,\r\n                        configType: userConfig ? Models_1.EcsConfigType.User : Models_1.EcsConfigType.Default,\r\n                        eTag: eTagHeader,\r\n                        expiration: updatedExpiration,\r\n                        cacheUpdateTime: currentRequestTime,\r\n                        lastFetchTokenHash: _this._skypeTokenData.getSkypeTokenHash(res.requestHeaders['Authorization']),\r\n                        appVersion: _this._config.getConfig().clientVersion\r\n                    };\r\n                }\r\n                _this._telemetryManager.sendTelemetryEvent(new TelemetryEvents.EcsConfigFetchResponse(responseTimeInfo.fetchDelayMs, res.statusCode, fetchAttempts, _this._skypeTokenData.isSkypeTokenValid(), urls[_this._serverIndex], responseTimeInfo.fetchDurationValid, !!etag, JSON.stringify(res).length, responseTimeInfo.cacheAge, !(oldConfig && oldConfig.expiration - Date.now() > 0), currentRequestTime, responseTimeInfo.lastResponseTime, userConfig, eTagHeader));\r\n                _this._ecsFailureBackoffTimer.reset();\r\n                deferred.resolve(ecsData);\r\n            }).catch(function (e) {\r\n                var errorInfo = {\r\n                    timedOut: (e && e.timedOut) || false,\r\n                    responseParseError: (e && e.responseParsingException),\r\n                    responseCode: (e && e.statusCode) || 0,\r\n                    message: _this._getErrorMessage(e)\r\n                };\r\n                console.error(\"ECS - Service request failed to return a response (timedOut: \" + errorInfo.timedOut + \", responseParseError: \" + errorInfo.responseParseError + \")\");\r\n                // send telemetry event with info about the failure\r\n                var responseTimeInfo = _this._calculateResponseTimeInfo(oldConfig);\r\n                _this._telemetryManager.sendTelemetryEvent(new TelemetryEvents.EcsConfigFetchResponse(responseTimeInfo.fetchDelayMs, errorInfo.responseCode, fetchAttempts, _this._skypeTokenData.isSkypeTokenValid(), urls[_this._serverIndex], responseTimeInfo.fetchDurationValid, !!etag, 0, responseTimeInfo.cacheAge, !(oldConfig && oldConfig.expiration - Date.now() > 0), currentRequestTime, responseTimeInfo.lastResponseTime, userConfig, undefined, errorInfo.timedOut, errorInfo.responseParseError, errorInfo.message));\r\n                // If maximum attemps is defined and we have reached it\r\n                // return right away so we won't retry anymore\r\n                var maxRefetchAttempts = _this._config.getConfig().fetchAttemptMax;\r\n                if (maxRefetchAttempts && fetchAttempts > maxRefetchAttempts) {\r\n                    return;\r\n                }\r\n                // Backoff and Switch ECS servers if possible.\r\n                setTimeout(function () {\r\n                    callConfigServer();\r\n                }, _this._ecsFailureBackoffTimer.getTimeAndCalculateNext());\r\n            });\r\n        };\r\n        callConfigServer();\r\n        return deferred.promise();\r\n    };\r\n    EcsClient.prototype._calculateExpirationDate = function (headers) {\r\n        var forceFetchTime = Date.now() + ForceFetchTimeout;\r\n        if (headers['date'] && headers['expires']) {\r\n            // Calculate client clock skew\r\n            var responseDate = new Date(headers['date']).getTime();\r\n            var clockSkew = Date.now() - responseDate;\r\n            // Ensure we don't do Math.min(forceFetchTime, NaN) => NaN\r\n            var headerExpirationTime = new Date(headers['expires']).getTime();\r\n            if (isNaN(headerExpirationTime)) {\r\n                return forceFetchTime;\r\n            }\r\n            return Math.min(forceFetchTime, headerExpirationTime + clockSkew);\r\n        }\r\n        // This is a fix for browsers that don't implement Access-Control-Expose-Headers header properly\r\n        // and Date header is not propagated (IE, Edge). We take the value from the cache-control\r\n        // header (seconds) and add it to the client's current time.\r\n        var match = this._cacheMaxAgeRegex.exec(headers['cache-control']);\r\n        this._cacheMaxAgeRegex.lastIndex = 0;\r\n        if (match && match.length === 2) {\r\n            return Math.min(forceFetchTime, Date.now() + (Number(match[1]) * 1000));\r\n        }\r\n        // Backup - send next request in 30 minutes.\r\n        return Date.now() + EcsExpirationFallbackDuration;\r\n    };\r\n    EcsClient.prototype._calculateResponseTimeInfo = function (oldConfig) {\r\n        lastResponseTime = Date.now();\r\n        var fetchDelayMs = lastResponseTime - currentRequestTime;\r\n        return {\r\n            lastResponseTime: lastResponseTime,\r\n            fetchDelayMs: fetchDelayMs,\r\n            fetchDurationValid: !(fetchDelayMs < 0 || fetchDelayMs > EcsFetchDurationLimit),\r\n            cacheAge: oldConfig ? (lastResponseTime - oldConfig.cacheUpdateTime) : 0\r\n        };\r\n    };\r\n    EcsClient.prototype._getErrorMessage = function (err) {\r\n        if (!err) {\r\n            return undefined;\r\n        }\r\n        if (typeof err === 'string') {\r\n            return err;\r\n        }\r\n        if (typeof err === 'object' && (err.statusText || err.message)) {\r\n            return err.statusText || err.message;\r\n        }\r\n        return undefined;\r\n    };\r\n    return EcsClient;\r\n}());\r\nexports.default = EcsClient;\r\n", "\"use strict\";\r\n/**\r\n* Scheduler.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Scheduling module for fetching ECS config\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Models_1 = require(\"./Models\");\r\nvar RestClient_1 = require(\"./RestClient\");\r\nvar Scheduler = /** @class */ (function () {\r\n    function Scheduler(_config, _skypeTokenData, _cache, appActiveData, allowBackgroundFetchData, telemetryManager) {\r\n        var _this = this;\r\n        this._config = _config;\r\n        this._skypeTokenData = _skypeTokenData;\r\n        this._cache = _cache;\r\n        this._isFetchingSettings = {};\r\n        this._pendingFetch = {};\r\n        this._pendingTimers = {};\r\n        this._subscriptionToken = null;\r\n        this._paused = false;\r\n        this._fetchEcsSettingsIfNeeded = function (configType) {\r\n            var _a;\r\n            var config = _this._config.getConfig();\r\n            var cachedConfig = _this._cache.getEcsConfigByType(configType);\r\n            // If we don't care about this config, abort\r\n            if (config.configsToFetch.indexOf(configType) === -1) {\r\n                return;\r\n            }\r\n            // Don't refresh if we're already fetching.\r\n            if (_this._isFetchingSettings[configType]) {\r\n                return;\r\n            }\r\n            if (!cachedConfig && _this._pendingFetch[configType]) {\r\n                _this._fetchSkypeEcsSettings(configType);\r\n                return;\r\n            }\r\n            // Get time until expiration, negative if we have no config.\r\n            var configExpirationMs = cachedConfig ? cachedConfig.expiration - Date.now() : -1;\r\n            // If config expired, fetch now.\r\n            if (configExpirationMs <= 0) {\r\n                _this._fetchSkypeEcsSettings(configType);\r\n                return;\r\n            }\r\n            // If SkypeToken used to fetch has changed, fetchNow\r\n            if (cachedConfig && configType === Models_1.EcsConfigType.User && _this._skypeTokenData.isSkypeTokenValid() &&\r\n                cachedConfig.lastFetchTokenHash !== _this._skypeTokenData.getSkypeTokenHash(_this._skypeTokenData.getSkypeToken())) {\r\n                _this._fetchSkypeEcsSettings(configType);\r\n                return;\r\n            }\r\n            if ((_a = config.Killswitches) === null || _a === void 0 ? void 0 : _a.isSkypeTokenDataLeakFixEnabled) {\r\n                // Cancel previous timeout before scheduling the next.\r\n                if (_this._pendingTimers[configType] > 0) {\r\n                    clearTimeout(_this._pendingTimers[configType]);\r\n                }\r\n                _this._pendingTimers[configType] = window.setTimeout(function () { return _this._fetchEcsSettingsIfNeeded(configType); }, configExpirationMs);\r\n            }\r\n            else {\r\n                // Schedule another check.\r\n                window.setTimeout(function () { return _this._fetchEcsSettingsIfNeeded(configType); }, configExpirationMs);\r\n            }\r\n        };\r\n        this._fetchSkypeEcsSettings = function (configType, bypassPause) {\r\n            if (bypassPause === void 0) { bypassPause = false; }\r\n            if (_this._isFetchingSettings[configType] || (_this._paused && !bypassPause)) {\r\n                _this._pendingFetch[configType] = true;\r\n                return;\r\n            }\r\n            _this._pendingFetch[configType] = false;\r\n            _this._isFetchingSettings[configType] = true;\r\n            var config = _this._config.getConfig();\r\n            // will never fail. We'll keep trying to fetch with exponential backoff until the end of time.\r\n            config.getEcsParameters()\r\n                .catch(function () {\r\n                // If we fail to get parameters, continue with none\r\n                console.warn('ECS - Failed to fetch ECS fetching parameters');\r\n                return {};\r\n            })\r\n                .then(function (parameters) {\r\n                return _this._ecsClient\r\n                    .getConfig(_this._cache.getEcsConfig(), configType === Models_1.EcsConfigType.User, parameters);\r\n            })\r\n                .then(function (ecsConfig) {\r\n                console.log('ECS - Config fetch complete');\r\n                _this._isFetchingSettings[configType] = false;\r\n                _this._cache.putConfig(ecsConfig);\r\n                // Queue a refresh\r\n                _this._fetchEcsSettingsIfNeeded(configType);\r\n            });\r\n        };\r\n        this._ecsClient = new RestClient_1.default(this._config, this._skypeTokenData, appActiveData, allowBackgroundFetchData, telemetryManager);\r\n    }\r\n    Scheduler.prototype.initialize = function () {\r\n        var _this = this;\r\n        this.updateConfigsToFetch();\r\n        // Re-fetch user settings when skype token changes\r\n        this._subscriptionToken = this._skypeTokenData.skypeTokenChanged.subscribe(function () { return _this._fetchEcsSettingsIfNeeded(Models_1.EcsConfigType.User); });\r\n    };\r\n    Scheduler.prototype.dispose = function () {\r\n        var _a, _b;\r\n        var config = this._config.getConfig();\r\n        if ((_a = config.Killswitches) === null || _a === void 0 ? void 0 : _a.isSkypeTokenDataLeakFixEnabled) {\r\n            for (var _i = 0, _c = config.configsToFetch; _i < _c.length; _i++) {\r\n                var configType = _c[_i];\r\n                clearTimeout(this._pendingTimers[configType]);\r\n                this._pendingTimers[configType] = 0;\r\n            }\r\n            (_b = this._subscriptionToken) === null || _b === void 0 ? void 0 : _b.unsubscribe();\r\n            this._subscriptionToken = null;\r\n            this._skypeTokenData.skypeTokenChanged.dispose();\r\n        }\r\n    };\r\n    Scheduler.prototype.updateConfigsToFetch = function () {\r\n        var config = this._config.getConfig();\r\n        for (var _i = 0, _a = config.configsToFetch; _i < _a.length; _i++) {\r\n            var configType = _a[_i];\r\n            if (!(configType in this._isFetchingSettings)) {\r\n                this._isFetchingSettings[configType] = false;\r\n            }\r\n            if (!(configType in this._isFetchingSettings)) {\r\n                this._pendingFetch[configType] = false;\r\n            }\r\n        }\r\n        // If we haven't downloaded a config yet (which should happen only on\r\n        // first run), download it immediately so we have the settings by the time\r\n        // the UI loads, and we can enable or disable specific UI features.\r\n        for (var _b = 0, _c = config.configsToFetch; _b < _c.length; _b++) {\r\n            var configType = _c[_b];\r\n            var cachedData = this._cache.getEcsConfigByType(configType);\r\n            if (!cachedData || (cachedData.appVersion && cachedData.appVersion !== config.clientVersion)) {\r\n                this._fetchSkypeEcsSettings(configType, true);\r\n            }\r\n            else {\r\n                this._fetchEcsSettingsIfNeeded(configType);\r\n            }\r\n        }\r\n    };\r\n    Scheduler.prototype.requestUpdate = function () {\r\n        var config = this._config.getConfig();\r\n        for (var _i = 0, _a = config.configsToFetch; _i < _a.length; _i++) {\r\n            var configType = _a[_i];\r\n            this._fetchSkypeEcsSettings(configType);\r\n        }\r\n    };\r\n    Scheduler.prototype.pause = function () {\r\n        this._paused = true;\r\n    };\r\n    Scheduler.prototype.resume = function () {\r\n        this._paused = false;\r\n        var config = this._config.getConfig();\r\n        for (var _i = 0, _a = config.configsToFetch; _i < _a.length; _i++) {\r\n            var configType = _a[_i];\r\n            this._fetchEcsSettingsIfNeeded(configType);\r\n        }\r\n    };\r\n    return Scheduler;\r\n}());\r\nexports.default = Scheduler;\r\n", "\"use strict\";\r\n/**\r\n* SkypeTokenData.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Holder for SkypeToken information\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscribableevent_1 = require(\"subscribableevent\");\r\nvar SyncTasks = require(\"synctasks\");\r\nvar SkypeTokenData = /** @class */ (function () {\r\n    function SkypeTokenData() {\r\n        this.skypeTokenChanged = new subscribableevent_1.default();\r\n    }\r\n    SkypeTokenData.prototype.putSkypeTokenData = function (initialData) {\r\n        this._data = initialData;\r\n        if (this.isSkypeTokenValid()) {\r\n            this.skypeTokenChanged.fire();\r\n        }\r\n        if (this.isSkypeTokenValid() && this._validSkypeTokenDeferral) {\r\n            var deferral = this._validSkypeTokenDeferral;\r\n            this._validSkypeTokenDeferral = undefined;\r\n            deferral.resolve(void 0);\r\n        }\r\n    };\r\n    SkypeTokenData.prototype.isSkypeTokenValid = function () {\r\n        var tokenData = this._data;\r\n        return !!tokenData && !!tokenData.skypeToken && tokenData.skypeTokenExpiration > Date.now();\r\n    };\r\n    SkypeTokenData.prototype.getSkypeToken = function () {\r\n        var tokenData = this._data;\r\n        if (!tokenData || !tokenData.skypeToken) {\r\n            throw new Error('No Skype Token provided');\r\n        }\r\n        return tokenData.skypeToken;\r\n    };\r\n    SkypeTokenData.prototype.getSkypeTokenHash = function (token) {\r\n        if (token === undefined) {\r\n            return 0;\r\n        }\r\n        return token.split('').reduce(function (mem, next) { return (mem * 101 + next.charCodeAt(0)) % 999727999; }, token.length);\r\n    };\r\n    SkypeTokenData.prototype.waitForValidSkypeToken = function () {\r\n        if (this.isSkypeTokenValid()) {\r\n            return SyncTasks.Resolved();\r\n        }\r\n        // Need to wait for a new one to be poked in\r\n        if (!this._validSkypeTokenDeferral) {\r\n            this._validSkypeTokenDeferral = SyncTasks.Defer();\r\n        }\r\n        return this._validSkypeTokenDeferral.promise();\r\n    };\r\n    return SkypeTokenData;\r\n}());\r\nexports.default = SkypeTokenData;\r\n", "\"use strict\";\r\n/**\r\n* TelemetryManager.ts\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* Record new telemtry events and fires update\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar subscribableevent_1 = require(\"subscribableevent\");\r\nvar TelemetryManager = /** @class */ (function () {\r\n    function TelemetryManager(_cache) {\r\n        this._cache = _cache;\r\n        this.telemetryEventAdded = new subscribableevent_1.default();\r\n        //noop\r\n    }\r\n    TelemetryManager.prototype.sendTelemetryEvent = function (event) {\r\n        var eventName = event.getEventName();\r\n        var eventData = event.getAttributes();\r\n        var telemetryEnabled = false;\r\n        var clientTelemetryConfig = this._cache.getEcsConfig();\r\n        if (!clientTelemetryConfig) {\r\n            // in the scenario where we have no cached previously ECS config that was successfully fetched in the past,\r\n            // fallback to sending telemetry event\r\n            console.warn('No previously cached ECS telemetry config exists - fallback to sending event');\r\n            telemetryEnabled = true;\r\n        }\r\n        else if (TelemetryManager._containsEcsClientTelemetryConfig(clientTelemetryConfig.config)) {\r\n            var ecsConfig = clientTelemetryConfig.config.ECSCONFIG;\r\n            if (ecsConfig && ecsConfig.ecsClientTelemetry) {\r\n                telemetryEnabled = !!ecsConfig.ecsClientTelemetry[eventName];\r\n            }\r\n        }\r\n        if (telemetryEnabled) {\r\n            this.telemetryEventAdded.fire(eventName, eventData);\r\n        }\r\n    };\r\n    TelemetryManager._containsEcsClientTelemetryConfig = function (config) {\r\n        return !!config && !!config.ECSCONFIG && !!config.ECSCONFIG.ecsClientTelemetry;\r\n    };\r\n    return TelemetryManager;\r\n}());\r\nexports.default = TelemetryManager;\r\n", "\"use strict\";\r\n/**\r\n*\r\n* Author: CALIB http://aka.ms/CALIB\r\n* Copyright: Microsoft 2017\r\n*\r\n* ECS Module\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar AllowBackgroundFetchData_1 = require(\"./AllowBackgroundFetchData\");\r\nvar AppActiveData_1 = require(\"./AppActiveData\");\r\nvar Cache_1 = require(\"./Cache\");\r\nvar Config_1 = require(\"./Config\");\r\nvar Models = require(\"./Models\");\r\nexports.Models = Models;\r\nvar Scheduler_1 = require(\"./Scheduler\");\r\nvar SkypeTokenData_1 = require(\"./SkypeTokenData\");\r\nvar TelemetryManager_1 = require(\"./TelemetryManager\");\r\nvar EcsClient = /** @class */ (function () {\r\n    function EcsClient() {\r\n        this._allowBackgroundFetchData = new AllowBackgroundFetchData_1.default();\r\n        this._appActiveData = new AppActiveData_1.default();\r\n        this._config = new Config_1.default();\r\n        this._cache = new Cache_1.default(this._config);\r\n        this._skypeTokenData = new SkypeTokenData_1.default();\r\n        this._telemetryManager = new TelemetryManager_1.default(this._cache);\r\n        this._scheduler = new Scheduler_1.default(this._config, this._skypeTokenData, this._cache, this._appActiveData, this._allowBackgroundFetchData, this._telemetryManager);\r\n        // Typescript 3.X has started inlining type requires for inferred type-only imports if the import isn't used elsewhere in the file\r\n        // Older versions of typescript do not support this so specify it here for backwards definition file compatibility\r\n        this.telemetryEventAdded = this._telemetryManager.telemetryEventAdded;\r\n        this.configUpdated = this._cache.configUpdated;\r\n    }\r\n    EcsClient.prototype.initialize = function (config) {\r\n        var _this = this;\r\n        this._config.initialize(config);\r\n        this._skypeTokenData.putSkypeTokenData(config.initialSkypeTokenData);\r\n        this._appActiveData.putAppActive(config.initialAppActiveState);\r\n        return this._cache.initialize().then(function () {\r\n            _this._scheduler.initialize();\r\n        });\r\n    };\r\n    EcsClient.prototype.dispose = function () {\r\n        var _a;\r\n        var config = this._config.getConfig();\r\n        if ((_a = config.Killswitches) === null || _a === void 0 ? void 0 : _a.isSkypeTokenDataLeakFixEnabled) {\r\n            this._scheduler.dispose();\r\n        }\r\n    };\r\n    EcsClient.prototype.getConfig = function () {\r\n        return this._cache.getEcsConfig();\r\n    };\r\n    EcsClient.prototype.getConfigType = function () {\r\n        var cacheConfig = this._cache.getEcsConfig();\r\n        if (!cacheConfig) {\r\n            return undefined;\r\n        }\r\n        return cacheConfig.configType;\r\n    };\r\n    EcsClient.prototype.requestUpdate = function () {\r\n        this._scheduler.requestUpdate();\r\n    };\r\n    EcsClient.prototype.pause = function () {\r\n        this._scheduler.pause();\r\n    };\r\n    EcsClient.prototype.resume = function () {\r\n        this._scheduler.resume();\r\n    };\r\n    EcsClient.prototype.setAllowBackgroundFetch = function (allowBackgroundFetch) {\r\n        this._allowBackgroundFetchData.putBackgroundFetchAllowed(allowBackgroundFetch);\r\n    };\r\n    EcsClient.prototype.useSkypeToken = function (skypeToken, skypeTokenExpiration) {\r\n        this._skypeTokenData.putSkypeTokenData({ skypeToken: skypeToken, skypeTokenExpiration: skypeTokenExpiration });\r\n    };\r\n    EcsClient.prototype.setAppActive = function (active) {\r\n        this._appActiveData.putAppActive(active);\r\n    };\r\n    EcsClient.prototype.setConfigsToFetch = function (types) {\r\n        var _this = this;\r\n        this._config.setConfigsToFetch(types);\r\n        return this._cache.updateConfigsToFetch().then(function () {\r\n            _this._scheduler.updateConfigsToFetch();\r\n        });\r\n    };\r\n    EcsClient.prototype.setFetchTimeout = function (fetchTimeout) {\r\n        this._config.setFetchTimeout(fetchTimeout);\r\n    };\r\n    return EcsClient;\r\n}());\r\nexports.default = EcsClient;\r\n", "/*\r\n * Utils.ts\r\n *\r\n * Module for utility functions\r\n */\r\n\r\nimport { ICampaignDefinition } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\n/**\r\n * Add time to a given date\r\n * Example, timeAdd(new Date(), 'minute', 5)  //returns 5 minutes from now\r\n * @param date  Date to start with\r\n * @param interval  One of: hour or h, minute or m, second or s\r\n * @param units  units of the given interval to add\r\n * @return date\r\n */\r\nexport function timeAdd(date: Date, interval: string, units: number): Date {\r\n\tswitch (interval.toLowerCase()) {\r\n\t\tcase \"h\":\r\n\t\tcase \"hour\":\r\n\t\t\treturn new Date(date.getTime() + (units * 3600000));\r\n\t\tcase \"m\":\r\n\t\tcase \"minute\":\r\n\t\t\treturn new Date(date.getTime() + (units * 60000));\r\n\t\tcase \"s\":\r\n\t\tcase \"second\":\r\n\t\t\treturn new Date(date.getTime() + (units * 1000));\r\n\t\tdefault:\r\n\t\t\tthrow new Error(\"Invalid interval value of \" + interval);\r\n\t}\r\n}\r\n\r\n/**\r\n * Check if an input value is a valid date, null or undefined return false.\r\n * @param input  input value\r\n * @return boolean\r\n */\r\nexport function isDate(input: any): boolean {\r\n\tif (Object.prototype.toString.call(input) === \"[object Date]\") {\r\n\t\t// it is a date\r\n\t\tif (!(isNaN(input.getTime()))) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Check if an input value is a valid value in the input enum\r\n * @param value  input value\r\n * @param input  input enum\r\n * Returns true if value exists in the enum\r\n */\r\nexport function isEnumValue(value: any, input: any): boolean {\r\n\treturn (value in input);\r\n}\r\n\r\n/**\r\n * Check if an input value is a number\r\n * @param value: input value\r\n */\r\nexport function isNumber(value: any): boolean {\r\n\treturn (value !== null && !isNaN(value) && isFinite(value));\r\n}\r\n\r\n/**\r\n * Check if an input value is null or undefined\r\n * @param value: input value\r\n */\r\nexport function isNOU(value: any): boolean {\r\n\treturn (value === null || value === undefined);\r\n}\r\n\r\n/**\r\n * Check if an input value is an object\r\n * @param value: input value\r\n */\r\nexport function isObject(value: any): boolean {\r\n\treturn (value !== null && value !== undefined && (typeof value === \"object\"));\r\n}\r\n\r\n/**\r\n * Check if an input value is an array\r\n * @param value: input value\r\n */\r\nexport function isFunction(value: any): boolean {\r\n\treturn (value !== null && value !== undefined && (typeof value === \"function\"));\r\n}\r\n\r\n/**\r\n * Check if an input value is an array\r\n * @param value: input value\r\n */\r\nexport function isArray(value: any): boolean {\r\n\treturn (value !== null && value !== undefined && (Array.isArray(value)));\r\n}\r\n\r\n/**\r\n * Check if given value is a string\r\n * @param {any} value value\r\n */\r\nexport function isString(value: any): boolean {\r\n\treturn (typeof value === \"string\");\r\n}\r\n\r\n/**\r\n * Check if value is an object\r\n * @param {any} value value\r\n */\r\nexport function isBoolean(value: any): boolean {\r\n\treturn typeof (value) === \"boolean\";\r\n}\r\n\r\n/**\r\n * Returns a lower temporal boundary\r\n * @return date\r\n */\r\nexport function getDistantPast(): Date {\r\n\t// Corresponds to UTC 1601-01-01T00:00:00Z\r\n\treturn new Date(-11644473600000);\r\n}\r\n\r\n/**\r\n * Get an upper temporal boundary\r\n * @return date\r\n */\r\nexport function getDistantFuture(): Date {\r\n\t// Corresponds to UTC 4001-01-01T00:00:00Z\r\n\treturn new Date(64092211200000);\r\n}\r\n\r\nexport const MAX_DATE_MILLISECONDS = 8640000000000000;\r\nexport const MIN_DATE_MILLISECONDS = -8640000000000000;\r\n\r\n/**\r\n * Adds seconds to a date, if overflows returns Date(Number.Max_VALUE)\r\n *\r\n * @param date    date to add to\r\n * @param seconds seconds as number\r\n * @return Resulting date\r\n */\r\nexport function addSecondsWithoutOverflow(date: Date, seconds: number): Date {\r\n\tif (!date) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (seconds < 0) {\r\n\t\treturn subtractSecondsWithoutOverflow(date, -1 * seconds);\r\n\t} else {\r\n\t\tconst milliseconds: number = date.getTime() + seconds * 1000;\r\n\r\n\t\tif (milliseconds < MAX_DATE_MILLISECONDS) {\r\n\t\t\treturn new Date(milliseconds);\r\n\t\t} else {\r\n\t\t\treturn new Date(MAX_DATE_MILLISECONDS);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Subtracts seconds from a date, if overflows returns Date(Number.MIN_VALUE)\r\n *\r\n * @param date   date to subtract from\r\n * @param seconds seconds as number\r\n * @return Resulting date\r\n */\r\nexport function subtractSecondsWithoutOverflow(date: Date, seconds: number): Date {\r\n\tif (!date) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (seconds < 0) {\r\n\t\tseconds = -seconds;\r\n\t\treturn this.addSecondsWithoutOverflow(date, seconds);\r\n\t}\r\n\r\n\tconst milliseconds: number = date.getTime() - (seconds * 1000);\r\n\r\n\tif (milliseconds > MIN_DATE_MILLISECONDS) {\r\n\t\treturn new Date(milliseconds);\r\n\t} else {\r\n\t\treturn new Date(MIN_DATE_MILLISECONDS);\r\n\t}\r\n}\r\n\r\n// region Language related\r\n\r\n/**\r\n * Effectively un-anchored on the right side because tags can have many more trailing sub-parts than we care to extract\r\n * Refer to https://www.ietf.org/rfc/rfc5646.txt\r\n */\r\nconst LANGUAGE_AND_SCRIPT_TAG_PATTERN: string =\r\n\t\"^\" +\r\n\t// capture 1:language subtag\r\n\t\"(\" +\r\n\t\"(?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})\" +  // 2-3 Alpha chars, followed by up to three optional extension tags, each of format -AAA, A=Alpha char\r\n\t\"|\" +\r\n\t\"(?:[a-zA-Z]{4,8})\" +                       // 4-Alpha chars (reserved in standard) or 5-8 Alpha chars\r\n\t\")\" +\r\n\t\"(?:\" +\r\n\t\"-\" +\r\n\t// capture 2: optional script subtag (without leading dash), exactly 4 alpha chars\r\n\t\"([a-zA-Z]{4})\" +                           // 4-Alpha chars\r\n\t\")?\" +\r\n\t// capture 3: optional region subtag (without leading dash), exactly 2 alpha chars or 3 digits\r\n\t\"(?:-([a-zA-Z]{2}|[0-9]{3}))?\" +\r\n\t\"(\" +\r\n\t// capture 4: any left-overs, rejecting remainder strings that don't end here or lead with a dash.\r\n\t\"-.*\" +\r\n\t\")?\" +\r\n\t\"$\";\r\n\r\nexport function isValidLanguageSubTag(subTag: string): boolean {\r\n\tif (!subTag) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst extractedSubTag: string = extractLanguageSubtag(subTag);\r\n\tif (!extractedSubTag) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn extractedSubTag === subTag;\r\n}\r\n\r\nexport function extractLanguageSubtag(language: string): string {\r\n\tif (!language) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst matches = language.match(LANGUAGE_AND_SCRIPT_TAG_PATTERN);\r\n\tif (!matches || matches.length < 1 || !isNOU(matches[4])) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// return the first capture group which should be the original input if there is a match\r\n\t// For example, \"en-US\" input should return \"en-US\", and \"en\" input should return \"en\".\r\n\treturn matches[0];\r\n}\r\n\r\n// endregion\r\n\r\n/**\r\n * Create guid string\r\n */\r\nexport function guid(): string {\r\n\t// Stitch in '4' in the third group\r\n\treturn (randomHex4() + randomHex4() + \"-\" + randomHex4() + \"-4\" + randomHex4().substr(0, 3) + \"-\" + randomHex4() + \"-\"\r\n\t\t+ randomHex4() + randomHex4() + randomHex4()).toLowerCase();\r\n}\r\n\r\n/**\r\n * Create random Hex4 string\r\n */\r\nfunction randomHex4(): string {\r\n\treturn (Math.floor(((1 + Math.random()) * 0x10000))).toString(16).substring(1);\r\n}\r\n\r\n/**\r\n * Create an array from input object values sorted by object key\r\n * @param Object input object\r\n * @return array\r\n */\r\nexport function makeArrayFromObjectValuesSortedByKeyString(object: object): any[] {\r\n\tconst keys: string[] = Object.keys(object);\r\n\tkeys.sort();\r\n\r\n\tconst values: any[] = [];\r\n\tfor (const id in keys) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(keys, id)) {\r\n\t\t\tconst key: string = keys[id];\r\n\t\t\tvalues.push(object[key]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn values;\r\n}\r\n\r\n/**\r\n * Create a date object from an input string\r\n * @param Object input string\r\n * @return date\r\n */\r\nexport function stringToDate(input: any): Date {\r\n\tif (!isString(input)) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst newDate: Date = input ? new Date(input) : null;\r\n\treturn isDate(newDate) ? newDate : null;\r\n}\r\n\r\n/**\r\n * Takes two objects (source, target) and returns the target object with values in the source added to it.\r\n * It overwrites any source properties which already exist in target.\r\n */\r\nexport function overrideValues<T>(sourceObject: T, targetobject: T): T {\r\n\tif (!targetobject) {\r\n\t\treturn targetobject;\r\n\t}\r\n\r\n\tconst result: T = targetobject;\r\n\r\n\tif (sourceObject) {\r\n\t\tfor (const field in sourceObject) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(sourceObject, field)) {\r\n\t\t\t\t(result as any)[field] = (sourceObject as any)[field];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Test a string is in our supported ISO8601 UTC format of \"yyyy-MM-ddTHH:mm:ssZ\" and \"yyyy-MM-ddTHH:mm:ss.fffZ\"\r\n * @param input Input string to be evaluated.\r\n */\r\nexport function isUtcDatetimeString(input: any): boolean {\r\n\tif (!isString(input)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst supportedUtcRegex = /^(\\d{4}\\-\\d\\d\\-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d\\d\\d)?Z)$/; /* eslint-disable-line no-useless-escape */\r\n\treturn supportedUtcRegex.test(input);\r\n}\r\n\r\n/**\r\n * Convert a date object to a string in ISO8601 UTC format supported by Floodgate (\"yyyy-MM-ddTHH:mm:ssZ\")\r\n * @param input Input date object\r\n */\r\nexport function dateToShortUtcString(input: Date): string {\r\n\tif (!isDate(input)) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction pad(n: number): string {\r\n\t\treturn (n < 10) ? (\"0\" + n) : n.toString();\r\n\t}\r\n\r\n\treturn input.getUTCFullYear() +\r\n\t\t\"-\" + pad(input.getUTCMonth() + 1) +\r\n\t\t\"-\" + pad(input.getUTCDate()) +\r\n\t\t\"T\" + pad(input.getUTCHours()) +\r\n\t\t\":\" + pad(input.getUTCMinutes()) +\r\n\t\t\":\" + pad(input.getUTCSeconds()) +\r\n\t\t\"Z\";\r\n}\r\n\r\n/*\r\nImplementing the Fisher-Yates Shuffle\r\n(Shuffles in situ)\r\n*/\r\nexport function fyShuffle(arrIn: number[]): number[] | undefined {\r\n\r\n\tif (isNOU(arrIn)) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t// If the array is empty or has one element, do nothing.\r\n\tif (arrIn.length === 0 || arrIn.length === 1) {\r\n\t\treturn arrIn;\r\n\t}\r\n\r\n\tlet lastNonShuffledElement = arrIn.length - 1;\r\n\r\n\t// While there is still a non shuffled element.\r\n\twhile (lastNonShuffledElement > 0) {\r\n\r\n\t\t// Pick one of the non shuffled elements (num range [0,lastNonShuffledElement+1))\r\n\t\tconst pickIndex = Math.floor(Math.random() * (lastNonShuffledElement + 1));\r\n\r\n\t\t// And swap it with the last non shuffled element\r\n\t\tconst temp = arrIn[lastNonShuffledElement];\r\n\t\tarrIn[lastNonShuffledElement] = arrIn[pickIndex];\r\n\t\tarrIn[pickIndex] = temp;\r\n\r\n\t\tlastNonShuffledElement--;\r\n\t}\r\n\r\n\treturn arrIn;\r\n}\r\n\r\n/**\r\n * Check if value is an valid user id\r\n * One or two character before colon, a colon, and some word after colon.\r\n * @param {any} value value\r\n */\r\nexport function isValidUserId(value: any): boolean {\r\n\tif (!isString(value)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst supportedUserIdRegex = /^([a-z]{1,2}):\\w+/;\r\n\treturn supportedUserIdRegex.test(value);\r\n}\r\n\r\n/**\r\n * Safely read an object\r\n */\r\nexport function safeParseObject<T>(serializedValue: string, defaultValue?: T): T {\r\n\ttry {\r\n\t\tconst parsedObject = serializedValue && (serializedValue[0] === \"{\" || serializedValue[0] === \"[\")\r\n\t\t\t? JSON.parse(serializedValue)\r\n\t\t\t: undefined;\r\n\t\treturn parsedObject ?? defaultValue;\r\n\t} catch (e) {\r\n\t\t// ignore\r\n\t}\r\n\r\n\treturn defaultValue;\r\n}\r\n\r\n/**\r\n * Find the definition with highest priority\r\n */\r\nexport function findHighestPriorityDefinition(definitions: ICampaignDefinition[]): [ICampaignDefinition, boolean] {\r\n\tlet hasLowerPriorityDefinitions = false;\r\n\t// Get definition that has max priority value (0/null/undefined has highest prioirty)\r\n\tconst maxPriorityDefinition = definitions.reduce((prev, cur) => {\r\n\t\tconst curPriority = cur.primaryPriority || 0;\r\n\t\tconst prevPriority = prev.primaryPriority || 0;\r\n\r\n\t\t// check if we have lower priority (higher number)\r\n\t\tif (curPriority !== prevPriority) {\r\n\t\t\thasLowerPriorityDefinitions = true;\r\n\t\t}\r\n\r\n\t\treturn curPriority < prevPriority ? cur : prev;\r\n\t});\r\n\r\n\treturn [maxPriorityDefinition, hasLowerPriorityDefinitions];\r\n}\r\n", "/**\r\n * Constants.ts\r\n *\r\n * A module for all the constants.\r\n */\r\n\r\n/**\r\n * Telemetry events\r\n */\r\nexport class TelemetryEvent {\r\n\tpublic static CampaignState = class {\r\n\t\tpublic static Deserialize = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_CampaignState_Deserialize_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static FileBasedCampaignStateProvider = class {\r\n\t\tpublic static Load = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_FileBasedCampaignStateProvider_Load_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static HostBasedCampaignStateProvider = class {\r\n\t\tpublic static GetStatesFromHost = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static Floodgate = class {\r\n\t\tpublic static Initialize = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_Floodgate_Initialize_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static Start = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_Floodgate_Start_Failed\";\r\n\t\t\tpublic static Warning = \"FloodgateCore_Floodgate_Start_Warning\";\r\n\t\t\tpublic static SurveysDisabled = \"FloodgateCore_Floodgate_Start_SurveysDisabled\";\r\n\t\t\tpublic static MessagingDisabled = \"FloodgateCore_Floodgate_Start_MessagingDisabled\";\r\n\t\t\tpublic static DynamicCampaignEnabled = \"FloodgateCore_Floodgate_Start_DynamicCampaignEnabled\";\r\n\t\t\tpublic static DynamicCampaignClientUndefined = \"FloodgateCore_Floodgate_Start_DynamicCampaignClientUndefined\";\r\n\t\t};\r\n\r\n\t\tpublic static UserFactsLoad = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_Floodgate_UserFactsLoad_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static UserFactsSpecDeserialization = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_Floodgate_UserFactsSpecDeserialization_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static UserFactsSpecIsAMatch = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Failed\";\r\n\t\t\tpublic static Mismatch = \"FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Mismatch\";\r\n\t\t\tpublic static Summary = \"FloodgateCore_Floodgate_UserFactsSpecIsAMatch_Summary\";\r\n\t\t};\r\n\r\n\t\tpublic static RenderSurvey = class {\r\n\t\t\tpublic static Unsupported = \"FloodgateCore_Floodgate_RenderSurvey_Unsupported\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static FloodgateEngine = class {\r\n\t\tpublic static Make = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_FloodgateEngine_Make_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static Common = class {\r\n\t\t\tpublic static Error = \"FloodgateCore_FloodgateEngine_Common_Error\";\r\n\t\t\tpublic static ActiveSurveys = \"FloodgateCore_FloodgateEngine_Common_ActiveSurveys\";\r\n\t\t};\r\n\r\n\t\tpublic static Start = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_FloodgateEngine_Start_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static StartAsync = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_FloodgateEngine_StartAsync_Failed\";\r\n\t\t\tpublic static Stopped = \"FloodgateCore_FloodgateEngine_StartAsync_Stopped\";\r\n\t\t};\r\n\r\n\t\tpublic static InitialLoadedDefinitions = \"FloodgateCore_FloodgateEngine_InitialLoadedDefinitions\";\r\n\t\tpublic static CampaignTypeDisabledDefinitions = \"FloodgateCore_FloodgateEngine_CampaignTypeDisabledDefinitions\";\r\n\t\tpublic static CampaignInitialTriggerMet = \"FloodgateCore_FloodgateEngine_CampaignInitialTriggerMet\";\r\n\t\tpublic static GetActiveSurveys = \"FloodgateCore_FloodgateEngine_GetActiveSurveys\";\r\n\r\n\t\tpublic static OnSurveyActivated = class {\r\n\t\t\tpublic static ActivationStatsSuppressedSurvey = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey\";\r\n\t\t\tpublic static ClosedChannelType = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType\";\r\n\t\t\tpublic static SurveyNotDefined = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_SurveyNotDefined\";\r\n\t\t\tpublic static SessionSuppressedSurvey = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_SessionSuppressedSurvey\";\r\n\t\t\tpublic static ActivationExpiredSurvey = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationExpiredSurvey\";\r\n\t\t\tpublic static ActivationIrrelevantSurvey = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationIrrelevantSurvey\";\r\n\t\t\tpublic static Error = \"FloodgateCore_FloodgateEngine_OnSurveyActivated_Error\";\r\n\t\t};\r\n\r\n\t\tpublic static CheckGovernanceServiceAndActivateSurvey = class {\r\n\t\t\tpublic static GovernanceServiceForceToDisplay = \"FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceForceToDisplay\";\r\n\t\t\tpublic static GovernanceServiceClientCompleted = \"FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceClientCompleted\";\r\n\t\t\tpublic static GovernanceServiceSurveyInCooldown = \"FloodgateCore_FloodgateEngine_GovernanceService_GovernanceServiceSurveyInCooldown\";\r\n\t\t};\r\n\t\t\r\n\t\tpublic static QueryTriggerMetApisAsync = class {\r\n\t\t\tpublic static Exception = \"FloodgateCore_FloodgateEngine_QueryTriggerMetApisAsync_Exception\";\r\n\t\t\tpublic static QueryTriggerMetApisAsync = \"FloodgateCore_FloodgateEngine_QueryTriggerMetApisAsync\";\r\n\t\t\tpublic static SurveyCdnFailureConcurrently = \"FloodgateCore_FloodgateEngine_QueryTriggerMetApisAsync_SurveyCdnFailureConcurrently\";\r\n\t\t\tpublic static SurveyCdnFailureSequentially = \"FloodgateCore_FloodgateEngine_QueryTriggerMetApisAsync_SurveyCdnFailureSequentially\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static GovernedChannelState = class {\r\n\t\tpublic static Deserialize = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_GovernedChannelState_Deserialize_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static FileBasedGovernedChannelStateProvider = class {\r\n\t\tpublic static Load = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static HostBasedGovernedChannelStateProvider = class {\r\n\t\tpublic static GetStatesFromHost = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static SurveyStatCollectionActivation = class {\r\n\t\tpublic static FromJson = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static ToJson = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static HostBasedSurveyActivationStatsProvider = class {\r\n\t\tpublic static GetSurveyStatsFromHost = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static SurveyStatCollectionEventActivity = class {\r\n\t\tpublic static FromJson = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed\";\r\n\t\t};\r\n\r\n\t\tpublic static ToJson = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static SurveyActivity = class {\r\n\t\tpublic static LogActivity = class {\r\n\t\t\tpublic static EventsReprocessed = \"FloodgateCore_SurveyActivity_LogActivity_EventsReprocessed\";\r\n\t\t\tpublic static SurveysReprocessed = \"FloodgateCore_SurveyActivity_LogActivity_SurveysReprocessed\";\r\n\t\t};\r\n\r\n\t\tpublic static SetActivityTrackingContracts = class {\r\n\t\t\tpublic static DuplicateSurveyID = \"FloodgateCore_SurveyActivity_SetActivityTrackingContracts_DuplicateSurveyID\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static DynamicCampaignDefinitionProvider = class {\r\n\t\tpublic static Load = class {\r\n\t\t\tpublic static EmptyEcsConfig = \"FloodgateCore_DynamicCampaignDefinitionProvider_Load_EmptyEcsConfig\";\r\n\t\t\tpublic static InvalidEcsConfig = \"FloodgateCore_DynamicCampaignDefinitionProvider_Load_InvalidEcsConfig\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static CampaignDefinitionProvider = class {\r\n\t\tpublic static CampaignSurveyTemplate = class {\r\n\t\t\tpublic static SchemaValidationError = \"FloodgateCore_CampaignDefinitionProvider_CampaignSurveyTemplate_validate\";\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static CampaignGovernance = class {\r\n\t\tpublic static LogExperimentTrigger = class {\r\n\t\t\tpublic static Undefined = \"FloodgateCore_CampaignGovernance_LogExperimentTrigger_Undefined\";\t\r\n\t\t\tpublic static Failed = \"FloodgateCore_CampaignGovernance_LogExperimentTrigger_Failed\";\t\r\n\t\t}\r\n\t\tpublic static RetrieveTriggerEventDetail = class {\r\n\t\t\tpublic static Failed = \"FloodgateCore_CampaignGovernance_RetrieveTriggerEventDetail_Failed\";\t\r\n\t\t};\r\n\t\tpublic static NominationCheckCampaigns = \"FloodgateCore_CampaignGovernance_NominationCheckCampaigns\";\r\n\t};\r\n\r\n\tpublic static HttpTransport = class {\r\n\t\tpublic static GET = class {\r\n\t\t\tpublic static Success = \"HttpTransport_Get_Success\";\r\n\t\t\tpublic static Error = \"HttpTransport_Get_Error\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static FloodgateSurveyCdnClient = class {\r\n\t\tpublic static loadCdnStringResource = class {\r\n\t\t\tpublic static Request_Failed = \"Floodgate_Survey_CDN_Request_Failed\";\r\n\t\t\tpublic static Request_Success = \"Floodgate_Survey_CDN_Request_Success\";\r\n\t\t\tpublic static Exception = \"Floodgate_Survey_CDN_Exception\";\r\n\t\t\tpublic static Completed = \"Floodgate_Survey_CDN_Completed\";\r\n\t\t}\r\n\t}\r\n}\r\n", "import { IFloodgateTelemetryLogger, ITelemetryProperties, SurveyType, TreatmentType } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\n// Telemetry logger with no-op logger\r\nclass DefaultFloodgateTelemetryLogger implements IFloodgateTelemetryLogger {\r\n\t// @Override\r\n\tpublic log_TriggerMet(\r\n\t\tcampaignId: string, \r\n\t\tsurveyId: string, \r\n\t\tsurveyType: SurveyType, \r\n\t\tsurveyActivityInfo: string,\r\n\t\tadditionalSurveyInfo: string, \r\n\t\ttreatmentType: TreatmentType, \r\n\t\tisUxSchemaPresent: boolean): void { }\r\n\r\n\t// @Override\r\n\tpublic log_UserSelected(campaignId: string, surveyId: string, surveyType: SurveyType,\r\n\t\tadditionalSurveyInfo: string, treatmentType: TreatmentType): void { }\r\n\r\n\t// @Override\r\n\tpublic log_CampaignLoad_Failed(errorMessage: string): void { }\r\n\r\n\t// @Override\r\n\tpublic log_Error(eventId: string, errorMessage: string): void { }\r\n\r\n\t// @Override\r\n\tpublic log_Event(eventId: string, properties: ITelemetryProperties): void { }\r\n\r\n\t// @Override\r\n\tpublic log_LocalError(message: string, ...data: any[]): void { }\r\n}\r\n\r\nexport class TelemetryLogger {\r\n    private static telemetryLogger: IFloodgateTelemetryLogger = new DefaultFloodgateTelemetryLogger();\r\n\r\n    public static getTelemetryLogger(): IFloodgateTelemetryLogger {\r\n        return TelemetryLogger.telemetryLogger;\r\n    }\r\n\r\n    public static setTelemetryLogger(logger: IFloodgateTelemetryLogger): void {\r\n        if (!logger) {\r\n            throw new Error(\"TelemetryLogger must not be null\");\r\n        }\r\n        TelemetryLogger.telemetryLogger = logger;\r\n    }\r\n}", "import { IUserFact } from \"@ms-ofb/officepersonalization/dist/lib/Common/Models\";\r\nimport { TelemetryEvent } from \"../Constants\";\r\nimport * as Utils from \"../Utils\";\r\nimport { ComparatorType, CurrentTimeIntervalType, IUserFactInput, UserFactLatencyType, UserFactType } from \"./UserFactModel\";\r\nimport { TelemetryLogger } from \"../TelemetryLogger\";\r\n\r\nconst { isNOU, isNumber, isArray } = Utils;\r\nconst commonComparatorTypes: ComparatorType[] = [\r\n\tComparatorType.Equal,\r\n\tComparatorType.NotEqual,\r\n\tComparatorType.GreaterThan,\r\n\tComparatorType.GreaterThanOrEqual,\r\n\tComparatorType.LessThan,\r\n\tComparatorType.LessThanOrEqual,\r\n];\r\n\r\nexport class UserFact {\r\n\tpublic static deserialize(rawUserFactSpec: any): UserFact {\r\n\t\treturn this.validate(rawUserFactSpec) ? new UserFact(rawUserFactSpec) : null;\r\n\t}\r\n\r\n\tprivate static validate(input: any) {\r\n\t\tif (!input) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t\"Input is null or undefined for user fact\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Values is used for type UserFactType.ListOfStrings\r\n\t\tif (!input.Value && input.Values) {\r\n\t\t\tinput.Value = input.Values;\r\n\t\t}\r\n\r\n\t\tif (isNOU(input.Name) || isNOU(input.Type) || isNOU(input.Value)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`Either of the required parameters Name: ${input.Name}, Type: ${input.Type} or Value: ${input.Value} are not provided for the user fact`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!this.validateUserFactType(input.Type)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`Invalid UserFactType value ${input.Type} is provided for user fact`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (input.Type === UserFactType.ListFile) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`Unsupported UserFactType value ${input.Type} is provided for user fact`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (input.LatencyType && !this.validateLatencyType(input.LatencyType)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`Invalid LatencyType value ${input.LatencyType} is provided for user fact of type ${input.Type}`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (input.LatencyType && input.LatencyType !== UserFactLatencyType.None && isNOU(input.LatencyDurationInSeconds)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`LatencyDurationInSeconds value ${input.LatencyDurationInSeconds} is not provided for user fact of type ${input.Type}`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (input.LatencyDurationInSeconds && !isNumber(input.LatencyDurationInSeconds)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`Invalid LatencyDurationInSeconds value ${input.LatencyDurationInSeconds} is provided for user fact of type ${input.Type}`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (input.Type === UserFactType.TimeIntervalInSeconds && isNOU(input.IntervalType)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecDeserialization.Failed,\r\n\t\t\t\t`Required parameter intervalType is not provided for user fact of type ${input.Type}`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst supportedComparatorTypes = this.getComparatorTypes(input.Type);\r\n\t\tif (input.Comparator && !isComparatorTypeSupported(input.Comparator, supportedComparatorTypes)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,\r\n\t\t\t\t`Unsupported comparator type for user fact of type ${input.Type}`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate static getComparatorTypes(userFactType: UserFactType): ComparatorType[] {\r\n\t\tswitch (userFactType) {\r\n\t\t\tcase UserFactType.Boolean:\r\n\t\t\t\treturn [ComparatorType.Equal, ComparatorType.NotEqual];\r\n\t\t\tcase UserFactType.String:\r\n\t\t\t\treturn [ComparatorType.Equal,\r\n\t\t\t\t\t\tComparatorType.NotEqual,\r\n\t\t\t\t\t\tComparatorType.In,\r\n\t\t\t\t\t\tComparatorType.NotIn,\r\n\t\t\t\t\t\tComparatorType.InverseIn,\r\n\t\t\t\t\t\tComparatorType.InverseNotIn];\r\n\t\t\tcase UserFactType.ListOfStrings:\r\n\t\t\t\treturn [ComparatorType.In, ComparatorType.NotIn, ComparatorType.InverseIn, ComparatorType.InverseNotIn];\r\n\t\t\tcase UserFactType.TimeIntervalInSeconds:\r\n\t\t\tcase UserFactType.DateTimeUTC:\r\n\t\t\tcase UserFactType.Number:\r\n\t\t\tcase UserFactType.ListFile:\r\n\t\t\t\treturn commonComparatorTypes;\r\n\t\t\tdefault:\r\n\t\t\t\tassertNever(userFactType);\r\n\t\t}\r\n\r\n\t\treturn commonComparatorTypes;\r\n\t}\r\n\r\n\tprivate static validateLatencyType(latency: UserFactLatencyType) {\r\n\t\treturn (\r\n\t\t\tlatency === UserFactLatencyType.None ||\r\n\t\t\tlatency === UserFactLatencyType.ClientIngestionDateTime ||\r\n\t\t\tlatency === UserFactLatencyType.SourceDateTime ||\r\n\t\t\tlatency === UserFactLatencyType.StorageDateTime\r\n\t\t) ? true : assertNever(latency);\r\n\t}\r\n\r\n\tprivate static validateUserFactType(factType: UserFactType) {\r\n\t\treturn (\r\n\t\t\tfactType === UserFactType.Boolean ||\r\n\t\t\tfactType === UserFactType.DateTimeUTC ||\r\n\t\t\tfactType === UserFactType.Number ||\r\n\t\t\tfactType === UserFactType.String ||\r\n\t\t\tfactType === UserFactType.TimeIntervalInSeconds ||\r\n\t\t\tfactType === UserFactType.ListOfStrings ||\r\n\t\t\tfactType === UserFactType.ListFile\r\n\t\t) ? true : assertNever(factType);\r\n\t}\r\n\r\n\tprivate input: IUserFactInput;\r\n\r\n\tconstructor(input: IUserFactInput) {\r\n\t\tthis.input = input;\r\n\t}\r\n\r\n\tpublic isAMatch(rawUserFact: IUserFact): boolean {\r\n\t\tif (!rawUserFact || !rawUserFact.userFactValue) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!this.isLatencyAcceptable(rawUserFact)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst factType = this.getType();\r\n\t\t\tif (factType === UserFactType.Boolean) {\r\n\t\t\t\treturn compareBooleanValues(this.getValue(), rawUserFact, this.getComparator());\r\n\t\t\t} else if (factType === UserFactType.DateTimeUTC) {\r\n\t\t\t\treturn compareDateTimeUTCValues(this.getValue() as string, rawUserFact, this.getComparator());\r\n\t\t\t} else if (factType === UserFactType.Number) {\r\n\t\t\t\treturn compareNumberValues(this.getValue() as number, rawUserFact, this.getComparator());\r\n\t\t\t} else if (factType === UserFactType.String) {\r\n\t\t\t\treturn compareStringValues(this.getValue() as string, rawUserFact, this.getComparator());\r\n\t\t\t} else if (factType === UserFactType.TimeIntervalInSeconds) {\r\n\t\t\t\treturn compareTimeIntervalValues(this.getValue() as number, rawUserFact, this.getComparator(), this.getIntervalType());\r\n\t\t\t} else if (factType === UserFactType.ListOfStrings) {\r\n\t\t\t\treturn compareListValues(this.getValue() as unknown as string[], rawUserFact, this.getComparator());\r\n\t\t\t} else {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,\r\n\t\t\t\t\t`Unsupported type of user fact was provided ${factType}`);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,\r\n\t\t\t\terror);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getType() {\r\n\t\treturn this.input.Type;\r\n\t}\r\n\r\n\tpublic getName() {\r\n\t\treturn this.input.Name;\r\n\t}\r\n\r\n\tpublic getValue() {\r\n\t\treturn this.input.Value;\r\n\t}\r\n\r\n\tpublic getComparator() {\r\n\t\treturn this.input.Comparator || ComparatorType.Equal;\r\n\t}\r\n\r\n\tpublic getLatencyType() {\r\n\t\treturn this.input.LatencyType || UserFactLatencyType.None;\r\n\t}\r\n\r\n\tpublic getLatencyDurationInSeconds() {\r\n\t\treturn this.input.LatencyDurationInSeconds;\r\n\t}\r\n\r\n\tpublic getIntervalType() {\r\n\t\treturn this.input.IntervalType;\r\n\t}\r\n\r\n\tprivate isLatencyAcceptable(rawUserFact: IUserFact) {\r\n\t\tconst factType = this.getType();\r\n\r\n\t\tif (!isNOU(this.getLatencyDurationInSeconds()) &&\r\n\t\t\t!evaluateFactCandidacy(this.getLatencyType(), this.getLatencyDurationInSeconds(), rawUserFact)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Mismatch, {\r\n\t\t\t\t\tErrorMessage: `Latency duration not acceptable - { Name: \"${rawUserFact.userFactName}\" }`,\r\n\t\t\t\t\tTimeMilliseconds: this.getLatencyDurationInSeconds(),\r\n\t\t\t\t\tType: `${factType}`,\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nfunction evaluateFactCandidacy(latencyType: UserFactLatencyType, latencyDurationInSeconds: number, userFact: IUserFact) {\r\n\tlet userFactTime: string;\r\n\tswitch (latencyType) {\r\n\t\tcase UserFactLatencyType.None:\r\n\t\t\tbreak;\r\n\t\tcase UserFactLatencyType.SourceDateTime:\r\n\t\t\tuserFactTime = userFact.sourceDateTime;\r\n\t\t\tbreak;\r\n\t\tcase UserFactLatencyType.StorageDateTime:\r\n\t\t\tuserFactTime = userFact.storageDateTime;\r\n\t\t\tbreak;\r\n\t\tcase UserFactLatencyType.ClientIngestionDateTime:\r\n\t\t\tuserFactTime = userFact.clientIngestionDateTime;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tassertNever(latencyType);\r\n\t}\r\n\r\n\tif (!isNOU(userFactTime)) {\r\n\t\tconst userFactTimeInMilliseconds = Date.parse(userFactTime);\r\n\t\tconst currentTimeInMilliseconds = Date.now();\r\n\r\n\t\treturn currentTimeInMilliseconds - userFactTimeInMilliseconds <= (latencyDurationInSeconds * 1000);\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction compareBooleanValues(userFactSpecValue: any, rawUserFact: IUserFact, comparator: ComparatorType) {\r\n\tconst rawUserFactValueInBoolean = JSON.parse(rawUserFact.userFactValue.toLowerCase());\r\n\treturn compareValues(!!userFactSpecValue, !!rawUserFactValueInBoolean, comparator);\r\n}\r\n\r\nfunction compareDateTimeUTCValues(userFactSpecValue: string, rawUserFact: IUserFact, comparator: ComparatorType) {\r\n\tconst rawUserFactValueInMilliseconds = Date.parse(rawUserFact.userFactValue);\r\n\tif (!isAValidNumber(rawUserFactValueInMilliseconds, rawUserFact.userFactValue, rawUserFact.userFactName)) {\r\n\t\treturn false;\r\n\t}\r\n\tconst userFactSpecValueInMilliseconds = Date.parse(userFactSpecValue);\r\n\tif (!isAValidNumber(userFactSpecValueInMilliseconds, userFactSpecValue, null, UserFactType.DateTimeUTC)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn compareValues(userFactSpecValueInMilliseconds, rawUserFactValueInMilliseconds, comparator);\r\n}\r\n\r\nfunction compareNumberValues(userFactSpecValue: number, rawUserFact: IUserFact, comparator: ComparatorType) {\r\n\tconst rawUserFactValueInNumber = parseInt(rawUserFact.userFactValue, 10);\r\n\tif (!isAValidNumber(rawUserFactValueInNumber, rawUserFact.userFactValue, rawUserFact.userFactName)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn compareValues(userFactSpecValue, rawUserFactValueInNumber, comparator);\r\n}\r\n\r\nfunction compareStringValues(userFactSpecValue: string, rawUserFact: IUserFact, comparator: ComparatorType) {\r\n\treturn compareValues(userFactSpecValue.toLowerCase(), rawUserFact.userFactValue.toLowerCase(), comparator);\r\n}\r\n\r\nfunction compareTimeIntervalValues(\r\n\tuserFactSpecValue: number, rawUserFact: IUserFact, comparator: ComparatorType, intervalType: CurrentTimeIntervalType) {\r\n\tconst rawUserFactValueInMilliseconds = Date.parse(rawUserFact.userFactValue);\r\n\tif (!isAValidNumber(rawUserFactValueInMilliseconds, rawUserFact.userFactValue, rawUserFact.userFactName)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Diff from now and users input date\r\n\t// IntervalTo - Internval to current date from fact date (fact date is expected to be before current date)\r\n\t// IntervalFrom - Interval from current date to fact date (fact date is expected to be after current date)\r\n\tconst currentTimeInMilliseconds = Date.now();\r\n\tconst currentDateDiff = intervalType === CurrentTimeIntervalType.IntervalTo ?\r\n\t\t(currentTimeInMilliseconds - rawUserFactValueInMilliseconds) : (rawUserFactValueInMilliseconds - currentTimeInMilliseconds);\r\n\tif (currentDateDiff < 0) {\r\n\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Mismatch, {\r\n\t\t\tErrorMessage: `Interval type not acceptable - { Spec: ${userFactSpecValue}, Name: \"${rawUserFact.userFactName}\" }`,\r\n\t\t\tTimeMilliseconds: currentDateDiff,\r\n\t\t\tType: `${intervalType}`,\r\n\t\t},\r\n\t\t);\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst secondInMilliseconds = 1000;\r\n\tconst userFactSpecValueInMilliseconds = userFactSpecValue * secondInMilliseconds;\r\n\r\n\t// check if the above diff satisfies the comparison criteria\r\n\treturn compareValues(userFactSpecValueInMilliseconds, currentDateDiff, comparator);\r\n}\r\n\r\nfunction compareListValues<T extends string | boolean | number>(userFactSpecValue: T[], rawUserFact: IUserFact, comparator: ComparatorType) {\r\n\treturn compareValues(userFactSpecValue, rawUserFact.userFactValue as T, comparator);\r\n}\r\n\r\nfunction isComparatorTypeSupported(comparator: ComparatorType, supportedComparatorTypes: ComparatorType[]) {\r\n\treturn supportedComparatorTypes.indexOf(comparator) !== -1;\r\n}\r\n\r\nfunction compareValues<T extends string | boolean | number>(\r\n\tuserFactSpecValue: T | T[], userFactRawValue: T, comparator: ComparatorType): boolean {\r\n\tswitch (comparator) {\r\n\t\tcase ComparatorType.Equal:\r\n\t\t\treturn userFactRawValue === userFactSpecValue;\r\n\t\tcase ComparatorType.NotEqual:\r\n\t\t\treturn userFactRawValue !== userFactSpecValue;\r\n\t\tcase ComparatorType.GreaterThan:\r\n\t\t\treturn userFactRawValue > userFactSpecValue;\r\n\t\tcase ComparatorType.GreaterThanOrEqual:\r\n\t\t\treturn userFactRawValue >= userFactSpecValue;\r\n\t\tcase ComparatorType.LessThan:\r\n\t\t\treturn userFactRawValue < userFactSpecValue;\r\n\t\tcase ComparatorType.LessThanOrEqual:\r\n\t\t\treturn userFactRawValue <= userFactSpecValue;\r\n\t\tcase ComparatorType.In:\r\n\t\t\treturn isFactValueInTargetItem(userFactSpecValue, userFactRawValue);\r\n\t\tcase ComparatorType.NotIn:\r\n\t\t\treturn !isFactValueInTargetItem(userFactSpecValue, userFactRawValue);\r\n\t\tcase ComparatorType.InverseIn:\r\n\t\t\treturn isFactValueInTargetItem(userFactRawValue, userFactSpecValue as T);\r\n\t\tcase ComparatorType.InverseNotIn:\r\n\t\t\treturn !isFactValueInTargetItem(userFactRawValue, userFactSpecValue as T);\r\n\t\tdefault:\r\n\t\t\tassertNever(comparator);\r\n\t}\r\n}\r\n\r\nfunction assertNever(_: never) {\r\n\treturn false;\r\n}\r\n\r\nfunction isFactValueInTargetItem<T>(userFactTargetValues: T | T[], userFactRawValue: T): boolean {\r\n\tif (typeof userFactRawValue === \"string\") {\r\n\t\tconst factValue = userFactRawValue.toLowerCase();\r\n\t\tif (typeof userFactTargetValues === \"string\") {\r\n\t\t\t// both the inputs are strings, do a plain indexOf\r\n\t\t\treturn (userFactTargetValues as string).toLowerCase().indexOf(factValue) !== -1;\r\n\t\t}\r\n\r\n\t\tif (isArray(userFactTargetValues)) {\r\n\t\t\tconst specValues = userFactTargetValues as T[];\r\n\t\t\treturn specValues.some((specValue) => specValue && specValue.toString().toLowerCase() === factValue);\r\n\t\t}\r\n\t}\r\n\r\n\tif (isArray(userFactTargetValues)) {\r\n\t\treturn (userFactTargetValues as T[]).indexOf(userFactRawValue) !== -1;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction isAValidNumber(numberValue: number, value: string, rawUserFactName: string, factType?: UserFactType) {\r\n\tif (!isNumber(numberValue)) {\r\n\t\tlet errorMessage = `User fact ${rawUserFactName} has invalid value ${value}`;\r\n\t\tif (factType) {\r\n\t\t\terrorMessage = `Invalid value ${value} was provided for user fact of type ${factType}`;\r\n\t\t}\r\n\r\n\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Failed,\r\n\t\t\terrorMessage);\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n", "import { UserFact } from \"./UserFact\";\r\n\r\nexport const deserializeUserFacts = (input: any): UserFact[] => {\r\n\tlet userFacts: UserFact[] = [];\r\n\tfor (const key in input.UserFacts) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(input.UserFacts, key)) {\r\n\t\t\tconst userFactInput = input.UserFacts[key];\r\n\r\n\t\t\tif (userFactInput) {\r\n\t\t\t\tuserFacts.push(UserFact.deserialize(userFactInput));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (userFacts.length === 0) {\r\n\t\tuserFacts = null;\r\n\t}\r\n\r\n\treturn userFacts;\r\n\r\n};\r\n\r\nexport const validateUserFacts = (userFacts: UserFact[]): boolean => {\r\n\tif (userFacts) {\r\n\t\tfor (const key in userFacts) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(userFacts, key) && !userFacts[key]) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n};\r\n", "import {\r\n\tCampaignScopeType,\r\n\tFloodgateStorageProviderFileType,\r\n\tGovernedChannelType,\r\n\tICampaignDefinition,\r\n\tICampaignDefinitionProvider,\r\n\tICampaignDuration,\r\n\tICampaignNominationScheme,\r\n\tICampaignScope,\r\n\tIFloodgateEnvironmentProvider,\r\n\tIFloodgateStorageProvider,\r\n\tIUxSchemaVariables,\r\n\tSurveyInfoAdditionalDataType,\r\n\tSurveyInfoBusinessLevel as BusinessLevel,\r\n\tSurveyInfoLaunchType,\r\n\tIEcsAdapter,\r\n\tEcsResponseBase,\r\n\tTreatmentType,\r\n\tIUxSchema,\r\n\tIUxSchemaAdditionalCapabilitiesTypes,\r\n\tIUxSchemaPage,\r\n\tQuestion,\r\n\tQuestionType,\r\n\tConditionSourceType,\r\n\tLikertQuestion,\r\n\tBranchingTargetType,\r\n\tBranchingTargetPage,\r\n\tBranchingTargetOverride,\r\n\tEcsCachedConfig\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { IUserFactProvider } from \"../Api/IUserFactProvider\";\r\nimport { TelemetryEvent } from \"../Constants\";\r\nimport { UserFact } from \"../UserFact/UserFact\";\r\nimport { deserializeUserFacts, validateUserFacts } from \"../UserFact/UserFactHelper\";\r\nimport * as Utils from \"../Utils\";\r\nimport { TelemetryLogger } from \"../TelemetryLogger\";\r\n\r\nconst { getDistantFuture, isBoolean, isNOU, isNumber, isString, isUtcDatetimeString, stringToDate } = Utils;\r\nlet dynamicUxSchemaVariables: IUxSchemaVariables = {};\r\n\r\n// region Language Range\r\n\r\n/**\r\n * Base class representing a language range in a campaign setting\r\n */\r\nexport abstract class CampaignLanguageRange {\r\n\tpublic static deserialize(input: any): CampaignLanguageRange {\r\n\t\tlet result: CampaignLanguageRange;\r\n\r\n\t\tif (input && input.Type === 0) {\r\n\t\t\tresult = CampaignLanguageRangeLanguageSubtag.deserialize(input);\r\n\t\t}\r\n\r\n\t\tif (result === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected constructor() { }\r\n\r\n\t/**\r\n\t * Returns whether or not the specific language tag (format from RFC 5646) is in this language range specification\r\n\t */\r\n\tpublic abstract isInRange(language: string): boolean;\r\n\r\n\tprotected validate(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * Represents a range matching on the \"language subtag\" against fully specified language tags, according to RFC 5646\r\n */\r\nexport class CampaignLanguageRangeLanguageSubtag extends CampaignLanguageRange {\r\n\tpublic static deserialize(input: any): CampaignLanguageRangeLanguageSubtag {\r\n\t\tconst result = new CampaignLanguageRangeLanguageSubtag();\r\n\r\n\t\tif (input) {\r\n\t\t\tresult.languageSubTag = input.Value;\r\n\t\t}\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Value\")\r\n\tpublic languageSubTag: string;\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\t// @Override\r\n\tpublic isInRange(language: string): boolean {\r\n\t\tif (isNOU(language)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst extractedLanguageSubTag: string = Utils.extractLanguageSubtag(language);\r\n\t\tif (isNOU(extractedLanguageSubTag)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// compare strings ignoring case\r\n\t\treturn extractedLanguageSubTag.toLocaleUpperCase() === this.languageSubTag.toLocaleUpperCase();\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.languageSubTag) || !isString(this.languageSubTag)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t// Reject any spec that isn't exactly a language subtag\r\n\t\tif (!Utils.isValidLanguageSubTag(this.languageSubTag)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Scope\r\n\r\nexport abstract class CampaignScope implements ICampaignScope {\r\n\tpublic static deserialize(input: any): ICampaignScope {\r\n\t\tlet result: ICampaignScope;\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tswitch (input.Type) {\r\n\t\t\tcase CampaignScopeType.CampaignScopeAny:\r\n\t\t\t\tresult = CampaignScopeAny.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignScopeType.CampaignScopeEnvironmentCrossProduct:\r\n\t\t\t\tresult = CampaignScopeEnvironmentCrossProduct.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignScopeType.CampaignScopeUserFactAny:\r\n\t\t\t\tresult = CampaignScopeUserFactAny.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignScopeType.CampaignScopeUserFactAll:\r\n\t\t\t\tresult = CampaignScopeUserFactAll.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (result === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected constructor() { }\r\n\r\n\tpublic abstract isInScope(): boolean;\r\n\r\n\tprotected validate(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignScopeAny extends CampaignScope {\r\n\tpublic static deserialize(input: any): CampaignScopeAny {\r\n\t\treturn new CampaignScopeAny();\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\t// @Override\r\n\tpublic isInScope(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignScopeEnvironmentCrossProduct extends CampaignScope {\r\n\tpublic static deserialize(input: any): CampaignScopeEnvironmentCrossProduct {\r\n\t\tconst result = new CampaignScopeEnvironmentCrossProduct();\r\n\t\tlet languageRanges: CampaignLanguageRange[] = [];\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfor (const key in input.Languages) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(input.Languages, key)) {\r\n\t\t\t\tconst readRange: CampaignLanguageRange = input.Languages[key];\r\n\r\n\t\t\t\tif (readRange) {\r\n\t\t\t\t\tlanguageRanges.push(CampaignLanguageRange.deserialize(readRange));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (languageRanges.length === 0) {\r\n\t\t\tlanguageRanges = null;\r\n\t\t}\r\n\r\n\t\tresult.languageRanges = languageRanges;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Languages\")\r\n\tpublic languageRanges: CampaignLanguageRange[];\r\n\r\n\tprivate environmentProvider: IFloodgateEnvironmentProvider;\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tpublic setEnvironmentProvider(environmentProvider: IFloodgateEnvironmentProvider) {\r\n\t\tthis.environmentProvider = environmentProvider;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isInScope(): boolean {\r\n\t\tif (isNOU(this.languageRanges)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.environmentProvider) || !this.environmentProvider.getLanguage()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst language = this.environmentProvider.getLanguage();\r\n\t\t// If the environment matches a single pattern, then this is a yes\r\n\t\tfor (const key in this.languageRanges) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.languageRanges, key)) {\r\n\t\t\t\tconst range = this.languageRanges[key];\r\n\r\n\t\t\t\tif (range.isInRange(language)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Null languageRanges is allowed, means will match with everything.\r\n\t\tif (this.languageRanges) {\r\n\t\t\tfor (const key in this.languageRanges) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(this.languageRanges, key) && !this.languageRanges[key]) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignScopeUserFactAny extends CampaignScope {\r\n\tpublic static deserialize(input: any): CampaignScopeUserFactAny {\r\n\t\tconst result = new CampaignScopeUserFactAny();\r\n\t\tresult.userFacts = deserializeUserFacts(input);\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"UserFacts\")\r\n\tpublic userFacts: UserFact[];\r\n\r\n\tprivate userFactsProvider?: IUserFactProvider;\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tpublic setUserFactsProvider(userFactsProvider?: IUserFactProvider) {\r\n\t\tthis.userFactsProvider = userFactsProvider;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isInScope(): boolean {\r\n\t\tif (isNOU(this.userFacts)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (!this.userFactsProvider) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// If one of the user fact matches, then this is a yes\r\n\t\treturn this.userFacts.some((userFact) => {\r\n\t\t\tconst rawUserFact = this.userFactsProvider.getUserFact(userFact.getName());\r\n\t\t\treturn userFact.isAMatch(rawUserFact);\r\n\t\t});\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn validateUserFacts(this.userFacts);\r\n\t}\r\n}\r\n\r\nexport class CampaignScopeUserFactAll extends CampaignScope {\r\n\tpublic static deserialize(input: any): CampaignScopeUserFactAll {\r\n\t\tconst result = new CampaignScopeUserFactAll();\r\n\t\tresult.userFacts = deserializeUserFacts(input);\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"UserFacts\")\r\n\tpublic userFacts: UserFact[];\r\n\r\n\tprivate userFactsProvider?: IUserFactProvider;\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tpublic setUserFactsProvider(userFactsProvider?: IUserFactProvider) {\r\n\t\tthis.userFactsProvider = userFactsProvider;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isInScope(): boolean {\r\n\t\tif (isNOU(this.userFacts)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (!this.userFactsProvider) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Get all of the mismatched user facts\r\n\t\tconst mismatchedFacts = this.userFacts.filter((userFact) => {\r\n\t\t\tconst rawUserFact = this.userFactsProvider.getUserFact(userFact.getName());\r\n\t\t\treturn !userFact.isAMatch(rawUserFact);\r\n\t\t});\r\n\r\n\t\tif (mismatchedFacts.length > 0) {\r\n\t\t\tconst mismatchedNames = mismatchedFacts.map((userFact) => userFact.getName());\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsSpecIsAMatch.Summary, {\r\n\t\t\t\tCount: mismatchedFacts.length,\r\n\t\t\t\tMessage: mismatchedNames.toString(),\r\n\t\t\t});\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// If all of the user facts match, then this is a yes\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn validateUserFacts(this.userFacts);\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Durations\r\n\r\n/**\r\n * Base class representing a duration in a campaign setting\r\n */\r\nexport abstract class CampaignDuration implements ICampaignDuration {\r\n\tpublic static deserialize(input: any): CampaignDuration {\r\n\t\tlet result: CampaignDuration;\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tswitch (input.Type) {\r\n\t\t\tcase 0:\r\n\t\t\t\tresult = CampaignDurationTimeInterval.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tresult = CampaignDurationSingleBuildChange.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (result === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected constructor() { }\r\n\r\n\tpublic abstract asTimeIntervalSeconds(): number;\r\n\r\n\tprotected validate(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * A Duration expressed in seconds. UTC datetime comparisons are used to determine expiration.\r\n */\r\nexport class CampaignDurationTimeInterval extends CampaignDuration {\r\n\tpublic static deserialize(input: any): CampaignDurationTimeInterval {\r\n\t\tconst result = new CampaignDurationTimeInterval();\r\n\r\n\t\tif (input) {\r\n\t\t\tresult.intervalSeconds = input.IntervalSeconds;\r\n\t\t}\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"IntervalSeconds\")\r\n\tpublic intervalSeconds: number;\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\t// @Override\r\n\tpublic asTimeIntervalSeconds(): number {\r\n\t\treturn this.intervalSeconds;\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.intervalSeconds)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * A Duration representing exactly 1 change in build number\r\n */\r\nexport class CampaignDurationSingleBuildChange extends CampaignDuration {\r\n\tpublic static deserialize(input: any): CampaignDurationSingleBuildChange {\r\n\t\treturn new CampaignDurationSingleBuildChange();\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\t// @Override\r\n\tpublic asTimeIntervalSeconds(): number {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/**\r\n * Class representing AdditionalDataRequested in CampaignDefinition\r\n */\r\nexport class CampaignAdditionalDataRequested {\r\n\tpublic static deserialize(additionalDataRequested: string[]): CampaignAdditionalDataRequested {\r\n\t\tconst result = new CampaignAdditionalDataRequested();\r\n\r\n\t\tif (!isNOU(additionalDataRequested)) {\r\n\t\t\t// Convert from AdditionalDataRequested string to enum\r\n\t\t\tresult.additionalData = [];\r\n\t\t\tfor (const additionalData of additionalDataRequested) {\r\n\t\t\t\tif (additionalData === \"EmailAddress\") {\r\n\t\t\t\t\tresult.additionalData.push(SurveyInfoAdditionalDataType.EmailAddress);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic additionalData: SurveyInfoAdditionalDataType[];\r\n\r\n\tprivate validate(): boolean {\r\n\t\tif (isNOU(this.additionalData)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n// endregion\r\n\r\n// region Distribution Schemes\r\n\r\nexport abstract class CampaignDistribution {\r\n\tpublic static deserialize(input: any): CampaignDistribution {\r\n\t\tlet result: CampaignDistribution;\r\n\r\n\t\tif (input && input.Type === 0) {\r\n\t\t\tresult = CampaignDistributionRamp.deserialize(input);\r\n\t\t}\r\n\r\n\t\tif (result === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected constructor() { }\r\n\r\n\tprotected validate(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignDistributionRamp extends CampaignDistribution {\r\n\tpublic static deserialize(input: any): CampaignDistributionRamp {\r\n\t\tconst result = new CampaignDistributionRamp();\r\n\r\n\t\tif (input) {\r\n\t\t\tresult.maxDelaySeconds = input.MaxDelaySeconds;\r\n\t\t\tresult.chunks = input.Chunks;\r\n\t\t}\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// The time window over which the ramp will distribute start dates.\r\n\t// @SerializedName(\"MaxDelaySeconds\")\r\n\tpublic maxDelaySeconds: number;\r\n\r\n\t// The number of discrete buckets to divide the time window (maxDelaySeconds) into\r\n\t// @SerializedName(\"Chunks\")\r\n\tpublic chunks: number;\r\n\r\n\tprivate constructor() { super(); }\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.maxDelaySeconds) || this.maxDelaySeconds < 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.chunks) || this.chunks < 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Nomination Scheme\r\n\r\nexport abstract class CampaignNominationScheme implements ICampaignNominationScheme {\r\n\tpublic static deserialize(input: any): CampaignNominationScheme {\r\n\t\tlet result: CampaignNominationScheme;\r\n\r\n\t\tif (input && input.Type === 0) {\r\n\t\t\tresult = CampaignNominationSchemeRatioPercentage.deserialize(input);\r\n\t\t}\r\n\r\n\t\tif (result === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// The amount of time (in seconds) for which the survey is active, if the nominationPeriod can't be interpreted as a time interval\r\n\t// note: This is only used when nominationPeriod is not of a type that can be interpreted as a time interval, otherwise\r\n\t// that value is used instead\r\n\t// @SerializedName(\"FallbackSurveyDurationSeconds\")\r\n\tpublic fallbackSurveyDurationSeconds: number;\r\n\r\n\t// When the user never sees the survey during their candidacy (or anti-candidacy), this is the duration that must lapse\r\n\t// before re- nominating\r\n\t// @SerializedName(\"NominationPeriod\")\r\n\tpublic nominationPeriod: CampaignDuration;\r\n\r\n\t// When the user does sees the survey during their candidacy, this is the duration that must lapse before re-evaluating\r\n\t// candidacy. Generally recommended that this be greater than nominationPeriod\r\n\t// @SerializedName(\"CooldownPeriod\")\r\n\tpublic cooldownPeriod: CampaignDuration;\r\n\r\n\tprotected constructor() { }\r\n\r\n\t/**\r\n\t * @return The amount of time the survey should be active, in seconds. Abstracts the difference between nominationPeriod and the fallback\r\n\t */\r\n\tpublic getActiveSurveyTimeIntervalSeconds(): number {\r\n\t\tconst nominationTimIntervalSeconds: number = this.nominationPeriod.asTimeIntervalSeconds();\r\n\r\n\t\tif (isNumber(nominationTimIntervalSeconds)) {\r\n\t\t\treturn nominationTimIntervalSeconds;\r\n\t\t}\r\n\r\n\t\treturn this.fallbackSurveyDurationSeconds;\r\n\t}\r\n\r\n\t/**\r\n\t * @return The survey start time, possibly adjusted by an underlying DistributionModel.\r\n\t */\r\n\tpublic calculateSurveyStartTimeFromDate(soonestStartTime: Date): Date {\r\n\t\t// No adjustment in base class.  Derived classes can override and implement delays like a \"ramp\"\r\n\t\treturn soonestStartTime ? soonestStartTime : new Date();\r\n\t}\r\n\r\n\t/**\r\n\t * @return The survey expiration time, based on the nomination periods and the survey's adjusted start time\r\n\t */\r\n\tpublic calculateSurveyExpirationTimeFromSurveyStartTime(surveyStartTime: Date): Date {\r\n\t\tsurveyStartTime = surveyStartTime ? surveyStartTime : new Date();\r\n\t\treturn Utils.addSecondsWithoutOverflow(surveyStartTime, this.getActiveSurveyTimeIntervalSeconds());\r\n\t}\r\n\r\n\t/**\r\n\t * @return The appropriate campaign cool down based on whether or not the user activated the survey\r\n\t */\r\n\tpublic getCampaignCooldown(didUserActivateSurvey: boolean): CampaignDuration {\r\n\t\tif (didUserActivateSurvey) {\r\n\t\t\treturn this.cooldownPeriod;\r\n\t\t} else {\r\n\t\t\treturn this.nominationPeriod;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Evaluate this rule set based on a random number\r\n\t *\r\n\t * @return true if the user should be a candidate, false if they should be an anti-candidate\r\n\t */\r\n\tpublic abstract evaluateNominationRules(): boolean;\r\n\r\n\tprotected validate(): boolean {\r\n\t\tif (isNOU(this.nominationPeriod)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.cooldownPeriod)) {\r\n\t\t\tthis.cooldownPeriod = this.nominationPeriod;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.nominationPeriod.asTimeIntervalSeconds())) {\r\n\t\t\tif (!isNumber(this.fallbackSurveyDurationSeconds) || this.fallbackSurveyDurationSeconds <= 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * Class representing a set of campaign nomination rules to evaluate for in-scope campaigns:\r\n * percentage\r\n * re-election durations\r\n * distribution model (for \"nominated\" candidates)\r\n */\r\nexport class CampaignNominationSchemeRatioPercentage extends CampaignNominationScheme {\r\n\tpublic static deserialize(input: any): CampaignNominationSchemeRatioPercentage {\r\n\t\tconst result = new CampaignNominationSchemeRatioPercentage();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (input.DistributionModel) {\r\n\t\t\tresult.distributionModel = CampaignDistribution.deserialize(input.DistributionModel);\r\n\t\t}\r\n\r\n\t\tif (input.CooldownPeriod) {\r\n\t\t\tresult.cooldownPeriod = CampaignDuration.deserialize(input.CooldownPeriod);\r\n\t\t}\r\n\r\n\t\tif (input.NominationPeriod) {\r\n\t\t\tresult.nominationPeriod = CampaignDuration.deserialize(input.NominationPeriod);\r\n\t\t}\r\n\r\n\t\tresult.fallbackSurveyDurationSeconds = input.FallbackSurveyDurationSeconds;\r\n\t\tresult.percentageDenominator = input.PercentageDenominator;\r\n\t\tresult.percentageNumerator = input.PercentageNumerator;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// The numerator when calculating the percentage of users that should be selected as candidates.  Must\r\n\t// satisfy 0 <= percentageNumerator <= percentageDenominator\r\n\t// @SerializedName(\"PercentageNumerator\")\r\n\tpublic percentageNumerator: number;\r\n\r\n\t// The denominator when calculating the percentage of users that should be selected as candidates.  Must be greater than 0.\r\n\t// @SerializedName(\"PercentageDenominator\")\r\n\tpublic percentageDenominator: number;\r\n\r\n\t// NYI - For candidates, allows the Survey start/end dates to be shifted forward in time, to help achieve a smoother signal\r\n\t// @SerializedName(\"DistributionModel\")\r\n\tpublic distributionModel: CampaignDistribution;\r\n\r\n\tprivate constructor() { super(); }\r\n\r\n\t// @Override\r\n\tpublic evaluateNominationRules(): boolean {\r\n\t\tconst rand: number = Math.random();\r\n\t\t// Creates a random number between [0 to (percentageDenominator - 1)]\r\n\t\t// In range [0 to (percentageDenominator - 1)] exactly 'percentageNumerator' values are < percentageNumerator\r\n\t\treturn Math.floor(rand * this.percentageDenominator) < this.percentageNumerator;\r\n\t}\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.percentageDenominator) || !isNumber(this.percentageNumerator)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.percentageDenominator <= 0 || this.percentageNumerator < 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.percentageNumerator > this.percentageDenominator) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// distribution model may be null\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Survey Event Definitions\r\nexport abstract class CampaignSurveyEvent {\r\n\tpublic static deserialize(input: any): CampaignSurveyEvent {\r\n\t\tlet result: CampaignSurveyEvent;\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tswitch (input.Type) {\r\n\t\t\tcase 0:\r\n\t\t\t\tresult = CampaignSurveyEventCountedActivity.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1:\r\n\t\t\t\tresult = CampaignSurveyEventCountedActivitySequence.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (result === undefined) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected constructor() { }\r\n\r\n\tprotected validate(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyEventCountedActivity extends CampaignSurveyEvent {\r\n\tpublic static deserialize(input: any): CampaignSurveyEventCountedActivity {\r\n\t\tconst result = new CampaignSurveyEventCountedActivity();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.activity = input.Activity;\r\n\t\tresult.count = input.Count;\r\n\t\tresult.isAggregate = input.IsAggregate;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Activity\")\r\n\tpublic activity: string;\r\n\r\n\t// @SerializedName(\"Count\")\r\n\tpublic count: number;\r\n\r\n\t// @SerializedName(\"IsAggregate\")\r\n\tpublic isAggregate: boolean;\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.activity) || !isString(this.activity)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.count) || this.count <= 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isBoolean(this.isAggregate)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyEventCountedActivitySequence extends CampaignSurveyEvent {\r\n\tpublic static deserialize(input: any): CampaignSurveyEventCountedActivitySequence {\r\n\t\tconst result = new CampaignSurveyEventCountedActivitySequence();\r\n\t\tlet sequence: CampaignSurveyEventCountedActivity[] = [];\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tfor (const key in input.Sequence) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(input.Sequence, key)) {\r\n\t\t\t\tconst readActivity: CampaignSurveyEventCountedActivity = input.Sequence[key];\r\n\r\n\t\t\t\tif (readActivity) {\r\n\t\t\t\t\tsequence.push(CampaignSurveyEventCountedActivity.deserialize(readActivity));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (sequence.length === 0) {\r\n\t\t\tsequence = null;\r\n\t\t}\r\n\r\n\t\tresult.sequence = sequence;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Sequence\")\r\n\tpublic sequence: CampaignSurveyEventCountedActivity[];\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\t// @Override\r\n\tprotected validate(): boolean {\r\n\t\tif (!super.validate()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.sequence)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfor (const key in this.sequence) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.sequence, key) && !this.sequence[key]) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Survey Content Definitions\r\n\r\nexport class CampaignSurveyContent {\r\n\tpublic static deserialize(input: any, optionalComponents?: boolean): CampaignSurveyContent {\r\n\t\tconst result = new CampaignSurveyContent();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.prompt = CampaignSurveyContentPrompt.deserialize(input.Prompt);\r\n\t\tresult.rating = CampaignSurveyContentRating.deserialize(input.Rating);\r\n\t\tresult.comment = CampaignSurveyContentComment.deserialize(input.Question);\r\n\t\tresult.multipleChoice = CampaignSurveyContentMultipleChoice.deserialize(input.MultipleChoice);\r\n\t\tresult.intercept = CampaignSurveyContentIntercept.deserialize(input.Intercept);\r\n\t\tresult.cvSurvey = CampaignSurveyContentCVSurvey.deserialize(input.CVSurveyParams);\r\n\r\n\t\tif (!result.validate(optionalComponents)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"CVSurvey\")\r\n\tpublic cvSurvey: CampaignSurveyContentCVSurvey;\r\n\r\n\t// @SerializedName(\"Prompt\")\r\n\tpublic prompt: CampaignSurveyContentPrompt;\r\n\r\n\t// @SerializedName(\"Rating\")\r\n\tpublic rating: CampaignSurveyContentRating;\r\n\r\n\t// @SerializedName(\"Question\")\r\n\tpublic comment: CampaignSurveyContentComment;\r\n\r\n\t// @SerializedName(\"MultipleChoice\")\r\n\tpublic multipleChoice: CampaignSurveyContentMultipleChoice;\r\n\r\n\t// @SerializedName(\"Intercept\")\r\n\tpublic intercept: CampaignSurveyContentIntercept;\r\n\r\n\tpublic validate(optionalComponents?: boolean): boolean {\r\n\t\tif (!isNOU(this.intercept)) {\r\n\t\t\t// An intercept survey only requires intercept.\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.prompt)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (optionalComponents) {\r\n\t\t\treturn !isNOU(this.rating) ||\r\n\t\t\t\t!isNOU(this.multipleChoice) ||\r\n\t\t\t\t!isNOU(this.comment);\r\n\t\t}\r\n\r\n\t\treturn !isNOU(this.rating) && !isNOU(this.comment);\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyContentMultipleChoice {\r\n\tpublic static deserialize(input: any): CampaignSurveyContentMultipleChoice {\r\n\t\tconst result = new CampaignSurveyContentMultipleChoice();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.question = input.Question;\r\n\t\tresult.availableOptions = input.AvailableOptions;\r\n\t\tresult.minNumberOfSelectedOptions = input.MinNumberOfSelectedOptions;\r\n\t\tresult.maxNumberOfSelectedOptions = input.MaxNumberOfSelectedOptions;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Question\")\r\n\tpublic question: string;\r\n\r\n\t// @SerializedName(\"AvailableOptions\")\r\n\tpublic availableOptions: string[];\r\n\r\n\t// @SerializedName(\"MinNumberOfSelectedOptions\")\r\n\tpublic minNumberOfSelectedOptions: number;\r\n\r\n\t// @SerializedName(\"MaxNumberOfSelectedOptions\")\r\n\tpublic maxNumberOfSelectedOptions: number;\r\n\r\n\tprivate validate(): boolean {\r\n\t\tif (isNOU(this.question) || !isString(this.question) ||\r\n\t\t\tisNOU(this.availableOptions) || !Array.isArray(this.availableOptions) || this.availableOptions.length < 2 ||\r\n\t\t\tisNOU(this.minNumberOfSelectedOptions) || !isNumber(this.minNumberOfSelectedOptions) ||\r\n\t\t\tisNOU(this.maxNumberOfSelectedOptions) || !isNumber(this.maxNumberOfSelectedOptions)) {\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// expect all availableOptions values to be string\r\n\t\tfor (const key in this.availableOptions) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.availableOptions, key)) {\r\n\t\t\t\tif (!isString(this.availableOptions[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyContentCVSurvey {\r\n\tpublic static deserialize(input: any): CampaignSurveyContentCVSurvey {\r\n\t\tconst result = new CampaignSurveyContentCVSurvey();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.customerVoiceFormId = input.CustomerVoiceFormId;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"FormId\")\r\n\tpublic customerVoiceFormId: string;\r\n\r\n\tprivate validate(): boolean {\r\n\r\n\t\treturn (!isNOU(this.customerVoiceFormId) && isString(this.customerVoiceFormId));\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyContentPrompt {\r\n\tpublic static deserialize(input: any): CampaignSurveyContentPrompt {\r\n\t\tconst result = new CampaignSurveyContentPrompt();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.title = input.Title;\r\n\t\tresult.question = input.Question;\r\n\t\tresult.yesLabel = input.YesLabel;\r\n\t\tresult.noLabel = input.NoLabel;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Title\")\r\n\tpublic title: string;\r\n\r\n\t// @SerializedName(\"Question\")\r\n\tpublic question: string;\r\n\r\n\t// @SerializedName(\"YesLabel\")\r\n\tpublic yesLabel: string;\r\n\r\n\t// @SerializedName(\"NoLabel\")\r\n\tpublic noLabel: string;\r\n\r\n\tprivate validate(): boolean {\r\n\t\tif (isNOU(this.title) || !isString(this.title) ||\r\n\t\t\tisNOU(this.question) || !isString(this.question) ||\r\n\t\t\tisNOU(this.yesLabel) || !isString(this.yesLabel) ||\r\n\t\t\tisNOU(this.noLabel) || !isString(this.noLabel)) {\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyContentIntercept {\r\n\tpublic static deserialize(input: any): CampaignSurveyContentIntercept {\r\n\t\tconst result = new CampaignSurveyContentIntercept();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.title = input.Title;\r\n\t\tresult.question = input.Question;\r\n\t\tresult.url = input.Url;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Title\")\r\n\tpublic title: string;\r\n\r\n\t// @SerializedName(\"Question\")\r\n\tpublic question: string;\r\n\r\n\t// @SerializedName(\"Url\")\r\n\tpublic url: string;\r\n\r\n\tprivate validate(): boolean {\r\n\t\tif (isNOU(this.title) || !isString(this.title) ||\r\n\t\t\tisNOU(this.question) || !isString(this.question) ||\r\n\t\t\tisNOU(this.url) || !isString(this.url)) {\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyContentRating {\r\n\tpublic static deserialize(input: any): CampaignSurveyContentRating {\r\n\t\tconst result = new CampaignSurveyContentRating();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.isZeroBased = input.IsZeroBased;\r\n\t\tresult.question = input.Question;\r\n\t\tresult.ratingValuesAscending = input.RatingValuesAscending;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"IsZeroBased\")\r\n\tpublic isZeroBased: boolean;\r\n\r\n\t// @SerializedName(\"Question\")\r\n\tpublic question: string;\r\n\r\n\t// @SerializedName(\"RatingValuesAscending\")\r\n\tpublic ratingValuesAscending: string[];\r\n\r\n\tprivate validate(): boolean {\r\n\t\t// expect ratingValuesAscending to contain between 2 to 11 values\r\n\t\tif (isNOU(this.question) || !isString(this.question) ||\r\n\t\t\tisNOU(this.ratingValuesAscending) || !Array.isArray(this.ratingValuesAscending) ||\r\n\t\t\tthis.ratingValuesAscending.length < 2 || this.ratingValuesAscending.length > 11) {\r\n\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.isZeroBased)) {\r\n\t\t\t// default to false if not provided\r\n\t\t\tthis.isZeroBased = false;\r\n\t\t} else if (!isBoolean(this.isZeroBased)) {\r\n\t\t\t// fail validation if non boolean value is provided\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// expect all ratingValuesAscending values to be string\r\n\t\tfor (const key in this.ratingValuesAscending) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.ratingValuesAscending, key)) {\r\n\t\t\t\tif (!isString(this.ratingValuesAscending[key])) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyContentComment {\r\n\tpublic static deserialize(input: any): CampaignSurveyContentComment {\r\n\t\tconst result = new CampaignSurveyContentComment();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// @SerializedName(\"Question\")\r\n\t\tresult.question = input.Question;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"Question\")\r\n\tpublic question: string;\r\n\r\n\tprivate validate(): boolean {\r\n\t\tif (isNOU(this.question) || !isString(this.question)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Survey Metadata Definitions\r\n\r\nexport class CampaignSurveyMetadata {\r\n\tpublic static deserialize(input: any): CampaignSurveyMetadata {\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst result = new CampaignSurveyMetadata();\r\n\t\tresult.contentMetadata = input.ContentMetadata;\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"ContentMetadata\")\r\n\tpublic contentMetadata: object;\r\n\r\n\tpublic validate(): boolean {\r\n\t\tif (isNOU(this.contentMetadata) || !Utils.isObject(this.contentMetadata)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Survey Template definitions\r\n\r\nexport abstract class CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplate, string] {\r\n\t\tlet result: CampaignSurveyTemplate;\r\n\t\tlet validationError = '';\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tswitch (input.Type) {\r\n\t\t\tcase CampaignSurveyTemplate.Type.Nps5PointStatic:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateNps5PointStatic.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.Nps11PointStatic:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateNps11PointStatic.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.Fps:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateFps.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.Nlqs:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateNlqs.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.Nps:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateNps.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.GenericMessagingSurface:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateGenericMessagingSurface.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.Intercept:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateIntercept.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t\tcase CampaignSurveyTemplate.Type.Dialog:\r\n\t\t\t\t[result, validationError] = CampaignSurveyTemplateDialog.deserialize(input);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (isNOU(result)) {\r\n\t\t\treturn [null, validationError];\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\t// @SerializedName(\"ActivationEvent\")\r\n\tpublic activationEvent: CampaignSurveyEvent;\r\n\r\n\t// @SerializedName(\"Content\")\r\n\tpublic content: CampaignSurveyContent;\r\n\r\n\t// @SerializedName(\"Metadata\")\r\n\tpublic metadata: CampaignSurveyMetadata;\r\n\r\n\t// @SerializedName(\"MaxLaunches\")\r\n\tpublic maxLaunches: number;\r\n\r\n\t// @SerializedName(\"MaxLaunchesPerSession\")\r\n\tpublic maxLaunchesPerSession: number;\r\n\r\n\t// @SerializedName(\"PreferredLaunchType\")\r\n\tpublic preferredLaunchType: SurveyInfoLaunchType;\r\n\r\n\t// @SerializedName(\"UxSchema\")\r\n\tpublic uxSchema: IUxSchema;\r\n\r\n\tprotected constructor() { }\r\n\r\n\tprotected validate(): string {\r\n\t\tif (isNOU(this.activationEvent)) {\r\n\t\t\treturn 'The survey template is missing the activation event.';\r\n\t\t}\r\n\t\t// Validate UX Schema\r\n\t\tif (this.uxSchema) {\r\n\t\t\t// Schema pages validation\r\n\t\t\tconst pagesValidityError = this.validatePages(this.uxSchema.pages)\r\n\t\t\tif (pagesValidityError) {\r\n\t\t\t\treturn pagesValidityError\r\n\t\t\t}\r\n\t\t\t// Schema variables validation\r\n\t\t\tif (this.uxSchema.variables) {\r\n\t\t\t\tfor (const key of Object.keys(this.uxSchema.variables)) {\r\n\t\t\t\t\tif (this.uxSchema.variables[key] === null || this.uxSchema.variables[key] === undefined) {\r\n\t\t\t\t\t\treturn `Schema variable of key ${key} does not have a corresponding value.`\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(dynamicUxSchemaVariables, key)) {\r\n\t\t\t\t\t\tthis.uxSchema.variables[key] = dynamicUxSchemaVariables[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treturn `Host app does not provide Schema variable of key ${key}.`\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Additional capabilities validation\r\n\t\t\tif (this.uxSchema.additionalCapabilities) {\r\n\t\t\t\tif (this.uxSchema.additionalCapabilities[IUxSchemaAdditionalCapabilitiesTypes.Email]?.targetPage == null) {\r\n\t\t\t\t\treturn 'Schema additional capability of Email is defined but has no target page.'\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst targetPage = this.uxSchema.additionalCapabilities[IUxSchemaAdditionalCapabilitiesTypes.Email]?.targetPage as number\r\n\t\t\t\t\tif (targetPage < 0 || targetPage >= this.uxSchema.pages.length) {\r\n\t\t\t\t\t\treturn `Schema additional capability of Email has its target page equal to ${targetPage} which is out of range.`\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Branching rules validation\r\n\t\t\tif (this.uxSchema.branchingRules && Array.isArray(this.uxSchema.branchingRules) && this.uxSchema.branchingRules.length > 0) {\r\n\t\t\t\tfor (const rule of this.uxSchema.branchingRules) {\r\n\t\t\t\t\tif (rule.conditions && Array.isArray(rule.conditions) && rule.conditions.length > 0) {\r\n\t\t\t\t\t\tfor (const condition of rule.conditions) {\r\n\t\t\t\t\t\t\tif (condition.conditionType == null ||\r\n\t\t\t\t\t\t\t\tcondition.conditionValue == null ||\r\n\t\t\t\t\t\t\t\tcondition.sourceId == null ||\r\n\t\t\t\t\t\t\t\tcondition.sourceType == null) {\r\n\t\t\t\t\t\t\t\treturn 'A condition in the branching rules is missing a type/value/sourceId/sourceType.'\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (condition.sourceType === ConditionSourceType.Variable) {\r\n\t\t\t\t\t\t\t\t\tif (!this.uxSchema.variables ||\r\n\t\t\t\t\t\t\t\t\t\t!Object.keys(this.uxSchema.variables).includes(condition.sourceId)) {\r\n\t\t\t\t\t\t\t\t\t\treturn `The variable ${condition.sourceId} is used in the branching rules but not defined among the schema variables.`\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif (condition.sourcePageIndex == null) {\r\n\t\t\t\t\t\t\t\t\t\treturn 'A condition in the branching rules of type question is missing a sourcePageIndex.'\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tconst questionIndex = this.uxSchema.pages[condition.sourcePageIndex]?.questions.findIndex(\r\n\t\t\t\t\t\t\t\t\t\t\t(question) => question.id === condition.sourceId)\r\n\t\t\t\t\t\t\t\t\t\tif ( questionIndex == null || questionIndex < 0) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn `The target question with id ${condition.sourceId} does not exist.`\r\n\t\t\t\t\t\t\t\t\t\t} else if (condition.subSourceIndex) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (this.uxSchema.pages[condition.sourcePageIndex].questions[questionIndex].type != QuestionType.Likert) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn `A subsource page index of ${condition.subSourceIndex} is provided\r\nbut the question with id ${condition.sourceId} is not of type Likert.`\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst likertQuestion = this.uxSchema.pages[condition.sourcePageIndex].questions[questionIndex] as LikertQuestion\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (likertQuestion.horizontalStatements.length <= condition.subSourceIndex) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn `The likert question with id ${condition.sourceId} doesn't have\r\na horizontal option with index ${condition.subSourceIndex}.`\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (rule.targets && Array.isArray(rule.targets) && rule.targets.length > 0) {\r\n\t\t\t\t\t\tfor (const target of rule.targets) {\r\n\t\t\t\t\t\t\tif (target.type === BranchingTargetType.Page) {\r\n\t\t\t\t\t\t\t\tconst pageTarget = target as BranchingTargetPage\r\n\t\t\t\t\t\t\t\tif (pageTarget.hiddenPageIndices.filter(index => index < 0).length > 0 ||\r\n\t\t\t\t\t\t\t\tpageTarget.hiddenPageIndices.filter(index => index >= this.uxSchema.pages.length).length > 0) {\r\n\t\t\t\t\t\t\t\t\treturn 'Some of the hidden pages indexes are out of range.'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconst overrideTarget = target as BranchingTargetOverride\r\n\t\t\t\t\t\t\t\tif(overrideTarget.targetPageIndex < 0 || overrideTarget.targetPageIndex >= this.uxSchema.pages.length) {\r\n\t\t\t\t\t\t\t\t\treturn 'An override target has its page index out of range.'\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tconst overrideTargetQuestion = this.uxSchema.pages[overrideTarget.targetPageIndex].questions.find(question =>\r\n\t\t\t\t\t\t\t\t\t\tquestion.id === overrideTarget.targetOverrideId)\r\n\t\t\t\t\t\t\t\t\tif (!overrideTargetQuestion) {\r\n\t\t\t\t\t\t\t\t\t\treturn `An override target's question on page ${overrideTarget.targetPageIndex} does not exist`\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate validatePages(schemaPages: IUxSchemaPage[]) : string {\r\n\t\tif (!schemaPages || !Array.isArray(schemaPages) || schemaPages.length === 0) {\r\n\t\t\treturn 'Schema has no pages.'\r\n\t\t} else {\r\n\t\t\tfor (const page of schemaPages) {\r\n\t\t\t\tif (!page.id) {\r\n\t\t\t\t\treturn 'Page is missing an id.'\r\n\t\t\t\t} else if (page.displayName == null) {\r\n\t\t\t\t\treturn 'Page is missing a displayName.'\r\n\t\t\t\t} else if (!page.questions || !Array.isArray(page.questions) || page.questions.length === 0) {\r\n\t\t\t\t\treturn `Page ${page.id} does not have any questions.`\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfor (const question of page.questions) {\r\n\t\t\t\t\t\tconst questionError = this.validateQuestion(question)\r\n\t\t\t\t\t\tif (questionError) {\r\n\t\t\t\t\t\t\treturn `On page ${page.id} ` + questionError\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ''\r\n\t}\r\n\r\n\tprivate validateQuestion(question: Question): string {\r\n\t\tlet questionError = ''\r\n\t\tif (!question.id || !question.questionLabel || !question.type) {\r\n\t\t\tquestionError += 'the question is missing one of the following properties: id, label or question type.'\r\n\t\t} else {\r\n\t\t\tif (question.type ===  QuestionType.SingleSelect && \r\n\t\t\t(!question.availableOptions || !Array.isArray(question.availableOptions) ||\r\n\t\t\tquestion.availableOptions.length < 2 || question.availableOptions.length > 11)) {\r\n\t\t\t\tquestionError += `the question ${question.id} of type SingleSelect must have at least 2 and at most 11 available options.`\r\n\t\t\t}\r\n\t\t\tif (question.type == QuestionType.MultipleChoice &&\r\n\t\t\t(!question.availableOptions || !Array.isArray(question.availableOptions) ||\r\n\t\t\tquestion.availableOptions.length < 2 || question.availableOptions.length > 11)) {\r\n\t\t\t\tquestionError += `the question ${question.id} of type MultipleChoice must have at least 2 and at most 11 available options.`\r\n\t\t\t}\r\n\t\t\tif (question.type === QuestionType.Rating && (!question.leftLegendValue || !question.rightLegendValue ||\r\n\t\t\t\t!question.ratingValues || !Array.isArray(question.ratingValues) ||\r\n\t\t\t\tquestion.ratingValues.length < 2 || question.ratingValues.length > 11)) {\r\n\t\t\t\tquestionError += \r\n\t\t\t\t`the question ${question.id} of type rating must have a right and left legend and have at least 2 and at most 11 rating values.`\r\n\t\t\t}\r\n\t\t\tif (question.type === QuestionType.Likert &&\r\n\t\t\t\t(!question.horizontalStatements || !Array.isArray(question.horizontalStatements) ||\r\n\t\t\t\t!question.verticalOptions || !Array.isArray(question.verticalOptions) ||\r\n\t\t\t\tquestion.horizontalStatements.length < 1 || question.horizontalStatements.length > 10 ||\r\n\t\t\t\tquestion.verticalOptions.length < 2 || question.verticalOptions.length > 7)) {\r\n\t\t\t\tquestionError += `the question ${question.id} of type Likert must have\r\nat least 2 and at most 7 vertical options and at least 1 and at most 10 horizontal options.`\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn questionError\r\n\t}\r\n}\r\n\r\nexport module CampaignSurveyTemplate {\r\n\texport const enum Type {\r\n\t\tNps5PointStatic = 0,\r\n\t\tNps11PointStatic = 1,\r\n\t\tFps = 2,\r\n\t\tNlqs = 3,\r\n\t\tNps = 4,\r\n\t\tIntercept = 5,\r\n\t\t// A generic messaging surface template type, which will make use of\r\n\t\t// content metadata to render ui.\r\n\t\t// As of 4th Feb 2019 there are 20 template types defined in Mso,\r\n\t\t// hence giving 22 as value for this type.\r\n\t\tGenericMessagingSurface = 22,\r\n\t\t// A dialog template type, to show dialog messages (e.g FRE)\r\n\t\t// The SurveytemplateType in Mso has the value 24 assigned for the \r\n\t\t// Dialog template type. Therefore using the same value to keep it in sync.\r\n\t\tDialog = 24\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateFps extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateFps, string] {\r\n\t\tlet result = new CampaignSurveyTemplateFps();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tresult.content = CampaignSurveyContent.deserialize(input.Content, true /* optionalComponents */);\r\n\t\tresult.uxSchema = input.UxSchema\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\tconst validationError = super.validate()\r\n\t\tif (validationError) {\r\n\t\t\treturn validationError\r\n\t\t} else if ((isNOU(this.content) && isNOU(this.uxSchema))) {\r\n\t\t\treturn 'The survey schema does not have any content or ux schema';\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateNlqs extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateNlqs, string] {\r\n\t\tlet result = new CampaignSurveyTemplateNlqs();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tresult.content = CampaignSurveyContent.deserialize(input.Content);\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\tconst validationError = super.validate()\r\n\t\tif (validationError) {\r\n\t\t\treturn validationError\r\n\t\t} else if (isNOU(this.content)) {\r\n\t\t\treturn 'The survey schema does not have any content';\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateNps extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateNps, string] {\r\n\t\tlet result = new CampaignSurveyTemplateNps();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tresult.content = CampaignSurveyContent.deserialize(input.Content);\r\n\t\tresult.uxSchema = input.UxSchema\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\tconst validationError = super.validate()\r\n\t\tif (validationError) {\r\n\t\t\treturn validationError\r\n\t\t} else if (isNOU(this.content) && isNOU(this.uxSchema)) {\r\n\t\t\treturn 'The survey schema does not have any content or ux schema';\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateNps5PointStatic extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateNps5PointStatic, string] {\r\n\t\tlet result = new CampaignSurveyTemplateNps5PointStatic();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tconst validationError = result.validate()\r\n\t\tif (validationError) {\r\n\t\t\tresult = null\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\treturn super.validate()\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateNps11PointStatic extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateNps11PointStatic, string] {\r\n\t\tlet result = new CampaignSurveyTemplateNps11PointStatic();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\tprivate constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\treturn super.validate()\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateGenericMessagingSurface extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateGenericMessagingSurface, string] {\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tlet result = new CampaignSurveyTemplateGenericMessagingSurface();\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tresult.metadata = CampaignSurveyMetadata.deserialize(input.Metadata);\r\n\t\tresult.maxLaunches = input.MaxLaunches;\r\n\t\tresult.maxLaunchesPerSession = input.MaxLaunchesPerSession;\r\n\t\tresult.preferredLaunchType = input.PreferredLaunchType;\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\tconst validationError = super.validate()\r\n\t\tif (validationError) {\r\n\t\t\treturn validationError\r\n\t\t} else if (isNOU(this.metadata)) {\r\n\t\t\treturn 'The metadata is undefined'\r\n\t\t} else if ((!isNOU(this.maxLaunches) && (!isNumber(this.maxLaunches) || this.maxLaunches <= 0)) ||\r\n\t\t\t(!isNOU(this.maxLaunchesPerSession) && (!isNumber(this.maxLaunchesPerSession) || this.maxLaunchesPerSession <= 0))) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid Multi Launch settings\", this.maxLaunches, this.maxLaunchesPerSession);\r\n\t\t\treturn 'Invalid Multi Launch settings';\r\n\t\t}\r\n\r\n\t\t// check for valid values\r\n\t\tif (isNumber(this.maxLaunches) &&\r\n\t\t\tisNumber(this.maxLaunchesPerSession) &&\r\n\t\t\tthis.maxLaunchesPerSession > this.maxLaunches) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid Multi launch settings\", this.maxLaunches, this.maxLaunchesPerSession);\r\n\t\t\treturn 'Invalid Multi Launch settings';\r\n\t\t}\r\n\r\n\t\tif (!isNOU(this.preferredLaunchType) && !isString(this.preferredLaunchType)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid launcher type\", this.preferredLaunchType);\r\n\t\t\treturn 'Invalid launcher type';\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateDialog extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateDialog, string] {\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tlet result = new CampaignSurveyTemplateDialog();\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tresult.metadata = CampaignSurveyMetadata.deserialize(input.Metadata);\r\n\t\tresult.maxLaunches = input.MaxLaunches;\r\n\t\tresult.maxLaunchesPerSession = input.MaxLaunchesPerSession;\r\n\t\tresult.preferredLaunchType = input.PreferredLaunchType;\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\tconst validationError = super.validate()\r\n\t\tif (validationError) {\r\n\t\t\treturn validationError\r\n\t\t} else if (isNOU(this.metadata)) {\r\n\t\t\treturn 'The metadata is undefined'\r\n\t\t} else if ((!isNOU(this.maxLaunches) && (!isNumber(this.maxLaunches) || this.maxLaunches <= 0)) ||\r\n\t\t\t(!isNOU(this.maxLaunchesPerSession) && (!isNumber(this.maxLaunchesPerSession) || this.maxLaunchesPerSession <= 0))) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid Multi Launch settings for dialog survey template\", \r\n\t\t\t\tthis.maxLaunches, this.maxLaunchesPerSession);\r\n\t\t\treturn 'Invalid Multi Launch settings';\r\n\t\t}\r\n\r\n\t\t// check for valid values\r\n\t\tif (isNumber(this.maxLaunches) &&\r\n\t\t\tisNumber(this.maxLaunchesPerSession) &&\r\n\t\t\tthis.maxLaunchesPerSession > this.maxLaunches) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid Multi launch settings for dialog survey template\",\r\n\t\t\t\tthis.maxLaunches, this.maxLaunchesPerSession);\r\n\t\t\treturn 'Invalid Multi Launch settings';\r\n\t\t}\r\n\r\n\t\tif (!isNOU(this.preferredLaunchType) && !isString(this.preferredLaunchType)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid launcher type\", this.preferredLaunchType);\r\n\t\t\treturn 'Invalid launcher type';\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\nexport class CampaignSurveyTemplateIntercept extends CampaignSurveyTemplate {\r\n\tpublic static deserialize(input: any): [CampaignSurveyTemplateIntercept, string] {\r\n\t\tlet result = new CampaignSurveyTemplateIntercept();\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn [null, 'deserialize parameter is null'];\r\n\t\t}\r\n\r\n\t\tresult.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);\r\n\t\tresult.content = CampaignSurveyContent.deserialize(input.Content);\r\n\t\tconst validationError = result.validate()\r\n\r\n\t\tif (validationError) {\r\n\t\t\tresult = null;\r\n\t\t}\r\n\r\n\t\treturn [result, validationError];\r\n\t}\r\n\r\n\t// public for UT only\r\n\tpublic constructor() { super(); }\r\n\r\n\tprotected validate(): string {\r\n\t\tconst validationError = super.validate()\r\n\t\tif (validationError) {\r\n\t\t\treturn validationError\r\n\t\t} else if (isNOU(this.content)) {\r\n\t\t\treturn 'The survey schema does not have any content'\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n}\r\n\r\n// endregion\r\n\r\n// region Campaign Definition\r\n\r\nexport class CampaignDefinition implements ICampaignDefinition {\r\n\t/**\r\n\t * Method to deserialize a JSON object to class object\r\n\t * @param input: JSON object\r\n\t * Returns result of validation check\r\n\t */\r\n\tpublic static deserialize(input: any): ICampaignDefinition {\r\n\t\tconst result: ICampaignDefinition = new CampaignDefinition();\r\n\t\tlet validationError: string;\r\n\r\n\t\tif (isNOU(input)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tresult.campaignId = input.CampaignId;\r\n\t\tresult.governedChannelType = input.GovernedChannelType;\r\n\t\tresult.startTime = input.StartTimeUtc;\r\n\t\tresult.endTime = input.EndTimeUtc;\r\n\t\tresult.launcherType = input.LauncherType;\r\n\t\tresult.primaryPriority = input.PrimaryPriority;\r\n\t\tresult.tags = input.Tags;\r\n\r\n\t\tconst additionalDataRequested: CampaignAdditionalDataRequested = CampaignAdditionalDataRequested.deserialize(\r\n\t\t\tinput.AdditionalDataRequested);\r\n\t\tresult.additionalDataRequested = additionalDataRequested ? additionalDataRequested.additionalData : [];\r\n\r\n\t\tif (input.SurveyTemplate) {\r\n\t\t\t[result.surveyTemplate, validationError] = CampaignSurveyTemplate.deserialize(input.SurveyTemplate);\r\n\t\t\tif (validationError) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.CampaignDefinitionProvider.CampaignSurveyTemplate.SchemaValidationError,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tCampaignId: input.CampaignId,\r\n\t\t\t\t\t\tErrorMessage: validationError\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (input.NominationScheme) {\r\n\t\t\tresult.nominationScheme = CampaignNominationScheme.deserialize(input.NominationScheme);\r\n\t\t}\r\n\r\n\t\tif (input.Scope) {\r\n\t\t\tresult.scope = CampaignScope.deserialize(input.Scope);\r\n\t\t}\r\n\r\n\t\tif (!isNOU(input.TreatmentType)) {\r\n\t\t\tresult.treatmentType = input.TreatmentType;\r\n\t\t}else{\r\n\t\t\tresult.treatmentType = TreatmentType.none;\r\n\t\t}\r\n\r\n\t\tif (!isNOU(input.BusinessLevel)) {\r\n\t\t\tresult.businessLevel = input.BusinessLevel;\r\n\t\t}\r\n\r\n\t\tif (!result.validate()) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_LocalError(\"Invalid definition\", input);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"CampaignId\")\r\n\tpublic campaignId: string;\r\n\r\n\t// @SerializedName(\"GovernedChannelType\")\r\n\tpublic governedChannelType: GovernedChannelType;\r\n\r\n\t// @SerializedName(\"Scope\")\r\n\tpublic scope: CampaignScope;\r\n\r\n\t// @SerializedName(\"NominationScheme\")\r\n\tpublic nominationScheme: CampaignNominationScheme;\r\n\r\n\t// @SerializedName(\"SurveyTemplate\")\r\n\tpublic surveyTemplate: CampaignSurveyTemplate;\r\n\r\n\t// @SerializedName(\"StartTimeUtc\")\r\n\tpublic startTime: Date;\r\n\r\n\t// @SerializedName(\"EndTimeUtc\")\r\n\tpublic endTime: Date;\r\n\r\n\t// @SerializedName(\"AdditionalDataRequested\")\r\n\tpublic additionalDataRequested: SurveyInfoAdditionalDataType[];\r\n\r\n\t// @SerializedName(\"LauncherType\")\r\n\tpublic launcherType: string;\r\n\r\n\t// @SerializedName(\"Priority\")\r\n\tpublic primaryPriority: number;\r\n\r\n\t// @SerializedName(\"Tags\")\r\n\tpublic tags: string[];\r\n\r\n\t// @SerializedName(\"BusinessLevel\")\r\n\tpublic businessLevel: BusinessLevel;\r\n\r\n\t// @SerializedName(\"TreatmentType\")\r\n\tpublic treatmentType: TreatmentType;\r\n\r\n\tpublic validate(): boolean {\r\n\t\tif (isNOU(this.scope)) {\r\n\t\t\tthis.scope = new CampaignScopeAny();\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.campaignId) || !isString(this.campaignId)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNumber(this.governedChannelType) || !Utils.isEnumValue(this.governedChannelType, GovernedChannelType)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.nominationScheme)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.surveyTemplate)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNOU(this.launcherType) && !isString(this.launcherType)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.launcherType === \"customervoice\" && isNOU(this.surveyTemplate.content?.cvSurvey?.customerVoiceFormId)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isNOU(this.primaryPriority) && !isNumber(this.primaryPriority)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.tags && !Array.isArray(this.tags)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Campaigns with no start date are effectively disabled, in fact, this is the supported way to stage a definition but have it be turned off\r\n\t\tif (isNOU(this.startTime)) {\r\n\t\t\tthis.startTime = getDistantFuture();\r\n\t\t} else if (isUtcDatetimeString(this.startTime)) {\r\n\t\t\tthis.startTime = stringToDate(this.startTime);\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Campaigns with no end date are effectively on indefinitely\r\n\t\tif (isNOU(this.endTime) ||\r\n\t\t\t(typeof (this.endTime) === \"string\" && this.endTime === \"\")) {\r\n\t\t\tthis.endTime = getDistantFuture();\r\n\t\t} else if (isUtcDatetimeString(this.endTime)) {\r\n\t\t\tthis.endTime = stringToDate(this.endTime);\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\n/**\r\n * Given an array of campaign definitions, returns the valid ones and errors if any are invalid.\r\n * @param input: JSON object\r\n * Returns the valid definitions and the error as string if any.\r\n */\r\nexport function FilterValidCampaignDefinitions(campaignDefinitions: any): { result: ICampaignDefinition[], error: string, invalidIndexes: number[] } {\r\n\tconst result: ICampaignDefinition[] = [];\r\n\r\n\tif (isNOU(campaignDefinitions)) {\r\n\t\treturn { result, error: \"Empty\", invalidIndexes: [] };\r\n\t}\r\n\r\n\tif (!Array.isArray(campaignDefinitions)) {\r\n\t\treturn { result, error: \"Not an array\", invalidIndexes: [] };\r\n\t}\r\n\r\n\tconst badIndexes: number[] = [];\r\n\tfor (let i = 0; i < campaignDefinitions.length; i++) {\r\n\t\tconst definition: any = campaignDefinitions[i];\r\n\r\n\t\tif (definition) {\r\n\t\t\tconst newDefinition: ICampaignDefinition = CampaignDefinition.deserialize(definition);\r\n\r\n\t\t\tnewDefinition\r\n\t\t\t\t? result.push(newDefinition)\r\n\t\t\t\t: badIndexes.push(i);\r\n\t\t} else {\r\n\t\t\tbadIndexes.push(i);\r\n\t\t}\r\n\t}\r\n\r\n\tconst error: string = badIndexes.length > 0 ? \"Invalid campaign definitions at indexes: \" + badIndexes.toString() : undefined;\r\n\treturn { result, error, invalidIndexes: badIndexes };\r\n}\r\n\r\n// endregion\r\n\r\nexport class FileSystemCampaignDefinitionProvider implements ICampaignDefinitionProvider {\r\n\tprivate storage: IFloodgateStorageProvider;\r\n\r\n\tpublic constructor(storage: IFloodgateStorageProvider) {\r\n\t\tif (isNOU(storage)) {\r\n\t\t\tthrow new Error(\"storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.storage = storage;\r\n\t}\r\n\r\n\tpublic load(): ICampaignDefinition[] {\r\n\t\tconst definitionString: string = this.storage.read(FloodgateStorageProviderFileType.CampaignDefinitions);\r\n\t\tif (isNOU(definitionString)) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tlet readDefinitions: any;\r\n\r\n\t\ttry {\r\n\t\t\treadDefinitions = JSON.parse(definitionString);\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_CampaignLoad_Failed(e.toString());\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\t// This ignores errors in validation for now.\r\n\t\treturn FilterValidCampaignDefinitions(readDefinitions).result;\r\n\t}\r\n\r\n\tpublic loadAsync(): Promise<ICampaignDefinition[]> {\r\n\t\tconst definitions = this.load();\r\n\t\treturn new Promise(\r\n\t\t\tfunction onFulfilled(resolve, reject) {\r\n\t\t\t\tresolve(definitions);\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\tpublic hasDataChanged() {\r\n\t\t// Not implemented - return false\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport class DynamicCampaignDefinitionProvider<T extends EcsResponseBase> implements ICampaignDefinitionProvider {\r\n\tprivate ecsCampaignDefintionProvider: IEcsAdapter<T>;\r\n\tprivate prefixRegex = new RegExp(/^(Floodgate_Campaign_)/im);\r\n\tpublic eTag: string;\r\n\r\n\tconstructor(storageProvider: IEcsAdapter<T>) {\r\n\t\tif (isNOU(storageProvider)) {\r\n\t\t\tthrow new Error(\"storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.ecsCampaignDefintionProvider = storageProvider;\r\n\t}\r\n\r\n\tpublic hasDataChanged() {\r\n\t\tconst ecsResponse = this.ecsCampaignDefintionProvider.getConfig();\r\n\t\tconst newEtag = ecsResponse?.eTag\r\n\r\n\t\t// If the etag changes, switch the flag so the campaign loading will refresh next time\r\n\t\t// the eTag will be updated later when the DefinitionProvider is loading\r\n\t\treturn newEtag !== this.eTag;\r\n\t}\r\n\r\n\tpublic load(): ICampaignDefinition[] {\r\n\t\tconst ecsCampaignDefinitions: ICampaignDefinition[] = [];\r\n\t\tconst ecsResponse = this.ecsCampaignDefintionProvider.getConfig();\r\n\t\tthis.eTag = ecsResponse?.eTag;\r\n\r\n\t\tif (Utils.isNOU(ecsResponse)) {\r\n\t\t\t// Potentially first boot, no config yet.\r\n\t\t\treturn ecsCampaignDefinitions;\r\n\t\t} else if (Utils.isNOU(ecsResponse?.config)) {\r\n\t\t\t// If the config is null/undefined, the request is likely blocked or bad response body\r\n\t\t\t// We still keep floodgate running for static campaigns\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.DynamicCampaignDefinitionProvider.Load.InvalidEcsConfig, {\r\n\t\t\t\tCount: 0,\r\n\t\t\t\tMessage: \"Null/Undefined config returned from ECS\",\r\n\t\t\t\tErrorDetails: JSON.stringify(this.getLoggableEcsResponse(ecsResponse))\r\n\t\t\t}, 0.1);\r\n\t\t\treturn ecsCampaignDefinitions;\r\n\t\t} else if (Object.keys(ecsResponse?.config).length === 0) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.DynamicCampaignDefinitionProvider.Load.EmptyEcsConfig, {\r\n\t\t\t\tCount: 0,\r\n\t\t\t\tMessage: \"Empty config returned from ECS\",\r\n\t\t\t\tErrorDetails: JSON.stringify(this.getLoggableEcsResponse(ecsResponse))\r\n\t\t\t}, 0.1);\r\n\t\t\treturn ecsCampaignDefinitions;\r\n\t\t}\r\n\r\n\t\tObject.entries(ecsResponse.config).forEach(([key, val]) => {\r\n\t\t\tif (this.prefixRegex.test(key)) {\r\n\t\t\t\tif (!Utils.isObject(val)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tecsCampaignDefinitions.push(val);\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst filteredEcsCampaignDefinitions = FilterValidCampaignDefinitions(ecsCampaignDefinitions);\r\n\t\tif (filteredEcsCampaignDefinitions.invalidIndexes.length > 0) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.DynamicCampaignDefinitionProvider.Load.InvalidEcsConfig, {\r\n\t\t\t\tCount: filteredEcsCampaignDefinitions.invalidIndexes.length,\r\n\t\t\t\tMessage: filteredEcsCampaignDefinitions.invalidIndexes.toString(),\r\n\t\t\t\tErrorDetails: JSON.stringify(this.getLoggableEcsResponse(ecsResponse))\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn filteredEcsCampaignDefinitions.result;\r\n\t}\r\n\r\n\tpublic loadAsync(): Promise<ICampaignDefinition[]> {\r\n\t\treturn Promise.resolve(this.load());\r\n\t}\r\n\r\n\tprivate getLoggableEcsResponse(ecsResponse: EcsCachedConfig<T>) {\r\n\t\t// Skip the lastFetchTokenHash since we don't want to log it\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tconst { lastFetchTokenHash, ...loggableEcsResponse } = ecsResponse;\r\n\t\treturn loggableEcsResponse;\r\n\t}\r\n}\r\n\r\nexport function setDynamicUxSchemaVariables(dynamicVariables: IUxSchemaVariables) {\r\n\tdynamicUxSchemaVariables = dynamicVariables ?? {};\r\n}\r\n", "import { IDictionary, ISurveyStatCollection } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\n/**\r\n * Generic class for managing a collection of survey stats. Includes read-from/write-to json structures or a file,\r\n * as well as merge routines for combining collections\r\n */\r\nexport abstract class SurveyStatCollection<TStats> implements ISurveyStatCollection<TStats> {\r\n\t// The following property name matches the JSON root key name for proper serialization/ deserialization\r\n\tprivate Surveys: IDictionary<TStats> = {};\r\n\r\n\tpublic constructor() {\r\n\t\tthis.Surveys = {};\r\n\t}\r\n\r\n\t/**\r\n\t * Add stats. Overwrites if already exists.\r\n\t */\r\n\tpublic addStats(surveyId: string, stats: TStats): void {\r\n\t\tthis.Surveys[surveyId] = stats;\r\n\t}\r\n\r\n\t/**\r\n\t * Get a SurveyActivationStats object by surveyId. Returns null if surveyId is not found\r\n\t */\r\n\tpublic getBySurveyId(surveyId: string): TStats {\r\n\t\treturn (this.Surveys[surveyId]);\r\n\t}\r\n\r\n\t/**\r\n\t * Get all stats available\r\n\t */\r\n\tpublic getStats(): IDictionary<TStats> {\r\n\t\treturn this.Surveys;\r\n\t}\r\n}\r\n", "import {\r\n\tFloodgateStorageProviderFileType as FileType,\r\n\tIDictionary,\r\n\tIFloodgateSetting,\r\n\tIFloodgateSettingStorageCallback,\r\n\tIFloodgateStorageProvider,\r\n\tISerializable,\r\n\tSurveyType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { TelemetryEvent } from \"./Constants\";\r\nimport * as StateProviderHelpers from \"./StateProviderHelpers\";\r\nimport { SurveyStatCollection } from \"./SurveyStatCollection\";\r\nimport * as Utils from \"./Utils\";\r\nimport { TelemetryLogger } from \"./TelemetryLogger\";\r\n\r\n/**\r\n * StatCollection for activated surveys.  Should be used to track the SurveyIds\r\n * that have been recently shown to a user\r\n */\r\n// TODO (gachoi) Check if this applies - VSOBug: 1443010 One bad Stat object fails the entire serialization\r\nexport class SurveyStatCollectionActivation extends SurveyStatCollection<SurveyActivationStats> implements ISerializable {\r\n\t/**\r\n\t * Load from Json\r\n\t */\r\n\tpublic static fromJson(json: string): SurveyStatCollectionActivation {\r\n\t\tconst statCollection = new SurveyStatCollectionActivation();\r\n\r\n\t\tif (!json) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed, { ErrorMessage: \"Input json is null or empty.\" });\r\n\t\t\treturn statCollection;\r\n\t\t}\r\n\r\n\t\tlet readStats: SurveyStatCollectionActivation;\r\n\t\ttry {\r\n\t\t\treadStats = JSON.parse(json);\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed, { ErrorMessage: \"Json parsing failed. \" + e.toString() });\r\n\t\t\treturn statCollection;\r\n\t\t}\r\n\r\n\t\tif (!statCollection.deserialize(readStats)) {\r\n\t\t\treturn new SurveyStatCollectionActivation();\r\n\t\t}\r\n\r\n\t\treturn statCollection;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert to Json\r\n\t */\r\n\tpublic static toJson(object: SurveyStatCollectionActivation): string {\r\n\t\tif (!object) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed, { ErrorMessage: \"Input json is null or empty.\" });\r\n\t\t\tobject = new SurveyStatCollectionActivation();\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(object);\r\n\t}\r\n\r\n\t/**\r\n\t * Add another SurveyStatCollectionActivation object\r\n\t */\r\n\tpublic accumulate(other: SurveyStatCollectionActivation): void {\r\n\t\tif (!other) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst stats: IDictionary<SurveyActivationStats> = other.getStats();\r\n\t\t// SurveyActivationStats accumulation simply overwrites any keys from 'other' into our collection\r\n\t\tfor (const key in stats) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(stats, key)) {\r\n\t\t\t\tthis.addStats(key, stats[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Method to deserialize SurveyStatCollectionActivation\r\n\t * @param input: collection of SurveyStatCollectionActivation\r\n\t * Returns result of validation check\r\n\t */\r\n\tpublic deserialize(input: any): boolean {\r\n\t\tconst rawStats: IDictionary<SurveyActivationStats> = input.Surveys;\r\n\t\tconst now = new Date();\r\n\r\n\t\tfor (const key in rawStats) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(rawStats, key)) {\r\n\t\t\t\tconst newStat = new SurveyActivationStats();\r\n\r\n\t\t\t\tif (newStat.deserialize(rawStats[key]) && newStat.ExpirationTimeUtc > now) {\r\n\t\t\t\t\tthis.addStats(key, newStat);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.validate();\r\n\t}\r\n\r\n\t/**\r\n\t * Validate the Surveys\r\n\t * Returns false if validation fails\r\n\t */\r\n\tpublic validate(): boolean {\r\n\t\treturn Utils.isObject(this.getStats());\r\n\t}\r\n}\r\n\r\nexport interface ISurveyActivationStatsProvider {\r\n\tload(): SurveyStatCollectionActivation;\r\n\r\n\tsave(surveyStatCollectionActivation: SurveyStatCollectionActivation): void;\r\n}\r\n\r\nexport class SurveyActivationStatsProviderFactory {\r\n\tpublic static make(fileBasedStorage: IFloodgateStorageProvider,\r\n\t\thostBasedStorage: IFloodgateSettingStorageCallback): ISurveyActivationStatsProvider {\r\n\t\tif (hostBasedStorage) {\r\n\t\t\treturn new HostBasedSurveyActivationStatsProvider(fileBasedStorage, hostBasedStorage);\r\n\t\t}\r\n\r\n\t\treturn new FileBasedSurveyActivationStatsProvider(fileBasedStorage);\r\n\t}\r\n}\r\n\r\nexport class HostBasedSurveyActivationStatsProvider implements ISurveyActivationStatsProvider {\r\n\tprivate fileBasedStorageProvider: FileBasedSurveyActivationStatsProvider;\r\n\tprivate hostBasedStorage: IFloodgateSettingStorageCallback;\r\n\r\n\tpublic constructor(fileBasedStorageProvider: IFloodgateStorageProvider, hostBasedStorage: IFloodgateSettingStorageCallback) {\r\n\t\tif (!hostBasedStorage) {\r\n\t\t\tthrow new Error(\"host-based storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.hostBasedStorage = hostBasedStorage;\r\n\r\n\t\t// file based provider is optional\r\n\t\tif (fileBasedStorageProvider) {\r\n\t\t\tthis.fileBasedStorageProvider = new FileBasedSurveyActivationStatsProvider(fileBasedStorageProvider);\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic load(): SurveyStatCollectionActivation {\r\n\t\tconst surveyStatsFromHost: SurveyStatCollectionActivation = this.getSurveyStatsFromHost();\r\n\r\n\t\tlet surveyStatsFromFile: SurveyStatCollectionActivation = new SurveyStatCollectionActivation();\r\n\t\tif (this.fileBasedStorageProvider) {\r\n\t\t\tsurveyStatsFromFile = this.fileBasedStorageProvider.load();\r\n\t\t}\r\n\r\n\t\tconst surveyStatsCollections = StateProviderHelpers.MergeAndUpdateSurveyActivationStats(surveyStatsFromFile, surveyStatsFromHost);\r\n\t\treturn surveyStatsCollections.find(StateProviderHelpers.StateListType.Merged);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic save(stats: SurveyStatCollectionActivation): void {\r\n\t\tif (!stats) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst statsFromHost: SurveyStatCollectionActivation = this.getSurveyStatsFromHost();\r\n\t\tconst statCollection = StateProviderHelpers.MergeAndUpdateSurveyActivationStats(stats, statsFromHost);\r\n\t\tconst toBeUpdatedStats: SurveyStatCollectionActivation = statCollection.find(StateProviderHelpers.StateListType.ToBeUpdated);\r\n\t\tconst mergedStates: SurveyStatCollectionActivation = statCollection.find(StateProviderHelpers.StateListType.Merged);\r\n\r\n\t\t// call host based storage provider to save the delta\r\n\t\tif (toBeUpdatedStats) {\r\n\t\t\tconst toBeUpdatedStatsDictionary: IDictionary<SurveyActivationStats> = toBeUpdatedStats.getStats();\r\n\t\t\tfor (const surveyId in toBeUpdatedStatsDictionary) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(toBeUpdatedStatsDictionary, surveyId)) {\r\n\t\t\t\t\tconst item: string = StateProviderHelpers.makeSettingItemValue(\r\n\t\t\t\t\t\tJSON.stringify(toBeUpdatedStatsDictionary[surveyId]));\r\n\r\n\t\t\t\t\tthis.hostBasedStorage.upsertSettingItem(FileType[FileType.SurveyActivationStats],\r\n\t\t\t\t\t\tsurveyId, item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Write merged data to File\r\n\t\tif (this.fileBasedStorageProvider) {\r\n\t\t\tthis.fileBasedStorageProvider.save(mergedStates);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSurveyStatsFromHost(): SurveyStatCollectionActivation {\r\n\t\tconst statsCollection: SurveyStatCollectionActivation = new SurveyStatCollectionActivation();\r\n\t\tconst itemData: IFloodgateSetting = this.hostBasedStorage.readSettingList(FileType[FileType.SurveyActivationStats]);\r\n\r\n\t\tconst now = new Date();\r\n\t\tfor (const surveyId in itemData) {\r\n\t\t\tif (!Object.prototype.hasOwnProperty.call(itemData, surveyId)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst dataString: string = StateProviderHelpers.extractSettingItemValueSubString(itemData[surveyId]);\r\n\t\t\tconst newStats: SurveyActivationStats = new SurveyActivationStats();\r\n\t\t\ttry {\r\n\t\t\t\tconst readStats: SurveyActivationStats = JSON.parse(dataString);\r\n\t\t\t\tnewStats.deserialize(readStats);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,\r\n\t\t\t\t\t{ ErrorMessage: \"Json parsing/deserializing failed. \" + e.toString() + \".  Input:\" + dataString });\r\n\t\t\t}\r\n\r\n\t\t\tif (newStats.ExpirationTimeUtc <= now) {\r\n\t\t\t\t// Delete survey stat from host storage if it's expired.\r\n\t\t\t\tthis.hostBasedStorage.deleteSettingItem(FileType[FileType.SurveyActivationStats], surveyId);\r\n\t\t\t} else {\r\n\t\t\t\tstatsCollection.addStats(surveyId, newStats);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn statsCollection;\r\n\t}\r\n}\r\nexport class FileBasedSurveyActivationStatsProvider implements ISurveyActivationStatsProvider {\r\n\tprivate storage: IFloodgateStorageProvider;\r\n\r\n\tpublic constructor(storage: IFloodgateStorageProvider) {\r\n\t\tif (!storage) {\r\n\t\t\tthrow new Error(\"storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.storage = storage;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic load(): SurveyStatCollectionActivation {\r\n\t\tconst readString: string = this.storage.read(FileType.SurveyActivationStats);\r\n\t\tif (!readString) {\r\n\t\t\treturn new SurveyStatCollectionActivation();\r\n\t\t}\r\n\r\n\t\treturn SurveyStatCollectionActivation.fromJson(readString);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic save(surveyStatCollectionActivation: SurveyStatCollectionActivation): void {\r\n\t\tif (!surveyStatCollectionActivation) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst writeString: string = SurveyStatCollectionActivation.toJson(surveyStatCollectionActivation);\r\n\t\tthis.storage.write(FileType.SurveyActivationStats, writeString);\r\n\t}\r\n}\r\n\r\nexport class SurveyActivationStats implements ISerializable {\r\n\t// The following property names match JSON property names for proper serialization/deserialization\r\n\tpublic ExpirationTimeUtc: Date;\r\n\tpublic ActivationTimeUtc: Date;\r\n\tpublic Type: SurveyType;\r\n\tpublic SurveyLaunchCount = 0;\r\n\tpublic SurveyLaunchCountPerSession = 0;\r\n\r\n\t/**\r\n\t * Method to deserialize a JSON object to class object\r\n\t * @param input: JSON object\r\n\t * Returns result of validation check\r\n\t */\r\n\tpublic deserialize(input: any): boolean {\r\n\t\tthis.ActivationTimeUtc = input.ActivationTimeUtc;\r\n\t\tthis.ExpirationTimeUtc = input.ExpirationTimeUtc;\r\n\t\tthis.Type = input.Type;\r\n\t\tthis.SurveyLaunchCount = input.SurveyLaunchCount ?? 0;\r\n\t\tthis.SurveyLaunchCountPerSession = input.SurveyLaunchCountPerSession ?? 0;\r\n\r\n\t\treturn this.validate();\r\n\t}\r\n\r\n\t/**\r\n\t * Method to call after deserialization to validate generated object.\r\n\t * Returns false if not valid.\r\n\t */\r\n\tpublic validate(): boolean {\r\n\t\t// make it a date object if it's a valid UTC date time value\r\n\t\tif (Utils.isUtcDatetimeString(this.ActivationTimeUtc)) {\r\n\t\t\tthis.ActivationTimeUtc = Utils.stringToDate(this.ActivationTimeUtc);\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// make it a date object if it's a valid UTC date time value\r\n\t\tif (Utils.isUtcDatetimeString(this.ExpirationTimeUtc)) {\r\n\t\t\tthis.ExpirationTimeUtc = Utils.stringToDate(this.ExpirationTimeUtc);\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!Utils.isNumber(this.SurveyLaunchCount) ||\r\n\t\t\t!Utils.isNumber(this.SurveyLaunchCountPerSession)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn Utils.isEnumValue(this.Type, SurveyType);\r\n\t}\r\n}\r\n", "import { IDictionary } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { SurveyActivationStats, SurveyStatCollectionActivation } from \"../src/SurveyStatCollectionActivation\";\r\nimport { CampaignState } from \"./Campaign/CampaignStateProvider\";\r\nimport { GovernedChannelState } from \"./GovernedChannelStateProvider\";\r\n\r\n/**\r\n * Values for the state list types\r\n */\r\nexport const enum StateListType {\r\n\tMerged,\r\n\tToBeUpdated,\r\n}\r\n\r\nexport interface IKeyedCollection<T> {\r\n\tadd(key: number, value: T): void;\r\n\tfind(key: number): T;\r\n\tremove(key: number): T;\r\n\tcount(): number;\r\n}\r\n\r\nexport class ItemCollection<T> implements IKeyedCollection<T> {\r\n\tprivate items: { [key: number]: T } = {};\r\n\tprivate itemCount = 0;\r\n\r\n\tpublic add(key: number, value: T): void {\r\n\t\tif (!this.items[key]) {\r\n\t\t\tthis.itemCount++;\r\n\t\t}\r\n\t\tthis.items[key] = value;\r\n\t}\r\n\r\n\tpublic find(key: number): T {\r\n\t\treturn this.items[key];\r\n\t}\r\n\r\n\tpublic remove(key: number): T {\r\n\t\tconst item: T = this.items[key];\r\n\r\n\t\tif (item) {\r\n\t\t\tdelete this.items[key];\r\n\t\t\tthis.itemCount--;\r\n\t\t}\r\n\r\n\t\treturn item;\r\n\t}\r\n\r\n\tpublic count(): number {\r\n\t\treturn this.itemCount;\r\n\t}\r\n}\r\n\r\nexport function extractSettingItemValueSubString(itemValue: string): string {\r\n\tif (!itemValue) {\r\n\t\treturn itemValue;\r\n\t}\r\n\r\n\tconst beginPos: number = itemValue.indexOf(SETTING_DATA_OPEN_TAG) + SETTING_DATA_OPEN_TAG.length;\r\n\tconst endPos: number = itemValue.indexOf(SETTING_DATA_CLOSE_TAG);\r\n\r\n\tif (beginPos < 0 || endPos < 0) {\r\n\t\treturn itemValue;\r\n\t}\r\n\r\n\treturn itemValue.substring(beginPos, endPos);\r\n}\r\n\r\nexport function makeSettingItemValue(value: string): string {\r\n\tif (!value) {\r\n\t\treturn SETTING_DATA_OPEN_TAG + SETTING_DATA_CLOSE_TAG;\r\n\t}\r\n\r\n\treturn SETTING_DATA_OPEN_TAG + value + SETTING_DATA_CLOSE_TAG;\r\n}\r\n\r\nexport function MergeAndUpdateGovernedChannelStates(previousStates: GovernedChannelState[],\r\n\tcurrentStates: GovernedChannelState[]): IKeyedCollection<GovernedChannelState[]> {\r\n\tconst stateCollections: IKeyedCollection<GovernedChannelState[]> = new ItemCollection<GovernedChannelState[]>();\r\n\r\n\t// Todo: move the following into a generic method to be shared\r\n\tif (!previousStates && !currentStates) {\r\n\t\treturn stateCollections;\r\n\t}\r\n\r\n\tif (!previousStates) {\r\n\t\tstateCollections.add(StateListType.Merged, currentStates);\r\n\t\treturn stateCollections;\r\n\t}\r\n\r\n\tif (!currentStates) {\r\n\t\tstateCollections.add(StateListType.Merged, previousStates);\r\n\t\tstateCollections.add(StateListType.ToBeUpdated, previousStates);\r\n\t\treturn stateCollections;\r\n\t}\r\n\r\n\tconst mergedStates: GovernedChannelState[] = [];\r\n\tconst toBeUpdatedStates: GovernedChannelState[] = [];\r\n\r\n\tif (previousStates) {\r\n\t\tpreviousStates.forEach((previousState) => {\r\n\t\t\t// find matching in current states\r\n\t\t\tlet pos = -1;\r\n\t\t\tlet currentState: GovernedChannelState;\r\n\t\t\tfor (let i = 0; i < currentStates.length; i++) {\r\n\t\t\t\tcurrentState = currentStates[i];\r\n\t\t\t\tif (currentState.getType() === previousState.getType()) {\r\n\t\t\t\t\tpos = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// if previous state is not in current states\r\n\t\t\tif (pos === -1) {\r\n\t\t\t\t// add previous state to merged\r\n\t\t\t\tmergedStates.push(previousState);\r\n\r\n\t\t\t\t// add previous state to toUpdated\r\n\t\t\t\ttoBeUpdatedStates.push(previousState);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// if ActivationTimeUtc of previous is greater than current\r\n\t\t\tif (previousState.getCooldownStartTime() > currentState.getCooldownStartTime()) {\r\n\t\t\t\t// add previous state to merged\r\n\t\t\t\tmergedStates.push(previousState);\r\n\r\n\t\t\t\t// add previous state to toUpdated\r\n\t\t\t\ttoBeUpdatedStates.push(previousState);\r\n\t\t\t} else {\r\n\t\t\t\t// add current state to merged\r\n\t\t\t\tmergedStates.push(currentState);\r\n\t\t\t}\r\n\r\n\t\t\t// remove state from current states\r\n\t\t\tcurrentStates.splice(pos, 1);\r\n\t\t});\r\n\t}\r\n\r\n\t// for the remaining current states\r\n\tif (currentStates) {\r\n\t\tcurrentStates.forEach((currentState) => {\r\n\t\t\t// add current state to merged\r\n\t\t\tmergedStates.push(currentState);\r\n\t\t});\r\n\t}\r\n\r\n\tstateCollections.add(StateListType.Merged, mergedStates);\r\n\r\n\tif (toBeUpdatedStates.length > 0) {\r\n\t\tstateCollections.add(StateListType.ToBeUpdated, toBeUpdatedStates);\r\n\t}\r\n\r\n\treturn stateCollections;\r\n}\r\n\r\nexport function MergeAndUpdateCampaignStates(previousStates: CampaignState[],\r\n\tcurrentStates: CampaignState[]): IKeyedCollection<CampaignState[]> {\r\n\tconst stateCollections: IKeyedCollection<CampaignState[]> = new ItemCollection<CampaignState[]>();\r\n\r\n\tif (!previousStates && !currentStates) {\r\n\t\treturn stateCollections;\r\n\t}\r\n\r\n\tif (!previousStates) {\r\n\t\tstateCollections.add(StateListType.Merged, currentStates);\r\n\t\treturn stateCollections;\r\n\t}\r\n\r\n\tif (!currentStates) {\r\n\t\tstateCollections.add(StateListType.Merged, previousStates);\r\n\t\tstateCollections.add(StateListType.ToBeUpdated, previousStates);\r\n\t\treturn stateCollections;\r\n\t}\r\n\r\n\tconst mergedStates: CampaignState[] = [];\r\n\tconst toBeUpdatedStates: CampaignState[] = [];\r\n\r\n\tif (previousStates) {\r\n\t\tpreviousStates.forEach((previousState) => {\r\n\t\t\tconst current = new Date();\r\n\r\n\t\t\t// find matching in current states\r\n\t\t\tlet pos = -1;\r\n\t\t\tlet currentState: CampaignState;\r\n\t\t\tfor (let i = 0; i < currentStates.length; i++) {\r\n\t\t\t\tcurrentState = currentStates[i];\r\n\t\t\t\tif (currentState.CampaignId === previousState.CampaignId) {\r\n\t\t\t\t\tpos = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// if previous state is not in current states\r\n\t\t\tif (pos === -1) {\r\n\t\t\t\t// add previous state to merged\r\n\t\t\t\tmergedStates.push(previousState);\r\n\r\n\t\t\t\t// add previous state to toUpdated\r\n\t\t\t\ttoBeUpdatedStates.push(previousState);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// if current state is in cooldown, add to merged list\r\n\t\t\tif (currentState.LastCooldownEndTimeUtc > current) {\r\n\t\t\t\t// add previous state to merged list\r\n\t\t\t\tmergedStates.push(currentState);\r\n\r\n\t\t\t\t// emove state from current states\r\n\t\t\t\tcurrentStates.splice(pos, 1);\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// if previous state is in cooldown, add to merged and toUpdated lists\r\n\t\t\tif (previousState.LastCooldownEndTimeUtc > current) {\r\n\t\t\t\t// add previous state to merged list\r\n\t\t\t\tmergedStates.push(previousState);\r\n\r\n\t\t\t\t// add previous state to to-be-updated list\r\n\t\t\t\ttoBeUpdatedStates.push(previousState);\r\n\r\n\t\t\t\t// emove state from current states\r\n\t\t\t\tcurrentStates.splice(pos, 1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// add previous state to toUpdated and merged for the following two conditions:\r\n\t\t\t//  1. previous cooldown time wins, or\r\n\t\t\t//  2. cooldown times are the same and previous nomination wins\r\n\t\t\tif (previousState.getCooldownStartDate() > currentState.getCooldownStartDate()\r\n\t\t\t\t|| (previousState.getCooldownStartDate() === currentState.getCooldownStartDate()\r\n\t\t\t\t\t&& previousState.LastNominationTimeUtc > currentState.LastNominationTimeUtc)\r\n\t\t\t) {\r\n\t\t\t\tmergedStates.push(previousState);\r\n\r\n\t\t\t\ttoBeUpdatedStates.push(previousState);\r\n\t\t\t} else {\r\n\t\t\t\t// add current state to merged\r\n\t\t\t\tmergedStates.push(currentState);\r\n\t\t\t}\r\n\r\n\t\t\t// remove state from current states\r\n\t\t\tcurrentStates.splice(pos, 1);\r\n\t\t});\r\n\t}\r\n\r\n\t// for the remaining current states\r\n\tif (currentStates) {\r\n\t\tcurrentStates.forEach((current) => {\r\n\t\t\t// add current state to merged\r\n\t\t\tmergedStates.push(current);\r\n\t\t});\r\n\t}\r\n\r\n\tstateCollections.add(StateListType.Merged, mergedStates);\r\n\r\n\tif (toBeUpdatedStates.length > 0) {\r\n\t\tstateCollections.add(StateListType.ToBeUpdated, toBeUpdatedStates);\r\n\t}\r\n\r\n\treturn stateCollections;\r\n}\r\n\r\nexport function MergeAndUpdateSurveyActivationStats(previousStats: SurveyStatCollectionActivation,\r\n\tcurrentStats: SurveyStatCollectionActivation): IKeyedCollection<SurveyStatCollectionActivation> {\r\n\r\n\tconst statsCollections: IKeyedCollection<SurveyStatCollectionActivation> = new ItemCollection<SurveyStatCollectionActivation>();\r\n\r\n\t// Handle previousStats and/or currentStats equal to null\r\n\tif (!previousStats && !currentStats) {\r\n\t\treturn statsCollections;\r\n\t}\r\n\r\n\tif (!previousStats) {\r\n\t\tstatsCollections.add(StateListType.Merged, currentStats);\r\n\t\treturn statsCollections;\r\n\t}\r\n\r\n\tif (!currentStats) {\r\n\t\tstatsCollections.add(StateListType.Merged, previousStats);\r\n\t\tstatsCollections.add(StateListType.ToBeUpdated, previousStats);\r\n\t\treturn statsCollections;\r\n\t}\r\n\r\n\t// Enumerate preivous stats\r\n\tconst mergedStats: SurveyStatCollectionActivation = new SurveyStatCollectionActivation();\r\n\tconst toBeUpdatedStats: SurveyStatCollectionActivation = new SurveyStatCollectionActivation();\r\n\r\n\tconst previousStatsDictionary: IDictionary<SurveyActivationStats> = previousStats.getStats();\r\n\tconst currentStatsDictionary: IDictionary<SurveyActivationStats> = currentStats.getStats();\r\n\r\n\tfor (const surveyId in previousStatsDictionary) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(previousStatsDictionary, surveyId)) {\r\n\t\t\t// if an updated stat is not found\r\n\t\t\tconst currentActivationStats: SurveyActivationStats = currentStatsDictionary[surveyId];\r\n\t\t\tif (!currentActivationStats) {\r\n\t\t\t\t// add to merged collection\r\n\t\t\t\tmergedStats.addStats(surveyId, previousStatsDictionary[surveyId]);\r\n\t\t\t\t// add to-be-updated collection\r\n\t\t\t\ttoBeUpdatedStats.addStats(surveyId, previousStatsDictionary[surveyId]);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t// if previous stat has higher activation time\r\n\t\t\tconst previousActivationStats: SurveyActivationStats = previousStatsDictionary[surveyId];\r\n\t\t\tif (previousActivationStats.ActivationTimeUtc > currentActivationStats.ActivationTimeUtc) {\r\n\t\t\t\t// add to merged collection\r\n\t\t\t\tmergedStats.addStats(surveyId, previousStatsDictionary[surveyId]);\r\n\t\t\t\t// add to-be-updated collection\r\n\t\t\t\ttoBeUpdatedStats.addStats(surveyId, previousStatsDictionary[surveyId]);\r\n\t\t\t} else {\r\n\t\t\t\t// add to current stat merged collection\r\n\t\t\t\tmergedStats.addStats(surveyId, currentStatsDictionary[surveyId]);\r\n\t\t\t}\r\n\r\n\t\t\t// delete from stats\r\n\t\t\tdelete currentStatsDictionary[surveyId];\r\n\t\t}\r\n\t}\r\n\r\n\t// merge any remaining stats\r\n\tfor (const surveyId in currentStatsDictionary) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(currentStatsDictionary, surveyId)) {\r\n\t\t\tmergedStats.addStats(surveyId, currentStatsDictionary[surveyId]);\r\n\t\t}\r\n\t}\r\n\r\n\t// always return merged list\r\n\tstatsCollections.add(StateListType.Merged, mergedStats);\r\n\r\n\t// since dictionaries don't have an empty check, enumerate the  first entry to check for non-empty\r\n\tconst toBeUpdatedStatsDictionary: IDictionary<SurveyActivationStats> = toBeUpdatedStats.getStats();\r\n\tfor (const toBeUpdated in toBeUpdatedStatsDictionary) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(toBeUpdatedStatsDictionary, toBeUpdated)) {\r\n\t\t\t// not empty, return to-be-updated\r\n\t\t\tstatsCollections.add(StateListType.ToBeUpdated, toBeUpdatedStats);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\treturn statsCollections;\r\n}\r\n\r\nconst SETTING_DATA_OPEN_TAG = \"<data>\";\r\nconst SETTING_DATA_CLOSE_TAG = \"</data>\";\r\n", "import {\r\n\tFloodgateStorageProviderFileType as FileType,\r\n\tGovernedChannelType,\r\n\tIFloodgateSetting,\r\n\tIFloodgateSettingStorageCallback,\r\n\tIFloodgateStorageProvider,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { TelemetryEvent } from \"./Constants\";\r\nimport * as StateProviderHelpers from \"./StateProviderHelpers\";\r\nimport * as Utils from \"./Utils\";\r\nimport StateListType = StateProviderHelpers.StateListType;\r\nimport { TelemetryLogger } from \"./TelemetryLogger\";\r\n\r\nexport class GovernedChannelState {\r\n\t/**\r\n\t * Method to deserialize a JSON object to class object\r\n\t * @param input: JSON object\r\n\t * Returns class object\r\n\t */\r\n\tpublic static deserialize(input: any): GovernedChannelState {\r\n\t\tlet result: GovernedChannelState;\r\n\r\n\t\tif (!input) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// Validation is handled by GovernedChannelState's constructor\r\n\t\ttry {\r\n\t\t\tresult = new GovernedChannelState(\r\n\t\t\t\tinput.ChannelType,\r\n\t\t\t\tinput.CooldownStartTimeUtc,\r\n\t\t\t);\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.GovernedChannelState.Deserialize.Failed, { ErrorMessage: e.toString() });\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @SerializedName(\"ChannelType\")\r\n\tprivate ChannelType: GovernedChannelType;\r\n\r\n\t// @SerializedName(\"CooldownStartTimeUtc\")\r\n\tprivate CooldownStartTimeUtc: Date;\r\n\r\n\tpublic constructor(type: GovernedChannelType, cooldownStartTime: Date) {\r\n\t\tthis.ChannelType = type;\r\n\t\tthis.CooldownStartTimeUtc = cooldownStartTime;\r\n\r\n\t\tif (!this.validate()) {\r\n\t\t\tthrow new Error(\"Constructor arguments are not valid\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic validate(): boolean {\r\n\t\tif (!Utils.isEnumValue(this.ChannelType, GovernedChannelType)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// make it a date object if it's a valid UTC date time value\r\n\t\tif (Utils.isUtcDatetimeString(this.CooldownStartTimeUtc)) {\r\n\t\t\tthis.CooldownStartTimeUtc = Utils.stringToDate(this.CooldownStartTimeUtc);\r\n\t\t\t// Allow null and bad cooldownStartTime\r\n\t\t} else if (Utils.isNOU(this.CooldownStartTimeUtc) || !Utils.isDate(this.CooldownStartTimeUtc)) {\r\n\t\t\tthis.CooldownStartTimeUtc = Utils.getDistantPast();\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic getType(): GovernedChannelType {\r\n\t\treturn this.ChannelType;\r\n\t}\r\n\r\n\tpublic getCooldownStartTime(): Date {\r\n\t\treturn this.CooldownStartTimeUtc;\r\n\t}\r\n}\r\n\r\nexport interface IGovernedChannelStateProvider {\r\n\tload(): GovernedChannelState[];\r\n\r\n\tsave(channels: GovernedChannelState[]): void;\r\n}\r\n\r\nexport class GovernedChannelStateProviderFactory {\r\n\tpublic static make(fileBasedStorage: IFloodgateStorageProvider,\r\n\t\thostBasedStorage: IFloodgateSettingStorageCallback): IGovernedChannelStateProvider {\r\n\t\tif (hostBasedStorage) {\r\n\t\t\treturn new HostBasedGovernedChannelStateProvider(fileBasedStorage, hostBasedStorage);\r\n\t\t}\r\n\r\n\t\treturn new FileBasedGovernedChannelStateProvider(fileBasedStorage);\r\n\t}\r\n}\r\n\r\n/**\r\n * Class representing what is stored in the file.\r\n */\r\nclass FileData {\r\n\t// @SerializedName(\"ChannelStates\")\r\n\tpublic ChannelStates: GovernedChannelState[];\r\n}\r\n\r\nexport class HostBasedGovernedChannelStateProvider implements IGovernedChannelStateProvider {\r\n\tprivate fileBasedStateProvider: IGovernedChannelStateProvider;\r\n\tprivate hostBasedStorage: IFloodgateSettingStorageCallback;\r\n\r\n\tpublic constructor(fileBasedStorage: IFloodgateStorageProvider, hostBasedStorage: IFloodgateSettingStorageCallback) {\r\n\t\tif (!hostBasedStorage) {\r\n\t\t\tthrow new Error(\"host-based storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.hostBasedStorage = hostBasedStorage;\r\n\r\n\t\t// file-based provider is optional\r\n\t\tif (fileBasedStorage) {\r\n\t\t\tthis.fileBasedStateProvider = new FileBasedGovernedChannelStateProvider(fileBasedStorage);\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic load(): GovernedChannelState[] {\r\n\t\tconst statesFromHost: GovernedChannelState[] = this.getStatesFromHost();\r\n\r\n\t\tlet statesFromFile: GovernedChannelState[];\r\n\t\tif (this.fileBasedStateProvider) {\r\n\t\t\tstatesFromFile = this.fileBasedStateProvider.load();\r\n\t\t}\r\n\r\n\t\tconst StateCollections = StateProviderHelpers.MergeAndUpdateGovernedChannelStates(statesFromFile, statesFromHost);\r\n\t\treturn StateCollections.find(StateListType.Merged);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic save(states: GovernedChannelState[]): void {\r\n\t\tif (!states) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst statesFromHost: GovernedChannelState[] = this.getStatesFromHost();\r\n\t\tconst StateCollections = StateProviderHelpers.MergeAndUpdateGovernedChannelStates(states, statesFromHost);\r\n\t\tconst toBeUpdatedStates: GovernedChannelState[] = StateCollections.find(StateListType.ToBeUpdated);\r\n\t\tconst mergedStates: GovernedChannelState[] = StateCollections.find(StateListType.Merged);\r\n\r\n\t\t// write delta_data to Host\r\n\t\tif (toBeUpdatedStates) {\r\n\t\t\ttoBeUpdatedStates.forEach((state) => {\r\n\t\t\t\tconst stateValue: string = StateProviderHelpers.makeSettingItemValue(JSON.stringify(state));\r\n\t\t\t\tthis.hostBasedStorage.upsertSettingItem(FileType[FileType.GovernedChannelStates], String(state.getType()), stateValue);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Write merged data to File\r\n\t\tif (this.fileBasedStateProvider) {\r\n\t\t\tthis.fileBasedStateProvider.save(mergedStates);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getStatesFromHost(): GovernedChannelState[] {\r\n\t\tconst states: GovernedChannelState[] = [];\r\n\t\tconst settings: IFloodgateSetting = this.hostBasedStorage.readSettingList(FileType[FileType.GovernedChannelStates]);\r\n\r\n\t\tfor (const key in settings) {\r\n\t\t\tif (!Object.prototype.hasOwnProperty.call(settings, key)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst value = settings[key];\r\n\t\t\tconst dataString: string = StateProviderHelpers.extractSettingItemValueSubString(value);\r\n\r\n\t\t\tlet itemObject: any = {};\r\n\t\t\ttry {\r\n\t\t\t\titemObject = JSON.parse(dataString);\r\n\r\n\t\t\t\tconst newState: GovernedChannelState = GovernedChannelState.deserialize(itemObject);\r\n\t\t\t\tif (newState) {\r\n\t\t\t\t\tstates.push(newState);\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,\r\n\t\t\t\t\t{ ErrorMessage: \"Json parsing/deserializing failed. \" + e.toString() + \".  Input:\" + dataString });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn states;\r\n\t}\r\n}\r\n\r\nexport class FileBasedGovernedChannelStateProvider implements IGovernedChannelStateProvider {\r\n\tprivate storage: IFloodgateStorageProvider;\r\n\r\n\tpublic constructor(storage: IFloodgateStorageProvider) {\r\n\t\tif (!storage) {\r\n\t\t\tthrow new Error(\"storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.storage = storage;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic load(): GovernedChannelState[] {\r\n\t\t// Load channel state from file using _storageProvider (get back string)\r\n\t\tconst readString: string = this.storage.read(FileType.GovernedChannelStates);\r\n\t\tif (!readString) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tlet fileData: FileData;\r\n\t\ttry {\r\n\t\t\tfileData = JSON.parse(readString);\r\n\r\n\t\t\tconst result: GovernedChannelState[] = [];\r\n\r\n\t\t\tif (fileData && fileData.ChannelStates) {\r\n\t\t\t\tfileData.ChannelStates.forEach((state) => {\r\n\t\t\t\t\tconst newState: GovernedChannelState = GovernedChannelState.deserialize(state);\r\n\r\n\t\t\t\t\tif (newState) {\r\n\t\t\t\t\t\tresult.push(newState);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,\r\n\t\t\t\t{ ErrorMessage: \"Json parsing/deserializing failed. \" + e.toString() + \".  Input:\" + readString });\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic save(states: GovernedChannelState[]): void {\r\n\t\tif (!states) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fileData = new FileData();\r\n\t\tfileData.ChannelStates = states;\r\n\t\tconst writeString: string = JSON.stringify(fileData);\r\n\r\n\t\tthis.storage.write(FileType.GovernedChannelStates, writeString);\r\n\t}\r\n}\r\n", "import { IDictionary, ISurveyEventActivityStats, ISurveyStatCollectionEventActivity } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { TelemetryEvent } from \"./Constants\";\r\nimport { SurveyStatCollection } from \"./SurveyStatCollection\";\r\nimport * as Utils from \"./Utils\";\r\nimport { TelemetryLogger } from \"./TelemetryLogger\";\r\n\r\n/**\r\n * StatCollection for EventActivity counts.  Should be used to store/merge\r\n * aggregate values between sessions tracking the same surveys/events\r\n * E.g. A survey that activates after 3 boots.\r\n */\r\n// TODO (gachoi) check the following - VSOBug: 1443010 One bad Stat object fails the entire serialization\r\nexport class SurveyStatCollectionEventActivity extends SurveyStatCollection<ISurveyEventActivityStats> implements ISurveyStatCollectionEventActivity {\r\n\r\n\t/**\r\n\t * Load from Json\r\n\t */\r\n\tpublic static fromJson(json: string): SurveyStatCollectionEventActivity {\r\n\t\tconst statCollection = new SurveyStatCollectionEventActivity();\r\n\r\n\t\tif (!json) {\r\n\t\t\treturn statCollection;\r\n\t\t}\r\n\r\n\t\tlet readStats: SurveyStatCollectionEventActivity;\r\n\t\ttry {\r\n\t\t\treadStats = JSON.parse(json);\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,\r\n\t\t\t\t{ ErrorMessage: \"Json parsing failed. \" + e.toString() });\r\n\t\t\treturn statCollection;\r\n\t\t}\r\n\r\n\t\tif (!statCollection.deserialize(readStats)) {\r\n\t\t\treturn new SurveyStatCollectionEventActivity();\r\n\t\t}\r\n\r\n\t\treturn statCollection;\r\n\t}\r\n\r\n\t/**\r\n\t * Convert to Json\r\n\t */\r\n\tpublic static toJson(object: SurveyStatCollectionEventActivity): string {\r\n\t\tif (!object) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.SurveyStatCollectionEventActivity.ToJson.Failed,\r\n\t\t\t\t{ ErrorMessage: \"Input json is null or empty.\" });\r\n\t\t\tobject = new SurveyStatCollectionEventActivity();\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(object);\r\n\t}\r\n\r\n\t/**\r\n\t * Add another SurveyStatCollectionEventActivity object\r\n\t */\r\n\tpublic accumulate(other: SurveyStatCollectionEventActivity): void {\r\n\t\tif (!other) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst stats: IDictionary<ISurveyEventActivityStats> = other.getStats();\r\n\t\t// SurveyEventActivityStats accumulation simply overwrites any keys from 'other' into our collection\r\n\t\tfor (const key in stats) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(stats, key)) {\r\n\t\t\t\tlet ourStats: SurveyEventActivityStats = this.getBySurveyId(key);\r\n\r\n\t\t\t\t// If it does not already exist\r\n\t\t\t\tif (!ourStats) {\r\n\t\t\t\t\tourStats = new SurveyEventActivityStats();\r\n\t\t\t\t\tourStats.Counts = [];\r\n\t\t\t\t\tthis.addStats(key, ourStats);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tourStats.ExpirationTimeUtc = stats[key].ExpirationTimeUtc;\r\n\r\n\t\t\t\t// If for some reason the other counts array is larger, resize ourStats.counts\r\n\t\t\t\tif (ourStats.Counts.length < stats[key].Counts.length) {\r\n\t\t\t\t\tconst resizedCounts: number[] = ourStats.Counts.slice();\r\n\t\t\t\t\tourStats.Counts = resizedCounts;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let i = 0; i < stats[key].Counts.length; i++) {\r\n\t\t\t\t\tif (!ourStats.Counts[i]) {\r\n\t\t\t\t\t\tourStats.Counts[i] = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tourStats.Counts[i] += stats[key].Counts[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Method to deserialize SurveyStatCollectionEventActivity\r\n\t * @param input: collection of SurveyStatCollectionEventActivity\r\n\t * Returns result of validation check\r\n\t */\r\n\tpublic deserialize(input: any): boolean {\r\n\t\tconst rawStats: IDictionary<ISurveyEventActivityStats> = input.Surveys;\r\n\t\tconst now = new Date();\r\n\r\n\t\tfor (const key in rawStats) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(rawStats, key)) {\r\n\t\t\t\tconst newStat = new SurveyEventActivityStats();\r\n\r\n\t\t\t\tif (newStat.deserialize(rawStats[key]) && newStat.ExpirationTimeUtc > now) {\r\n\t\t\t\t\tthis.addStats(key, newStat);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.validate();\r\n\t}\r\n\r\n\t/**\r\n\t * Validate the Surveys\r\n\t * Returns false if validation fails\r\n\t */\r\n\tpublic validate(): boolean {\r\n\t\treturn Utils.isObject(this.getStats());\r\n\t}\r\n}\r\n\r\nexport class SurveyEventActivityStats implements ISurveyEventActivityStats {\r\n\t// The following property names match JSON property names for proper serialization/deserialization\r\n\tpublic ExpirationTimeUtc: Date;\r\n\tpublic Counts: number[];\r\n\r\n\t/**\r\n\t * Method to deserialize a JSON object to class object\r\n\t * @param input: JSON object\r\n\t * Returns result of validation check\r\n\t */\r\n\tpublic deserialize(input: any): boolean {\r\n\t\tthis.ExpirationTimeUtc = input.ExpirationTimeUtc;\r\n\t\tthis.Counts = input.Counts;\r\n\r\n\t\treturn this.validate();\r\n\t}\r\n\r\n\t/**\r\n\t * Method to call after deserialization to validate generated object.\r\n\t * Returns false if not valid.\r\n\t */\r\n\tpublic validate(): boolean {\r\n\t\tif (!this.Counts) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < this.Counts.length; i++) {\r\n\t\t\tconst val: number = this.Counts[i];\r\n\r\n\t\t\tif (!Utils.isNumber(val)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (val < 0) {\r\n\t\t\t\tthis.Counts[i] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// make it a date object if it's a valid UTC date time value\r\n\t\tif (Utils.isUtcDatetimeString(this.ExpirationTimeUtc)) {\r\n\t\t\tthis.ExpirationTimeUtc = Utils.stringToDate(this.ExpirationTimeUtc);\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n", "import { IDictionary, ISurveyInfo, SurveyInfoBusinessLevel } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { SurveyActivationStats } from \"./SurveyStatCollectionActivation\";\r\nimport { isNOU, isNumber } from \"./Utils\";\r\n\r\nexport function isMultiLaunchSurvey(surveyInfo: ISurveyInfo): boolean {\r\n\tconst maxLaunches = surveyInfo?.getMaxLaunches();\r\n\treturn isNumber(maxLaunches) && maxLaunches > 1;\r\n}\r\n\r\nexport function isBusinessCriticalSurvey(surveyInfo: ISurveyInfo): boolean {\r\n\tconst businessLevel = surveyInfo?.getBusinessLevel();\r\n\treturn !isNOU(businessLevel) && businessLevel === SurveyInfoBusinessLevel.Critical;\r\n}\r\n\r\nexport function isCriticalSurvey(surveyInfo: ISurveyInfo): boolean {\r\n\treturn isMultiLaunchSurvey(surveyInfo) || isBusinessCriticalSurvey(surveyInfo);\r\n}\r\n\r\nexport function hasSurveyReachedMaxLaunchesPerSession(surveyInfo: ISurveyInfo, surveyActivationStats: IDictionary<number>): boolean {\r\n\tif (isMultiLaunchSurvey(surveyInfo) && isNumber(surveyInfo.getMaxLaunchesPerSession())) {\r\n\t\tconst surveyLaunchCountInSession = surveyActivationStats[surveyInfo.getId()] ?? 0;\r\n\t\tconst maxLaunchesPerSession = surveyInfo.getMaxLaunchesPerSession();\r\n\t\treturn surveyLaunchCountInSession >= maxLaunchesPerSession;\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nexport function hasSurveyReachedMaxLaunches(surveyInfo: ISurveyInfo, surveyActivationStats: SurveyActivationStats): boolean {\r\n\tif (isMultiLaunchSurvey(surveyInfo)) {\r\n\t\tconst surveyLaunchCount = surveyActivationStats?.SurveyLaunchCount || 0;\r\n\t\treturn surveyLaunchCount >= surveyInfo.getMaxLaunches();\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n", "import { IActivityTrackingContract, IActivityTrackingSet } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nexport class ActivityTrackingContract implements IActivityTrackingContract {\r\n\tpublic surveyId: string;\r\n\tpublic trackingSet: IActivityTrackingSet;\r\n\r\n\tpublic constructor(surveyId: string, trackingSet: IActivityTrackingSet) {\r\n\t\tthis.surveyId = surveyId;\r\n\t\tthis.trackingSet = trackingSet;\r\n\t}\r\n}\r\n", "import {\r\n\tFloodgateStorageProviderFileType as FileType,\r\n\tICampaignState,\r\n\tICampaignStateProvider,\r\n\tIFloodgateSetting,\r\n\tIFloodgateSettingStorageCallback,\r\n\tIFloodgateStorageProvider,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { TelemetryEvent } from \"../Constants\";\r\nimport * as StateProviderHelpers from \"../StateProviderHelpers\";\r\nimport * as Utils from \"../Utils\";\r\nimport StateListType = StateProviderHelpers.StateListType;\r\nimport { TelemetryLogger } from \"../TelemetryLogger\";\r\n\r\nconst { getDistantPast, isBoolean, isDate, isNOU, isString, isUtcDatetimeString, stringToDate } = Utils;\r\n\r\nexport class CampaignState implements ICampaignState {\r\n\t/**\r\n\t * Method to deserialize a JSON object to class object\r\n\t * @param input: JSON object\r\n\t * Returns class object\r\n\t */\r\n\tpublic static deserialize(input: any): CampaignState {\r\n\t\tlet result: CampaignState;\r\n\r\n\t\tif (!input) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tresult = new CampaignState(\r\n\t\t\t\tinput.CampaignId,\r\n\t\t\t\tinput.LastNominationTimeUtc,\r\n\t\t\t\tinput.LastNominationBuildNumber,\r\n\t\t\t\tinput.DeleteAfterSecondsWhenStale,\r\n\t\t\t\tfalse, // ForceCandidacy\r\n\t\t\t\tinput.IsCandidate,\r\n\t\t\t\tinput.DidCandidateTriggerSurvey,\r\n\t\t\t\tinput.LastSurveyActivatedTimeUtc,\r\n\t\t\t\tinput.LastSurveyId,\r\n\t\t\t\tinput.LastSurveyStartTimeUtc,\r\n\t\t\t\tinput.LastSurveyExpirationTimeUtc,\r\n\t\t\t\tinput.LastCooldownEndTimeUtc,\r\n\t\t\t);\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.CampaignState.Deserialize.Failed, { ErrorMessage: e.toString() });\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// The Campaign to which this state corresponds\r\n\t// @SerializedName(\"CampaignId\")\r\n\tpublic CampaignId: string;\r\n\r\n\t// The last time the candidacy was evaluated\r\n\t// @SerializedName(\"LastNominationTimeUtc\")\r\n\tpublic LastNominationTimeUtc: Date;\r\n\r\n\t// The build number from the last time the candidacy was evaluated\r\n\t// @SerializedName(\"LastNominationBuildNumber\")\r\n\tpublic LastNominationBuildNumber: string;\r\n\r\n\t// Amount of time to delay cleanup of this state from storage, when it's campaign definition is no longer present\r\n\t// @SerializedName(\"DeleteAfterSecondsWhenStale\")\r\n\tpublic DeleteAfterSecondsWhenStale: number;\r\n\r\n\t// Manual setting that can be used to force this client to be a candidate for this campaign. Not persisted to the file.\r\n\tpublic ForceCandidacy: boolean;\r\n\r\n\t// Whether or not the user is currently a candidate or anti-candidate\r\n\t// @SerializedName(\"IsCandidate\")\r\n\tpublic IsCandidate: boolean;\r\n\r\n\t// Whether or not the user triggered a survey when they are a Candidate.\r\n\t// If isCandidate is false, then this value is meaningless.\r\n\t// If isCandidate is true, then this is used to pick a different campaign cooldown time\r\n\t// @SerializedName(\"DidCandidateTriggerSurvey\")\r\n\tpublic DidCandidateTriggerSurvey: boolean;\r\n\r\n\t// The date the last survey was activated\r\n\t// @SerializedName(\"LastSurveyActivatedTimeUtc\")\r\n\tpublic LastSurveyActivatedTimeUtc: Date;\r\n\r\n\t// region Properties of the most recently generated survey.\u0010\r\n\r\n\t// When isCandidate == true for the current election time, this is used to regenerate the same Survey definition\r\n\t// each time we are invoked\r\n\t// Consider: Putting this in its own subclass\r\n\r\n\t// The surveyId for the most recently generated survey in this campaign (can differ from campaignId, and is\r\n\t// used to guarantee a given survey is shown once)\r\n\t// @SerializedName(\"LastSurveyId\")\r\n\tpublic LastSurveyId: string;\r\n\r\n\t// The start time of the most recently generated survey\r\n\t// @SerializedName(\"LastSurveyStartTimeUtc\")\r\n\tpublic LastSurveyStartTimeUtc: Date;\r\n\r\n\t// The expiration time of the most recently generated survey\r\n\t// @SerializedName(\"LastSurveyExpirationTimeUtc\")\r\n\tpublic LastSurveyExpirationTimeUtc: Date;\r\n\r\n\t// The cooldown end time of the most recently generated survey\r\n\t// @SerializedName(\"LastCooldownEndTimeUtc\")\r\n\tpublic LastCooldownEndTimeUtc: Date;\r\n\r\n\tconstructor(campaignId: string, lastNominationTime: Date, lastNominationBuildNumber: string, deleteAfterSecondsWhenStale: number,\r\n\t\tForceCandidacy: boolean, isCandidate: boolean, didCandidateTriggerSurvey: boolean, lastSurveyActivatedTime: Date,\r\n\t\tlastSurveyId: string, lastSurveyStartTime: Date, lastSurveyExpirationTime: Date, lastCooldownEndTimeUtc: Date) {\r\n\t\tthis.CampaignId = campaignId;\r\n\t\tthis.LastNominationTimeUtc = lastNominationTime;\r\n\t\tthis.LastNominationBuildNumber = lastNominationBuildNumber;\r\n\t\tthis.DeleteAfterSecondsWhenStale = deleteAfterSecondsWhenStale;\r\n\t\tthis.ForceCandidacy = ForceCandidacy;\r\n\t\tthis.IsCandidate = isCandidate;\r\n\t\tthis.DidCandidateTriggerSurvey = didCandidateTriggerSurvey;\r\n\t\tthis.LastSurveyActivatedTimeUtc = lastSurveyActivatedTime;\r\n\t\tthis.LastSurveyId = lastSurveyId;\r\n\t\tthis.LastSurveyStartTimeUtc = lastSurveyStartTime;\r\n\t\tthis.LastSurveyExpirationTimeUtc = lastSurveyExpirationTime;\r\n\t\tthis.LastCooldownEndTimeUtc = lastCooldownEndTimeUtc;\r\n\r\n\t\tif (!this.validate()) {\r\n\t\t\tthrow new Error(\"Constructor arguments are not valid\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic validate(): boolean {\r\n\t\tif (!this.CampaignId || !isString(this.CampaignId)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.LastNominationBuildNumber)\r\n\t\t\t|| !isString(this.LastNominationBuildNumber)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!Utils.isNumber(this.DeleteAfterSecondsWhenStale) || this.DeleteAfterSecondsWhenStale < 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (!isBoolean(this.IsCandidate) || !isBoolean(this.DidCandidateTriggerSurvey)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.IsCandidate) {\r\n\t\t\t// Disallow the following null's if isCandidate == true\r\n\t\t\tif (isNOU(this.LastSurveyStartTimeUtc) || isNOU(this.LastSurveyExpirationTimeUtc)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// LastSurveyId could be \"\"\r\n\t\t\tif (!isString(this.LastSurveyId)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.DidCandidateTriggerSurvey) {\r\n\t\t\t// Disallow the following null's if didCandidateTriggerSurvey == true\r\n\t\t\tif (isNOU(this.LastSurveyActivatedTimeUtc)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (isNOU(this.LastSurveyId)) {\r\n\t\t\tthis.LastSurveyId = \"\";\r\n\t\t} else if (!isString(this.LastSurveyId)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// LastNominationTime does not allow null\r\n\t\tif (isUtcDatetimeString(this.LastNominationTimeUtc)) {\r\n\t\t\tthis.LastNominationTimeUtc = stringToDate(this.LastNominationTimeUtc);\r\n\t\t\t// invalidate if it's not a Date object\r\n\t\t} else if (!isDate(this.LastNominationTimeUtc)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Set value to distance past if value not provided\r\n\t\tif (isNOU(this.LastSurveyActivatedTimeUtc)) {\r\n\t\t\tthis.LastSurveyActivatedTimeUtc = getDistantPast();\r\n\t\t\t// check if it's UTC date time string, possibly coming from deserialize method\r\n\t\t} else if (isUtcDatetimeString(this.LastSurveyActivatedTimeUtc)) {\r\n\t\t\tthis.LastSurveyActivatedTimeUtc = stringToDate(this.LastSurveyActivatedTimeUtc);\r\n\t\t\t// invalidate if it's not a Date object\r\n\t\t} else if (!isDate(this.LastSurveyActivatedTimeUtc)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Set value to distance past if value not provided\r\n\t\tif (isNOU(this.LastSurveyStartTimeUtc)) {\r\n\t\t\tthis.LastSurveyStartTimeUtc = getDistantPast();\r\n\t\t\t// check if it's string, possibly coming from deserialize method\r\n\t\t} else if (isUtcDatetimeString(this.LastSurveyStartTimeUtc)) {\r\n\t\t\tthis.LastSurveyStartTimeUtc = stringToDate(this.LastSurveyStartTimeUtc);\r\n\t\t\t// invalidate if it's not a Date object\r\n\t\t} else if (!isDate(this.LastSurveyStartTimeUtc)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Set value to distance past if value not provided\r\n\t\tif (isNOU(this.LastSurveyExpirationTimeUtc)) {\r\n\t\t\tthis.LastSurveyExpirationTimeUtc = getDistantPast();\r\n\t\t\t// check if it's string, possibly coming from deserialize method\r\n\t\t} else if (isUtcDatetimeString(this.LastSurveyExpirationTimeUtc)) {\r\n\t\t\tthis.LastSurveyExpirationTimeUtc = stringToDate(this.LastSurveyExpirationTimeUtc);\r\n\t\t} else if (!isDate(this.LastSurveyExpirationTimeUtc)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Set value to distance past if value not provided\r\n\t\tif (isNOU(this.LastCooldownEndTimeUtc)) {\r\n\t\t\tthis.LastCooldownEndTimeUtc = getDistantPast();\r\n\t\t\t// check if it's string, possibly coming from deserialize method\r\n\t\t} else if (isUtcDatetimeString(this.LastCooldownEndTimeUtc)) {\r\n\t\t\tthis.LastCooldownEndTimeUtc = stringToDate(this.LastCooldownEndTimeUtc);\r\n\t\t} else if (!isDate(this.LastCooldownEndTimeUtc)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Record that the current survey was taken on this date\r\n\t *\r\n\t * @param date date\r\n\t * @param cooldownSeconds number\r\n\t */\r\n\tpublic markCurrentSurveyTakenOnDate(date: Date, cooldownSeconds: number, isSurveyComplete: boolean): void {\r\n\t\tthis.DidCandidateTriggerSurvey = isSurveyComplete;\r\n\t\tthis.LastSurveyActivatedTimeUtc = date != null ? date : new Date();\r\n\t\tthis.LastCooldownEndTimeUtc = Utils.addSecondsWithoutOverflow(this.LastSurveyActivatedTimeUtc, cooldownSeconds);\r\n\t}\r\n\r\n\tpublic getCooldownStartDate(): Date {\r\n\t\tif (!this.IsCandidate) {\r\n\t\t\treturn this.LastNominationTimeUtc;\r\n\t\t}\r\n\r\n\t\tif (this.DidCandidateTriggerSurvey) {\r\n\t\t\treturn this.LastSurveyActivatedTimeUtc;\r\n\t\t}\r\n\r\n\t\t// In practice this wil be equal to lastNominationTime, but\r\n\t\t// distribution models like a ramp effectively cause us to\r\n\t\t// shift our \"effective nomination date\" forward with the survey start date\r\n\t\treturn this.LastSurveyStartTimeUtc;\r\n\t}\r\n\r\n\t// endregion\r\n}\r\n\r\nexport class CampaignStateProviderFactory {\r\n\tpublic static make(fileBasedStorage: IFloodgateStorageProvider,\r\n\t\thostBasedStorage: IFloodgateSettingStorageCallback): ICampaignStateProvider {\r\n\t\tif (hostBasedStorage) {\r\n\t\t\treturn new HostBasedCampaignStateProvider(fileBasedStorage, hostBasedStorage);\r\n\t\t}\r\n\r\n\t\treturn new FileBasedCampaignStateProvider(fileBasedStorage);\r\n\t}\r\n}\r\n\r\n/**\r\n * Class representing what is stored in the file.\r\n */\r\nclass FileData {\r\n\t// @SerializedName(\"CampaignStates\")\r\n\tpublic CampaignStates: CampaignState[];\r\n\r\n}\r\n\r\nexport class HostBasedCampaignStateProvider implements ICampaignStateProvider {\r\n\tprivate fileBasedStateProvider: ICampaignStateProvider;\r\n\tprivate hostBasedStorage: IFloodgateSettingStorageCallback;\r\n\r\n\tpublic constructor(fileBasedStorage: IFloodgateStorageProvider, hostBasedStorage: IFloodgateSettingStorageCallback) {\r\n\t\tif (!hostBasedStorage) {\r\n\t\t\tthrow new Error(\"host-based storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.hostBasedStorage = hostBasedStorage;\r\n\r\n\t\t// file-based provider is optional\r\n\t\tif (fileBasedStorage) {\r\n\t\t\tthis.fileBasedStateProvider = new FileBasedCampaignStateProvider(fileBasedStorage);\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic load(): CampaignState[] {\r\n\t\tconst statesFromHost: CampaignState[] = this.getStatesFromHost();\r\n\r\n\t\tlet statesFromFile: CampaignState[];\r\n\t\tif (this.fileBasedStateProvider) {\r\n\t\t\tstatesFromFile = this.fileBasedStateProvider.load();\r\n\t\t}\r\n\r\n\t\tconst StateCollections = StateProviderHelpers.MergeAndUpdateCampaignStates(statesFromFile, statesFromHost);\r\n\t\treturn StateCollections.find(StateListType.Merged);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic save(campaignStates: CampaignState[]): void {\r\n\t\tif (!campaignStates) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst statesFromHost: CampaignState[] = this.getStatesFromHost();\r\n\t\tconst StateCollections = StateProviderHelpers.MergeAndUpdateCampaignStates(campaignStates, statesFromHost);\r\n\t\tconst toBeUpdatedStates: CampaignState[] = StateCollections.find(StateListType.ToBeUpdated);\r\n\t\tconst mergedStates: CampaignState[] = StateCollections.find(StateListType.Merged);\r\n\r\n\t\t// write delta_data to host\r\n\t\tif (toBeUpdatedStates) {\r\n\t\t\ttoBeUpdatedStates.forEach((state) => {\r\n\t\t\t\tconst stateValue: string = StateProviderHelpers.makeSettingItemValue(JSON.stringify(state));\r\n\t\t\t\tthis.hostBasedStorage.upsertSettingItem(FileType[FileType.CampaignStates], state.CampaignId, stateValue);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Write merged data to File\r\n\t\tif (this.fileBasedStateProvider) {\r\n\t\t\tthis.fileBasedStateProvider.save(mergedStates);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getStatesFromHost(): CampaignState[] {\r\n\t\tconst states: CampaignState[] = [];\r\n\t\tconst settings: IFloodgateSetting = this.hostBasedStorage.readSettingList(FileType[FileType.CampaignStates]);\r\n\r\n\t\tfor (const key in settings) {\r\n\t\t\tif (!Object.prototype.hasOwnProperty.call(settings, key)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst value = settings[key];\r\n\t\t\tconst dataString: string = StateProviderHelpers.extractSettingItemValueSubString(value);\r\n\r\n\t\t\tlet itemObject: any = {};\r\n\t\t\ttry {\r\n\t\t\t\titemObject = JSON.parse(dataString);\r\n\r\n\t\t\t\tconst newState: CampaignState = CampaignState.deserialize(itemObject);\r\n\t\t\t\tif (newState) {\r\n\t\t\t\t\tstates.push(newState);\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,\r\n\t\t\t\t\t{ ErrorMessage: \"Json parsing/deserializing failed. \" + e.toString() + \".  Input:\" + dataString });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn states;\r\n\t}\r\n}\r\n\r\nexport class FileBasedCampaignStateProvider implements ICampaignStateProvider {\r\n\tprivate storage: IFloodgateStorageProvider;\r\n\r\n\tpublic constructor(storage: IFloodgateStorageProvider) {\r\n\t\tif (!storage) {\r\n\t\t\tthrow new Error(\"storage must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.storage = storage;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic load(): CampaignState[] {\r\n\t\tconst readString: string = this.storage.read(FileType.CampaignStates);\r\n\t\tif (!readString) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tlet fileData: FileData;\r\n\t\ttry {\r\n\t\t\tfileData = JSON.parse(readString);\r\n\r\n\t\t\tconst result: CampaignState[] = [];\r\n\t\t\tif (fileData && fileData.CampaignStates) {\r\n\t\t\t\tfileData.CampaignStates.forEach((state) => {\r\n\t\t\t\t\tconst newState: CampaignState = CampaignState.deserialize(state);\r\n\r\n\t\t\t\t\tif (newState) {\r\n\t\t\t\t\t\tresult.push(newState);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,\r\n\t\t\t\t{ ErrorMessage: \"Json parsing/deserializing failed. \" + e.toString() + \".  Input:\" + readString });\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic save(campaignStates: CampaignState[]): void {\r\n\t\tif (!campaignStates) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst fileData = new FileData();\r\n\t\tfileData.CampaignStates = campaignStates;\r\n\t\tconst writeString: string = JSON.stringify(fileData);\r\n\t\tthis.storage.write(FileType.CampaignStates, writeString);\r\n\t}\r\n}\r\n", "import { IActivityTrackingData } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\n/**\r\n * Basic structure used to configure an ActivityTracker\r\n */\r\nexport class ActivityTrackingData implements IActivityTrackingData {\r\n\tprivate activity: string;\r\n\tprivate count: number;\r\n\tprivate isAggregate: boolean;\r\n\r\n\tpublic constructor(activity: string, count: number, isAggregate: boolean) {\r\n\t\tthis.activity = activity;\r\n\t\tthis.count = count;\r\n\t\tthis.isAggregate = isAggregate;\r\n\t}\r\n\r\n\tpublic getActivity(): string {\r\n\t\treturn this.activity;\r\n\t}\r\n\r\n\tpublic getCount(): number {\r\n\t\treturn this.count;\r\n\t}\r\n\r\n\tpublic setCount(count: number): void {\r\n\t\tthis.count = count;\r\n\t}\r\n\r\n\tpublic getIsAggregate(): boolean {\r\n\t\treturn this.isAggregate;\r\n\t}\r\n}\r\n", "import { IActivityTrackingSet } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { ActivityTrackingData } from \"./ActivityTrackingData\";\r\nimport SurveyActivityListener from \"./SurveyActivityListener\";\r\nimport { isNOU } from \"./Utils\";\r\n\r\n/**\r\n * Class to hold a collection of Activity Tracking Data\r\n */\r\nexport class ActivityTrackingSet implements IActivityTrackingSet {\r\n\tprivate isOrdered: boolean;\r\n\tprivate list: ActivityTrackingData[];\r\n\r\n\tpublic constructor(isOrdered: boolean, list: ActivityTrackingData[]) {\r\n\t\tthis.isOrdered = isOrdered;\r\n\t\tthis.list = list;\r\n\t}\r\n\r\n\tpublic getIsOrdered(): boolean {\r\n\t\treturn this.isOrdered;\r\n\t}\r\n\r\n\tpublic getList(): ActivityTrackingData[] {\r\n\t\treturn this.list;\r\n\t}\r\n\r\n\t// returns a stringified json with the list and isOrdered info.\r\n\tpublic getActivityTrackingInfo(activityListener: SurveyActivityListener, surveyId: string): string {\r\n\r\n\t\tlet activitiesInfoObject: {\r\n\t\t\tActivities: Array<{ Activity: string, Count: number, IsAggregate: boolean }>,\r\n\t\t\tIsListOrdered: boolean,\r\n\t\t};\r\n\r\n\t\tif (this.list.length === 0) {\r\n\t\t\tactivitiesInfoObject = {\r\n\t\t\t\tActivities: [],\r\n\t\t\t\tIsListOrdered: this.isOrdered,\r\n\t\t\t};\r\n\r\n\t\t\treturn JSON.stringify(activitiesInfoObject);\r\n\t\t}\r\n\r\n\t\tfor (const trackingData of this.list) {\r\n\r\n\t\t\tconst actualCount = activityListener.getCount(trackingData.getActivity(), surveyId);\r\n\t\t\tconst tempActivities = {\r\n\t\t\t\tActivity: trackingData.getActivity(),\r\n\t\t\t\tActualCount: actualCount,\r\n\t\t\t\tCount: trackingData.getCount(),\r\n\t\t\t\tIsAggregate: trackingData.getIsAggregate(),\r\n\t\t\t\tIsDiscrete: actualCount % 1 === 0,\r\n\t\t\t};\r\n\r\n\t\t\tif (isNOU(activitiesInfoObject)) {\r\n\t\t\t\tactivitiesInfoObject = {\r\n\t\t\t\t\tActivities: [tempActivities],\r\n\t\t\t\t\tIsListOrdered: this.isOrdered,\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tactivitiesInfoObject.Activities.push(tempActivities);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(activitiesInfoObject);\r\n\t}\r\n}\r\n", "import { ICountedActivityEvent, ICountedActivitySequenceEvent, SurveyEventType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { ActivityTrackingData } from \"./ActivityTrackingData\";\r\nimport { ActivityTrackingSet } from \"./ActivityTrackingSet\";\r\n\r\nexport class CountedActivityEvent implements ICountedActivityEvent {\r\n\tpublic static make(data: CountedActivityEventData): ICountedActivityEvent {\r\n\t\ttry {\r\n\t\t\treturn new CountedActivityEvent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: CountedActivityEventData;\r\n\r\n\tpublic constructor(data: CountedActivityEventData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (data.count <= 0) {\r\n\t\t\tthrow new Error(\"count must be greater than 0\");\r\n\t\t}\r\n\t\tif (!data.activity || data.activity.length === 0) {\r\n\t\t\tthrow new Error(\"activity must not be null or an empty string\");\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t}\r\n\r\n\tpublic getActivity(): string {\r\n\t\treturn this.data.activity;\r\n\t}\r\n\r\n\tpublic getCount(): number {\r\n\t\treturn this.data.count;\r\n\t}\r\n\r\n\tpublic isAggregate(): boolean {\r\n\t\treturn this.data.isAggregate;\r\n\t}\r\n\r\n\tpublic getType(): SurveyEventType {\r\n\t\treturn SurveyEventType.CountedActivity;\r\n\t}\r\n\r\n\tpublic getTrackingSet(): ActivityTrackingSet {\r\n\t\tconst trackingDataList = new Array<ActivityTrackingData>();\r\n\t\ttrackingDataList.push(new ActivityTrackingData(this.data.activity, this.data.count, this.data.isAggregate));\r\n\t\treturn new ActivityTrackingSet(false, trackingDataList);\r\n\t}\r\n}\r\n\r\n/**\r\n * Data class for serialization and deserialization. Do not add logic in here.\r\n */\r\nexport class CountedActivityEventData {\r\n\tpublic activity: string;\r\n\tpublic count: number;\r\n\tpublic isAggregate: boolean;\r\n}\r\n\r\nexport class CountedActivitySequenceEvent implements ICountedActivitySequenceEvent {\r\n\tpublic static make(data: CountedActivitySequenceEventData): ICountedActivitySequenceEvent {\r\n\t\ttry {\r\n\t\t\treturn new CountedActivitySequenceEvent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: ICountedActivityEvent[];\r\n\r\n\tpublic constructor(data: CountedActivitySequenceEventData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.sequence) {\r\n\t\t\tthrow new Error(\"data.sequence must not be null\");\r\n\t\t}\r\n\t\tif (data.sequence.length === 0) {\r\n\t\t\tthrow new Error(\"data.sequence size must be greater than 0\");\r\n\t\t}\r\n\r\n\t\tthis.data = [];\r\n\t\tfor (const countedActivityEventData of data.sequence) {\r\n\t\t\tthis.data.push(new CountedActivityEvent(countedActivityEventData));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getSequence(): ICountedActivityEvent[] {\r\n\t\treturn this.data;\r\n\t}\r\n\r\n\tpublic getType(): SurveyEventType {\r\n\t\treturn SurveyEventType.CountedActivitySequence;\r\n\t}\r\n\r\n\tpublic getTrackingSet(): ActivityTrackingSet {\r\n\t\tconst trackingDataList = new Array<ActivityTrackingData>();\r\n\r\n\t\tfor (const countedActivityEvent of this.data) {\r\n\t\t\ttrackingDataList.push(new ActivityTrackingData(countedActivityEvent.getActivity(), countedActivityEvent.getCount(),\r\n\t\t\t\tcountedActivityEvent.isAggregate()));\r\n\t\t}\r\n\r\n\t\treturn new ActivityTrackingSet(true, trackingDataList);\r\n\t}\r\n}\r\n\r\n/**\r\n * Data class for serialization and deserialization. Do not add logic in here.\r\n */\r\nexport class CountedActivitySequenceEventData {\r\n\tpublic sequence: CountedActivityEventData[];\r\n\r\n\t/**\r\n\t * No args constructor needed for serialization.\r\n\t */\r\n\tpublic CountedActivitySequenceEventData() {\r\n\t}\r\n}\r\n", "import { ISurveyMetadata } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Utils from \"./Utils\";\r\n\r\nexport class SurveyMetadata implements ISurveyMetadata {\r\n\tpublic static make(data: Metadata): ISurveyMetadata {\r\n\t\ttry {\r\n\t\t\treturn new SurveyMetadata(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: Metadata;\r\n\r\n\tpublic constructor(data: Metadata) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.contentMetadata) {\r\n\t\t\tthrow new Error(\"content metadata must not be null\");\r\n\t\t}\r\n\t\tif (!Utils.isObject(data.contentMetadata)) {\r\n\t\t\tthrow new Error(\"content metadata must be of object type\");\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t}\r\n\r\n\tpublic getContentMetadata(): object {\r\n\t\treturn this.data.contentMetadata;\r\n\t}\r\n}\r\n\r\n/**\r\n * Data class for serialization and deserialization. Do not add logic in here.\r\n */\r\nexport class Metadata {\r\n\tpublic contentMetadata: object;\r\n}\r\n", "import { ISurvey, ISurveyComponent, ISurveyInfo, ITransporter, IUxSchema, SurveyComponentType, SurveyType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { FloodgateEngine } from \"../FloodgateEngine\";\r\nimport * as Utils from \"./../Utils\";\r\n\r\nexport abstract class Survey implements ISurvey {\r\n\tprivate survey: ISurvey;\r\n\tprivate clientFeedbackId: string;\r\n\tprivate uxSchema: IUxSchema\r\n\r\n\tpublic abstract getComponent(componentType: SurveyComponentType): ISurveyComponent;\r\n\r\n\tpublic getCampaignId(): string {\r\n\t\treturn this.getSurveyInfo().getBackEndId();\r\n\t}\r\n\r\n\tpublic getLauncherType(): string {\r\n\t\treturn this.getSurveyInfo().getLauncherType();\r\n\t}\r\n\r\n\tpublic getClientFeedbackId(): string {\r\n\t\treturn this.clientFeedbackId;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.getSurveyInfo().getTags();\r\n\t}\r\n\r\n\tpublic async submit(): Promise<void> {\r\n\t\tconst surveyType: string = SurveyType[this.getType()];\r\n\t\tconst transporter: ITransporter = FloodgateEngine.getTransportFactory().makeTransporter(surveyType);\r\n\t\ttransporter.setManifestValues(this.getJsonElements());\r\n\t\tthis.clientFeedbackId = transporter.getClientFeedbackId();\r\n\t\treturn transporter.submit();\r\n\t}\r\n\r\n\tpublic getPreGeneratedClientFeedbackId(): string {\r\n\t\tif (this.clientFeedbackId) {\r\n\t\t\treturn this.clientFeedbackId;\r\n\t\t} else {\r\n\t\t\treturn this.clientFeedbackId = Utils.guid();\r\n\t\t}\r\n\t}\r\n\t\r\n\tpublic getUxSchema(): IUxSchema {\r\n\t\treturn this.uxSchema;\r\n\t}\r\n\t\r\n\tpublic setUxSchema(inputSchema: IUxSchema) {\r\n\t\tthis.uxSchema = inputSchema;\r\n\t}\r\n\t\r\n\tpublic isContentValid(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// Abstract classes that are implemented by actual Surveys\r\n\tpublic abstract getType(): SurveyType;\r\n\r\n\tpublic abstract getSurveyInfo(): ISurveyInfo;\r\n\r\n\tpublic abstract getJsonElements(): object;\r\n\r\n\tpublic abstract getDomElements(doc: Document): Element[];\r\n}\r\n", "import {\r\n\tDOM_ID_TAGNAME,\r\n\tDOM_TYPE_TAGNAME,\r\n\tDOM_TYPE_VALUE,\r\n\tGovernedChannelType,\r\n\tISurveyEvent,\r\n\tISurveyInfo,\r\n\tISurveyMetadata,\r\n\tJSON_ID_KEYNAME,\r\n\tJSON_SURVEY_KEYNAME,\r\n\tLAUNCHER_TYPE_DEFAULT,\r\n\tSurveyInfoAdditionalDataType,\r\n\tSurveyInfoBusinessLevel,\r\n\tSurveyInfoLaunchType,\r\n\tTreatmentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Utils from \"../Utils\";\r\n\r\nconst { getDistantFuture, getDistantPast, isNOU, isDate } = Utils;\r\n\r\nclass SurveyDataSource implements ISurveyInfo {\r\n\tprivate data: SurveyDataSource.SurveyDataSourceData;\r\n\r\n\tpublic constructor(data: SurveyDataSource.SurveyDataSourceData) {\r\n\t\tif (isNOU(data)) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (isNOU(data.id) || data.id === \"\") {\r\n\t\t\tthrow new Error(\"data.id must not be null or empty\");\r\n\t\t}\r\n\t\tif (isNOU(data.governedChannelType)) {\r\n\t\t\tdata.governedChannelType = GovernedChannelType.getDefault();\r\n\t\t}\r\n\t\tif (isNOU(data.expirationTimeUtc) || data.expirationTimeUtc === \"\") {\r\n\t\t\tthrow new Error(\"data.expirationTimeUtc must not be null or empty\");\r\n\t\t}\r\n\t\tif (isNOU(data.activationEvent)) {\r\n\t\t\tthrow new Error(\"data.activationEvent must not be null\");\r\n\t\t}\r\n\t\tif (isNOU(data.backEndIdentifier) || data.backEndIdentifier === \"\") {\r\n\t\t\tdata.backEndIdentifier = data.id;\r\n\t\t}\r\n\t\tif (isNOU(data.launcherType)) {\r\n\t\t\tdata.launcherType = LAUNCHER_TYPE_DEFAULT;\r\n\t\t}\r\n\t\tif(isNOU(data.treatmentType)){\r\n\t\t\tdata.treatmentType = TreatmentType.none;\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getId(): string {\r\n\t\treturn this.data.id;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getBackEndId(): string {\r\n\t\treturn this.data.backEndIdentifier;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getGovernedChannelType(): GovernedChannelType {\r\n\t\treturn this.data.governedChannelType;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getRawStartTimeUtc(): string {\r\n\t\treturn this.data.startTimeUtc;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getStartTimeUtc(): Date {\r\n\t\tif (isNOU(this.data.startTimeUtc)) {\r\n\t\t\treturn getDistantPast(); // Optional start date means the survey has started\r\n\t\t}\r\n\r\n\t\tconst parsed = new Date(this.data.startTimeUtc);\r\n\t\tif (!isDate(parsed)) {\r\n\t\t\treturn getDistantFuture(); // Badly specified start dates means the survey never starts\r\n\t\t}\r\n\r\n\t\treturn parsed;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getExpirationTimeUtc(): Date {\r\n\t\t// Bad or missing expiration date means survey is always expired.\r\n\r\n\t\tif (isNOU(this.data.expirationTimeUtc)) {\r\n\t\t\treturn getDistantPast();\r\n\t\t}\r\n\r\n\t\tconst parsed = new Date(this.data.expirationTimeUtc);\r\n\t\tif (!isDate(parsed)) {\r\n\t\t\treturn getDistantPast();\r\n\t\t}\r\n\r\n\t\treturn parsed;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getRawExpirationTimeUtc(): string {\r\n\t\treturn this.data.expirationTimeUtc;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isActiveForDate(date: Date): boolean {\r\n\t\tif (isNOU(date)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn (date >= this.getStartTimeUtc() && date <= this.getExpirationTimeUtc());\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getActivationEvent(): ISurveyEvent {\r\n\t\treturn this.data.activationEvent;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getPreferredLaunchType(): SurveyInfoLaunchType {\r\n\t\treturn this.data.preferredLaunchType;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isAdditionalDataRequested(additionalDataToCheck: SurveyInfoAdditionalDataType): boolean {\r\n\t\tif (isNOU(this.data.additionalDataRequested)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfor (const additionalData of this.data.additionalDataRequested) {\r\n\t\t\tif (additionalData === additionalDataToCheck) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getLauncherType(): string {\r\n\t\treturn this.data.launcherType;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getMetadata(): ISurveyMetadata {\r\n\t\treturn this.data.metadata;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.data.tags;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getBusinessLevel(): SurveyInfoBusinessLevel {\r\n\t\treturn this.data.businessLevel;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTreatmentType(): TreatmentType {\r\n\t\treturn this.data.treatmentType;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getMaxLaunches(): number {\r\n\t\treturn this.data.maxLaunches;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getMaxLaunchesPerSession(): number {\r\n\t\treturn this.data.maxLaunchesPerSession;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst typeElement: Element = doc.createElement(DOM_TYPE_TAGNAME);\r\n\t\ttypeElement.appendChild(doc.createTextNode(DOM_TYPE_VALUE));\r\n\r\n\t\tconst idElement: Element = doc.createElement(DOM_ID_TAGNAME);\r\n\t\tidElement.appendChild(doc.createTextNode(this.getBackEndId()));\r\n\r\n\t\treturn [typeElement, idElement];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tconst surveyObject: object = {};\r\n\t\tsurveyObject[JSON_ID_KEYNAME] = this.getBackEndId();\r\n\r\n\t\tconst result: object = {};\r\n\t\tresult[JSON_SURVEY_KEYNAME] = surveyObject;\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nmodule SurveyDataSource {\r\n\t/**\r\n\t * Basic data needed for all Surveys\r\n\t */\r\n\texport class SurveyDataSourceData {\r\n\t\tpublic id: string;\r\n\t\tpublic backEndIdentifier: string;\r\n\t\tpublic governedChannelType: GovernedChannelType;\r\n\t\tpublic startTimeUtc: string;\r\n\t\tpublic expirationTimeUtc: string;\r\n\t\tpublic activationEvent: ISurveyEvent;\r\n\t\tpublic preferredLaunchType: SurveyInfoLaunchType = SurveyInfoLaunchType.Default;\r\n\t\tpublic additionalDataRequested: SurveyInfoAdditionalDataType[];\r\n\t\tpublic launcherType: string;\r\n\t\tpublic metadata: ISurveyMetadata;\r\n\t\tpublic tags: string[];\r\n\t\t\r\n\t\tpublic treatmentType: TreatmentType;\r\n\t\tpublic businessLevel: SurveyInfoBusinessLevel;\r\n\t\tpublic maxLaunches: number;\r\n\t\tpublic maxLaunchesPerSession: number;\r\n\t}\r\n}\r\n\r\nexport default SurveyDataSource;\r\n", "import { ISurvey, ISurveyComponent, ISurveyInfo, SurveyComponentType, SurveyType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Utils from \"../Utils\";\r\nimport { Survey } from \"./Survey\";\r\nimport SurveyDataSource from \"./SurveyDataSource\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\n// Dialog survey for dialogs (eg: FRE). Dialog properties have to be added to the SurveyMetadata.\r\nclass DialogSurvey extends Survey {\r\n\tpublic static make(data: DialogSurvey.DialogSurveyData): ISurvey {\r\n\t\ttry {\r\n\t\t\treturn new DialogSurvey(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static makeCustom(baseData: SurveyDataSource.SurveyDataSourceData): ISurvey {\r\n\t\tif (isNOU(baseData)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst data = new DialogSurvey.DialogSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tprivate surveyInfo: SurveyDataSource;\r\n\r\n\tprivate constructor(data: DialogSurvey.DialogSurveyData) {\r\n\t\tsuper();\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.surveyInfo = new SurveyDataSource(data.baseData);\r\n\r\n\t\t// This check cannot be done in survey info constructor\r\n\t\t// as metadata is specific to this survey type.\r\n\t\tif (isNOU(this.surveyInfo.getMetadata())) {\r\n\t\t\tthrow new Error(\"metadata must not be null\");\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyType {\r\n\t\treturn SurveyType.Dialog;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSurveyInfo(): ISurveyInfo {\r\n\t\treturn this.surveyInfo;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.surveyInfo.getTags();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponent(_componentType: SurveyComponentType): ISurveyComponent {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(_doc: Document): Element[] {\r\n\t\treturn [];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\treturn {};\r\n\t}\r\n}\r\n\r\nmodule DialogSurvey {\r\n\t/**\r\n\t * Data required for a Generic Surface Survey\r\n\t */\r\n\texport class DialogSurveyData {\r\n\t\tpublic baseData: SurveyDataSource.SurveyDataSourceData;\r\n\t}\r\n}\r\n\r\nexport default DialogSurvey;\r\n", "import {\r\n\tDOM_COMMENT_TAGNAME,\r\n\tICommentComponent,\r\n\tJSON_COMMENT_KEYNAME,\r\n\tJSON_QUESTION_KEYNAME,\r\n\tSurveyComponentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nclass CommentComponent implements ICommentComponent {\r\n\tpublic static make(data: CommentComponent.CommentComponentData): ICommentComponent {\r\n\t\ttry {\r\n\t\t\treturn new CommentComponent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: CommentComponent.CommentComponentData;\r\n\tprivate userComment: string;\r\n\r\n\tpublic constructor(data: CommentComponent.CommentComponentData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.question) {\r\n\t\t\tthrow new Error(\"data.question must not be null or empty\");\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t\tthis.userComment = \"\";\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyComponentType {\r\n\t\treturn SurveyComponentType.Comment;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getQuestion(): string {\r\n\t\treturn this.data.question;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic setSubmittedText(userComment: string): void {\r\n\t\tthis.userComment = userComment;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSubmittedText(): string {\r\n\t\treturn this.userComment;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_COMMENT_TAGNAME);\r\n\t\telement.appendChild(doc.createTextNode(this.getSubmittedText()));\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tconst result: object = {};\r\n\t\tresult[JSON_COMMENT_KEYNAME] = this.getSubmittedText();\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponentJson(): object {\r\n\t\treturn {\r\n\t\t\t[JSON_QUESTION_KEYNAME]: this.getQuestion(),\r\n\t\t};\r\n\t}\r\n}\r\n\r\nmodule CommentComponent {\r\n\texport class CommentComponentData {\r\n\t\tpublic question: string;\r\n\t}\r\n}\r\n\r\nexport default CommentComponent;\r\n", "import {\r\n\tDOM_CVSURVEY_TAGNAME,\r\n\tICVSurveyComponent,\r\n\tJSON_CVSURVEY_KEYNAME,\r\n\tJSON_CVSURVEYFORMID_KEYNAME,\r\n\tSurveyComponentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nclass CVSurveyComponent implements ICVSurveyComponent {\r\n\tpublic static make(data: CVSurveyComponent.CVSurveyComponentData): ICVSurveyComponent {\r\n\t\ttry {\r\n\t\t\treturn new CVSurveyComponent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: CVSurveyComponent.CVSurveyComponentData;\r\n\r\n\tpublic constructor(data: CVSurveyComponent.CVSurveyComponentData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.customerVoiceFormId) {\r\n\t\t\tthrow new Error(\"data.formID must not be null or empty\");\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t}\r\n\r\n\tpublic getType(): SurveyComponentType {\r\n\t\treturn SurveyComponentType.CVSurvey;\r\n\t}\r\n\r\n\tpublic getFormId(): string {\r\n\t\treturn this.data.customerVoiceFormId;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\t\tconst element: Element = doc.createElement(DOM_CVSURVEY_TAGNAME);\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tconst result: object = {};\r\n\r\n\t\tresult[JSON_CVSURVEY_KEYNAME] = this.getFormId();\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponentJson(): object {\r\n\t\treturn {\r\n\t\t\t[JSON_CVSURVEYFORMID_KEYNAME]: this.getFormId(),\r\n\t\t};\r\n\t}\r\n}\r\n\r\nmodule CVSurveyComponent {\r\n\texport class CVSurveyComponentData {\r\n\t\tpublic customerVoiceFormId: string;\r\n\t}\r\n}\r\n\r\nexport default CVSurveyComponent;\r\n", "import {\r\n\tDOM_MULTIPLECHOICE_TAGNAME,\r\n\tIMultipleChoiceComponent,\r\n\tJSON_MULTIPLECHOICE_KEYNAME,\r\n\tJSON_QUESTION_KEYNAME,\r\n\tJSON_RATINGOPTIONS_KEYNAME,\r\n\tSurveyComponentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nclass MultipleChoiceComponent implements IMultipleChoiceComponent {\r\n\tpublic static make(data: MultipleChoiceComponent.MultipleChoiceComponentData): IMultipleChoiceComponent {\r\n\t\ttry {\r\n\t\t\treturn new MultipleChoiceComponent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: MultipleChoiceComponent.MultipleChoiceComponentData;\r\n\tprivate optionStates: boolean[];\r\n\r\n\tpublic constructor(data: MultipleChoiceComponent.MultipleChoiceComponentData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.question) {\r\n\t\t\tthrow new Error(\"data.question must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.availableOptions || data.availableOptions.length < 2) {\r\n\t\t\tthrow new Error(\"data.availableOptions must not be null or have less than two choices\");\r\n\t\t}\r\n\r\n\t\tdata.availableOptions.forEach((option) => {\r\n\t\t\tif (!option) {\r\n\t\t\t\tthrow new Error(\"Option values must not contain null or empty\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.data = data;\r\n\t\tthis.optionStates = new Array<boolean>(data.availableOptions.length);\r\n\t\t// Initialize with all false values\r\n\t\tfor (let i = 0; i < this.optionStates.length; i++) {\r\n\t\t\tthis.optionStates[i] = false;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getType(): SurveyComponentType {\r\n\t\treturn SurveyComponentType.MultipleChoice;\r\n\t}\r\n\r\n\tpublic getQuestion(): string {\r\n\t\treturn this.data.question;\r\n\t}\r\n\r\n\tpublic getAvailableOptions(): string[] {\r\n\t\treturn this.data.availableOptions;\r\n\t}\r\n\r\n\tpublic getOptionSelectedStates(): boolean[] {\r\n\t\treturn this.optionStates;\r\n\t}\r\n\r\n\tpublic getMinNumberofSelectedOptions(): number {\r\n\t\treturn this.data.minNumberOfSelectedOptions;\r\n\t}\r\n\r\n\tpublic getMaxNumberofSelectedOptions(): number {\r\n\t\treturn this.data.maxNumberOfSelectedOptions;\r\n\t}\r\n\r\n\tpublic setOptionSelectedStates(selectedStates: boolean[]): void {\r\n\t\tfor (let i = 0; i < selectedStates.length; i++) {\r\n\t\t\tthis.optionStates[i] = selectedStates[i];\r\n\t\t}\r\n\t}\r\n\r\n\tpublic ValidateMinNumberofSelectedOptions(): boolean {\r\n\t\tlet result = 0;\r\n\t\tthis.optionStates.forEach((element) => {\r\n\t\t\tif (element) {\r\n\t\t\t\tresult++;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (result >= this.getMinNumberofSelectedOptions());\r\n\t}\r\n\r\n\tpublic ValidateMaxNumberofSelectedOptions(): boolean {\r\n\t\tlet result = 0;\r\n\t\tthis.optionStates.forEach((element) => {\r\n\t\t\tif (element) {\r\n\t\t\t\tresult++;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (result <= this.getMaxNumberofSelectedOptions());\r\n\t}\r\n\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_MULTIPLECHOICE_TAGNAME);\r\n\r\n\t\telement.appendChild(doc.createTextNode(this.getOptionSelectedStates().toString()));\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tconst result: object = {};\r\n\t\tresult[JSON_MULTIPLECHOICE_KEYNAME] = this.getOptionSelectedStates().toString();\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponentJson(): object {\r\n\t\treturn {\r\n\t\t\t[JSON_QUESTION_KEYNAME]: this.getQuestion(),\r\n\t\t\t[JSON_RATINGOPTIONS_KEYNAME]: this.getAvailableOptions(),\r\n\t\t};\r\n\t}\r\n}\r\n\r\nmodule MultipleChoiceComponent {\r\n\texport class MultipleChoiceComponentData {\r\n\t\tpublic question: string;\r\n\t\tpublic availableOptions: string[];\r\n\t\tpublic minNumberOfSelectedOptions: number;\r\n\t\tpublic maxNumberOfSelectedOptions: number;\r\n\t}\r\n}\r\n\r\nexport default MultipleChoiceComponent;\r\n", "import {\r\n\tDOM_PROMPT_TAGNAME,\r\n\tIPromptComponent,\r\n\tJSON_PROMPTNOTEXT_KEYNAME,\r\n\tJSON_PROMPTYESTEXT_KEYNAME,\r\n\tJSON_PROMPT_KEYNAME,\r\n\tJSON_QUESTION_KEYNAME,\r\n\tJSON_TITLE_KEYNAME,\r\n\tPromptButton,\r\n\tSurveyComponentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nclass PromptComponent implements IPromptComponent {\r\n\tpublic static make(data: PromptComponent.PromptComponentData): IPromptComponent {\r\n\t\ttry {\r\n\t\t\treturn new PromptComponent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: PromptComponent.PromptComponentData;\r\n\tprivate selectedButton: PromptButton;\r\n\r\n\tpublic constructor(data: PromptComponent.PromptComponentData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.question) {\r\n\t\t\tthrow new Error(\"data.question must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.title) {\r\n\t\t\tthrow new Error(\"data.title must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.yesButtonLabel) {\r\n\t\t\tthrow new Error(\"data.yesButtonLabel must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.noButtonLabel) {\r\n\t\t\tthrow new Error(\"data.noButtonLabel must not be null or empty\");\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t\tthis.selectedButton = PromptButton.Unselected;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyComponentType {\r\n\t\treturn SurveyComponentType.Prompt;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTitle(): string {\r\n\t\treturn this.data.title;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getQuestion(): string {\r\n\t\treturn this.data.question;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getYesButtonText(): string {\r\n\t\treturn this.data.yesButtonLabel;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getNoButtonText(): string {\r\n\t\treturn this.data.noButtonLabel;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic setButtonSelected(selected: PromptButton): void {\r\n\t\tif (selected) {\r\n\t\t\tthis.selectedButton = selected;\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getButtonSelected(): PromptButton {\r\n\t\treturn this.selectedButton;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_PROMPT_TAGNAME);\r\n\t\telement.appendChild(doc.createTextNode(this.promptButtonToString(this.getButtonSelected())));\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tconst result: object = {};\r\n\t\tresult[JSON_PROMPT_KEYNAME] = this.promptButtonToString(this.getButtonSelected());\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponentJson(): object {\r\n\t\treturn {\r\n\t\t\t[JSON_TITLE_KEYNAME]: this.getTitle(),\r\n\t\t\t[JSON_QUESTION_KEYNAME]: this.getQuestion(),\r\n\t\t\t[JSON_PROMPTYESTEXT_KEYNAME]: this.getYesButtonText(),\r\n\t\t\t[JSON_PROMPTNOTEXT_KEYNAME]: this.getNoButtonText(),\r\n\t\t};\r\n\t}\r\n\r\n\tprivate promptButtonToString(value: PromptButton): string {\r\n\t\tswitch (value) {\r\n\t\t\tcase PromptButton.Unselected:\r\n\t\t\t\treturn \"Unselected\";\r\n\t\t\tcase PromptButton.Yes:\r\n\t\t\t\treturn \"Yes\";\r\n\t\t\tcase PromptButton.No:\r\n\t\t\t\treturn \"No\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"Unknown\";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule PromptComponent {\r\n\texport class PromptComponentData {\r\n\t\tpublic question: string;\r\n\t\tpublic title: string;\r\n\t\tpublic yesButtonLabel: string;\r\n\t\tpublic noButtonLabel: string;\r\n\t}\r\n}\r\n\r\nexport default PromptComponent;\r\n", "import {\r\n\tDOM_RATING_TAGNAME,\r\n\tIRatingComponent,\r\n\tJSON_QUESTION_KEYNAME,\r\n\tJSON_RATINGOPTIONS_KEYNAME,\r\n\tJSON_RATING_KEYNAME,\r\n\tSurveyComponentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nclass RatingComponent implements IRatingComponent {\r\n\tpublic static make(data: RatingComponent.RatingComponentData): IRatingComponent {\r\n\t\ttry {\r\n\t\t\treturn new RatingComponent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: RatingComponent.RatingComponentData;\r\n\tprivate selectedIndex: number;\r\n\r\n\tpublic constructor(data: RatingComponent.RatingComponentData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.question) {\r\n\t\t\tthrow new Error(\"data.question must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.ratingValuesAscending || data.ratingValuesAscending.length < 2) {\r\n\t\t\tthrow new Error(\"data.ratingValuesAscending must not be null or have less than two choices\");\r\n\t\t}\r\n\r\n\t\tdata.ratingValuesAscending.forEach((rating) => {\r\n\t\t\tif (!rating) {\r\n\t\t\t\tthrow new Error(\"rating values must not contain null or empty\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.data = data;\r\n\t\tthis.selectedIndex = -1;\r\n\t}\r\n\r\n\tpublic getType(): SurveyComponentType {\r\n\t\treturn SurveyComponentType.Rating;\r\n\t}\r\n\r\n\tpublic getQuestion(): string {\r\n\t\treturn this.data.question;\r\n\t}\r\n\r\n\tpublic getRatingValuesAscending(): string[] {\r\n\t\treturn this.data.ratingValuesAscending;\r\n\t}\r\n\r\n\tpublic getSelectedRating(): string {\r\n\t\tif (!this.isRatingIndexValid(this.selectedIndex)) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\treturn this.data.ratingValuesAscending[this.selectedIndex];\r\n\t}\r\n\r\n\tpublic setSelectedRatingIndex(selected: number): void {\r\n\t\tif (this.isRatingIndexValid(selected)) {\r\n\t\t\tthis.selectedIndex = selected;\r\n\t\t} else {\r\n\t\t\tthis.selectedIndex = -1;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getSelectedRatingIndex(): number {\r\n\t\treturn this.selectedIndex;\r\n\t}\r\n\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_RATING_TAGNAME);\r\n\r\n\t\tif (!this.isRatingIndexValid(this.getSelectedRatingIndex())) {\r\n\t\t\telement.appendChild(doc.createTextNode(\"Not rated\"));\r\n\t\t} else {\r\n\t\t\t// Enforce six digits after the decimal\r\n\t\t\telement.appendChild(doc.createTextNode(this.getNormalizedRatingScore().toFixed(6)));\r\n\t\t}\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tconst result: object = {};\r\n\r\n\t\tif (!this.isRatingIndexValid(this.getSelectedRatingIndex())) {\r\n\t\t\tresult[JSON_RATING_KEYNAME] = \"Not rated\";\r\n\t\t} else {\r\n\t\t\tresult[JSON_RATING_KEYNAME] = this.getNormalizedRatingScore();\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponentJson(): object {\r\n\t\treturn {\r\n\t\t\t[JSON_QUESTION_KEYNAME]: this.getQuestion(),\r\n\t\t\t[JSON_RATINGOPTIONS_KEYNAME]: this.getRatingValuesAscending(),\r\n\t\t};\r\n\t}\r\n\r\n\tpublic getNormalizedRatingScore(): number {\r\n\t\tif (!this.isRatingIndexValid(this.getSelectedRatingIndex())) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tif (this.data.isZeroBased) {\r\n\t\t\treturn (this.selectedIndex) / (this.data.ratingValuesAscending.length - 1);\r\n\t\t} else {\r\n\t\t\treturn (this.selectedIndex + 1.0) / this.data.ratingValuesAscending.length;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isRatingIndexValid(index: number): boolean {\r\n\t\treturn (index >= 0 && index < this.data.ratingValuesAscending.length);\r\n\t}\r\n\r\n}\r\n\r\nmodule RatingComponent {\r\n\texport class RatingComponentData {\r\n\t\tpublic question: string;\r\n\t\tpublic ratingValuesAscending: string[];\r\n\t\tpublic isZeroBased: boolean;\r\n\t}\r\n}\r\n\r\nexport default RatingComponent;\r\n", "import {\r\n\tDOM_FPS_TAGNAME,\r\n\tIFloodgateStringProvider,\r\n\tIFpsSurvey,\r\n\tISurveyComponent,\r\n\tISurveyInfo,\r\n\tIUxSchema,\r\n\tJSON_APPLICATION_KEYNAME,\r\n\tJSON_COMMENT_KEYNAME,\r\n\tJSON_EXTENDEDMANIFESTDATA_KEYNAME,\r\n\tJSON_MULTIPLECHOICE_KEYNAME,\r\n\tJSON_PROMPT_KEYNAME,\r\n\tJSON_RATING_KEYNAME,\r\n\tJSON_SURVEYSPECIFICDATA_KEYNAME,\r\n\tJSON_SURVEYSTRINGS_KEYNAME,\r\n\tSurveyComponentType,\r\n\tSurveyType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { CampaignSurveyContent, CampaignSurveyTemplate } from \"../Campaign/CampaignDefinitionProvider\";\r\nimport CommentComponent from \"../SurveyComponents/CommentComponent\";\r\nimport CVSurveyComponent from \"../SurveyComponents/CVSurveyComponent\";\r\nimport MultipleChoiceComponent from \"../SurveyComponents/MultipleChoiceComponent\";\r\nimport PromptComponent from \"../SurveyComponents/PromptComponent\";\r\nimport RatingComponent from \"../SurveyComponents/RatingComponent\";\r\nimport * as Utils from \"../Utils\";\r\nimport { Survey } from \"./Survey\";\r\nimport SurveyDataSource from \"./SurveyDataSource\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nclass FpsSurvey extends Survey implements IFpsSurvey {\r\n\tpublic static make(data: FpsSurvey.FpsSurveyData): IFpsSurvey {\r\n\t\ttry {\r\n\t\t\treturn new FpsSurvey(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static makeFps(baseData: SurveyDataSource.SurveyDataSourceData, sp: IFloodgateStringProvider,\r\n\t\tsurveyModel: CampaignSurveyTemplate): IFpsSurvey {\r\n\r\n\t\tif (isNOU(baseData) || isNOU(sp) || isNOU(surveyModel)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst ratingValuesAscending: string[] = [];\r\n\t\tconst availableOptions: string[] = [];\r\n\t\tconst content: CampaignSurveyContent = surveyModel.content;\r\n\t\tlet contentValid = true;\r\n\r\n\t\t// Either UxSchema or Prompt/Content must be in the survey\r\n\t\t// In case of Prompt/Content, Prompt is required and at least one of the other components are required\r\n\t\tif (isNOU(content) || isNOU(content.prompt) ||\r\n\t\t\t(isNOU(content.rating) && isNOU(content.multipleChoice) &&\r\n\t\t\t\tisNOU(content.comment))) {\r\n\t\t\tcontentValid = false;\r\n\t\t\tif (!surveyModel.uxSchema) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst data = new FpsSurvey.FpsSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\t\tdata.uxSchema = surveyModel.uxSchema;\r\n\r\n\t\tif (contentValid) {\r\n\t\t\tdata.promptData = new PromptComponent.PromptComponentData();\r\n\t\t\tdata.promptData.title = sp.getCustomString(content.prompt.title);\r\n\t\t\tdata.promptData.question = sp.getCustomString(content.prompt.question);\r\n\t\t\tdata.promptData.yesButtonLabel = sp.getCustomString(content.prompt.yesLabel);\r\n\t\t\tdata.promptData.noButtonLabel = sp.getCustomString(content.prompt.noLabel);\r\n\r\n\t\t\tif (isNOU(data.promptData.title)\r\n\t\t\t\t|| isNOU(data.promptData.question)\r\n\t\t\t\t|| isNOU(data.promptData.yesButtonLabel)\r\n\t\t\t\t|| isNOU(data.promptData.noButtonLabel)) {\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tif (content.rating) {\r\n\t\t\t\tdata.ratingData = new RatingComponent.RatingComponentData();\r\n\t\t\t\tdata.ratingData.question = sp.getCustomString(content.rating.question);\r\n\t\t\t\tdata.ratingData.isZeroBased = content.rating.isZeroBased;\r\n\r\n\t\t\t\tfor (const value of content.rating.ratingValuesAscending) {\r\n\t\t\t\t\tconst customString: string = sp.getCustomString(value);\r\n\r\n\t\t\t\t\tif (isNOU(customString)) {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tratingValuesAscending.push(customString);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata.ratingData.ratingValuesAscending = ratingValuesAscending;\r\n\r\n\t\t\t\tif (isNOU(data.ratingData.question)\r\n\t\t\t\t\t|| isNOU(data.ratingData.ratingValuesAscending)) {\r\n\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (content.multipleChoice) {\r\n\t\t\t\tdata.multipleChoiceData = new MultipleChoiceComponent.MultipleChoiceComponentData();\r\n\t\t\t\tdata.multipleChoiceData.question = sp.getCustomString(content.multipleChoice.question);\r\n\t\t\t\tdata.multipleChoiceData.minNumberOfSelectedOptions = content.multipleChoice.minNumberOfSelectedOptions;\r\n\t\t\t\tdata.multipleChoiceData.maxNumberOfSelectedOptions = content.multipleChoice.maxNumberOfSelectedOptions;\r\n\r\n\t\t\t\tfor (const value of content.multipleChoice.availableOptions) {\r\n\t\t\t\t\tconst customString: string = sp.getCustomString(value);\r\n\r\n\t\t\t\t\tif (isNOU(customString)) {\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tavailableOptions.push(customString);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdata.multipleChoiceData.availableOptions = availableOptions;\r\n\r\n\t\t\t\tif (isNOU(data.multipleChoiceData.question)\r\n\t\t\t\t\t|| isNOU(data.multipleChoiceData.availableOptions)) {\r\n\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (content.comment) {\r\n\t\t\t\tdata.commentData = new CommentComponent.CommentComponentData();\r\n\t\t\t\tdata.commentData.question = sp.getCustomString(content.comment.question);\r\n\r\n\t\t\t\tif (isNOU(data.commentData.question)) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// cvsurvey data is not required on all surveys.\r\n\t\t\tif (content.cvSurvey) {\r\n\t\t\t\tdata.cvSurveyData = new CVSurveyComponent.CVSurveyComponentData();\r\n\t\t\t\tdata.cvSurveyData.customerVoiceFormId = content.cvSurvey.customerVoiceFormId;\r\n\r\n\t\t\t\tif (isNOU(data.cvSurveyData.customerVoiceFormId)) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tprivate surveyInfo: SurveyDataSource;\r\n\tprivate question: CommentComponent;\r\n\tprivate prompt: PromptComponent;\r\n\tprivate rating: RatingComponent;\r\n\tprivate multipleChoice: MultipleChoiceComponent;\r\n\tprivate cvSurvey: CVSurveyComponent;\r\n\tprivate contentValid: boolean;\r\n\r\n\tprivate constructor(data: FpsSurvey.FpsSurveyData) {\r\n\t\tsuper();\r\n\t\tif (isNOU(data)) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.surveyInfo = new SurveyDataSource(data.baseData);\r\n\t\tthis.contentValid = (!Utils.isNOU(data.promptData?.question) && !Utils.isNOU(data.promptData?.title)) &&\r\n\t\t!Utils.isNOU(data.ratingData?.question) && !Utils.isNOU(data.ratingData?.ratingValuesAscending) &&\r\n\t\t!Utils.isNOU(data.commentData?.question);\r\n\r\n\t\t// Taking in the UxSchema if possible\r\n\t\tif (data.uxSchema) {\r\n\t\t\tthis.setUxSchema(data.uxSchema);\r\n\t\t}\r\n\r\n\t\t// Otherwise, fallback to static content\r\n\t\tif (this.contentValid) {\r\n\t\t\tthis.prompt = new PromptComponent(data.promptData);\r\n\t\t\tthis.question = data.commentData ? (new CommentComponent(data.commentData)) : null;\r\n\t\t\tthis.rating = data.ratingData ? (new RatingComponent(data.ratingData)) : null;\r\n\t\t\tthis.multipleChoice = data.multipleChoiceData ? (new MultipleChoiceComponent(data.multipleChoiceData)) : null;\r\n\t\t\tthis.cvSurvey = data.cvSurveyData ? (new CVSurveyComponent(data.cvSurveyData)) : null;\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyType {\r\n\t\treturn SurveyType.Fps;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSurveyInfo(): ISurveyInfo {\r\n\t\treturn this.surveyInfo;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCommentComponent(): CommentComponent {\r\n\t\treturn this.question;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getPromptComponent(): PromptComponent {\r\n\t\treturn this.prompt;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getRatingComponent(): RatingComponent {\r\n\t\treturn this.rating;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getMultipleChoiceComponent(): MultipleChoiceComponent {\r\n\t\treturn this.multipleChoice;\r\n\t}\r\n\r\n\tpublic getCVSurveyComponent(): CVSurveyComponent {\r\n\t\treturn this.cvSurvey;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.surveyInfo.getTags();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponent(componentType: SurveyComponentType): ISurveyComponent {\r\n\t\tswitch (componentType) {\r\n\t\t\tcase SurveyComponentType.Comment:\r\n\t\t\t\treturn this.getCommentComponent();\r\n\t\t\tcase SurveyComponentType.Prompt:\r\n\t\t\t\treturn this.getPromptComponent();\r\n\t\t\tcase SurveyComponentType.Rating:\r\n\t\t\t\treturn this.getRatingComponent();\r\n\t\t\tcase SurveyComponentType.MultipleChoice:\r\n\t\t\t\treturn this.getMultipleChoiceComponent();\r\n\t\t\tcase SurveyComponentType.CVSurvey:\r\n\t\t\t\treturn this.getCVSurveyComponent();\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (isNOU(doc)) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_FPS_TAGNAME);\r\n\r\n\t\tthis.getSurveyInfo().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (!isNOU(child)) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.getCommentComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (!isNOU(child)) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (this.getRatingComponent()) {\r\n\t\t\tthis.getRatingComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\t\tif (!isNOU(child)) {\r\n\t\t\t\t\telement.appendChild(child);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (this.getMultipleChoiceComponent()) {\r\n\t\t\tthis.getMultipleChoiceComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\t\tif (!isNOU(child)) {\r\n\t\t\t\t\telement.appendChild(child);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tlet result: object = {};\r\n\r\n\t\tresult = Utils.overrideValues(this.getSurveyInfo().getJsonElements(), result);\r\n\t\tresult[JSON_APPLICATION_KEYNAME] = {};\r\n\r\n\t\tresult[JSON_APPLICATION_KEYNAME][JSON_EXTENDEDMANIFESTDATA_KEYNAME] =\r\n\t\t\tJSON.stringify({\r\n\t\t\t\t[JSON_SURVEYSTRINGS_KEYNAME]: this.makeSurveyStrings(),\r\n\t\t\t\t[JSON_SURVEYSPECIFICDATA_KEYNAME]: this.makeResponseString(),\r\n\t\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t// @Override\r\n\tpublic isContentValid(): boolean {\r\n\t\treturn this.contentValid;\r\n\t}\r\n\r\n\t// Makes the string to send to Manifest respecting the components present in the survey\r\n\tprivate makeResponseString(): string {\r\n\t\tconst response: object = {};\r\n\r\n\t\tif (this.question) {\r\n\t\t\tresponse[JSON_COMMENT_KEYNAME] = [this.getCommentComponent().getSubmittedText()];\r\n\t\t}\r\n\r\n\t\tif (this.multipleChoice) {\r\n\t\t\tresponse[JSON_MULTIPLECHOICE_KEYNAME] =\r\n\t\t\t\t[this.getMultipleChoiceComponent().getOptionSelectedStates()];\r\n\t\t}\r\n\r\n\t\tif (this.rating) {\r\n\t\t\tresponse[JSON_RATING_KEYNAME] = [\r\n\t\t\t\t{\r\n\t\t\t\t\tnumberOfOptions: this.getRatingComponent().getRatingValuesAscending().length,\r\n\t\t\t\t\tselectedRating: this.getRatingComponent().getSelectedRatingIndex(),\r\n\t\t\t\t}];\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(response);\r\n\t}\r\n\r\n\t// Makes the string to send to Manifest respecting the components present in the survey\r\n\tprivate makeSurveyStrings(): string {\r\n\t\tconst actualStrings: object = {};\r\n\r\n\t\tif (this.prompt) {\r\n\t\t\tactualStrings[JSON_PROMPT_KEYNAME] = this.prompt.getComponentJson();\r\n\t\t}\r\n\r\n\t\tif (this.rating) {\r\n\t\t\tactualStrings[JSON_RATING_KEYNAME] = [this.rating.getComponentJson()];\r\n\t\t}\r\n\r\n\t\tif (this.question) {\r\n\t\t\tactualStrings[JSON_COMMENT_KEYNAME] = [this.question.getComponentJson()];\r\n\t\t}\r\n\r\n\t\tif (this.multipleChoice) {\r\n\t\t\tactualStrings[JSON_MULTIPLECHOICE_KEYNAME] = [this.multipleChoice.getComponentJson()];\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(actualStrings);\r\n\t}\r\n}\r\nmodule FpsSurvey {\r\n\t/**\r\n\t * Data required for a Fps Survey\r\n\t */\r\n\texport class FpsSurveyData {\r\n\t\tpublic baseData: SurveyDataSource.SurveyDataSourceData;\r\n\t\tpublic commentData: CommentComponent.CommentComponentData;\r\n\t\tpublic promptData: PromptComponent.PromptComponentData;\r\n\t\tpublic ratingData: RatingComponent.RatingComponentData;\r\n\t\tpublic multipleChoiceData: MultipleChoiceComponent.MultipleChoiceComponentData;\r\n\t\tpublic cvSurveyData: CVSurveyComponent.CVSurveyComponentData;\r\n\t\tpublic uxSchema: IUxSchema;\r\n\t}\r\n}\r\n\r\nexport default FpsSurvey;\r\n", "import { ISurvey, ISurveyComponent, ISurveyInfo, SurveyComponentType, SurveyType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Utils from \"../Utils\";\r\nimport { Survey } from \"./Survey\";\r\nimport SurveyDataSource from \"./SurveyDataSource\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nclass GenericMessagingSurfaceSurvey extends Survey {\r\n\tpublic static make(data: GenericMessagingSurfaceSurvey.GenericMessagingSurfaceSurveyData): ISurvey {\r\n\t\ttry {\r\n\t\t\treturn new GenericMessagingSurfaceSurvey(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static makeCustom(baseData: SurveyDataSource.SurveyDataSourceData): ISurvey {\r\n\t\tif (isNOU(baseData)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst data = new GenericMessagingSurfaceSurvey.GenericMessagingSurfaceSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tprivate surveyInfo: SurveyDataSource;\r\n\r\n\tprivate constructor(data: GenericMessagingSurfaceSurvey.GenericMessagingSurfaceSurveyData) {\r\n\t\tsuper();\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.surveyInfo = new SurveyDataSource(data.baseData);\r\n\r\n\t\t// This check cannot be done in survey info constructor\r\n\t\t// as metadata is specific to this survey type.\r\n\t\tif (isNOU(this.surveyInfo.getMetadata())) {\r\n\t\t\tthrow new Error(\"metadata must not be null\");\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyType {\r\n\t\treturn SurveyType.GenericMessagingSurface;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSurveyInfo(): ISurveyInfo {\r\n\t\treturn this.surveyInfo;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.surveyInfo.getTags();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponent(componentType: SurveyComponentType): ISurveyComponent {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\treturn [];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\treturn {};\r\n\t}\r\n}\r\n\r\nmodule GenericMessagingSurfaceSurvey {\r\n\t/**\r\n\t * Data required for a Generic Surface Survey\r\n\t */\r\n\texport class GenericMessagingSurfaceSurveyData {\r\n\t\tpublic baseData: SurveyDataSource.SurveyDataSourceData;\r\n\t}\r\n}\r\n\r\nexport default GenericMessagingSurfaceSurvey;\r\n", "import {\r\n\tDOM_INTERCEPT_TAGNAME,\r\n\tIInterceptComponent,\r\n\tJSON_INTERCEPT_KEYNAME,\r\n\tJSON_INTERCEPTURL_KEYNAME,\r\n\tJSON_QUESTION_KEYNAME,\r\n\tJSON_TITLE_KEYNAME,\r\n\tSurveyComponentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nclass InterceptComponent implements IInterceptComponent {\r\n\tpublic static make(data: InterceptComponent.InterceptComponentData): IInterceptComponent {\r\n\t\ttry {\r\n\t\t\treturn new InterceptComponent(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate data: InterceptComponent.InterceptComponentData;\r\n\r\n\tpublic constructor(data: InterceptComponent.InterceptComponentData) {\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\t\tif (!data.question) {\r\n\t\t\tthrow new Error(\"data.question must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.title) {\r\n\t\t\tthrow new Error(\"data.title must not be null or empty\");\r\n\t\t}\r\n\t\tif (!data.url) {\r\n\t\t\tthrow new Error(\"data.url must not be null or empty\");\r\n\t\t}\r\n\r\n\t\tthis.data = data;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyComponentType {\r\n\t\treturn SurveyComponentType.Intercept;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTitle(): string {\r\n\t\treturn this.data.title;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getQuestion(): string {\r\n\t\treturn this.data.question;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getUrl(): string {\r\n\t\treturn this.data.url;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\t\treturn [doc.createElement(DOM_INTERCEPT_TAGNAME)];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\treturn { [JSON_INTERCEPT_KEYNAME]: \"\" };\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponentJson(): object {\r\n\t\treturn {\r\n\t\t\t[JSON_TITLE_KEYNAME]: this.getTitle(),\r\n\t\t\t[JSON_QUESTION_KEYNAME]: this.getQuestion(),\r\n\t\t\t[JSON_INTERCEPTURL_KEYNAME]: this.getUrl(),\r\n\t\t};\r\n\t}\r\n}\r\n\r\nmodule InterceptComponent {\r\n\texport class InterceptComponentData {\r\n\t\tpublic question: string;\r\n\t\tpublic title: string;\r\n\t\tpublic url: string;\r\n\t}\r\n}\r\n\r\nexport default InterceptComponent;\r\n", "import { IFloodgateStringProvider, IInterceptSurvey, ISurveyComponent, ISurveyInfo, SurveyComponentType, SurveyType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { CampaignSurveyContent, CampaignSurveyTemplate } from \"../Campaign/CampaignDefinitionProvider\";\r\nimport InterceptComponent from \"../SurveyComponents/InterceptComponent\";\r\nimport * as Utils from \"../Utils\";\r\nimport { Survey } from \"./Survey\";\r\nimport SurveyDataSource from \"./SurveyDataSource\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nclass InterceptSurvey extends Survey implements IInterceptSurvey {\r\n\tpublic static make(data: InterceptSurvey.InterceptSurveyData): IInterceptSurvey {\r\n\t\ttry {\r\n\t\t\treturn new InterceptSurvey(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static makeIntercept(baseData: SurveyDataSource.SurveyDataSourceData, sp: IFloodgateStringProvider,\r\n\t\tsurveyModel: CampaignSurveyTemplate): IInterceptSurvey {\r\n\r\n\t\tif (isNOU(baseData) || isNOU(sp) || isNOU(surveyModel)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst content: CampaignSurveyContent = surveyModel.content;\r\n\r\n\t\t// Intercept component is required.\r\n\t\tif (isNOU(content) || isNOU(content.intercept)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst data = new InterceptSurvey.InterceptSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\r\n\t\tdata.interceptData = new InterceptComponent.InterceptComponentData();\r\n\r\n\t\tdata.interceptData.title = sp.getCustomString(content.intercept.title);\r\n\t\tdata.interceptData.question = sp.getCustomString(content.intercept.question);\r\n\t\tdata.interceptData.url = sp.getCustomString(content.intercept.url);\r\n\r\n\t\tif (isNOU(data.interceptData.title)\r\n\t\t\t|| isNOU(data.interceptData.question)\r\n\t\t\t|| isNOU(data.interceptData.url)) {\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tprivate surveyInfo: SurveyDataSource;\r\n\tprivate intercept: InterceptComponent;\r\n\r\n\tprivate constructor(data: InterceptSurvey.InterceptSurveyData) {\r\n\t\tsuper();\r\n\t\tif (isNOU(data)) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.surveyInfo = new SurveyDataSource(data.baseData);\r\n\t\tthis.intercept = new InterceptComponent(data.interceptData);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyType {\r\n\t\treturn SurveyType.Intercept;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSurveyInfo(): ISurveyInfo {\r\n\t\treturn this.surveyInfo;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getInterceptComponent(): InterceptComponent {\r\n\t\treturn this.intercept;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.surveyInfo.getTags();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponent(componentType: SurveyComponentType): ISurveyComponent {\r\n\t\treturn (componentType === SurveyComponentType.Intercept) ? this.getInterceptComponent() : null;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\treturn [];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\treturn {};\r\n\t}\r\n}\r\nmodule InterceptSurvey {\r\n\t/**\r\n\t * Data required for an Intercept Survey\r\n\t */\r\n\texport class InterceptSurveyData {\r\n\t\tpublic baseData: SurveyDataSource.SurveyDataSourceData;\r\n\t\tpublic interceptData: InterceptComponent.InterceptComponentData;\r\n\t}\r\n}\r\n\r\nexport default InterceptSurvey;\r\n", "import {\r\n\tDOM_NLQS_TAGNAME,\r\n\tIFloodgateStringProvider,\r\n\tINlqsSurvey,\r\n\tISurveyComponent,\r\n\tISurveyInfo,\r\n\tSurveyComponentType,\r\n\tSurveyType\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { CampaignSurveyContent, CampaignSurveyTemplate } from \"../Campaign/CampaignDefinitionProvider\";\r\nimport CommentComponent from \"../SurveyComponents/CommentComponent\";\r\nimport PromptComponent from \"../SurveyComponents/PromptComponent\";\r\nimport RatingComponent from \"../SurveyComponents/RatingComponent\";\r\nimport * as Utils from \"../Utils\";\r\nimport { Survey } from \"./Survey\";\r\nimport SurveyDataSource from \"./SurveyDataSource\";\r\n\r\nconst { isNOU, overrideValues } = Utils;\r\n\r\nclass NlqsSurvey extends Survey implements INlqsSurvey {\r\n\tpublic static make(data: NlqsSurvey.NlqsSurveyData): INlqsSurvey {\r\n\t\ttry {\r\n\t\t\treturn new NlqsSurvey(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static makeNlqs(baseData: SurveyDataSource.SurveyDataSourceData, sp: IFloodgateStringProvider,\r\n\t\tsurveyModel: CampaignSurveyTemplate): INlqsSurvey {\r\n\r\n\t\tif (isNOU(baseData) || isNOU(sp) || isNOU(surveyModel)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst ratingValuesAscending: string[] = [];\r\n\t\tconst content: CampaignSurveyContent = surveyModel.content;\r\n\r\n\t\tif (isNOU(content) || isNOU(content.comment)\r\n\t\t\t|| isNOU(content.prompt) || isNOU(content.rating)) {\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst data = new NlqsSurvey.NlqsSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\t\tdata.promptData = new PromptComponent.PromptComponentData();\r\n\t\tdata.ratingData = new RatingComponent.RatingComponentData();\r\n\t\tdata.commentData = new CommentComponent.CommentComponentData();\r\n\r\n\t\tdata.promptData.title = sp.getCustomString(content.prompt.title);\r\n\t\tdata.promptData.question = sp.getCustomString(content.prompt.question);\r\n\t\tdata.promptData.yesButtonLabel = sp.getCustomString(content.prompt.yesLabel);\r\n\t\tdata.promptData.noButtonLabel = sp.getCustomString(content.prompt.noLabel);\r\n\t\tdata.ratingData.question = sp.getCustomString(content.rating.question);\r\n\t\tdata.ratingData.isZeroBased = content.rating.isZeroBased;\r\n\t\tdata.commentData.question = sp.getCustomString(content.comment.question);\r\n\r\n\t\tfor (const value of content.rating.ratingValuesAscending) {\r\n\t\t\tconst customString: string = sp.getCustomString(value);\r\n\r\n\t\t\tif (isNOU(customString)) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tratingValuesAscending.push(customString);\r\n\t\t}\r\n\r\n\t\tdata.ratingData.ratingValuesAscending = ratingValuesAscending;\r\n\r\n\t\tif (isNOU(data.ratingData.question)\r\n\t\t\t|| isNOU(data.commentData.question)\r\n\t\t\t|| isNOU(data.promptData.title)\r\n\t\t\t|| isNOU(data.promptData.question)\r\n\t\t\t|| isNOU(data.promptData.yesButtonLabel)\r\n\t\t\t|| isNOU(data.promptData.noButtonLabel)\r\n\t\t\t|| isNOU(data.ratingData.ratingValuesAscending)) {\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tprivate surveyInfo: SurveyDataSource;\r\n\tprivate question: CommentComponent;\r\n\tprivate prompt: PromptComponent;\r\n\tprivate rating: RatingComponent;\r\n\r\n\tprivate constructor(data: NlqsSurvey.NlqsSurveyData) {\r\n\t\tsuper();\r\n\t\tif (isNOU(data)) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.surveyInfo = new SurveyDataSource(data.baseData);\r\n\t\tthis.prompt = new PromptComponent(data.promptData);\r\n\t\tthis.question = new CommentComponent(data.commentData);\r\n\t\tthis.rating = new RatingComponent(data.ratingData);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyType {\r\n\t\treturn SurveyType.Nlqs;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSurveyInfo(): ISurveyInfo {\r\n\t\treturn this.surveyInfo;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCommentComponent(): CommentComponent {\r\n\t\treturn this.question;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getPromptComponent(): PromptComponent {\r\n\t\treturn this.prompt;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getRatingComponent(): RatingComponent {\r\n\t\treturn this.rating;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.surveyInfo.getTags();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponent(componentType: SurveyComponentType): ISurveyComponent {\r\n\t\tswitch (componentType) {\r\n\t\t\tcase SurveyComponentType.Comment:\r\n\t\t\t\treturn this.getCommentComponent();\r\n\t\t\tcase SurveyComponentType.Prompt:\r\n\t\t\t\treturn this.getPromptComponent();\r\n\t\t\tcase SurveyComponentType.Rating:\r\n\t\t\t\treturn this.getRatingComponent();\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (isNOU(doc)) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_NLQS_TAGNAME);\r\n\r\n\t\tthis.getSurveyInfo().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (!isNOU(child)) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.getCommentComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (!isNOU(child)) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.getRatingComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (!isNOU(child)) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tlet result: object = {};\r\n\r\n\t\tresult = overrideValues(this.getSurveyInfo().getJsonElements(), result);\r\n\t\tresult = overrideValues(this.getCommentComponent().getJsonElements(), result);\r\n\t\tresult = overrideValues(this.getRatingComponent().getJsonElements(), result);\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nmodule NlqsSurvey {\r\n\t/**\r\n\t * Data required for a Nlqs Survey\r\n\t */\r\n\texport class NlqsSurveyData {\r\n\t\tpublic baseData: SurveyDataSource.SurveyDataSourceData;\r\n\t\tpublic commentData: CommentComponent.CommentComponentData;\r\n\t\tpublic promptData: PromptComponent.PromptComponentData;\r\n\t\tpublic ratingData: RatingComponent.RatingComponentData;\r\n\t}\r\n}\r\n\r\nexport default NlqsSurvey;\r\n", "import {\r\n\tDOM_NPS_TAGNAME,\r\n\tFloodgateStringProviderStringType,\r\n\tIFloodgateStringProvider,\r\n\tINpsSurvey,\r\n\tISurveyComponent,\r\n\tISurveyInfo,\r\n\tIUxSchema,\r\n\tJSON_APPLICATION_KEYNAME,\r\n\tJSON_COMMENT_KEYNAME,\r\n\tJSON_EXTENDEDMANIFESTDATA_KEYNAME,\r\n\tJSON_PROMPT_KEYNAME,\r\n\tJSON_RATING_KEYNAME,\r\n\tJSON_SURVEYSTRINGS_KEYNAME,\r\n\tSurveyComponentType,\r\n\tSurveyType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { CampaignSurveyContent, CampaignSurveyTemplate } from \"../Campaign/CampaignDefinitionProvider\";\r\nimport CommentComponent from \"../SurveyComponents/CommentComponent\";\r\nimport CVSurveyComponent from \"../SurveyComponents/CVSurveyComponent\";\r\nimport PromptComponent from \"../SurveyComponents/PromptComponent\";\r\nimport RatingComponent from \"../SurveyComponents/RatingComponent\";\r\nimport * as Utils from \"../Utils\";\r\nimport { Survey } from \"./Survey\";\r\nimport SurveyDataSource from \"./SurveyDataSource\";\r\n\r\nconst { isNOU, overrideValues } = Utils;\r\n\r\nclass NpsSurvey extends Survey implements INpsSurvey {\r\n\tpublic static make(data: NpsSurvey.NpsSurveyData): INpsSurvey {\r\n\t\ttry {\r\n\t\t\treturn new NpsSurvey(data);\r\n\t\t} catch (e) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static makeCustom(baseData: SurveyDataSource.SurveyDataSourceData, sp: IFloodgateStringProvider,\r\n\t\tsurveyModel: CampaignSurveyTemplate): INpsSurvey {\r\n\r\n\t\tif (isNOU(baseData) || isNOU(sp) || isNOU(surveyModel)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst ratingValuesAscending: string[] = [];\r\n\t\tconst content: CampaignSurveyContent = surveyModel.content;\r\n\t\tlet contentValid = true;\r\n\r\n\t\t// Either UxSchema or Prompt/Content must be in the survey\r\n\t\tif (isNOU(content) || isNOU(content.comment)\r\n\t\t\t|| isNOU(content.prompt) || isNOU(content.rating)) {\r\n\t\t\tcontentValid = false;\r\n\t\t\tif (!surveyModel.uxSchema) {\r\n\t\t\t\treturn null\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst data = new NpsSurvey.NpsSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\t\tdata.uxSchema = surveyModel.uxSchema;\r\n\r\n\t\tif (contentValid) {\r\n\t\t\tdata.promptData = new PromptComponent.PromptComponentData();\r\n\t\t\tdata.ratingData = new RatingComponent.RatingComponentData();\r\n\t\t\tdata.commentData = new CommentComponent.CommentComponentData();\r\n\r\n\t\t\tdata.promptData.title = sp.getCustomString(content.prompt.title);\r\n\t\t\tdata.promptData.question = sp.getCustomString(content.prompt.question);\r\n\t\t\tdata.promptData.yesButtonLabel = sp.getCustomString(content.prompt.yesLabel);\r\n\t\t\tdata.promptData.noButtonLabel = sp.getCustomString(content.prompt.noLabel);\r\n\t\t\tdata.ratingData.question = sp.getCustomString(content.rating.question);\r\n\t\t\tdata.ratingData.isZeroBased = content.rating.isZeroBased;\r\n\t\t\tdata.commentData.question = sp.getCustomString(content.comment.question);\r\n\r\n\t\t\tfor (const value of content.rating.ratingValuesAscending) {\r\n\t\t\t\tconst customString: string = sp.getCustomString(value);\r\n\r\n\t\t\t\tif (isNOU(customString)) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tratingValuesAscending.push(customString);\r\n\t\t\t}\r\n\r\n\t\t\tdata.ratingData.ratingValuesAscending = ratingValuesAscending;\r\n\r\n\t\t\tif (isNOU(data.ratingData.question)\r\n\t\t\t\t|| isNOU(data.commentData.question)\r\n\t\t\t\t|| isNOU(data.promptData.title)\r\n\t\t\t\t|| isNOU(data.promptData.question)\r\n\t\t\t\t|| isNOU(data.promptData.yesButtonLabel)\r\n\t\t\t\t|| isNOU(data.promptData.noButtonLabel)\r\n\t\t\t\t|| isNOU(data.ratingData.ratingValuesAscending)) {\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\t// cvsurvey data is not required on all surveys.\r\n\t\t\tif (content.cvSurvey) {\r\n\t\t\t\tdata.cvSurveyData = new CVSurveyComponent.CVSurveyComponentData();\r\n\t\t\t\tdata.cvSurveyData.customerVoiceFormId = content.cvSurvey.customerVoiceFormId;\r\n\r\n\t\t\t\tif (isNOU(data.cvSurveyData.customerVoiceFormId)) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tpublic static make5Point(baseData: SurveyDataSource.SurveyDataSourceData, sp: IFloodgateStringProvider): INpsSurvey {\r\n\t\tif (!baseData || !sp) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst data = new NpsSurvey.NpsSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\t\tdata.ratingData = new RatingComponent.RatingComponentData();\r\n\t\tdata.ratingData.isZeroBased = false;\r\n\t\tdata.commentData = new CommentComponent.CommentComponentData();\r\n\t\tdata.promptData = new PromptComponent.PromptComponentData();\r\n\t\tdata.ratingData.question = sp.loadStringResource(FloodgateStringProviderStringType.NpsRatingQuestion);\r\n\t\tdata.commentData.question = sp.loadStringResource(FloodgateStringProviderStringType.NpsCommentQuestion);\r\n\t\tdata.promptData.title = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptTitle);\r\n\t\tdata.promptData.question = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptQuestion);\r\n\t\tdata.promptData.yesButtonLabel = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptYesLabel);\r\n\t\tdata.promptData.noButtonLabel = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptNotNowLabel);\r\n\t\tconst ratingValuesAscending: string[] = new Array(5);\r\n\t\tratingValuesAscending[0] = sp.loadStringResource(FloodgateStringProviderStringType.Nps5RatingValue1);\r\n\t\tratingValuesAscending[1] = sp.loadStringResource(FloodgateStringProviderStringType.Nps5RatingValue2);\r\n\t\tratingValuesAscending[2] = sp.loadStringResource(FloodgateStringProviderStringType.Nps5RatingValue3);\r\n\t\tratingValuesAscending[3] = sp.loadStringResource(FloodgateStringProviderStringType.Nps5RatingValue4);\r\n\t\tratingValuesAscending[4] = sp.loadStringResource(FloodgateStringProviderStringType.Nps5RatingValue5);\r\n\r\n\t\tif (!data.ratingData.question\r\n\t\t\t|| !data.commentData.question\r\n\t\t\t|| !data.promptData.title\r\n\t\t\t|| !data.promptData.question\r\n\t\t\t|| !data.promptData.yesButtonLabel\r\n\t\t\t|| !data.promptData.noButtonLabel\r\n\t\t\t|| !ratingValuesAscending[0]\r\n\t\t\t|| !ratingValuesAscending[1]\r\n\t\t\t|| !ratingValuesAscending[2]\r\n\t\t\t|| !ratingValuesAscending[3]\r\n\t\t\t|| !ratingValuesAscending[4]) {\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tdata.ratingData.ratingValuesAscending = ratingValuesAscending;\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tpublic static make11Point(baseData: SurveyDataSource.SurveyDataSourceData, sp: IFloodgateStringProvider): INpsSurvey {\r\n\t\tif (!baseData || !sp) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst data = new NpsSurvey.NpsSurveyData();\r\n\t\tdata.baseData = baseData;\r\n\t\tdata.ratingData = new RatingComponent.RatingComponentData();\r\n\t\tdata.ratingData.isZeroBased = true;\r\n\t\tdata.commentData = new CommentComponent.CommentComponentData();\r\n\t\tdata.promptData = new PromptComponent.PromptComponentData();\r\n\t\tdata.ratingData.question = sp.loadStringResource(FloodgateStringProviderStringType.NpsRatingQuestion);\r\n\t\tdata.commentData.question = sp.loadStringResource(FloodgateStringProviderStringType.NpsCommentQuestion);\r\n\t\tdata.promptData.title = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptTitle);\r\n\t\tdata.promptData.question = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptQuestion);\r\n\t\tdata.promptData.yesButtonLabel = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptYesLabel);\r\n\t\tdata.promptData.noButtonLabel = sp.loadStringResource(FloodgateStringProviderStringType.NpsPromptNotNowLabel);\r\n\r\n\t\tconst ratingValuesAscending: string[] = new Array(11);\r\n\t\tratingValuesAscending[0] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue0);\r\n\t\tratingValuesAscending[1] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue1);\r\n\t\tratingValuesAscending[2] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue2);\r\n\t\tratingValuesAscending[3] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue3);\r\n\t\tratingValuesAscending[4] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue4);\r\n\t\tratingValuesAscending[5] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue5);\r\n\t\tratingValuesAscending[6] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue6);\r\n\t\tratingValuesAscending[7] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue7);\r\n\t\tratingValuesAscending[8] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue8);\r\n\t\tratingValuesAscending[9] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue9);\r\n\t\tratingValuesAscending[10] = sp.loadStringResource(FloodgateStringProviderStringType.Nps11RatingValue10);\r\n\r\n\t\tif (!data.ratingData.question\r\n\t\t\t|| !data.commentData.question\r\n\t\t\t|| !data.promptData.title\r\n\t\t\t|| !data.promptData.question\r\n\t\t\t|| !data.promptData.yesButtonLabel\r\n\t\t\t|| !data.promptData.noButtonLabel\r\n\t\t\t|| !ratingValuesAscending[0]\r\n\t\t\t|| !ratingValuesAscending[1]\r\n\t\t\t|| !ratingValuesAscending[2]\r\n\t\t\t|| !ratingValuesAscending[3]\r\n\t\t\t|| !ratingValuesAscending[4]\r\n\t\t\t|| !ratingValuesAscending[5]\r\n\t\t\t|| !ratingValuesAscending[6]\r\n\t\t\t|| !ratingValuesAscending[7]\r\n\t\t\t|| !ratingValuesAscending[8]\r\n\t\t\t|| !ratingValuesAscending[9]\r\n\t\t\t|| !ratingValuesAscending[10]) {\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tdata.ratingData.ratingValuesAscending = ratingValuesAscending;\r\n\t\treturn this.make(data);\r\n\t}\r\n\r\n\tprivate surveyInfo: SurveyDataSource;\r\n\tprivate question: CommentComponent;\r\n\tprivate prompt: PromptComponent;\r\n\tprivate rating: RatingComponent;\r\n\tprivate cvSurvey: CVSurveyComponent;\r\n\tprivate contentValid: boolean;\r\n\r\n\tprivate constructor(data: NpsSurvey.NpsSurveyData) {\r\n\t\tsuper();\r\n\t\tif (!data) {\r\n\t\t\tthrow new Error(\"data must not be null\");\r\n\t\t}\r\n\r\n\t\tif (data.uxSchema) {\r\n\t\t\tthis.setUxSchema(data.uxSchema);\r\n\t\t}\r\n\r\n\t\tthis.contentValid = (!Utils.isNOU(data.promptData?.question) && !Utils.isNOU(data.promptData?.title)) &&\r\n\t\t!Utils.isNOU(data.ratingData?.question) && !Utils.isNOU(data.ratingData?.ratingValuesAscending) &&\r\n\t\t!Utils.isNOU(data.commentData?.question);\r\n\r\n\t\tthis.surveyInfo = new SurveyDataSource(data.baseData);\r\n\t\tif (this.contentValid) {\r\n\t\t\tthis.prompt = new PromptComponent(data.promptData);\r\n\t\t\tthis.question = new CommentComponent(data.commentData);\r\n\t\t\tthis.rating = new RatingComponent(data.ratingData);\r\n\t\t\tthis.cvSurvey = data.cvSurveyData ? (new CVSurveyComponent(data.cvSurveyData)) : null;\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): SurveyType {\r\n\t\treturn SurveyType.Nps;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getSurveyInfo(): ISurveyInfo {\r\n\t\treturn this.surveyInfo;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCommentComponent(): CommentComponent {\r\n\t\treturn this.question;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getPromptComponent(): PromptComponent {\r\n\t\treturn this.prompt;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getRatingComponent(): RatingComponent {\r\n\t\treturn this.rating;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCVSurveyComponent(): CVSurveyComponent {\r\n\t\treturn this.cvSurvey;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getTags(): string[] {\r\n\t\treturn this.surveyInfo.getTags();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getComponent(componentType: SurveyComponentType): ISurveyComponent {\r\n\t\tswitch (componentType) {\r\n\t\t\tcase SurveyComponentType.Comment:\r\n\t\t\t\treturn this.getCommentComponent();\r\n\t\t\tcase SurveyComponentType.Prompt:\r\n\t\t\t\treturn this.getPromptComponent();\r\n\t\t\tcase SurveyComponentType.Rating:\r\n\t\t\t\treturn this.getRatingComponent();\r\n\t\t\tcase SurveyComponentType.CVSurvey:\r\n\t\t\t\treturn this.getCVSurveyComponent();\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getDomElements(doc: Document): Element[] {\r\n\t\tif (!doc) {\r\n\t\t\tthrow new Error(\"Document must not be null\");\r\n\t\t}\r\n\r\n\t\tconst element: Element = doc.createElement(DOM_NPS_TAGNAME);\r\n\r\n\t\tthis.getSurveyInfo().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (child) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.getCommentComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (child) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.getRatingComponent().getDomElements(doc).forEach((child) => {\r\n\t\t\tif (child) {\r\n\t\t\t\telement.appendChild(child);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn [element];\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getJsonElements(): object {\r\n\t\tlet result: object = {};\r\n\r\n\t\tresult = overrideValues(this.getSurveyInfo().getJsonElements(), result);\r\n\t\tresult = overrideValues(this.getCommentComponent().getJsonElements(), result);\r\n\t\tresult = overrideValues(this.getRatingComponent().getJsonElements(), result);\r\n\r\n\t\tresult[JSON_APPLICATION_KEYNAME] = {};\r\n\t\tresult[JSON_APPLICATION_KEYNAME][JSON_EXTENDEDMANIFESTDATA_KEYNAME] =\r\n\t\t\tJSON.stringify({ [JSON_SURVEYSTRINGS_KEYNAME]: this.makeSurveyStrings() });\r\n\r\n\t\treturn result;\r\n\t}\r\n\t\r\n\t// @Override\r\n\tpublic isContentValid(): boolean {\r\n\t\treturn this.contentValid;\r\n\t}\r\n\r\n\t// Makes the string to send to Manifest respecting the components present in the survey\r\n\tprivate makeSurveyStrings(): string {\r\n\t\tconst actualStrings: object = {};\r\n\r\n\t\tif (this.prompt) {\r\n\t\t\tactualStrings[JSON_PROMPT_KEYNAME] = this.prompt.getComponentJson();\r\n\t\t}\r\n\r\n\t\tif (this.rating) {\r\n\t\t\tactualStrings[JSON_RATING_KEYNAME] = [this.rating.getComponentJson()];\r\n\t\t}\r\n\r\n\t\tif (this.question) {\r\n\t\t\tactualStrings[JSON_COMMENT_KEYNAME] = [this.question.getComponentJson()];\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(actualStrings);\r\n\t}\r\n}\r\n\r\nmodule NpsSurvey {\r\n\t/**\r\n\t * Data required for a Nps Survey\r\n\t */\r\n\texport class NpsSurveyData {\r\n\t\tpublic baseData: SurveyDataSource.SurveyDataSourceData;\r\n\t\tpublic commentData: CommentComponent.CommentComponentData;\r\n\t\tpublic promptData: PromptComponent.PromptComponentData;\r\n\t\tpublic ratingData: RatingComponent.RatingComponentData;\r\n\t\tpublic cvSurveyData: CVSurveyComponent.CVSurveyComponentData;\r\n\t\tpublic uxSchema: IUxSchema;\r\n\t}\r\n}\r\n\r\nexport default NpsSurvey;\r\n", "import {\r\n\tICampaignDefinition,\r\n\tICampaignState,\r\n\tICountedActivityEvent,\r\n\tICountedActivitySequenceEvent,\r\n\tIFloodgateStringProvider,\r\n\tISurvey,\r\n\tISurveyEvent,\r\n\tISurveyMetadata,\r\n\tLAUNCHER_TYPE_DEFAULT as SURVEY_LAUNCHER_TYPE_DEFAULT,\r\n\tSurveyInfoLaunchType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport {\r\n\tCountedActivityEvent,\r\n\tCountedActivityEventData,\r\n\tCountedActivitySequenceEvent,\r\n\tCountedActivitySequenceEventData,\r\n} from \"../SurveyEvents\";\r\nimport { Metadata, SurveyMetadata } from \"../SurveyMetadata\";\r\nimport DialogSurvey from \"../Surveys/DialogSurvey\";\r\nimport FpsSurvey from \"../Surveys/FpsSurvey\";\r\nimport GenericMessagingSurfaceSurvey from \"../Surveys/GenericMessagingSurfaceSurvey\";\r\nimport InterceptSurvey from \"../Surveys/InterceptSurvey\";\r\nimport NlqsSurvey from \"../Surveys/NlqsSurvey\";\r\nimport NpsSurvey from \"../Surveys/NpsSurvey\";\r\nimport SurveyDataSource from \"../Surveys/SurveyDataSource\";\r\nimport * as Utils from \"../Utils\";\r\nimport {\r\n\tCampaignSurveyEvent,\r\n\tCampaignSurveyEventCountedActivity,\r\n\tCampaignSurveyEventCountedActivitySequence,\r\n\tCampaignSurveyMetadata,\r\n\tCampaignSurveyTemplateDialog,\r\n\tCampaignSurveyTemplateFps,\r\n\tCampaignSurveyTemplateGenericMessagingSurface,\r\n\tCampaignSurveyTemplateIntercept,\r\n\tCampaignSurveyTemplateNlqs,\r\n\tCampaignSurveyTemplateNps,\r\n\tCampaignSurveyTemplateNps11PointStatic,\r\n\tCampaignSurveyTemplateNps5PointStatic,\r\n} from \"./CampaignDefinitionProvider\";\r\n\r\nconst { dateToShortUtcString, isNOU } = Utils;\r\n\r\n/**\r\n * Contains methods to take a campaign definition + state and generate an ISurvey\r\n */\r\nexport class CampaignSurveyFactory {\r\n\tpublic static makeSurvey(state: ICampaignState, definition: ICampaignDefinition, stringProvider: IFloodgateStringProvider): ISurvey {\r\n\t\tif (!state || !definition || !definition.surveyTemplate || !stringProvider) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst surveyDataSource = CampaignSurveyFactory.makeSurveyDataSourceData(state, definition);\r\n\t\tconst surveyModel = definition.surveyTemplate;\r\n\t\tif (surveyModel instanceof CampaignSurveyTemplateNps5PointStatic) {\r\n\t\t\treturn NpsSurvey.make5Point(surveyDataSource, stringProvider);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateNps11PointStatic) {\r\n\t\t\treturn NpsSurvey.make11Point(surveyDataSource, stringProvider);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateFps) {\r\n\t\t\treturn FpsSurvey.makeFps(surveyDataSource, stringProvider, surveyModel);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateNlqs) {\r\n\t\t\treturn NlqsSurvey.makeNlqs(surveyDataSource, stringProvider, surveyModel);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateNps) {\r\n\t\t\treturn NpsSurvey.makeCustom(surveyDataSource, stringProvider, surveyModel);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateGenericMessagingSurface) {\r\n\t\t\treturn GenericMessagingSurfaceSurvey.makeCustom(surveyDataSource);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateIntercept) {\r\n\t\t\treturn InterceptSurvey.makeIntercept(surveyDataSource, stringProvider, surveyModel);\r\n\t\t} else if (surveyModel instanceof CampaignSurveyTemplateDialog){\r\n\t\t\treturn DialogSurvey.makeCustom(surveyDataSource);\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static makeSurveyDataSourceData(state: ICampaignState, definition: ICampaignDefinition): SurveyDataSource.SurveyDataSourceData {\r\n\t\tif (!state || !definition || !definition.surveyTemplate) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst surveyModel = definition.surveyTemplate;\r\n\t\tconst surveyData = new SurveyDataSource.SurveyDataSourceData();\r\n\t\tsurveyData.activationEvent = CampaignSurveyFactory.makeEvent(state, surveyModel.activationEvent as CampaignSurveyEvent);\r\n\t\tsurveyData.metadata = CampaignSurveyFactory.makeMetadata(surveyModel.metadata);\r\n\t\tsurveyData.id = state.LastSurveyId;\r\n\t\tsurveyData.backEndIdentifier = state.CampaignId;\r\n\t\tsurveyData.expirationTimeUtc = dateToShortUtcString(state.LastSurveyExpirationTimeUtc);\r\n\t\tsurveyData.governedChannelType = definition.governedChannelType;\r\n\t\tsurveyData.startTimeUtc = dateToShortUtcString(state.LastSurveyStartTimeUtc);\r\n\t\tsurveyData.additionalDataRequested = definition.additionalDataRequested || [];\r\n\t\tsurveyData.launcherType = definition.launcherType || SURVEY_LAUNCHER_TYPE_DEFAULT;\r\n\t\tsurveyData.preferredLaunchType = definition.surveyTemplate.preferredLaunchType || SurveyInfoLaunchType.Default;\r\n\t\tsurveyData.businessLevel = definition.businessLevel;\r\n\t\tsurveyData.tags = definition.tags;\r\n\t\tsurveyData.treatmentType = definition.treatmentType;\r\n\r\n\t\tif (!isNOU(surveyModel.maxLaunches)) {\r\n\t\t\tsurveyData.maxLaunches = surveyModel.maxLaunches;\r\n\t\t}\r\n\r\n\t\tif (!isNOU(surveyModel.maxLaunchesPerSession)) {\r\n\t\t\tsurveyData.maxLaunchesPerSession = surveyModel.maxLaunchesPerSession;\r\n\t\t}\r\n\r\n\t\treturn surveyData;\r\n\t}\r\n\r\n\tprivate static makeCountedActivityEventData(eventModel: CampaignSurveyEventCountedActivity): CountedActivityEventData {\r\n\t\tif (!eventModel) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst eventData = new CountedActivityEventData();\r\n\t\teventData.activity = eventModel.activity;\r\n\t\teventData.count = eventModel.count;\r\n\t\teventData.isAggregate = eventModel.isAggregate;\r\n\r\n\t\treturn eventData;\r\n\t}\r\n\r\n\tprivate static makeCountedActivityEvent(state: ICampaignState, eventModel: CampaignSurveyEventCountedActivity): ICountedActivityEvent {\r\n\t\tif (!state || !eventModel) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst eventData: CountedActivityEventData = CampaignSurveyFactory.makeCountedActivityEventData(eventModel);\r\n\t\tif (!eventData) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn new CountedActivityEvent(eventData);\r\n\t}\r\n\r\n\tprivate static makeCountedActivitySequenceEvent(state: ICampaignState,\r\n\t\teventModel: CampaignSurveyEventCountedActivitySequence): ICountedActivitySequenceEvent {\r\n\r\n\t\tif (!state || !eventModel) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst sequenceEventData = new CountedActivitySequenceEventData();\r\n\t\tsequenceEventData.sequence = [];\r\n\r\n\t\tfor (const event of eventModel.sequence) {\r\n\t\t\tconst eventData: CountedActivityEventData = CampaignSurveyFactory.makeCountedActivityEventData(event);\r\n\t\t\tif (!eventData) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tsequenceEventData.sequence.push(eventData);\r\n\t\t}\r\n\r\n\t\treturn new CountedActivitySequenceEvent(sequenceEventData);\r\n\t}\r\n\r\n\tprivate static makeEvent(state: ICampaignState, eventModel: CampaignSurveyEvent): ISurveyEvent {\r\n\t\tif (eventModel instanceof CampaignSurveyEventCountedActivity) {\r\n\t\t\treturn CampaignSurveyFactory.makeCountedActivityEvent(state, eventModel as CampaignSurveyEventCountedActivity);\r\n\t\t} else if (eventModel instanceof CampaignSurveyEventCountedActivitySequence) {\r\n\t\t\treturn CampaignSurveyFactory.makeCountedActivitySequenceEvent(state, eventModel as CampaignSurveyEventCountedActivitySequence);\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static makeMetadata(metadataModel: CampaignSurveyMetadata): ISurveyMetadata {\r\n\t\tif (isNOU(metadataModel) || isNOU(metadataModel.contentMetadata)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst metadata = new Metadata();\r\n\t\tmetadata.contentMetadata = metadataModel.contentMetadata;\r\n\r\n\t\treturn new SurveyMetadata(metadata);\r\n\t}\r\n}\r\n", "import { IFloodgateFeatureStatusCallback } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nlet featureGateProvider: IFloodgateFeatureStatusCallback;\r\n\r\nexport function setFeatureGateProvider(provider: IFloodgateFeatureStatusCallback) {\r\n\tfeatureGateProvider = provider;\r\n}\r\n\r\nexport function getFeatureGateProvider() {\r\n\treturn featureGateProvider;\r\n}", "import * as Utils from \"../Utils\";\r\n\r\nimport {\r\n\tSurveyInfoBusinessLevel as BusinessLevel,\r\n\tGovernedChannelType,\r\n\tICampaignDefinition,\r\n\tICampaignDefinitionProvider,\r\n\tICampaignDuration,\r\n\tICampaignManager,\r\n\tICampaignState,\r\n\tICampaignStateProvider,\r\n\tIDictionary,\r\n\tIFloodgateEnvironmentProvider,\r\n\tIFloodgateStringProvider,\r\n\tILogExperimentTrigger,\r\n\tISurvey,\r\n\tISurveyCandidacyChecker,\r\n\tISurveyClient,\r\n\tISurveyInfo,\r\n\tTreatmentType,\r\n\tITriggerEventDetails,\r\n\tIEventInfo,\r\n\tICampaignTelemetrySamplingConfig\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport {\r\n\tCampaignDurationSingleBuildChange,\r\n\tCampaignDurationTimeInterval,\r\n\tCampaignScopeEnvironmentCrossProduct,\r\n\tCampaignScopeUserFactAll,\r\n\tCampaignScopeUserFactAny,\r\n} from \"./CampaignDefinitionProvider\";\r\n\r\nimport { CampaignState } from \"./CampaignStateProvider\";\r\nimport { CampaignSurveyFactory } from \"./CampaignSurveyFactory\";\r\nimport { IUserFact } from \"@ms-ofb/officepersonalization/dist/lib/Common/Models\";\r\nimport { IUserFactProvider } from \"../Api/IUserFactProvider\";\r\nimport { TelemetryEvent } from \"../Constants\";\r\nimport { getFeatureGateProvider } from \"../FeatureGateProvider\";\r\nimport { TelemetryLogger } from \"../TelemetryLogger\";\r\n\r\nconst { getDistantFuture, getDistantPast, isArray, isNOU } = Utils;\r\n\r\n/**\r\n * The standard campaign manager implementation.\r\n */\r\nexport class CampaignManager implements ICampaignManager, ISurveyClient {\r\n\tpublic static isStateUpForNomination(state: ICampaignState, definition: ICampaignDefinition, date: Date, buildNumber: string): boolean {\r\n\t\tif (!state || !definition) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tdate = date ? date : new Date();\r\n\r\n\t\t// Check manual override\r\n\t\tif (state.ForceCandidacy) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Figure out which duration we're using based on whether or not the user triggered the survey\r\n\t\tconst campaignCooldownDuration: ICampaignDuration\r\n\t\t\t= definition.nominationScheme.getCampaignCooldown(state.IsCandidate && state.DidCandidateTriggerSurvey);\r\n\r\n\t\tif (!campaignCooldownDuration) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t// First check for build-based rules. Eventually this could get more complex if we supported counting differently seen build numbers\r\n\t\tif (CampaignManager.hasBuildChangeDurationElapsed(campaignCooldownDuration, state.LastNominationBuildNumber, buildNumber)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Next check date rules\r\n\t\treturn CampaignManager.hasTimeIntervalDurationElapsed(campaignCooldownDuration, state.getCooldownStartDate(), date);\r\n\t}\r\n\r\n\tpublic static isDateInRange(date: Date, startDate: Date, endDate: Date): boolean {\r\n\t\tdate = date ? date : new Date();\r\n\t\tstartDate = startDate ? startDate : getDistantPast();\r\n\t\tendDate = endDate ? endDate : getDistantFuture();\r\n\r\n\t\t// Check Start/Expire date range\r\n\t\tif (startDate.getTime() <= date.getTime() && endDate.getTime() >= date.getTime()) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic static hasTimeIntervalDurationElapsed(duration: ICampaignDuration, startDate: Date, date: Date): boolean {\r\n\t\tif (isNOU(duration) || !(duration instanceof CampaignDurationTimeInterval)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!startDate || !date) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst endDate: Date = Utils.addSecondsWithoutOverflow(startDate, duration.intervalSeconds);\r\n\t\treturn date.getTime() >= endDate.getTime();\r\n\t}\r\n\r\n\tpublic static hasBuildChangeDurationElapsed(duration: ICampaignDuration, startBuild: string, build: string): boolean {\r\n\t\tif (isNOU(duration) || !(duration instanceof CampaignDurationSingleBuildChange)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (isNOU(startBuild) || isNOU(build)) {\r\n\t\t\treturn (startBuild === null) !== (build === null);\r\n\t\t}\r\n\r\n\t\treturn !(startBuild === build);\r\n\t}\r\n\r\n\tprivate static isCampaignInScope(\r\n\t\tdefinition: ICampaignDefinition,\r\n\t\tdate: Date,\r\n\t\tenvironmentProvider: IFloodgateEnvironmentProvider,\r\n\t\tuserFactsProvider: IUserFactProvider): boolean {\r\n\t\tif (!definition) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tdate = date ? date : new Date();\r\n\r\n\t\t// Check Start/Expire date range\r\n\t\tif (!CampaignManager.isDateInRangeWithDefinition(date, definition)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (definition.scope) {\r\n\t\t\tif (definition.scope instanceof CampaignScopeUserFactAny || definition.scope instanceof CampaignScopeUserFactAll) {\r\n\t\t\t\tdefinition.scope.setUserFactsProvider(userFactsProvider);\r\n\t\t\t}\r\n\t\t\tif (definition.scope instanceof CampaignScopeEnvironmentCrossProduct) {\r\n\t\t\t\tdefinition.scope.setEnvironmentProvider(environmentProvider);\r\n\t\t\t}\r\n\t\t\tif (!definition.scope.isInScope()) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If we get here, the definition is relevant\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate static isDateInRangeWithDefinition(date: Date, definition: ICampaignDefinition): boolean {\r\n\t\tif (!definition) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tdate = date ? date : new Date();\r\n\r\n\t\treturn CampaignManager.isDateInRange(date,\r\n\t\t\t// null start dates should be impossible, but if set, should mean the campaign is disabled\r\n\t\t\tdefinition.startTime ? definition.startTime : getDistantFuture(),\r\n\t\t\tdefinition.endTime);\r\n\t}\r\n\r\n\tprivate campaignStates: IDictionary<ICampaignState>;\r\n\tprivate campaignDefinitions: IDictionary<ICampaignDefinition>;\r\n\tprivate userFacts: IUserFact[];\r\n\tprivate currentBuildNumber: string;\r\n\tprivate stateProvider: ICampaignStateProvider;\r\n\tprivate definitionProviders: ICampaignDefinitionProvider[];\r\n\tprivate stringProvider: IFloodgateStringProvider;\r\n\tprivate environmentProvider: IFloodgateEnvironmentProvider;\r\n\tprivate surveyCandidacyChecker: ISurveyCandidacyChecker;\r\n\tprivate userFactsProvider: IUserFactProvider;\r\n\tprivate lastCampaignRefreshTime: Date;\r\n\tprivate isPriorityEnabled: boolean;\r\n\tprivate logExperimentTrigger: ILogExperimentTrigger;\r\n\tprivate campaignTelemetrySamplingConfig: ICampaignTelemetrySamplingConfig;\r\n\tprivate messagingEnabled: boolean;\r\n\tprivate surveyEnabled: boolean;\r\n\tprivate newNominationCampaigns: string[];\r\n\tprivate isFloodgateEnabledConfigAvailable: boolean;\r\n\tprivate floodgateEnabledTelemetrySamplingRate: number;\r\n\r\n\tpublic constructor(stateProvider: ICampaignStateProvider,\r\n\t\tdefinitionProviders: ICampaignDefinitionProvider[],\r\n\t\tstringProvider: IFloodgateStringProvider,\r\n\t\tenvironmentProvider: IFloodgateEnvironmentProvider,\r\n\t\tcurrentBuildNumber: string,\r\n\t\tcurrentDate: Date,\r\n\t\tisPriorityEnabled: boolean,\r\n\t\tuserFactsProvider?: IUserFactProvider,\r\n\t\tsurveyCandidacyChecker?: ISurveyCandidacyChecker,\r\n\t\tlogExperimentTrigger?: ILogExperimentTrigger,\r\n\t\tcampaignTelemetrySamplingConfig?: ICampaignTelemetrySamplingConfig,\r\n\t\tmessagingEnabled?: boolean,\r\n\t\tsurveyEnabled?: boolean) {\r\n\r\n\t\tif (!stateProvider) {\r\n\t\t\tthrow new Error(\"stateProvider must not be null\");\r\n\t\t}\r\n\r\n\t\tif (!isArray(definitionProviders)) {\r\n\t\t\tthrow new Error(\"definitionProviders is either null or not an array type\");\r\n\t\t}\r\n\r\n\t\tif (!stringProvider) {\r\n\t\t\tthrow new Error(\"stringProvider must not be null\");\r\n\t\t}\r\n\r\n\t\tif (isNOU(currentBuildNumber)) {\r\n\t\t\tthrow new Error(\"currentBuildNumber must not be null\");\r\n\t\t}\r\n\r\n\t\t// these settings help determine what type of messaging surface / Floodgate capability is available\r\n\t\tthis.messagingEnabled = messagingEnabled;\r\n\t\tthis.surveyEnabled = surveyEnabled;\r\n\r\n\t\tthis.campaignStates = {};\r\n\t\tthis.campaignDefinitions = {};\r\n\t\tthis.userFacts = [];\r\n\t\tthis.stateProvider = stateProvider;\r\n\t\tthis.definitionProviders = definitionProviders;\r\n\t\tthis.stringProvider = stringProvider;\r\n\t\tthis.surveyCandidacyChecker = surveyCandidacyChecker;\r\n\t\tthis.userFactsProvider = userFactsProvider;\r\n\t\tthis.environmentProvider = environmentProvider; // Can be null\r\n\t\tthis.currentBuildNumber = currentBuildNumber;\r\n\r\n\t\tcurrentDate = currentDate ? currentDate : new Date();\r\n\t\tthis.isPriorityEnabled = isPriorityEnabled;\r\n\r\n\t\tthis.logExperimentTrigger = logExperimentTrigger;\r\n\r\n\t\tthis.campaignTelemetrySamplingConfig = campaignTelemetrySamplingConfig;\r\n\r\n\t\tthis.isFloodgateEnabledConfigAvailable = getFeatureGateProvider()?.getBoolFeatureStatus(\"FloodgateEnabledConfigAvailable\", false);\r\n\t\tthis.floodgateEnabledTelemetrySamplingRate = getFeatureGateProvider()?.getIntFeatureStatus(\"FloodgateEnabledTelemetrySamplingRate\", 0.1);\r\n\t}\r\n\r\n\tpublic LogExperimentTrigger(triggerDetails: ITriggerEventDetails[]): void {\r\n\t\tif (isNOU(this.logExperimentTrigger)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(TelemetryEvent.CampaignGovernance.LogExperimentTrigger.Undefined,\r\n\t\t\t\t\"LogExperimentTrigger does not exist\");\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tthis.logExperimentTrigger.LogExperimentTrigger(triggerDetails);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\t\tTelemetryEvent.CampaignGovernance.LogExperimentTrigger.Failed, \"Failed to run LogExperimentTrigger \" + error);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getActiveSurveys(): IDictionary<ISurvey> {\r\n\t\tconst surveys: IDictionary<ISurvey> = {};\r\n\t\tconst prioritizedCampaigns = this.getPrioritizedCampaigns();\r\n\t\tconst activeCampaignIds = [];\r\n\r\n\t\tfor (const key in this.campaignStates) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.campaignStates, key)) {\r\n\t\t\t\tconst state: ICampaignState = this.campaignStates[key];\r\n\t\t\t\tif (!state.IsCandidate) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// This is a requirement because we keep some otherwise \"stale\" campaigns around for the save routine\r\n\t\t\t\tconst definition: ICampaignDefinition = prioritizedCampaigns[state.CampaignId];\r\n\t\t\t\tif (!definition) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst survey: ISurvey = CampaignSurveyFactory.makeSurvey(state, definition, this.stringProvider);\r\n\t\t\t\tif (!survey) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.surveyCandidacyChecker && !this.surveyCandidacyChecker.isSurveyTrackable(survey)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsurveys[survey.getSurveyInfo().getId()] = survey;\r\n\t\t\t\tactiveCampaignIds.push(survey.getCampaignId());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.logActiveSurveys(prioritizedCampaigns, activeCampaignIds);\r\n\t\treturn surveys;\r\n\t}\r\n\r\n\t// This function will log a json of all the CampaignStates during creating active surveys. The purpose of this log is for us to be able to detect\r\n\t// whether the campaign is selected correctly with nomination and prioritization.\r\n\t// The sampling rate of this log is dependent on what rate was received from the campaignTelemetrySamplingConfig\r\n\t// This telemetry gets logged at every floodgate.start. So we need to keep the sampling rate low.\r\n\t// Default sampling rate: 0% - it's turned off by default. We will enable it from the Host app side if needed.\r\n\tprivate logActiveSurveys(prioritizedCampaigns: IDictionary<ICampaignDefinition>, activeCampaignIds: string[]) {\r\n\t\tconst currentCampaignStates: Record<string, unknown>[] = [];\r\n\t\tfor (const key in this.campaignStates) {\r\n\t\t\tconst state: ICampaignState = this.campaignStates[key];\r\n\t\t\tconst payload: Record<string, unknown> = {\r\n\t\t\t\tCampaignId: key,\r\n\t\t\t\tIsCandidate: state.IsCandidate,\r\n\t\t\t\tDidCandidateTriggerSurvey: state.DidCandidateTriggerSurvey,\r\n\t\t\t\tSurveyId: state.LastSurveyId\r\n\t\t\t}\r\n\t\t\tcurrentCampaignStates.push(payload);\r\n\t\t}\r\n\r\n\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.GetActiveSurveys,\r\n\t\t\t{\r\n\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\tCampaignStates: currentCampaignStates,\r\n\t\t\t\t\tPrioritizedCampaigns: Object.keys(prioritizedCampaigns),\r\n\t\t\t\t\tActiveCampaigns: activeCampaignIds,\r\n\t\t\t\t\tNewNominationCampaigns: this.newNominationCampaigns\r\n\t\t\t\t})\r\n\t\t\t}, 0);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic modifyCampaignSurveyTakenDate(campaignId: string, takenDate: Date, isSurveyComplete: boolean): void {\r\n\t\tconst state: ICampaignState = this.campaignStates[campaignId];\r\n\t\tif (!state) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttakenDate = takenDate ? takenDate : new Date();\r\n\r\n\t\tconst cooldownSeconds = this.campaignDefinitions[campaignId].nominationScheme.cooldownPeriod.asTimeIntervalSeconds();\r\n\t\tstate.markCurrentSurveyTakenOnDate(takenDate, cooldownSeconds, isSurveyComplete);\r\n\r\n\t\tthis.saveCurrentState();\r\n\t}\r\n\r\n\tpublic getCampaignStates(): IDictionary<ICampaignState> {\r\n\t\treturn this.campaignStates;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCampaignDefinitions(): IDictionary<ICampaignDefinition> {\r\n\t\treturn this.campaignDefinitions;\r\n\t}\r\n\r\n\tpublic getUserFacts(): IUserFact[] {\r\n\t\treturn this.userFacts;\r\n\t}\r\n\r\n\t// region ISurveyClient methods\r\n\r\n\t// @Override\r\n\tpublic onSurveyActivated(surveyInfo: ISurveyInfo, isSurveyComplete: boolean): void {\r\n\t\tif (!surveyInfo) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.modifyCampaignSurveyTakenDate(surveyInfo.getBackEndId(), new Date(), isSurveyComplete);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic refreshSurveyDefinitions(channelTypes?: GovernedChannelType[], date?: Date): void {\r\n\t\tthis.refreshSurveyDefinitionsPrivate(channelTypes, (date ? date : new Date()));\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic refreshSurveyDefinitionsAsync(channelTypes?: GovernedChannelType[], date?: Date): Promise<void> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.refreshSurveyDefinitionsPrivateAsync(channelTypes, (date ? date : new Date())).then(\r\n\t\t\t\tfunction onFulfilled() {\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t},\r\n\t\t\t).catch(\r\n\t\t\t\tfunction OnRejected(errReason) {\r\n\t\t\t\t\treject(errReason);\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getAppSurveys(): { [id: string]: ISurvey } {\r\n\t\treturn this.getActiveSurveys();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic saveCurrentState(): void {\r\n\t\t// Sort by campaignId, ascending for uniformity\r\n\t\tconst states: ICampaignState[] = Utils.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);\r\n\r\n\t\tthis.stateProvider.save(states);\r\n\t}\r\n\r\n\t// endregion\r\n\r\n\tprivate refreshSurveyDefinitionsPrivate(channelTypes: GovernedChannelType[], date: Date): void {\r\n\t\tif (this.needRefreshSurveyDefinitions()) {\r\n\t\t\tthis.lastCampaignRefreshTime = new Date();\r\n\t\t\tthis.campaignDefinitions = {};\r\n\t\t\tthis.userFacts = [];\r\n\r\n\t\t\tthis.loadFilterCampaigns(date, channelTypes);\r\n\t\t} else {\r\n\t\t\tthis.FilterCampaignsOnRestart(date, channelTypes);\r\n\t\t}\r\n\r\n\t\tthis.campaignStates = {};\r\n\t\tthis.LoadFilterCampaignStates(date);\r\n\t\tthis.evaluateCampaigns(date);\r\n\t}\r\n\r\n\tprivate refreshSurveyDefinitionsPrivateAsync(channelTypes: GovernedChannelType[], date: Date): Promise<void> {\r\n\t\tthis.campaignStates = {};\r\n\t\tthis.campaignDefinitions = {};\r\n\t\tthis.userFacts = [];\r\n\t\tthis.lastCampaignRefreshTime = this.lastCampaignRefreshTime ?? new Date();\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.loadAndFilterCampaignDataAsync(date, channelTypes).then(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.evaluateCampaigns(date);\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t},\r\n\t\t\t).catch(\r\n\t\t\t\tfunction OnRejected(errReason) {\r\n\t\t\t\t\treject(errReason);\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Load and filter the campaigns definitions and states\r\n\t */\r\n\tprivate loadAndFilterCampaignDataAsync(currentDate: Date, channelTypes: GovernedChannelType[]): Promise<void> {\r\n\t\tcurrentDate = currentDate ? currentDate : new Date();\r\n\t\tlet loadedDefinitions: ICampaignDefinition[] = [];\r\n\t\tconst promises = [];\r\n\r\n\t\tconst userFactsPromise = this.userFactsProvider && this.userFactsProvider.loadAsync() as Promise<IUserFact[]>;\r\n\r\n\t\tfor (const i of Object.keys(this.definitionProviders)) {\r\n\t\t\tconst provider = this.definitionProviders[i];\r\n\t\t\tlet promise: any = provider && provider.loadAsync();\r\n\t\t\tif (!isNOU(promise)) {\r\n\t\t\t\t// Promise.all fails even if one promise fails.\r\n\t\t\t\t// We want to ignore the promise that failed and continue with the ones\r\n\t\t\t\t// those are succesful, hence overriding the catch to always resolve.\r\n\t\t\t\t// responsibility of logging failures should be with the provider.\r\n\t\t\t\tpromise = promise.catch(() => {\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_CampaignLoad_Failed(\"Failed to load from campaign definition provider\");\r\n\t\t\t\t\tPromise.resolve();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tpromises.push(promise);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tPromise.all(promises).then((values) => {\r\n\t\t\t\tfor (const i of Object.keys(values)) {\r\n\t\t\t\t\tconst campaignDefinitions = values[i];\r\n\t\t\t\t\tif (isArray(campaignDefinitions)) {\r\n\t\t\t\t\t\t// If there are campaign defintions with duplicate campaign Id's\r\n\t\t\t\t\t\t// Floodgate will load the last one it found. FilterCampaignData does this filteration\r\n\t\t\t\t\t\tloadedDefinitions = loadedDefinitions.concat(campaignDefinitions);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.logInitialLoadCampaigns(loadedDefinitions, \"loadAsync\", this.campaignTelemetrySamplingConfig?.campaignInitialLoadSamplingRate);\r\n\r\n\t\t\t\tconst setUserFacts = (userFacts?: IUserFact[]) => {\r\n\t\t\t\t\tthis.userFacts = userFacts || [];\r\n\t\t\t\t\tthis.FilterCampaignData(currentDate, channelTypes, loadedDefinitions);\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Before filtering and evaluating the campaign definitions,\r\n\t\t\t\t// wait until the user facts are loaded as they will be used in evaluating campaign scopes\r\n\t\t\t\tif (!isNOU(userFactsPromise)) {\r\n\t\t\t\t\tuserFactsPromise.then((userFacts: IUserFact[]) => {\r\n\t\t\t\t\t\tsetUserFacts(userFacts);\r\n\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\t// this should never happen as user facts promise will always be resolved by the user facts provider\r\n\t\t\t\t\t\tTelemetryLogger.getTelemetryLogger()\r\n\t\t\t\t\t\t\t.log_Error(TelemetryEvent.Floodgate.UserFactsLoad.Failed, \"Failed to load from user facts provider\");\r\n\t\t\t\t\t\tsetUserFacts();\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetUserFacts();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t).catch(\r\n\t\t\t\tfunction OnRejected(error) {\r\n\t\t\t\t\t// this should never happen as Promise.all will always be resolved\r\n\t\t\t\t\t// because of hack at the top of the function.\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_CampaignLoad_Failed(\"Failed to load from campaign definition provider\");\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t// This function will log a json of all the definitions received on initial load. The purpose of this log is for us to be able to detect\r\n\t// what campaigns users initially recieved and trace which campaigns from the original pool were successfully nominated / launched\r\n\t// The sampling rate of this log is dependent on what rate was received from the campaignTelemetrySamplingConfig\r\n\t// This telemetry gets logged once per floodgate session\r\n\t// Default sampling rate: 10%\r\n\tprivate logInitialLoadCampaigns(loadedDefinitions: ICampaignDefinition[], loadMethod: string, initialLoadSamplingRate = 0.1) {\r\n\t\tif (initialLoadSamplingRate > 0) {\r\n\t\t\tconst loggedDefinitions: Record<string, unknown>[] = [];\r\n\t\t\tfor (const key in loadedDefinitions) {\r\n\t\t\t\tconst definition = loadedDefinitions[key];\r\n\t\t\t\tconst payload: Record<string, unknown> = {\r\n\t\t\t\t\tid: definition.campaignId,\r\n\t\t\t\t\tbusinessLevel: definition.businessLevel,\r\n\t\t\t\t\ttreatmentType: definition.treatmentType,\r\n\t\t\t\t\tscope: definition.scope,\r\n\t\t\t\t\ttelemetryEventName: definition?.surveyTemplate?.metadata?.contentMetadata?.[\"telemetryEventName\"],\r\n\t\t\t\t\tuserHost: this.environmentProvider,\r\n\t\t\t\t\tgovernedChannelType: definition.governedChannelType,\r\n\t\t\t\t\tloadMethod: loadMethod,\r\n\t\t\t\t}\r\n\t\t\t\tloggedDefinitions.push(payload);\r\n\t\t\t}\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.InitialLoadedDefinitions,\r\n\t\t\t\t{ Message: JSON.stringify(loggedDefinitions) },\r\n\t\t\t\tinitialLoadSamplingRate)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isCampaignTypeEnabled(governedChannelType: GovernedChannelType): boolean {\r\n\r\n\t\t// default to true unless stated otherwise by the associated enabled settings\r\n\t\tlet isCampaignTypeEnabled = true;\r\n\r\n\t\t// feature gate for Floodgate Enabled feature- if this is on we will use the settings to determine whether to filter at this stage\r\n\t\tif (this.isFloodgateEnabledConfigAvailable) {\r\n\t\t\t// LPP campaigns depend on the messagingEnabled check (currently teaching message or busbar)\r\n\t\t\tif (governedChannelType == GovernedChannelType.TeachingMessage || governedChannelType == GovernedChannelType.BusinessBar) {\r\n\t\t\t\tisCampaignTypeEnabled = this.messagingEnabled;\r\n\t\t\t} else {\r\n\t\t\t\t// Quip surveys will depend on the surveyEnabled check\r\n\t\t\t\tisCampaignTypeEnabled = this.surveyEnabled;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// we return default true if we did not receive floodgate enabled config or the feature gate is not on\r\n\t\treturn isCampaignTypeEnabled;\r\n\t}\r\n\r\n\r\n\tprivate loadFilterCampaigns(currentDate: Date, channelTypes: GovernedChannelType[]): void {\r\n\t\tcurrentDate = currentDate ? currentDate : new Date();\r\n\t\tlet loadedDefinitions: ICampaignDefinition[] = [];\r\n\r\n\t\tfor (const index of Object.keys(this.definitionProviders)) {\r\n\t\t\ttry {\r\n\t\t\t\tconst definitions = this.definitionProviders[index] && this.definitionProviders[index].load();\r\n\t\t\t\tif (isArray(definitions)) {\r\n\t\t\t\t\t// If there are campaign defintions with duplicate campaign Id's\r\n\t\t\t\t\t// Floodgate will load the last one it found. FilterCampaignData does this filteration\r\n\t\t\t\t\tloadedDefinitions = loadedDefinitions.concat(definitions);\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\t// Log error, but continue with other providers\r\n\t\t\t\t// It should be the responsibility of provider to log detailed errors\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_CampaignLoad_Failed(\"Failed to load from campaign definition provider. \" + error.toString());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.logInitialLoadCampaigns(loadedDefinitions, \"load\", this.campaignTelemetrySamplingConfig?.campaignInitialLoadSamplingRate);\r\n\r\n\t\t// Load the user facts before all the campaign definitions are evaluated\r\n\t\ttry {\r\n\t\t\tthis.userFacts = (this.userFactsProvider && this.userFactsProvider.load()) || [];\r\n\t\t} catch (error) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.Floodgate.UserFactsLoad.Failed, \"Failed to load from user facts provider. \" + error);\r\n\t\t}\r\n\r\n\t\t// array that lists the skipped campaigns due to the campaign type not being enabled\r\n\t\tconst disabledCampaigns = new Array<string>()\r\n\r\n\t\t// array that will be passed to LPP scorecard callback\r\n\t\tconst triggerDetails = new Array<ITriggerEventDetails>();\r\n\r\n\t\t// array that lists campaign ids which passed governed channel type / business level checks\r\n\t\tconst channelCleared = new Array<string>()\r\n\r\n\t\t// array that lists campaign ids that are in scope \r\n\t\tconst inScope = new Array<string>();\r\n\r\n\t\t// array that lists campaign ids that are not control campaigns (added to activityListener)\r\n\t\tconst nominated = new Array<string>();\r\n\r\n\t\t// Load filtered campaign definitions\r\n\t\tfor (const key in loadedDefinitions) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(loadedDefinitions, key)) {\r\n\t\t\t\tconst definition: ICampaignDefinition = loadedDefinitions[key];\r\n\r\n\t\t\t\t// checks if this definition should be included in nomination process based on Floodgate Enabled configuration\r\n\t\t\t\tif (!this.isCampaignTypeEnabled(definition.governedChannelType)) {\r\n\t\t\t\t\tdisabledCampaigns.push(definition.campaignId)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// this needs to be done here before adding to campaignDefinitions in case there are multiple definitions with different language scopes\r\n\t\t\t\tif (!CampaignManager.isCampaignInScope(definition, currentDate, this.environmentProvider, this.userFactsProvider)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tinScope.push(definition.campaignId);\r\n\r\n\t\t\t\t// filtering for campaign trigger logging\r\n\t\t\t\tif (definition.treatmentType !== TreatmentType.none) {\r\n\t\t\t\t\t// campaign trigger info for scorecards\r\n\t\t\t\t\tconst triggerDetail = this.RetrieveTriggerEventDetail(definition);\r\n\t\t\t\t\tif (!isNOU(triggerDetail)) {\r\n\t\t\t\t\t\ttriggerDetails.push(triggerDetail);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (channelTypes &&\r\n\t\t\t\t\t(channelTypes.indexOf(definition.governedChannelType) < 0) &&\r\n\t\t\t\t\t(definition.businessLevel !== BusinessLevel.Critical)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tchannelCleared.push(definition.campaignId);\r\n\r\n\t\t\t\t// to remove control campaigns from activityListener list \r\n\t\t\t\tif (definition.treatmentType === TreatmentType.Control) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// log the definitions which are nominated\r\n\t\t\t\tnominated.push(definition.campaignId);\r\n\t\t\t\t// Overwrite the campaign definition if it already exists with the latest one.\r\n\t\t\t\tthis.campaignDefinitions[definition.campaignId] = definition;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// log the campaigns which were skipped due to the campaign type being disabled\r\n\t\tthis.CampaignTypeDisabledTelemetry(disabledCampaigns, this.messagingEnabled, this.surveyEnabled);\r\n\r\n\t\t// if sampling is on for governance check telemetry, log telemetry\r\n\t\tthis.GovernanceCheckTelemetry(channelCleared, inScope, nominated, this.campaignTelemetrySamplingConfig?.passedCampaignGovernanceSamplingRate);\r\n\r\n\t\t// call new scorecard trigger callback only if feature gate is on and there are campaign definitions available\r\n\t\tif (triggerDetails.length > 0) {\r\n\t\t\tthis.LogExperimentTrigger(triggerDetails);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate RetrieveTriggerEventDetail(definition: ICampaignDefinition): ITriggerEventDetails {\r\n\t\ttry {\r\n\t\t\tconst eventInfo: IEventInfo = {\r\n\t\t\t\tid: definition.campaignId,\r\n\t\t\t\ttelemetryEventName: definition?.surveyTemplate?.metadata?.contentMetadata?.[\"telemetryEventName\"],\r\n\t\t\t\ttreatmentType: isNOU(definition.treatmentType) ? TreatmentType.none : definition.treatmentType\r\n\t\t\t}\r\n\r\n\t\t\tconst triggerDetail: ITriggerEventDetails = {\r\n\t\t\t\ttriggerEvent: eventInfo.telemetryEventName,\r\n\t\t\t\teventInfo: eventInfo\r\n\t\t\t}\r\n\r\n\t\t\t// return info needed for scorecards for this campaign to the list to the array\r\n\t\t\treturn triggerDetail;\r\n\t\t} catch (error) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.CampaignGovernance.RetrieveTriggerEventDetail.Failed, \"Failed to add trigger event detail \" + error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t// creating a json object to log campaigns which passed various governance checks, logs once per floodgate session\r\n\t// Default sampling rate: 10%\r\n\tprivate GovernanceCheckTelemetry(channelCleared: string[], inScope: string[], nominated: string[], samplingRate = 0.1)\r\n\t\t: void {\r\n\t\tif (samplingRate > 0) {\r\n\t\t\tconst payload: Record<string, unknown> = {\r\n\t\t\t\tchannelCleared: channelCleared.length > 0 ? channelCleared : undefined,\r\n\t\t\t\tinScope: inScope.length > 0 ? inScope : undefined,\r\n\t\t\t\tnominated: nominated.length > 0 ? nominated : undefined,\r\n\t\t\t}\r\n\t\t\tif (Object.values(payload).some(v => v != undefined)) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.CampaignGovernance.NominationCheckCampaigns,\r\n\t\t\t\t\t{ Message: JSON.stringify(payload) }, samplingRate);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate CampaignTypeDisabledTelemetry(disabledCampaigns, messagingEnabled = true, surveyEnabled = true) {\r\n\t\tif (this.isFloodgateEnabledConfigAvailable && disabledCampaigns.length > 0) {\r\n\t\t\tconst payload: Record<string, unknown> = {\r\n\t\t\t\tdisabledCampaigns: disabledCampaigns,\r\n\t\t\t\tmessagingEnabled: messagingEnabled,\r\n\t\t\t\tsurveyEnabled: surveyEnabled,\r\n\t\t\t}\r\n\r\n\t\t\t// default we will log the telemetry at 10%, we can change this later on if needed\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.CampaignTypeDisabledDefinitions,\r\n\t\t\t\t{ Message: JSON.stringify(payload) }, this.floodgateEnabledTelemetrySamplingRate);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Load and filter the campaigns definitions and states\r\n\t */\r\n\tprivate FilterCampaignData(currentDate: Date, channelTypes: GovernedChannelType[], loadedDefinitions: ICampaignDefinition[]): void {\r\n\t\tconst loadedDefinitionsMap: IDictionary<ICampaignDefinition> = {};\r\n\t\tconst triggerDetails = new Array<ITriggerEventDetails>();\r\n\r\n\t\t// array that lists the skipped campaigns due to the campaign type not being enabled\r\n\t\tconst campaignTypeDisabledCampaigns = new Array<string>()\r\n\r\n\t\t// array that lists campaign ids which passed governed channel type / business level checks\r\n\t\tconst channelCleared = new Array<string>()\r\n\r\n\t\t// array that lists campaign ids that are in scope \r\n\t\tconst inScope = new Array<string>();\r\n\r\n\t\t// array that lists campaign ids that are not control campaigns (added to activityListener)\r\n\t\tconst nominated = new Array<string>();\r\n\t\t// Load filtered campaign definitions\r\n\t\tfor (const key in loadedDefinitions) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(loadedDefinitions, key)) {\r\n\t\t\t\tconst definition: ICampaignDefinition = loadedDefinitions[key];\r\n\r\n\t\t\t\tloadedDefinitionsMap[definition.campaignId] = definition;\r\n\r\n\t\t\t\t// checks if this definition should be included in nomination process based on Floodgate Enabled configuration\r\n\t\t\t\tif (!this.isCampaignTypeEnabled(definition.governedChannelType)) {\r\n\t\t\t\t\tcampaignTypeDisabledCampaigns.push(definition.campaignId)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// this needs to be done here before adding to campaignDefinitions in case there are multiple definitions with different language scopes\r\n\t\t\t\tif (!CampaignManager.isCampaignInScope(definition, currentDate, this.environmentProvider, this.userFactsProvider)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tinScope.push(definition.campaignId);\r\n\r\n\t\t\t\t// filtering for campaign trigger logging\r\n\t\t\t\tif (definition.treatmentType !== TreatmentType.none) {\r\n\t\t\t\t\t// campaign trigger info for scorecards\r\n\t\t\t\t\tconst triggerDetail = this.RetrieveTriggerEventDetail(definition);\r\n\t\t\t\t\tif (!isNOU(triggerDetail)) {\r\n\t\t\t\t\t\ttriggerDetails.push(triggerDetail);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (channelTypes &&\r\n\t\t\t\t\t(channelTypes.indexOf(definition.governedChannelType) < 0) &&\r\n\t\t\t\t\t(definition.businessLevel !== BusinessLevel.Critical)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tchannelCleared.push(definition.campaignId);\r\n\r\n\t\t\t\t// to remove control campaigns from activityListener list \r\n\t\t\t\tif (definition.treatmentType === TreatmentType.Control) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// log the definitions which are nominated\r\n\t\t\t\tnominated.push(definition.campaignId);\r\n\t\t\t\t// Overwrite the campaign definition if it already exists with the latest one.\r\n\t\t\t\tthis.campaignDefinitions[definition.campaignId] = definition;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// log the campaigns which were skipped due to the campaign type being disabled\r\n\t\tthis.CampaignTypeDisabledTelemetry(campaignTypeDisabledCampaigns, this.messagingEnabled, this.surveyEnabled);\r\n\r\n\t\t// if sampling is on for governance check telemetry, log telemetry\r\n\t\tthis.GovernanceCheckTelemetry(channelCleared, inScope, nominated, this.campaignTelemetrySamplingConfig?.passedCampaignGovernanceSamplingRate);\r\n\r\n\t\t// call new scorecard trigger callback only if feature gate is on and there are campaign definitions available\r\n\t\tif (triggerDetails.length > 0) {\r\n\t\t\tthis.LogExperimentTrigger(triggerDetails);\r\n\t\t}\r\n\r\n\t\t// Load campaign state, filtering out the expired definitions\r\n\t\tconst loadedStates: ICampaignState[] = this.stateProvider.load();\r\n\t\tconst staleLoadedStates: ICampaignState[] = [];\r\n\r\n\t\tfor (const key in loadedStates) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(loadedStates, key)) {\r\n\t\t\t\tconst state: ICampaignState = loadedStates[key];\r\n\r\n\t\t\t\tif (!Object.prototype.hasOwnProperty.call(this.campaignDefinitions, state.CampaignId)) {\r\n\t\t\t\t\tstaleLoadedStates.push(state);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.campaignStates[state.CampaignId] = state;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\t\t* Stale State data cleanup\r\n\t\t\t* State needs to be cleaned up when:\r\n\t\t\t* 1) The campaign has expired\r\n\t\t\t* 2) The campaign is no longer present in the definitions (think ECS or other outages or very old expirations)\r\n\t\t\t*    In this case the state should still be cleaned up on it's reelection date\r\n\t\t\t* 3) When the user is out of scope (for an otherwise active campaign) and is up for nomination\r\n\r\n\t\t\t* This optimizes the user experience in case the campaign pops up or gets renewed when we would have preferred the user remain in cool down\r\n\r\n\t\t\t* 2&3 are basically the same, and 1 is a special case optimization on top of 2&3 for earlier clean up\r\n\r\n\t\t\t* To do 2 & 3, we just look at states with no matching definition (after filtering), and reject them if they are past their nomination period\r\n\t\t\t* To do 1, we just need to keep a list/hash of the definitions that we filtered out this load cycle, specifically for expiration dates, and bypass\r\n\t\t\t* the cool down \"wait\" for these specifically\r\n\r\n\t\t\t* For now, allowing some \"grace\" for \"missing\"/\"blippy\" campaign definitions (in case they pop in and out of ECS) by deferring missing\r\n\t\t\t* deletion by a delay-time specified by the original campaign.\r\n\t\t\t*/\r\n\t\tfor (const key in staleLoadedStates) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(staleLoadedStates, key)) {\r\n\t\t\t\tconst state: ICampaignState = staleLoadedStates[key];\r\n\t\t\t\tif (!state) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst definition: ICampaignDefinition = loadedDefinitionsMap[state.CampaignId];\r\n\t\t\t\tlet shouldRemove = false;\r\n\r\n\t\t\t\tif (!definition) {\r\n\t\t\t\t\tif (state.LastNominationTimeUtc\r\n\t\t\t\t\t\t.getTime() <= Utils.subtractSecondsWithoutOverflow(currentDate, state.DeleteAfterSecondsWhenStale).getTime()) {\r\n\t\t\t\t\t\tshouldRemove = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (CampaignManager.isStateUpForNomination(state, definition, currentDate, this.currentBuildNumber)) {\r\n\t\t\t\t\tshouldRemove = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// The next time we write to storage, these will be removed\r\n\t\t\t\tif (shouldRemove) {\r\n\t\t\t\t\tdelete this.campaignStates[state.CampaignId];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Filter lower priority campaigns that are on same channel and have a matching tag\r\n\tprivate getPrioritizedCampaigns() {\r\n\t\tconst prioritizedCampaigns: IDictionary<ICampaignDefinition> = {};\r\n\r\n\t\t// build <tagId_channel, campaign[]> map\r\n\t\tconst matchingTagCampaigns: IDictionary<ICampaignDefinition[]> = {};\r\n\t\tObject.keys(this.campaignDefinitions || []).forEach((key) => {\r\n\t\t\tconst definition: ICampaignDefinition = this.campaignDefinitions[key];\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.campaignStates, key)) {\r\n\t\t\t\tconst state: ICampaignState = this.campaignStates[key];\r\n\t\t\t\t// only add the campaign if it's nominated\r\n\t\t\t\tif (state.IsCandidate) {\r\n\t\t\t\t\tprioritizedCampaigns[key] = definition;\r\n\r\n\t\t\t\t\t// if tags are not defined, use empty tag to fallback to channel level aggregation\r\n\t\t\t\t\tconst definitionTags = definition.tags && definition.tags.length > 0 ? definition.tags : [\"\"];\r\n\t\t\t\t\tdefinitionTags.forEach((tagId) => {\r\n\t\t\t\t\t\tconst mapKey = `${tagId}_${definition.governedChannelType}`;\r\n\t\t\t\t\t\tmatchingTagCampaigns[mapKey] = matchingTagCampaigns[mapKey] || [];\r\n\t\t\t\t\t\tmatchingTagCampaigns[mapKey].push(definition);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// remove lower priority campaigns\r\n\t\tObject.keys(matchingTagCampaigns).forEach((key) => {\r\n\t\t\t// Check if the priority filter is enabled for standard channel\r\n\t\t\tif (!this.isPriorityEnabled && key.endsWith(`_${GovernedChannelType.Standard}`)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst definitions = matchingTagCampaigns[key];\r\n\t\t\tif (definitions.length <= 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Get definition that has max priority value (0/null/undefined has highest prioirty)\r\n\t\t\tconst [maxPriorityDefinition, hasLowerPriorityDefinitions] = Utils.findHighestPriorityDefinition(definitions);\r\n\r\n\t\t\tconst maxPriority = maxPriorityDefinition.primaryPriority ?? 0;\r\n\t\t\tif (!hasLowerPriorityDefinitions) {\r\n\t\t\t\t// nothing to filter because all priorities are the same\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// delete lower priority campaigns while preserving all the matching higher priority items\r\n\t\t\tdefinitions.forEach((current) => {\r\n\t\t\t\tconst currentPriority = current.primaryPriority;\r\n\r\n\t\t\t\t// for mso compatability ignore campaigns without priority set so that they are always considered\r\n\t\t\t\tif (!isNOU(current.primaryPriority) && currentPriority > maxPriority) {\r\n\t\t\t\t\tdelete prioritizedCampaigns[current.campaignId];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn prioritizedCampaigns;\r\n\t}\r\n\r\n\t/**\r\n\t * Given the loaded campaign definitions and states from previous sessions, run anything up for nomination\r\n\t */\r\n\tprivate evaluateCampaigns(currentDate: Date): void {\r\n\t\t// Loop through campaigns definitions, and update their state if necessary\r\n\t\tcurrentDate = currentDate ? currentDate : new Date();\r\n\t\tthis.newNominationCampaigns = [];\r\n\r\n\t\tfor (const key in this.campaignDefinitions) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.campaignDefinitions, key)) {\r\n\t\t\t\tconst definition: ICampaignDefinition = this.campaignDefinitions[key];\r\n\t\t\t\tconst state: ICampaignState = this.campaignStates[definition.campaignId];\r\n\r\n\t\t\t\tif (!state || CampaignManager.isStateUpForNomination(state, definition, currentDate, this.currentBuildNumber)) {\r\n\t\t\t\t\tlet lastSurveyId: string = state ? state.LastSurveyId : \"\";\r\n\t\t\t\t\tlet lastSurveyStartTime: Date = state ? state.LastSurveyStartTimeUtc : getDistantPast();\r\n\t\t\t\t\tlet lastSurveyExpirationTime: Date = state ? state.LastSurveyExpirationTimeUtc : getDistantPast();\r\n\t\t\t\t\tconst lastSurveyActivatedTime: Date = state ? state.LastSurveyActivatedTimeUtc : getDistantPast();\r\n\t\t\t\t\tconst lastCooldownEndTimeUtc: Date = state ? state.LastCooldownEndTimeUtc : getDistantPast();\r\n\t\t\t\t\tthis.newNominationCampaigns.push(definition.campaignId);\r\n\r\n\t\t\t\t\t// Run the nomination\r\n\t\t\t\t\tconst isCandidate: boolean = (state && state.ForceCandidacy) || definition.nominationScheme.evaluateNominationRules();\r\n\t\t\t\t\tif (isCandidate) {\r\n\t\t\t\t\t\t// Make new survey properties for the next call to get the active surveys\r\n\t\t\t\t\t\tlastSurveyId = Utils.guid();\r\n\t\t\t\t\t\tlastSurveyStartTime = definition.nominationScheme.calculateSurveyStartTimeFromDate(currentDate);\r\n\t\t\t\t\t\tlastSurveyExpirationTime = definition.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(lastSurveyStartTime);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst newState: ICampaignState = new CampaignState(\r\n\t\t\t\t\t\tdefinition.campaignId,\r\n\t\t\t\t\t\tcurrentDate,\r\n\t\t\t\t\t\tthis.currentBuildNumber,\r\n\t\t\t\t\t\tdefinition.nominationScheme.getActiveSurveyTimeIntervalSeconds(),\r\n\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\tisCandidate,\r\n\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\tlastSurveyActivatedTime,\r\n\t\t\t\t\t\tlastSurveyId,\r\n\t\t\t\t\t\tlastSurveyStartTime,\r\n\t\t\t\t\t\tlastSurveyExpirationTime,\r\n\t\t\t\t\t\tlastCooldownEndTimeUtc,\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Save the new state to our local cache\r\n\t\t\t\t\tthis.campaignStates[newState.CampaignId] = newState;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate needRefreshSurveyDefinitions(): boolean {\r\n\t\t// Check for data has changed\r\n\t\tlet updateNeeded = false;\r\n\r\n\t\tfor (const i of Object.keys(this.definitionProviders)) {\r\n\t\t\tconst provider = this.definitionProviders[i];\r\n\t\t\tupdateNeeded = provider.hasDataChanged();\r\n\r\n\t\t\t// Breakout singe we just need one true to refresh campaigns\r\n\t\t\tif (updateNeeded) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn !this.lastCampaignRefreshTime || updateNeeded;\r\n\t}\r\n\r\n\tprivate FilterCampaignsOnRestart(currentDate: Date, channelTypes: GovernedChannelType[]): void {\r\n\t\tfor (const key in this.campaignDefinitions) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.campaignDefinitions, key)) {\r\n\t\t\t\tconst definition: ICampaignDefinition = this.campaignDefinitions[key];\r\n\r\n\t\t\t\t// checks if this definition should be included in nomination process based on Floodgate Enabled configuration\r\n\t\t\t\tif (!this.isCampaignTypeEnabled(definition.governedChannelType)) {\r\n\t\t\t\t\tdelete this.campaignDefinitions[definition.campaignId];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (channelTypes &&\r\n\t\t\t\t\t(channelTypes.indexOf(definition.governedChannelType) < 0) &&\r\n\t\t\t\t\t(definition.businessLevel !== BusinessLevel.Critical)) {\r\n\t\t\t\t\tdelete this.campaignDefinitions[definition.campaignId];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!CampaignManager.isCampaignInScope(definition, currentDate, this.environmentProvider, this.userFactsProvider)) {\r\n\t\t\t\t\tdelete this.campaignDefinitions[definition.campaignId];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// new campaign governance only applies if feature gate is on, removes control campaigns from activityListener list \r\n\t\t\t\tif (definition.treatmentType === TreatmentType.Control) {\r\n\t\t\t\t\tdelete this.campaignDefinitions[definition.campaignId];\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Load and filter the campaigns definitions and states\r\n\t */\r\n\tprivate LoadFilterCampaignStates(currentDate: Date): void {\r\n\t\t// Load campaign state, filtering out the expired definitions\r\n\t\tconst loadedStates: ICampaignState[] = this.stateProvider.load();\r\n\t\tconst staleLoadedStates: ICampaignState[] = [];\r\n\r\n\t\tfor (const key in loadedStates) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(loadedStates, key)) {\r\n\t\t\t\tconst state: ICampaignState = loadedStates[key];\r\n\r\n\t\t\t\tif (!Object.prototype.hasOwnProperty.call(this.campaignDefinitions, state.CampaignId)) {\r\n\t\t\t\t\tstaleLoadedStates.push(state);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.campaignStates[state.CampaignId] = state;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\t * Stale State data cleanup\r\n\t\t * State needs to be cleaned up when:\r\n\t\t * 1) The campaign has expired\r\n\t\t * 2) The campaign is no longer present in the definitions (think ECS or other outages or very old expirations)\r\n\t\t *    In this case the state should still be cleaned up on it's reelection date\r\n\t\t * 3) When the user is out of scope (for an otherwise active campaign) and is up for nomination\r\n\r\n\t\t * This optimizes the user experience in case the campaign pops up or gets renewed when we would have preferred the user remain in cool down\r\n\r\n\t\t * 2&3 are basically the same, and 1 is a special case optimization on top of 2&3 for earlier clean up\r\n\r\n\t\t * To do 2 & 3, we just look at states with no matching definition (after filtering), and reject them if they are past their nomination period\r\n\t\t * To do 1, we just need to keep a list/hash of the definitions that we filtered out this load cycle, specifically for expiration dates, and bypass\r\n\t\t * the cool down \"wait\" for these specifically\r\n\r\n\t\t * For now, allowing some \"grace\" for \"missing\"/\"blippy\" campaign definitions (in case they pop in and out of ECS) by deferring missing\r\n\t\t * deletion by a delay-time specified by the original campaign.\r\n\t\t */\r\n\t\tfor (const key in staleLoadedStates) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(staleLoadedStates, key)) {\r\n\t\t\t\tconst state: ICampaignState = staleLoadedStates[key];\r\n\t\t\t\tif (!state) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst definition: ICampaignDefinition = this.campaignDefinitions[state.CampaignId];\r\n\t\t\t\tlet shouldRemove = false;\r\n\r\n\t\t\t\tif (!definition) {\r\n\t\t\t\t\tif (state.LastNominationTimeUtc\r\n\t\t\t\t\t\t.getTime() <= Utils.subtractSecondsWithoutOverflow(currentDate, state.DeleteAfterSecondsWhenStale).getTime()) {\r\n\t\t\t\t\t\tshouldRemove = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (CampaignManager.isStateUpForNomination(state, definition, currentDate, this.currentBuildNumber)) {\r\n\t\t\t\t\tshouldRemove = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// The next time we write to storage, these will be removed\r\n\t\t\t\tif (shouldRemove) {\r\n\t\t\t\t\tdelete this.campaignStates[state.CampaignId];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n", "/**\r\n * General floodgate settings\r\n */\r\nexport class FloodgateSettings {\r\n\t/**\r\n\t * Convert to Json\r\n\t */\r\n\tpublic static toJson(object: FloodgateSettings): string {\r\n\t\treturn JSON.stringify(object);\r\n\t}\r\n\r\n\t/**\r\n\t * Load from Json\r\n\t */\r\n\tpublic static fromJson(json: string): FloodgateSettings {\r\n\t\treturn JSON.parse(json);\r\n\t}\r\n}\r\n", "import { IActivityTrackingData, IActivityTrackingSet } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { IndexedTracker } from \"./IndexedTracker\";\r\n\r\n/**\r\n * Class to track ticks against a list of expected counts in a thread-safe way\r\n * Main API of interest is incrementActivity, which returns an enumerated value indicating\r\n * whether or not the increment resulted in no thresholds crossed, a single activity threshold crossed,\r\n * or the final activity threshold crossed.\r\n */\r\nclass ActivityTracker {\r\n\tprivate isOrdered: boolean;\r\n\tprivate trackedActivities: IActivityTrackingData[];\r\n\tprivate currentIndex: number;\r\n\tprivate activationMask: number;\r\n\tprivate currentActivationFlags: number;\r\n\tprivate isActivationByInitPending: boolean;\r\n\tprivate currentCounts: number[];\r\n\tprivate currentSessionCounts: number[];\r\n\tprivate currentStartTimes: Date[];\r\n\r\n\tpublic constructor(trackingSet: IActivityTrackingSet) {\r\n\t\tif (!trackingSet) {\r\n\t\t\tthrow new Error(\"trackingSet must not be null\");\r\n\t\t}\r\n\t\tif (trackingSet.getList().length > 32) {\r\n\t\t\tthrow new Error(\"trackingSet list size must be less than 32\");\r\n\t\t}\r\n\r\n\t\tthis.isOrdered = trackingSet.getIsOrdered();\r\n\t\tthis.trackedActivities = trackingSet.getList();\r\n\r\n\t\t/**\r\n\t\t * For ordered sets, the current index.\r\n\t\t */\r\n\t\tthis.currentIndex = 0;\r\n\t\tthis.activationMask = 0;\r\n\t\tthis.currentActivationFlags = 0;\r\n\t\tthis.isActivationByInitPending = false;\r\n\r\n\t\tthis.currentCounts = new Array<number>(this.trackedActivities.length);\r\n\t\tthis.currentStartTimes = new Array<Date>(this.trackedActivities.length);\r\n\t\tthis.currentSessionCounts = new Array<number>(this.trackedActivities.length);\r\n\r\n\t\tfor (let i = 0; i < this.trackedActivities.length; i++) {\r\n\t\t\tthis.currentCounts[i] = 0;\r\n\t\t\tthis.currentSessionCounts[i] = 0;\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < this.trackedActivities.length; i++) {\r\n\t\t\tthis.activationMask |= 0x1 << i;\r\n\r\n\t\t\tif (this.trackedActivities[i].getCount() < 1) {\r\n\t\t\t\tthis.trackedActivities[i].setCount(1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get the count for the activity at the specified index. Returns 0 for out-of-range indices\r\n\t *\r\n\t * @param index index\r\n\t */\r\n\tpublic getCount(index: number): number {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn this.currentCounts[index];\r\n\t}\r\n\r\n\t/**\r\n\t * Get the count for the activity at the specified index, as tracked only for this session.\r\n\t * Returns 0 for out-of-range indices\r\n\t *\r\n\t * @param index index\r\n\t */\r\n\tpublic getSessionCount(index: number): number {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn this.currentSessionCounts[index];\r\n\t}\r\n\r\n\t/**\r\n\t * Get the StartTime for the activity at the specified index. Returns null for out-of-range indices\r\n\t *\r\n\t * @param index index\r\n\t */\r\n\tpublic getStartTime(index: number): Date {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn this.currentStartTimes[index];\r\n\t}\r\n\r\n\t/**\r\n\t * A get-and-set method. Returns the current SessionCount, resetting it to zero and adding it into\r\n\t * the established baseline.\r\n\t *\r\n\t * @param index index\r\n\t */\r\n\tpublic moveSessionCountIntoBaseCount(index: number): number {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tconst sessionCount: number = this.currentSessionCounts[index];\r\n\t\tthis.currentSessionCounts[index] = 0;\r\n\r\n\t\treturn sessionCount;\r\n\t}\r\n\r\n\t/**\r\n\t * Forcibly set the counts for the activities in the trackingSet.\r\n\t * Unlike other APIs, this expects vector indices to match the order\r\n\t * of the ActivityTrackingSet.List initially used to construct this tracker.\r\n\t * (When data is copied from a different IndexedTracker, it will properly use the IndexedTracker.Index to query internals)\r\n\t * Note:\r\n\t * 1) Assumes a count of 0 for any missing index in undersized arrays.\r\n\t * 2) Respects and enforces ordered list initialization (i.e. all init values are ignored once a unfinished activity is\r\n\t * encountered in an ordered tracking list).\r\n\t * 3) If the tracker is fully Activated as a result of this call, the next call to IncrementActivity will raise the\r\n\t * IncrementEdgeResult.AllActivitiesActivated, for any valid index accepted by IsPermittedIndexForActivationByInit().\r\n\t */\r\n\tpublic initCounts(baselineCounts: number[], otherTrackers: IndexedTracker[], wasAlreadyActivatedThisSession = false): void {\r\n\t\t// NOTE: baselineIncrements and sessionIncrements are sorted the same as the initial trackedActivity set, which\r\n\t\t// for this class is the same as trackedActivities\r\n\r\n\t\tfor (let i = 0; i < this.trackedActivities.length; i++) {\r\n\t\t\t// Only accept values up to the current index, when ordered\r\n\t\t\tif (this.isOrdered && i > this.currentIndex) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// Start off by pulling values from this session\r\n\t\t\tif (i < otherTrackers.length && otherTrackers[i]) {\r\n\t\t\t\tthis.currentSessionCounts[i] = this.currentCounts[i] = otherTrackers[i].tracker.getSessionCount(otherTrackers[i].index);\r\n\t\t\t\tthis.currentStartTimes[i] = otherTrackers[i].tracker.getStartTime(otherTrackers[i].index);\r\n\t\t\t}\r\n\r\n\t\t\t// If we've got a baseline from previous sessions, add it in as well\r\n\t\t\tif (this.trackedActivities[i].getIsAggregate() && i < baselineCounts.length) {\r\n\t\t\t\tthis.currentCounts[i] += baselineCounts[i];\r\n\t\t\t}\r\n\r\n\t\t\tif (this.hasCountCrossedThreshold(i)) {\r\n\t\t\t\tthis.finishActivityAtIndex(i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.isActivated() && !wasAlreadyActivatedThisSession) {\r\n\t\t\t// Mark this object so that the next time any permitted activation event is logged, the survey will activate\r\n\t\t\tthis.isActivationByInitPending = true;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic generateActivityIndexList(): ActivityTracker.ActivityIndex[] {\r\n\t\tconst indexList = new Array<ActivityTracker.ActivityIndex>();\r\n\t\tfor (let i = 0; i < this.trackedActivities.length; i++) {\r\n\t\t\tconst current = new ActivityTracker.ActivityIndex();\r\n\t\t\tcurrent.activity = this.trackedActivities[i].getActivity();\r\n\t\t\tcurrent.index = i;\r\n\t\t\tindexList.push(current);\r\n\t\t}\r\n\r\n\t\treturn indexList;\r\n\t}\r\n\r\n\t/**\r\n\t * Increments the count at the specified index by the given increment.  Returns a value indicating whether\r\n\t * or not this call triggered a transition edge (activating the activity at 'index', or finishing the activation\r\n\t * of the final pending activity)\r\n\t */\r\n\tpublic incrementActivity(index: number, increment: number): ActivityTracker.IncrementResult {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn ActivityTracker.IncrementResult.Pending;\r\n\t\t}\r\n\r\n\t\tif (increment < 0) {\r\n\t\t\tthrow new Error(\"increment must be non-negative\");\r\n\t\t}\r\n\r\n\t\t// Ordered sets must be triggered in order.  We can only track at the current index, or before\r\n\t\tif (this.isOrdered && index > this.currentIndex) {\r\n\t\t\treturn ActivityTracker.IncrementResult.Pending;\r\n\t\t}\r\n\r\n\t\t// Add to our counts after storing off our current state\r\n\t\tconst startedLessThanThreshold = !this.hasCountCrossedThreshold(index);\r\n\t\tthis.currentCounts[index] += increment;\r\n\t\tthis.currentSessionCounts[index] += increment;\r\n\r\n\t\tif (this.isActivationByInitPending) {\r\n\t\t\tif (this.isPermittedIndexForActivationByInit(index)) {\r\n\t\t\t\t// This tracker was completed due to the initialization from previous increment data\r\n\t\t\t\t// now that we've store this activities increments, raise the AllActivitiesActivated signal\r\n\t\t\t\treturn this.commitActivation();\r\n\t\t\t} else {\r\n\t\t\t\t// Still waiting for a valid re-activation activity\r\n\t\t\t\treturn ActivityTracker.IncrementResult.Pending;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!(startedLessThanThreshold && this.hasCountCrossedThreshold(index))) {\r\n\t\t\t// Still waiting for this activity to finish\r\n\t\t\treturn ActivityTracker.IncrementResult.Pending;\r\n\t\t}\r\n\r\n\t\t// Mark this activity as complete in our flag collection\r\n\t\tthis.finishActivityAtIndex(index);\r\n\r\n\t\tif (this.isActivated()) {\r\n\t\t\treturn this.commitActivation();\r\n\t\t}\r\n\r\n\t\treturn ActivityTracker.IncrementResult.SingleActivityActivated;\r\n\t}\r\n\r\n\t/**\r\n\t * Explicitly sets a start timestamp (now if startTime is null) for the specified activity index. Overwrites any previous StartTime.\r\n\t */\r\n\tpublic startTime(index: number, startTime?: Date): void {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.currentStartTimes[index] = (!startTime) ? new Date() : startTime;\r\n\t}\r\n\r\n\t/**\r\n\t * Computes the \"count\" delta (delta in whatever units are appropriate for a subsequent call to IncrementActivity)\r\n\t * elapsed between now and a previously logged StartTime for this activity index.\r\n\t * Always clears the previous StartTime.\r\n\t * Returns 0 if no previous StartTime was logged, or if StartTime > StopTime\r\n\t */\r\n\tpublic stopTime(index: number, stopTime?: Date): number {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tconst startTime = this.currentStartTimes[index];\r\n\t\tthis.currentStartTimes[index] = null;\r\n\r\n\t\tif (!startTime) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tstopTime = (!stopTime) ? new Date() : stopTime;\r\n\t\tif (startTime > stopTime) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tconst deltaMS = stopTime.getTime() - startTime.getTime();\r\n\t\t// Currently all timer activities return seconds as the increment unit\r\n\t\tlet diff = deltaMS / 1000;\r\n\r\n\t\t// Adding 1ms to the count so it can have the decimal place\r\n\t\t// So that we can distinguish the Time activity\r\n\t\tif (diff % 1 === 0) {\r\n\t\t\tdiff += 0.001;\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if the index is valid for accessing the stored activity counts, false otherwise\r\n\t */\r\n\tpublic isValidIndex(index: number): boolean {\r\n\t\treturn index < this.trackedActivities.length;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets whether or not the full set of activities for this tracker have exceeded their trigger thresholds\r\n\t */\r\n\tpublic isActivated(): boolean {\r\n\t\treturn (this.currentActivationFlags & this.activationMask) === this.activationMask;\r\n\t}\r\n\r\n\t/**\r\n\t\t* Marks the activity at the index as finished. Includes setting the proper\r\n\t\t* activation flags and potentially advancing the current index for ordered tracking sets\r\n\t\t*/\r\n\tprivate finishActivityAtIndex(index: number): void {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\tthrow new Error(\"Index is not valid\");\r\n\t\t}\r\n\r\n\t\tthis.currentActivationFlags |= 0x1 << index;\r\n\r\n\t\tif (index + 1 < this.trackedActivities.length) {\r\n\t\t\tthis.currentIndex = index + 1;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param index index\r\n\t * @return true if the counts for the activity at the specified index have met or exceeded the threshold count.\r\n\t */\r\n\tprivate hasCountCrossedThreshold(index: number): boolean {\r\n\t\tif (!this.isValidIndex(index)) {\r\n\t\t\tthrow new Error(\"Index is not valid\");\r\n\t\t}\r\n\r\n\t\treturn this.currentCounts[index] >= this.trackedActivities[index].getCount();\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if the index refers to an activity that can re-activate a tracked object (aka return AllActivitiesActivated)\r\n\t * that was initialized as \"complete\" via initCounts.\r\n\t * Note: For unordered sets, any activity is valid. For ordered sequences, only the final activity is valid\r\n\t */\r\n\tprivate isPermittedIndexForActivationByInit(index: number): boolean {\r\n\t\treturn !this.isOrdered || ((index + 1) === this.currentCounts.length);\r\n\t}\r\n\r\n\tprivate commitActivation(): ActivityTracker.IncrementResult {\r\n\t\tthis.isActivationByInitPending = false;\r\n\t\treturn ActivityTracker.IncrementResult.AllActivitiesActivated;\r\n\t}\r\n}\r\n\r\nmodule ActivityTracker {\r\n\t/**\r\n\t * Structure returned by an ActivityTracker to call back into\r\n\t * IncrementActivity with valid index values\r\n\t */\r\n\texport class ActivityIndex {\r\n\t\tpublic activity: string;\r\n\t\tpublic index: number;\r\n\t}\r\n\r\n\texport const enum IncrementResult {\r\n\t\t/**\r\n\t\t * No thresholds crossed as a result of this increment operation\r\n\t\t */\r\n\t\tPending,\r\n\r\n\t\t/**\r\n\t\t * The threshold for the targeted activity index was crossed as a result of this increment operation\r\n\t\t */\r\n\t\tSingleActivityActivated,\r\n\r\n\t\t/**\r\n\t\t * The threshold for the targeted activity index was crossed as a result of this increment operation\r\n\t\t * and this was the final activity being tracked\r\n\t\t */\r\n\t\tAllActivitiesActivated,\r\n\t}\r\n}\r\n\r\nexport default ActivityTracker;\r\n", "import ActivityTracker from \"./ActivityTracker\";\r\n\r\nexport class IndexedTracker {\r\n\tpublic index: number;\r\n\tpublic surveyId: string;\r\n\tpublic tracker: ActivityTracker;\r\n}\r\n", "import {\r\n\tIActivityContext,\r\n\tIActivityListener,\r\n\tIActivityTrackingSet,\r\n\tIContextData,\r\n\tIDictionary,\r\n\tIFloodgateTelemetryLogger,\r\n\tISurvey,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport ActivityTracker from \"./ActivityTracker\";\r\nimport { ActivityTrackingContract } from \"./ActivityTrackingContract\";\r\nimport { TelemetryEvent } from \"./Constants\";\r\nimport { IndexedTracker } from \"./IndexedTracker\";\r\nimport { SurveyEventActivityStats, SurveyStatCollectionEventActivity } from \"./SurveyStatCollectionEventActivity\";\r\nimport { fyShuffle, isNOU } from \"./Utils\";\r\n\r\nlet queuedActivities: SurveyActivityListener.IQueuedActivityParams[] = [];\r\nlet pendingActivityCount = 0;\r\nlet previousTrackedActivityMap: { [id: string]: IndexedTracker[] } = {};\r\n\r\n/**\r\n * This class tracks log calls against named activity strings (matched on strict case-sensitive equality)\r\n * and calls the provided callback when all activity thresholds for a given survey have been crossed\r\n */\r\nclass SurveyActivityListener implements IActivityListener {\r\n\tpublic static FloodgateStartActivityName = \"FloodgateFirstStart\";\r\n\t// The size of the dropped activities is set to 100 due to the following two reasons.\r\n\t// 1) To prevent the array growing too big and causing memory issues.\r\n\t// 2) Based on the telemetry analysis of number of dropped activities, the count is very small and much lesser than 100.\r\n\tpublic static MaxPendingActivitiesQueueSize = 100;\r\n\r\n\tpublic static resetSessionActivity(): void {\r\n\t\tpreviousTrackedActivityMap = {};\r\n\t}\r\n\r\n\t// Save incoming activity context data in a dictionary with SurveyID as key, activity data array as value\r\n\tprivate activityContext: Record<string, IContextData[]> = {};\r\n\r\n\tprivate trackedActivityMap: { [id: string]: IndexedTracker[] };\r\n\tprivate callback: SurveyActivityListener.IActivityListenerCallback;\r\n\tprivate loggerCallback: () => IFloodgateTelemetryLogger;\r\n\r\n\tconstructor(callback: SurveyActivityListener.IActivityListenerCallback, loggerCallback?: () => IFloodgateTelemetryLogger) {\r\n\t\tif (!callback) {\r\n\t\t\tthrow new Error(\"callback must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.trackedActivityMap = {};\r\n\t\tthis.callback = callback;\r\n\t\tthis.loggerCallback = loggerCallback;\r\n\t}\r\n\r\n\tpublic logActivity(activityName: string, increment = 1, context?: IActivityContext): void {\r\n\t\tthis.logActivity_private(activityName, SurveyActivityListener.LogActionType.Increment, increment, null, context);\r\n\t}\r\n\r\n\tpublic logActivityStartTime(activityName: string, startTime?: Date): void {\r\n\t\tthis.logActivity_private(activityName, SurveyActivityListener.LogActionType.StartTime, 0, startTime, null);\r\n\t}\r\n\r\n\tpublic logActivityStopTime(activityName: string, stopTime?: Date): void {\r\n\t\tthis.logActivity_private(activityName, SurveyActivityListener.LogActionType.StopTime, 0, stopTime, null);\r\n\t}\r\n\r\n\tpublic SetActivityTrackingContracts(activityTrackingContracts: ActivityTrackingContract[],\r\n\t\tbaseline = new SurveyStatCollectionEventActivity()): void {\r\n\r\n\t\tlet duplicateCounter = 0;\r\n\r\n\t\tif (!activityTrackingContracts || activityTrackingContracts.length === 0 || !baseline) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Populate a new map based on the passed in surveys, but propagating and tracking activity counts\r\n\t\t// we may have seen against those events\r\n\t\t// NOTE: We will lose activity counts for survey events that are no longer relevant.\r\n\t\tconst newMap: { [id: string]: IndexedTracker[] } = {};\r\n\t\tconst trackedSurveyIds: string[] = [];\r\n\r\n\t\tfor (const activityTrackingContract of activityTrackingContracts) {\r\n\t\t\tconst trackingSet: IActivityTrackingSet = activityTrackingContract.trackingSet;\r\n\r\n\t\t\t// Added to the new set to make sure they are not duplicated. Based on MSO.\r\n\t\t\tif (trackedSurveyIds.indexOf(activityTrackingContract.surveyId) === -1) {\r\n\t\t\t\ttrackedSurveyIds.push(activityTrackingContract.surveyId);\r\n\t\t\t} else {\r\n\t\t\t\t// Duplicate surveyId being added, count it for the log.\r\n\t\t\t\tduplicateCounter++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// At this point, the survey's activities are safe to add.\r\n\t\t\t// Set up the structures we need to transfer baseline counts (from previous sessions) or current counts (from previous trackers)\r\n\t\t\t// Both vectors must be sorted in the same order as the trackingSet.List items\r\n\t\t\tconst baselineStats: SurveyEventActivityStats = baseline.getBySurveyId(activityTrackingContract.surveyId);\r\n\t\t\tconst baselineCounts: number[] = [trackingSet.getList().length];\r\n\t\t\tconst currentIndexedTrackers: IndexedTracker[] = new Array<IndexedTracker>(trackingSet.getList().length);\r\n\r\n\t\t\tlet currentBaselineIndex = 0;\r\n\t\t\tlet currentIndex = 0;\r\n\r\n\t\t\tfor (const trackingData of trackingSet.getList()) {\r\n\t\t\t\t// Baseline stats count is 0 for events with \"IsAggregate = false\"\r\n\t\t\t\tbaselineCounts[currentIndex] = 0;\r\n\t\t\t\tif (trackingData.getIsAggregate() && baselineStats && currentBaselineIndex < baselineStats.Counts.length) {\r\n\t\t\t\t\tbaselineCounts[currentIndex] = baselineStats.Counts[currentBaselineIndex++];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Session stats may be available in the previous trackedActivityMap\r\n\t\t\t\t// Transfer the old \"current session\" count to the new tracker\r\n\t\t\t\t// Is set to null if not available\r\n\t\t\t\tif (previousTrackedActivityMap[trackingData.getActivity()]) {\r\n\t\t\t\t\tfor (const tracker of previousTrackedActivityMap[trackingData.getActivity()]) {\r\n\t\t\t\t\t\tif (tracker.surveyId === activityTrackingContract.surveyId) {\r\n\t\t\t\t\t\t\tcurrentIndexedTrackers[currentIndex] = tracker;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrentIndex++;\r\n\t\t\t}\r\n\r\n\t\t\t// Make a new tracker and init the counts appropriately.\r\n\t\t\tconst newTracker = new ActivityTracker(trackingSet);\r\n\t\t\t// If in a future change we start keeping trackers registered past activation, this will change\r\n\t\t\tnewTracker.initCounts(baselineCounts, currentIndexedTrackers, false /*wasActivatedThisSession*/);\r\n\r\n\t\t\t// Setup the indexed trackers\r\n\t\t\tfor (const activityIndex of newTracker.generateActivityIndexList()) {\r\n\t\t\t\tconst indexedTracker = new IndexedTracker();\r\n\t\t\t\tindexedTracker.index = activityIndex.index;\r\n\t\t\t\tindexedTracker.surveyId = activityTrackingContract.surveyId;\r\n\t\t\t\tindexedTracker.tracker = newTracker;\r\n\r\n\t\t\t\tif (!newMap[activityIndex.activity]) {\r\n\t\t\t\t\tnewMap[activityIndex.activity] = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Register the new tracker in our new map\r\n\t\t\t\tnewMap[activityIndex.activity].push(indexedTracker);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (duplicateCounter > 0) {\r\n\t\t\tconst telemetryLogger = this.loggerCallback && this.loggerCallback();\r\n\t\t\tif (telemetryLogger) {\r\n\t\t\t\ttelemetryLogger.log_Error(TelemetryEvent.SurveyActivity.SetActivityTrackingContracts.DuplicateSurveyID,\r\n\t\t\t\t\t\"Duplicate surveyId passed in activityTrackingContracts. Duplicate count: \" + duplicateCounter);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Set the new map in place of the old\r\n\t\tthis.copyObject(this.trackedActivityMap, newMap);\r\n\t}\r\n\r\n\tpublic clearSurveys(): void {\r\n\t\tObject.getOwnPropertyNames(this.trackedActivityMap).forEach((key) => {\r\n\t\t\tdelete this.trackedActivityMap[key];\r\n\t\t});\r\n\t}\r\n\r\n\tpublic saveSessionTrackingActivity(activity: string): void {\r\n\t\t// Set the new activity in place of the old\r\n\t\tpreviousTrackedActivityMap[activity] = this.trackedActivityMap[activity];\r\n\t}\r\n\r\n\t// Get the indexedTracker that corresponds to the SurveyID and return that count. otherwise return 0.\r\n\tpublic getCount(activity: string, surveyId: string): number {\r\n\t\tconst indexedTracker = this.getIndexedTracker(activity, surveyId);\r\n\t\tif (!indexedTracker) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn indexedTracker.tracker.getCount(indexedTracker.index);\r\n\t}\r\n\r\n\tpublic getSessionCount(activity: string, surveyId: string): number {\r\n\t\tconst indexedTracker = this.getIndexedTracker(activity, surveyId);\r\n\t\tif (!indexedTracker) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn indexedTracker.tracker.getSessionCount(indexedTracker.index);\r\n\t}\r\n\r\n\t/**\r\n\t * An atomic get-and-set method.  Returns the current SessionCount, resetting it to zero and adding it into the established baseline\r\n\t */\r\n\tpublic moveSessionCountIntoBaseCount(activity: string, surveyId: string): number {\r\n\t\tconst indexedTracker = this.getIndexedTracker(activity, surveyId);\r\n\t\tif (!indexedTracker) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn indexedTracker.tracker.moveSessionCountIntoBaseCount(indexedTracker.index);\r\n\t}\r\n\r\n\tpublic getSurveyIds(activity: string): string[] | undefined {\r\n\t\tif (isNOU(activity)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tconst indexedTrackers = this.trackedActivityMap[activity];\r\n\t\tif (!indexedTrackers) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tconst surveyIds = indexedTrackers.map((indexedTracker) => indexedTracker.surveyId);\r\n\t\treturn surveyIds;\r\n\t}\r\n\r\n\tpublic setCallback(callback: SurveyActivityListener.IActivityListenerCallback): void {\r\n\t\tthis.callback = callback;\r\n\t}\r\n\r\n\tpublic UpdateActivityTrackingContracts(surveyList: IDictionary<ISurvey>): void {\r\n\t\tif (isNOU(surveyList) || Object.keys(surveyList).length === 0) {\r\n\t\t\tthis.clearSurveys();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (const key in this.trackedActivityMap) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.trackedActivityMap, key)) {\r\n\t\t\t\tconst tracker: IndexedTracker[] = this.trackedActivityMap[key];\r\n\r\n\t\t\t\t// loop through tracker and remove the ones not associate with given surveys\r\n\t\t\t\tfor (let i = tracker.length - 1; i >= 0; --i) {\r\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(surveyList, tracker[i].surveyId)) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttracker.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getIndexedTracker(activity: string, surveyId: string): IndexedTracker | undefined {\r\n\t\tconst indexedTrackers = this.trackedActivityMap[activity];\r\n\r\n\t\tif (!indexedTrackers) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tlet indexedTracker: IndexedTracker | undefined;\r\n\t\tfor (const tracker of indexedTrackers) {\r\n\t\t\tif (tracker.surveyId === surveyId) {\r\n\t\t\t\tindexedTracker = tracker;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn indexedTracker;\r\n\t}\r\n\r\n\tprivate resetQueuedActivities(): void {\r\n\t\tqueuedActivities = [];\r\n\t}\r\n\r\n\tprivate logActivity_private(activityName: string,\r\n\t\tlogType: SurveyActivityListener.LogActionType,\r\n\t\tincrement: number,\r\n\t\ttimestamp: Date,\r\n\t\tcontext: IActivityContext): void {\r\n\t\tif (this.callback && !this.callback.shouldAcceptActivity(activityName)) {\r\n\t\t\tpendingActivityCount++;\r\n\t\t\tif (queuedActivities.length < SurveyActivityListener.MaxPendingActivitiesQueueSize) {\r\n\t\t\t\tqueuedActivities.push({ activityName, logType, increment, timestamp });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Count any activities that are posted before 'FloodgateFirstStart' activity happens\r\n\t\tif (activityName === SurveyActivityListener.FloodgateStartActivityName) {\r\n\t\t\tif (pendingActivityCount > 0) {\r\n\t\t\t\t// Get the activity names of the queued activities for telemetry, send only first 25.\r\n\t\t\t\tconst activityNames = queuedActivities.slice(0, 25).map((queuedActivity) => queuedActivity.activityName);\r\n\r\n\t\t\t\tconst telemetryLogger = this.loggerCallback && this.loggerCallback();\r\n\t\t\t\tif (telemetryLogger) {\r\n\t\t\t\t\t// Sampling this telemetry event to 5%\r\n\t\t\t\t\ttelemetryLogger.log_Event(TelemetryEvent.SurveyActivity.LogActivity.EventsReprocessed,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tActivityNames: JSON.stringify(activityNames),\r\n\t\t\t\t\t\t\tCount: queuedActivities.length,\r\n\t\t\t\t\t\t\tDropped: pendingActivityCount - queuedActivities.length,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t0.05);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// replay all the queued activities one by one as the floodgate engine has started now\r\n\t\t\t\tqueuedActivities.map((queuedActivity) => this.logActivity_core(\r\n\t\t\t\t\tqueuedActivity.activityName, queuedActivity.logType, queuedActivity.increment, queuedActivity.timestamp, context));\r\n\t\t\t}\r\n\r\n\t\t\tpendingActivityCount = 0;\r\n\t\t\tthis.resetQueuedActivities();\r\n\t\t}\r\n\r\n\t\tthis.logActivity_core(activityName, logType, increment, timestamp, context);\r\n\t}\r\n\r\n\tprivate logActivity_core(activityName: string,\r\n\t\tlogType: SurveyActivityListener.LogActionType,\r\n\t\tincrement: number,\r\n\t\ttimestamp: Date,\r\n\t\tcontext: IActivityContext): void {\r\n\t\tconst indexedTrackers: IndexedTracker[] = this.trackedActivityMap[activityName];\r\n\t\tif (!indexedTrackers || indexedTrackers.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet indices: number[] = [];\r\n\r\n\t\t// If we have more than one tracker shuffle trackers to randomize which is evaluated first\r\n\t\tif (indexedTrackers.length > 1) {\r\n\t\t\tindices = new Array<number>(indexedTrackers.length);\r\n\t\t\tfor (let i = 0; i < indices.length; i++) {\r\n\t\t\t\tindices[i] = i;\r\n\t\t\t}\r\n\t\t\tindices = fyShuffle(indices); // shuffle and reassign\r\n\t\t} else {\r\n\t\t\tindices.push(0); // just have a zero. Shuffling is not needed.\r\n\t\t}\r\n\r\n\t\t// Loop through trackers in shuffled order\r\n\t\tfor (const index of indices) {\r\n\t\t\tconst tracker: IndexedTracker = indexedTrackers[index];\r\n\t\t\tswitch (logType) {\r\n\t\t\t\tcase SurveyActivityListener.LogActionType.StartTime: {\r\n\t\t\t\t\ttracker.tracker.startTime(tracker.index, timestamp);\r\n\t\t\t\t\tcontinue; // Look at the next tracker. Increment not needed.\r\n\t\t\t\t}\r\n\t\t\t\tcase SurveyActivityListener.LogActionType.StopTime: {\r\n\t\t\t\t\tincrement = tracker.tracker.stopTime(tracker.index, timestamp);\r\n\t\t\t\t\t// fall through to increment the activity as well.\r\n\t\t\t\t}\r\n\t\t\t\tcase SurveyActivityListener.LogActionType.Increment: {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault: {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (context) {\r\n\t\t\t\tconst trackerSurveyId = tracker.surveyId;\r\n\t\t\t\tthis.activityContext[trackerSurveyId] = this.activityContext[trackerSurveyId] || [];\r\n\t\t\t\tthis.activityContext[trackerSurveyId].push({ activityName, context });\r\n\t\t\t}\r\n\r\n\t\t\tconst result: ActivityTracker.IncrementResult = tracker.tracker.incrementActivity(tracker.index, increment);\r\n\t\t\tif (result === ActivityTracker.IncrementResult.AllActivitiesActivated) {\r\n\t\t\t\t// Check the activated surveys list to ensure whether any previous survey is still in process\r\n\t\t\t\t// If not, the length should be 1 and call to execute this survey right away\r\n\t\t\t\t// This should only happen if calling to Governance Service, due to the call is asynchronous\r\n\t\t\t\tthis.executeCallback(tracker.surveyId);\r\n\t\t\t\tbreak;\r\n\t\t\t\t/* Breaking here to let one and only one callback to be made from a logActivity call.\r\n\t\t\t\tThis ensures only one survey can fully 'trigger' for a logActivity call. Others that would also\r\n\t\t\t\thave triggered must wait until the next call to trigger (without there being a cooldown, of course).\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate executeCallback(surveyId: string): void {\r\n\t\tthis.callback.run(surveyId, this.activityContext[surveyId]);\r\n\t}\r\n\r\n\tprivate copyObject(target: object, source: object) {\r\n\t\tObject.keys(source).forEach((key) => {\r\n\t\t\ttarget[key] = source[key];\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule SurveyActivityListener {\r\n\texport interface IActivityListenerCallback {\r\n\t\trun(surveyId: string, contextData: IContextData[]): void;\r\n\t\tshouldAcceptActivity(activityName: string): boolean;\r\n\t}\r\n\r\n\texport const enum LogActionType {\r\n\t\tIncrement,\r\n\t\tStartTime,\r\n\t\tStopTime,\r\n\t}\r\n\r\n\texport interface IQueuedActivityParams {\r\n\t\tactivityName: string;\r\n\t\tlogType: SurveyActivityListener.LogActionType;\r\n\t\tincrement: number;\r\n\t\ttimestamp: Date;\r\n\t}\r\n}\r\n\r\nexport default SurveyActivityListener;\r\n", "import { TelemetryEvent } from \"../Constants\";\r\nimport { guid } from \"../Utils\";\r\nimport { TelemetryLogger } from \"../TelemetryLogger\";\r\n\r\nconst HTTP_TRANSPORT_DEFAULT_TIMEOUT = 5000; // default timeout for fetching\r\n\r\n/**\r\n * This class is the client to perform http request\r\n * It supports retry and timeout if needed.\r\n */\r\nexport class HttpTransport {\r\n\tpublic requestId: string;\r\n\t\r\n\t/**\r\n\t * Perform the GET request\r\n\t * @param requestUrl request URL\r\n\t * @param retry maximum retry if failure. For example: 0 means no retry and 1 means retry once if failed\r\n\t * @param timeout Timeout of the request\r\n\t * @param simpleRequestEnabled Simple request if this is true\r\n\t * @returns the response if success. Otherwise, reject with error\r\n\t */\r\n\tpublic getRequestWithRetry(requestUrl: string, retry: number, timeout: number, simpleRequestEnabled = false): Promise<Response> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet timeBefore = performance.now();\r\n\t\t\tthis.sendGetRequest(requestUrl, true, timeout, simpleRequestEnabled)\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconst serviceCallTime = performance.now() - timeBefore;\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.HttpTransport.GET.Success,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\t\tCount: retry,\r\n\t\t\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\t\t\tRequestUrl: requestUrl,\r\n\t\t\t\t\t\t\tCorrelationId: this.requestId,\r\n\t\t\t\t\t\t\tTimeout: timeout,\r\n\t\t\t\t\t\t\tSimpleRequestEnabled: simpleRequestEnabled,\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t});\r\n\t\t\t\tresolve(response);\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tconst serviceCallTime = performance.now() - timeBefore;\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\t\tTelemetryEvent.HttpTransport.GET.Error,\r\n\t\t\t\t\tJSON.stringify({\r\n\t\t\t\t\t\tErrorMessage: error.toString(),\r\n\t\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\t\tTimeout: timeout,\r\n\t\t\t\t\t\tCount: retry,\r\n\t\t\t\t\t\tCorrelationId: this.requestId,\r\n\t\t\t\t\t\tMessage: requestUrl,\r\n\t\t\t\t\t\tSimpleRequestEnabled: simpleRequestEnabled,\r\n\t\t\t\t\t}),\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (retry <= 1) {\r\n\t\t\t\t\treturn reject(error);\r\n\t\t\t\t}\r\n\t\t\t\ttimeBefore = performance.now();\r\n\t\t\t\tthis.getRequestWithRetry(requestUrl, retry - 1, timeout, simpleRequestEnabled)\r\n\t\t\t\t.then(resolve)\r\n\t\t\t\t.catch(reject);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate createHeaders(simpleRequestEnabled: boolean): Headers {\r\n\t\tconst headers: Headers = typeof Headers !== \"undefined\" && new Headers();\r\n\r\n\t\tif (headers) {\r\n\t\t\t// Create header based on the request\r\n\t\t\tif (simpleRequestEnabled) {\r\n\t\t\t\tthis.createSimpleHeaders(headers);\r\n\t\t\t} else {\r\n\t\t\t\tthis.createNormalHeaders(headers);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn headers;\r\n\t}\r\n\r\n\tprivate createNormalHeaders(headers: Headers) {\r\n\t\tthis.requestId = guid();\r\n\t\theaders.append(\"X-Request-ID\", this.requestId);\r\n\t\theaders.append(\"Content-Type\", \"application/json\");\r\n\t}\r\n\r\n\tprivate createSimpleHeaders(headers: Headers) {\r\n\t\tthis.requestId = guid();\r\n\t\theaders.append(\"Content-Type\", \"text/plain\");\r\n\t}\r\n\r\n\tpublic async sendGetRequest(requestUrl: string, useTimeout?: boolean, timeout?: number, simpleRequestEnabled?: boolean): Promise<Response> {\r\n\t\tconst requestInit = {\r\n\t\t\tmethod: \"GET\",\r\n\t\t\theaders: this.createHeaders(simpleRequestEnabled),\r\n\t\t};\r\n\r\n\t\treturn useTimeout ?\r\n\t\t\tthis.timeoutFetch(requestUrl, requestInit, timeout ?? HTTP_TRANSPORT_DEFAULT_TIMEOUT) :\r\n\t\t\tfetch(requestUrl, requestInit);\r\n\t}\r\n\t\r\n\tprivate timeoutFetch(input: RequestInfo, init: RequestInit = {}, timeout: number): Promise<Response> {\r\n\t\tconst controller = new AbortController();\r\n\t\tinit.signal = controller.signal;\r\n\t\t// Reject after timeout\r\n\t\tconst timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\t\treturn fetch(input, init).then(response => {\r\n\t\t\tclearTimeout(timeoutId);\r\n\t\t\treturn response;\r\n\t\t});\r\n\t}\r\n}\r\n", "/**\r\n * Implementation of IFloodgateStringProvider for Web SDK\r\n */\r\n\r\nimport {\r\n\tApi,\r\n\tBranchingRule,\r\n\tBranchingTargetOverride,\r\n\tBranchingTargetType,\r\n\tIUxSchema,\r\n\tIUxSchemaPage,\r\n\tOverridePropertiesType,\r\n\tQuestion,\r\n\tQuestionType\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { isNOU } from \"../Utils\";\r\nimport { HttpTransport } from \"../Transport/HttpTransport\";\r\nimport { TelemetryEvent } from \"../Constants\";\r\nimport { TelemetryLogger } from \"../TelemetryLogger\";\r\n\r\ninterface UiStringsMap {\r\n\t[key:string]: string\r\n}\r\n\r\nexport function isTranslationRequired(survey: Api.ISurvey, locale: string): boolean {\r\n\tconst currentLocale = locale?.toLowerCase() || 'en-us';\r\n\treturn survey.getUxSchema()?.uiStringsUrl && \r\n\t\t(currentLocale != 'en-us' && currentLocale != 'en');\r\n}\r\n\r\n/**\r\n * This class is the client to query the CDN from the given survey UxSchema if required\r\n * The survey UxSchema will be translated into the given locale\r\n */\r\nexport default class FloodgateSurveyCdnClient {\r\n\tpublic timeout: number;\r\n\tpublic retryLimit: number;\r\n\tpublic simpleRequestEnabled: boolean;\r\n\t\r\n\tconstructor(uiStringsLoadingTimeout: number, retryLimit: number, simpleRequestEnabled = false) {\r\n\t\tthis.timeout = uiStringsLoadingTimeout;\r\n\t\tthis.retryLimit = retryLimit;\r\n\t\tthis.simpleRequestEnabled = simpleRequestEnabled;\r\n\t}\r\n\r\n\t/**\r\n\t * The function to translate the given survey UxSchema into the given locale\r\n\t * If the CDN is failed or UxSchema is failed in translation, the UxSchema will be reset to null\r\n\t * In case of failure, it can possible returns success if the legacy Content is valid.\r\n\t * @returns true if success. Otherwise, false.\r\n\t */\r\n\tpublic async loadCdnStringResource(survey: Api.ISurvey, locale: string): Promise<boolean> {\r\n\t\tconst requestUrl: string = survey.getUxSchema().uiStringsUrl + locale + \"/strings.json\";\r\n\t\tconst httpTransport = new HttpTransport();\r\n\t\tlet success = false;\r\n\t\tlet response: Response;\r\n\t\tlet serviceCallTime: number;\r\n\r\n\t\t// Survey CDN is not enabled, assume it's good\r\n\t\tif (!isTranslationRequired(survey, locale)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst timeBefore = performance.now();\r\n\t\t\tresponse = await httpTransport.getRequestWithRetry(requestUrl, this.retryLimit, this.timeout, this.simpleRequestEnabled);\r\n\t\t\tserviceCallTime = performance.now() - timeBefore;\r\n\r\n\t\t\tif (response.ok) {\r\n\t\t\t\t// Get the response text\r\n\t\t\t\tconst responseText = await response.text();\r\n\r\n\t\t\t\t// Log the successful post criteria with time\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateSurveyCdnClient.loadCdnStringResource.Request_Success,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\t\t\tMessage: JSON.stringify({ \r\n\t\t\t\t\t\t\tRequestUrl: requestUrl,\r\n\t\t\t\t\t\t\tHttpStatusCode: response.status,\r\n\t\t\t\t\t\t\tHttpStatusText: response.statusText,\r\n\t\t\t\t\t\t\tSimpleRequestEnabled: this.simpleRequestEnabled,\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t// Parse the response\r\n\t\t\t\tconst jsonResponse: UiStringsMap = JSON.parse(responseText);\r\n\t\t\t\t\r\n\t\t\t\t// Translating the UxSchema\r\n\t\t\t\t// This function should throw error if there is any issue\r\n\t\t\t\tawait this.translateSurveyUxSchema(survey, jsonResponse);\r\n\r\n\t\t\t\tsuccess = true;\r\n\t\t\t} else {\r\n\t\t\t\t// Log the error with response\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateSurveyCdnClient.loadCdnStringResource.Request_Failed,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\t\t\tMessage: JSON.stringify({ \r\n\t\t\t\t\t\t\tRequestUrl: requestUrl,\r\n\t\t\t\t\t\t\tHttpStatusCode: response.status,\r\n\t\t\t\t\t\t\tHttpStatusText: response.statusText,\r\n\t\t\t\t\t\t\tSimpleRequestEnabled: this.simpleRequestEnabled,\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// Done\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateSurveyCdnClient.loadCdnStringResource.Exception,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: e && e.toString(),\r\n\t\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\t\tMessage: JSON.stringify({ \r\n\t\t\t\t\t\tRequestUrl: requestUrl,\r\n\t\t\t\t\t\tHttpStatusCode: response?.status,\r\n\t\t\t\t\t\tHttpStatusText: response?.statusText,\r\n\t\t\t\t\t\tSimpleRequestEnabled: this.simpleRequestEnabled,\r\n\t\t\t\t\t}),\r\n\t\t\t\t});\r\n\t\t}\r\n\r\n\t\t// In case of failure, we allow fallback if there is valid Content\r\n\t\tif (!success) {\r\n\t\t\t// Set the UxSchema to null so we fallback to Content\r\n\t\t\tsurvey.setUxSchema(null);\r\n\t\t\tif (survey.isContentValid()) {\r\n\t\t\t\tsuccess = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateSurveyCdnClient.loadCdnStringResource.Completed,\r\n\t\t\t{\r\n\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\tSuccess: success,\r\n\t\t\t\t\tIsContentValid: survey.isContentValid(),\r\n\t\t\t\t\tIsUxSchemaPresent: !isNOU(survey.getUxSchema())\r\n\t\t\t\t}),\r\n\t\t\t});\r\n\r\n\t\treturn success;\r\n\t}\r\n\r\n\t/**\r\n\t * This function translates the given uxSchema in the parameter\r\n\t * This is destructive function since it will create a new translated UxSchema and set the new one to given survey.\r\n\t * However, the original UxSchema won't be changed and stay the same with orginal strings.\r\n\t * Important note: the original UxSchema is shallow copied from Campaign Definition, so any change to it will affect the original\r\n\t * Campaign Definition as well. Therefore, we should not changing the UxSchema if not needed.\r\n\t * If there is issue in translation, it will throw Error\r\n\t * @param survey survey with UxSchema to be translated\r\n\t * @param uiStringMap dictionary contains locale strings\r\n\t*/\r\n\tpublic async translateSurveyUxSchema(survey: Api.ISurvey, uiStringMap: UiStringsMap): Promise<void> {\r\n\t\tconst uxSchema = survey.getUxSchema();\r\n\t\tconst promiseList = [];\r\n\t\tconst errorList = [];\r\n\r\n\t\t// Using spread copy to create a new `uxSchema` and `pages` reference\r\n\t\t// then we can deep copy the inner fields as neccesary without changing the original object\r\n\t\t// Any other fields that we don't modify, they can be reused by spread copy\r\n\t\tconst translatedResult: IUxSchema = {...uxSchema};\r\n\t\ttranslatedResult.pages = [...uxSchema.pages];\r\n\r\n\t\t// translate the pages\r\n\t\tfor (let index = 0; index < uxSchema.pages.length; index++) {\r\n\t\t\tpromiseList.push(\r\n\t\t\t\tthis.translatePage(uiStringMap, uxSchema.pages[index], `page.${index}`, errorList)\r\n\t\t\t\t.then((result) => {\r\n\t\t\t\t\ttranslatedResult.pages[index] = result;\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// translate the branching rule if possible\r\n\t\tif (uxSchema.branchingRules && uxSchema.branchingRules.length > 0) {\r\n\t\t\tconst translatedRules = translatedResult.branchingRules = [];\r\n\t\t\tfor (let indexRule = 0; indexRule < uxSchema.branchingRules.length; indexRule++) {\r\n\t\t\t\tconst rule = uxSchema.branchingRules[indexRule];\r\n\r\n\t\t\t\t// Create deep copy the rule object so that we can translate the targets without changing the original rule\r\n\t\t\t\tconst translatedRule: BranchingRule = {\r\n\t\t\t\t\tconditions: rule.conditions,\r\n\t\t\t\t\ttargets: [...rule.targets]\r\n\t\t\t\t};\r\n\t\t\t\ttranslatedRules.push(translatedRule);\r\n\r\n\t\t\t\t// Translate the targets if possible\r\n\t\t\t\tif (rule.targets && rule.targets.length > 0) {\r\n\t\t\t\t\tfor (let index = 0; index < rule.targets.length; index++) {\r\n\t\t\t\t\t\tconst target = rule.targets[index];\r\n\r\n\t\t\t\t\t\t// translate the TargetOverride if possible\r\n\t\t\t\t\t\tif (target.type === BranchingTargetType.Override) {\r\n\t\t\t\t\t\t\t// Using spread copy to create a new `target` reference\r\n\t\t\t\t\t\t\t// then we can deep copy the inner fields as neccesary without changing the original object\r\n\t\t\t\t\t\t\t// Any other fields that we don't modify, they can be reused by spread copy\r\n\t\t\t\t\t\t\tconst translatedTarget: BranchingTargetOverride = {...target};\r\n\t\t\t\t\t\t\ttranslatedRule.targets[index] = translatedTarget;\r\n\t\t\t\t\t\t\tconst overrideTargetQuestion = uxSchema.pages[target.targetPageIndex].questions.find(question =>\r\n\t\t\t\t\t\t\t\tquestion.id === target.targetOverrideId);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\t\t\tthis.translateQuestion(\r\n\t\t\t\t\t\t\t\t\tuiStringMap,\r\n\t\t\t\t\t\t\t\t\ttarget.overrideProperties,\r\n\t\t\t\t\t\t\t\t\toverrideTargetQuestion.type,\r\n\t\t\t\t\t\t\t\t\t`branchingRules.${indexRule}.targets.${index}`,\r\n\t\t\t\t\t\t\t\t\terrorList)\r\n\t\t\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\t\t\ttranslatedTarget.overrideProperties = result as OverridePropertiesType;\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait Promise.all(promiseList);\r\n\r\n\t\tif (errorList.length > 0) {\r\n\t\t\tthrow new Error(JSON.stringify(errorList));\r\n\t\t}\r\n\r\n\t\t// Finally, set the new translated schema\r\n\t\tsurvey.setUxSchema(translatedResult);\r\n\r\n\t\treturn;\r\n\t}\r\n\r\n\t/**\r\n\t * Translate the given page, and putting error into errorList if there is any\r\n\t*/\r\n\tprivate translatePage(uiStringMap: UiStringsMap, schemaPage: IUxSchemaPage, pageKey: string, errorList: string[]): Promise<IUxSchemaPage> {\r\n\t\tconst promiseList = [];\r\n\t\tconst translatedResult: IUxSchemaPage = {...schemaPage};\r\n\r\n\t\t// Using spread copy to create a new `questions` reference\r\n\t\t// then we can deep copy the inner fields as neccesary without changing the original object\r\n\t\t// Any other fields that we don't modify, they can be reused by spread copy\r\n\t\ttranslatedResult.questions = [...schemaPage.questions];\r\n\t\t// title is optional\r\n\t\tif (schemaPage.title) {\r\n\t\t\tpromiseList.push(\r\n\t\t\t\tthis.translateString(uiStringMap, schemaPage.title, `${pageKey}.title`, errorList)\r\n\t\t\t\t.then((result) => {\r\n\t\t\t\t\ttranslatedResult['title'] = result;\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tfor (let index = 0; index < schemaPage.questions.length; index++) {\r\n\t\t\tpromiseList.push(\r\n\t\t\t\tthis.translateQuestion(uiStringMap, schemaPage.questions[index], schemaPage.questions[index].type, `${pageKey}.questions.${index}`, errorList)\r\n\t\t\t\t.then((result) => {\r\n\t\t\t\t\ttranslatedResult.questions[index] = result as Question;\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn Promise.all(promiseList).then(() => translatedResult);\r\n\t}\r\n\r\n\t/**\r\n\t * Translate the given string, and putting error into errorList if there is any\r\n\t*/\r\n\tprivate translateQuestion(\r\n\t\tuiStringMap: UiStringsMap,\r\n\t\ttranslateObject: Question | OverridePropertiesType,\r\n\t\tquestionType: QuestionType,\r\n\t\tquestionKey: string,\r\n\t\terrorList: string[]\r\n\t\t): Promise<Question | OverridePropertiesType> {\r\n\t\tconst promiseList = [];\r\n\r\n\t\t// Using spread copy to create a new object reference\r\n\t\t// then we can deep copy the inner object fields as neccesary without changing the original object\r\n\t\t// Any other fields that we don't modify, they can be reused by spread copy\r\n\t\tconst translatedResult = {...translateObject};\r\n\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"questionLabel\")) {\r\n\t\t\tpromiseList.push(\r\n\t\t\t\tthis.translateString(uiStringMap, translateObject.questionLabel as string, `${questionKey}.questionLabel`, errorList)\r\n\t\t\t\t.then((result) => {\r\n\t\t\t\t\ttranslatedResult['questionLabel'] = result;\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tswitch (questionType) {\r\n\t\t\tcase QuestionType.MultipleChoice: \r\n\t\t\tcase QuestionType.SingleSelect: {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"availableOptions\")) {\r\n\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\tthis.translateStringArray(uiStringMap, translateObject[\"availableOptions\"] as string[],`${questionKey}.availableOptions`, errorList)\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\ttranslatedResult['availableOptions'] = result;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase QuestionType.Rating: {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"ratingValues\")) {\r\n\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\tthis.translateStringArray(uiStringMap, translateObject[\"ratingValues\"] as string[], `${questionKey}.ratingValues`, errorList)\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\ttranslatedResult['ratingValues'] = result;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"leftLegendValue\")) {\r\n\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\tthis.translateString(uiStringMap, translateObject[\"leftLegendValue\"] as string, `${questionKey}.leftLegendValue`, errorList)\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\ttranslatedResult[\"leftLegendValue\"] = result;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"rightLegendValue\")) {\r\n\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\tthis.translateString(uiStringMap, translateObject[\"rightLegendValue\"] as string, `${questionKey}.rightLegendValue`, errorList)\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\ttranslatedResult[\"rightLegendValue\"] = result;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase QuestionType.Likert: {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"verticalOptions\")) {\r\n\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\tthis.translateStringArray(uiStringMap, translateObject[\"verticalOptions\"] as string[], `${questionKey}.verticalOptions`, errorList)\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\ttranslatedResult['verticalOptions'] = result;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(translateObject, \"horizontalStatements\")) {\r\n\t\t\t\t\tpromiseList.push(\r\n\t\t\t\t\t\tthis.translateStringArray(\r\n\t\t\t\t\t\t\tuiStringMap,\r\n\t\t\t\t\t\t\ttranslateObject[\"horizontalStatements\"] as string[],\r\n\t\t\t\t\t\t\t`${questionKey}.horizontalStatements`,\r\n\t\t\t\t\t\t\terrorList)\r\n\t\t\t\t\t\t.then((result) => {\r\n\t\t\t\t\t\t\ttranslatedResult['horizontalStatements'] = result;\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase QuestionType.Comment:\r\n\t\t\tcase QuestionType.Label:\r\n\t\t\t\t// Nothing special for Comment, Label question\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// unknown type\r\n\t\t\t\terrorList.push(`${questionKey}.questionType is unknown.`);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn Promise.all(promiseList).then(() => translatedResult);\r\n\t}\r\n\r\n\t/**\r\n\t * Translate the given string array, and putting error into errorList if there is any\r\n\t*/\r\n\tprivate translateStringArray(uiStringMap: UiStringsMap, stringArray: string[], keyArray: string, errorList: string[]): Promise<string[]> {\r\n\t\tconst promiseList: Promise<string>[] = [];\r\n\t\tfor (let index = 0; index < stringArray.length; index++) {\r\n\t\t\tpromiseList.push(\r\n\t\t\t\tthis.translateString(uiStringMap, stringArray[index], `${keyArray}.${index}`, errorList)\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn Promise.all(promiseList).then((result)=>result);\r\n\t}\r\n\r\n\t/**\r\n\t * Translate the given string, and putting error into errorList if there is any\r\n\t * @returns empty string if failure. Otherwise, return locale string on success.\r\n\t*/\r\n\tprivate translateString(uiStringMap: UiStringsMap, translatedString: string, keyString: string, errorList: string[]): Promise<string> {\r\n\t\t// reject is not used here to prevent the Promise.all to fail fast \r\n\t\treturn new Promise((resolve, _reject) => {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(uiStringMap, translatedString)) {\r\n\t\t\t\tresolve(uiStringMap[translatedString]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\terrorList.push(`'${keyString}: ${translatedString}' does not exist in the strings map.`);\r\n\t\t\t\tresolve('');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n", "import {\r\n\tGovernedChannelType,\r\n\tIGovernanceParameters,\r\n\tIGovernanceServiceResult,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { IAppGovernanceCampaignForm } from \"@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IAppGovernanceProvider\";\r\n\r\nexport enum GovernanceDecision {\r\n\tApproved,\r\n\tRejected,\r\n\tError\r\n}\r\n\r\nexport interface IGovernanceDecision {\r\n\tgovernanceDecision: GovernanceDecision;\r\n\tserviceResult?: IGovernanceServiceResult;\r\n}\r\n\r\nexport enum CampaignBusinessLevel {\r\n\tNone = 0,\r\n\tCritical = 1\r\n}\r\n\r\nexport interface IOrchestrationEngine {\r\n\tgetDecision(businessLevel: CampaignBusinessLevel, governanceParams: IGovernanceParameters): Promise<IGovernanceDecision>;\r\n\tisSurveyTrackable(campaignForm: IAppGovernanceCampaignForm): boolean;\r\n\tgetAvailableChannels(): GovernedChannelType[];\r\n\tmergeAndSave(): void;\r\n\r\n\tstartChannelCooldown(channelType: GovernedChannelType, dateTime?: Date): void\r\n\r\n\tisChannelOpen(type: GovernedChannelType, refreshData?: boolean): boolean;\r\n\tisChannelGovernanceEnabled(governedChannelType: GovernedChannelType): boolean;\r\n\r\n\tshouldForcePermission(): boolean;\r\n\tgetStateForTelemetry(): any;\r\n}\r\n", "import { GovernedChannelType, IGovernedChannelData } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Utils from \"./Utils\";\r\n\r\nexport class GovernedChannel implements IGovernedChannelData {\r\n\tprivate type: GovernedChannelType;\r\n\tprivate name: string;\r\n\tprivate cooldownSeconds: number;\r\n\tprivate cooldownStartTime: Date;\r\n\tprivate cooldownEndTime: Date;\r\n\r\n\tpublic constructor(type: GovernedChannelType, name: string, cooldownSeconds: number, cooldownStartTime: Date) {\r\n\t\tif (!Utils.isEnumValue(type, GovernedChannelType)) {\r\n\t\t\tthrow new Error(\"type is not a valid GovernedChannelType\");\r\n\t\t}\r\n\r\n\t\tif (!name) {\r\n\t\t\tthrow new Error(\"name must not be null or empty\");\r\n\t\t}\r\n\r\n\t\tif (cooldownSeconds < 0) {\r\n\t\t\tthrow new Error(\"cooldownSeconds must not be negative\");\r\n\t\t}\r\n\r\n\t\tthis.type = type;\r\n\t\tthis.name = name;\r\n\t\tthis.cooldownSeconds = cooldownSeconds;\r\n\t\tthis.setCooldownStartTime(cooldownStartTime);\r\n\t}\r\n\r\n\tpublic setCooldownStartTime(cooldownStartTime: Date): void {\r\n\t\t// Set the start time\r\n\t\tthis.cooldownStartTime = cooldownStartTime;\r\n\r\n\t\tif (Utils.isNOU(this.cooldownStartTime)) {\r\n\t\t\t// Null cooldownStartTime means cool down has never been initiated, so set the cooldownEndTime to distant past\r\n\t\t\tthis.cooldownEndTime = Utils.getDistantPast();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Calculate the end time, but don't overflow past max.\r\n\t\tthis.cooldownEndTime = Utils.addSecondsWithoutOverflow(this.cooldownStartTime, this.cooldownSeconds);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isOpen(): boolean {\r\n\t\treturn this.isOpenAtDate(new Date());\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isOpenAtDate(date: Date): boolean {\r\n\t\tif (!date) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn (date > this.cooldownEndTime);\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getType(): GovernedChannelType {\r\n\t\treturn this.type;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getName(): string {\r\n\t\treturn this.name;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCooldownSeconds(): number {\r\n\t\treturn this.cooldownSeconds;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCooldownStartTime(): Date {\r\n\t\treturn this.cooldownStartTime;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getCooldownEndTime(): Date {\r\n\t\treturn this.cooldownEndTime;\r\n\t}\r\n}\r\n", "import { GovernedChannelType, IGovernedChannelData } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { GovernedChannel } from \"./GovernedChannel\";\r\nimport { GovernedChannelState, IGovernedChannelStateProvider } from \"./GovernedChannelStateProvider\";\r\nimport * as Utils from \"./Utils\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nexport interface IGovernor {\r\n\tgetAvailableChannelData(): IGovernedChannelData[];\r\n\r\n\tisChannelOpen(type: GovernedChannelType): boolean;\r\n\r\n\tstartChannelCooldown(type: GovernedChannelType, date?: Date): void;\r\n\r\n\trefreshChannelData(): void;\r\n\r\n\tsaveChannelStates(): void;\r\n}\r\n\r\nclass DefaultChannelData {\r\n\tpublic cooldownSeconds: number;\r\n\tpublic name: string;\r\n\r\n\tpublic constructor(name: string, cooldownSeconds: number) {\r\n\t\tthis.name = name;\r\n\t\tthis.cooldownSeconds = cooldownSeconds;\r\n\t}\r\n}\r\n\r\nexport class Governor implements IGovernor {\r\n\tpublic static GetChannelCoolDown(channelType: GovernedChannelType) {\r\n\t\tconst channelData = Governor.defaultChannelData[channelType];\r\n\t\treturn channelData ? channelData.cooldownSeconds : 0;\r\n\t}\r\n\r\n\tpublic static SetDefaultChannelCoolDown(channelType: GovernedChannelType, cooldownSeconds: number) {\r\n\t\tconst channelData = Governor.defaultChannelData[channelType];\r\n\t\tif (channelData) {\r\n\t\t\tchannelData.cooldownSeconds = cooldownSeconds;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static minute = 60;\r\n\tprivate static hour: number = 60 * Governor.minute;\r\n\tprivate static day: number = 24 * Governor.hour;\r\n\r\n\t// Array of default values for each channel type. Indexed by the GovernedChannelType enum name.\r\n\tprivate static defaultChannelData: Record<GovernedChannelType, DefaultChannelData> = {\r\n\t\t[GovernedChannelType.Standard]: new DefaultChannelData(GovernedChannelType[GovernedChannelType.Standard], 14 * Governor.day),\r\n\t\t[GovernedChannelType.Urgent]: new DefaultChannelData(GovernedChannelType[GovernedChannelType.Urgent], 0),\r\n\t\t[GovernedChannelType.Banner]: new DefaultChannelData(GovernedChannelType[GovernedChannelType.Banner], 15 * Governor.day),\r\n\t\t[GovernedChannelType.TeachingMessage]: new DefaultChannelData(GovernedChannelType[GovernedChannelType.TeachingMessage], 1 * Governor.hour),\r\n\t\t[GovernedChannelType.BusinessBar]: new DefaultChannelData(GovernedChannelType[GovernedChannelType.BusinessBar], 3 * Governor.hour),\r\n\t\t[GovernedChannelType.Dialog]: new DefaultChannelData(GovernedChannelType[GovernedChannelType.Dialog], 24 * Governor.hour),\r\n\t};\r\n\r\n\tprivate channelStateProvider: IGovernedChannelStateProvider;\r\n\tprivate channels: GovernedChannel[] = [];\r\n\r\n\tpublic constructor(channelStateProvider: IGovernedChannelStateProvider) {\r\n\t\tif (!channelStateProvider) {\r\n\t\t\tthrow new Error(\"channelStateProvider must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.channelStateProvider = channelStateProvider;\r\n\t\tthis.loadChannels();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic refreshChannelData(): void {\r\n\t\tthis.loadChannels();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic getAvailableChannelData(): IGovernedChannelData[] {\r\n\t\tconst channelData: IGovernedChannelData[] = [];\r\n\r\n\t\tfor (const key in this.channels) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.channels, key)) {\r\n\t\t\t\tconst channel: GovernedChannel = this.channels[key];\r\n\r\n\t\t\t\tif (channel.isOpen()) {\r\n\t\t\t\t\tchannelData.push(channel);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn channelData;\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic isChannelOpen(type: GovernedChannelType): boolean {\r\n\t\tif (isNOU(type)) {\r\n\t\t\tthrow new Error(\"type must not be null\");\r\n\t\t}\r\n\r\n\t\treturn this.channels[type].isOpen();\r\n\t}\r\n\r\n\t// @Override\r\n\tpublic startChannelCooldown(type: GovernedChannelType, date?: Date): void {\r\n\t\tif (isNOU(type)) {\r\n\t\t\tthrow new Error(\"type must not be null\");\r\n\t\t}\r\n\r\n\t\tdate = date ? date : new Date();\r\n\r\n\t\t// Start the cool down\r\n\t\tthis.channels[type].setCooldownStartTime(date);\r\n\r\n\t\t// Save the new channel state for future sessions\r\n\t\tthis.saveChannelStates();\r\n\t}\r\n\r\n\tpublic saveChannelStates(): void {\r\n\t\t// Build up the list of channel states\r\n\t\tconst channelStates: GovernedChannelState[] = [];\r\n\r\n\t\tfor (const key in this.channels) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.channels, key)) {\r\n\t\t\t\tconst channel: GovernedChannel = this.channels[key];\r\n\t\t\t\tconst channelState: GovernedChannelState =\r\n\t\t\t\t\tnew GovernedChannelState(channel.getType(), channel.getCooldownStartTime());\r\n\r\n\t\t\t\tchannelStates.push(channelState);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.channelStateProvider.save(channelStates);\r\n\t}\r\n\r\n\tprivate loadChannels(): void {\r\n\t\t// Load up state from previous sessions\r\n\t\tthis.loadChannelStatesFromProvider();\r\n\r\n\t\t// For any missing channels, init them from scratch\r\n\t\t// There's no straightforward way to iterate enums, we need to iterate through the enum array\r\n\t\t//    filtering out just the numeric enum values (excluding enum names).\r\n\t\tfor (const item in GovernedChannelType) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(GovernedChannelType, item)) {\r\n\t\t\t\tconst key = Number(item);\r\n\r\n\t\t\t\t// skip if key is not numeric enum value, or if already exists\r\n\t\t\t\tif (isNaN(key) || this.channels[key]) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst defaultData: DefaultChannelData = Governor.defaultChannelData[key];\r\n\t\t\t\tconst newChannel: GovernedChannel =\r\n\t\t\t\t\tnew GovernedChannel(key, defaultData.name, defaultData.cooldownSeconds, null);\r\n\t\t\t\tthis.channels[key] = newChannel;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadChannelStatesFromProvider(): void {\r\n\t\tthis.channels = [];\r\n\r\n\t\tconst channelStates: GovernedChannelState[] = this.channelStateProvider.load();\r\n\r\n\t\tfor (const key in channelStates) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(channelStates, key)) {\r\n\t\t\t\tconst channelState: GovernedChannelState = channelStates[key];\r\n\r\n\t\t\t\tconst type: GovernedChannelType = channelState.getType();\r\n\t\t\t\tconst defaultData: DefaultChannelData = Governor.defaultChannelData[type];\r\n\t\t\t\tconst newChannel: GovernedChannel =\r\n\t\t\t\t\tnew GovernedChannel(type, defaultData.name, defaultData.cooldownSeconds, channelState.getCooldownStartTime());\r\n\r\n\t\t\t\tthis.channels[newChannel.getType()] = newChannel;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n", "import {\r\n\tGovernedChannelType,\r\n\tIAppGovernanceProvider,\r\n\tIGovernanceParameters,\r\n\tIGovernanceServiceClient,\r\n\tIGovernedChannelData,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { Governor } from \"../Governor\";\r\nimport { IGovernedChannelStateProvider } from \"../GovernedChannelStateProvider\";\r\nimport { CampaignBusinessLevel, GovernanceDecision, IGovernanceDecision, IOrchestrationEngine } from \"./Api\";\r\nimport { IAppGovernanceCampaignForm } from \"@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IAppGovernanceProvider\";\r\n\r\nexport class OrchestrationEngine implements IOrchestrationEngine {\r\n\tprivate governanceServiceClient: IGovernanceServiceClient;\r\n\tprivate channelGovernanceProvider: Governor;\r\n\tprivate appGovernanceProvider: IAppGovernanceProvider;\r\n\r\n\tpublic constructor(governanceServiceClient: IGovernanceServiceClient, \r\n\t\tgovernedChannelStateProvider: IGovernedChannelStateProvider,\r\n\t\tappGovernanceProvider: IAppGovernanceProvider) {\r\n\r\n\t\tif (!governanceServiceClient) {\r\n\t\t\tthrow new Error(\"Invalid governanceServiceClient\");\r\n\t\t}\r\n\t\r\n\t\tif (!governedChannelStateProvider) {\r\n\t\t\tthrow new Error(\"Invalid governanceServiceClient\");\r\n\t\t}\r\n\r\n\t\tthis.governanceServiceClient = governanceServiceClient;\r\n\t\tthis.channelGovernanceProvider = new Governor(governedChannelStateProvider);\r\n\t\tthis.appGovernanceProvider = appGovernanceProvider;\r\n\t}\r\n\r\n\tpublic async getDecision(businessLevel: CampaignBusinessLevel, governanceParams: IGovernanceParameters): Promise<IGovernanceDecision> {\r\n\t\tif (!governanceParams) {\r\n\t\t\tthrow new Error(\"Invalid governanceParams\");\r\n\t\t}\r\n\r\n\t\tconst defaultDecision: IGovernanceDecision = {\r\n\t\t\tgovernanceDecision: GovernanceDecision.Approved,\r\n\t\t\tserviceResult: {\r\n\t\t\t\tpermission: true\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Always allow business critical campaigns\r\n\t\tif (businessLevel === CampaignBusinessLevel.Critical) {\r\n\t\t\treturn defaultDecision;\r\n\t\t}\r\n\r\n\t\t// Allow calls only on the channels that are governed\r\n\t\tif (!this.governanceServiceClient.isEnabled(governanceParams.channelType)) {\r\n\t\t\treturn defaultDecision;\r\n\t\t}\r\n\r\n\t\t// Update governance cooldown if the value is not set\r\n\t\tif (governanceParams.userCooldown < 0) {\r\n\t\t\tgovernanceParams.userCooldown = Governor.GetChannelCoolDown(governanceParams.channelType);\r\n\t\t}\r\n\r\n\t\t// check with governance service\r\n\t\tconst serviceResult = await this.governanceServiceClient.checkGovernancePermitAsync(governanceParams);\r\n\t\tlet governanceDecision: GovernanceDecision = GovernanceDecision.Error;\r\n\t\tif (serviceResult && !serviceResult.error) {\r\n\t\t\tgovernanceDecision = serviceResult.permission ? GovernanceDecision.Approved : GovernanceDecision.Rejected;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tgovernanceDecision,\r\n\t\t\tserviceResult\r\n\t\t};\r\n\t}\r\n\r\n\tpublic isSurveyTrackable(campaignForm: IAppGovernanceCampaignForm): boolean {\r\n\t\treturn !this.appGovernanceProvider || this.appGovernanceProvider.getDecision(campaignForm);\r\n\t}\r\n\r\n\tpublic getAvailableChannels(): GovernedChannelType[] {\r\n\t\tconst channels: IGovernedChannelData[] = this.channelGovernanceProvider.getAvailableChannelData();\r\n\t\tconst channelTypes: GovernedChannelType[] = [];\r\n\r\n\t\tchannels.forEach((channel) => {\r\n\t\t\tif (channel) {\r\n\t\t\t\tchannelTypes.push(channel.getType());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn channelTypes;\r\n\t}\r\n\r\n\tpublic mergeAndSave(): void {\r\n\t\tthis.channelGovernanceProvider.saveChannelStates();\r\n\t}\r\n\r\n\tpublic isChannelOpen(governedChannelType: GovernedChannelType, refreshData = true): boolean {\r\n\t\t// Refresh channels\r\n\t\tif (refreshData) {\r\n\t\t\tthis.channelGovernanceProvider.refreshChannelData();\r\n\t\t}\r\n\r\n\t\treturn this.channelGovernanceProvider.isChannelOpen(governedChannelType);\r\n\t}\r\n\r\n\tpublic isChannelGovernanceEnabled(governedChannelType: GovernedChannelType): boolean {\r\n\t\treturn this.governanceServiceClient.isEnabled(governedChannelType);\r\n\t}\r\n\r\n\tpublic startChannelCooldown(channelType: GovernedChannelType, dateTime: Date): void {\r\n\t\tthis.channelGovernanceProvider.startChannelCooldown(channelType, dateTime);\r\n\t}\r\n\r\n\tpublic shouldForcePermission(): boolean {\r\n\t\treturn this.governanceServiceClient.shouldForceDisplay();\r\n\t}\r\n\r\n\tpublic getStateForTelemetry(): any {\r\n\t\treturn this.governanceServiceClient.getClientState();\r\n\t}\r\n}\r\n", "import {\r\n\tCampaignNominationSchemeRatioPercentage,\r\n\tFileSystemCampaignDefinitionProvider,\r\n} from \"./Campaign/CampaignDefinitionProvider\";\r\nimport {\r\n\tDynamicUxClientState,\r\n\tFloodgateStorageProviderFileType as FileType,\r\n\tGovernanceServiceClientState,\r\n\tGovernedChannelType,\r\n\tIActivityListener,\r\n\tIActivityTrackingSet,\r\n\tIAppGovernanceProvider,\r\n\tICampaignDefinition,\r\n\tICampaignDefinitionProvider,\r\n\tICampaignStateProvider,\r\n\tICampaignTelemetrySamplingConfig,\r\n\tIContextData,\r\n\tIDictionary,\r\n\tIFloodgateEnvironmentProvider,\r\n\tIFloodgateSettingStorageCallback,\r\n\tIFloodgateStorageProvider,\r\n\tIFloodgateStringProvider,\r\n\tIFloodgateTelemetryLogger,\r\n\tIGovernanceParameters,\r\n\tIGovernanceServiceClient,\r\n\tIGovernanceServiceResult,\r\n\tILogExperimentTrigger,\r\n\tIOnSurveyActivatedCallback,\r\n\tIPersonalizerClient,\r\n\tISurvey,\r\n\tISurveyCandidacyChecker,\r\n\tISurveyForm,\r\n\tISurveyInfo,\r\n\tISurveyLauncher,\r\n\tISurveyLauncherFactory,\r\n\tITelemetryProperties,\r\n\tITransporterFactory,\r\n\tSurveyType,\r\n\tTreatmentType,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { GovernedChannelStateProviderFactory, IGovernedChannelStateProvider } from \"./GovernedChannelStateProvider\";\r\nimport {\r\n\tISurveyActivationStatsProvider,\r\n\tSurveyActivationStats,\r\n\tSurveyActivationStatsProviderFactory,\r\n\tSurveyStatCollectionActivation,\r\n} from \"./SurveyStatCollectionActivation\";\r\nimport { SurveyEventActivityStats, SurveyStatCollectionEventActivity } from \"./SurveyStatCollectionEventActivity\";\r\nimport {\r\n\thasSurveyReachedMaxLaunches,\r\n\thasSurveyReachedMaxLaunchesPerSession,\r\n\tisBusinessCriticalSurvey,\r\n\tisCriticalSurvey,\r\n\tisMultiLaunchSurvey\r\n} from \"./GovernanceUtils\";\r\n\r\nimport { ActivityTrackingContract } from \"./ActivityTrackingContract\";\r\nimport { CampaignManager } from \"./Campaign/CampaignManager\";\r\nimport { CampaignStateProviderFactory } from \"./Campaign/CampaignStateProvider\";\r\nimport { FloodgateSettings } from \"./FloodgateSettings\";\r\nimport { IUserFactProvider } from \"./Api/IUserFactProvider\";\r\nimport SurveyActivityListener from \"./SurveyActivityListener\";\r\nimport { TelemetryEvent } from \"./Constants\";\r\nimport { isNOU } from \"./Utils\";\r\nimport { IFloodgateEngineConfig } from \"./Api/IFloodgateEngineConfig\";\r\nimport FloodgateSurveyCdnClient, { isTranslationRequired } from \"./FloodgateSurveyCdn/FloodgateSurveyCdnClient\";\r\nimport { getFeatureGateProvider } from \"./FeatureGateProvider\";\r\n\r\nimport { CampaignBusinessLevel, GovernanceDecision, IGovernanceDecision, IOrchestrationEngine } from \"./OrchestrationEngine/Api\";\r\nimport { OrchestrationEngine } from \"./OrchestrationEngine/OrchestrationEngine\";\r\nimport { TelemetryLogger } from \"./TelemetryLogger\";\r\n\r\nexport const enum InitializationStatus {\r\n\tNone = 0,\r\n\tError,\r\n\tInitializing,\r\n\tStarted,\r\n\tStopped,\r\n}\r\n\r\nconst defaultSurveyActivityListener: SurveyActivityListener.IActivityListenerCallback = {\r\n\trun(survey) {\r\n\t},\r\n\tshouldAcceptActivity(activityName) {\r\n\t\treturn true;\r\n\t},\r\n};\r\n\r\nconst globalSessionSurveyActivationCounts: IDictionary<number> = {};\r\n\r\n/**\r\n * Internal interface is used for FloodgateEngine calss only.\r\n * It hold the neccessary information for stale activated campaign which is waiting for its turn\r\n * to call to Governance Service, due to the previous call is still in progress\r\n */\r\ninterface IStaleTriggeredSurvey {\r\n\tsurvey: ISurvey,\r\n\tcontextInfo: IContextData[]\r\n}\r\n\r\n/**\r\n * Floodgate Engine class.  The main wiring hub and the brains responsible for\r\n * linking together the survey definitions, governance, activity tracking, and\r\n * survey launchers.  Only one-instance-at-a-time of these should be created\r\n * per app session.\r\n */\r\nexport class FloodgateEngine {\r\n\tpublic static getTransportFactory(): ITransporterFactory {\r\n\t\treturn FloodgateEngine.transporterFactory;\r\n\t}\r\n\r\n\tpublic static make(\r\n\t\tbuildVersion: string,\r\n\t\tlauncherFactory: ISurveyLauncherFactory,\r\n\t\tonSurveyActivatedCallback: IOnSurveyActivatedCallback,\r\n\t\tfileBasedStorageProvider: IFloodgateStorageProvider,\r\n\t\thostBasedStorageProvider: IFloodgateSettingStorageCallback,\r\n\t\tstringProvider: IFloodgateStringProvider,\r\n\t\tenvironmentProvider: IFloodgateEnvironmentProvider,\r\n\t\ttransporterFactory: ITransporterFactory,\r\n\t\tcampaignDefinitionProviders: ICampaignDefinitionProvider[],\r\n\t\tuserFactsProvider: IUserFactProvider,\r\n\t\tgovernanceServiceClient: IGovernanceServiceClient,\r\n\t\tisPriorityEnabled: boolean,\r\n\t\tfloodgateEngineConfig: IFloodgateEngineConfig,\r\n\t\tappGovernanceProvider?: IAppGovernanceProvider,\r\n\t\tlogExperimentTrigger?: ILogExperimentTrigger, \r\n\t\tcampaignTelemetrySamplingConfig?: ICampaignTelemetrySamplingConfig,\r\n\t\tpersonalizerClient?: IPersonalizerClient,\r\n\t\tmessagingEnabled?: boolean,\r\n\t\tsurveyEnabled?: boolean,\r\n\t\tsurveyClient?: CampaignManager): FloodgateEngine {\r\n\r\n\t\ttry {\r\n\t\t\tconst governedChannelStateProvider: IGovernedChannelStateProvider\r\n\t\t\t\t= GovernedChannelStateProviderFactory.make(fileBasedStorageProvider, hostBasedStorageProvider);\r\n\r\n\t\t\tconst surveyActivationStatsProvider: ISurveyActivationStatsProvider\r\n\t\t\t\t= SurveyActivationStatsProviderFactory.make(fileBasedStorageProvider, hostBasedStorageProvider);\r\n\r\n\t\t\tconst campaignStateProvider: ICampaignStateProvider\r\n\t\t\t\t= CampaignStateProviderFactory.make(fileBasedStorageProvider, hostBasedStorageProvider);\r\n\r\n\t\t\t// Push to front of array so that it is the first provider to be checked.\r\n\t\t\t// FilterCampaignData method overwrites the latest campaign definition with the same id.\r\n\t\t\t// So, the static campaign definition provider should have the least priority during override.\r\n\t\t\tcampaignDefinitionProviders.unshift(new FileSystemCampaignDefinitionProvider(fileBasedStorageProvider));\r\n\r\n\t\t\tconst orchestrationEngine = new OrchestrationEngine(governanceServiceClient, governedChannelStateProvider, appGovernanceProvider );\r\n\r\n\t\t\tconst getSurveyCandidacyChecker = (surveyForm: ISurveyForm) => {\r\n\t\t\t\treturn orchestrationEngine.isSurveyTrackable(surveyForm);\r\n\t\t\t};\r\n\r\n\t\t\tconst surveyCandidacyChecker: ISurveyCandidacyChecker = { isSurveyTrackable: getSurveyCandidacyChecker };\r\n\r\n\t\t\tconst client = surveyClient || new CampaignManager(\r\n\t\t\t\tcampaignStateProvider,\r\n\t\t\t\tcampaignDefinitionProviders,\r\n\t\t\t\tstringProvider,\r\n\t\t\t\tenvironmentProvider,\r\n\t\t\t\tbuildVersion,\r\n\t\t\t\tnew Date(),\r\n\t\t\t\tisPriorityEnabled,\r\n\t\t\t\tuserFactsProvider,\r\n\t\t\t\tsurveyCandidacyChecker,\r\n\t\t\t\tlogExperimentTrigger,\r\n\t\t\t\tcampaignTelemetrySamplingConfig,\r\n\t\t\t\tmessagingEnabled,\r\n\t\t\t\tsurveyEnabled,\r\n\t\t\t);\r\n\r\n\t\t\treturn new FloodgateEngine(\r\n\t\t\t\tclient,\r\n\t\t\t\tnew SurveyActivityListener(\r\n\t\t\t\t\tdefaultSurveyActivityListener,\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger,\r\n\t\t\t\t),\r\n\t\t\t\tlauncherFactory,\r\n\t\t\t\tonSurveyActivatedCallback,\r\n\t\t\t\tfileBasedStorageProvider,\r\n\t\t\t\torchestrationEngine,\r\n\t\t\t\tsurveyActivationStatsProvider,\r\n\t\t\t\ttransporterFactory,\r\n\t\t\t\tcampaignTelemetrySamplingConfig,\r\n\t\t\t\tfloodgateEngineConfig,\r\n\t\t\t\tpersonalizerClient\r\n\t\t\t);\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.Make.Failed,\r\n\t\t\t\t{ ErrorMessage: e && e.toString(), ErrorDetails: e && e.stack });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static transporterFactory: ITransporterFactory;\r\n\r\n\tprivate surveyClient: CampaignManager;\r\n\tprivate activityListener: SurveyActivityListener;\r\n\tprivate onSurveyActivatedCallback: IOnSurveyActivatedCallback;\r\n\tprivate launcherFactory: ISurveyLauncherFactory;\r\n\tprivate storage: IFloodgateStorageProvider;\r\n\tprivate orchestrationEngine: IOrchestrationEngine;\r\n\tprivate initializationStatus: InitializationStatus = InitializationStatus.None;\r\n\tprivate loggedFirstStart: boolean;\r\n\r\n\tprivate floodgateSettings: FloodgateSettings;\r\n\tprivate previousSurveyActivationStats: SurveyStatCollectionActivation;\r\n\tprivate previousSurveyEventActivityStats: SurveyStatCollectionEventActivity;\r\n\r\n\tprivate candidateSurveys: IDictionary<ISurvey> = {};\r\n\tprivate launchedSurveys: IDictionary<ISurvey> = {};\r\n\tprivate launchedLaunchers: ISurveyLauncher[] = [];\r\n\tprivate surveyEventSent: string[] = [];\r\n\r\n\tprivate surveyActivationStatsProvider: ISurveyActivationStatsProvider;\r\n\r\n\tprivate staleTriggeredSurveysQueue: IStaleTriggeredSurvey[] = [];\r\n\tprivate campaignTelemetrySamplingConfig: ICampaignTelemetrySamplingConfig;\r\n\tprivate floodgateEngineConfig: IFloodgateEngineConfig;\r\n\r\n\tprivate personalizerClient: IPersonalizerClient;\r\n\r\n\tpublic constructor(surveyClient: CampaignManager, activityListener: SurveyActivityListener, launcherFactory: ISurveyLauncherFactory,\r\n\t\tonSurveyActivatedCallback: IOnSurveyActivatedCallback, storage: IFloodgateStorageProvider, orchestrationEngine: IOrchestrationEngine,\r\n\t\tsurveyActivationStatsProvider: ISurveyActivationStatsProvider, transporterFactory: ITransporterFactory,\r\n\t\tcampaignTelemetrySamplingConfig: ICampaignTelemetrySamplingConfig,\r\n\t\tfloodgateEngineConfig: IFloodgateEngineConfig, personalizerClient: IPersonalizerClient) {\r\n\r\n\t\tif (!surveyClient) {\r\n\t\t\tthrow new Error(\"surveyClient must not be null\");\r\n\t\t}\r\n\t\tif (!activityListener) {\r\n\t\t\tthrow new Error(\"activityListener must not be null\");\r\n\t\t}\r\n\t\tif (!launcherFactory) {\r\n\t\t\tthrow new Error(\"launcherFactory must not be null\");\r\n\t\t}\r\n\t\tif (!onSurveyActivatedCallback) {\r\n\t\t\tthrow new Error(\"onSurveyActivatedCallback must not be null\");\r\n\t\t}\r\n\t\tif (!storage) {\r\n\t\t\tthrow new Error(\"storage must not be null\");\r\n\t\t}\r\n\t\tif (!orchestrationEngine) {\r\n\t\t\tthrow new Error(\"governor must not be null\");\r\n\t\t}\r\n\t\tif (!transporterFactory) {\r\n\t\t\tthrow new Error(\"transporterFactory must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.surveyClient = surveyClient;\r\n\t\tthis.activityListener = activityListener;\r\n\t\tthis.launcherFactory = launcherFactory;\r\n\t\tthis.onSurveyActivatedCallback = onSurveyActivatedCallback;\r\n\t\tthis.storage = storage;\r\n\t\tthis.orchestrationEngine = orchestrationEngine;\r\n\t\tthis.surveyActivationStatsProvider = surveyActivationStatsProvider;\r\n\t\tthis.campaignTelemetrySamplingConfig = campaignTelemetrySamplingConfig;\r\n\t\tthis.floodgateEngineConfig = floodgateEngineConfig;\r\n\t\tthis.personalizerClient = personalizerClient;\r\n\t\tFloodgateEngine.transporterFactory = transporterFactory;\r\n\r\n\t\tthis.loggedFirstStart = false;\r\n\r\n\t\t// Initialize our list to a valid, empty collection\r\n\t\tthis.setPendingSurveys(null);\r\n\r\n\t\t// If the listener was pre-configured with survey for some reason, clear it now\r\n\t\tthis.activityListener.clearSurveys();\r\n\r\n\t\t// Link ourselves with the listener\r\n\t\t/* eslint-disable-next-line @typescript-eslint/no-this-alias*/\r\n\t\tconst thisObj = this; // Save current object in a variable to allow access from callback.\r\n\t\tthis.activityListener.setCallback({\r\n\t\t\trun(surveyId: string, contextInfo: IContextData[]) {\r\n\t\t\t\tthisObj.onSurveyActivated(surveyId, contextInfo);\r\n\t\t\t},\r\n\t\t\tshouldAcceptActivity(activityName: string) {\r\n\t\t\t\treturn thisObj.shouldAcceptActivity(activityName);\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getSurveyClient(): CampaignManager {\r\n\t\treturn this.surveyClient;\r\n\t}\r\n\r\n\t/**\r\n\t * Save all internal stats and floodgateSettings (merging with existing file contents), without stopping the engine.\r\n\t */\r\n\tpublic mergeAndSave(): void {\r\n\t\tthis.saveSettings();\r\n\t\tthis.saveSurveyActivationHistory();\r\n\t\tthis.saveSurveyEventActivityHistory();\r\n\r\n\t\t// Inform surveyClient to save its state\r\n\t\tthis.surveyClient.saveCurrentState();\r\n\r\n\t\t// Save governed channel states\r\n\t\tthis.orchestrationEngine.mergeAndSave();\r\n\t}\r\n\r\n\t/**\r\n\t * Start the engine.  Checks feature enable state, causes survey definitions to be read, and tracked activities to be set on the listener.\r\n\t */\r\n\tpublic start(): void {\r\n\t\tif (this.initializationStatus === InitializationStatus.Initializing ||\r\n\t\t\tthis.initializationStatus === InitializationStatus.Started) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tthis.setInitializationStatus(InitializationStatus.Initializing);\r\n\t\t\tthis.loadSettingsAndPriorEventCounts();\r\n\r\n\t\t\tconst channelTypes: GovernedChannelType[] = this.orchestrationEngine.getAvailableChannels();\r\n\r\n\t\t\tthis.surveyClient.refreshSurveyDefinitions(channelTypes);\r\n\r\n\t\t\tthis.setPendingSurveysAndStartFloodgate();\r\n\t\t\tthis.setInitializationStatus(InitializationStatus.Started);\r\n\t\t} catch (e) {\r\n\t\t\tthis.setInitializationStatus(InitializationStatus.Error);\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.Start.Failed,\r\n\t\t\t\t{ ErrorMessage: e && e.toString(), ErrorDetails: e && e.stack });\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Start the engine.  Checks feature enable state, causes survey definitions to be read, and tracked activities to be set on the listener.\r\n\t */\r\n\tpublic startAsync(): Promise<void> {\r\n\t\tif (this.initializationStatus === InitializationStatus.Initializing ||\r\n\t\t\tthis.initializationStatus === InitializationStatus.Started) {\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tthis.setInitializationStatus(InitializationStatus.Initializing);\r\n\t\t\tthis.loadSettingsAndPriorEventCounts();\r\n\r\n\t\t\tconst channelTypes: GovernedChannelType[] = this.orchestrationEngine.getAvailableChannels();\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tthis.surveyClient.refreshSurveyDefinitionsAsync(channelTypes).then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\t// Handle any stop() calls that happened while initializing\r\n\t\t\t\t\t\tif (this.initializationStatus === InitializationStatus.Stopped) {\r\n\t\t\t\t\t\t\tthis.setInitializationStatus(InitializationStatus.Started);\r\n\t\t\t\t\t\t\tthis.stop();\r\n\t\t\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.StartAsync.Stopped,\r\n\t\t\t\t\t\t\t\t{ ErrorMessage: \"Stopped because of a pending stop() call\" });\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.setPendingSurveysAndStartFloodgate();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t},\r\n\t\t\t\t).catch(\r\n\t\t\t\t\t(error: Error) => {\r\n\t\t\t\t\t\tthis.setInitializationStatus(InitializationStatus.Error);\r\n\t\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.StartAsync.Failed,\r\n\t\t\t\t\t\t\t{ ErrorMessage: \"Survey refresh error \" + (error && error.message) });\r\n\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t},\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t} catch (e) {\r\n\t\t\tthis.setInitializationStatus(InitializationStatus.Error);\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.StartAsync.Failed,\r\n\t\t\t\t{ ErrorMessage: e && e.toString(), ErrorDetails: e && e.stack });\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Stop the engine.  Causes tracked activities to be cleared and any in-progress counters not otherwise saved to be thrown out.\r\n\t */\r\n\tpublic stop(): void {\r\n\t\tif (this.initializationStatus === InitializationStatus.Started) {\r\n\t\t\tthis.mergeAndSave();\r\n\r\n\t\t\t// Clear our Survey list, and push that through to the listener\r\n\t\t\tthis.setPendingSurveys(null);\r\n\t\t\tthis.updateActivityListenerWithCurrentSurveyDefinitions();\r\n\t\t}\r\n\r\n\t\tthis.setInitializationStatus(InitializationStatus.Stopped);\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the IActivityListener logging interface for callers that want to log directly rather than through telemetry\r\n\t */\r\n\tpublic getActivityListener(): IActivityListener {\r\n\t\treturn this.activityListener;\r\n\t}\r\n\r\n\tprivate setInitializationStatus(status: InitializationStatus): void {\r\n\t\tthis.initializationStatus = status;\r\n\t}\r\n\r\n\tprivate saveSettings(): void {\r\n\t\tthis.storage.fileLock(FileType.FloodgateSettings);\r\n\r\n\t\ttry {\r\n\t\t\tthis.writeString(FileType.FloodgateSettings, FloodgateSettings.toJson(this.floodgateSettings));\r\n\t\t} finally {\r\n\t\t\tthis.storage.fileUnlock(FileType.FloodgateSettings);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadSettingsAndPriorEventCounts(): void {\r\n\t\ttry {\r\n\t\t\t// Load up the prior survey history and prior event counts\r\n\t\t\tthis.previousSurveyActivationStats = this.surveyActivationStatsProvider.load();\r\n\r\n\t\t\tthis.previousSurveyEventActivityStats =\r\n\t\t\t\tSurveyStatCollectionEventActivity.fromJson(this.readString(FileType.SurveyEventActivityStats));\r\n\r\n\t\t\t// get the list of survey Id - all the survey should have event sent already\r\n\t\t\tconst stats: IDictionary<SurveyEventActivityStats> = this.previousSurveyEventActivityStats.getStats();\r\n\t\t\tfor (const key in stats) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(stats, key)) {\r\n\t\t\t\t\tthis.surveyEventSent.push(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Load up the general floodgateSettings\r\n\t\t\tthis.floodgateSettings = FloodgateSettings.fromJson(this.readString(FileType.FloodgateSettings));\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.Common.Error,\r\n\t\t\t\t{ ErrorMessage: \"Error loading prior settings/events \" + (e && e.toString()) });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setPendingSurveysAndStartFloodgate(): void {\r\n\t\t// Update our survey list, and push that through to the listener\r\n\t\tthis.setPendingSurveys(this.surveyClient.getAppSurveys());\r\n\t\tthis.updateActivityListenerWithCurrentSurveyDefinitions();\r\n\r\n\t\t// Mark us as started\r\n\t\tthis.setInitializationStatus(InitializationStatus.Started);\r\n\r\n\t\t// Log our first start (aka floodgate boot) event\r\n\t\tif (!this.loggedFirstStart) {\r\n\t\t\tthis.loggedFirstStart = true;\r\n\t\t\tthis.getActivityListener().logActivity(SurveyActivityListener.FloodgateStartActivityName);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateSurveyActivationStats(survey: ISurvey) {\r\n\t\tconst surveyInfo = survey.getSurveyInfo();\r\n\t\tconst surveyId = surveyInfo.getId();\r\n\t\tconst stats = this.previousSurveyActivationStats.getStats()[surveyId] || new SurveyActivationStats();\r\n\t\tstats.Type = survey.getType();\r\n\t\tstats.ExpirationTimeUtc = surveyInfo.getExpirationTimeUtc();\r\n\t\tstats.ActivationTimeUtc = new Date();\r\n\t\tstats.SurveyLaunchCount++;\r\n\r\n\t\tthis.previousSurveyActivationStats.addStats(surveyId, stats);\r\n\r\n\t\t// Save the SurveyLaunchCountPerSession into global memory but not local storage\r\n\t\t// so it won't be overwritten in local storage by another app instance\r\n\t\tif (!Object.prototype.hasOwnProperty.call(globalSessionSurveyActivationCounts, surveyId)) {\r\n\t\t\tglobalSessionSurveyActivationCounts[surveyId] = 0;\r\n\t\t}\r\n\t\tglobalSessionSurveyActivationCounts[surveyId]++;\r\n\t}\r\n\r\n\tprivate saveSurveyActivationHistory(): void {\r\n\t\tthis.storage.fileLock(FileType.SurveyActivationStats);\r\n\r\n\t\ttry {\r\n\t\t\tconst statCollection: SurveyStatCollectionActivation = this.surveyActivationStatsProvider.load();\r\n\r\n\t\t\tconst previousStats = this.previousSurveyActivationStats.getStats();\r\n\r\n\t\t\t// Build the update collection\r\n\t\t\tconst updateCollection = new SurveyStatCollectionActivation();\r\n\t\t\tfor (const key in this.launchedSurveys) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(this.launchedSurveys, key)) {\r\n\t\t\t\t\tconst survey: ISurvey = this.launchedSurveys[key];\r\n\t\t\t\t\tconst surveyId = survey.getSurveyInfo().getId();\r\n\r\n\t\t\t\t\t// Make this part of the update list\r\n\t\t\t\t\tconst stats = previousStats[surveyId];\r\n\t\t\t\t\tupdateCollection.addStats(surveyId, stats);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Actually merge our updates into the full collection\r\n\t\t\tstatCollection.accumulate(updateCollection);\r\n\t\t\tthis.surveyActivationStatsProvider.save(statCollection);\r\n\r\n\t\t\t// Make sure to keep our internal collection consistent with what we just wrote\r\n\t\t\tthis.previousSurveyActivationStats = statCollection;\r\n\t\t} finally {\r\n\t\t\tthis.storage.fileUnlock(FileType.SurveyActivationStats);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate saveSurveyEventActivityHistory(): void {\r\n\t\tthis.storage.fileLock(FileType.SurveyEventActivityStats);\r\n\r\n\t\ttry {\r\n\t\t\tconst statCollection: SurveyStatCollectionEventActivity =\r\n\t\t\t\tSurveyStatCollectionEventActivity.fromJson(this.readString(FileType.SurveyEventActivityStats));\r\n\r\n\t\t\tconst now = new Date();\r\n\t\t\t// Fill out our list of updates\r\n\t\t\tconst updateCollection = new SurveyStatCollectionEventActivity();\r\n\t\t\tfor (const key in this.candidateSurveys) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(this.candidateSurveys, key)) {\r\n\t\t\t\t\tconst stats: SurveyEventActivityStats = new SurveyEventActivityStats();\r\n\t\t\t\t\tconst survey: ISurvey = this.candidateSurveys[key];\r\n\r\n\t\t\t\t\tif (!survey.getSurveyInfo().isActiveForDate(now)) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstats.ExpirationTimeUtc = survey.getSurveyInfo().getExpirationTimeUtc();\r\n\r\n\t\t\t\t\t// Get the activities which are aggregated, if there aren't any continue\r\n\t\t\t\t\tconst allActivities: IActivityTrackingSet = survey.getSurveyInfo().getActivationEvent().getTrackingSet();\r\n\t\t\t\t\tconst aggregateActivities: string[] = [];\r\n\t\t\t\t\tconst nonAggregateActivities: string[] = [];\r\n\r\n\t\t\t\t\tallActivities.getList().forEach((data) => {\r\n\t\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\t\tif (data.getIsAggregate()) {\r\n\t\t\t\t\t\t\t\taggregateActivities.push(data.getActivity());\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnonAggregateActivities.push(data.getActivity());\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tstats.Counts = new Array(aggregateActivities.length);\r\n\r\n\t\t\t\t\t// Save off the counts we've added for this session\r\n\t\t\t\t\tfor (let i = 0; i < aggregateActivities.length; i++) {\r\n\t\t\t\t\t\tstats.Counts[i] = this.activityListener.moveSessionCountIntoBaseCount(aggregateActivities[i], survey.getSurveyInfo().getId());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (const activity of nonAggregateActivities) {\r\n\t\t\t\t\t\tthis.activityListener.saveSessionTrackingActivity(activity);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Make this part of the update list\r\n\t\t\t\t\tupdateCollection.addStats(survey.getSurveyInfo().getId(), stats);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Actually merge our updates into the full collection\r\n\t\t\tstatCollection.accumulate(updateCollection);\r\n\r\n\t\t\tthis.writeString(FileType.SurveyEventActivityStats, SurveyStatCollectionEventActivity.toJson(statCollection));\r\n\t\t\t// Make sure to keep our internal collection consistent with what we just wrote\r\n\t\t\tthis.previousSurveyEventActivityStats = statCollection;\r\n\t\t} finally {\r\n\t\t\tthis.storage.fileUnlock(FileType.SurveyEventActivityStats);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setPendingSurveys(pendingSurveys: IDictionary<ISurvey>): void {\r\n\t\tthis.candidateSurveys = {};\r\n\t\tif (pendingSurveys) {\r\n\t\t\tconst rejectCampaigns = [];\r\n\t\t\tconst acceptCampaigns = [];\r\n\t\t\tfor (const key in pendingSurveys) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(pendingSurveys, key)) {\r\n\t\t\t\t\tconst survey: ISurvey = pendingSurveys[key];\r\n\t\t\t\t\tconst payload: Record<string, unknown> = {\r\n\t\t\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\t\t\tSurveyId: key\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.launcherFactory.AcceptsSurvey(survey)) {\r\n\t\t\t\t\t\tthis.candidateSurveys[key] = survey;\r\n\t\t\t\t\t\tacceptCampaigns.push(payload);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\trejectCampaigns.push(payload);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Default sampling rate: 0% - it's turned off by default. We will enable it from the Host app side if needed.\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.Common.ActiveSurveys,\r\n\t\t\t\t{ Message: JSON.stringify(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tRejectCampaigns: rejectCampaigns,\r\n\t\t\t\t\t\tCandidateCampaigns: acceptCampaigns,\r\n\t\t\t\t\t\tPreviousCandidateSurveyIds: this.surveyEventSent\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 0);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getCurrentSurveyDefinitions(): ISurvey[] {\r\n\t\t// Get a vector of Surveys from our id-based map\r\n\t\tconst surveyList: ISurvey[] = new Array<ISurvey>();\r\n\r\n\t\tconst allCampaignDefinitionIDs = this.getAllCampaignDefinitionIDs();\r\n\t\tconst allCandidateCampaignDefinitionIDs = this.getAllCandidateCampaignDefinitionIDs();\r\n\r\n\t\t// Get all the campaign definitions. We need info from these for telemetry.\r\n\t\tconst allCampaignDefinitions = (this.surveyClient as CampaignManager).getCampaignDefinitions();\r\n\r\n\t\tconst isSurveyAllowed = (surveyInfo: ISurveyInfo) => {\r\n\t\t\t// always allow business critical and approved campaigns\r\n\t\t\tif (isBusinessCriticalSurvey(surveyInfo)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tconst surveyActivationStats = this.previousSurveyActivationStats.getBySurveyId(surveyInfo.getId());\r\n\t\t\tif (isMultiLaunchSurvey(surveyInfo) &&\r\n\t\t\t\t!hasSurveyReachedMaxLaunches(surveyInfo, surveyActivationStats) &&\r\n\t\t\t\t!hasSurveyReachedMaxLaunchesPerSession(surveyInfo, globalSessionSurveyActivationCounts)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\t// Skip over any candidate surveys that have been previously completed or not active anymore\r\n\t\t\tif (surveyActivationStats || !surveyInfo.isActiveForDate(new Date())) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tfor (const key in this.candidateSurveys) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.candidateSurveys, key)) {\r\n\t\t\t\tconst survey: ISurvey = this.candidateSurveys[key];\r\n\t\t\t\tconst surveyInfo = survey.getSurveyInfo();\r\n\t\t\t\tconst campaignDefinition: ICampaignDefinition = allCampaignDefinitions[surveyInfo?.getBackEndId()];\r\n\t\t\t\tif (!campaignDefinition || !isSurveyAllowed(surveyInfo)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// send the UserSelected event if it is not sent before\r\n\t\t\t\tif (this.surveyEventSent.indexOf(key) < 0) {\r\n\t\t\t\t\tthis.surveyEventSent.push(key);\r\n\r\n\t\t\t\t\tconst additionalSurveyInfo = this.getAdditionalSurveyInfoForTelemetry(survey,\r\n\t\t\t\t\t\tnull /* contextInfo */,\r\n\t\t\t\t\t\tallCampaignDefinitionIDs,\r\n\t\t\t\t\t\tallCandidateCampaignDefinitionIDs);\r\n\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_UserSelected(surveyInfo.getBackEndId(),\r\n\t\t\t\t\t\tsurveyInfo.getId(),\r\n\t\t\t\t\t\tsurvey.getType(),\r\n\t\t\t\t\t\tJSON.stringify(additionalSurveyInfo),\r\n\t\t\t\t\t\tsurveyInfo.getTreatmentType());\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsurveyList.push(survey);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn surveyList;\r\n\t}\r\n\r\n\tprivate getAdditionalSurveyInfoForTelemetry(survey: ISurvey,\r\n\t\tcontextInfo: IContextData[], allCampaignDefinitionIDs: string[], allCandidateCampaignDefinitionIDs: string[]): {\r\n\t\t\tallCandidateCampaignDefinitionIDs: string[],\r\n\t\t\tallCampaignDefinitionIDs: string[],\r\n\t\t\tcontextCount?: number,\r\n\t\t\tsurveyLauncherType: string,\r\n\t\t\tchannelType: GovernedChannelType,\r\n\t\t\tpercentageNumerator: number,\r\n\t\t\tpercentageDenominator: number,\r\n\t\t\tnominationPeriodNumber: number,\r\n\t\t\tcooldownPeriodNumber: number,\r\n\t\t\tbusinessLevel: number,\r\n\t\t\tmaxLaunches: number,\r\n\t\t\tmaxLaunchesPerSession: number,\r\n\t\t\tgovernanceServiceClientState?: GovernanceServiceClientState,\r\n\t\t\tisContentValid: boolean,\r\n\t\t\tisUxSchemaPresent: boolean,\r\n\t\t} {\r\n\t\t// Get all the campaign definitions. We need info from these for telemetry.\r\n\t\tconst allCampaignDefinitions = this.surveyClient.getCampaignDefinitions();\r\n\r\n\t\t// Get the corresponding campaign definition to the survey in question.\r\n\t\tconst correspondingCampaignDefinition = allCampaignDefinitions[survey.getCampaignId()];\r\n\r\n\t\t// Survey properties to get from its corresponding CampaignDefinition:\r\n\t\tlet nominationPeriodNumber: number;\r\n\t\tlet cooldownPeriodNumber: number;\r\n\r\n\t\tconst percentageNumerator = (correspondingCampaignDefinition.nominationScheme as CampaignNominationSchemeRatioPercentage).percentageNumerator;\r\n\t\tconst percentageDenominator = (correspondingCampaignDefinition.nominationScheme as CampaignNominationSchemeRatioPercentage).percentageDenominator;\r\n\r\n\t\tnominationPeriodNumber = correspondingCampaignDefinition.nominationScheme.nominationPeriod.asTimeIntervalSeconds();\r\n\t\tnominationPeriodNumber = isNOU(nominationPeriodNumber) ? -1 : nominationPeriodNumber; // Setting to -1 if null or undefined\r\n\r\n\t\tcooldownPeriodNumber = correspondingCampaignDefinition.nominationScheme.cooldownPeriod.asTimeIntervalSeconds();\r\n\t\tcooldownPeriodNumber = isNOU(cooldownPeriodNumber) ? -1 : cooldownPeriodNumber;  // Setting to -1 if null or undefined\r\n\r\n\t\tconst surveyInfo = survey.getSurveyInfo();\r\n\t\treturn {\r\n\t\t\tallCampaignDefinitionIDs,\r\n\t\t\tallCandidateCampaignDefinitionIDs,\r\n\t\t\tchannelType: surveyInfo.getGovernedChannelType(),\r\n\t\t\tcontextCount: contextInfo ? contextInfo.length : undefined,\r\n\t\t\tcooldownPeriodNumber,\r\n\t\t\tnominationPeriodNumber,\r\n\t\t\tpercentageDenominator,\r\n\t\t\tpercentageNumerator,\r\n\t\t\tsurveyLauncherType: survey.getLauncherType(),\r\n\t\t\tbusinessLevel: surveyInfo.getBusinessLevel(),\r\n\t\t\tmaxLaunches: surveyInfo.getMaxLaunches(),\r\n\t\t\tmaxLaunchesPerSession: surveyInfo.getMaxLaunchesPerSession(),\r\n\t\t\tisContentValid: survey.isContentValid(),\r\n\t\t\tisUxSchemaPresent: !isNOU(survey.getUxSchema())\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getAllCandidateCampaignDefinitionIDs(): string[] {\r\n\r\n\t\tconst allCandidateCampaignDefinitionIDs: string[] = [];\r\n\r\n\t\t// Get all the candidate surveys' campaign definition IDs\r\n\t\tfor (const key in this.candidateSurveys) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.candidateSurveys, key)) {\r\n\t\t\t\tconst candidateSurvey: ISurvey = this.candidateSurveys[key];\r\n\t\t\t\tallCandidateCampaignDefinitionIDs.push(candidateSurvey.getSurveyInfo().getBackEndId());\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn allCandidateCampaignDefinitionIDs;\r\n\t}\r\n\r\n\tprivate getAllCampaignDefinitionIDs(): string[] {\r\n\r\n\t\tconst allCampaignDefinitions = this.surveyClient.getCampaignDefinitions();\r\n\t\tconst allCampaignDefinitionIDs: string[] = [];\r\n\r\n\t\tfor (const definitionsKey in allCampaignDefinitions) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(allCampaignDefinitions, definitionsKey)) {\r\n\t\t\t\tconst definition: ICampaignDefinition = allCampaignDefinitions[definitionsKey];\r\n\t\t\t\tallCampaignDefinitionIDs.push(definition.campaignId);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn allCampaignDefinitionIDs;\r\n\t}\r\n\r\n\tprivate updateActivityListenerWithCurrentSurveyDefinitions(): void {\r\n\t\tconst surveyList: ISurvey[] = this.getCurrentSurveyDefinitions();\r\n\t\tconst trackingContractList: ActivityTrackingContract[] = [];\r\n\r\n\t\tfor (const survey of surveyList) {\r\n\t\t\tconst surveyInfo = survey.getSurveyInfo();\r\n\t\t\tconst trackingContract = new ActivityTrackingContract(surveyInfo.getId(), surveyInfo.getActivationEvent().getTrackingSet());\r\n\t\t\ttrackingContractList.push(trackingContract);\r\n\t\t}\r\n\r\n\t\tthis.activityListener.SetActivityTrackingContracts(trackingContractList, this.previousSurveyEventActivityStats);\r\n\t}\r\n\r\n\tprivate setCriticalPendingSurveysAndUpdateActivityListener() {\r\n\t\tconst activeSurveys: IDictionary<ISurvey> = {};\r\n\r\n\t\t// Get all the candidate surveys' campaign definition IDs\r\n\t\tfor (const key in this.candidateSurveys) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.candidateSurveys, key)) {\r\n\t\t\t\tconst candidateSurvey: ISurvey = this.candidateSurveys[key];\r\n\t\t\t\tif (isCriticalSurvey(candidateSurvey.getSurveyInfo())) {\r\n\t\t\t\t\tactiveSurveys[key] = candidateSurvey;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (Object.keys(activeSurveys).length > 0) {\r\n\t\t\tthis.setPendingSurveys(activeSurveys);\r\n\t\t\tthis.updateActivityListenerWithCurrentSurveyDefinitions();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate shouldAcceptActivity(activityName: string): boolean {\r\n\t\treturn this.initializationStatus === InitializationStatus.Started ||\r\n\t\t\tactivityName === SurveyActivityListener.FloodgateStartActivityName;\r\n\t}\r\n\r\n\tprivate onSurveyActivated(surveyId: string, contextInfo: IContextData[]): void {\r\n\t\t// Find the survey object that corresponds to the surveyId passed\r\n\t\tconst surveys: ISurvey[] = this.getCurrentSurveyDefinitions();\r\n\t\tlet survey: ISurvey;\r\n\r\n\t\tfor (const tempSurvey of surveys) {\r\n\t\t\tif (tempSurvey.getSurveyInfo().getId() === surveyId) {\r\n\t\t\t\tsurvey = tempSurvey;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (isNOU(survey)) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Error(\r\n\t\t\t\tTelemetryEvent.FloodgateEngine.OnSurveyActivated.SurveyNotDefined,\r\n\t\t\t\t\"Survey is not defined in the current survey definitions.\",\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// this log will trigger when the user has first met the trigger action required to initially trigger the campaign.\r\n\t\t\t// this log occurs prior to the post governance checks which determines if the trigger is actually met and we can launch \r\n\t\t\t// the surface\r\n\t\t\t// Default sampling rate: 10%\r\n\t\t\tconst initialTriggerSamplingRate = this.campaignTelemetrySamplingConfig?.initialTriggerMetSamplingRate \r\n\t\t\t\t?? 0.1;\r\n\t\t\tif (initialTriggerSamplingRate > 0) {\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.CampaignInitialTriggerMet, \r\n\t\t\t\t\t{CampaignId: survey.getCampaignId(), Message: \"Sampling Rate: \" + initialTriggerSamplingRate}, initialTriggerSamplingRate);\r\n\t\t\t}\r\n\r\n\t\t\tconst governedChannelType: GovernedChannelType = survey.getSurveyInfo().getGovernedChannelType();\r\n\r\n\t\t\t// If the governance service is in use, launch survey asynchronously\r\n\t\t\tif (this.orchestrationEngine.isChannelGovernanceEnabled(governedChannelType) ||\r\n\t\t\t\t(this.floodgateEngineConfig.uiStringsCdnEnabled && isTranslationRequired(survey, this.floodgateEngineConfig.locale))) {\r\n\t\t\t\t// record the stale surveys, so we can clear its tracker if Engine is stopped\r\n\t\t\t\tthis.staleTriggeredSurveysQueue.push({\r\n\t\t\t\t\tsurvey: survey,\r\n\t\t\t\t\tcontextInfo: contextInfo\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// If there is no survey in stale before, launch the survey right away\r\n\t\t\t\tif (this.staleTriggeredSurveysQueue.length === 1) {\r\n\t\t\t\t\t// Launch the survey asynchronously\r\n\t\t\t\t\tthis.checkTriggerMetApisAndActivateSurvey(survey, contextInfo);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.activateSurvey(survey, contextInfo);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.OnSurveyActivated.Error,\r\n\t\t\t\t{ ErrorMessage: `Error activating survey ${e && e.toString()}`, ErrorDetails: e && e.stack });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate activateSurvey(survey: ISurvey, contextInfo: IContextData[]) {\r\n\t\tlet launchSurvey = false;\r\n\t\tconst governedChannelType = survey.getSurveyInfo().getGovernedChannelType();\r\n\r\n\t\t// Figure out if the activated survey is still relevant\r\n\t\tif (!this.candidateSurveys[survey.getSurveyInfo().getId()]) {\r\n\t\t\t// Survey is no longer relevant but was activated. Suppress it.\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationIrrelevantSurvey,\r\n\t\t\t\t{\r\n\t\t\t\t\tCampaignId: survey.getSurveyInfo().getBackEndId(),\r\n\t\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\t});\r\n\t\t} else if (!survey.getSurveyInfo().isActiveForDate(new Date())) {\r\n\t\t\t// Survey is no longer active (e.g. it was when we registered it but it has now expired)\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\tTelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationExpiredSurvey,\r\n\t\t\t\t{\r\n\t\t\t\t\tCampaignId: survey.getSurveyInfo().getBackEndId(),\r\n\t\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (isCriticalSurvey(survey.getSurveyInfo())) {\r\n\t\t\t\tlaunchSurvey = true;\r\n\t\t\t} else if (!this.orchestrationEngine.isChannelOpen(governedChannelType)) {\r\n\t\t\t\t// Channel has closed and maxLaunches is not set, suppress the survey\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,\r\n\t\t\t\t\t{ ClosedChannelType: GovernedChannelType[governedChannelType] });\r\n\t\t\t} else {\r\n\t\t\t\t// Get latest survey states from provider\r\n\t\t\t\tconst refreshedSurveyActivationStats = this.surveyActivationStatsProvider.load();\r\n\t\t\t\tif (refreshedSurveyActivationStats.getBySurveyId(survey.getSurveyInfo().getId())) {\r\n\t\t\t\t\t// Survey stats exists already, don't launch\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\t\tTelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tCampaignId: survey.getSurveyInfo().getBackEndId(),\r\n\t\t\t\t\t\t\tSurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t} else if (Object.keys(this.launchedSurveys).length === 0) {\r\n\t\t\t\t\t// for now we only support launching one survey per session unless it is multi-launch campaign\r\n\t\t\t\t\t// Track this survey activation for the launch history tracker\r\n\t\t\t\t\tlaunchSurvey = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst triggeredSurvey = Object.values(this.launchedSurveys)[0];\r\n\t\t\t\t\tif (!isNOU(triggeredSurvey)) {\r\n\t\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\t\t\tTelemetryEvent.FloodgateEngine.OnSurveyActivated.SessionSuppressedSurvey,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tCampaignId: triggeredSurvey.getSurveyInfo().getBackEndId(),\r\n\t\t\t\t\t\t\t\tSurveyId: triggeredSurvey.getSurveyInfo().getId(),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (launchSurvey) {\r\n\t\t\t\tthis.launchedSurveys[survey.getSurveyInfo().getId()] = survey;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// At this point, regardless of whether or not the survey is still relevant, we should flush out the stats\r\n\t\tthis.updateSurveyActivationStats(survey);\r\n\t\tthis.mergeAndSave();\r\n\t\t// shut off further survey launches\r\n\t\tthis.activityListener.clearSurveys();\r\n\r\n\t\t// Clear the survey from stale list\r\n\t\tthis.staleTriggeredSurveysQueue = [];\r\n\r\n\t\t// Actually launch the survey if possible\r\n\t\tif (launchSurvey) {\r\n\t\t\t// Get the stringified json with activity names, counts and isAggregate info for TriggetMet telemetry.\r\n\t\t\tconst activityTrackingString = survey.getSurveyInfo().getActivationEvent().getTrackingSet()\r\n\t\t\t\t.getActivityTrackingInfo(this.activityListener, survey.getSurveyInfo().getId());\r\n\r\n\t\t\tconst additionalSurveyInfo = this.getAdditionalSurveyInfoForTelemetry(survey, contextInfo, this.getAllCampaignDefinitionIDs(),\r\n\t\t\t\tthis.getAllCandidateCampaignDefinitionIDs());\r\n\r\n\t\t\t// Only adding the governance service client state at TriggerMet event\r\n\t\t\tadditionalSurveyInfo.governanceServiceClientState = this.orchestrationEngine.getStateForTelemetry();\r\n\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_TriggerMet(survey.getSurveyInfo().getBackEndId(), survey.getSurveyInfo().getId(),\r\n\t\t\t\tsurvey.getType(), activityTrackingString, JSON.stringify(additionalSurveyInfo), survey.getSurveyInfo().getTreatmentType(), \r\n\t\t\t\tadditionalSurveyInfo.isUxSchemaPresent);\r\n\r\n\t\t\t// Set govern channel\r\n\t\t\tthis.orchestrationEngine.startChannelCooldown(governedChannelType);\r\n\r\n\t\t\tconst surveyInfo = survey.getSurveyInfo();\r\n\t\t\tlet isSurveyComplete = true;\r\n\t\t\tif (isBusinessCriticalSurvey(surveyInfo)) {\r\n\t\t\t\t// critical campaigns are not tracked\r\n\t\t\t\tisSurveyComplete = false;\r\n\t\t\t} else if (isMultiLaunchSurvey(surveyInfo)) {\r\n\t\t\t\tconst surveyActivationStats = this.previousSurveyActivationStats.getBySurveyId(surveyInfo.getId());\r\n\t\t\t\tisSurveyComplete = hasSurveyReachedMaxLaunches(surveyInfo, surveyActivationStats);\r\n\t\t\t}\r\n\r\n\t\t\t// Set campaign states\r\n\t\t\tthis.surveyClient.onSurveyActivated(surveyInfo, isSurveyComplete);\r\n\r\n\t\t\t// Show the survey\r\n\t\t\tthis.launchLauncher(survey, contextInfo);\r\n\r\n\t\t\t// check if there are any critical campaigns and start tracking again\r\n\t\t\tthis.setCriticalPendingSurveysAndUpdateActivityListener();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async checkTriggerMetApisAndActivateSurvey(survey: ISurvey, contextInfo: IContextData[]): Promise<void> {\r\n\t\t// Get the cooldown setting\r\n\t\tconst campaignDefinition = this.surveyClient.getCampaignDefinitions()[survey.getCampaignId()];\r\n\t\tconst surveyLevelCooldown = campaignDefinition.nominationScheme.cooldownPeriod.asTimeIntervalSeconds();\r\n\t\tconst governedChannelType = survey.getSurveyInfo().getGovernedChannelType();\r\n\r\n\t\t// Call the TriggerMet Apis\r\n\t\tlet serviceResult: IGovernanceServiceResult;\r\n\t\ttry {\r\n\t\t\tconst governanceDecision = await this.queryTriggerMetApisAsync(survey, surveyLevelCooldown, governedChannelType);\r\n\t\t\tserviceResult = governanceDecision.serviceResult;\r\n\t\t} catch (e) {\r\n\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(TelemetryEvent.FloodgateEngine.QueryTriggerMetApisAsync.Exception,\r\n\t\t\t\t{ ErrorMessage: e && e.toString(), ErrorDetails: e && e.stack });\r\n\t\t\t// failure in case of exception\r\n\t\t\tserviceResult = {\r\n\t\t\t\tpermission: false\r\n\t\t\t};\r\n\t\t}\r\n\t\tlet launchSurvey = false;\r\n\r\n\t\t// Log the stale\r\n\t\tconst governanceResponseTelemetry = JSON.stringify(this.createGorvernanceResponseTelemetry(serviceResult, survey.getCampaignId()));\r\n\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\tTelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceClientCompleted,\r\n\t\t\t{\r\n\t\t\t\tMessage: governanceResponseTelemetry,\r\n\t\t\t});\r\n\r\n\t\t// Check if engine is still running\r\n\t\tif (this.initializationStatus !== InitializationStatus.Started) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!serviceResult.error) {\r\n\t\t\t// Check result is permitted\r\n\t\t\tif (serviceResult.permission) { // the Governance Service is permitting, continue to trigger\r\n\t\t\t\tlaunchSurvey = true;\r\n\t\t\t} else {\r\n\t\t\t\tif (serviceResult.lastTriggerSurvey?.timeUntilNextCampaignAllowed > 0) {\r\n\t\t\t\t\t// Set governed channel to new cooldown\r\n\t\t\t\t\tthis.orchestrationEngine.startChannelCooldown(governedChannelType, serviceResult.lastTriggerSurvey.lastTriggerCampaignTime);\r\n\r\n\t\t\t\t\t// Clear the survey relating to channel\r\n\t\t\t\t\tthis.clearSurveyWithChannel(governedChannelType);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tserviceResult.isSurveyGoverned &&\r\n\t\t\t\t\tserviceResult.lastTriggerSurvey?.timeUntilSameCampaignAllowed > 0\r\n\t\t\t\t) {\r\n\t\t\t\t\t// Log the event\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\t\tTelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceSurveyInCooldown,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tMessage: governanceResponseTelemetry,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tthis.putSurveyOnCooldown(survey, serviceResult);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// If force to display with error, continue to trigger the survey\r\n\t\t\tif (this.orchestrationEngine.shouldForcePermission()) {\r\n\t\t\t\tlaunchSurvey = true;\r\n\r\n\t\t\t\t// Log the force to display event\r\n\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\tTelemetryEvent.FloodgateEngine.CheckGovernanceServiceAndActivateSurvey.GovernanceServiceForceToDisplay,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tErrorMessage: serviceResult.errorMessage,\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (launchSurvey) {\r\n\t\t\t// Launch the survey\r\n\t\t\tthis.activateSurvey(survey, contextInfo);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If there is only one survey, which is the current one in process, clear queue and return\r\n\t\tif (this.staleTriggeredSurveysQueue.length <= 1) {\r\n\t\t\tthis.staleTriggeredSurveysQueue = [];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Remove the first activated survey from the list which is the current one in process\r\n\t\tthis.staleTriggeredSurveysQueue.shift();\r\n\t\tconst nextSurvey = this.staleTriggeredSurveysQueue[0].survey;\r\n\t\tconst nextContextInfo = this.staleTriggeredSurveysQueue[0].contextInfo;\r\n\r\n\t\t// Playback the next activated survey in waiting\r\n\t\tthis.checkTriggerMetApisAndActivateSurvey(nextSurvey, nextContextInfo);\r\n\t}\r\n\r\n\tprivate readString(fileType: FileType): string {\r\n\t\treturn this.storage.read(fileType);\r\n\t}\r\n\r\n\tprivate writeString(fileType: FileType, str: string): void {\r\n\t\tthis.storage.write(fileType, str);\r\n\t}\r\n\r\n\tprivate launchLauncher(survey: ISurvey, contextInfo: IContextData[]): void {\r\n\t\tconst launcher: ISurveyLauncher = this.launcherFactory.makeSurveyLauncher(survey);\r\n\t\tif (launcher) {\r\n\t\t\tthis.launchedLaunchers.push(launcher);\r\n\t\t\tthis.onSurveyActivatedCallback.onSurveyActivated(launcher, survey, { contextInfo });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate clearSurveyWithChannel(governedChannelType: GovernedChannelType) {\r\n\t\tconst activeSurveys: IDictionary<ISurvey> = {};\r\n\r\n\t\t// Get all the candidate surveys' campaign definition IDs\r\n\t\tfor (const key in this.candidateSurveys) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(this.candidateSurveys, key)) {\r\n\t\t\t\tconst candidateSurvey: ISurvey = this.candidateSurveys[key];\r\n\t\t\t\tif (candidateSurvey.getSurveyInfo().getGovernedChannelType() !== governedChannelType) {\r\n\t\t\t\t\tactiveSurveys[key] = candidateSurvey;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.candidateSurveys = activeSurveys;\r\n\t\tthis.activityListener.UpdateActivityTrackingContracts(this.candidateSurveys);\r\n\t}\r\n\r\n\tprivate createGorvernanceResponseTelemetry(serviceResult: IGovernanceServiceResult, campaignId: string) {\r\n\t\treturn {\r\n\t\t\tCampaignId: campaignId,\r\n\t\t\tFloodgateEngineStatus: this.initializationStatus.toString(),\r\n\t\t\tGovernanceServiceResult: serviceResult,\r\n\t\t\tStaleTriggeredSurveysQueueCount: this.staleTriggeredSurveysQueue.length - 1,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate putSurveyOnCooldown(survey: ISurvey, serviceResult: IGovernanceServiceResult): void {\r\n\t\t// Set the Survey on cooldown from the value returned from the service\r\n\t\tthis.surveyClient.modifyCampaignSurveyTakenDate(\r\n\t\t\tsurvey.getCampaignId(),\r\n\t\t\tserviceResult.lastTriggerSurvey.lastTriggerSameCampaignTime,\r\n\t\t\ttrue);\r\n\t}\r\n\r\n\tprivate async queryTriggerMetApisAsync(\r\n\t\tsurvey: ISurvey,\r\n\t\tsurveyLevelCooldown: number,\r\n\t\tchannel: GovernedChannelType): Promise<IGovernanceDecision> {\r\n\t\tconst isLoadingSurveyCdnRequired = isTranslationRequired(survey, this.floodgateEngineConfig.locale);\r\n\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\tTelemetryEvent.FloodgateEngine.QueryTriggerMetApisAsync.QueryTriggerMetApisAsync,\r\n\t\t\t{\r\n\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\tchannel,\r\n\t\t\t\t\tIsLoadingSurveyCdnRequired: isLoadingSurveyCdnRequired,\r\n\t\t\t\t\tGovServiceEnabled: this.orchestrationEngine.isChannelGovernanceEnabled(channel),\r\n\t\t\t\t\tFloodgateSurveyCdnClientEnabled: this.floodgateEngineConfig.uiStringsCdnEnabled\r\n\t\t\t\t}),\r\n\t\t\t});\r\n\r\n\t\tconst governanceParams: IGovernanceParameters = {\r\n\t\t\tcampaignId: survey.getCampaignId(),\r\n\t\t\tsurveyId: survey.getSurveyInfo().getId(),\r\n\t\t\tsurveyType: survey.getType(),\r\n\t\t\tchannelType: channel,\r\n\t\t\tlauncherType: survey.getLauncherType(),\r\n\t\t\tmaxLaunches: survey.getSurveyInfo().getMaxLaunches(),\r\n\t\t\tcampaignCooldown: surveyLevelCooldown,\r\n\t\t\tuserCooldown: -1,\r\n\t\t\tpersonalizerEnabled: false\r\n\t\t};\r\n\r\n\t\tconst businessLevel = survey.getSurveyInfo().getBusinessLevel() as unknown as CampaignBusinessLevel;\r\n\r\n\t\tif (isLoadingSurveyCdnRequired && this.floodgateEngineConfig.uiStringsCdnEnabled) {\r\n\t\t\tconst cdnSimpleRequestEnabled = getFeatureGateProvider()?.getBoolFeatureStatus(\"CdnSimpleRequestEnabled\", true);\r\n\t\t\tconst floodgateSurveyCdnClient = new FloodgateSurveyCdnClient(this.floodgateEngineConfig.uiStringsLoadingTimeout,\r\n\t\t\t\tthis.floodgateEngineConfig.uiStringCdnRetryLimit, cdnSimpleRequestEnabled);\r\n\t\t\tif (this.floodgateEngineConfig.shouldFetchSurveyCdnConcurrently) {\r\n\t\t\t\tconst loadCdnPromise = floodgateSurveyCdnClient.loadCdnStringResource(survey, this.floodgateEngineConfig.locale);\r\n\t\t\t\tconst checkPermission = this.getGovernanceDecision(businessLevel, governanceParams);\r\n\t\t\t\tconst [cdnLoadResult, mopResult] = await Promise.all([loadCdnPromise, checkPermission]);\r\n\t\t\t\t// if SurveyCDN is failed, return false no need to check for MOP result\r\n\t\t\t\tif (!cdnLoadResult) {\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\t\tTelemetryEvent.FloodgateEngine.QueryTriggerMetApisAsync.SurveyCdnFailureConcurrently,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\t\t\t\tcdnLoadResult,\r\n\t\t\t\t\t\t\t\tmopResult\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tgovernanceDecision: GovernanceDecision.Rejected\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\treturn mopResult;\r\n\t\t\t} else {\r\n\t\t\t\tconst cdnLoadResult = await floodgateSurveyCdnClient.loadCdnStringResource(survey, this.floodgateEngineConfig.locale);\r\n\t\t\t\t// if SurveyCDN is failed, return right away, no need to call MOP anymore\r\n\t\t\t\tif (!cdnLoadResult) {\r\n\t\t\t\t\tTelemetryLogger.getTelemetryLogger().log_Event(\r\n\t\t\t\t\t\tTelemetryEvent.FloodgateEngine.QueryTriggerMetApisAsync.SurveyCdnFailureSequentially,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\t\t\t\tcdnLoadResult\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tgovernanceDecision: GovernanceDecision.Rejected\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\treturn await this.getGovernanceDecision(businessLevel, governanceParams);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Current behavior\r\n\t\t\treturn this.getGovernanceDecision(businessLevel, governanceParams);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async getGovernanceDecision(businessLevel: CampaignBusinessLevel, governanceParams: IGovernanceParameters): Promise<IGovernanceDecision> {\r\n\t\tif (this.personalizerClient) {\r\n\t\t\tconst isEnabled = this.personalizerClient.isEnabled(governanceParams.surveyType, governanceParams.launcherType, governanceParams.channelType);\r\n\t\t\tgovernanceParams.personalizerEnabled = isEnabled;\r\n\t\t}\r\n\r\n\t\tconst governanceDecision = await this.orchestrationEngine.getDecision(businessLevel, governanceParams);\r\n\t\tif (governanceDecision && this.personalizerClient) {\r\n\t\t\tthis.personalizerClient.onGovernanceServiceResult(governanceParams, governanceDecision.serviceResult);\r\n\t\t}\r\n\r\n\t\treturn governanceDecision;\r\n\t}\r\n}\r\n", "/**\r\n * Main entry point.\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Utils from \"./src/Utils\";\r\n\r\nexport { FloodgateEngine } from \"./src/FloodgateEngine\";\r\nexport { TelemetryLogger } from \"./src/TelemetryLogger\";\r\nexport { Api, Utils };\r\n", "\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n//# sourceMappingURL=types.js.map", null, null, null, null, null, null, "/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.8+1e68dce6\n */\n", "export function objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nexport function isFunction(x) {\n  return typeof x === 'function';\n}\n\nexport function isMaybeThenable(x) {\n  return x !== null && typeof x === 'object';\n}\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nexport var isArray = _isArray;", "var len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nexport var asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nexport function setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nexport function setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}", "import { invokeCallback, subscribe, FULFILLED, REJECTED, noop, makePromise, PROMISE_ID } from './-internal';\n\nimport { asap } from './asap';\n\nexport default function then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}", "import { noop, resolve as _resolve } from '../-internal';\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nexport default function resolve(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  _resolve(promise, object);\n  return promise;\n}", "import { objectOrFunction, isFunction } from './utils';\n\nimport { asap } from './asap';\n\nimport originalThen from './then';\nimport originalResolve from './promise/resolve';\n\nexport var PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then) {\n  if (maybeThenable.constructor === promise.constructor && then === originalThen && maybeThenable.constructor.resolve === originalResolve) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then)) {\n      handleForeignThenable(promise, maybeThenable, then);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    var then = void 0;\n    try {\n      then = value.then;\n    } catch (error) {\n      reject(promise, error);\n      return;\n    }\n    handleMaybeThenable(promise, value, then);\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = true;\n\n  if (hasCallback) {\n    try {\n      value = callback(detail);\n    } catch (e) {\n      succeeded = false;\n      error = e;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (succeeded === false) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nexport { nextId, makePromise, noop, resolve, reject, fulfill, subscribe, publish, publishRejection, initializePromise, invokeCallback, FULFILLED, REJECTED, PENDING, handleMaybeThenable };", "function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport { isArray, isMaybeThenable } from './utils';\nimport { noop, reject, fulfill, subscribe, FULFILLED, REJECTED, PENDING, handleMaybeThenable } from './-internal';\n\nimport then from './then';\nimport Promise from './promise';\nimport originalResolve from './promise/resolve';\nimport originalThen from './then';\nimport { makePromise, PROMISE_ID } from './-internal';\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n};\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve = c.resolve;\n\n\n    if (resolve === originalResolve) {\n      var _then = void 0;\n      var error = void 0;\n      var didError = false;\n      try {\n        _then = entry.then;\n      } catch (e) {\n        didError = true;\n        error = e;\n      }\n\n      if (_then === originalThen && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise) {\n        var promise = new c(noop);\n        if (didError) {\n          reject(promise, error);\n        } else {\n          handleMaybeThenable(promise, entry, _then);\n        }\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve) {\n          return resolve(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\nexport default Enumerator;\n;", "import Enumerator from '../enumerator';\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nexport default function all(entries) {\n  return new Enumerator(this, entries).promise;\n}", "import { isArray } from \"../utils\";\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nexport default function race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}", "import { noop, reject as _reject } from '../-internal';\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nexport default function reject(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  _reject(promise, reason);\n  return promise;\n}", "function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nimport { isFunction } from './utils';\nimport { noop, nextId, PROMISE_ID, initializePromise } from './-internal';\nimport { asap, setAsap, setScheduler } from './asap';\n\nimport all from './promise/all';\nimport race from './promise/race';\nimport Resolve from './promise/resolve';\nimport Reject from './promise/reject';\nimport then from './then';\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise.prototype.then = then;\nexport default Promise;\nPromise.all = all;\nPromise.race = race;\nPromise.resolve = Resolve;\nPromise.reject = Reject;\nPromise._setScheduler = setScheduler;\nPromise._setAsap = setAsap;\nPromise._asap = asap;", "/*global self*/\nimport Promise from './promise';\n\nexport default function polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise;\n}", "import Promise from './es6-promise/promise';\nimport polyfill from './es6-promise/polyfill';\n\n// Strange compat..\nPromise.polyfill = polyfill;\nPromise.Promise = Promise;\nexport default Promise;", "// This file can be required in Browserify and Node.js for automatic polyfill\n// To use it:  require('es6-promise/auto');\n'use strict';\nmodule.exports = require('./').polyfill();\n", "{\n  \"name\": \"@ms/centro-hvc-loader\",\n  \"version\": \"4.7.4\",\n  \"description\": \"Project Centro high value component loader\",\n  \"license\": \"UNLICENSED\",\n  \"devDependencies\": {\n    \"@types/webpack-env\": \"1.15.1\",\n    \"typescript\": \"4.2.3\"\n  },\n  \"homepage\": \"https://office.visualstudio.com/OC/_git/M365AdminUX?path=%2Fmodules%2Fhvc-loader\",\n  \"bugs\": {\n    \"url\": \"https://office.visualstudio.com/OC/_workitems/edit/2364251\",\n    \"email\": \"centroinfo@microsoft.com\"\n  },\n  \"author\": \"MAC Platform Team <macplat@microsoft.com>\",\n  \"main\": \"./dist/hvc-loader/index.js\",\n  \"module\": \"./dist/hvc-loader/index.js\",\n  \"typings\": \"./dist/hvc-loader/index.d.ts\",\n  \"dependencies\": {\n    \"tslib\": \"^2.1.0\"\n  },\n  \"scripts\": {\n    \"build\": \"tsc -p ./tsconfig.json\"\n  }\n}", "import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from './App';\r\nimport { global_variables } from \"./freemarker-variables\";\r\nimport { APP_CONSTANTS, isProduction } from \"../src/utils/app-constants.js\";\r\n\r\nfunction initializeApp() {\r\n    if (!global_variables?.sso_id) {\r\n        const target = document.getElementById(APP_CONSTANTS.FLOODGATE.SURVEY_CONTAINER);\r\n        if (target) {\r\n            ReactDOM.render(<div style={{ padding: '20px', textAlign: 'center', color: '#666', fontFamily: 'Arial, sans-serif' }}>\r\n                    <h3>{APP_CONSTANTS.ERROR_MESSAGES.AUTH_REQUIRED}</h3>\r\n                    <p>Please log in with your SSO account to access this application.</p>\r\n            </div>, target);\r\n        }\r\n        return;\r\n    }\r\n\r\n    const target = document.getElementById(APP_CONSTANTS.FLOODGATE.SURVEY_CONTAINER);\r\n    if (!target) {\r\n        console.error(APP_CONSTANTS.ERROR_MESSAGES.TARGET_NOT_FOUND + \":\", APP_CONSTANTS.FLOODGATE.SURVEY_CONTAINER);\r\n        return;\r\n    }\r\n\r\n    try {\r\n       ReactDOM.render(<App />, target);\r\n        if (!isProduction()) {\r\n            console.log(APP_CONSTANTS.SUCCESS_MESSAGES.APP_RENDERED);\r\n        }\r\n    } catch (error) {\r\n        console.error(APP_CONSTANTS.ERROR_MESSAGES.RENDER_FAILED + \":\", error);\r\n    }\r\n}\r\n\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', initializeApp);\r\n} else {\r\n    initializeApp();\r\n}", "import React from \"react\";\r\nimport { FluentProvider, webLightTheme } from \"@fluentui/react-components\";\r\nimport { FloodgateProvider } from \"./providers/FloodgateProvider\";\r\nimport { FloodgateTrigger } from \"./components/FloodgateTrigger\";\r\n\r\nconst App = () => (\r\n    <FluentProvider theme={webLightTheme}>\r\n        <FloodgateProvider>\r\n            <div style={{ margin: 32 }}>\r\n                <FloodgateTrigger />\r\n            </div>\r\n        </FloodgateProvider>\r\n    </FluentProvider>\r\n);\r\n\r\nexport default App;", "import type { GriffelStylesUnsupportedCSSProperties } from '@griffel/style-types';\nimport type { LookupItem, SequenceHash } from './types';\n\n// ----\n\n// Heads up!\n// These constants are global and will be shared between Griffel instances.\n// Any change in them should happen only in a MAJOR version. If it happens,\n// please change \"__NAMESPACE_PREFIX__\" to include a version.\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst __GLOBAL__: any = typeof window === 'undefined' ? global : window;\nconst __NAMESPACE_PREFIX__ = '@griffel/';\n\nfunction getGlobalVar<T>(name: string, defaultValue: T): T {\n  if (!__GLOBAL__[Symbol.for(__NAMESPACE_PREFIX__ + name)]) {\n    __GLOBAL__[Symbol.for(__NAMESPACE_PREFIX__ + name)] = defaultValue;\n  }\n\n  return __GLOBAL__[Symbol.for(__NAMESPACE_PREFIX__ + name)];\n}\n\n/** @internal */\nexport const DEBUG_RESET_CLASSES = getGlobalVar<Record<string, 1>>('DEBUG_RESET_CLASSES', {});\n\n/** @internal */\nexport const DEFINITION_LOOKUP_TABLE = getGlobalVar<Record<SequenceHash, LookupItem>>('DEFINITION_LOOKUP_TABLE', {});\n\n// ----\n\n/** @internal */\nexport const DATA_BUCKET_ATTR = 'data-make-styles-bucket';\n\n/** @internal */\nexport const DATA_PRIORITY_ATTR = 'data-priority';\n\n/** @internal */\nexport const HASH_PREFIX = 'f';\n\n/** @internal */\nexport const RESET_HASH_PREFIX = 'r';\n\n/** @internal */\nexport const SEQUENCE_HASH_LENGTH = 7;\n\n/** @internal */\nexport const SEQUENCE_PREFIX = '___';\n\n/** @internal */\nexport const DEBUG_SEQUENCE_SEPARATOR = '_';\n\n/** @internal */\nexport const SEQUENCE_SIZE =\n  process.env.NODE_ENV === 'production'\n    ? SEQUENCE_PREFIX.length + SEQUENCE_HASH_LENGTH\n    : SEQUENCE_PREFIX.length + SEQUENCE_HASH_LENGTH + DEBUG_SEQUENCE_SEPARATOR.length + SEQUENCE_HASH_LENGTH;\n\n// indexes for values in LookupItem tuple\n\n/** @internal */\nexport const LOOKUP_DEFINITIONS_INDEX = 0;\n\n/** @internal */\nexport const LOOKUP_DIR_INDEX = 1;\n\n// This collection is a map simply for faster access when checking if a CSS property is unsupported\n/** @internal */\nexport const UNSUPPORTED_CSS_PROPERTIES: Record<keyof GriffelStylesUnsupportedCSSProperties, 1> = {\n  all: 1,\n  borderColor: 1,\n  borderStyle: 1,\n  borderWidth: 1,\n\n  borderBlock: 1,\n  borderBlockEnd: 1,\n  borderBlockStart: 1,\n  borderInline: 1,\n  borderInlineEnd: 1,\n  borderInlineStart: 1,\n} as const;\n\n/**\n * Removes a CSS property from the style object.\n *\n * @link https://griffel.js.org/react/api/make-styles\n *\n * Do not use the value directly, use `RESET` constant instead.\n */\nexport const RESET = 'DO_NOT_USE_DIRECTLY: @griffel/reset-value' as unknown as 'unset';\n", "/* eslint-disable */\n// Inspired by https://github.com/garycourt/murmurhash-js\n// Ported from https://github.com/aappleby/smhasher/blob/61a0530f28277f2e850bfc39600ce61d02b518de/src/MurmurHash2.cpp#L37-L86\nfunction murmur2(str) {\n  // 'm' and 'r' are mixing constants generated offline.\n  // They're not really 'magic', they just happen to work well.\n  // const m = 0x5bd1e995;\n  // const r = 24;\n  // Initialize the hash\n  var h = 0; // Mix 4 bytes at a time into the hash\n\n  var k,\n      i = 0,\n      len = str.length;\n\n  for (; len >= 4; ++i, len -= 4) {\n    k = str.charCodeAt(i) & 0xff | (str.charCodeAt(++i) & 0xff) << 8 | (str.charCodeAt(++i) & 0xff) << 16 | (str.charCodeAt(++i) & 0xff) << 24;\n    k =\n    /* Math.imul(k, m): */\n    (k & 0xffff) * 0x5bd1e995 + ((k >>> 16) * 0xe995 << 16);\n    k ^=\n    /* k >>> r: */\n    k >>> 24;\n    h =\n    /* Math.imul(k, m): */\n    (k & 0xffff) * 0x5bd1e995 + ((k >>> 16) * 0xe995 << 16) ^\n    /* Math.imul(h, m): */\n    (h & 0xffff) * 0x5bd1e995 + ((h >>> 16) * 0xe995 << 16);\n  } // Handle the last few bytes of the input array\n\n\n  switch (len) {\n    case 3:\n      h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n\n    case 2:\n      h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n\n    case 1:\n      h ^= str.charCodeAt(i) & 0xff;\n      h =\n      /* Math.imul(h, m): */\n      (h & 0xffff) * 0x5bd1e995 + ((h >>> 16) * 0xe995 << 16);\n  } // Do a few final mixes of the hash to ensure the last few\n  // bytes are well-incorporated.\n\n\n  h ^= h >>> 13;\n  h =\n  /* Math.imul(h, m): */\n  (h & 0xffff) * 0x5bd1e995 + ((h >>> 16) * 0xe995 << 16);\n  return ((h ^ h >>> 15) >>> 0).toString(36);\n}\n\nexport { murmur2 as default };\n", "import hash from '@emotion/hash';\n\nimport { DEBUG_SEQUENCE_SEPARATOR, SEQUENCE_HASH_LENGTH, SEQUENCE_PREFIX } from '../../constants';\nimport type { SequenceHash } from '../../types';\n\nfunction padEndHash(value: string): string {\n  const hashLength = value.length;\n\n  if (hashLength === SEQUENCE_HASH_LENGTH) {\n    return value;\n  }\n\n  for (let i = hashLength; i < SEQUENCE_HASH_LENGTH; i++) {\n    value += '0';\n  }\n\n  return value;\n}\n\nexport function hashSequence(\n  classes: string,\n  dir: 'ltr' | 'rtl',\n  sequenceIds: (SequenceHash | undefined)[] = [],\n): SequenceHash {\n  if (process.env.NODE_ENV === 'production') {\n    return SEQUENCE_PREFIX + padEndHash(hash(classes + dir));\n  }\n\n  return (\n    SEQUENCE_PREFIX +\n    padEndHash(hash(classes + dir)) +\n    DEBUG_SEQUENCE_SEPARATOR +\n    padEndHash(hash(sequenceIds.join('')))\n  );\n}\n", "import { DEFINITION_LOOKUP_TABLE } from '../constants';\nimport { hashSequence } from './utils/hashSequence';\nimport type { CSSClassesMapBySlot, CSSClassesMap, CSSClasses } from '../types';\n\n/**\n * Reduces a classname map for slot to a classname string. Uses classnames according to text directions.\n *\n * @private\n */\nexport function reduceToClassName(classMap: CSSClassesMap, dir: 'ltr' | 'rtl'): [string, string] {\n  // - `classString` is a string of classnames separated by a space, used to output classes\n  // - `hashString` is a string of classnames separated by a space, used to generate a hash\n  //\n  // `hashString` is needed to handle `null` values in a class map as they don't produce any classes.\n  let classString = '';\n  let hashString = '';\n\n  // eslint-disable-next-line guard-for-in\n  for (const propertyHash in classMap) {\n    const classNameMapping: CSSClasses = classMap[propertyHash];\n\n    if (classNameMapping === 0) {\n      hashString += propertyHash + ' ';\n      continue;\n    }\n\n    const hasRTLClassName = Array.isArray(classNameMapping);\n    const className =\n      dir === 'rtl'\n        ? (hasRTLClassName ? classNameMapping[1] : classNameMapping) + ' '\n        : (hasRTLClassName ? classNameMapping[0] : classNameMapping) + ' ';\n\n    classString += className;\n    hashString += className;\n  }\n\n  return [classString.slice(0, -1), hashString.slice(0, -1)];\n}\n\n/**\n * Reduces classname maps for slots to classname strings. Registers them in a definition cache to be used by\n * `mergeClasses()`.\n *\n * @internal\n */\nexport function reduceToClassNameForSlots<Slots extends string | number>(\n  classesMapBySlot: CSSClassesMapBySlot<Slots>,\n  dir: 'ltr' | 'rtl',\n): Record<Slots, string> {\n  const classNamesForSlots = {} as Record<Slots, string>;\n\n  // eslint-disable-next-line guard-for-in\n  for (const slotName in classesMapBySlot) {\n    const [slotClasses, slotClassesHash] = reduceToClassName(classesMapBySlot[slotName], dir);\n\n    // Handles a case when there are no classes in a set i.e. \"makeStyles({ root: {} })\"\n    if (slotClassesHash === '') {\n      classNamesForSlots[slotName] = '';\n      continue;\n    }\n\n    const sequenceHash = hashSequence(slotClassesHash, dir);\n    const resultSlotClasses = sequenceHash + (slotClasses === '' ? '' : ' ' + slotClasses);\n\n    DEFINITION_LOOKUP_TABLE[sequenceHash] = [classesMapBySlot[slotName], dir];\n    classNamesForSlots[slotName] = resultSlotClasses;\n  }\n\n  return classNamesForSlots;\n}\n", "import {\n  DEBUG_RESET_CLASSES,\n  DEFINITION_LOOKUP_TABLE,\n  LOOKUP_DEFINITIONS_INDEX,\n  LOOKUP_DIR_INDEX,\n  RESET_HASH_PREFIX,\n  SEQUENCE_PREFIX,\n  SEQUENCE_SIZE,\n} from './constants';\nimport { hashSequence } from './runtime/utils/hashSequence';\nimport { reduceToClassName } from './runtime/reduceToClassNameForSlots';\nimport type { CSSClassesMap, SequenceHash } from './types';\n\n// Contains a mapping of previously resolved sequences of atomic classnames\nexport const mergeClassesCachedResults: Record<string, string> = {};\n\n/**\n * Function can take any number of arguments, joins classes together and deduplicates atomic declarations generated by\n * `makeStyles()`. Handles scoped directional styles.\n *\n * Classnames can be of any length, this function can take both atomic declarations and class names.\n *\n * Input:\n * ```\n * // not real classes\n * mergeClasses('ui-button', 'displayflex', 'displaygrid')\n * ```\n *\n * Output:\n * ```\n * 'ui-button displaygrid'\n * ```\n */\nexport function mergeClasses(...classNames: (string | false | undefined)[]): string;\n\nexport function mergeClasses(): string {\n  // arguments are parsed manually to avoid double loops as TS & Babel transforms rest via an additional loop\n  // @see https://babeljs.io/docs/en/babel-plugin-transform-parameters\n  /* eslint-disable prefer-rest-params */\n\n  let dir: 'ltr' | 'rtl' | null = null;\n  let resultClassName = '';\n\n  // Is used as a cache key to avoid object merging\n  let sequenceMatch = '';\n  const sequencesIds: (SequenceHash | undefined)[] = new Array(arguments.length);\n\n  let containsResetClassName = '';\n\n  for (let i = 0; i < arguments.length; i++) {\n    const className = arguments[i];\n\n    if (typeof className === 'string' && className !== '') {\n      // All classes generated by `makeStyles()` are prefixed by a sequence hash, this allows to identify class sets\n      // without parsing each className in a string\n      const sequenceIndex = className.indexOf(SEQUENCE_PREFIX);\n\n      if (sequenceIndex === -1) {\n        if (process.env.NODE_ENV !== 'production') {\n          className.split(' ').forEach(entry => {\n            if (entry.startsWith(RESET_HASH_PREFIX) && DEBUG_RESET_CLASSES[entry]) {\n              if (containsResetClassName) {\n                // eslint-disable-next-line no-console\n                console.error(\n                  'mergeClasses(): a passed string contains multiple classes produced by makeResetStyles (' +\n                    `${className} & ${resultClassName}, this will lead to non-deterministic behavior. Learn more:` +\n                    'https://griffel.js.org/react/api/make-reset-styles#limitations' +\n                    '\\n' +\n                    `Source string: ${className}`,\n                );\n              } else {\n                containsResetClassName = entry;\n              }\n            }\n          });\n        }\n\n        resultClassName += className + ' ';\n      } else {\n        const sequenceId = className.substr(sequenceIndex, SEQUENCE_SIZE);\n\n        // Handles a case with mixed classnames, i.e. \"ui-button ATOMIC_CLASSES\"\n        if (sequenceIndex > 0) {\n          resultClassName += className.slice(0, sequenceIndex);\n        }\n\n        sequenceMatch += sequenceId;\n        sequencesIds[i] = sequenceId;\n      }\n\n      if (process.env.NODE_ENV !== 'production') {\n        if (className.indexOf(SEQUENCE_PREFIX, sequenceIndex + 1) !== -1) {\n          // eslint-disable-next-line no-console\n          console.error(\n            'mergeClasses(): a passed string contains multiple identifiers of atomic classes (classes that start ' +\n              `with \"${SEQUENCE_PREFIX}\"), it's possible that passed classes were concatenated in a wrong way. ` +\n              `Source string: ${className}`,\n          );\n        }\n      }\n    }\n  }\n\n  // .slice() there allows to avoid trailing space for non-atomic classes\n  // \"ui-button ui-flex \" => \"ui-button ui-flex\"\n  if (sequenceMatch === '') {\n    return resultClassName.slice(0, -1);\n  }\n\n  // It's safe to reuse results to avoid continuous merging as results are stable\n  // \"__seq1 ... __seq2 ...\" => \"__seq12 ...\"\n  const mergeClassesResult = mergeClassesCachedResults[sequenceMatch];\n\n  if (mergeClassesResult !== undefined) {\n    return resultClassName + mergeClassesResult;\n  }\n\n  const sequenceMappings: CSSClassesMap[] = [];\n\n  for (let i = 0; i < arguments.length; i++) {\n    const sequenceId = sequencesIds[i];\n\n    if (sequenceId) {\n      const sequenceMapping = DEFINITION_LOOKUP_TABLE[sequenceId];\n\n      if (sequenceMapping) {\n        sequenceMappings.push(sequenceMapping[LOOKUP_DEFINITIONS_INDEX]);\n\n        if (process.env.NODE_ENV !== 'production') {\n          if (dir !== null && dir !== sequenceMapping[LOOKUP_DIR_INDEX]) {\n            // eslint-disable-next-line no-console\n            console.error(\n              `mergeClasses(): a passed string contains an identifier (${sequenceId}) that has different direction ` +\n                `(dir=\"${sequenceMapping[1] ? 'rtl' : 'ltr'}\") setting than other classes. This is not supported. ` +\n                `Source string: ${arguments[i]}`,\n            );\n          }\n        }\n\n        dir = sequenceMapping[LOOKUP_DIR_INDEX];\n      } else {\n        if (process.env.NODE_ENV !== 'production') {\n          // eslint-disable-next-line no-console\n          console.error(\n            `mergeClasses(): a passed string contains an identifier (${sequenceId}) that does not match any entry ` +\n              `in cache. Source string: ${arguments[i]}`,\n          );\n        }\n      }\n    }\n  }\n\n  // eslint-disable-next-line prefer-spread\n  const resultClassesMap = Object.assign.apply<ObjectConstructor, CSSClassesMap[], CSSClassesMap>(\n    Object,\n    // .assign() mutates the first object, we can't mutate mappings as it will produce invalid results later\n    [{}].concat(sequenceMappings),\n  );\n  const [atomicClasses, classesMapHash] = reduceToClassName(resultClassesMap, dir!);\n\n  // Each merge of classes generates a new sequence of atomic classes that needs to be registered\n  const newSequenceHash = hashSequence(classesMapHash, dir!, sequencesIds);\n  const newClassName = newSequenceHash + ' ' + atomicClasses;\n\n  mergeClassesCachedResults[sequenceMatch] = newClassName;\n  DEFINITION_LOOKUP_TABLE[newSequenceHash] = [resultClassesMap, dir!];\n\n  return resultClassName + newClassName;\n}\n", "import type { CSSBucketEntry } from '../../types';\n\n/**\n * @internal\n *\n * @param entry - CSS bucket entry that can be either a string or an array\n * @returns An array where the first element is the CSS rule\n */\nexport function normalizeCSSBucketEntry(entry: CSSBucketEntry): [string] | [string, Record<string, unknown>] {\n  if (!Array.isArray(entry)) {\n    return [entry];\n  }\n\n  if (process.env.NODE_ENV !== 'production' && entry.length > 2) {\n    throw new Error(\n      'CSS Bucket contains an entry with greater than 2 items, please report this to https://github.com/microsoft/griffel/issues',\n    );\n  }\n\n  return entry;\n}\n", "import { DATA_BUCKET_ATTR, DATA_PRIORITY_ATTR } from '../constants';\nimport type { IsomorphicStyleSheet, StyleBucketName } from '../types';\n\nexport function createIsomorphicStyleSheet(\n  styleElement: HTMLStyleElement | undefined,\n  bucketName: StyleBucketName,\n  priority: number,\n  elementAttributes: Record<string, string>,\n): IsomorphicStyleSheet {\n  // no CSSStyleSheet in SSR, just append rules here for server render\n  const __cssRulesForSSR: string[] = [];\n\n  elementAttributes[DATA_BUCKET_ATTR] = bucketName;\n  elementAttributes[DATA_PRIORITY_ATTR] = String(priority);\n\n  if (styleElement) {\n    for (const attrName in elementAttributes) {\n      styleElement.setAttribute(attrName, elementAttributes[attrName]);\n    }\n  }\n\n  function insertRule(rule: string) {\n    if (styleElement?.sheet) {\n      return styleElement.sheet.insertRule(rule, styleElement.sheet.cssRules.length);\n    }\n\n    return __cssRulesForSSR.push(rule);\n  }\n\n  return {\n    elementAttributes,\n    insertRule,\n    element: styleElement,\n    bucketName,\n    cssRules() {\n      if (styleElement?.sheet) {\n        return Array.from(styleElement.sheet.cssRules).map(cssRule => cssRule.cssText);\n      }\n\n      return __cssRulesForSSR;\n    },\n  };\n}\n\nexport function createIsomorphicStyleSheetFromElement(element: HTMLStyleElement) {\n  const elementAttributes = Array.from(element.attributes).reduce((acc, attr) => {\n    acc[attr.name] = attr.value;\n    return acc;\n  }, {} as Record<string, string>);\n  const stylesheet = createIsomorphicStyleSheet(\n    element,\n    elementAttributes[DATA_BUCKET_ATTR] as StyleBucketName,\n    Number(elementAttributes[DATA_PRIORITY_ATTR]),\n    elementAttributes,\n  );\n  return stylesheet;\n}\n", "import { DATA_BUCKET_ATTR, DATA_PRIORITY_ATTR } from '../constants';\nimport type { GriffelRenderer, IsomorphicStyleSheet, StyleBucketName } from '../types';\nimport { createIsomorphicStyleSheet } from './createIsomorphicStyleSheet';\n\n/**\n * Ordered style buckets using their short pseudo name.\n *\n * @internal\n */\nexport const styleBucketOrdering: StyleBucketName[] = [\n  // reset styles\n  'r',\n  // catch-all\n  'd',\n  // link\n  'l',\n  // visited\n  'v',\n  // focus-within\n  'w',\n  // focus\n  'f',\n  // focus-visible\n  'i',\n  // hover\n  'h',\n  // active\n  'a',\n  // at rules for reset styles\n  's',\n  // keyframes\n  'k',\n  // at-rules\n  't',\n  // @media rules\n  'm',\n  // @container rules\n  'c',\n];\n\n// avoid repeatedly calling `indexOf` to determine order during new insertions\nconst styleBucketOrderingMap = styleBucketOrdering.reduce((acc, cur, j) => {\n  acc[cur as StyleBucketName] = j;\n  return acc;\n}, {} as Record<StyleBucketName, number>);\n\nexport function getStyleSheetKey(bucketName: StyleBucketName, media: string, priority: number | string): string {\n  return (bucketName === 'm' ? bucketName + media : bucketName) + priority;\n}\n\nexport function getStyleSheetKeyFromElement(styleEl: HTMLStyleElement): string {\n  const bucketName = styleEl.getAttribute(DATA_BUCKET_ATTR) as StyleBucketName;\n  const priority = styleEl.getAttribute(DATA_PRIORITY_ATTR) ?? '0';\n\n  return getStyleSheetKey(bucketName, styleEl.media, priority);\n}\n\n/**\n * Lazily adds a `<style>` bucket to the `<head>`. This will ensure that the style buckets are ordered.\n */\nexport function getStyleSheetForBucket(\n  bucketName: StyleBucketName,\n  targetDocument: Document | undefined,\n  insertionPoint: HTMLElement | null,\n  renderer: GriffelRenderer,\n  metadata: Record<string, unknown> = {},\n): IsomorphicStyleSheet {\n  const isMediaBucket = bucketName === 'm';\n\n  const media = (metadata['m'] as string | undefined) ?? '0';\n  const priority = (metadata['p'] as number | undefined) ?? 0;\n\n  const stylesheetKey = getStyleSheetKey(bucketName, media, priority);\n\n  if (!renderer.stylesheets[stylesheetKey]) {\n    const tag: HTMLStyleElement | undefined = targetDocument && targetDocument.createElement('style');\n    const stylesheet = createIsomorphicStyleSheet(tag, bucketName, priority, {\n      ...renderer.styleElementAttributes,\n      ...(isMediaBucket && { media }),\n    });\n\n    renderer.stylesheets[stylesheetKey] = stylesheet;\n\n    if (targetDocument?.head && tag) {\n      targetDocument.head.insertBefore(\n        tag,\n        findInsertionPoint(targetDocument, insertionPoint, bucketName, renderer, metadata),\n      );\n    }\n  }\n\n  return renderer.stylesheets[stylesheetKey]!;\n}\n\nfunction isSameInsertionKey(\n  element: HTMLStyleElement,\n  bucketName: StyleBucketName,\n  metadata: Record<string, unknown>,\n): boolean {\n  const targetKey = bucketName + ((metadata['m'] as string | undefined) ?? '');\n  const elementKey = element.getAttribute(DATA_BUCKET_ATTR) + (element.media ?? '');\n\n  return targetKey === elementKey;\n}\n\n/**\n * Finds an element before which the new bucket style element should be inserted following the bucket sort order.\n *\n * @param targetDocument - A document\n * @param insertionPoint - An element that will be used as an initial insertion point\n * @param targetBucket - The bucket that should be inserted to DOM\n * @param renderer - Griffel renderer\n * @param metadata - metadata for CSS rule\n * @returns - Smallest style element with greater sort order than the current bucket\n */\nfunction findInsertionPoint(\n  targetDocument: Document,\n  insertionPoint: HTMLElement | null,\n  targetBucket: StyleBucketName,\n  renderer: GriffelRenderer,\n  metadata: Record<string, unknown> = {},\n): Node | null {\n  const targetOrder = styleBucketOrderingMap[targetBucket];\n\n  const media = (metadata['m'] as string | undefined) ?? '';\n  const priority = (metadata['p'] as number | undefined) ?? 0;\n\n  // Similar to javascript sort comparators where\n  // a positive value is increasing sort order\n  // a negative value is decreasing sort order\n  let comparer: (el: HTMLStyleElement) => number = el =>\n    targetOrder - styleBucketOrderingMap[el.getAttribute(DATA_BUCKET_ATTR) as StyleBucketName];\n  let styleElements = targetDocument.head.querySelectorAll<HTMLStyleElement>(`[${DATA_BUCKET_ATTR}]`);\n\n  if (targetBucket === 'm') {\n    const mediaElements = targetDocument.head.querySelectorAll<HTMLStyleElement>(\n      `[${DATA_BUCKET_ATTR}=\"${targetBucket}\"]`,\n    );\n\n    // only reduce the scope of the search and change comparer\n    // if there are other media buckets already on the page\n    if (mediaElements.length) {\n      styleElements = mediaElements;\n      comparer = (el: HTMLStyleElement) => renderer.compareMediaQueries(media, el.media);\n    }\n  }\n\n  const comparerWithPriority: (el: HTMLStyleElement) => number = el => {\n    if (isSameInsertionKey(el, targetBucket, metadata)) {\n      return priority - Number(el.getAttribute('data-priority'));\n    }\n\n    return comparer(el);\n  };\n\n  const length = styleElements.length;\n  let index = length - 1;\n\n  while (index >= 0) {\n    const styleElement = styleElements.item(index);\n\n    if (comparerWithPriority(styleElement) > 0) {\n      return styleElement.nextSibling;\n    }\n\n    index--;\n  }\n\n  if (length > 0) {\n    return styleElements.item(0);\n  }\n\n  return insertionPoint ? insertionPoint.nextSibling : null;\n}\n", "/**\n * Suffixes to be ignored in case of error\n */\nconst ignoreSuffixes = [\n  '-moz-placeholder',\n  '-moz-focus-inner',\n  '-moz-focusring',\n  '-ms-input-placeholder',\n  '-moz-read-write',\n  '-moz-read-only',\n].join('|');\nconst ignoreSuffixesRegex = new RegExp(`:(${ignoreSuffixes})`);\n\n/**\n * @internal\n *\n * Calls `sheet.insertRule` and catches errors related to browser prefixes.\n */\nexport function safeInsertRule(sheet: { insertRule(rule: string): number | undefined }, ruleCSS: string): void {\n  try {\n    sheet.insertRule(ruleCSS);\n  } catch (e) {\n    // We've disabled these warnings due to false-positive errors with browser prefixes\n    if (process.env.NODE_ENV !== 'production' && !ignoreSuffixesRegex.test(ruleCSS)) {\n      // eslint-disable-next-line no-console\n      console.error(`There was a problem inserting the following rule: \"${ruleCSS}\"`, e);\n    }\n  }\n}\n", "import { injectDevTools, isDevToolsEnabled, debugData } from '../devtools';\nimport { normalizeCSSBucketEntry } from '../runtime/utils/normalizeCSSBucketEntry';\nimport type { GriffelRenderer, StyleBucketName } from '../types';\nimport { getStyleSheetForBucket } from './getStyleSheetForBucket';\nimport { safeInsertRule } from './safeInsertRule';\n\nlet lastIndex = 0;\n\nexport interface CreateDOMRendererOptions {\n  /**\n   * A salt that will be added for hashed classes. Should be the same for all renderers in the same application\n   * (bundle).\n   *\n   * @see https://github.com/microsoft/griffel/issues/453\n   */\n  classNameHashSalt?: string;\n\n  /**\n   * If specified, a renderer will insert created style tags after this element.\n   */\n  insertionPoint?: HTMLElement;\n\n  /**\n   * A map of attributes that's passed to the generated style elements. Is useful to set \"nonce\" attribute.\n   *\n   * @see https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/nonce\n   */\n  styleElementAttributes?: Record<string, string>;\n\n  /**\n   * A filter run before CSS rule insertion to systematically remove CSS rules at render time.\n   * This can be used to forbid specific rules from being written to the style sheet at run time without\n   * affecting build time styles.\n   *\n   *  Keep the filter as performant as possible to avoid negative performance impacts to your application.\n   *  This API is unstable and can be removed from the library at any time.\n   */\n  unstable_filterCSSRule?: (cssRule: string) => boolean;\n\n  /**\n   * @param a - media query\n   * @param b - media query\n   * @returns positive number if a > b or negative number if a < b\n   */\n  compareMediaQueries?: (a: string, b: string) => number;\n}\n\n/** @internal */\nexport const defaultCompareMediaQueries = (a: string, b: string) => (a < b ? -1 : a > b ? 1 : 0);\n\n/**\n * Creates a new instances of a renderer.\n *\n * @public\n */\nexport function createDOMRenderer(\n  targetDocument: Document | undefined = typeof document === 'undefined' ? undefined : document,\n  options: CreateDOMRendererOptions = {},\n): GriffelRenderer {\n  const {\n    classNameHashSalt,\n    unstable_filterCSSRule,\n    insertionPoint,\n    styleElementAttributes,\n    compareMediaQueries = defaultCompareMediaQueries,\n  } = options;\n  const renderer: GriffelRenderer = {\n    classNameHashSalt,\n    insertionCache: {},\n    stylesheets: {},\n    styleElementAttributes: Object.freeze(styleElementAttributes),\n    compareMediaQueries,\n\n    id: `d${lastIndex++}`,\n\n    insertCSSRules(cssRules) {\n      // eslint-disable-next-line guard-for-in\n      for (const styleBucketName in cssRules) {\n        const cssRulesForBucket = cssRules[styleBucketName as StyleBucketName]!;\n\n        // This is a hot path in rendering styles: \".length\" is cached in \"l\" var to avoid accesses the property\n        for (let i = 0, l = cssRulesForBucket.length; i < l; i++) {\n          const [ruleCSS, metadata] = normalizeCSSBucketEntry(cssRulesForBucket[i]);\n          const sheet = getStyleSheetForBucket(\n            styleBucketName as StyleBucketName,\n            targetDocument,\n            insertionPoint || null,\n            renderer,\n            metadata,\n          );\n\n          if (renderer.insertionCache[ruleCSS]) {\n            continue;\n          }\n\n          renderer.insertionCache[ruleCSS] = styleBucketName as StyleBucketName;\n\n          if (process.env.NODE_ENV !== 'production' && isDevToolsEnabled) {\n            debugData.addCSSRule(ruleCSS);\n          }\n\n          if (unstable_filterCSSRule) {\n            if (unstable_filterCSSRule(ruleCSS)) {\n              safeInsertRule(sheet, ruleCSS);\n            }\n          } else {\n            safeInsertRule(sheet, ruleCSS);\n          }\n        }\n      }\n    },\n  };\n\n  if (targetDocument && process.env.NODE_ENV !== 'production' && isDevToolsEnabled) {\n    injectDevTools(targetDocument);\n  }\n\n  return renderer;\n}\n", "import type { CSSRulesByBucket, GriffelInsertionFactory, GriffelRenderer } from './types';\n\n/**\n * Default implementation of insertion factory. Inserts styles only once per renderer and performs\n * insertion immediately after styles computation.\n *\n * @internal\n */\nexport const insertionFactory: GriffelInsertionFactory = () => {\n  const insertionCache: Record<string, boolean> = {};\n\n  return function insertStyles(renderer: GriffelRenderer, cssRules: CSSRulesByBucket) {\n    if (insertionCache[renderer.id] === undefined) {\n      renderer.insertCSSRules(cssRules!);\n      insertionCache[renderer.id] = true;\n    }\n  };\n};\n", "import { debugData, isDevToolsEnabled, getSourceURLfromError } from './devtools';\nimport { insertionFactory } from './insertionFactory';\nimport { reduceToClassNameForSlots } from './runtime/reduceToClassNameForSlots';\nimport type { CSSClassesMapBySlot, CSSRulesByBucket, GriffelInsertionFactory } from './types';\nimport type { MakeStylesOptions } from './makeStyles';\n\n/**\n * A version of makeStyles() that accepts build output as an input and skips all runtime transforms.\n *\n * @internal\n */\nexport function __styles<Slots extends string>(\n  classesMapBySlot: CSSClassesMapBySlot<Slots>,\n  cssRules: CSSRulesByBucket,\n  factory: GriffelInsertionFactory = insertionFactory,\n) {\n  const insertStyles = factory();\n\n  let ltrClassNamesForSlots: Record<Slots, string> | null = null;\n  let rtlClassNamesForSlots: Record<Slots, string> | null = null;\n\n  let sourceURL: string | undefined;\n  if (process.env.NODE_ENV !== 'production' && isDevToolsEnabled) {\n    sourceURL = getSourceURLfromError();\n  }\n\n  function computeClasses(options: Pick<MakeStylesOptions, 'dir' | 'renderer'>): Record<Slots, string> {\n    const { dir, renderer } = options;\n    const isLTR = dir === 'ltr';\n\n    if (isLTR) {\n      if (ltrClassNamesForSlots === null) {\n        ltrClassNamesForSlots = reduceToClassNameForSlots(classesMapBySlot, dir);\n      }\n    } else {\n      if (rtlClassNamesForSlots === null) {\n        rtlClassNamesForSlots = reduceToClassNameForSlots(classesMapBySlot, dir);\n      }\n    }\n\n    insertStyles(renderer, cssRules);\n\n    const classNamesForSlots = isLTR\n      ? (ltrClassNamesForSlots as Record<Slots, string>)\n      : (rtlClassNamesForSlots as Record<Slots, string>);\n\n    if (process.env.NODE_ENV !== 'production' && isDevToolsEnabled) {\n      debugData.addSequenceDetails(classNamesForSlots!, sourceURL);\n    }\n\n    return classNamesForSlots;\n  }\n\n  return computeClasses;\n}\n", "import { createDOMRenderer, rehydrateRendererCache } from '@griffel/core';\nimport type { GriffelRenderer } from '@griffel/core';\nimport * as React from 'react';\n\nimport { canUseDOM } from './utils/canUseDOM';\n\nexport interface RendererProviderProps {\n  /** An instance of Griffel renderer. */\n  renderer: GriffelRenderer;\n\n  /**\n   * Document used to insert CSS variables to head\n   */\n  targetDocument?: Document;\n\n  /**\n   * Content wrapped by the RendererProvider\n   */\n  children: React.ReactNode;\n}\n\n/**\n * @private\n */\nconst RendererContext = React.createContext<GriffelRenderer>(createDOMRenderer());\n\n/**\n * @public\n */\nexport const RendererProvider: React.FC<RendererProviderProps> = ({ children, renderer, targetDocument }) => {\n  React.useMemo(() => {\n    if (canUseDOM()) {\n      // \"rehydrateCache()\" can't be called in effects as it needs to be called before any component will be rendered to\n      // avoid double insertion of classes\n      rehydrateRendererCache(renderer, targetDocument);\n    }\n  }, [renderer, targetDocument]);\n\n  return <RendererContext.Provider value={renderer}>{children}</RendererContext.Provider>;\n};\n\n/**\n * Returns an instance of current makeStyles() renderer.\n *\n * @private Exported as \"useRenderer_unstable\" use it on own risk. Can be changed or removed without a notice.\n */\nexport function useRenderer(): GriffelRenderer {\n  return React.useContext(RendererContext);\n}\n", "import * as React from 'react';\n\nexport interface TextDirectionProviderProps {\n  /** Indicates the directionality of the element's text. */\n  dir: 'ltr' | 'rtl';\n\n  /**\n   * Content wrapped by the TextDirectionProvider.\n   */\n  children: React.ReactNode;\n}\n\n/**\n * @private\n */\nconst TextDirectionContext = React.createContext<'ltr' | 'rtl'>('ltr');\n\n/**\n * @public\n */\nexport const TextDirectionProvider: React.FC<TextDirectionProviderProps> = ({ children, dir }) => {\n  return <TextDirectionContext.Provider value={dir}>{children}</TextDirectionContext.Provider>;\n};\n\n/**\n * Returns current directionality of the element's text.\n *\n * @private\n */\nexport function useTextDirection() {\n  return React.useContext(TextDirectionContext);\n}\n", "/**\n * Creates a CSS rule from a theme object.\n *\n * Useful for scenarios when you want to apply theming statically to a top level elements like `body`.\n */ export function createCSSRuleFromTheme(selector, theme) {\n    if (theme) {\n        const cssVarsAsString = Object.keys(theme).reduce((cssVarRule, cssVar)=>{\n            return `${cssVarRule}--${cssVar}: ${theme[cssVar]}; `;\n        }, '');\n        return `${selector} { ${cssVarsAsString} }`;\n    }\n    return `${selector} {}`;\n}\n", "import * as React from 'react';\nimport { renderFluentProvider_unstable } from './renderFluentProvider';\nimport { useFluentProvider_unstable } from './useFluentProvider';\nimport { useFluentProviderStyles_unstable } from './useFluentProviderStyles.styles';\nimport { useFluentProviderContextValues_unstable } from './useFluentProviderContextValues';\nexport const FluentProvider = /*#__PURE__*/ React.forwardRef((props, ref)=>{\n    const state = useFluentProvider_unstable(props, ref);\n    useFluentProviderStyles_unstable(state);\n    const contextValues = useFluentProviderContextValues_unstable(state);\n    return renderFluentProvider_unstable(state, contextValues);\n});\nFluentProvider.displayName = 'FluentProvider';\n", "import * as React from 'react';\nimport { SLOT_CLASS_NAME_PROP_SYMBOL, SLOT_ELEMENT_TYPE_SYMBOL, SLOT_RENDER_FUNCTION_SYMBOL } from './constants';\n/**\n * Creates a slot from a slot shorthand or properties (`props.SLOT_NAME` or `props` itself)\n * @param value - the value of the slot, it can be a slot shorthand, a slot component or a slot properties\n * @param options - values you can pass to alter the signature of a slot, those values are:\n *\n * * `elementType` - the base element type of a slot, defaults to `'div'`\n * * `defaultProps` - similar to a React component declaration, you can provide a slot default properties to be merged with the shorthand/properties provided.\n */ export function always(value, options) {\n    const { defaultProps, elementType } = options;\n    const props = resolveShorthand(value);\n    /**\n   * Casting is required here as SlotComponentType is a function, not an object.\n   * Although SlotComponentType has a function signature, it is still just an object.\n   * This is required to make a slot callable (JSX compatible), this is the exact same approach\n   * that is used on `@types/react` components\n   */ const propsWithMetadata = {\n        ...defaultProps,\n        ...props,\n        [SLOT_ELEMENT_TYPE_SYMBOL]: elementType,\n        [SLOT_CLASS_NAME_PROP_SYMBOL]: props === null || props === void 0 ? void 0 : props.className\n    };\n    if (props && typeof props.children === 'function') {\n        propsWithMetadata[SLOT_RENDER_FUNCTION_SYMBOL] = props.children;\n        propsWithMetadata.children = defaultProps === null || defaultProps === void 0 ? void 0 : defaultProps.children;\n    }\n    return propsWithMetadata;\n}\n/**\n * Creates a slot from a slot shorthand or properties (`props.SLOT_NAME` or `props` itself)\n * @param value - the value of the slot, it can be a slot shorthand, a slot component or a slot properties\n * @param options - values you can pass to alter the signature of a slot, those values are:\n *\n * * `elementType` - the base element type of a slot, defaults to `'div'`\n * * `defaultProps` - similar to a React component declaration, you can provide a slot default properties to be merged with the shorthand/properties provided\n * * `renderByDefault` - a boolean that indicates if a slot will be rendered even if it's base value is `undefined`.\n * By default if `props.SLOT_NAME` is `undefined` then `state.SLOT_NAME` becomes `undefined`\n * and nothing will be rendered, but if `renderByDefault = true` then `state.SLOT_NAME` becomes an object\n * with the values provided by `options.defaultProps` (or `{}`). This is useful for cases such as providing a default content\n * in case no shorthand is provided, like the case of the `expandIcon` slot for the `AccordionHeader`\n */ export function optional(value, options) {\n    if (value === null || value === undefined && !options.renderByDefault) {\n        return undefined;\n    }\n    return always(value, options);\n}\n/**\n * Helper function that converts a slot shorthand or properties to a slot properties object\n * The main difference between this function and `slot` is that this function does not return the metadata required for a slot to be considered a properly renderable slot, it only converts the value to a slot properties object\n * @param value - the value of the slot, it can be a slot shorthand or a slot properties object\n */ export function resolveShorthand(value) {\n    if (typeof value === 'string' || typeof value === 'number' || isIterable(value) || // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    React.isValidElement(value)) {\n        return {\n            children: value\n        };\n    }\n    if (value && typeof value !== 'object' && process.env.NODE_ENV !== 'production') {\n        // TODO: would be nice to have a link to slot documentation in this error message\n        // eslint-disable-next-line no-console\n        console.error(`@fluentui/react-utilities [slot.${resolveShorthand.name}]:\nA slot got an invalid value \"${value}\" (${typeof value}).\nA valid value for a slot is a slot shorthand or slot properties object.\nSlot shorthands can be strings, numbers, arrays or JSX elements`);\n    }\n    return value;\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst isIterable = (value)=>typeof value === 'object' && value !== null && Symbol.iterator in value;\n", "/**\n * @internal\n * Internal reference for the render function\n */ export const SLOT_RENDER_FUNCTION_SYMBOL = Symbol.for('fui.slotRenderFunction');\n/**\n * @internal\n * Internal reference for the render function\n */ export const SLOT_ELEMENT_TYPE_SYMBOL = Symbol.for('fui.slotElementType');\n/**\n * @internal\n * Internal cache of the original className prop for the slot, before being modified by the useStyles hook.\n */ export const SLOT_CLASS_NAME_PROP_SYMBOL = Symbol.for('fui.slotClassNameProp');\n", "import { SLOT_ELEMENT_TYPE_SYMBOL } from './constants';\n/**\n * Guard method to ensure a given element is a slot.\n * This is mainly used internally to ensure a slot is being used as a component.\n */ export function isSlot(element) {\n    return Boolean(element === null || element === void 0 ? void 0 : element.hasOwnProperty(SLOT_ELEMENT_TYPE_SYMBOL));\n}\n", "import * as React from 'react';\nimport { getNativeElementProps } from '../utils/getNativeElementProps';\n/**\n * Given an element tagname and user props, filters the props to only allowed props for the given\n * element type.\n *\n * Equivalent to {@link getNativeElementProps}, but more type-safe.\n *\n * @param tagName - The slot's default element type (e.g. 'div')\n * @param props - The component's props object\n * @param excludedPropNames - List of native props to exclude from the returned value\n */ export const getIntrinsicElementProps = (tagName, // eslint-disable-next-line @typescript-eslint/no-restricted-types -- in order to not introduce Type Restriction CHANGe which is kinda \"breaking change from Types POV\", we don't enforce our custom `RefAttributes` in this API, to be compatible with scenarios where non v9 interfaces might be used. This may/will change with React 19\nprops, excludedPropNames)=>{\n    var _props_as;\n    // eslint-disable-next-line @typescript-eslint/no-deprecated\n    return getNativeElementProps((_props_as = props.as) !== null && _props_as !== void 0 ? _props_as : tagName, props, excludedPropNames);\n};\n", "import * as React from 'react';\nimport { labelProperties, audioProperties, videoProperties, olProperties, liProperties, anchorProperties, buttonProperties, inputProperties, textAreaProperties, selectProperties, optionProperties, tableProperties, trProperties, thProperties, tdProperties, colGroupProperties, colProperties, fieldsetProperties, formProperties, iframeProperties, imgProperties, htmlElementProperties, getNativeProps, timeProperties, dialogProperties } from './properties';\nconst nativeElementMap = {\n    label: labelProperties,\n    audio: audioProperties,\n    video: videoProperties,\n    ol: olProperties,\n    li: liProperties,\n    a: anchorProperties,\n    button: buttonProperties,\n    input: inputProperties,\n    textarea: textAreaProperties,\n    select: selectProperties,\n    option: optionProperties,\n    table: tableProperties,\n    tr: trProperties,\n    th: thProperties,\n    td: tdProperties,\n    colGroup: colGroupProperties,\n    col: colProperties,\n    fieldset: fieldsetProperties,\n    form: formProperties,\n    iframe: iframeProperties,\n    img: imgProperties,\n    time: timeProperties,\n    dialog: dialogProperties\n};\n/**\n * Given an element tagname and user props, filters the props to only allowed props for the given\n * element type.\n * @param tagName - Tag name (e.g. \"div\")\n * @param props - Props object\n * @param excludedPropNames - List of props to disallow\n *\n * @deprecated use getIntrinsicElementProps instead, it is a type-safe version of this method\n */ // eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function getNativeElementProps(tagName, props, excludedPropNames) {\n    const allowedPropNames = tagName && nativeElementMap[tagName] || htmlElementProperties;\n    allowedPropNames.as = 1;\n    return getNativeProps(props, allowedPropNames, excludedPropNames);\n}\n/**\n * Splits the native props into ones that go to the `root` slot, and ones that go to the primary slot.\n *\n * This function is only for use with components that have a primary slot other than `root`.\n * Most components should use {@link getNativeElementProps} for their root slot if it is the primary slot.\n *\n * @returns An object containing the native props for the `root` and primary slots.\n */ export const getPartitionedNativeProps = ({ primarySlotTagName, props, excludedPropNames })=>{\n    return {\n        root: {\n            style: props.style,\n            className: props.className\n        },\n        // eslint-disable-next-line @typescript-eslint/no-deprecated\n        primary: getNativeElementProps(primarySlotTagName, props, [\n            ...excludedPropNames || [],\n            'style',\n            'className'\n        ])\n    };\n};\n", "const toObjectMap = (...items)=>{\n    const result = {};\n    for (const item of items){\n        const keys = Array.isArray(item) ? item : Object.keys(item);\n        for (const key of keys){\n            result[key] = 1;\n        }\n    }\n    return result;\n};\n/**\n * An array of events that are allowed on every html element type.\n *\n * @public\n */ export const baseElementEvents = toObjectMap([\n    'onAuxClick',\n    'onAnimationEnd',\n    'onAnimationStart',\n    'onCopy',\n    'onCut',\n    'onPaste',\n    'onCompositionEnd',\n    'onCompositionStart',\n    'onCompositionUpdate',\n    'onFocus',\n    'onFocusCapture',\n    'onBlur',\n    'onBlurCapture',\n    'onChange',\n    'onInput',\n    'onSubmit',\n    'onLoad',\n    'onError',\n    'onKeyDown',\n    'onKeyDownCapture',\n    'onKeyPress',\n    'onKeyUp',\n    'onAbort',\n    'onCanPlay',\n    'onCanPlayThrough',\n    'onDurationChange',\n    'onEmptied',\n    'onEncrypted',\n    'onEnded',\n    'onLoadedData',\n    'onLoadedMetadata',\n    'onLoadStart',\n    'onPause',\n    'onPlay',\n    'onPlaying',\n    'onProgress',\n    'onRateChange',\n    'onSeeked',\n    'onSeeking',\n    'onStalled',\n    'onSuspend',\n    'onTimeUpdate',\n    'onVolumeChange',\n    'onWaiting',\n    'onClick',\n    'onClickCapture',\n    'onContextMenu',\n    'onDoubleClick',\n    'onDrag',\n    'onDragEnd',\n    'onDragEnter',\n    'onDragExit',\n    'onDragLeave',\n    'onDragOver',\n    'onDragStart',\n    'onDrop',\n    'onMouseDown',\n    'onMouseDownCapture',\n    'onMouseEnter',\n    'onMouseLeave',\n    'onMouseMove',\n    'onMouseOut',\n    'onMouseOver',\n    'onMouseUp',\n    'onMouseUpCapture',\n    'onSelect',\n    'onTouchCancel',\n    'onTouchEnd',\n    'onTouchMove',\n    'onTouchStart',\n    'onScroll',\n    'onWheel',\n    'onPointerCancel',\n    'onPointerDown',\n    'onPointerEnter',\n    'onPointerLeave',\n    'onPointerMove',\n    'onPointerOut',\n    'onPointerOver',\n    'onPointerUp',\n    'onGotPointerCapture',\n    'onLostPointerCapture'\n]);\n/**\n * An array of element attributes which are allowed on every html element type.\n *\n * @public\n */ export const baseElementProperties = toObjectMap([\n    'accessKey',\n    'children',\n    'className',\n    'contentEditable',\n    'dir',\n    'draggable',\n    'hidden',\n    'htmlFor',\n    'id',\n    'lang',\n    'ref',\n    'role',\n    'style',\n    'tabIndex',\n    'title',\n    'translate',\n    'spellCheck',\n    'name'\n]);\n/**\n * An array of microdata attributes that are allowed on every html element type.\n *\n * @public\n */ export const microdataProperties = toObjectMap([\n    'itemID',\n    'itemProp',\n    'itemRef',\n    'itemScope',\n    'itemType'\n]);\n/**\n * An array of HTML element properties and events.\n *\n * @public\n */ export const htmlElementProperties = toObjectMap(baseElementProperties, baseElementEvents, microdataProperties);\n/**\n * An array of LABEL tag properties and events.\n *\n * @public\n */ export const labelProperties = toObjectMap(htmlElementProperties, [\n    'form'\n]);\n/**\n * An array of AUDIO tag properties and events.\n\n * @public\n */ export const audioProperties = toObjectMap(htmlElementProperties, [\n    'height',\n    'loop',\n    'muted',\n    'preload',\n    'src',\n    'width'\n]);\n/**\n * An array of VIDEO tag properties and events.\n *\n * @public\n */ export const videoProperties = toObjectMap(audioProperties, [\n    'poster'\n]);\n/**\n * An array of OL tag properties and events.\n *\n * @public\n */ export const olProperties = toObjectMap(htmlElementProperties, [\n    'start'\n]);\n/**\n * An array of LI tag properties and events.\n *\n * @public\n */ export const liProperties = toObjectMap(htmlElementProperties, [\n    'value'\n]);\n/**\n * An array of A tag properties and events.\n *\n * @public\n */ export const anchorProperties = toObjectMap(htmlElementProperties, [\n    'download',\n    'href',\n    'hrefLang',\n    'media',\n    'rel',\n    'target',\n    'type'\n]);\n/**\n * An array of TIME tag properties and events.\n *\n * @public\n */ export const timeProperties = toObjectMap(htmlElementProperties, [\n    'dateTime'\n]);\n/**\n * An array of BUTTON tag properties and events.\n *\n * @public\n */ export const buttonProperties = toObjectMap(htmlElementProperties, [\n    'autoFocus',\n    'disabled',\n    'form',\n    'formAction',\n    'formEncType',\n    'formMethod',\n    'formNoValidate',\n    'formTarget',\n    'type',\n    'value'\n]);\n/**\n * An array of INPUT tag properties and events.\n *\n * @public\n */ export const inputProperties = toObjectMap(buttonProperties, [\n    'accept',\n    'alt',\n    'autoCorrect',\n    'autoCapitalize',\n    'autoComplete',\n    'checked',\n    'dirname',\n    'form',\n    'height',\n    'inputMode',\n    'list',\n    'max',\n    'maxLength',\n    'min',\n    'minLength',\n    'multiple',\n    'pattern',\n    'placeholder',\n    'readOnly',\n    'required',\n    'src',\n    'step',\n    'size',\n    'type',\n    'value',\n    'width'\n]);\n/**\n * An array of TEXTAREA tag properties and events.\n *\n * @public\n */ export const textAreaProperties = toObjectMap(buttonProperties, [\n    'autoCapitalize',\n    'cols',\n    'dirname',\n    'form',\n    'maxLength',\n    'placeholder',\n    'readOnly',\n    'required',\n    'rows',\n    'wrap'\n]);\n/**\n * An array of SELECT tag properties and events.\n *\n * @public\n */ export const selectProperties = toObjectMap(buttonProperties, [\n    'form',\n    'multiple',\n    'required'\n]);\nexport const optionProperties = toObjectMap(htmlElementProperties, [\n    'selected',\n    'value'\n]);\n/**\n * An array of TABLE tag properties and events.\n *\n * @public\n */ export const tableProperties = toObjectMap(htmlElementProperties, [\n    'cellPadding',\n    'cellSpacing'\n]);\n/**\n * An array of TR tag properties and events.\n *\n * @public\n */ export const trProperties = htmlElementProperties;\n/**\n * An array of TH tag properties and events.\n *\n * @public\n */ export const thProperties = toObjectMap(htmlElementProperties, [\n    'colSpan',\n    'rowSpan',\n    'scope'\n]);\n/**\n * An array of TD tag properties and events.\n *\n * @public\n */ export const tdProperties = toObjectMap(htmlElementProperties, [\n    'colSpan',\n    'headers',\n    'rowSpan',\n    'scope'\n]);\nexport const colGroupProperties = toObjectMap(htmlElementProperties, [\n    'span'\n]);\nexport const colProperties = toObjectMap(htmlElementProperties, [\n    'span'\n]);\n/**\n * An array of FIELDSET tag properties and events.\n *\n * @public\n */ export const fieldsetProperties = toObjectMap(htmlElementProperties, [\n    'disabled',\n    'form'\n]);\n/**\n * An array of FORM tag properties and events.\n *\n * @public\n */ export const formProperties = toObjectMap(htmlElementProperties, [\n    'acceptCharset',\n    'action',\n    'encType',\n    'encType',\n    'method',\n    'noValidate',\n    'target'\n]);\n/**\n * An array of IFRAME tag properties and events.\n *\n * @public\n */ export const iframeProperties = toObjectMap(htmlElementProperties, [\n    'allow',\n    'allowFullScreen',\n    'allowPaymentRequest',\n    'allowTransparency',\n    'csp',\n    'height',\n    'importance',\n    'referrerPolicy',\n    'sandbox',\n    'src',\n    'srcDoc',\n    'width'\n]);\n/**\n * An array of IMAGE tag properties and events.\n *\n * @public\n */ export const imgProperties = toObjectMap(htmlElementProperties, [\n    'alt',\n    'crossOrigin',\n    'height',\n    'src',\n    'srcSet',\n    'useMap',\n    'width'\n]);\n/**\n * An array of DIALOG tag properties and events.\n *\n * @public\n */ export const dialogProperties = toObjectMap(htmlElementProperties, [\n    'open',\n    'onCancel',\n    'onClose'\n]);\n/**\n * An array of DIV tag properties and events.\n *\n * @public\n */ export const divProperties = htmlElementProperties;\n/**\n * Gets native supported props for an html element provided the allowance set. Use one of the property\n * sets defined (divProperties, buttonPropertes, etc) to filter out supported properties from a given\n * props set. Note that all data- and aria- prefixed attributes will be allowed.\n * NOTE: getNativeProps should always be applied first when adding props to a react component. The\n * non-native props should be applied second. This will prevent getNativeProps from overriding your custom props.\n * For example, if props passed to getNativeProps has an onClick function and getNativeProps is added to\n * the component after an onClick function is added, then the getNativeProps onClick will override it.\n *\n * @public\n * @param props - The unfiltered input props\n * @param allowedPropNames - The array or record of allowed prop names.\n * @param excludedPropNames\n * @returns The filtered props\n */ // eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function getNativeProps(// eslint-disable-next-line @typescript-eslint/no-explicit-any\nprops, allowedPropNames, excludedPropNames) {\n    // It'd be great to properly type this while allowing 'aria-` and 'data-' attributes like TypeScript does for\n    // JSX attributes, but that ability is hardcoded into the TS compiler with no analog in TypeScript typings.\n    // Then we'd be able to enforce props extends native props (including aria- and data- attributes), and then\n    // return native props.\n    // We should be able to do this once this PR is merged: https://github.com/microsoft/TypeScript/pull/26797\n    const isArray = Array.isArray(allowedPropNames);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const result = {};\n    const keys = Object.keys(props);\n    for (const key of keys){\n        const isNativeProp = !isArray && allowedPropNames[key] || isArray && allowedPropNames.indexOf(key) >= 0 || key.indexOf('data-') === 0 || key.indexOf('aria-') === 0;\n        if (isNativeProp && (!excludedPropNames || (excludedPropNames === null || excludedPropNames === void 0 ? void 0 : excludedPropNames.indexOf(key)) === -1)) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            result[key] = props[key];\n        }\n    }\n    return result;\n}\n", "import * as React from 'react';\n/**\n * @internal\n */ export const ThemeContext = React.createContext(undefined);\n/**\n * @internal\n */ export const ThemeProvider = ThemeContext.Provider;\n", "import * as React from 'react';\n/**\n * @internal\n * Used to provide a CSS class that applies theme css variables\n *\n * Useful for elements in the React tree (can read context) but not in the DOM Tree. E.g. Portals\n */ const ThemeClassNameContext = React.createContext(undefined);\nconst themeClassNameContextDefaultVaue = '';\nexport const ThemeClassNameProvider = ThemeClassNameContext.Provider;\n/**\n * @returns CSS class that applies css variables\n */ export function useThemeClassName() {\n    var _React_useContext;\n    return (_React_useContext = React.useContext(ThemeClassNameContext)) !== null && _React_useContext !== void 0 ? _React_useContext : themeClassNameContextDefaultVaue;\n}\n", "import * as React from 'react';\n/**\n * @internal\n * Context shared by all of the tooltips in the app\n */ const TooltipVisibilityContext = React.createContext(undefined);\nconst tooltipVisibilityContextDefaultValue = {};\n/**\n * @internal\n */ export const TooltipVisibilityProvider = TooltipVisibilityContext.Provider;\nexport function useTooltipVisibility() {\n    var _React_useContext;\n    return (_React_useContext = React.useContext(TooltipVisibilityContext)) !== null && _React_useContext !== void 0 ? _React_useContext : tooltipVisibilityContextDefaultValue;\n}\n", "import * as React from 'react';\n/**\n * @internal\n */ const ProviderContext = React.createContext(undefined);\nconst providerContextDefaultValue = {\n    // eslint-disable-next-line @nx/workspace-no-restricted-globals -- expected ignore ( SSR friendly acquisition of globals )\n    targetDocument: typeof document === 'object' ? document : undefined,\n    dir: 'ltr'\n};\n/**\n * @internal\n */ export const Provider = ProviderContext.Provider;\nexport function useFluent() {\n    var _React_useContext;\n    return (_React_useContext = React.useContext(ProviderContext)) !== null && _React_useContext !== void 0 ? _React_useContext : providerContextDefaultValue;\n}\n", "import * as React from 'react';\n/**\n * @internal\n */ export const OverridesContext = React.createContext(undefined);\n/**\n * @internal\n */ export const OverridesProvider = OverridesContext.Provider;\nexport function useOverrides() {\n    var _React_useContext;\n    return (_React_useContext = React.useContext(OverridesContext)) !== null && _React_useContext !== void 0 ? _React_useContext : {};\n}\n", "/* eslint-disable */ import * as React from 'react';\n/**\n * @internal\n */ export const CustomStyleHooksContext = React.createContext(undefined);\nconst noop = ()=>{};\n/**\n * @internal\n */ export const CustomStyleHooksProvider = CustomStyleHooksContext.Provider;\n/**\n * Gets a custom style hook\n * @param hook - One of the hook properties in CustomStyleHooksContextValue\n * @returns The corresponding hook when defined, otherwise a no-op function.\n */ export const useCustomStyleHook = (hook)=>{\n    var _React_useContext;\n    var _React_useContext_hook;\n    return (_React_useContext_hook = (_React_useContext = React.useContext(CustomStyleHooksContext)) === null || _React_useContext === void 0 ? void 0 : _React_useContext[hook]) !== null && _React_useContext_hook !== void 0 ? _React_useContext_hook : noop;\n};\n", "import * as React from 'react';\nimport { canUseDOM } from '../ssr/index';\n/**\n * React currently throws a warning when using useLayoutEffect on the server. To get around it, we can conditionally\n * useEffect on the server (no-op) and useLayoutEffect in the browser. We occasionally need useLayoutEffect to\n * ensure we don't get a render flash for certain operations, but we may also need affected components to render on\n * the server.\n *\n * https://gist.github.com/gaearon/e7d97cdf38a2907924ea12e4ebdf3c85\n * https://github.com/reduxjs/react-redux/blob/master/src/utils/useIsomorphicLayoutEffect.js\n */ // eslint-disable-next-line no-restricted-properties\nexport const useIsomorphicLayoutEffect = canUseDOM() ? React.useLayoutEffect : React.useEffect;\n", "/**\n * Verifies if an application can use DOM.\n */ export function canUseDOM() {\n    return /* eslint-disable @nx/workspace-no-restricted-globals -- expected ignore ( SSR friendly acquisition of globals )*/ typeof window !== 'undefined' && !!(window.document && // eslint-disable-next-line @typescript-eslint/no-deprecated\n    window.document.createElement);\n}\n", "import * as React from 'react';\nimport { canUseDOM } from './canUseDOM';\n/**\n * Default context value to use in case there is no SSRProvider. This is fine for client-only apps.\n *\n * @internal\n */ export const defaultSSRContextValue = {\n    current: 0\n};\nexport const SSRContext = /*#__PURE__*/ React.createContext(undefined);\n/**\n * @internal\n */ export function useSSRContext() {\n    var _React_useContext;\n    return (_React_useContext = React.useContext(SSRContext)) !== null && _React_useContext !== void 0 ? _React_useContext : defaultSSRContextValue;\n}\n/**\n * When using SSR with Fluent UI, applications must be wrapped in an SSRProvider. This ensures that auto generated ids\n * are consistent between the client and server.\n *\n * @public\n */ export const SSRProvider = (props)=>{\n    const [value] = React.useState(()=>({\n            current: 0\n        }));\n    return /*#__PURE__*/ React.createElement(SSRContext.Provider, {\n        value: value\n    }, props.children);\n};\n/**\n * Returns whether the component is currently being server side rendered or hydrated on the client. Can be used to delay\n * browser-specific rendering until after hydration. May cause re-renders on a client when is used within SSRProvider.\n */ export function useIsSSR() {\n    const isInSSRContext = useSSRContext() !== defaultSSRContextValue;\n    const [isSSR, setIsSSR] = React.useState(isInSSRContext);\n    // If we are rendering in a non-DOM environment, and there's no SSRProvider, provide a warning to hint to the\n    // developer to add one.\n    if (process.env.NODE_ENV !== 'production') {\n        if (!isInSSRContext && !canUseDOM()) {\n            // eslint-disable-next-line no-console\n            console.error(`@fluentui/react-components [${useIsSSR.name}]:\nWhen server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.\n\n\nCheck documentation at https://aka.ms/fluentui-ssr.`);\n        }\n    }\n    // If on the client, and the component was initially server rendered, then schedule a layout effect to update the\n    // component after hydration.\n    if (canUseDOM() && isInSSRContext) {\n        // This if statement technically breaks the rules of hooks, but is safe because the condition never changes after\n        // mounting.\n        // eslint-disable-next-line\n        React.useLayoutEffect(()=>{\n            setIsSSR(false);\n        }, []);\n    }\n    return isSSR;\n}\n", "import * as React from 'react';\nimport { defaultSSRContextValue, useSSRContext } from '../ssr/index';\nconst IdPrefixContext = React.createContext(undefined);\n/**\n * Allows to define a prefix that will be used for all IDs generated by useId() hook. It's useful to avoid collisions\n * between different bundles.\n */ export const IdPrefixProvider = IdPrefixContext.Provider;\nfunction useIdPrefix() {\n    return React.useContext(IdPrefixContext) || '';\n}\n/**\n * Resets generated IDs, should be used only in tests.\n */ export function resetIdsForTests() {\n    defaultSSRContextValue.current = 0;\n}\n/**\n * Hook to generate a unique ID.\n *\n * @param prefix - Optional prefix for the ID. Defaults to 'fui-'.\n * @param providedId - Optional id provided by a parent component. Defaults to the provided value if present,\n *  without conditioning the hook call\n * @returns The ID\n */ export function useId(prefix = 'fui-', providedId) {\n    'use no memo';\n    const contextValue = useSSRContext();\n    const idPrefix = useIdPrefix();\n    // Checking if useId is available on React, if it is, we use it to generate the id. String concatenation is used to\n    // prevent bundlers from complaining with older versions of React.\n    const _useId = React['use' + 'Id'];\n    if (_useId) {\n        const generatedId = _useId();\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        const escapedId = React.useMemo(()=>generatedId.replace(/:/g, ''), [\n            generatedId\n        ]);\n        return providedId || `${idPrefix}${prefix}${escapedId}`;\n    }\n    // Hooks appear to be running conditionally, but they will always run in the same order since it's based on\n    // the version of React being used. This is safe to ignore.\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    return React.useMemo(()=>{\n        if (providedId) {\n            return providedId;\n        }\n        return `${idPrefix}${prefix}${++contextValue.current}`;\n    }, [\n        idPrefix,\n        prefix,\n        providedId,\n        contextValue\n    ]);\n}\n", "import * as React from 'react';\n/**\n * React hook to merge multiple React refs (either MutableRefObjects or ref callbacks) into a single ref callback that\n * updates all provided refs\n * @param refs - Refs to collectively update with one ref value.\n * @returns A function with an attached \"current\" prop, so that it can be treated like a RefObject.\n */ // LegacyRef is actually not supported, but in React v18 types this is leaking directly from forwardRef component declaration\nexport function useMergedRefs(...refs) {\n    'use no memo';\n    const mergedCallback = React.useCallback((value)=>{\n        // Update the \"current\" prop hanging on the function.\n        mergedCallback.current = value;\n        for (const ref of refs){\n            if (typeof ref === 'string' && process.env.NODE_ENV !== 'production') {\n                // eslint-disable-next-line no-console\n                console.error(`@fluentui/react-utilities [useMergedRefs]:\nThis hook does not support the usage of string refs. Please use React.useRef instead.\n\nFor more info on 'React.useRef', see https://react.dev/reference/react/useRef.\nFor more info on string refs, see https://react.dev/blog/2024/04/25/react-19-upgrade-guide#removed-string-refs.`);\n            }\n            if (typeof ref === 'function') {\n                ref(value);\n            } else if (ref) {\n                // work around the immutability of the React.Ref type\n                ref.current = value;\n            }\n        }\n    }, // eslint-disable-next-line react-hooks/exhaustive-deps -- already exhaustive\n    [\n        ...refs\n    ]);\n    return mergedCallback;\n}\n", "/**\n * Verifies if a given node is an HTMLElement,\n * this method works seamlessly with frames and elements from different documents\n *\n * This is preferred over simply using `instanceof`.\n * Since `instanceof` might be problematic while operating with [multiple realms](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof#instanceof_and_multiple_realms)\n *\n * @example\n * ```ts\n * isHTMLElement(event.target) && event.target.focus()\n * isHTMLElement(event.target, {constructorName: 'HTMLInputElement'}) && event.target.value // some value\n * ```\n *\n */ export function isHTMLElement(element, options) {\n    var _typedElement_ownerDocument;\n    const typedElement = element;\n    var _options_constructorName;\n    return Boolean((typedElement === null || typedElement === void 0 ? void 0 : (_typedElement_ownerDocument = typedElement.ownerDocument) === null || _typedElement_ownerDocument === void 0 ? void 0 : _typedElement_ownerDocument.defaultView) && typedElement instanceof typedElement.ownerDocument.defaultView[(_options_constructorName = options === null || options === void 0 ? void 0 : options.constructorName) !== null && _options_constructorName !== void 0 ? _options_constructorName : 'HTMLElement']);\n}\n", "import { isSlot } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { createCompatSlotComponent } from '../utils/createCompatSlotComponent';\nimport { warnIfElementTypeIsInvalid } from '../utils/warnIfElementTypeIsInvalid';\nexport function createJSX(runtime, slotRuntime) {\n    return function jsx(type, overrideProps, key, source, self) {\n        // TODO:\n        // this is for backwards compatibility with getSlotsNext\n        // it should be removed once getSlotsNext is obsolete\n        if (isSlot(overrideProps)) {\n            return slotRuntime(createCompatSlotComponent(type, overrideProps), null, key, source, self);\n        }\n        if (isSlot(type)) {\n            return slotRuntime(type, overrideProps, key, source, self);\n        }\n        warnIfElementTypeIsInvalid(type);\n        return runtime(type, overrideProps, key, source, self);\n    };\n}\n", "import * as React from 'react';\nimport { SLOT_ELEMENT_TYPE_SYMBOL } from '@fluentui/react-utilities';\n// TODO:\n// this is for backwards compatibility with getSlotsNext\n// it should be removed once getSlotsNext is obsolete\nexport function createCompatSlotComponent(type, props) {\n    return {\n        ...props,\n        [SLOT_ELEMENT_TYPE_SYMBOL]: type\n    };\n}\n", "import * as React from 'react';\nimport { getMetadataFromSlotComponent } from '../utils/getMetadataFromSlotComponent';\nimport { Runtime } from '../utils/Runtime';\nexport const jsxSlot = (type, overrideProps, key)=>{\n    const { elementType, renderFunction, props: slotProps } = getMetadataFromSlotComponent(type);\n    const props = {\n        ...slotProps,\n        ...overrideProps\n    };\n    if (renderFunction) {\n        return Runtime.jsx(React.Fragment, {\n            children: renderFunction(elementType, props)\n        }, key);\n    }\n    return Runtime.jsx(elementType, props, key);\n};\n", "import { SLOT_CLASS_NAME_PROP_SYMBOL, SLOT_ELEMENT_TYPE_SYMBOL, SLOT_RENDER_FUNCTION_SYMBOL } from '@fluentui/react-utilities';\n/**\n * @internal\n */ export function getMetadataFromSlotComponent(type) {\n    const { as, [SLOT_CLASS_NAME_PROP_SYMBOL]: _classNameProp, [SLOT_ELEMENT_TYPE_SYMBOL]: baseElementType, [SLOT_RENDER_FUNCTION_SYMBOL]: renderFunction, ...propsWithoutMetadata } = type;\n    const props = propsWithoutMetadata;\n    const elementType = typeof baseElementType === 'string' ? as !== null && as !== void 0 ? as : baseElementType : baseElementType;\n    if (typeof elementType !== 'string' && as) {\n        props.as = as;\n    }\n    return {\n        elementType,\n        props,\n        renderFunction\n    };\n}\n", "import * as ReactRuntime from 'react/jsx-runtime';\nexport const Runtime = ReactRuntime;\n", "import * as React from 'react';\nimport { getMetadataFromSlotComponent } from '../utils/getMetadataFromSlotComponent';\nimport { Runtime } from '../utils/Runtime';\nexport const jsxsSlot = (type, overrideProps, key)=>{\n    const { elementType, renderFunction, props: slotProps } = getMetadataFromSlotComponent(type);\n    const props = {\n        ...slotProps,\n        ...overrideProps\n    };\n    if (renderFunction) {\n        /**\n     * In static runtime then children is an array and this array won't be keyed.\n     * We should wrap children by a static fragment\n     * as there's no way to know if renderFunction will render statically or dynamically\n     */ return Runtime.jsx(React.Fragment, {\n            children: renderFunction(elementType, {\n                ...props,\n                children: Runtime.jsxs(React.Fragment, {\n                    children: props.children\n                }, undefined)\n            })\n        }, key);\n    }\n    return Runtime.jsxs(elementType, props, key);\n};\n", "import { createJSX } from './jsx/createJSX';\nimport { jsxSlot } from './jsx/jsxSlot';\nimport { jsxsSlot } from './jsx/jsxsSlot';\nimport { Runtime } from './utils/Runtime';\nexport { Fragment } from 'react';\nexport const jsx = createJSX(Runtime.jsx, jsxSlot);\nexport const jsxs = createJSX(Runtime.jsxs, jsxsSlot);\n", "import * as React from 'react';\nconst IconDirectionContext = React.createContext(undefined);\nconst IconDirectionContextDefaultValue = {};\nexport const IconDirectionContextProvider = IconDirectionContext.Provider;\nexport const useIconContext = () => React.useContext(IconDirectionContext) ? React.useContext(IconDirectionContext) : IconDirectionContextDefaultValue;", "  import { jsx as _jsx, jsxs as _jsxs } from \"@fluentui/react-jsx-runtime/jsx-runtime\";\nimport { canUseDOM, assertSlots } from '@fluentui/react-utilities';\nimport { TextDirectionProvider } from '@griffel/react';\nimport { OverridesProvider_unstable as OverridesProvider, Provider_unstable as Provider, TooltipVisibilityProvider_unstable as TooltipVisibilityProvider, ThemeProvider_unstable as ThemeProvider, ThemeClassNameProvider_unstable as ThemeClassNameProvider, CustomStyleHooksProvider_unstable as CustomStyleHooksProvider } from '@fluentui/react-shared-contexts';\nimport { IconDirectionContextProvider } from '@fluentui/react-icons/lib/providers';\n/**\n * Render the final JSX of FluentProvider\n */ export const renderFluentProvider_unstable = (state, contextValues)=>{\n    assertSlots(state);\n    // Typescript (vscode) incorrectly references the FluentProviderProps.customStyleHooks_unstable\n    // instead of FluentProviderContextValues.customStyleHooks_unstable and thinks it is\n    // Partial<CustomStyleHooksContextValue>, so it needs to be cast to Required<CustomStyleHooksContextValue>\n    return /*#__PURE__*/ _jsx(Provider, {\n        value: contextValues.provider,\n        children: /*#__PURE__*/ _jsx(ThemeProvider, {\n            value: contextValues.theme,\n            children: /*#__PURE__*/ _jsx(ThemeClassNameProvider, {\n                value: contextValues.themeClassName,\n                children: /*#__PURE__*/ _jsx(CustomStyleHooksProvider, {\n                    value: contextValues.customStyleHooks_unstable,\n                    children: /*#__PURE__*/ _jsx(TooltipVisibilityProvider, {\n                        value: contextValues.tooltip,\n                        children: /*#__PURE__*/ _jsx(TextDirectionProvider, {\n                            dir: contextValues.textDirection,\n                            children: /*#__PURE__*/ _jsx(IconDirectionContextProvider, {\n                                value: contextValues.iconDirection,\n                                children: /*#__PURE__*/ _jsx(OverridesProvider, {\n                                    value: contextValues.overrides_unstable,\n                                    children: /*#__PURE__*/ _jsxs(state.root, {\n                                        children: [\n                                            canUseDOM() ? null : /*#__PURE__*/ _jsx(\"style\", {\n                                                // Using dangerous HTML because react can escape characters\n                                                // which can lead to invalid CSS.\n                                                // eslint-disable-next-line react/no-danger\n                                                dangerouslySetInnerHTML: {\n                                                    __html: state.serverStyleProps.cssRule\n                                                },\n                                                ...state.serverStyleProps.attributes\n                                            }),\n                                            state.root.children\n                                        ]\n                                    })\n                                })\n                            })\n                        })\n                    })\n                })\n            })\n        })\n    });\n};\n", "/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\n// IE11 compat, checks if WeakRef is supported\nexport const _canUseWeakRef = typeof WeakRef !== \"undefined\";\n\n/**\n * Allows disposable instances to be used\n */\nexport interface Disposable {\n  isDisposed?(): boolean;\n}\n\n/**\n * WeakRef wrapper around a HTMLElement that also supports IE11\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakRef}\n * @internal\n */\nexport class WeakRefInstance<T extends Disposable | object> {\n  private _weakRef?: WeakRef<T>;\n  private _instance?: T;\n\n  constructor(instance: T) {\n    if (_canUseWeakRef && typeof instance === \"object\") {\n      this._weakRef = new WeakRef(instance);\n    } else {\n      this._instance = instance;\n    }\n  }\n\n  /**\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakRef/deref}\n   */\n  deref(): T | undefined {\n    let instance: T | undefined;\n\n    if (this._weakRef) {\n      instance = this._weakRef?.deref();\n\n      if (!instance) {\n        delete this._weakRef;\n      }\n    } else {\n      instance = this._instance;\n      if ((instance as Disposable)?.isDisposed?.()) {\n        delete this._instance;\n      }\n    }\n\n    return instance;\n  }\n}\n", "/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\nimport { WeakRefInstance } from \"./WeakRefInstance\";\n\nexport const KEYBORG_FOCUSIN = \"keyborg:focusin\";\nexport const KEYBORG_FOCUSOUT = \"keyborg:focusout\";\n\ninterface KeyborgFocus {\n  /**\n   * This is the native `focus` function that is retained so that it can be restored when keyborg is disposed\n   */\n  __keyborgNativeFocus?: (options?: FocusOptions | undefined) => void;\n}\n\ninterface KeyborgFocusEventData {\n  focusInHandler: (e: FocusEvent) => void;\n  focusOutHandler: (e: FocusEvent) => void;\n  lastFocusedProgrammatically?: WeakRefInstance<HTMLElement>;\n  shadowTargets: Set<WeakRefInstance<ShadowRoot>>;\n}\n\n/**\n * Extends the global window with keyborg focus event data\n */\ninterface WindowWithKeyborgFocusEvent extends Window {\n  HTMLElement: typeof HTMLElement;\n  __keyborgData?: KeyborgFocusEventData;\n}\n\nfunction canOverrideNativeFocus(win: Window): boolean {\n  const HTMLElement = (win as WindowWithKeyborgFocusEvent).HTMLElement;\n  const origFocus = HTMLElement.prototype.focus;\n\n  let isCustomFocusCalled = false;\n\n  HTMLElement.prototype.focus = function focus(): void {\n    isCustomFocusCalled = true;\n  };\n\n  const btn = win.document.createElement(\"button\");\n\n  btn.focus();\n\n  HTMLElement.prototype.focus = origFocus;\n\n  return isCustomFocusCalled;\n}\n\nlet _canOverrideNativeFocus = false;\n\nexport interface KeyborgFocusInEventDetails {\n  relatedTarget?: HTMLElement;\n  isFocusedProgrammatically?: boolean;\n  originalEvent?: FocusEvent;\n}\n\nexport interface KeyborgFocusInEvent\n  extends CustomEvent<KeyborgFocusInEventDetails> {\n  /**\n   * @deprecated - used `event.detail`\n   */\n  details?: KeyborgFocusInEventDetails;\n}\n\nexport interface KeyborgFocusOutEventDetails {\n  originalEvent: FocusEvent;\n}\n\nexport type KeyborgFocusOutEvent = CustomEvent<KeyborgFocusOutEventDetails>;\n\n/**\n * Guarantees that the native `focus` will be used\n */\nexport function nativeFocus(element: HTMLElement): void {\n  const focus = element.focus as KeyborgFocus;\n\n  if (focus.__keyborgNativeFocus) {\n    focus.__keyborgNativeFocus.call(element);\n  } else {\n    element.focus();\n  }\n}\n\n/**\n * Overrides the native `focus` and setups the keyborg focus event\n */\nexport function setupFocusEvent(win: Window): void {\n  const kwin = win as WindowWithKeyborgFocusEvent;\n\n  if (!_canOverrideNativeFocus) {\n    _canOverrideNativeFocus = canOverrideNativeFocus(kwin);\n  }\n\n  const origFocus = kwin.HTMLElement.prototype.focus;\n\n  if ((origFocus as KeyborgFocus).__keyborgNativeFocus) {\n    // Already set up.\n    return;\n  }\n\n  kwin.HTMLElement.prototype.focus = focus;\n\n  const shadowTargets: Set<WeakRefInstance<ShadowRoot>> = new Set();\n\n  const focusOutHandler = (e: FocusEvent) => {\n    const target = e.target as HTMLElement;\n\n    if (!target) {\n      return;\n    }\n\n    const event: KeyborgFocusOutEvent = new CustomEvent(KEYBORG_FOCUSOUT, {\n      cancelable: true,\n      bubbles: true,\n      // Allows the event to bubble past an open shadow root\n      composed: true,\n      detail: {\n        originalEvent: e,\n      },\n    });\n\n    target.dispatchEvent(event);\n  };\n\n  const focusInHandler = (e: FocusEvent) => {\n    const target = e.target as HTMLElement;\n\n    if (!target) {\n      return;\n    }\n\n    let node: Node | null | undefined = e.composedPath()[0] as\n      | Node\n      | null\n      | undefined;\n\n    const currentShadows: Set<ShadowRoot> = new Set();\n\n    while (node) {\n      if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        currentShadows.add(node as ShadowRoot);\n        node = (node as ShadowRoot).host;\n      } else {\n        node = node.parentNode;\n      }\n    }\n\n    for (const shadowRootWeakRef of shadowTargets) {\n      const shadowRoot = shadowRootWeakRef.deref();\n\n      if (!shadowRoot || !currentShadows.has(shadowRoot)) {\n        shadowTargets.delete(shadowRootWeakRef);\n\n        if (shadowRoot) {\n          shadowRoot.removeEventListener(\"focusin\", focusInHandler, true);\n          shadowRoot.removeEventListener(\"focusout\", focusOutHandler, true);\n        }\n      }\n    }\n\n    onFocusIn(target, (e.relatedTarget as HTMLElement | null) || undefined);\n  };\n\n  const onFocusIn = (\n    target: Element,\n    relatedTarget?: HTMLElement,\n    originalEvent?: FocusEvent,\n  ) => {\n    const shadowRoot = target.shadowRoot;\n\n    if (shadowRoot) {\n      /**\n       * https://bugs.chromium.org/p/chromium/issues/detail?id=1512028\n       * focusin events don't bubble up through an open shadow root once focus is inside\n       * once focus moves into a shadow root - we drop the same focusin handler there\n       * keyborg's custom event will still bubble up since it is composed\n       * event handlers should be cleaned up once focus leaves the shadow root.\n       *\n       * When a focusin event is dispatched from a shadow root, its target is the shadow root parent.\n       * Each shadow root encounter requires a new capture listener.\n       * Why capture? - we want to follow the focus event in order or descending nested shadow roots\n       * When there are no more shadow root targets - dispatch the keyborg:focusin event\n       *\n       * 1. no focus event\n       * > document - capture listener \n       *   > shadow root 1\n       *     > shadow root 2\n       *       > shadow root 3\n       *         > focused element\n       *\n       * 2. focus event received by document listener\n       * > document - capture listener  (focus event here)\n       *   > shadow root 1 - capture listener \n       *     > shadow root 2\n       *       > shadow root 3\n       *         > focused element\n\n       * 3. focus event received by root l1 listener\n       * > document - capture listener \n       *   > shadow root 1 - capture listener  (focus event here)\n       *     > shadow root 2 - capture listener \n       *       > shadow root 3\n       *         > focused element\n       *\n       * 4. focus event received by root l2 listener\n       * > document - capture listener \n       *   > shadow root 1 - capture listener \n       *     > shadow root 2 - capture listener  (focus event here)\n       *       > shadow root 3 - capture listener \n       *         > focused element\n       *\n       * 5. focus event received by root l3 listener, no more shadow root targets\n       * > document - capture listener \n       *   > shadow root 1 - capture listener \n       *     > shadow root 2 - capture listener \n       *       > shadow root 3 - capture listener  (focus event here)\n       *         > focused element  (no shadow root - dispatch keyborg event)\n       */\n\n      for (const shadowRootWeakRef of shadowTargets) {\n        if (shadowRootWeakRef.deref() === shadowRoot) {\n          return;\n        }\n      }\n\n      shadowRoot.addEventListener(\"focusin\", focusInHandler, true);\n      shadowRoot.addEventListener(\"focusout\", focusOutHandler, true);\n\n      shadowTargets.add(new WeakRefInstance(shadowRoot));\n\n      return;\n    }\n\n    const details: KeyborgFocusInEventDetails = {\n      relatedTarget,\n      originalEvent,\n    };\n\n    const event: KeyborgFocusInEvent = new CustomEvent(KEYBORG_FOCUSIN, {\n      cancelable: true,\n      bubbles: true,\n      // Allows the event to bubble past an open shadow root\n      composed: true,\n      detail: details,\n    });\n\n    // Tabster (and other users) can still use the legacy details field - keeping for backwards compat\n    event.details = details;\n\n    if (_canOverrideNativeFocus || data.lastFocusedProgrammatically) {\n      details.isFocusedProgrammatically =\n        target === data.lastFocusedProgrammatically?.deref();\n\n      data.lastFocusedProgrammatically = undefined;\n    }\n\n    target.dispatchEvent(event);\n  };\n\n  const data: KeyborgFocusEventData = (kwin.__keyborgData = {\n    focusInHandler,\n    focusOutHandler,\n    shadowTargets,\n  });\n\n  kwin.document.addEventListener(\n    \"focusin\",\n    kwin.__keyborgData.focusInHandler,\n    true,\n  );\n\n  kwin.document.addEventListener(\n    \"focusout\",\n    kwin.__keyborgData.focusOutHandler,\n    true,\n  );\n\n  function focus(this: HTMLElement) {\n    const keyborgNativeFocusEvent = (kwin as WindowWithKeyborgFocusEvent)\n      .__keyborgData;\n\n    if (keyborgNativeFocusEvent) {\n      keyborgNativeFocusEvent.lastFocusedProgrammatically = new WeakRefInstance(\n        this,\n      );\n    }\n\n    // eslint-disable-next-line prefer-rest-params\n    return origFocus.apply(this, arguments);\n  }\n\n  let activeElement = kwin.document.activeElement as Element | null;\n\n  // If keyborg is created with the focus inside shadow root, we need\n  // to go through the shadows up to make sure all relevant shadows\n  // have focus handlers attached.\n  while (activeElement && activeElement.shadowRoot) {\n    onFocusIn(activeElement);\n    activeElement = activeElement.shadowRoot.activeElement;\n  }\n\n  (focus as KeyborgFocus).__keyborgNativeFocus = origFocus;\n}\n\n/**\n * Removes keyborg event listeners and custom focus override\n * @param win The window that stores keyborg focus events\n */\nexport function disposeFocusEvent(win: Window): void {\n  const kwin = win as WindowWithKeyborgFocusEvent;\n  const proto = kwin.HTMLElement.prototype;\n  const origFocus = (proto.focus as KeyborgFocus).__keyborgNativeFocus;\n  const keyborgNativeFocusEvent = kwin.__keyborgData;\n\n  if (keyborgNativeFocusEvent) {\n    kwin.document.removeEventListener(\n      \"focusin\",\n      keyborgNativeFocusEvent.focusInHandler,\n      true,\n    );\n\n    kwin.document.removeEventListener(\n      \"focusout\",\n      keyborgNativeFocusEvent.focusOutHandler,\n      true,\n    );\n\n    for (const shadowRootWeakRef of keyborgNativeFocusEvent.shadowTargets) {\n      const shadowRoot = shadowRootWeakRef.deref();\n\n      if (shadowRoot) {\n        shadowRoot.removeEventListener(\n          \"focusin\",\n          keyborgNativeFocusEvent.focusInHandler,\n          true,\n        );\n        shadowRoot.removeEventListener(\n          \"focusout\",\n          keyborgNativeFocusEvent.focusOutHandler,\n          true,\n        );\n      }\n    }\n\n    keyborgNativeFocusEvent.shadowTargets.clear();\n\n    delete kwin.__keyborgData;\n  }\n\n  if (origFocus) {\n    proto.focus = origFocus;\n  }\n}\n\n/**\n * @param win The window that stores keyborg focus events\n * @returns The last element focused with element.focus()\n */\nexport function getLastFocusedProgrammatically(\n  win: Window,\n): HTMLElement | null | undefined {\n  const keyborgNativeFocusEvent = (win as WindowWithKeyborgFocusEvent)\n    .__keyborgData;\n\n  return keyborgNativeFocusEvent\n    ? keyborgNativeFocusEvent.lastFocusedProgrammatically?.deref() || null\n    : undefined;\n}\n", "/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport {\n  disposeFocusEvent,\n  KeyborgFocusInEvent,\n  KEYBORG_FOCUSIN,\n  setupFocusEvent,\n} from \"./FocusEvent\";\nimport { Disposable } from \"./WeakRefInstance\";\n\ninterface WindowWithKeyborg extends Window {\n  __keyborg?: {\n    core: KeyborgCore;\n    refs: { [id: string]: Keyborg };\n  };\n}\n\nconst _dismissTimeout = 500; // When a key from dismissKeys is pressed and the focus is not moved\n// during _dismissTimeout time, dismiss the keyboard navigation mode.\n\nlet _lastId = 0;\n\nexport interface KeyborgProps {\n  // Keys to be used to trigger keyboard navigation mode. By default, any key will trigger\n  // it. Could be limited to, for example, just Tab (or Tab and arrow keys).\n  triggerKeys?: number[];\n  // Keys to be used to dismiss keyboard navigation mode using keyboard (in addition to\n  // mouse clicks which dismiss it). For example, Esc could be used to dismiss.\n  dismissKeys?: number[];\n}\n\nexport type KeyborgCallback = (isNavigatingWithKeyboard: boolean) => void;\n\n/**\n * Manages a collection of Keyborg instances in a window/document and updates keyborg state\n */\nclass KeyborgCore implements Disposable {\n  readonly id: string;\n\n  private _win?: WindowWithKeyborg;\n  private _isMouseOrTouchUsedTimer: number | undefined;\n  private _dismissTimer: number | undefined;\n  private _triggerKeys?: Set<number>;\n  private _dismissKeys?: Set<number>;\n  private _isNavigatingWithKeyboard_DO_NOT_USE = false;\n\n  constructor(win: WindowWithKeyborg, props?: KeyborgProps) {\n    this.id = \"c\" + ++_lastId;\n    this._win = win;\n    const doc = win.document;\n\n    if (props) {\n      const triggerKeys = props.triggerKeys;\n      const dismissKeys = props.dismissKeys;\n\n      if (triggerKeys?.length) {\n        this._triggerKeys = new Set(triggerKeys);\n      }\n\n      if (dismissKeys?.length) {\n        this._dismissKeys = new Set(dismissKeys);\n      }\n    }\n\n    doc.addEventListener(KEYBORG_FOCUSIN, this._onFocusIn, true); // Capture!\n    doc.addEventListener(\"mousedown\", this._onMouseDown, true); // Capture!\n    win.addEventListener(\"keydown\", this._onKeyDown, true); // Capture!\n\n    doc.addEventListener(\"touchstart\", this._onMouseOrTouch, true); // Capture!\n    doc.addEventListener(\"touchend\", this._onMouseOrTouch, true); // Capture!\n    doc.addEventListener(\"touchcancel\", this._onMouseOrTouch, true); // Capture!\n\n    setupFocusEvent(win);\n  }\n\n  get isNavigatingWithKeyboard() {\n    return this._isNavigatingWithKeyboard_DO_NOT_USE;\n  }\n\n  set isNavigatingWithKeyboard(val: boolean) {\n    if (this._isNavigatingWithKeyboard_DO_NOT_USE !== val) {\n      this._isNavigatingWithKeyboard_DO_NOT_USE = val;\n      this.update();\n    }\n  }\n\n  dispose(): void {\n    const win = this._win;\n\n    if (win) {\n      if (this._isMouseOrTouchUsedTimer) {\n        win.clearTimeout(this._isMouseOrTouchUsedTimer);\n        this._isMouseOrTouchUsedTimer = undefined;\n      }\n\n      if (this._dismissTimer) {\n        win.clearTimeout(this._dismissTimer);\n        this._dismissTimer = undefined;\n      }\n\n      disposeFocusEvent(win);\n\n      const doc = win.document;\n\n      doc.removeEventListener(KEYBORG_FOCUSIN, this._onFocusIn, true); // Capture!\n      doc.removeEventListener(\"mousedown\", this._onMouseDown, true); // Capture!\n      win.removeEventListener(\"keydown\", this._onKeyDown, true); // Capture!\n\n      doc.removeEventListener(\"touchstart\", this._onMouseOrTouch, true); // Capture!\n      doc.removeEventListener(\"touchend\", this._onMouseOrTouch, true); // Capture!\n      doc.removeEventListener(\"touchcancel\", this._onMouseOrTouch, true); // Capture!\n\n      delete this._win;\n    }\n  }\n\n  isDisposed(): boolean {\n    return !!this._win;\n  }\n\n  /**\n   * Updates all keyborg instances with the keyboard navigation state\n   */\n  update(): void {\n    const keyborgs = this._win?.__keyborg?.refs;\n\n    if (keyborgs) {\n      for (const id of Object.keys(keyborgs)) {\n        Keyborg.update(keyborgs[id], this.isNavigatingWithKeyboard);\n      }\n    }\n  }\n\n  private _onFocusIn = (e: KeyborgFocusInEvent) => {\n    // When the focus is moved not programmatically and without keydown events,\n    // it is likely that the focus is moved by screen reader (as it might swallow\n    // the events when the screen reader shortcuts are used). The screen reader\n    // usage is keyboard navigation.\n\n    if (this._isMouseOrTouchUsedTimer) {\n      // There was a mouse or touch event recently.\n      return;\n    }\n\n    if (this.isNavigatingWithKeyboard) {\n      return;\n    }\n\n    const details = e.detail;\n\n    if (!details.relatedTarget) {\n      return;\n    }\n\n    if (\n      details.isFocusedProgrammatically ||\n      details.isFocusedProgrammatically === undefined\n    ) {\n      // The element is focused programmatically, or the programmatic focus detection\n      // is not working.\n      return;\n    }\n\n    this.isNavigatingWithKeyboard = true;\n  };\n\n  private _onMouseDown = (e: MouseEvent): void => {\n    if (\n      e.buttons === 0 ||\n      (e.clientX === 0 && e.clientY === 0 && e.screenX === 0 && e.screenY === 0)\n    ) {\n      // This is most likely an event triggered by the screen reader to perform\n      // an action on an element, do not dismiss the keyboard navigation mode.\n      return;\n    }\n\n    this._onMouseOrTouch();\n  };\n\n  private _onMouseOrTouch = (): void => {\n    const win = this._win;\n\n    if (win) {\n      if (this._isMouseOrTouchUsedTimer) {\n        win.clearTimeout(this._isMouseOrTouchUsedTimer);\n      }\n\n      this._isMouseOrTouchUsedTimer = win.setTimeout(() => {\n        delete this._isMouseOrTouchUsedTimer;\n      }, 1000); // Keeping the indication of mouse or touch usage for some time.\n    }\n\n    this.isNavigatingWithKeyboard = false;\n  };\n\n  private _onKeyDown = (e: KeyboardEvent): void => {\n    const isNavigatingWithKeyboard = this.isNavigatingWithKeyboard;\n\n    if (isNavigatingWithKeyboard) {\n      if (this._shouldDismissKeyboardNavigation(e)) {\n        this._scheduleDismiss();\n      }\n    } else {\n      if (this._shouldTriggerKeyboardNavigation(e)) {\n        this.isNavigatingWithKeyboard = true;\n      }\n    }\n  };\n\n  /**\n   * @returns whether the keyboard event should trigger keyboard navigation mode\n   */\n  private _shouldTriggerKeyboardNavigation(e: KeyboardEvent) {\n    // TODO Some rich text fields can allow Tab key for indentation so it doesn't\n    // need to be a navigation key. If there is a bug regarding that we should revisit\n    if (e.key === \"Tab\") {\n      return true;\n    }\n\n    const activeElement = this._win?.document\n      .activeElement as HTMLElement | null;\n    const isTriggerKey = !this._triggerKeys || this._triggerKeys.has(e.keyCode);\n\n    const isEditable =\n      activeElement &&\n      (activeElement.tagName === \"INPUT\" ||\n        activeElement.tagName === \"TEXTAREA\" ||\n        activeElement.isContentEditable);\n\n    return isTriggerKey && !isEditable;\n  }\n\n  /**\n   * @returns whether the keyboard event should dismiss keyboard navigation mode\n   */\n  private _shouldDismissKeyboardNavigation(e: KeyboardEvent) {\n    return this._dismissKeys?.has(e.keyCode);\n  }\n\n  private _scheduleDismiss(): void {\n    const win = this._win;\n\n    if (win) {\n      if (this._dismissTimer) {\n        win.clearTimeout(this._dismissTimer);\n        this._dismissTimer = undefined;\n      }\n\n      const was = win.document.activeElement;\n\n      this._dismissTimer = win.setTimeout(() => {\n        this._dismissTimer = undefined;\n\n        const cur = win.document.activeElement;\n\n        if (was && cur && was === cur) {\n          // Esc was pressed, currently focused element hasn't changed.\n          // Just dismiss the keyboard navigation mode.\n          this.isNavigatingWithKeyboard = false;\n        }\n      }, _dismissTimeout);\n    }\n  }\n}\n\n/**\n * Used to determine the keyboard navigation state\n */\nexport class Keyborg {\n  private _id: string;\n  private _win?: WindowWithKeyborg;\n  private _core?: KeyborgCore;\n  private _cb: KeyborgCallback[] = [];\n\n  static create(win: WindowWithKeyborg, props?: KeyborgProps): Keyborg {\n    return new Keyborg(win, props);\n  }\n\n  static dispose(instance: Keyborg): void {\n    instance.dispose();\n  }\n\n  /**\n   * Updates all subscribed callbacks with the keyboard navigation state\n   */\n  static update(instance: Keyborg, isNavigatingWithKeyboard: boolean): void {\n    instance._cb.forEach((callback) => callback(isNavigatingWithKeyboard));\n  }\n\n  private constructor(win: WindowWithKeyborg, props?: KeyborgProps) {\n    this._id = \"k\" + ++_lastId;\n    this._win = win;\n\n    const current = win.__keyborg;\n\n    if (current) {\n      this._core = current.core;\n      current.refs[this._id] = this;\n    } else {\n      this._core = new KeyborgCore(win, props);\n      win.__keyborg = {\n        core: this._core,\n        refs: { [this._id]: this },\n      };\n    }\n  }\n\n  private dispose(): void {\n    const current = this._win?.__keyborg;\n\n    if (current?.refs[this._id]) {\n      delete current.refs[this._id];\n\n      if (Object.keys(current.refs).length === 0) {\n        current.core.dispose();\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        delete this._win!.__keyborg;\n      }\n    } else if (process.env.NODE_ENV !== \"production\") {\n      console.error(\n        `Keyborg instance ${this._id} is being disposed incorrectly.`,\n      );\n    }\n\n    this._cb = [];\n    delete this._core;\n    delete this._win;\n  }\n\n  /**\n   * @returns Whether the user is navigating with keyboard\n   */\n  isNavigatingWithKeyboard(): boolean {\n    return !!this._core?.isNavigatingWithKeyboard;\n  }\n\n  /**\n   * @param callback - Called when the keyboard navigation state changes\n   */\n  subscribe(callback: KeyborgCallback): void {\n    this._cb.push(callback);\n  }\n\n  /**\n   * @param callback - Registered with subscribe\n   */\n  unsubscribe(callback: KeyborgCallback): void {\n    const index = this._cb.indexOf(callback);\n\n    if (index >= 0) {\n      this._cb.splice(index, 1);\n    }\n  }\n\n  /**\n   * Manually set the keyboard navigtion state\n   */\n  setVal(isNavigatingWithKeyboard: boolean): void {\n    if (this._core) {\n      this._core.isNavigatingWithKeyboard = isNavigatingWithKeyboard;\n    }\n  }\n}\n\nexport function createKeyborg(win: Window, props?: KeyborgProps): Keyborg {\n  return Keyborg.create(win, props);\n}\n\nexport function disposeKeyborg(instance: Keyborg) {\n  Keyborg.dispose(instance);\n}\n", "/*!\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nexport type { Keyborg, KeyborgCallback } from \"./Keyborg\";\nexport { createKeyborg, disposeKeyborg } from \"./Keyborg\";\n\nexport type {\n  KeyborgFocusInEvent,\n  KeyborgFocusInEventDetails,\n  KeyborgFocusOutEvent,\n  KeyborgFocusOutEventDetails,\n} from \"./FocusEvent\";\nexport {\n  getLastFocusedProgrammatically,\n  nativeFocus,\n  KEYBORG_FOCUSIN,\n  KEYBORG_FOCUSOUT,\n} from \"./FocusEvent\";\n\nexport const version = process.env.PKG_VERSION;\n", "import * as React from 'react';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { applyFocusVisiblePolyfill } from '../focus/focusVisiblePolyfill';\nexport function useFocusVisible(options = {}) {\n    const contextValue = useFluent();\n    const scopeRef = React.useRef(null);\n    var _options_targetDocument;\n    const targetDocument = (_options_targetDocument = options.targetDocument) !== null && _options_targetDocument !== void 0 ? _options_targetDocument : contextValue.targetDocument;\n    React.useEffect(()=>{\n        if ((targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.defaultView) && scopeRef.current) {\n            return applyFocusVisiblePolyfill(scopeRef.current, targetDocument.defaultView);\n        }\n    }, [\n        scopeRef,\n        targetDocument\n    ]);\n    return scopeRef;\n}\n", "export const KEYBOARD_NAV_ATTRIBUTE = 'data-keyboard-nav';\nexport const KEYBOARD_NAV_SELECTOR = `:global([${KEYBOARD_NAV_ATTRIBUTE}])`;\n/**\n * @internal\n */ export const FOCUS_VISIBLE_ATTR = 'data-fui-focus-visible';\n/**\n * @internal\n */ export const FOCUS_WITHIN_ATTR = 'data-fui-focus-within';\nexport const defaultOptions = {\n    style: {},\n    selector: 'focus',\n    customizeSelector: (selector)=>selector\n};\n", "import { isHTMLElement } from '@fluentui/react-utilities';\nimport { KEYBORG_FOCUSIN, createKeyborg, disposeKeyborg } from 'keyborg';\nimport { FOCUS_VISIBLE_ATTR } from './constants';\n/**\n * @internal\n * @param scope - Applies the ponyfill to all DOM children\n * @param targetWindow - window\n */ export function applyFocusVisiblePolyfill(scope, targetWindow) {\n    if (alreadyInScope(scope)) {\n        // Focus visible polyfill already applied at this scope\n        return ()=>undefined;\n    }\n    const state = {\n        current: undefined\n    };\n    const keyborg = createKeyborg(targetWindow);\n    function registerElementIfNavigating(el) {\n        if (keyborg.isNavigatingWithKeyboard() && isHTMLElement(el)) {\n            state.current = el;\n            el.setAttribute(FOCUS_VISIBLE_ATTR, '');\n        }\n    }\n    function disposeCurrentElement() {\n        if (state.current) {\n            state.current.removeAttribute(FOCUS_VISIBLE_ATTR);\n            state.current = undefined;\n        }\n    }\n    // When navigation mode changes remove the focus-visible selector\n    keyborg.subscribe((isNavigatingWithKeyboard)=>{\n        if (!isNavigatingWithKeyboard) {\n            disposeCurrentElement();\n        } else {\n            registerElementIfNavigating(targetWindow.document.activeElement);\n        }\n    });\n    // Keyborg's focusin event is delegated so it's only registered once on the window\n    // and contains metadata about the focus event\n    const keyborgListener = (e)=>{\n        disposeCurrentElement();\n        const target = e.composedPath()[0];\n        registerElementIfNavigating(target);\n    };\n    // Make sure that when focus leaves the scope, the focus visible class is removed\n    const blurListener = (e)=>{\n        if (!e.relatedTarget || isHTMLElement(e.relatedTarget) && !scope.contains(e.relatedTarget)) {\n            disposeCurrentElement();\n        }\n    };\n    scope.addEventListener(KEYBORG_FOCUSIN, keyborgListener);\n    scope.addEventListener('focusout', blurListener);\n    scope.focusVisible = true;\n    if (scope.contains(targetWindow.document.activeElement)) {\n        registerElementIfNavigating(targetWindow.document.activeElement);\n    }\n    // Return disposer\n    return ()=>{\n        disposeCurrentElement();\n        scope.removeEventListener(KEYBORG_FOCUSIN, keyborgListener);\n        scope.removeEventListener('focusout', blurListener);\n        delete scope.focusVisible;\n        disposeKeyborg(keyborg);\n    };\n}\nfunction alreadyInScope(el) {\n    if (!el) {\n        return false;\n    }\n    if (el.focusVisible) {\n        return true;\n    }\n    return alreadyInScope(el === null || el === void 0 ? void 0 : el.parentElement);\n}\n", "/* !!! DO NOT EDIT !!! */ /* This file has been generated by the token pipeline */ export const grey = {\n    '2': '#050505',\n    '4': '#0a0a0a',\n    '6': '#0f0f0f',\n    '8': '#141414',\n    '10': '#1a1a1a',\n    '12': '#1f1f1f',\n    '14': '#242424',\n    '16': '#292929',\n    '18': '#2e2e2e',\n    '20': '#333333',\n    '22': '#383838',\n    '24': '#3d3d3d',\n    '26': '#424242',\n    '28': '#474747',\n    '30': '#4d4d4d',\n    '32': '#525252',\n    '34': '#575757',\n    '36': '#5c5c5c',\n    '38': '#616161',\n    '40': '#666666',\n    '42': '#6b6b6b',\n    '44': '#707070',\n    '46': '#757575',\n    '48': '#7a7a7a',\n    '50': '#808080',\n    '52': '#858585',\n    '54': '#8a8a8a',\n    '56': '#8f8f8f',\n    '58': '#949494',\n    '60': '#999999',\n    '62': '#9e9e9e',\n    '64': '#a3a3a3',\n    '66': '#a8a8a8',\n    '68': '#adadad',\n    '70': '#b3b3b3',\n    '72': '#b8b8b8',\n    '74': '#bdbdbd',\n    '76': '#c2c2c2',\n    '78': '#c7c7c7',\n    '80': '#cccccc',\n    '82': '#d1d1d1',\n    '84': '#d6d6d6',\n    '86': '#dbdbdb',\n    '88': '#e0e0e0',\n    '90': '#e6e6e6',\n    '92': '#ebebeb',\n    '94': '#f0f0f0',\n    '96': '#f5f5f5',\n    '98': '#fafafa'\n};\nexport const whiteAlpha = {\n    '5': 'rgba(255, 255, 255, 0.05)',\n    '10': 'rgba(255, 255, 255, 0.1)',\n    '20': 'rgba(255, 255, 255, 0.2)',\n    '30': 'rgba(255, 255, 255, 0.3)',\n    '40': 'rgba(255, 255, 255, 0.4)',\n    '50': 'rgba(255, 255, 255, 0.5)',\n    '60': 'rgba(255, 255, 255, 0.6)',\n    '70': 'rgba(255, 255, 255, 0.7)',\n    '80': 'rgba(255, 255, 255, 0.8)',\n    '90': 'rgba(255, 255, 255, 0.9)'\n};\nexport const blackAlpha = {\n    '5': 'rgba(0, 0, 0, 0.05)',\n    '10': 'rgba(0, 0, 0, 0.1)',\n    '20': 'rgba(0, 0, 0, 0.2)',\n    '30': 'rgba(0, 0, 0, 0.3)',\n    '40': 'rgba(0, 0, 0, 0.4)',\n    '50': 'rgba(0, 0, 0, 0.5)',\n    '60': 'rgba(0, 0, 0, 0.6)',\n    '70': 'rgba(0, 0, 0, 0.7)',\n    '80': 'rgba(0, 0, 0, 0.8)',\n    '90': 'rgba(0, 0, 0, 0.9)'\n};\nexport const grey10Alpha = {\n    '5': 'rgba(26, 26, 26, 0.05)',\n    '10': 'rgba(26, 26, 26, 0.1)',\n    '20': 'rgba(26, 26, 26, 0.2)',\n    '30': 'rgba(26, 26, 26, 0.3)',\n    '40': 'rgba(26, 26, 26, 0.4)',\n    '50': 'rgba(26, 26, 26, 0.5)',\n    '60': 'rgba(26, 26, 26, 0.6)',\n    '70': 'rgba(26, 26, 26, 0.7)',\n    '80': 'rgba(26, 26, 26, 0.8)',\n    '90': 'rgba(26, 26, 26, 0.9)'\n};\nexport const grey12Alpha = {\n    '5': 'rgba(31, 31, 31, 0.05)',\n    '10': 'rgba(31, 31, 31, 0.1)',\n    '20': 'rgba(31, 31, 31, 0.2)',\n    '30': 'rgba(31, 31, 31, 0.3)',\n    '40': 'rgba(31, 31, 31, 0.4)',\n    '50': 'rgba(31, 31, 31, 0.5)',\n    '60': 'rgba(31, 31, 31, 0.6)',\n    '70': 'rgba(31, 31, 31, 0.7)',\n    '80': 'rgba(31, 31, 31, 0.8)',\n    '90': 'rgba(31, 31, 31, 0.9)'\n};\nexport const grey14Alpha = {\n    '5': 'rgba(36, 36, 36, 0.05)',\n    '10': 'rgba(36, 36, 36, 0.1)',\n    '20': 'rgba(36, 36, 36, 0.2)',\n    '30': 'rgba(36, 36, 36, 0.3)',\n    '40': 'rgba(36, 36, 36, 0.4)',\n    '50': 'rgba(36, 36, 36, 0.5)',\n    '60': 'rgba(36, 36, 36, 0.6)',\n    '70': 'rgba(36, 36, 36, 0.7)',\n    '80': 'rgba(36, 36, 36, 0.8)',\n    '90': 'rgba(36, 36, 36, 0.9)'\n};\nexport const white = '#ffffff';\nexport const black = '#000000';\nexport const hcHyperlink = '#ffff00';\nexport const hcHighlight = '#1aebff';\nexport const hcDisabled = '#3ff23f';\nexport const hcCanvas = '#000000';\nexport const hcCanvasText = '#ffffff';\nexport const hcHighlightText = '#000000';\nexport const hcButtonText = '#000000';\nexport const hcButtonFace = '#ffffff';\nexport const darkRed = {\n    shade50: '#130204',\n    shade40: '#230308',\n    shade30: '#420610',\n    shade20: '#590815',\n    shade10: '#690a19',\n    primary: '#750b1c',\n    tint10: '#861b2c',\n    tint20: '#962f3f',\n    tint30: '#ac4f5e',\n    tint40: '#d69ca5',\n    tint50: '#e9c7cd',\n    tint60: '#f9f0f2'\n};\nexport const burgundy = {\n    shade50: '#1a0607',\n    shade40: '#310b0d',\n    shade30: '#5c1519',\n    shade20: '#7d1d21',\n    shade10: '#942228',\n    primary: '#a4262c',\n    tint10: '#af393e',\n    tint20: '#ba4d52',\n    tint30: '#c86c70',\n    tint40: '#e4afb2',\n    tint50: '#f0d3d4',\n    tint60: '#fbf4f4'\n};\nexport const cranberry = {\n    shade50: '#200205',\n    shade40: '#3b0509',\n    shade30: '#6e0811',\n    shade20: '#960b18',\n    shade10: '#b10e1c',\n    primary: '#c50f1f',\n    tint10: '#cc2635',\n    tint20: '#d33f4c',\n    tint30: '#dc626d',\n    tint40: '#eeacb2',\n    tint50: '#f6d1d5',\n    tint60: '#fdf3f4'\n};\nexport const red = {\n    shade50: '#210809',\n    shade40: '#3f1011',\n    shade30: '#751d1f',\n    shade20: '#9f282b',\n    shade10: '#bc2f32',\n    primary: '#d13438',\n    tint10: '#d7494c',\n    tint20: '#dc5e62',\n    tint30: '#e37d80',\n    tint40: '#f1bbbc',\n    tint50: '#f8dadb',\n    tint60: '#fdf6f6'\n};\nexport const darkOrange = {\n    shade50: '#230900',\n    shade40: '#411200',\n    shade30: '#7a2101',\n    shade20: '#a62d01',\n    shade10: '#c43501',\n    primary: '#da3b01',\n    tint10: '#de501c',\n    tint20: '#e36537',\n    tint30: '#e9835e',\n    tint40: '#f4bfab',\n    tint50: '#f9dcd1',\n    tint60: '#fdf6f3'\n};\nexport const bronze = {\n    shade50: '#1b0a01',\n    shade40: '#321303',\n    shade30: '#5e2405',\n    shade20: '#7f3107',\n    shade10: '#963a08',\n    primary: '#a74109',\n    tint10: '#b2521e',\n    tint20: '#bc6535',\n    tint30: '#ca8057',\n    tint40: '#e5bba4',\n    tint50: '#f1d9cc',\n    tint60: '#fbf5f2'\n};\nexport const pumpkin = {\n    shade50: '#200d03',\n    shade40: '#3d1805',\n    shade30: '#712d09',\n    shade20: '#9a3d0c',\n    shade10: '#b6480e',\n    primary: '#ca5010',\n    tint10: '#d06228',\n    tint20: '#d77440',\n    tint30: '#df8e64',\n    tint40: '#efc4ad',\n    tint50: '#f7dfd2',\n    tint60: '#fdf7f4'\n};\nexport const orange = {\n    shade50: '#271002',\n    shade40: '#4a1e04',\n    shade30: '#8a3707',\n    shade20: '#bc4b09',\n    shade10: '#de590b',\n    primary: '#f7630c',\n    tint10: '#f87528',\n    tint20: '#f98845',\n    tint30: '#faa06b',\n    tint40: '#fdcfb4',\n    tint50: '#fee5d7',\n    tint60: '#fff9f5'\n};\nexport const peach = {\n    shade50: '#291600',\n    shade40: '#4d2a00',\n    shade30: '#8f4e00',\n    shade20: '#c26a00',\n    shade10: '#e67e00',\n    primary: '#ff8c00',\n    tint10: '#ff9a1f',\n    tint20: '#ffa83d',\n    tint30: '#ffba66',\n    tint40: '#ffddb3',\n    tint50: '#ffedd6',\n    tint60: '#fffaf5'\n};\nexport const marigold = {\n    shade50: '#251a00',\n    shade40: '#463100',\n    shade30: '#835b00',\n    shade20: '#b27c00',\n    shade10: '#d39300',\n    primary: '#eaa300',\n    tint10: '#edad1c',\n    tint20: '#efb839',\n    tint30: '#f2c661',\n    tint40: '#f9e2ae',\n    tint50: '#fcefd3',\n    tint60: '#fefbf4'\n};\nexport const yellow = {\n    shade50: '#282400',\n    shade40: '#4c4400',\n    shade30: '#817400',\n    shade20: '#c0ad00',\n    shade10: '#e4cc00',\n    primary: '#fde300',\n    tint10: '#fde61e',\n    tint20: '#fdea3d',\n    tint30: '#feee66',\n    tint40: '#fef7b2',\n    tint50: '#fffad6',\n    tint60: '#fffef5'\n};\nexport const gold = {\n    shade50: '#1f1900',\n    shade40: '#3a2f00',\n    shade30: '#6c5700',\n    shade20: '#937700',\n    shade10: '#ae8c00',\n    primary: '#c19c00',\n    tint10: '#c8a718',\n    tint20: '#d0b232',\n    tint30: '#dac157',\n    tint40: '#ecdfa5',\n    tint50: '#f5eece',\n    tint60: '#fdfbf2'\n};\nexport const brass = {\n    shade50: '#181202',\n    shade40: '#2e2103',\n    shade30: '#553e06',\n    shade20: '#745408',\n    shade10: '#89640a',\n    primary: '#986f0b',\n    tint10: '#a47d1e',\n    tint20: '#b18c34',\n    tint30: '#c1a256',\n    tint40: '#e0cea2',\n    tint50: '#efe4cb',\n    tint60: '#fbf8f2'\n};\nexport const brown = {\n    shade50: '#170e07',\n    shade40: '#2b1a0e',\n    shade30: '#50301a',\n    shade20: '#6c4123',\n    shade10: '#804d29',\n    primary: '#8e562e',\n    tint10: '#9c663f',\n    tint20: '#a97652',\n    tint30: '#bb8f6f',\n    tint40: '#ddc3b0',\n    tint50: '#edded3',\n    tint60: '#faf7f4'\n};\nexport const darkBrown = {\n    shade50: '#0c0704',\n    shade40: '#170c08',\n    shade30: '#2b1710',\n    shade20: '#3a1f15',\n    shade10: '#452519',\n    primary: '#4d291c',\n    tint10: '#623a2b',\n    tint20: '#784d3e',\n    tint30: '#946b5c',\n    tint40: '#caada3',\n    tint50: '#e3d2cb',\n    tint60: '#f8f3f2'\n};\nexport const lime = {\n    shade50: '#121b06',\n    shade40: '#23330b',\n    shade30: '#405f14',\n    shade20: '#57811b',\n    shade10: '#689920',\n    primary: '#73aa24',\n    tint10: '#81b437',\n    tint20: '#90be4c',\n    tint30: '#a4cc6c',\n    tint40: '#cfe5af',\n    tint50: '#e5f1d3',\n    tint60: '#f8fcf4'\n};\nexport const forest = {\n    shade50: '#0c1501',\n    shade40: '#162702',\n    shade30: '#294903',\n    shade20: '#376304',\n    shade10: '#427505',\n    primary: '#498205',\n    tint10: '#599116',\n    tint20: '#6ba02b',\n    tint30: '#85b44c',\n    tint40: '#bdd99b',\n    tint50: '#dbebc7',\n    tint60: '#f6faf0'\n};\nexport const seafoam = {\n    shade50: '#002111',\n    shade40: '#003d20',\n    shade30: '#00723b',\n    shade20: '#009b51',\n    shade10: '#00b85f',\n    primary: '#00cc6a',\n    tint10: '#19d279',\n    tint20: '#34d889',\n    tint30: '#5ae0a0',\n    tint40: '#a8f0cd',\n    tint50: '#cff7e4',\n    tint60: '#f3fdf8'\n};\nexport const lightGreen = {\n    shade50: '#031a02',\n    shade40: '#063004',\n    shade30: '#0b5a08',\n    shade20: '#0e7a0b',\n    shade10: '#11910d',\n    primary: '#13a10e',\n    tint10: '#27ac22',\n    tint20: '#3db838',\n    tint30: '#5ec75a',\n    tint40: '#a7e3a5',\n    tint50: '#cef0cd',\n    tint60: '#f2fbf2'\n};\nexport const green = {\n    shade50: '#031403',\n    shade40: '#052505',\n    shade30: '#094509',\n    shade20: '#0c5e0c',\n    shade10: '#0e700e',\n    primary: '#107c10',\n    tint10: '#218c21',\n    tint20: '#359b35',\n    tint30: '#54b054',\n    tint40: '#9fd89f',\n    tint50: '#c9eac9',\n    tint60: '#f1faf1'\n};\nexport const darkGreen = {\n    shade50: '#021102',\n    shade40: '#032003',\n    shade30: '#063b06',\n    shade20: '#085108',\n    shade10: '#0a5f0a',\n    primary: '#0b6a0b',\n    tint10: '#1a7c1a',\n    tint20: '#2d8e2d',\n    tint30: '#4da64d',\n    tint40: '#9ad29a',\n    tint50: '#c6e7c6',\n    tint60: '#f0f9f0'\n};\nexport const lightTeal = {\n    shade50: '#001d1f',\n    shade40: '#00373a',\n    shade30: '#00666d',\n    shade20: '#008b94',\n    shade10: '#00a5af',\n    primary: '#00b7c3',\n    tint10: '#18bfca',\n    tint20: '#32c8d1',\n    tint30: '#58d3db',\n    tint40: '#a6e9ed',\n    tint50: '#cef3f5',\n    tint60: '#f2fcfd'\n};\nexport const teal = {\n    shade50: '#001516',\n    shade40: '#012728',\n    shade30: '#02494c',\n    shade20: '#026467',\n    shade10: '#037679',\n    primary: '#038387',\n    tint10: '#159195',\n    tint20: '#2aa0a4',\n    tint30: '#4cb4b7',\n    tint40: '#9bd9db',\n    tint50: '#c7ebec',\n    tint60: '#f0fafa'\n};\nexport const darkTeal = {\n    shade50: '#001010',\n    shade40: '#001f1f',\n    shade30: '#003939',\n    shade20: '#004e4e',\n    shade10: '#005c5c',\n    primary: '#006666',\n    tint10: '#0e7878',\n    tint20: '#218b8b',\n    tint30: '#41a3a3',\n    tint40: '#92d1d1',\n    tint50: '#c2e7e7',\n    tint60: '#eff9f9'\n};\nexport const cyan = {\n    shade50: '#00181e',\n    shade40: '#002e38',\n    shade30: '#005669',\n    shade20: '#00748f',\n    shade10: '#008aa9',\n    primary: '#0099bc',\n    tint10: '#18a4c4',\n    tint20: '#31afcc',\n    tint30: '#56bfd7',\n    tint40: '#a4deeb',\n    tint50: '#cdedf4',\n    tint60: '#f2fafc'\n};\nexport const steel = {\n    shade50: '#000f12',\n    shade40: '#001b22',\n    shade30: '#00333f',\n    shade20: '#004555',\n    shade10: '#005265',\n    primary: '#005b70',\n    tint10: '#0f6c81',\n    tint20: '#237d92',\n    tint30: '#4496a9',\n    tint40: '#94c8d4',\n    tint50: '#c3e1e8',\n    tint60: '#eff7f9'\n};\nexport const lightBlue = {\n    shade50: '#091823',\n    shade40: '#112d42',\n    shade30: '#20547c',\n    shade20: '#2c72a8',\n    shade10: '#3487c7',\n    primary: '#3a96dd',\n    tint10: '#4fa1e1',\n    tint20: '#65ade5',\n    tint30: '#83bdeb',\n    tint40: '#bfddf5',\n    tint50: '#dcedfa',\n    tint60: '#f6fafe'\n};\nexport const blue = {\n    shade50: '#001322',\n    shade40: '#002440',\n    shade30: '#004377',\n    shade20: '#005ba1',\n    shade10: '#006cbf',\n    primary: '#0078d4',\n    tint10: '#1a86d9',\n    tint20: '#3595de',\n    tint30: '#5caae5',\n    tint40: '#a9d3f2',\n    tint50: '#d0e7f8',\n    tint60: '#f3f9fd'\n};\nexport const royalBlue = {\n    shade50: '#000c16',\n    shade40: '#00172a',\n    shade30: '#002c4e',\n    shade20: '#003b6a',\n    shade10: '#00467e',\n    primary: '#004e8c',\n    tint10: '#125e9a',\n    tint20: '#286fa8',\n    tint30: '#4a89ba',\n    tint40: '#9abfdc',\n    tint50: '#c7dced',\n    tint60: '#f0f6fa'\n};\nexport const darkBlue = {\n    shade50: '#000910',\n    shade40: '#00111f',\n    shade30: '#002039',\n    shade20: '#002b4e',\n    shade10: '#00335c',\n    primary: '#003966',\n    tint10: '#0e4a78',\n    tint20: '#215c8b',\n    tint30: '#4178a3',\n    tint40: '#92b5d1',\n    tint50: '#c2d6e7',\n    tint60: '#eff4f9'\n};\nexport const cornflower = {\n    shade50: '#0d1126',\n    shade40: '#182047',\n    shade30: '#2c3c85',\n    shade20: '#3c51b4',\n    shade10: '#4760d5',\n    primary: '#4f6bed',\n    tint10: '#637cef',\n    tint20: '#778df1',\n    tint30: '#93a4f4',\n    tint40: '#c8d1fa',\n    tint50: '#e1e6fc',\n    tint60: '#f7f9fe'\n};\nexport const navy = {\n    shade50: '#00061d',\n    shade40: '#000c36',\n    shade30: '#001665',\n    shade20: '#001e89',\n    shade10: '#0023a2',\n    primary: '#0027b4',\n    tint10: '#173bbd',\n    tint20: '#3050c6',\n    tint30: '#546fd2',\n    tint40: '#a3b2e8',\n    tint50: '#ccd5f3',\n    tint60: '#f2f4fc'\n};\nexport const lavender = {\n    shade50: '#120f25',\n    shade40: '#221d46',\n    shade30: '#3f3682',\n    shade20: '#5649b0',\n    shade10: '#6656d1',\n    primary: '#7160e8',\n    tint10: '#8172eb',\n    tint20: '#9184ee',\n    tint30: '#a79cf1',\n    tint40: '#d2ccf8',\n    tint50: '#e7e4fb',\n    tint60: '#f9f8fe'\n};\nexport const purple = {\n    shade50: '#0f0717',\n    shade40: '#1c0e2b',\n    shade30: '#341a51',\n    shade20: '#46236e',\n    shade10: '#532982',\n    primary: '#5c2e91',\n    tint10: '#6b3f9e',\n    tint20: '#7c52ab',\n    tint30: '#9470bd',\n    tint40: '#c6b1de',\n    tint50: '#e0d3ed',\n    tint60: '#f7f4fb'\n};\nexport const darkPurple = {\n    shade50: '#0a0411',\n    shade40: '#130820',\n    shade30: '#240f3c',\n    shade20: '#311552',\n    shade10: '#3a1861',\n    primary: '#401b6c',\n    tint10: '#512b7e',\n    tint20: '#633e8f',\n    tint30: '#7e5ca7',\n    tint40: '#b9a3d3',\n    tint50: '#d8cce7',\n    tint60: '#f5f2f9'\n};\nexport const orchid = {\n    shade50: '#16101d',\n    shade40: '#281e37',\n    shade30: '#4c3867',\n    shade20: '#674c8c',\n    shade10: '#795aa6',\n    primary: '#8764b8',\n    tint10: '#9373c0',\n    tint20: '#a083c9',\n    tint30: '#b29ad4',\n    tint40: '#d7caea',\n    tint50: '#e9e2f4',\n    tint60: '#f9f8fc'\n};\nexport const grape = {\n    shade50: '#160418',\n    shade40: '#29072e',\n    shade30: '#4c0d55',\n    shade20: '#671174',\n    shade10: '#7a1589',\n    primary: '#881798',\n    tint10: '#952aa4',\n    tint20: '#a33fb1',\n    tint30: '#b55fc1',\n    tint40: '#d9a7e0',\n    tint50: '#eaceef',\n    tint60: '#faf2fb'\n};\nexport const berry = {\n    shade50: '#1f091d',\n    shade40: '#3a1136',\n    shade30: '#6d2064',\n    shade20: '#932b88',\n    shade10: '#af33a1',\n    primary: '#c239b3',\n    tint10: '#c94cbc',\n    tint20: '#d161c4',\n    tint30: '#da7ed0',\n    tint40: '#edbbe7',\n    tint50: '#f5daf2',\n    tint60: '#fdf5fc'\n};\nexport const lilac = {\n    shade50: '#1c0b1f',\n    shade40: '#35153a',\n    shade30: '#63276d',\n    shade20: '#863593',\n    shade10: '#9f3faf',\n    primary: '#b146c2',\n    tint10: '#ba58c9',\n    tint20: '#c36bd1',\n    tint30: '#cf87da',\n    tint40: '#e6bfed',\n    tint50: '#f2dcf5',\n    tint60: '#fcf6fd'\n};\nexport const pink = {\n    shade50: '#24091b',\n    shade40: '#441232',\n    shade30: '#80215d',\n    shade20: '#ad2d7e',\n    shade10: '#cd3595',\n    primary: '#e43ba6',\n    tint10: '#e750b0',\n    tint20: '#ea66ba',\n    tint30: '#ef85c8',\n    tint40: '#f7c0e3',\n    tint50: '#fbddf0',\n    tint60: '#fef6fb'\n};\nexport const hotPink = {\n    shade50: '#240016',\n    shade40: '#44002a',\n    shade30: '#7f004e',\n    shade20: '#ad006a',\n    shade10: '#cc007e',\n    primary: '#e3008c',\n    tint10: '#e61c99',\n    tint20: '#ea38a6',\n    tint30: '#ee5fb7',\n    tint40: '#f7adda',\n    tint50: '#fbd2eb',\n    tint60: '#fef4fa'\n};\nexport const magenta = {\n    shade50: '#1f0013',\n    shade40: '#390024',\n    shade30: '#6b0043',\n    shade20: '#91005a',\n    shade10: '#ac006b',\n    primary: '#bf0077',\n    tint10: '#c71885',\n    tint20: '#ce3293',\n    tint30: '#d957a8',\n    tint40: '#eca5d1',\n    tint50: '#f5cee6',\n    tint60: '#fcf2f9'\n};\nexport const plum = {\n    shade50: '#13000c',\n    shade40: '#240017',\n    shade30: '#43002b',\n    shade20: '#5a003b',\n    shade10: '#6b0045',\n    primary: '#77004d',\n    tint10: '#87105d',\n    tint20: '#98246f',\n    tint30: '#ad4589',\n    tint40: '#d696c0',\n    tint50: '#e9c4dc',\n    tint60: '#faf0f6'\n};\nexport const beige = {\n    shade50: '#141313',\n    shade40: '#252323',\n    shade30: '#444241',\n    shade20: '#5d5958',\n    shade10: '#6e6968',\n    primary: '#7a7574',\n    tint10: '#8a8584',\n    tint20: '#9a9594',\n    tint30: '#afabaa',\n    tint40: '#d7d4d4',\n    tint50: '#eae8e8',\n    tint60: '#faf9f9'\n};\nexport const mink = {\n    shade50: '#0f0e0e',\n    shade40: '#1c1b1a',\n    shade30: '#343231',\n    shade20: '#474443',\n    shade10: '#54514f',\n    primary: '#5d5a58',\n    tint10: '#706d6b',\n    tint20: '#84817e',\n    tint30: '#9e9b99',\n    tint40: '#cecccb',\n    tint50: '#e5e4e3',\n    tint60: '#f8f8f8'\n};\nexport const silver = {\n    shade50: '#151818',\n    shade40: '#282d2e',\n    shade30: '#4a5356',\n    shade20: '#657174',\n    shade10: '#78868a',\n    primary: '#859599',\n    tint10: '#92a1a5',\n    tint20: '#a0aeb1',\n    tint30: '#b3bfc2',\n    tint40: '#d8dfe0',\n    tint50: '#eaeeef',\n    tint60: '#fafbfb'\n};\nexport const platinum = {\n    shade50: '#111314',\n    shade40: '#1f2426',\n    shade30: '#3b4447',\n    shade20: '#505c60',\n    shade10: '#5f6d71',\n    primary: '#69797e',\n    tint10: '#79898d',\n    tint20: '#89989d',\n    tint30: '#a0adb2',\n    tint40: '#cdd6d8',\n    tint50: '#e4e9ea',\n    tint60: '#f8f9fa'\n};\nexport const anchor = {\n    shade50: '#090a0b',\n    shade40: '#111315',\n    shade30: '#202427',\n    shade20: '#2b3135',\n    shade10: '#333a3f',\n    primary: '#394146',\n    tint10: '#4d565c',\n    tint20: '#626c72',\n    tint30: '#808a90',\n    tint40: '#bcc3c7',\n    tint50: '#dbdfe1',\n    tint60: '#f6f7f8'\n};\nexport const charcoal = {\n    shade50: '#090909',\n    shade40: '#111111',\n    shade30: '#202020',\n    shade20: '#2b2b2b',\n    shade10: '#333333',\n    primary: '#393939',\n    tint10: '#515151',\n    tint20: '#686868',\n    tint30: '#888888',\n    tint40: '#c4c4c4',\n    tint50: '#dfdfdf',\n    tint60: '#f7f7f7'\n};\n", "import { red, green, darkOrange, yellow, berry, lightGreen, marigold, darkRed, cranberry, pumpkin, peach, gold, brass, brown, forest, seafoam, darkGreen, lightTeal, teal, steel, blue, royalBlue, cornflower, navy, lavender, purple, grape, lilac, pink, magenta, plum, beige, mink, platinum, anchor, orange } from \"./colors.js\";\nexport const statusSharedColors = {\n    red,\n    green,\n    darkOrange,\n    yellow,\n    berry,\n    lightGreen,\n    marigold\n};\nexport const personaSharedColors = {\n    darkRed,\n    cranberry,\n    pumpkin,\n    peach,\n    gold,\n    brass,\n    brown,\n    forest,\n    seafoam,\n    darkGreen,\n    lightTeal,\n    teal,\n    steel,\n    blue,\n    royalBlue,\n    cornflower,\n    navy,\n    lavender,\n    purple,\n    grape,\n    lilac,\n    pink,\n    magenta,\n    plum,\n    beige,\n    mink,\n    platinum,\n    anchor\n};\nexport const mappedStatusColors = {\n    cranberry,\n    green,\n    orange\n};\n", "/* Names of colors used in shared color palette alias tokens for status. */ export const statusSharedColorNames = [\n    'red',\n    'green',\n    'darkOrange',\n    'yellow',\n    'berry',\n    'lightGreen',\n    'marigold'\n];\n/* Names of colors used in shared color palette alias tokens for persona. */ export const personaSharedColorNames = [\n    'darkRed',\n    'cranberry',\n    'pumpkin',\n    'peach',\n    'gold',\n    'brass',\n    'brown',\n    'forest',\n    'seafoam',\n    'darkGreen',\n    'lightTeal',\n    'teal',\n    'steel',\n    'blue',\n    'royalBlue',\n    'cornflower',\n    'navy',\n    'lavender',\n    'purple',\n    'grape',\n    'lilac',\n    'pink',\n    'magenta',\n    'plum',\n    'beige',\n    'mink',\n    'platinum',\n    'anchor'\n];\n/* List of global colors which semantic alias status tokens map to */ export const mappedStatusColorNames = [\n    'cranberry',\n    'green',\n    'orange'\n];\n/* Names of colors not used in alias tokens but produced by token pipeline as global color tokens. */ export const unusedSharedColorNames = [\n    'burgundy',\n    'bronze',\n    'orange',\n    'darkBrown',\n    'lime',\n    'darkTeal',\n    'cyan',\n    'lightBlue',\n    'darkBlue',\n    'darkPurple',\n    'orchid',\n    'hotPink',\n    'silver',\n    'charcoal'\n];\n", "export const statusColorMapping = {\n    success: 'green',\n    warning: 'orange',\n    danger: 'cranberry'\n};\n", "import { statusSharedColors, personaSharedColors, mappedStatusColors } from \"../global/colorPalette.js\";\nimport { statusSharedColorNames, personaSharedColorNames } from \"../sharedColorNames.js\";\nimport { statusColorMapping } from \"../statusColorMapping.js\";\nconst statusColorPaletteTokens = statusSharedColorNames.reduce((acc, sharedColor)=>{\n    const color = sharedColor.slice(0, 1).toUpperCase() + sharedColor.slice(1);\n    const sharedColorTokens = {\n        [`colorPalette${color}Background1`]: statusSharedColors[sharedColor].tint60,\n        [`colorPalette${color}Background2`]: statusSharedColors[sharedColor].tint40,\n        [`colorPalette${color}Background3`]: statusSharedColors[sharedColor].primary,\n        [`colorPalette${color}Foreground1`]: statusSharedColors[sharedColor].shade10,\n        [`colorPalette${color}Foreground2`]: statusSharedColors[sharedColor].shade30,\n        [`colorPalette${color}Foreground3`]: statusSharedColors[sharedColor].primary,\n        [`colorPalette${color}BorderActive`]: statusSharedColors[sharedColor].primary,\n        [`colorPalette${color}Border1`]: statusSharedColors[sharedColor].tint40,\n        [`colorPalette${color}Border2`]: statusSharedColors[sharedColor].primary\n    };\n    return Object.assign(acc, sharedColorTokens);\n}, {});\n// one-off patch for yellow\nstatusColorPaletteTokens.colorPaletteYellowForeground1 = statusSharedColors.yellow.shade30;\nstatusColorPaletteTokens.colorPaletteRedForegroundInverted = statusSharedColors.red.tint20;\nstatusColorPaletteTokens.colorPaletteGreenForegroundInverted = statusSharedColors.green.tint20;\nstatusColorPaletteTokens.colorPaletteYellowForegroundInverted = statusSharedColors.yellow.tint40;\nconst personaColorPaletteTokens = personaSharedColorNames.reduce((acc, sharedColor)=>{\n    const color = sharedColor.slice(0, 1).toUpperCase() + sharedColor.slice(1);\n    const sharedColorTokens = {\n        [`colorPalette${color}Background2`]: personaSharedColors[sharedColor].tint40,\n        [`colorPalette${color}Foreground2`]: personaSharedColors[sharedColor].shade30,\n        [`colorPalette${color}BorderActive`]: personaSharedColors[sharedColor].primary\n    };\n    return Object.assign(acc, sharedColorTokens);\n}, {});\nexport const colorPaletteTokens = {\n    ...statusColorPaletteTokens,\n    ...personaColorPaletteTokens\n};\nexport const colorStatusTokens = Object.entries(statusColorMapping).reduce((acc, [statusColor, sharedColor])=>{\n    const color = statusColor.slice(0, 1).toUpperCase() + statusColor.slice(1);\n    // TODO: double check the mapping with design\n    const statusColorTokens = {\n        [`colorStatus${color}Background1`]: mappedStatusColors[sharedColor].tint60,\n        [`colorStatus${color}Background2`]: mappedStatusColors[sharedColor].tint40,\n        [`colorStatus${color}Background3`]: mappedStatusColors[sharedColor].primary,\n        [`colorStatus${color}Foreground1`]: mappedStatusColors[sharedColor].shade10,\n        [`colorStatus${color}Foreground2`]: mappedStatusColors[sharedColor].shade30,\n        [`colorStatus${color}Foreground3`]: mappedStatusColors[sharedColor].primary,\n        [`colorStatus${color}ForegroundInverted`]: mappedStatusColors[sharedColor].tint30,\n        [`colorStatus${color}BorderActive`]: mappedStatusColors[sharedColor].primary,\n        [`colorStatus${color}Border1`]: mappedStatusColors[sharedColor].tint40,\n        [`colorStatus${color}Border2`]: mappedStatusColors[sharedColor].primary\n    };\n    return Object.assign(acc, statusColorTokens);\n}, {});\n// one-off overrides for colorStatus tokens\ncolorStatusTokens.colorStatusDangerBackground3Hover = mappedStatusColors[statusColorMapping.danger].shade10;\ncolorStatusTokens.colorStatusDangerBackground3Pressed = mappedStatusColors[statusColorMapping.danger].shade20;\ncolorStatusTokens.colorStatusWarningForeground1 = mappedStatusColors[statusColorMapping.warning].shade20;\ncolorStatusTokens.colorStatusWarningForeground3 = mappedStatusColors[statusColorMapping.warning].shade20;\ncolorStatusTokens.colorStatusWarningBorder2 = mappedStatusColors[statusColorMapping.warning].shade20;\n", "/* !!! DO NOT EDIT !!! */ /* This file has been generated by the token pipeline */ import { black, blackAlpha, grey, white, whiteAlpha } from \"../global/colors.js\";\nexport const generateColorTokens = (brand)=>({\n        colorNeutralForeground1: grey[14],\n        colorNeutralForeground1Hover: grey[14],\n        colorNeutralForeground1Pressed: grey[14],\n        colorNeutralForeground1Selected: grey[14],\n        colorNeutralForeground2: grey[26],\n        colorNeutralForeground2Hover: grey[14],\n        colorNeutralForeground2Pressed: grey[14],\n        colorNeutralForeground2Selected: grey[14],\n        colorNeutralForeground2BrandHover: brand[80],\n        colorNeutralForeground2BrandPressed: brand[70],\n        colorNeutralForeground2BrandSelected: brand[80],\n        colorNeutralForeground3: grey[38],\n        colorNeutralForeground3Hover: grey[26],\n        colorNeutralForeground3Pressed: grey[26],\n        colorNeutralForeground3Selected: grey[26],\n        colorNeutralForeground3BrandHover: brand[80],\n        colorNeutralForeground3BrandPressed: brand[70],\n        colorNeutralForeground3BrandSelected: brand[80],\n        colorNeutralForeground4: grey[44],\n        colorNeutralForegroundDisabled: grey[74],\n        colorNeutralForegroundInvertedDisabled: whiteAlpha[40],\n        colorBrandForegroundLink: brand[70],\n        colorBrandForegroundLinkHover: brand[60],\n        colorBrandForegroundLinkPressed: brand[40],\n        colorBrandForegroundLinkSelected: brand[70],\n        colorNeutralForeground2Link: grey[26],\n        colorNeutralForeground2LinkHover: grey[14],\n        colorNeutralForeground2LinkPressed: grey[14],\n        colorNeutralForeground2LinkSelected: grey[14],\n        colorCompoundBrandForeground1: brand[80],\n        colorCompoundBrandForeground1Hover: brand[70],\n        colorCompoundBrandForeground1Pressed: brand[60],\n        colorBrandForeground1: brand[80],\n        colorBrandForeground2: brand[70],\n        colorBrandForeground2Hover: brand[60],\n        colorBrandForeground2Pressed: brand[30],\n        colorNeutralForeground1Static: grey[14],\n        colorNeutralForegroundStaticInverted: white,\n        colorNeutralForegroundInverted: white,\n        colorNeutralForegroundInvertedHover: white,\n        colorNeutralForegroundInvertedPressed: white,\n        colorNeutralForegroundInvertedSelected: white,\n        colorNeutralForegroundInverted2: white,\n        colorNeutralForegroundOnBrand: white,\n        colorNeutralForegroundInvertedLink: white,\n        colorNeutralForegroundInvertedLinkHover: white,\n        colorNeutralForegroundInvertedLinkPressed: white,\n        colorNeutralForegroundInvertedLinkSelected: white,\n        colorBrandForegroundInverted: brand[100],\n        colorBrandForegroundInvertedHover: brand[110],\n        colorBrandForegroundInvertedPressed: brand[100],\n        colorBrandForegroundOnLight: brand[80],\n        colorBrandForegroundOnLightHover: brand[70],\n        colorBrandForegroundOnLightPressed: brand[50],\n        colorBrandForegroundOnLightSelected: brand[60],\n        colorNeutralBackground1: white,\n        colorNeutralBackground1Hover: grey[96],\n        colorNeutralBackground1Pressed: grey[88],\n        colorNeutralBackground1Selected: grey[92],\n        colorNeutralBackground2: grey[98],\n        colorNeutralBackground2Hover: grey[94],\n        colorNeutralBackground2Pressed: grey[86],\n        colorNeutralBackground2Selected: grey[90],\n        colorNeutralBackground3: grey[96],\n        colorNeutralBackground3Hover: grey[92],\n        colorNeutralBackground3Pressed: grey[84],\n        colorNeutralBackground3Selected: grey[88],\n        colorNeutralBackground4: grey[94],\n        colorNeutralBackground4Hover: grey[98],\n        colorNeutralBackground4Pressed: grey[96],\n        colorNeutralBackground4Selected: white,\n        colorNeutralBackground5: grey[92],\n        colorNeutralBackground5Hover: grey[96],\n        colorNeutralBackground5Pressed: grey[94],\n        colorNeutralBackground5Selected: grey[98],\n        colorNeutralBackground6: grey[90],\n        colorNeutralBackgroundInverted: grey[16],\n        colorNeutralBackgroundStatic: grey[20],\n        colorNeutralBackgroundAlpha: whiteAlpha[50],\n        colorNeutralBackgroundAlpha2: whiteAlpha[80],\n        colorSubtleBackground: 'transparent',\n        colorSubtleBackgroundHover: grey[96],\n        colorSubtleBackgroundPressed: grey[88],\n        colorSubtleBackgroundSelected: grey[92],\n        colorSubtleBackgroundLightAlphaHover: whiteAlpha[70],\n        colorSubtleBackgroundLightAlphaPressed: whiteAlpha[50],\n        colorSubtleBackgroundLightAlphaSelected: 'transparent',\n        colorSubtleBackgroundInverted: 'transparent',\n        colorSubtleBackgroundInvertedHover: blackAlpha[10],\n        colorSubtleBackgroundInvertedPressed: blackAlpha[30],\n        colorSubtleBackgroundInvertedSelected: blackAlpha[20],\n        colorTransparentBackground: 'transparent',\n        colorTransparentBackgroundHover: 'transparent',\n        colorTransparentBackgroundPressed: 'transparent',\n        colorTransparentBackgroundSelected: 'transparent',\n        colorNeutralBackgroundDisabled: grey[94],\n        colorNeutralBackgroundInvertedDisabled: whiteAlpha[10],\n        colorNeutralStencil1: grey[90],\n        colorNeutralStencil2: grey[98],\n        colorNeutralStencil1Alpha: blackAlpha[10],\n        colorNeutralStencil2Alpha: blackAlpha[5],\n        colorBackgroundOverlay: blackAlpha[40],\n        colorScrollbarOverlay: blackAlpha[50],\n        colorBrandBackground: brand[80],\n        colorBrandBackgroundHover: brand[70],\n        colorBrandBackgroundPressed: brand[40],\n        colorBrandBackgroundSelected: brand[60],\n        colorCompoundBrandBackground: brand[80],\n        colorCompoundBrandBackgroundHover: brand[70],\n        colorCompoundBrandBackgroundPressed: brand[60],\n        colorBrandBackgroundStatic: brand[80],\n        colorBrandBackground2: brand[160],\n        colorBrandBackground2Hover: brand[150],\n        colorBrandBackground2Pressed: brand[130],\n        colorBrandBackground3Static: brand[60],\n        colorBrandBackground4Static: brand[40],\n        colorBrandBackgroundInverted: white,\n        colorBrandBackgroundInvertedHover: brand[160],\n        colorBrandBackgroundInvertedPressed: brand[140],\n        colorBrandBackgroundInvertedSelected: brand[150],\n        colorNeutralCardBackground: grey[98],\n        colorNeutralCardBackgroundHover: white,\n        colorNeutralCardBackgroundPressed: grey[96],\n        colorNeutralCardBackgroundSelected: grey[92],\n        colorNeutralCardBackgroundDisabled: grey[94],\n        colorNeutralStrokeAccessible: grey[38],\n        colorNeutralStrokeAccessibleHover: grey[34],\n        colorNeutralStrokeAccessiblePressed: grey[30],\n        colorNeutralStrokeAccessibleSelected: brand[80],\n        colorNeutralStroke1: grey[82],\n        colorNeutralStroke1Hover: grey[78],\n        colorNeutralStroke1Pressed: grey[70],\n        colorNeutralStroke1Selected: grey[74],\n        colorNeutralStroke2: grey[88],\n        colorNeutralStroke3: grey[94],\n        colorNeutralStrokeSubtle: grey[88],\n        colorNeutralStrokeOnBrand: white,\n        colorNeutralStrokeOnBrand2: white,\n        colorNeutralStrokeOnBrand2Hover: white,\n        colorNeutralStrokeOnBrand2Pressed: white,\n        colorNeutralStrokeOnBrand2Selected: white,\n        colorBrandStroke1: brand[80],\n        colorBrandStroke2: brand[140],\n        colorBrandStroke2Hover: brand[120],\n        colorBrandStroke2Pressed: brand[80],\n        colorBrandStroke2Contrast: brand[140],\n        colorCompoundBrandStroke: brand[80],\n        colorCompoundBrandStrokeHover: brand[70],\n        colorCompoundBrandStrokePressed: brand[60],\n        colorNeutralStrokeDisabled: grey[88],\n        colorNeutralStrokeInvertedDisabled: whiteAlpha[40],\n        colorTransparentStroke: 'transparent',\n        colorTransparentStrokeInteractive: 'transparent',\n        colorTransparentStrokeDisabled: 'transparent',\n        colorNeutralStrokeAlpha: blackAlpha[5],\n        colorNeutralStrokeAlpha2: whiteAlpha[20],\n        colorStrokeFocus1: white,\n        colorStrokeFocus2: black,\n        colorNeutralShadowAmbient: 'rgba(0,0,0,0.12)',\n        colorNeutralShadowKey: 'rgba(0,0,0,0.14)',\n        colorNeutralShadowAmbientLighter: 'rgba(0,0,0,0.06)',\n        colorNeutralShadowKeyLighter: 'rgba(0,0,0,0.07)',\n        colorNeutralShadowAmbientDarker: 'rgba(0,0,0,0.20)',\n        colorNeutralShadowKeyDarker: 'rgba(0,0,0,0.24)',\n        colorBrandShadowAmbient: 'rgba(0,0,0,0.30)',\n        colorBrandShadowKey: 'rgba(0,0,0,0.25)'\n    });\n", "export const borderRadius = {\n    borderRadiusNone: '0',\n    borderRadiusSmall: '2px',\n    borderRadiusMedium: '4px',\n    borderRadiusLarge: '6px',\n    borderRadiusXLarge: '8px',\n    borderRadiusCircular: '10000px'\n};\n", "export const curves = {\n    curveAccelerateMax: 'cubic-bezier(0.9,0.1,1,0.2)',\n    curveAccelerateMid: 'cubic-bezier(1,0,1,1)',\n    curveAccelerateMin: 'cubic-bezier(0.8,0,0.78,1)',\n    curveDecelerateMax: 'cubic-bezier(0.1,0.9,0.2,1)',\n    curveDecelerateMid: 'cubic-bezier(0,0,0,1)',\n    curveDecelerateMin: 'cubic-bezier(0.33,0,0.1,1)',\n    curveEasyEaseMax: 'cubic-bezier(0.8,0,0.2,1)',\n    curveEasyEase: 'cubic-bezier(0.33,0,0.67,1)',\n    curveLinear: 'cubic-bezier(0,0,1,1)'\n};\n", "export const durations = {\n    durationUltraFast: '50ms',\n    durationFaster: '100ms',\n    durationFast: '150ms',\n    durationNormal: '200ms',\n    durationGentle: '250ms',\n    durationSlow: '300ms',\n    durationSlower: '400ms',\n    durationUltraSlow: '500ms'\n};\n", "export const fontSizes = {\n    fontSizeBase100: '10px',\n    fontSizeBase200: '12px',\n    fontSizeBase300: '14px',\n    fontSizeBase400: '16px',\n    fontSizeBase500: '20px',\n    fontSizeBase600: '24px',\n    fontSizeHero700: '28px',\n    fontSizeHero800: '32px',\n    fontSizeHero900: '40px',\n    fontSizeHero1000: '68px'\n};\nexport const lineHeights = {\n    lineHeightBase100: '14px',\n    lineHeightBase200: '16px',\n    lineHeightBase300: '20px',\n    lineHeightBase400: '22px',\n    lineHeightBase500: '28px',\n    lineHeightBase600: '32px',\n    lineHeightHero700: '36px',\n    lineHeightHero800: '40px',\n    lineHeightHero900: '52px',\n    lineHeightHero1000: '92px'\n};\nexport const fontWeights = {\n    fontWeightRegular: 400,\n    fontWeightMedium: 500,\n    fontWeightSemibold: 600,\n    fontWeightBold: 700\n};\nexport const fontFamilies = {\n    fontFamilyBase: \"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif\",\n    fontFamilyMonospace: \"Consolas, 'Courier New', Courier, monospace\",\n    fontFamilyNumeric: \"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif\"\n};\n", "// Intentionally not exported! Use horizontalSpacings and verticalSpacings instead.\nconst spacings = {\n    none: '0',\n    xxs: '2px',\n    xs: '4px',\n    sNudge: '6px',\n    s: '8px',\n    mNudge: '10px',\n    m: '12px',\n    l: '16px',\n    xl: '20px',\n    xxl: '24px',\n    xxxl: '32px'\n};\nexport const horizontalSpacings = {\n    spacingHorizontalNone: spacings.none,\n    spacingHorizontalXXS: spacings.xxs,\n    spacingHorizontalXS: spacings.xs,\n    spacingHorizontalSNudge: spacings.sNudge,\n    spacingHorizontalS: spacings.s,\n    spacingHorizontalMNudge: spacings.mNudge,\n    spacingHorizontalM: spacings.m,\n    spacingHorizontalL: spacings.l,\n    spacingHorizontalXL: spacings.xl,\n    spacingHorizontalXXL: spacings.xxl,\n    spacingHorizontalXXXL: spacings.xxxl\n};\nexport const verticalSpacings = {\n    spacingVerticalNone: spacings.none,\n    spacingVerticalXXS: spacings.xxs,\n    spacingVerticalXS: spacings.xs,\n    spacingVerticalSNudge: spacings.sNudge,\n    spacingVerticalS: spacings.s,\n    spacingVerticalMNudge: spacings.mNudge,\n    spacingVerticalM: spacings.m,\n    spacingVerticalL: spacings.l,\n    spacingVerticalXL: spacings.xl,\n    spacingVerticalXXL: spacings.xxl,\n    spacingVerticalXXXL: spacings.xxxl\n};\n", "export const strokeWidths = {\n    strokeWidthThin: '1px',\n    strokeWidthThick: '2px',\n    strokeWidthThicker: '3px',\n    strokeWidthThickest: '4px'\n};\n", "export function createShadowTokens(ambientColor, keyColor, tokenSuffix = '') {\n    return {\n        [`shadow2${tokenSuffix}`]: `0 0 2px ${ambientColor}, 0 1px 2px ${keyColor}`,\n        [`shadow4${tokenSuffix}`]: `0 0 2px ${ambientColor}, 0 2px 4px ${keyColor}`,\n        [`shadow8${tokenSuffix}`]: `0 0 2px ${ambientColor}, 0 4px 8px ${keyColor}`,\n        [`shadow16${tokenSuffix}`]: `0 0 2px ${ambientColor}, 0 8px 16px ${keyColor}`,\n        [`shadow28${tokenSuffix}`]: `0 0 8px ${ambientColor}, 0 14px 28px ${keyColor}`,\n        [`shadow64${tokenSuffix}`]: `0 0 8px ${ambientColor}, 0 32px 64px ${keyColor}`\n    };\n}\n", "import { colorPaletteTokens, colorStatusTokens } from \"../alias/lightColorPalette.js\";\nimport { generateColorTokens } from \"../alias/lightColor.js\";\nimport { borderRadius, fontSizes, lineHeights, fontFamilies, strokeWidths, fontWeights } from \"../global/index.js\";\nimport { createShadowTokens } from \"./shadows.js\";\nimport { durations } from \"../global/durations.js\";\nimport { curves } from \"../global/curves.js\";\nimport { horizontalSpacings, verticalSpacings } from \"../global/spacings.js\";\nexport const createLightTheme = (brand)=>{\n    const colorTokens = generateColorTokens(brand);\n    return {\n        ...borderRadius,\n        ...fontSizes,\n        ...lineHeights,\n        ...fontFamilies,\n        ...fontWeights,\n        ...strokeWidths,\n        ...horizontalSpacings,\n        ...verticalSpacings,\n        ...durations,\n        ...curves,\n        ...colorTokens,\n        ...colorPaletteTokens,\n        ...colorStatusTokens,\n        ...createShadowTokens(colorTokens.colorNeutralShadowAmbient, colorTokens.colorNeutralShadowKey),\n        ...createShadowTokens(colorTokens.colorBrandShadowAmbient, colorTokens.colorBrandShadowKey, 'Brand')\n    };\n};\n", "export const brandWeb = {\n    10: `#061724`,\n    20: `#082338`,\n    30: `#0a2e4a`,\n    40: `#0c3b5e`,\n    50: `#0e4775`,\n    60: `#0f548c`,\n    70: `#115ea3`,\n    80: `#0f6cbd`,\n    90: `#2886de`,\n    100: `#479ef5`,\n    110: `#62abf5`,\n    120: `#77b7f7`,\n    130: `#96c6fa`,\n    140: `#b4d6fa`,\n    150: `#cfe4fa`,\n    160: `#ebf3fc`\n};\nexport const brandTeams = {\n    10: `#2b2b40`,\n    20: `#2f2f4a`,\n    30: `#333357`,\n    40: `#383966`,\n    50: `#3d3e78`,\n    60: `#444791`,\n    70: `#4f52b2`,\n    80: `#5b5fc7`,\n    90: `#7579eb`,\n    100: `#7f85f5`,\n    110: `#9299f7`,\n    120: `#aab1fa`,\n    130: `#b6bcfa`,\n    140: `#c5cbfa`,\n    150: `#dce0fa`,\n    160: `#e8ebfa`\n};\nexport const brandOffice = {\n    10: `#29130b`,\n    20: `#4d2415`,\n    30: `#792000`,\n    40: `#99482b`,\n    50: `#a52c00`,\n    60: `#c33400`,\n    70: `#e06a3f`,\n    80: `#d83b01`,\n    90: `#dd4f1b`,\n    100: `#fe7948`,\n    110: `#ff865a`,\n    120: `#ff9973`,\n    130: `#e8825d`,\n    140: `#ffb498`,\n    150: `#f4beaa`,\n    160: `#f9dcd1`\n};\n", "import { createLightTheme } from \"../../utils/createLightTheme.js\";\nimport { brandWeb } from \"../../global/brandColors.js\";\nexport const webLightTheme = createLightTheme(brandWeb);\n", "import { useRenderer_unstable } from '@griffel/react';\nimport { useFocusVisible } from '@fluentui/react-tabster';\nimport { ThemeContext_unstable as ThemeContext, useFluent_unstable as useFluent, useOverrides_unstable as useOverrides, CustomStyleHooksContext_unstable as CustomStyleHooksContext } from '@fluentui/react-shared-contexts';\nimport { getIntrinsicElementProps, useMergedRefs, slot } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { useFluentProviderThemeStyleTag } from './useFluentProviderThemeStyleTag';\n// Meomizing empty objects to avoid unnecessary rerenders.\nconst DEFAULT_STYLE_HOOKS = {};\nconst DEFAULT_RENDERER_ATTRIBUTES = {};\n/**\n * Create the state required to render FluentProvider.\n *\n * The returned state can be modified with hooks such as useFluentProviderStyles_unstable,\n * before being passed to renderFluentProvider_unstable.\n *\n * @param props - props from this instance of FluentProvider\n * @param ref - reference to root HTMLElement of FluentProvider\n */ export const useFluentProvider_unstable = (props, ref)=>{\n    'use no memo';\n    const parentContext = useFluent();\n    const parentTheme = useTheme();\n    const parentOverrides = useOverrides();\n    const parentCustomStyleHooks = React.useContext(CustomStyleHooksContext) || DEFAULT_STYLE_HOOKS;\n    /**\n   * TODO: add merge functions to \"dir\" merge,\n   * nesting providers with the same \"dir\" should not add additional attributes to DOM\n   * see https://github.com/microsoft/fluentui/blob/0dc74a19f3aa5a058224c20505016fbdb84db172/packages/fluentui/react-northstar/src/utils/mergeProviderContexts.ts#L89-L93\n   */ const { applyStylesToPortals = true, // eslint-disable-next-line @typescript-eslint/naming-convention\n    customStyleHooks_unstable, dir = parentContext.dir, targetDocument = parentContext.targetDocument, theme, overrides_unstable: overrides = {} } = props;\n    const mergedTheme = shallowMerge(parentTheme, theme);\n    const mergedOverrides = shallowMerge(parentOverrides, overrides);\n    const mergedCustomStyleHooks = shallowMerge(parentCustomStyleHooks, customStyleHooks_unstable);\n    const renderer = useRenderer_unstable();\n    var _renderer_styleElementAttributes;\n    const { styleTagId, rule } = useFluentProviderThemeStyleTag({\n        theme: mergedTheme,\n        targetDocument,\n        rendererAttributes: (_renderer_styleElementAttributes = renderer.styleElementAttributes) !== null && _renderer_styleElementAttributes !== void 0 ? _renderer_styleElementAttributes : DEFAULT_RENDERER_ATTRIBUTES\n    });\n    if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        React.useEffect(()=>{\n            if (mergedTheme === undefined) {\n                // eslint-disable-next-line no-console\n                console.warn([\n                    '@fluentui/react-provider: FluentProvider does not have your \"theme\" defined.',\n                    \"Make sure that your top-level FluentProvider has set a `theme` prop or you're setting the theme in your child FluentProvider.\"\n                ].join(' '));\n            }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        }, []);\n    }\n    return {\n        applyStylesToPortals,\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        customStyleHooks_unstable: mergedCustomStyleHooks,\n        dir,\n        targetDocument,\n        theme: mergedTheme,\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        overrides_unstable: mergedOverrides,\n        themeClassName: styleTagId,\n        components: {\n            root: 'div'\n        },\n        root: slot.always(getIntrinsicElementProps('div', {\n            ...props,\n            dir,\n            // FIXME:\n            // `ref` is wrongly assigned to be `HTMLElement` instead of `HTMLDivElement`\n            // but since it would be a breaking change to fix it, we are casting ref to it's proper type\n            ref: useMergedRefs(ref, useFocusVisible({\n                targetDocument\n            }))\n        }), {\n            elementType: 'div'\n        }),\n        serverStyleProps: {\n            cssRule: rule,\n            attributes: {\n                ...renderer.styleElementAttributes,\n                id: styleTagId\n            }\n        }\n    };\n};\nfunction shallowMerge(a, b) {\n    // Merge impacts perf: we should like to avoid it if it's possible\n    if (a && b) {\n        return {\n            ...a,\n            ...b\n        };\n    }\n    if (a) {\n        return a;\n    }\n    return b;\n}\nfunction useTheme() {\n    return React.useContext(ThemeContext);\n}\n", "import { useId, useIsomorphicLayoutEffect } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { createCSSRuleFromTheme } from './createCSSRuleFromTheme';\nimport { fluentProviderClassNames } from './useFluentProviderStyles.styles';\n// String concatenation is used to prevent bundlers to complain with older versions of React\nconst useInsertionEffect = React['useInsertion' + 'Effect'] ? React['useInsertion' + 'Effect'] : useIsomorphicLayoutEffect;\nconst createStyleTag = (target, elementAttributes)=>{\n    // Document might exist but not be ready yet (e.g. during SSR)\n    // In that case, we should not create a style tag\n    if (!(target === null || target === void 0 ? void 0 : target.head)) {\n        return undefined;\n    }\n    const tag = target.createElement('style');\n    Object.keys(elementAttributes).forEach((attrName)=>{\n        tag.setAttribute(attrName, elementAttributes[attrName]);\n    });\n    target.head.appendChild(tag);\n    return tag;\n};\nconst insertSheet = (tag, rule)=>{\n    const sheet = tag.sheet;\n    if (sheet) {\n        if (sheet.cssRules.length > 0) {\n            sheet.deleteRule(0);\n        }\n        sheet.insertRule(rule, 0);\n    } else if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line no-console\n        console.error('FluentProvider: No sheet available on styleTag, styles will not be inserted into DOM.');\n    }\n};\n/**\n * Writes a theme as css variables in a style tag on the provided targetDocument as a rule applied to a CSS class\n * @internal\n * @returns CSS class to apply the rule\n */ export const useFluentProviderThemeStyleTag = (options)=>{\n    'use no memo';\n    const { targetDocument, theme, rendererAttributes } = options;\n    const styleTag = React.useRef();\n    const styleTagId = useId(fluentProviderClassNames.root);\n    const styleElementAttributes = rendererAttributes;\n    const rule = React.useMemo(()=>createCSSRuleFromTheme(`.${styleTagId}`, theme), [\n        theme,\n        styleTagId\n    ]);\n    if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        React.useMemo(()=>{\n            // Heads up!\n            // .useMemo() is used because it is called during render and DOM for _current_ component is not mounted yet. Also,\n            // this allows to do checks with strict mode enabled as .useEffect() will be called with incremented IDs because\n            // of double render.\n            if (targetDocument) {\n                var _styleElement_textContent;\n                const providerElementSelector = `.${fluentProviderClassNames.root}.${styleTagId}`;\n                const providerElements = targetDocument.querySelectorAll(providerElementSelector);\n                const styleElementSelector = `style[id=\"${styleTagId}\"]`;\n                const styleElements = targetDocument.querySelectorAll(styleElementSelector);\n                if (styleElements.length > 1) {\n                    // eslint-disable-next-line no-console\n                    console.error([\n                        '@fluentui/react-provider: We found multiple <style> elements with same IDs in your DOM.',\n                        'Please make sure that you configured your application properly.',\n                        '\\n',\n                        '\\n',\n                        'Configuration guide: https://aka.ms/fluentui-conflicting-ids'\n                    ].join(' '));\n                    return;\n                }\n                const styleElement = styleElements.item(0);\n                var _styleElement_textContent_length;\n                // Heads up!\n                //\n                // In SSR, we will have DOM upfront & style tags will have CSS rules defined in `.textContent`\n                const isSSR = ((_styleElement_textContent_length = styleElement === null || styleElement === void 0 ? void 0 : (_styleElement_textContent = styleElement.textContent) === null || _styleElement_textContent === void 0 ? void 0 : _styleElement_textContent.length) !== null && _styleElement_textContent_length !== void 0 ? _styleElement_textContent_length : 0) > 0;\n                const elementsCount = isSSR ? 1 : 0;\n                if (providerElements.length > elementsCount) {\n                    // eslint-disable-next-line no-console\n                    console.error([\n                        '@fluentui/react-provider: There are conflicting ids in your DOM.',\n                        'Please make sure that you configured your application properly.',\n                        '\\n',\n                        '\\n',\n                        'Configuration guide: https://aka.ms/fluentui-conflicting-ids'\n                    ].join(' '));\n                }\n            }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        }, []);\n    }\n    useHandleSSRStyleElements(targetDocument, styleTagId);\n    useInsertionEffect(()=>{\n        // The style element could already have been created during SSR - no need to recreate it\n        const ssrStyleElement = targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.getElementById(styleTagId);\n        if (ssrStyleElement) {\n            styleTag.current = ssrStyleElement;\n        } else {\n            styleTag.current = createStyleTag(targetDocument, {\n                ...styleElementAttributes,\n                id: styleTagId\n            });\n            if (styleTag.current) {\n                insertSheet(styleTag.current, rule);\n            }\n        }\n        return ()=>{\n            var _styleTag_current;\n            (_styleTag_current = styleTag.current) === null || _styleTag_current === void 0 ? void 0 : _styleTag_current.remove();\n        };\n    }, [\n        styleTagId,\n        targetDocument,\n        rule,\n        styleElementAttributes\n    ]);\n    return {\n        styleTagId,\n        rule\n    };\n};\nfunction useHandleSSRStyleElements(targetDocument, styleTagId) {\n    // Using a state factory so that this logic only runs once per render\n    // Each FluentProvider can create its own style element during SSR as a slot\n    // Moves all theme style elements to document head during render to avoid hydration errors.\n    // Should be strict mode safe since the logic is idempotent.\n    React.useState(()=>{\n        if (!targetDocument) {\n            return;\n        }\n        const themeStyleElement = targetDocument.getElementById(styleTagId);\n        if (themeStyleElement) {\n            targetDocument.head.append(themeStyleElement);\n        }\n    });\n}\n", "import { __styles, mergeClasses } from '@griffel/core';\nimport { useRenderer_unstable } from '@griffel/react';\nimport { tokens, typographyStyles } from '@fluentui/react-theme';\nexport const fluentProviderClassNames = {\n  root: 'fui-FluentProvider'\n};\nconst useStyles = /*#__PURE__*/__styles({\n  root: {\n    sj55zd: \"f19n0e5\",\n    De3pzq: \"fxugw4r\",\n    fsow6f: [\"f1o700av\", \"fes3tcz\"],\n    Bahqtrf: \"fk6fouc\",\n    Be2twd7: \"fkhj508\",\n    Bhrd7zp: \"figsok6\",\n    Bg96gwp: \"f1i3iumi\"\n  }\n}, {\n  d: [\".f19n0e5{color:var(--colorNeutralForeground1);}\", \".fxugw4r{background-color:var(--colorNeutralBackground1);}\", \".f1o700av{text-align:left;}\", \".fes3tcz{text-align:right;}\", \".fk6fouc{font-family:var(--fontFamilyBase);}\", \".fkhj508{font-size:var(--fontSizeBase300);}\", \".figsok6{font-weight:var(--fontWeightRegular);}\", \".f1i3iumi{line-height:var(--lineHeightBase300);}\"]\n});\n/** Applies style classnames to slots */\nexport const useFluentProviderStyles_unstable = state => {\n  'use no memo';\n\n  const renderer = useRenderer_unstable();\n  const styles = useStyles({\n    dir: state.dir,\n    renderer\n  });\n  state.root.className = mergeClasses(fluentProviderClassNames.root, state.themeClassName, styles.root, state.root.className);\n  return state;\n};", "import * as React from 'react';\nexport function useFluentProviderContextValues_unstable(state) {\n    const { applyStylesToPortals, // eslint-disable-next-line @typescript-eslint/naming-convention\n    customStyleHooks_unstable, dir, root, targetDocument, theme, themeClassName, // eslint-disable-next-line @typescript-eslint/naming-convention\n    overrides_unstable } = state;\n    const provider = React.useMemo(()=>({\n            dir,\n            targetDocument\n        }), [\n        dir,\n        targetDocument\n    ]);\n    // \"Tooltip\" component mutates an object in this context, instance should be stable\n    const [tooltip] = React.useState(()=>({}));\n    const iconDirection = React.useMemo(()=>({\n            textDirection: dir\n        }), [\n        dir\n    ]);\n    return {\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        customStyleHooks_unstable,\n        // eslint-disable-next-line @typescript-eslint/naming-convention\n        overrides_unstable,\n        provider,\n        textDirection: dir,\n        iconDirection,\n        tooltip,\n        theme,\n        themeClassName: applyStylesToPortals ? root.className : themeClassName\n    };\n}\n", "import React, { useState, useEffect, createContext, useContext } from 'react';\r\nimport { OfficeBrowserFeedback } from '@ms-ofb/officebrowserfeedbacknpm/scripts/app/Window/Window';\r\nimport { loadAndInitialize } from '../sdk/officeBrowserFeedbackSetup';\r\nimport {global_variables} from \"../freemarker-variables\";\r\nimport { clearOCVStateStorage, isTestingMode, AppUsageTimeout,OCV_CLEAR_DELAY } from \"../utils/app-constants.js\";\r\n// Create the context with default values\r\nconst FloodgateContext = createContext({\r\n    logActivity: () => console.log(\"Floodgate context not initialized yet\"),\r\n    logActivityStartTime: () => console.log(\"Floodgate context not initialized yet\"),\r\n    logActivityStopTime: () => console.log(\"Floodgate context not initialized yet\"),\r\n    logReadyToPrompt: () => console.log(\"Floodgate context not initialized yet\"), // Add this\r\n    start: async () => console.log(\"Floodgate context not initialized yet\"),\r\n    stop: () => console.log(\"Floodgate context not initialized yet\"),\r\n    loading: true,\r\n    error: null,\r\n    isInitialized: false\r\n});\r\n\r\n/**\r\n * FloodgateProvider initializes the OfficeBrowserFeedback instance once and provides\r\n * simple activity logging functions to all child components through React Context.\r\n * \r\n * This abstracts away the complexity of the officeBrowserFeedback object and provides\r\n * a clean API for components to log Floodgate activities and control the engine.\r\n */\r\nexport const FloodgateProvider = ({ children }) => {\r\n    const [officeBrowserFeedback, setOfficeBrowserFeedback] = useState(undefined);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n    // Start function that wraps the Floodgate SDK start method\r\n    const start = async () => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            try {\r\n                await officeBrowserFeedback.floodgate.start();\r\n                console.log('Floodgate engine started');\r\n            } catch (err) {\r\n                console.error('Failed to start Floodgate engine', err);\r\n            }\r\n        } else {\r\n            console.log('Cannot start Floodgate engine: Floodgate not initialized');\r\n        }\r\n    };\r\n\r\n    // Stop function that wraps the Floodgate SDK stop method\r\n    const stop = () => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            try {\r\n                officeBrowserFeedback.floodgate.stop();\r\n                console.log('Floodgate engine stopped');\r\n            } catch (err) {\r\n                console.error('Failed to stop Floodgate engine', err);\r\n            }\r\n        } else {\r\n            console.log('Cannot stop Floodgate engine: Floodgate not initialized');\r\n        }\r\n    };\r\n\r\n// Initialize Floodgate once when the component mounts\r\nuseEffect(() => {\r\n    const initializeFloodgate = async () => {\r\n\r\n         // Clear OCV state storage in testing mode before initialization\r\n            if (isTestingMode()) {\r\n                clearOCVStateStorage();\r\n            }\r\n\r\n        // Check if global variables are defined before initializing\r\n        if (!global_variables || !global_variables.sso_id) {\r\n            console.log('FloodgateProvider: User not authenticated. Skipping Floodgate initialization.');\r\n            setLoading(false);\r\n            setError(new Error('User not authenticated - Floodgate initialization skipped'));\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Pass user details to loadAndInitialize\r\n            const userDetails = {\r\n                userId: global_variables.user_id,\r\n                ssoId: global_variables.sso_id,\r\n            };\r\n\r\n            console.log('FloodgateProvider: Initializing Floodgate with user details:', userDetails);\r\n            \r\n            const obfObject = await loadAndInitialize(userDetails);\r\n            await obfObject.floodgate.start();\r\n\r\n            setOfficeBrowserFeedback(obfObject);\r\n            console.log('FloodgateProvider: Floodgate SDK initialized successfully');\r\n            \r\n            setIsInitialized(true);\r\n            setLoading(false);\r\n\r\n            window.OfficeBrowserFeedback = obfObject;\r\n\r\n              // Clear OCV state storage again after successful initialization in testing mode\r\n                if (isTestingMode()) {\r\n                    setTimeout(() => {\r\n                        clearOCVStateStorage();\r\n                    }, OCV_CLEAR_DELAY); // Delay to ensure everything is initialized\r\n                }\r\n        } catch (err) {\r\n            const errorMessage = err instanceof Error ? err.message : 'Unknown error initializing Floodgate';\r\n            console.error('FloodgateProvider: Failed to initialize Floodgate SDK', err);\r\n            setError(new Error(`Floodgate initialization failed: ${errorMessage}`));\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    initializeFloodgate();\r\n}, []);\r\n\r\n    // Set up event listeners for window focus/blur to start/stop Floodgate automatically\r\n    useEffect(() => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            const handleFocus = () => {\r\n                start();\r\n            };\r\n            \r\n            const handleBlur = () => {\r\n                stop();\r\n            };\r\n            \r\n            let appUsageTimer = setTimeout(() => {  \r\n                stop();\r\n            }, AppUsageTimeout);\r\n\r\n            const handleVisibilityChange = () => {\r\n            if (document.visibilityState === 'visible') {   \r\n                    start();\r\n                    appUsageTimer = setTimeout(() => stop(), AppUsageTimeout);\r\n                } else {\r\n                    clearTimeout(appUsageTimer);\r\n                    stop();\r\n                }\r\n            };\r\n            \r\n            window.addEventListener('focus', handleFocus);\r\n            window.addEventListener('blur', handleBlur);\r\n            window.addEventListener('visibilitychange', handleVisibilityChange);\r\n            window.addEventListener('visibilitychange', () => {\r\n                if (document.visibilityState === 'visible') {   \r\n                    start();\r\n                    appUsageTimer = setTimeout(() => {  \r\n                        stop();\r\n                    }, AppUsageTimeout);\r\n                } else {\r\n                    clearTimeout(appUsageTimer);\r\n                    stop();\r\n                }\r\n            });\r\n            \r\n            return () => {\r\n                window.removeEventListener('focus', handleFocus);\r\n                window.removeEventListener('blur', handleBlur);\r\n                window.removeEventListener('visibilitychange', handleVisibilityChange);\r\n            };\r\n        }\r\n    }, [isInitialized, officeBrowserFeedback]);\r\n\r\n    // Activity logging functions that check if Floodgate is initialized before calling\r\n    const logActivity = (activity) => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            officeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivity(activity);\r\n        } else {\r\n            console.log(`Floodgate Activity '${activity}' tried to be logged but floodgate did not initialize successfully.`);\r\n        }\r\n    };\r\n\r\n    const logActivityStartTime = (activity) => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            officeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivityStartTime(activity);\r\n        } else {\r\n            console.log(`Floodgate Activity StartTime '${activity}' tried to be logged but floodgate did not initialize successfully.`);\r\n        }\r\n    };\r\n\r\n    const logActivityStopTime = (activity) => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            officeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivityStopTime(activity);\r\n        } else {\r\n            console.log(`Floodgate Activity StopTime '${activity}' tried to be logged but floodgate did not initialize successfully.`);\r\n        }\r\n    };\r\n    // Add this helper function after the other log functions\r\n    const logReadyToPrompt = () => {\r\n        if (isInitialized && officeBrowserFeedback) {\r\n            officeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivity(\"ReadytoPrompt\");\r\n            console.log('ReadytoPrompt activity logged - app is ready for surveys');\r\n        } else {\r\n            console.log(`ReadytoPrompt activity tried to be logged but floodgate did not initialize successfully.`);\r\n        }\r\n    };\r\n\r\n    const contextValue = {\r\n        logActivity,\r\n        logActivityStartTime,\r\n        logActivityStopTime,\r\n        logReadyToPrompt, // Add this new function\r\n        start,\r\n        stop,\r\n        loading,\r\n        error,\r\n        isInitialized\r\n    };\r\n\r\n    return (\r\n        <FloodgateContext.Provider value={contextValue}>\r\n            {children}\r\n        </FloodgateContext.Provider>\r\n    );\r\n};\r\n\r\n/**\r\n * Hook to use Floodgate functionality within any component\r\n * \r\n * Usage:\r\n * const { logActivity, start, stop, loading, isInitialized } = useFloodgate();\r\n * \r\n * // To log a simple activity\r\n * logActivity(\"ButtonClick\");\r\n * \r\n * // To measure time spent on an activity\r\n * // Log when the activity starts.\r\n * logActivityStartTime(\"UserIsUsingFeature\");\r\n * // ... other things happen ...\r\n * // Log stop time when the activity ends. Floodgate records and updates the time spent.\r\n * logActivityStopTime(\"UserIsUsingFeature\");\r\n * \r\n * // To control the Floodgate engine\r\n * await start(); // Start the engine (async)\r\n * stop();        // Stop the engine\r\n */\r\nexport const useFloodgate = () => {\r\n    const context = useContext(FloodgateContext);\r\n\r\n    if (context === undefined) {\r\n        throw new Error('useFloodgate must be used within a FloodgateProvider');\r\n    }\r\n\r\n    return context;\r\n};", "/**\r\n * Window.ts\r\n *\r\n * Module wrapping around the global window object.\r\n * When the pure npm publish is called, this file will become Window.ts and replace the existing one.\r\n */\r\n\r\nimport { TelemetryEvent, TelemetrySink } from \"@microsoft/oteljs\";\r\nimport { IFloodgateSettingIdMap, IFloodgateStorageProvider, ISurveyForm } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { FloodgateEngine } from \"@ms-ofb/officefloodgatecore\";\r\nimport { FeedbackStatus } from \"../Constants\";\r\nimport { ICustomUXHandler } from \"../ICustomUXHandler\";\r\nimport { IOverrideRenderCallback } from \"../IOverrideRenderCallback\";\r\nimport * as Configuration from \"./../Configuration/Configuration\";\r\nimport { ILaunchOptionsInAppFeedback } from \"./../Configuration/ILaunchOptions\";\r\nimport ICustomSurvey from \"./../FloodgateCore/ICustomSurvey\";\r\nimport IUISurvey from \"./../FloodgateCore/UISurvey/IUISurvey\";\r\n\r\n\r\n/**\r\n * Get the IOfficeBrowserFeedback object\r\n */\r\nexport function get(): IOfficeBrowserFeedbackEnv { return w; }\r\n\r\n/**\r\n * Get the IWindow object\r\n */\r\nexport function getGlobal(): IWindow {\r\n\tif (typeof window !== 'undefined') {\r\n\t\t// Required `any` as CoachingUxLauncherFactory is overriding this Interface at a global level.\r\n\t\t// We should stop doing that and refactor the code there.\r\n\t\treturn window as any;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n/**\r\n * Set the sendUserFact() method\r\n * @param sendUserFact the method\r\n */\r\nexport function setSendUserFact(\r\n\tsendUserFact: (telemetryEvent: string) => void) {\r\n\tofficeBrowserFeedback.sendUserFact = sendUserFact;\r\n}\r\n\r\n/**\r\n * Set the processTelemetryEvent() method\r\n * @param processTelemetryEvent the method\r\n */\r\nexport function setProcessTelemetryEvent(\r\n\tprocessTelemetryEvent: (telemetryEvent: TelemetryEvent) => void) {\r\n\tofficeBrowserFeedback.processTelemetryEvent = processTelemetryEvent;\r\n}\r\n\r\n/**\r\n * Set the setUiStrings() method\r\n * @param setUiStrings the method\r\n */\r\nexport function setSetUiStrings(setUiStrings: (data: any) => void) {\r\n\tconst globalWindow = getGlobal() as any;\r\n\tofficeBrowserFeedback.setUiStrings = setUiStrings;\r\n\tglobalWindow.OfficeBrowserFeedback = globalWindow.OfficeBrowserFeedback || {};\r\n\tglobalWindow.OfficeBrowserFeedback.setUiStrings = officeBrowserFeedback.setUiStrings;\r\n}\r\n\r\n/**\r\n * Set the singleFeedback() method\r\n * @param singleFeedback the method\r\n */\r\nexport function setSingleFeedback(\r\n\tsingleFeedback: (feedbackType: string, launchOptions: ILaunchOptionsInAppFeedback) => Promise<any>) {\r\n\tofficeBrowserFeedback.singleFeedback = singleFeedback;\r\n}\r\n\r\n/**\r\n * Set the multiFeedback() method\r\n * @param multiFeedback the method\r\n */\r\nexport function setMultiFeedback(\r\n\tmultiFeedback: (launchOptions: ILaunchOptionsInAppFeedback) => Promise<any>) {\r\n\tofficeBrowserFeedback.multiFeedback = multiFeedback;\r\n}\r\n\r\n/**\r\n * Set the getFeedbackStatus() method\r\n * @param getFeedbackStatus the method\r\n */\r\nexport function setFeedbackStatus(\r\n\tgetFeedbackStatus: () => FeedbackStatus) {\r\n\tofficeBrowserFeedback.getFeedbackStatus = getFeedbackStatus;\r\n}\r\n\r\n/**\r\n * Set the createScreenshot() method\r\n * @param createScreenshot the method\r\n */\r\nexport function setCreateScreenshot(\r\n\tcreateScreenshot: (domElement?: object, options?: any) => Promise<any>) {\r\n\tofficeBrowserFeedback.createScreenshot = createScreenshot;\r\n}\r\n\r\n/**\r\n * Set the isFeedbackSurveyEnabledByAADC() method\r\n * @param isFeedbackSurveyEnabledByAADC the method\r\n */\r\nexport function setIsFeedbackSurveyEnabledByAADC(\r\n\tisFeedbackSurveyEnabledByAADC: () => boolean) {\r\n\tofficeBrowserFeedback.isFeedbackSurveyEnabledByAADC = isFeedbackSurveyEnabledByAADC;\r\n}\r\n\r\n/**\r\n * Set the floodgate customUXHandler interface\r\n * @param floodgateCustomUXHandler the interface\r\n */\r\nexport function setFloodgateCustomUXHandler(floodgateCustomUXHandler: ICustomUXHandler) {\r\n\tfloodgate.customUXHandler = floodgateCustomUXHandler;\r\n}\r\n\r\n/**\r\n * Set the floodgate showSurvey() method\r\n * @param floodgateShowSurvey the method\r\n */\r\nexport function setFloodgateShowSurvey(\r\n\tfloodgateShowSurvey: (survey: IUISurvey, overrideUXRenderCallbackAsync?: IOverrideRenderCallback) => Promise<any>\r\n) {\r\n\tfloodgate.showSurvey = floodgateShowSurvey;\r\n}\r\n\r\n/**\r\n * Set the floodgate showFormSurvey() method\r\n * @param floodgateShowFormSurvey the method\r\n */\r\nexport function setFloodgateShowFormSurvey(\r\n\tfloodgateShowFormSurvey: (survey: ISurveyForm, overrideUXRenderCallbackAsync?: IOverrideRenderCallback) => Promise<any>\r\n) {\r\n\tfloodgate.showFormSurvey = floodgateShowFormSurvey;\r\n}\r\n\r\n/**\r\n * Set the floodgate showCustomSurvey() method\r\n * @param floodgateShowCustomSurvey the method\r\n */\r\nexport function setFloodgateShowCustomSurvey(floodgateShowCustomSurvey: (survey: ICustomSurvey) => Promise<any>) {\r\n\tfloodgate.showCustomSurvey = floodgateShowCustomSurvey;\r\n}\r\n\r\n/**\r\n * Set the floodgate initialize() method\r\n * @param floodgateInitialize the method\r\n */\r\nexport function setFloodgateInitialize(floodgateInitialize: () => Promise<any>) {\r\n\tfloodgate.initialize = floodgateInitialize;\r\n}\r\n\r\n/**\r\n * Set the floodgate start() method\r\n * @param floodgateStart the method\r\n */\r\nexport function setFloodgateStart(floodgateStart: () => Promise<any>) {\r\n\tfloodgate.start = floodgateStart;\r\n}\r\n\r\n/**\r\n * Set the floodgate stop() method\r\n * @param floodgateStop the method\r\n */\r\nexport function setFloodgateStop(floodgateStop: () => void) {\r\n\tfloodgate.stop = floodgateStop;\r\n}\r\n\r\n/**\r\n * Set the floodgate getEngine() method\r\n * @param floodgateGetEngine the method\r\n */\r\nexport function setFloodgateGetEngine(floodgateGetEngine: () => FloodgateEngine) {\r\n\tfloodgate.getEngine = floodgateGetEngine;\r\n}\r\n\r\n/**\r\n * Set the floodgate updateTheme() method\r\n * @param floodgateUpdateTheme the method\r\n */\r\nexport function setFloodgateUpdateTheme(floodgateUpdateTheme: (themeConfig: Configuration.IDynamicUxThemeConfig) => Promise<any>) {\r\n\tfloodgate.updateTheme = floodgateUpdateTheme;\r\n}\r\n\r\n/**\r\n * Set the floodgate updateTelemetrySink() method\r\n */\r\nexport function setUpdateTelemetrySink(updateSink: (sink: TelemetrySink) => void) {\r\n\tofficeBrowserFeedback.updateTelemetrySink = updateSink;\r\n}\r\n\r\n/**\r\n * Set the floodgate getSettingIdMap() method\r\n * @param floodgateSettingIdMap the method\r\n */\r\nexport function getSettingIdMap(floodgateSettingIdMap: () => IFloodgateSettingIdMap) {\r\n\tfloodgate.getSettingIdMap = floodgateSettingIdMap;\r\n}\r\n\r\n/**\r\n * Set the floodgate getStorageProvider() method\r\n */\r\nexport function setStorageProvider(getStorageProvider: () => IFloodgateStorageProvider) {\r\n\tfloodgate.getStorageProvider = getStorageProvider;\r\n}\r\nexport interface IInitOptions extends Configuration.IInitOptionsCommon, Configuration.IInitOptionsInAppFeedback {\r\n}\r\n\r\nexport class Floodgate {\r\n\tpublic initOptions: Configuration.IInitOptionsFloodgate;\r\n\tpublic customUXHandler: ICustomUXHandler;\r\n\tpublic showSurvey: (survey: IUISurvey, overrideUXRenderCallbackAsync?: IOverrideRenderCallback) => Promise<any>;\r\n\tpublic showFormSurvey: (survey: ISurveyForm, overrideUXRenderCallbackAsync?: IOverrideRenderCallback) => Promise<any>;\r\n\tpublic showCustomSurvey: (survey: ICustomSurvey) => Promise<any>;\r\n\tpublic initialize: () => Promise<any>;\r\n\tpublic start: () => Promise<any>;\r\n\tpublic stop: () => void;\r\n\tpublic getEngine: () => FloodgateEngine;\r\n\tpublic updateTheme: (themeConfig: Configuration.IDynamicUxThemeConfig) => Promise<any>;\r\n\tpublic getSettingIdMap: () => IFloodgateSettingIdMap;\r\n\tpublic getStorageProvider: () => IFloodgateStorageProvider;\r\n}\r\n\r\nexport class OfficeBrowserFeedback {\r\n\tpublic initOptions: IInitOptions;\r\n\tpublic multiFeedback: (launchOptions: ILaunchOptionsInAppFeedback) => Promise<any>;\r\n\tpublic processTelemetryEvent: (telemetryEvent: TelemetryEvent) => void;\r\n\tpublic sdkVersion: string;\r\n\tpublic sendUserFact: ((telemetryEvent: string) => void);\r\n\tpublic singleFeedback: (feedbackType: string, launchOptions: ILaunchOptionsInAppFeedback) => Promise<any>;\r\n\tpublic setUiStrings: (data: any) => void;\r\n\tpublic html2canvas: () => ((domElement?: object, options?: any) => Promise<HTMLCanvasElement>);\r\n\tpublic createScreenshot: (domElement?: object, options?: any) => Promise<HTMLCanvasElement>;\r\n\tpublic isFeedbackSurveyEnabledByAADC: () => boolean;\r\n\tpublic floodgate: Floodgate;\r\n\tpublic getFeedbackStatus: () => FeedbackStatus;\r\n\tpublic updateTelemetrySink: (sink: TelemetrySink) => void;\r\n\r\n\tpublic constructor() {\r\n\t\tthis.floodgate = new Floodgate();\r\n\t}\r\n}\r\n\r\nexport class IOfficeBrowserFeedbackEnv {\r\n\tpublic OfficeBrowserFeedback: OfficeBrowserFeedback;\r\n}\r\n\r\n/* eslint-disable-next-line @typescript-eslint/no-empty-interface */\r\nexport interface IWindow extends WindowLocalStorage {\r\n}\r\n\r\nconst officeBrowserFeedback: OfficeBrowserFeedback = new OfficeBrowserFeedback();\r\nconst floodgate: Floodgate = officeBrowserFeedback.floodgate;\r\nconst w = { OfficeBrowserFeedback: officeBrowserFeedback };\r\n", "import { DataField, DataFieldType, DataClassification } from './DataModels';\r\n\r\n/**\r\n * Make a boolean data field.\r\n * @param name - The name of the data field\r\n * @param value - The value of the data field\r\n */\r\nexport function makeBooleanDataField(name: string, value: boolean, classification?: DataClassification): DataField {\r\n  // eslint-disable-next-line id-denylist\r\n  return makeDataField<DataFieldType.Boolean>(name, DataFieldType.Boolean, value, classification);\r\n}\r\n\r\n/**\r\n * Make a data field corresponding to the Aria Int64 data type. Note that\r\n * JavaScript doesn't actually support Int64 precision on large numbers.\r\n * @param name - The name of the data field\r\n * @param value - The value of the data field\r\n */\r\nexport function makeInt64DataField(name: string, value: number, classification?: DataClassification): DataField {\r\n  return makeDataField<DataFieldType.Int64>(name, DataFieldType.Int64, value, classification);\r\n}\r\n\r\n/**\r\n * Make a double data field\r\n * @param name - The name of the data field\r\n * @param value - The value of the data field\r\n */\r\nexport function makeDoubleDataField(name: string, value: number, classification?: DataClassification): DataField {\r\n  return makeDataField<DataFieldType.Double>(name, DataFieldType.Double, value, classification);\r\n}\r\n\r\n/**\r\n * Make a string data field\r\n * @param name - The name of the data field\r\n * @param value - The value of the data field\r\n */\r\nexport function makeStringDataField(name: string, value: string, classification?: DataClassification): DataField {\r\n  // eslint-disable-next-line id-denylist\r\n  return makeDataField<DataFieldType.String>(name, DataFieldType.String, value, classification);\r\n}\r\n\r\n/**\r\n * Make a GUID data field\r\n * !!!WARNING: Only the 1DS Sink has support for Guid types.\r\n * @param name - The name of the data field\r\n * @param value - The value of the data field\r\n */\r\nexport function makeGuidDataField(name: string, value: string, classification?: DataClassification): DataField {\r\n  return makeDataField<DataFieldType.Guid>(name, DataFieldType.Guid, value, classification);\r\n}\r\n\r\nfunction makeDataField<T>(name: string, dataType: T, value: any, classification?: DataClassification) {\r\n  return {\r\n    name,\r\n    dataType,\r\n    value,\r\n    classification: classification ? classification : DataClassification.SystemMetadata\r\n  };\r\n}\r\n", "/* eslint-disable @typescript-eslint/no-namespace */\r\nimport { DataClassification, DataField } from './DataModels';\r\nimport { makeBooleanDataField, makeDoubleDataField, makeGuidDataField, makeInt64DataField, makeStringDataField } from './DataFieldHelper';\r\n\r\n/**\r\n * @internal\r\n * Constructs the full field name by prepending the instance name if provided.\r\n */\r\nexport function getFullFieldName(instanceName: string | undefined, fieldName: string) {\r\n  return instanceName ? instanceName + '.' + fieldName : fieldName;\r\n}\r\n\r\n/**\r\n * Adds a data field from a contract to the data fields array.\r\n * If the data field value is empty, the field is skipped.\r\n * @param instanceName - The name of the contract instance. Empty if no instance.\r\n * @param fieldName - The name of the field to add\r\n * @param value - The value\r\n * @param dataFields - The array of data fields to which a field will be added\r\n */\r\nexport function addStringDataField(\r\n  dataFields: DataField[],\r\n  instanceName: string | undefined,\r\n  fieldName: string,\r\n  value: string | undefined | null,\r\n  dataClassification: DataClassification = DataClassification.SystemMetadata\r\n) {\r\n  if (value) {\r\n    dataFields.push(makeStringDataField(`${getFullFieldName(instanceName, fieldName)}`, value, dataClassification));\r\n  }\r\n}\r\nexport function addBooleanDataField(\r\n  dataFields: DataField[],\r\n  instanceName: string | undefined,\r\n  fieldName: string,\r\n  value: boolean | undefined | null\r\n) {\r\n  if (typeof value === 'boolean') {\r\n    dataFields.push(makeBooleanDataField(`${getFullFieldName(instanceName, fieldName)}`, value));\r\n  }\r\n}\r\nexport function addInt64DataField(\r\n  dataFields: DataField[],\r\n  instanceName: string | undefined,\r\n  fieldName: string,\r\n  value: number | undefined | null\r\n) {\r\n  if (typeof value === 'number') {\r\n    const intValue = Math.round(value);\r\n    dataFields.push(makeInt64DataField(`${getFullFieldName(instanceName, fieldName)}`, intValue));\r\n  }\r\n}\r\nexport function addDoubleDataField(\r\n  dataFields: DataField[],\r\n  instanceName: string | undefined,\r\n  fieldName: string,\r\n  value: number | undefined | null\r\n) {\r\n  if (typeof value === 'number') {\r\n    dataFields.push(makeDoubleDataField(`${getFullFieldName(instanceName, fieldName)}`, value));\r\n  }\r\n}\r\nexport function addGuidDataField(\r\n  dataFields: DataField[],\r\n  instanceName: string | undefined,\r\n  fieldName: string,\r\n  value: string | undefined | null\r\n) {\r\n  if (value) {\r\n    dataFields.push(makeGuidDataField(`${getFullFieldName(instanceName, fieldName)}`, value));\r\n  }\r\n}\r\n\r\nexport namespace Result {\r\n  export interface Contract {\r\n    code: number;\r\n    type?: string;\r\n    tag?: number;\r\n    isExpected?: boolean;\r\n  }\r\n}\r\nexport const Result = {\r\n  /* Gets data fields for the Office.System.Result contract */\r\n  getFields(contract: Result.Contract): DataField[] {\r\n    const instanceName = 'Activity.Result';\r\n    const contractName = 'Office.System.Result';\r\n    let dataFields: DataField[] = [];\r\n    addInt64DataField(dataFields, instanceName, 'Code', contract.code);\r\n    addStringDataField(dataFields, instanceName, 'Type', contract.type);\r\n    addInt64DataField(dataFields, instanceName, 'Tag', contract.tag);\r\n    addBooleanDataField(dataFields, instanceName, 'IsExpected', contract.isExpected);\r\n    dataFields.push(makeStringDataField('zC.Activity.Result', contractName));\r\n    return dataFields;\r\n  }\r\n}; // Result\r\n\r\nexport namespace Activity {\r\n  export interface Contract {\r\n    cV?: string;\r\n    duration: number;\r\n    count: number;\r\n    aggMode: number;\r\n    success?: boolean;\r\n    result?: Result.Contract;\r\n  }\r\n}\r\nexport const Activity = {\r\n  contractName: 'Office.System.Activity',\r\n  /* Gets data fields for the Office.System.Activity contract */\r\n  getFields(contract: Activity.Contract): DataField[] {\r\n    const instanceName = 'Activity';\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'CV', contract.cV);\r\n    addInt64DataField(dataFields, instanceName, 'Duration', contract.duration);\r\n    addInt64DataField(dataFields, instanceName, 'Count', contract.count);\r\n    addInt64DataField(dataFields, instanceName, 'AggMode', contract.aggMode);\r\n    addBooleanDataField(dataFields, instanceName, 'Success', contract.success);\r\n    if (contract.result) {\r\n      dataFields.push(...Result.getFields(contract.result));\r\n    }\r\n    dataFields.push(makeStringDataField('zC.Activity', this.contractName));\r\n    return dataFields;\r\n  }\r\n}; // Activity\r\n\r\nexport const enum PrimaryIdentitySpace {\r\n  UserObjectId = 'UserObjectId',\r\n  /**\r\n   * Uppercase, no dash\r\n   */\r\n  MSACID = 'MSACID',\r\n  /**\r\n   * @deprecated - Use MSAPUID instead\r\n   */\r\n  MsaPuid = 'MsaPuid',\r\n  /**\r\n   * Lowercase\r\n   */\r\n  MSAPUID = 'MSAPUID',\r\n  /**\r\n   * @deprecated - Use OrgIdPUID instead\r\n   */\r\n  OrgIdPuid = 'OrgIdPuid',\r\n  /**\r\n   * Lowercase\r\n   */\r\n  OrgIdPUID = 'OrgIdPUID',\r\n  /**\r\n   * Uppercase, no dash\r\n   */\r\n  OrgIdCID = 'OrgIdCID',\r\n  /**\r\n   * @deprecated - Use Other instead\r\n   */\r\n  WopiAuth = 'WopiAuth',\r\n  /**\r\n   * @deprecated - Use Other instead\r\n   */\r\n  ThirdParty = 'ThirdParty',\r\n  /**\r\n   * @deprecated - Use Other instead\r\n   */\r\n  Anonymous = 'Anonymous',\r\n  Other = 'Other'\r\n}\r\n\r\nexport namespace User {\r\n  /**\r\n   * Office.System.User contract\r\n   * Prefer using StrictContract, which has stronger typing\r\n   */\r\n  export interface Contract {\r\n    primaryIdentityHash?: string;\r\n    primaryIdentitySpace?: string;\r\n    tenantId?: string;\r\n    tenantGroup?: string;\r\n    isAnonymous?: boolean;\r\n    isSignedIn?: boolean;\r\n    /**\r\n     * Set this to 'EDPS' if the user is in EDPS region.\r\n     */\r\n    telemetryRegion?: string;\r\n  }\r\n\r\n  /**\r\n   * isAnonymous was renamed to isSignedIn.\r\n   */\r\n  export type StrictContractKnownUser = StrictContractKnownUserCommercial | StrictContractKnownUserOther;\r\n  export type StrictContractKnownUserCommercial = {\r\n    primaryIdentityHash: string;\r\n    primaryIdentitySpace:\r\n      | PrimaryIdentitySpace.UserObjectId\r\n      | PrimaryIdentitySpace.OrgIdCID\r\n      | PrimaryIdentitySpace.OrgIdPuid\r\n      | PrimaryIdentitySpace.OrgIdPUID;\r\n    tenantId: string;\r\n    tenantGroup?: string;\r\n    isAnonymous?: false;\r\n    isSignedIn?: true;\r\n    /**\r\n     * Set this to 'EDPS' if the user is in EDPS region.\r\n     */\r\n    telemetryRegion?: string;\r\n  };\r\n  export type StrictContractKnownUserOther = {\r\n    primaryIdentityHash: string;\r\n    primaryIdentitySpace:\r\n      | PrimaryIdentitySpace.MSACID\r\n      | PrimaryIdentitySpace.MsaPuid\r\n      | PrimaryIdentitySpace.MSAPUID\r\n      | PrimaryIdentitySpace.WopiAuth\r\n      | PrimaryIdentitySpace.ThirdParty;\r\n    tenantId?: string;\r\n    tenantGroup?: string;\r\n    isAnonymous?: false;\r\n    isSignedIn?: true;\r\n    /**\r\n     * Set this to 'EDPS' if the user is in EDPS region.\r\n     */\r\n    telemetryRegion?: string;\r\n  };\r\n  export type StrictContractAnonymousUser =\r\n    | {\r\n        tenantId?: never;\r\n        tenantGroup?: never;\r\n        isAnonymous: true;\r\n        /**\r\n         * Set this to 'EDPS' if the user is in EDPS region.\r\n         */\r\n        telemetryRegion?: string;\r\n      }\r\n    | {\r\n        primaryIdentityHash?: never;\r\n        primaryIdentitySpace?: never;\r\n        tenantId?: never;\r\n        tenantGroup?: never;\r\n        isSignedIn: false;\r\n        /**\r\n         * Set this to 'EDPS' if the user is in EDPS region.\r\n         */\r\n        telemetryRegion?: string;\r\n      };\r\n  export type StrictContractAnonymousUserWithId =\r\n    | {\r\n        primaryIdentityHash: string;\r\n        primaryIdentitySpace: PrimaryIdentitySpace.Anonymous | PrimaryIdentitySpace.Other;\r\n        tenantId?: never;\r\n        tenantGroup?: never;\r\n        isAnonymous: true;\r\n        /**\r\n         * Set this to 'EDPS' if the user is in EDPS region.\r\n         */\r\n        telemetryRegion?: string;\r\n      }\r\n    | {\r\n        primaryIdentityHash: string;\r\n        primaryIdentitySpace: PrimaryIdentitySpace.Other;\r\n        tenantId?: never;\r\n        tenantGroup?: never;\r\n        isSignedIn: false;\r\n        /**\r\n         * Set this to 'EDPS' if the user is in EDPS region.\r\n         */\r\n        telemetryRegion?: string;\r\n      };\r\n\r\n  /**\r\n   * Office.System.User contract\r\n   * If isSignedIn is true, then PrimaryIdentityHash and PrimaryIdentitySpace must be set\r\n   * If PrimaryIdentitySpace is one of OrgIdPUID, OrgIdCID, or UserObjectId, then TenantId must be a lowercase GUID\r\n   * If isSignedIn is false, then either PrimaryIdentityHash must be unset or\r\n   *   PrimaryIdentityHash must be an anonymously constructed value and PrimaryIdentitySpace must be 'Other'\r\n   */\r\n  export type StrictContract = StrictContractKnownUser | StrictContractAnonymousUser | StrictContractAnonymousUserWithId;\r\n}\r\n\r\nexport const User = {\r\n  /* Gets data fields for the Office.System.User contract */\r\n  getFields(contract: User.Contract): DataField[] {\r\n    const instanceName = 'User';\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'PrimaryIdentityHash', contract.primaryIdentityHash);\r\n    addStringDataField(dataFields, instanceName, 'PrimaryIdentitySpace', contract.primaryIdentitySpace);\r\n    addStringDataField(dataFields, instanceName, 'TenantId', contract.tenantId, DataClassification.EssentialServiceMetadata);\r\n    addStringDataField(dataFields, instanceName, 'TenantGroup', contract.tenantGroup, DataClassification.EssentialServiceMetadata);\r\n    addBooleanDataField(dataFields, instanceName, 'IsAnonymous', contract.isAnonymous);\r\n    addBooleanDataField(dataFields, instanceName, 'IsSignedIn', contract.isSignedIn);\r\n    addStringDataField(dataFields, instanceName, 'TelemetryRegion', contract.telemetryRegion);\r\n    return dataFields;\r\n  }\r\n}; // User\r\n\r\nexport namespace Funnel {\r\n  // 'Office.System.Funnel'\r\n  export interface Contract {\r\n    name?: string;\r\n    state?: string;\r\n  }\r\n}\r\nexport const Funnel = {\r\n  /* Gets data fields for the Office.System.Funnel contract */\r\n  getFields(instanceName: string, contract: Funnel.Contract): DataField[] {\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'Name', contract.name);\r\n    addStringDataField(dataFields, instanceName, 'State', contract.state);\r\n    return dataFields;\r\n  }\r\n}; // Funnel\r\n\r\nexport namespace UserAction {\r\n  // 'Office.System.UserAction'\r\n  export interface Contract {\r\n    id?: number;\r\n    name?: string;\r\n    commandSurface?: string;\r\n    parentName?: string;\r\n    triggerMethod?: string;\r\n    timeOffsetMs?: number;\r\n  }\r\n}\r\nexport const UserAction = {\r\n  /* Gets data fields for the Office.System.UserAction contract */\r\n  getFields(contract: UserAction.Contract): DataField[] {\r\n    const instanceName = 'UserAction';\r\n    let dataFields: DataField[] = [];\r\n    addInt64DataField(dataFields, instanceName, 'Id', contract.id);\r\n    addStringDataField(dataFields, instanceName, 'Name', contract.name);\r\n    addStringDataField(dataFields, instanceName, 'CommandSurface', contract.commandSurface);\r\n    addStringDataField(dataFields, instanceName, 'ParentName', contract.parentName);\r\n    addStringDataField(dataFields, instanceName, 'TriggerMethod', contract.triggerMethod);\r\n    addInt64DataField(dataFields, instanceName, 'TimeOffsetMs', contract.timeOffsetMs);\r\n    return dataFields;\r\n  }\r\n}; // UserAction\r\n\r\nexport enum Platform {\r\n  Web = 'Web',\r\n  Desktop = 'Desktop',\r\n  Universal = 'Universal',\r\n  Mobile = 'Mobile',\r\n  Win32 = 'Win32',\r\n  Mac = 'Mac',\r\n  iOS = 'iOS',\r\n  Android = 'Android'\r\n}\r\n\r\nexport namespace App {\r\n  // 'Office.System.App'\r\n  export interface Contract {\r\n    name?: string;\r\n    platform?: string;\r\n    version?: string;\r\n  }\r\n  export type StrictContract = {\r\n    name: string;\r\n    platform: 'Web' | 'Desktop' | 'Universal' | 'Mobile' | 'Win32' | 'iOS' | 'Android' | Platform | string;\r\n    version: string;\r\n  };\r\n}\r\nexport const App = {\r\n  /* Gets data fields for the Office.System.App contract */\r\n  getFields(contract: App.Contract): DataField[] {\r\n    const instanceName = 'App';\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'Name', contract.name, DataClassification.EssentialServiceMetadata);\r\n    addStringDataField(dataFields, instanceName, 'Platform', contract.platform, DataClassification.EssentialServiceMetadata);\r\n    addStringDataField(dataFields, instanceName, 'Version', contract.version, DataClassification.EssentialServiceMetadata);\r\n    return dataFields;\r\n  }\r\n}; // App\r\n\r\nexport namespace Session {\r\n  // 'Office.System.Session'\r\n  export interface Contract {\r\n    /* Must be a lowercase GUID */\r\n    id: string;\r\n    ecsETag?: string;\r\n  }\r\n}\r\nexport const Session = {\r\n  /* Gets data fields for the Office.System.Session contract */\r\n  getFields(contract: Session.Contract): DataField[] {\r\n    const instanceName = 'Session';\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'Id', contract.id, DataClassification.EssentialServiceMetadata);\r\n    addStringDataField(dataFields, instanceName, 'EcsETag', contract.ecsETag, DataClassification.EssentialServiceMetadata);\r\n    return dataFields;\r\n  }\r\n}; // Session\r\n\r\n// See https://aka.ms/asha/docs for documentation on usage and parameters.\r\n// The HealthQosError 'contract' is a set of fields, but it does not\r\n// have an instance name; thus, fields are sent as Data.Pillar instead of\r\n// Data.HealthQosError.Pillar\r\nexport namespace HealthQosError {\r\n  export interface Contract {\r\n    pillar: QosPillarName;\r\n    veto: string;\r\n    isIntentional: boolean;\r\n    isInternal: boolean;\r\n    alertOnPillar: boolean;\r\n    isSessionEndingError: boolean;\r\n    inStaging?: boolean;\r\n  }\r\n}\r\nexport const enum QosPillarName {\r\n  Interruptions = 'Interruptions',\r\n  Open = 'Open',\r\n  Save = 'Save',\r\n  RealTimeCoauth = 'RealTimeCoauth',\r\n  NotebookNavigation = 'NotebookNavigation',\r\n  Fidelity = 'Fidelity',\r\n  AsyncCollab = 'AsyncCollab',\r\n  Present = 'Present',\r\n  ContentConsumption = 'ContentConsumption',\r\n  ContentCreation = 'ContentCreation'\r\n}\r\nexport const HealthQosError = {\r\n  /**\r\n   * Gets data fields for the Health contract\r\n   * See https://aka.ms/asha/docs for documentation on usage and parameters.\r\n   * Generally, use sendHealthQosError() instead of using this contract directly.\r\n   */\r\n  getFields(contract: HealthQosError.Contract): DataField[] {\r\n    let dataFields: DataField[] = [];\r\n    dataFields.push(makeStringDataField('Pillar', contract.pillar));\r\n    dataFields.push(makeStringDataField('Veto', contract.veto));\r\n    dataFields.push(makeBooleanDataField('IsIntentional', contract.isIntentional));\r\n    dataFields.push(makeBooleanDataField('IsInternal', contract.isInternal));\r\n    dataFields.push(makeBooleanDataField('AlertOnPillar', contract.alertOnPillar));\r\n    dataFields.push(makeBooleanDataField('IsSessionEndingError', contract.isSessionEndingError));\r\n    addBooleanDataField(dataFields, undefined, 'InStaging', contract.inStaging);\r\n    return dataFields;\r\n  }\r\n}; // HealthQosError\r\n\r\nexport enum AudienceGroup {\r\n  Automation = 'Automation',\r\n  Dogfood = 'Dogfood',\r\n  Microsoft = 'Microsoft',\r\n  Insiders = 'Insiders',\r\n  Production = 'Production'\r\n}\r\n\r\nexport namespace Release {\r\n  export interface Contract {\r\n    audienceGroup?: AudienceGroup | string;\r\n  }\r\n  export interface StrictContract {\r\n    audienceGroup: 'Automation' | 'Dogfood' | 'Microsoft' | 'Insiders' | 'Production' | AudienceGroup;\r\n  }\r\n}\r\n\r\nexport const Release = {\r\n  /* Gets data fields for the Office.System.Release contract */\r\n  getFields(contract: Release.Contract): DataField[] {\r\n    const instanceName = 'Release';\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'AudienceGroup', contract.audienceGroup, DataClassification.EssentialServiceMetadata);\r\n    return dataFields;\r\n  }\r\n}; // Release\r\n\r\n// Source of truth is https://office.visualstudio.com/OE/_git/UnifiedEventSchema?version=GBmain&path=/src/Copilot.tml\r\n// Compiled with TML compiler, and manually modified to add enums and zC field\r\nexport namespace Copilot {\r\n  const contractName = 'Office.System.Copilot';\r\n  const instanceName = 'Copilot';\r\n\r\n  export interface Contract {\r\n    featureActionType?: string | FeatureActionType;\r\n    isUserInitiated?: boolean;\r\n    featureName?: string;\r\n    subFeatureName?: string;\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    capability?: string | Capability;\r\n    isThumbsUp?: boolean;\r\n    entryPoint?: string | EntryPoint;\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    verb?: string | Verb;\r\n    /**\r\n     * The ID for the Copilot interaction. Must be a plain lowercase GUID or TraceParent.\r\n     */\r\n    interactionId?: string;\r\n    /**\r\n     * Identifier uniquely identifying a conversation with Copilot. Conversations contain one or more interactions.\r\n     */\r\n    conversationId?: string;\r\n  }\r\n\r\n  export enum FeatureActionType {\r\n    IsEnabled = 'IsEnabled',\r\n    IsSeen = 'IsSeen',\r\n    IsTried = 'IsTried',\r\n    IsKept = 'IsKept',\r\n    IsRejected = 'IsRejected'\r\n  }\r\n\r\n  /**\r\n   * @deprecated - Use FeatureName and SubFeatureName instead\r\n   */\r\n  export enum Capability {\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    ContentGeneration = 'Content Generation',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Commanding = 'Commanding',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    QAandSummaries = 'QA and Summaries',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Collaboration = 'Collaboration',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Suggestions = 'Suggestions'\r\n  }\r\n\r\n  export enum EntryPoint {\r\n    Chat = 'Chat',\r\n    Canvas = 'Canvas',\r\n    SuggestionsPane = 'Suggestions Pane',\r\n    Backstage = 'Backstage'\r\n  }\r\n\r\n  /**\r\n   * @deprecated - Use FeatureName and SubFeatureName instead\r\n   */\r\n  export enum Verb {\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Create = 'Create',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Command = 'Command',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Ask = 'Ask',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Summarize = 'Summarize',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Share = 'Share',\r\n    /**\r\n     * @deprecated - Use FeatureName and SubFeatureName instead\r\n     */\r\n    Analyze = 'Analyze'\r\n  }\r\n\r\n  /* Gets data fields for the Office.System.Copilot contract */\r\n  export function getFields(contract: Contract): DataField[] {\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'FeatureActionType', contract.featureActionType);\r\n    addBooleanDataField(dataFields, instanceName, 'IsUserInitiated', contract.isUserInitiated);\r\n    addStringDataField(dataFields, instanceName, 'FeatureName', contract.featureName);\r\n    addStringDataField(dataFields, instanceName, 'SubFeatureName', contract.subFeatureName);\r\n    addStringDataField(dataFields, instanceName, 'Capability', contract.capability);\r\n    addBooleanDataField(dataFields, instanceName, 'IsThumbsUp', contract.isThumbsUp);\r\n    addStringDataField(dataFields, instanceName, 'EntryPoint', contract.entryPoint);\r\n    addStringDataField(dataFields, instanceName, 'Verb', contract.verb);\r\n    addStringDataField(dataFields, instanceName, 'InteractionId', contract.interactionId);\r\n    addStringDataField(dataFields, instanceName, 'ConversationId', contract.conversationId);\r\n    dataFields.push(makeStringDataField(`zC.${instanceName}`, contractName));\r\n    return dataFields;\r\n  }\r\n} // Copilot\r\n\r\n// Source of truth is https://office.visualstudio.com/DefaultCollection/_git/Office?path=/liblet/telemetryevent/Asha.tml\r\nexport namespace Asha {\r\n  const contractName = 'Office.System.Asha';\r\n  const instanceName = 'Asha';\r\n\r\n  export interface Contract {\r\n    eventType?: string | EventType;\r\n    pillar?: string;\r\n    scenario?: string;\r\n    veto?: string;\r\n    error?: string;\r\n    inStaging?: boolean;\r\n    isSessionEndingError?: boolean;\r\n    isIntentional?: boolean;\r\n    isInternal?: boolean;\r\n  }\r\n\r\n  export enum EventType {\r\n    Pillar = 'Pillar',\r\n    Error = 'Error'\r\n  }\r\n\r\n  /* Gets data fields for the Office.System.Asha contract */\r\n  export function getFields(contract: Contract): DataField[] {\r\n    let dataFields: DataField[] = [];\r\n    addStringDataField(dataFields, instanceName, 'EventType', contract.eventType);\r\n    addStringDataField(dataFields, instanceName, 'Pillar', contract.pillar);\r\n    addStringDataField(dataFields, instanceName, 'Scenario', contract.scenario);\r\n    addStringDataField(dataFields, instanceName, 'Veto', contract.veto);\r\n    addStringDataField(dataFields, instanceName, 'Error', contract.error);\r\n    addBooleanDataField(dataFields, instanceName, 'InStaging', contract.inStaging);\r\n    addBooleanDataField(dataFields, instanceName, 'IsSessionEndingError', contract.isSessionEndingError);\r\n    addBooleanDataField(dataFields, instanceName, 'IsIntentional', contract.isIntentional);\r\n    addBooleanDataField(dataFields, instanceName, 'IsInternal', contract.isInternal);\r\n    dataFields.push(makeStringDataField(`zC.${instanceName}`, contractName));\r\n    return dataFields;\r\n  }\r\n} // Asha\r\n\r\nexport namespace Module {\r\n  export interface Contract {\r\n    name?: string;\r\n    platform?: string;\r\n    version?: string;\r\n    sessionId?: string;\r\n    immediateHost?: string;\r\n    subModuleName?: string;\r\n    context?: string;\r\n    referrer?: string;\r\n  }\r\n\r\n  /* Gets data fields for the Office.System.Module contract */\r\n  export function getFields(instanceName: string, contract: Contract): DataField[] {\r\n    let dataFields: DataField[] = [];\r\n    if (contract.name !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.Name`, contract.name));\r\n    }\r\n    if (contract.platform !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.Platform`, contract.platform));\r\n    }\r\n    if (contract.version !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.Version`, contract.version));\r\n    }\r\n    if (contract.sessionId !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.SessionId`, contract.sessionId));\r\n    }\r\n    if (contract.immediateHost !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.ImmediateHost`, contract.immediateHost));\r\n    }\r\n    if (contract.subModuleName !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.SubModuleName`, contract.subModuleName));\r\n    }\r\n    if (contract.context !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.Context`, contract.context));\r\n    }\r\n    if (contract.referrer !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.Referrer`, contract.referrer));\r\n    }\r\n    return dataFields;\r\n  }\r\n} // Module\r\n\r\nexport namespace ContentIdentifier {\r\n  const contractName = 'Office.System.ContentIdentifier';\r\n  const instanceName = 'ContentIdentifier';\r\n\r\n  export interface Contract {\r\n    contentType: string;\r\n    contentId: string;\r\n    subContentType?: string;\r\n    subContentId?: string;\r\n  }\r\n\r\n  /* Gets data fields for the Office.System.ContentIdentifier contract */\r\n  export function getFields(contract: Contract): DataField[] {\r\n    let dataFields: DataField[] = [];\r\n    dataFields.push(makeStringDataField(`${instanceName}.ContentType`, contract.contentType));\r\n    dataFields.push(makeStringDataField(`${instanceName}.ContentId`, contract.contentId));\r\n    if (contract.subContentType !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.SubContentType`, contract.subContentType));\r\n    }\r\n    if (contract.subContentId !== undefined) {\r\n      dataFields.push(makeStringDataField(`${instanceName}.SubContentId`, contract.subContentId));\r\n    }\r\n    dataFields.push(makeStringDataField(`zC.${instanceName}`, contractName));\r\n    return dataFields;\r\n  }\r\n} // ContentIdentifier\r\n", "/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n", "import { LogLevel, Category } from './DataModels';\r\n\r\nfunction getNotificationHandler() {\r\n  const _listeners: Array<(args: INotification) => void> = [];\r\n  return {\r\n    /**\r\n     * Fires an event to its listeners\r\n     * @param args - The parameters of the event\r\n     */\r\n    fireEvent(args: INotification): void {\r\n      _listeners.forEach(listener => listener(args));\r\n    },\r\n\r\n    /**\r\n     * Add an event listener\r\n     * @param listener - The listener that can process events\r\n     */\r\n    addListener(listener: (args: INotification) => void): void {\r\n      if (listener) {\r\n        _listeners.push(listener);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nlet notificationHandler = getNotificationHandler();\r\n\r\n// This interface hides fireEvent from callers in TypeScript\r\nexport interface INotificationHandler {\r\n  addListener(listener: (args: INotification) => void): void;\r\n}\r\n\r\nexport interface INotification {\r\n  level: LogLevel;\r\n  category: Category;\r\n  message: () => string;\r\n}\r\n\r\n/**\r\n * Returns a list of notification event listeners. You can add an event listener:\r\n *    onNotification().addListener(event =\\> \\{\r\n *      console.log(event!.message + ' ' + event!.level); \\});\r\n *\r\n * DO NOT trigger telemetry events on these notifications, as doing so may\r\n * create an infinite loop of telemetry events.\r\n */\r\nexport function onNotification(): INotificationHandler {\r\n  return notificationHandler;\r\n}\r\n\r\n/**\r\n * Internal function: log a notification\r\n * @param level - The level of notification to log\r\n * @param category - The category of the notification\r\n * @param message - A function that returns a message to log\r\n */\r\nexport function logNotification(level: LogLevel, category: Category, message: () => string) {\r\n  notificationHandler.fireEvent({ level, category, message });\r\n}\r\n\r\n/**\r\n * Internal function: log an error\r\n * @param category - The category of the notification\r\n * @param message - A message that will precede the message from error object\r\n * @param error - An error object, from which an error message might be obtained\r\n */\r\nexport function logError(category: Category, message: string, error: any) {\r\n  logNotification(LogLevel.Error, category, () => {\r\n    let errorMessage = error instanceof Error ? error.message : '';\r\n    return `${message}: ${errorMessage}`;\r\n  });\r\n}\r\n", "import { logNotification } from './OTelNotifications';\r\nimport { TelemetryProperties, LogLevel, Category } from './DataModels';\r\n\r\nconst NAMESPACE_SEPARATOR = '.';\r\n\r\nlet tenantTokens: { [namespace: string]: TelemetryProperties } = {};\r\n\r\nexport function setTenantTokens(namespace: string, telemetryProperties: TelemetryProperties) {\r\n  if (\r\n    // Starts with \"Office.\" and doesn't end with \".\"\r\n    namespace.substring(0, 7) === 'Office' + NAMESPACE_SEPARATOR &&\r\n    namespace[namespace.length - 1] !== NAMESPACE_SEPARATOR\r\n  ) {\r\n    if (tenantTokens[namespace]) {\r\n      if (telemetryProperties.ariaTenantToken) {\r\n        tenantTokens[namespace].ariaTenantToken = telemetryProperties.ariaTenantToken;\r\n      }\r\n      if (telemetryProperties.dnmToken) {\r\n        tenantTokens[namespace].dnmToken = telemetryProperties.dnmToken;\r\n      }\r\n    } else {\r\n      tenantTokens[namespace] = telemetryProperties;\r\n    }\r\n  } else {\r\n    logNotification(LogLevel.Error, Category.Core, () => {\r\n      return `Namespace: ${namespace}`;\r\n    });\r\n    return;\r\n  }\r\n}\r\n\r\n/**\r\n * Gets the tenant tokens corresponding to an event\r\n * Strategy: Search for the whole string, then substrings that could be the namespace\r\n * @param eventName - The event name\r\n * @returns - The corresponding tenant tokens, or undefined if none found\r\n */\r\nexport function fillTenantTokens(eventName: string, telemetryProperties: TelemetryProperties): boolean {\r\n  let indexOfCharacterAfterNamespace = eventName.length;\r\n  while (indexOfCharacterAfterNamespace > 0) {\r\n    const namespaceCandidate = eventName.substr(0, indexOfCharacterAfterNamespace);\r\n    if (tenantTokens[namespaceCandidate]) {\r\n      const storedTelemetryProperties = tenantTokens[namespaceCandidate];\r\n\r\n      telemetryProperties.ariaTenantToken = storedTelemetryProperties.ariaTenantToken;\r\n      telemetryProperties.dnmToken = storedTelemetryProperties.dnmToken;\r\n      return true;\r\n    }\r\n    indexOfCharacterAfterNamespace = eventName.lastIndexOf(NAMESPACE_SEPARATOR, indexOfCharacterAfterNamespace - 1);\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function clear() {\r\n  tenantTokens = {};\r\n}\r\n", "import { TelemetryEvent, DataField, DataFieldType } from './DataModels';\r\n\r\nconst INT64_MAX = 9007199254740991;\r\nconst INT64_MIN = -INT64_MAX;\r\n\r\nexport const MaxEventNameLength = 98; // Client Code = 100 limit; Aria Compact SDK = 98 limit.\r\n\r\n// **Validation**\r\n// Ref: https://www.owiki.ms/wiki/Telemetry/Instrumentation/Event_Names/EventAndDataValidations\r\n// C#:  https://office.visualstudio.com/OE/_git/OTEL-OTelCS?path=/UTelCS/Sources/TelemetryService/Utilities/ErrorHandling.cs&version=GBmain&_a=contents&line=28&lineStyle=plain&lineEnd=72&lineStartColumn=1&lineEndColumn=10\r\n// C++: https://office.visualstudio.com/Office/_git/Office?path=/liblet/telemetryevent/public/NodeNameValidation.h&version=GBmain&_a=contents&line=11&lineStyle=plain&lineEnd=29&lineStartColumn=1&lineEndColumn=2\r\n\r\n// **EventName Validation**\r\n// Starts with \"Office\", and then at least two more alphanumeric tokens that start with capital letters\r\n// Tokens are separated by periods.\r\n// This regex has been manually reviewed for catastrophic backtracking.\r\n// Client Code = 100 limit; Aria Compact SDK = 98 limit.\r\n// eslint-disable-next-line security/detect-unsafe-regex\r\nexport const EventNameRegex: RegExp = /^Office(\\.[A-Z][a-zA-Z0-9]*){2,}$/;\r\n\r\n// **DataField Validation**\r\n// Contains alphanumeric or _ or .\r\n// Must be between 1 and 95 characters long (5 characters reserved for 'Data.')\r\nexport const DataFieldRegex = /^[a-zA-Z0-9_\\.]{1,95}$/;\r\n\r\nexport function validateTelemetryEvent(telemetryEvent: TelemetryEvent) {\r\n  if (!isEventNameValid(telemetryEvent.eventName)) {\r\n    raiseNameValidationError('eventName', telemetryEvent.eventName, EventNameRegex, MaxEventNameLength);\r\n  }\r\n\r\n  const eventContract = telemetryEvent.eventContract;\r\n  if (eventContract) {\r\n    if (eventContract.name && !isNameValid(eventContract.name)) {\r\n      raiseNameValidationError('eventContract', eventContract.name, DataFieldRegex);\r\n    }\r\n    validateDataFields(eventContract.dataFields);\r\n  }\r\n\r\n  validateDataFields(telemetryEvent.dataFields);\r\n}\r\n\r\nfunction isEventNameValid(eventName: string | undefined): boolean {\r\n  if (!eventName || eventName.length > MaxEventNameLength) {\r\n    return false;\r\n  }\r\n\r\n  return EventNameRegex.test(eventName);\r\n}\r\n\r\nfunction isNameValid(name: string): boolean {\r\n  return DataFieldRegex.test(name);\r\n}\r\n\r\nfunction validateDataFields(dataFields: DataField[] | undefined): void {\r\n  if (!dataFields) {\r\n    return;\r\n  }\r\n  dataFields.forEach(dataField => {\r\n    if (typeof dataField.name !== 'string' || !isNameValid(dataField.name)) {\r\n      raiseNameValidationError('dataField name', dataField.name, DataFieldRegex);\r\n    }\r\n\r\n    if (dataField.dataType === DataFieldType.Int64) {\r\n      validateInt(dataField.value);\r\n    }\r\n  });\r\n}\r\n\r\nfunction validateInt(value: any): void {\r\n  if (typeof value !== 'number' || !isFinite(value) || Math.floor(value) !== value || value < INT64_MIN || value > INT64_MAX) {\r\n    throw new Error(`Invalid integer ${JSON.stringify(value)}`);\r\n  }\r\n}\r\n\r\nfunction raiseNameValidationError(type: string, name: string, regex: RegExp, maxLength?: number): never {\r\n  throw new Error(`Invalid ${type} '${name}' as it does not match regex ${regex}` + (maxLength ? ` or exceeds ${maxLength} chars` : ''));\r\n}\r\n", "export const oteljsVersion = '4.23.1139';\r\n", "import { fillTenantTokens, setTenantTokens } from './TenantTokenManager';\r\nimport {\r\n  DataField,\r\n  TelemetryEvent,\r\n  TelemetrySink,\r\n  CustomerContentEvent,\r\n  LogLevel,\r\n  Category,\r\n  FilledTelemetryEvent,\r\n  DirectNumericEvent,\r\n  EventType\r\n} from './DataModels';\r\nimport { validateTelemetryEvent } from './TelemetryEventValidator';\r\nimport { logNotification, logError } from './OTelNotifications';\r\nimport { oteljsVersion } from './Version';\r\nimport { makeStringDataField, makeInt64DataField } from './DataFieldHelper';\r\n\r\nconst CUSTOMER_CONTENT_VERSION = 2;\r\nconst MAX_EVENT_QUEUE_LENGTH = 1000;\r\n\r\n/**\r\n * Sets the content type for an event.\r\n *\r\n * No default value for ContentType.\r\n *\r\n * If the type is DiagnosticData then event is treated as a standard telemetry event where as\r\n * in case of the AnonymousData the telemetry event is treated as Direct Measures (Anonymous) events.\r\n * In both the above cases these telemetry data is available in Aria/Kusto/Cosmos.\r\n * The type CustomerContent is used to collect data using the Compliant Customer Content in Office(CCCO) pipeline.\r\n * These events will not be available in Aria/Kusto/Cosmos and would only be available in compliant boundaries such as Substrate.\r\n *\r\n * From: https://office.visualstudio.com/Office/_git/Office?path=/liblet/telemetryevent/public/ContentType.h&_a=contents&version=GBmain\r\n */\r\nconst enum ContentType {\r\n  TelemetryData = 0,\r\n  AnonymousData = 1, // Direct Numeric Measures\r\n  CustomerContent = 2\r\n}\r\n\r\n/**\r\n * Use this as the Nexus tenant token when Nexus logging is not needed or relevant\r\n */\r\nexport const SuppressNexus = -1;\r\n\r\n/**\r\n * Clone a telemetry event; generally so we don't modify the input telemetry event\r\n * Also initializes telemetryProperties and dataFields if they aren't already set\r\n * @param telemetryEvent - The event to clone\r\n */\r\nexport function cloneEvent(telemetryEvent: TelemetryEvent): FilledTelemetryEvent {\r\n  let localEvent: FilledTelemetryEvent = {\r\n    eventName: telemetryEvent.eventName,\r\n    eventFlags: telemetryEvent.eventFlags || {},\r\n    telemetryProperties: !!telemetryEvent.telemetryProperties ? { ...telemetryEvent.telemetryProperties } : {},\r\n    dataFields: !!telemetryEvent.dataFields ? telemetryEvent.dataFields.slice() : [],\r\n    timestamp: telemetryEvent.timestamp || new Date().getTime()\r\n  };\r\n\r\n  if (!!telemetryEvent.eventContract) {\r\n    localEvent.eventContract = { name: telemetryEvent.eventContract.name, dataFields: telemetryEvent.eventContract.dataFields.slice() };\r\n  }\r\n  return localEvent;\r\n}\r\n\r\nexport interface ISimpleTelemetryLogger extends TelemetrySink {\r\n  /**\r\n   * A list of sinks that telemetry events will be forwarded to\r\n   */\r\n  telemetrySinks: TelemetrySink[];\r\n\r\n  /**\r\n   * persistentDataFields: Data fields that will automatically be sent with every event.\r\n   * 'Data.' will be prepended to each field.\r\n   */\r\n  persistentDataFields: DataField[];\r\n\r\n  /**\r\n   * A list of Part A data fields that should be added to every event. In the 1DS Sink,\r\n   * part A data fields will be sent without 'Data.'. On native clients, these fields\r\n   * will still get sent as 'Data.Foo'.\r\n   */\r\n  partAFields: DataField[];\r\n\r\n  /**\r\n   * Send a telemetry event\r\n   * @param telemetryEvent - The event to send\r\n   */\r\n  sendTelemetryEvent(telemetryEvent: TelemetryEvent): void;\r\n\r\n  /**\r\n   * Sends an event containing customer content, to a compliant endpoint\r\n   * @param customerContentEvent - The event to send\r\n   */\r\n  sendCustomerContent(customerContentEvent: CustomerContentEvent): void;\r\n\r\n  /**\r\n   * Sends a direct numeric measures telemetry event.\r\n   * @param directNumericEvent - The event to send\r\n   */\r\n  sendDirectNumericEvent(directNumericEvent: DirectNumericEvent): void;\r\n\r\n  /**\r\n   * Add a sink for processing telemetry events\r\n   * @param sink - A telemetry sink to which events will be passed when sendTelemetryEvent is called.\r\n   */\r\n  addSink(sink: TelemetrySink): void;\r\n\r\n  /**\r\n   * Set tokens to use for sending telemetry to Aria and/or Nexus\r\n   * The tokens will be used for events which the namespace has an exact or partial match\r\n   * @param namespace - The namespace for the tokens\r\n   * @param ariaTenantToken - Optional: The Aria tenant token\r\n   * @param nexusTenantToken - Optional: The Nexus tenant token\r\n   */\r\n  setTenantToken(namespace: string, ariaTenantToken?: string, nexusTenantToken?: number): void;\r\n\r\n  /**\r\n   * Set tokens to use for sending telemetry to Aria via the DNM pipeline\r\n   * The tokens will be used for events which the namespace has an exact or partial match\r\n   * @param namespace - The namespace for the tokens\r\n   * @param dnmTenantToken - The Aria dnm tenant token\r\n   */\r\n  setDNMToken(namespace: string, dnmTenantToken: string): void;\r\n\r\n  /**\r\n   * Get the currently applied telemetry configuration\r\n   */\r\n  getConfig(): ITelemetryConfig;\r\n\r\n  /**\r\n   * Flush the queue, after adding a sink\r\n   */\r\n  flushQueue(): void;\r\n}\r\n\r\n/**\r\n * A configuration object for telemetry sinks\r\n */\r\nexport interface ITelemetryConfig {\r\n  /**\r\n   * NOT FOR USE IN BYPASSING VALIDATION RULES; ONLY FOR USE IN IMPROVING PERFORMANCE\r\n   *\r\n   * Disables basic validation that telemetry events conform to Office Event Schema\r\n   * Validation adds a small overhead that could adversely affect perf in production.\r\n   * In pre-production, validation should be turned on to ensure that events are valid.\r\n   * To improve perf, validation can be turned off in production. This flag MUST NOT\r\n   * be used to bypass rules that would otherwise prevent events from being sent.\r\n   */\r\n  disableValidation?: boolean;\r\n\r\n  /**\r\n   * Enables queueing events when no telemetry sink is attached.\r\n   */\r\n  enableQueue?: boolean;\r\n}\r\n\r\n/**\r\n * SimpleTelemetryLogger is the base implementation of a telemetry logger.\r\n * It exposes sendTelemetryEvent, which is used to log a telemetry event.\r\n *\r\n * Add a sink by calling addSink() or modifying the telemetrySinks list.\r\n * If no sinks are attached, it keeps a queue of events, but starts silently\r\n */\r\nexport class SimpleTelemetryLogger implements ISimpleTelemetryLogger {\r\n  /**\r\n   * A list of sinks that telemetry events will be forwarded to\r\n   */\r\n  telemetrySinks: TelemetrySink[] = [];\r\n\r\n  /**\r\n   * 'Data.' will be prepended to each field.\r\n   */\r\n  persistentDataFields: DataField[] = [];\r\n\r\n  /**\r\n   * A list of Part A data fields that should be added to every event. In the 1DS Sink,\r\n   * part A data fields will be sent without 'Data.'. On native clients, these fields\r\n   * will still get added as 'Data.Foo'.\r\n   */\r\n  partAFields: DataField[] = [];\r\n\r\n  private config: ITelemetryConfig;\r\n\r\n  private eventQueue: [FilledTelemetryEvent, EventType][] = [];\r\n\r\n  private static instanceCounter: number = 0;\r\n  public readonly instanceId: number;\r\n\r\n  /**\r\n   * Creates a telemetry logger\r\n   * @param parent - A parent telemetry logger that this telemetry logger should inherit from\r\n   *                 This telemetry logger will send telemetry to the same sinks\r\n   *                 and will send the same persistent data fields as the parent logger\r\n   * @param persistentDataFields - Data fields to send with every event\r\n   */\r\n  constructor(parent?: ISimpleTelemetryLogger, persistentDataFields?: DataField[], config?: ITelemetryConfig) {\r\n    this.config = config || {};\r\n    this.instanceId = ++SimpleTelemetryLogger.instanceCounter;\r\n\r\n    if (parent) {\r\n      this.telemetrySinks = parent.telemetrySinks;\r\n      this.persistentDataFields.push(...parent.persistentDataFields);\r\n      this.config = { ...parent.getConfig(), ...this.config };\r\n      this.partAFields.push(...parent.partAFields);\r\n    }\r\n    if (persistentDataFields) {\r\n      this.persistentDataFields.push(...persistentDataFields);\r\n    }\r\n  }\r\n\r\n  private addEventContentType(dataFields: DataField[], eventContentType: ContentType) {\r\n    dataFields.push(makeInt64DataField('EventContent.Type', eventContentType));\r\n  }\r\n\r\n  /**\r\n   * SendTelemetryEvent is the basic way to send a telemetry event.\r\n   * This should be used for sending telemetry about discrete events that happened\r\n   * For telemetry that includes duration and/or success/failure, the Activity API may be more appropriate.\r\n   * @param telemetryEvent - The telemetry event to send\r\n   */\r\n  public sendTelemetryEvent(telemetryEvent: TelemetryEvent) {\r\n    const clonedEvent = cloneEvent(telemetryEvent);\r\n\r\n    const telemetryProperties = clonedEvent.telemetryProperties;\r\n    // Nexus is no longer supported by OTelJS\r\n    telemetryProperties.nexusTenantToken = SuppressNexus;\r\n\r\n    // If either one is missing, we try to fill both\r\n    const ariaTenantToken = telemetryProperties.ariaTenantToken;\r\n    if (!ariaTenantToken) {\r\n      let success = fillTenantTokens(clonedEvent.eventName, telemetryProperties);\r\n\r\n      if (!success && !ariaTenantToken) {\r\n        logNotification(LogLevel.Error, Category.Core, () => 'No tenant token: ' + telemetryEvent.eventName);\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.sendTelemetryEventInternal(clonedEvent, EventType.SendTelemetryEvent);\r\n  }\r\n\r\n  /**\r\n   * Sends a non-standard telemetry event like CustomerContentEvent or DirectNumericEvent\r\n   * Note: This method should not be called directly. It is meant for when the SimpleTelemetryLogger is used as a passthrough.\r\n   * @param telemetryEvent - The telemetry event to send\r\n   * @param eventType - The type of event like CustomerContentEvent or DirectNumericEvent\r\n   */\r\n  public sendNonStandardEvent(telemetryEvent: TelemetryEvent, eventType: EventType) {\r\n    const clonedEvent = cloneEvent(telemetryEvent);\r\n    this.sendTelemetryEventInternal(clonedEvent, eventType);\r\n  }\r\n\r\n  /**\r\n   * Sends customer content to an appropriate compliant endpoint\r\n   * @param event - The event to send\r\n   * @param customerContentType - The type of customer content\r\n   */\r\n  public sendCustomerContent(customerContentEvent: CustomerContentEvent) {\r\n    const clonedEvent = cloneEvent(customerContentEvent);\r\n    const telemetryProperties = clonedEvent.telemetryProperties;\r\n\r\n    const customerContentVersion = telemetryProperties.customerContentVersion;\r\n    if (!customerContentVersion || customerContentVersion > CUSTOMER_CONTENT_VERSION) {\r\n      telemetryProperties.customerContentVersion = CUSTOMER_CONTENT_VERSION;\r\n    }\r\n    // Suppress any tenant tokens that were passed in; the event must go to the customer content tenant.\r\n    telemetryProperties.ariaTenantToken = undefined;\r\n    telemetryProperties.nexusTenantToken = undefined;\r\n    telemetryProperties.dnmToken = undefined;\r\n\r\n    this.addEventContentType(clonedEvent.dataFields, ContentType.CustomerContent);\r\n\r\n    return this.sendTelemetryEventInternal(clonedEvent, EventType.CustomerContent);\r\n  }\r\n\r\n  /**\r\n   * Send a direct numerical measurement to the a DNM tenant\r\n   * @param directNumericEvent - the event to send\r\n   */\r\n  public sendDirectNumericEvent(directNumericEvent: DirectNumericEvent) {\r\n    const clonedEvent = cloneEvent(directNumericEvent);\r\n\r\n    const telemetryProperties = clonedEvent.telemetryProperties;\r\n\r\n    if (!telemetryProperties.dnmToken) {\r\n      let success = fillTenantTokens(clonedEvent.eventName, telemetryProperties);\r\n\r\n      if (!success && !telemetryProperties.dnmToken) {\r\n        logNotification(LogLevel.Error, Category.Core, () => 'No dnm token: ' + clonedEvent.eventName);\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.addEventContentType(clonedEvent.dataFields, ContentType.AnonymousData);\r\n\r\n    this.sendTelemetryEventInternal(clonedEvent, EventType.DirectNumericEvent);\r\n  }\r\n\r\n  /**\r\n   * Internal method to send a telemetry event\r\n   * @param event - The telemetry event to send.\r\n   * Note that it may be a CustomerContentEvent by virtue of having a customerContentVersion and customerContentType.\r\n   */\r\n  protected sendTelemetryEventInternal(telemetryEvent: FilledTelemetryEvent, eventType: EventType) {\r\n    if (\r\n      eventType !== EventType.CustomerContent &&\r\n      (telemetryEvent.telemetryProperties.customerContentVersion || telemetryEvent.telemetryProperties.customerContentType)\r\n    ) {\r\n      logNotification(LogLevel.Error, Category.Core, () => 'Customer content');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (this.telemetrySinks.length === 0) {\r\n        if (this.config.enableQueue && this.eventQueue.length < MAX_EVENT_QUEUE_LENGTH) {\r\n          this.eventQueue.push([telemetryEvent, eventType]);\r\n        } else {\r\n          logNotification(LogLevel.Warning, Category.Core, () => 'No telemetry sinks are attached.');\r\n        }\r\n        return;\r\n      }\r\n\r\n      this.processTelemetryEvent(telemetryEvent, eventType);\r\n    } catch (error) {\r\n      logError(Category.Core, 'SendTelemetryEvent', error);\r\n      return;\r\n    }\r\n\r\n    this.telemetrySinks.forEach(telemetrySink => {\r\n      try {\r\n        if (eventType === EventType.DirectNumericEvent || eventType === EventType.CustomerContent) {\r\n          if (telemetrySink.sendNonStandardEvent) {\r\n            telemetrySink.sendNonStandardEvent(telemetryEvent, eventType);\r\n          }\r\n        } else {\r\n          telemetrySink.sendTelemetryEvent(telemetryEvent);\r\n        }\r\n      } catch (_e) {\r\n        // Sinks should handle their own errors;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Processes a telemetry event, but does not send it\r\n   *   Adds persistent data fields\r\n   *   Validates the event\r\n   * Throws if the event is invalid\r\n   * @param telemetryEvent - The telemetry event to process\r\n   */\r\n  private processTelemetryEvent(telemetryEvent: TelemetryEvent, eventType: EventType) {\r\n    // The last-added data field wins, if the same-named data field is added more than once.\r\n    // Persistent data fields should have lower priority than per-event data fields\r\n    if (telemetryEvent.dataFields) {\r\n      telemetryEvent.dataFields?.unshift(makeStringDataField('OTelJS.Version', oteljsVersion));\r\n      // Do not add logger persistent data fields to DNM events\r\n      // All Part C fields should be explicitly added\r\n      if (eventType !== EventType.DirectNumericEvent && this.persistentDataFields) {\r\n        telemetryEvent.dataFields.unshift(...this.persistentDataFields);\r\n      }\r\n    }\r\n\r\n    if (this.partAFields.length > 0) {\r\n      const eventContract = telemetryEvent.eventContract || {\r\n        name: '',\r\n        dataFields: []\r\n      };\r\n      eventContract.dataFields.push(...this.partAFields);\r\n\r\n      telemetryEvent.eventContract = eventContract;\r\n    }\r\n\r\n    if (!this.config.disableValidation) {\r\n      validateTelemetryEvent(telemetryEvent);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Adds a telemetry sink, to which events will be sent\r\n   * @param sink - The telemetry sink to add\r\n   */\r\n  public addSink(sink: TelemetrySink) {\r\n    this.telemetrySinks.push(sink);\r\n    this.flushQueue();\r\n  }\r\n\r\n  /**\r\n   * Flush the queue of telemetry events that were accumulated before a sink was attached.\r\n   * The queue is emptied whether or not a sink is attached.\r\n   *\r\n   * Note that all events are sent at once. If an event throttler is enabled on a telemetry sink,\r\n   * it may be triggered; you may choose to only connect the event throttler after flushing the queue.\r\n   */\r\n  public flushQueue() {\r\n    const eventQueue = this.eventQueue;\r\n    this.eventQueue = [];\r\n\r\n    if (this.telemetrySinks.length > 0) {\r\n      for (const [telemetryEvent, eventType] of eventQueue) {\r\n        this.sendTelemetryEventInternal(telemetryEvent, eventType);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets a tenant token for a single namespace. Events within the namespace will be sent to the corresponding tenant.\r\n   * @param namespace - The namespace to which the tokens apply, such as Office.System.\r\n   * @param ariaTenantToken - The Aria tenant token\r\n   * @param nexusTenantToken - The Nexus tenant token\r\n   */\r\n  public setTenantToken(namespace: string, ariaTenantToken?: string, nexusTenantToken?: number) {\r\n    setTenantTokens(namespace, { ariaTenantToken, nexusTenantToken });\r\n  }\r\n\r\n  /**\r\n   * Sets a tenant token for a single namespace for DNM. Events within the namespace will be sent to the corresponding tenant.\r\n   * @param namespace - The namespace to which the tokens apply, such as Office.System.\r\n   * @param dnmToken - The Aria tenant token for direct numerical measurement events\r\n   */\r\n  public setDNMToken(namespace: string, dnmToken: string) {\r\n    setTenantTokens(namespace, { dnmToken });\r\n  }\r\n\r\n  /**\r\n   * Clone a telemetry event; generally so we don't modify the input telemetry event\r\n   * Also sets dataFields to [] if it isn't already set\r\n   * @param telemetryEvent - The event to clone\r\n   */\r\n  public cloneEvent(telemetryEvent: TelemetryEvent): TelemetryEvent {\r\n    return cloneEvent(telemetryEvent);\r\n  }\r\n\r\n  /**\r\n   * Gets the currently applied configuration\r\n   */\r\n  public getConfig() {\r\n    return this.config;\r\n  }\r\n}\r\n", "import { Activity, Result } from './Contracts';\r\nimport { CV } from './CorrelationVector';\r\nimport { logNotification } from './OTelNotifications';\r\nimport { TelemetryEvent, LogLevel, Category, FilledTelemetryEvent } from './DataModels';\r\nimport { cloneEvent } from './SimpleTelemetryLogger';\r\n\r\n// Currently we only send one activity at a time\r\nconst ACTIVITY_COUNT = 1;\r\n\r\n// Currently we do not aggregate activities in OTelJS\r\nconst ACTIVITY_AGGMODE = 0;\r\n\r\nexport let getCurrentMilliseconds = (): number => {\r\n  if (typeof self === 'object' && typeof self.performance === 'object' && typeof self.performance.now === 'function') {\r\n    getCurrentMilliseconds = () => {\r\n      return self.performance.now();\r\n    };\r\n  } else {\r\n    getCurrentMilliseconds = () => {\r\n      return Date.now();\r\n    };\r\n  }\r\n\r\n  return getCurrentMilliseconds();\r\n};\r\n\r\n/**\r\n * Additional properties that apply to the activity\r\n */\r\ninterface IActivityProperties {\r\n  sendTelemetryEvent: (telemetryEvent: TelemetryEvent) => void;\r\n\r\n  telemetryEvent: TelemetryEvent;\r\n\r\n  parentCv: CV;\r\n}\r\n\r\nexport interface IActivityScope extends FilledTelemetryEvent {\r\n  /**\r\n   * The correlation vector\r\n   */\r\n  cv: CV;\r\n\r\n  /**\r\n   * Whether the activity succeeded. At least one of success or result must be set.\r\n   */\r\n  success?: boolean;\r\n\r\n  /**\r\n   * The result of the activity. Can be set with setResult().\r\n   * At least one of success or result must be set.\r\n   */\r\n  result?: Result.Contract;\r\n\r\n  /**\r\n   * Creates an activity parented to this one.\r\n   * @param telemetryEvent - The underlying telemetry event for this activity\r\n   */\r\n  createChildActivity(telemetryEvent: TelemetryEvent): IActivityScope;\r\n\r\n  /**\r\n   * Sets the result of the activity. Does not end it.\r\n   * @param resultCode - The result code, e.g. 0 for success\r\n   * @param resultType - Optional: The result type, e.g. \"HRESULT\"\r\n   * @param resultTag - Optional: The result tag\r\n   */\r\n  setResult(code: number, type?: string, tag?: number): void;\r\n\r\n  /**\r\n   * Ends the activity; sends a telemetry event.\r\n   */\r\n  endNow(): void;\r\n}\r\n\r\nexport const createActivity: (activityProperties: IActivityProperties) => IActivityScope = (activityProperties: IActivityProperties) => {\r\n  let _startTime = getCurrentMilliseconds();\r\n  let _ended: boolean;\r\n\r\n  const clonedEvent = cloneEvent(activityProperties.telemetryEvent);\r\n\r\n  return {\r\n    cv: activityProperties.parentCv.getNext(),\r\n    ...clonedEvent,\r\n\r\n    /**\r\n     * Creates an activity parented to this one.\r\n     * @param telemetryEvent - The underlying telemetry event for this activity\r\n     */\r\n    createChildActivity(telemetryEvent: TelemetryEvent) {\r\n      return createActivity({\r\n        telemetryEvent,\r\n        sendTelemetryEvent: activityProperties.sendTelemetryEvent,\r\n        parentCv: this.cv\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Sets the result of the activity. Does not end it.\r\n     * @param resultCode - The result code, e.g. 0 for success\r\n     * @param resultType - Optional: The result type, e.g. \"HRESULT\"\r\n     * @param resultTag - Optional: The result tag\r\n     */\r\n    setResult(code: number, type?: string, tag?: number): void {\r\n      this.result = { code, type, tag };\r\n    },\r\n\r\n    /**\r\n     * Ends the activity; records the duration and sends a telemetry event.\r\n     */\r\n    endNow() {\r\n      if (_ended) {\r\n        logNotification(LogLevel.Error, Category.Core, () => `'${this.eventName}' already ended`);\r\n        return;\r\n      }\r\n\r\n      if (this.success === undefined && this.result === undefined) {\r\n        // The Activity dashboard shows these activities as 'unresolved'\r\n        // but developers generally should avoid leaving activities in this state.\r\n        logNotification(LogLevel.Warning, Category.Core, () => 'Activity does not have success or result set');\r\n      }\r\n\r\n      let endTime = getCurrentMilliseconds();\r\n      let durationInMicroseconds = Math.floor((endTime - _startTime) * 1000);\r\n      _ended = true;\r\n\r\n      // Fill the event contract\r\n      let activity: Activity.Contract = {\r\n        duration: durationInMicroseconds,\r\n        count: ACTIVITY_COUNT,\r\n        aggMode: ACTIVITY_AGGMODE,\r\n        cV: this.cv.value,\r\n        success: this.success,\r\n        result: this.result\r\n      };\r\n\r\n      let newDataFields = this.eventContract?.dataFields ?? [];\r\n      newDataFields.push(...Activity.getFields(activity));\r\n\r\n      this.eventContract = {\r\n        name: Activity.contractName,\r\n        dataFields: newDataFields\r\n      };\r\n\r\n      return activityProperties.sendTelemetryEvent(this);\r\n    }\r\n  };\r\n};\r\n", "// The \"base CV\" has a hash without any child numbers\r\nlet baseCv: CV | undefined;\r\n\r\n/**\r\n * Implementation of correlation vector\r\n */\r\nexport class CV {\r\n  /**\r\n   * The string representation of this correlation vector\r\n   */\r\n  value: string;\r\n  /**\r\n   * The index of the next child of this correlation vector\r\n   */\r\n  nextChild: number;\r\n\r\n  constructor(value: string) {\r\n    this.value = value;\r\n    this.nextChild = 0;\r\n  }\r\n\r\n  /**\r\n   * The index of the next child\r\n   */\r\n  getNext() {\r\n    return new CV(`${this.value}.${++this.nextChild}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Gets a base correlation vector for this session\r\n * @returns A base correlation vector, with a value of a 22-character string\r\n */\r\nexport function getBaseCv() {\r\n  if (!baseCv) {\r\n    let characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n    let hashLength = 22;\r\n\r\n    let result = [];\r\n\r\n    for (let i = 0; i < hashLength; i++) {\r\n      // (security is not a concern here and secure crypto function is not available on all platform)\r\n      // eslint-disable-next-line no-restricted-properties\r\n      result.push(characters.charAt(Math.floor(Math.random() * characters.length)));\r\n    }\r\n    baseCv = new CV(result.join(''));\r\n  }\r\n  return baseCv;\r\n}\r\n", "import { DataField } from './DataModels';\r\nimport { makeInt64DataField, makeStringDataField } from './DataFieldHelper';\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-namespace\r\nexport namespace Error {\r\n  export interface Contract {\r\n    errorGroup: string;\r\n    tag: number;\r\n    code?: number;\r\n    id?: number;\r\n    count?: number;\r\n  }\r\n}\r\n\r\nexport const Error = {\r\n  /**\r\n   * Gets data fields for the Error Contract\r\n   * @param contract - The object containing data fields pertaining to the Error Contract\r\n   */\r\n  getFields(contract: Error.Contract): DataField[] {\r\n    const instanceName = 'Error';\r\n    let dataFields: DataField[] = [];\r\n    dataFields.push(makeStringDataField(`${instanceName}.ErrorGroup`, contract.errorGroup));\r\n    dataFields.push(makeInt64DataField(`${instanceName}.Tag`, contract.tag));\r\n    if (contract.code !== undefined) {\r\n      dataFields.push(makeInt64DataField(`${instanceName}.Code`, contract.code));\r\n    }\r\n    if (contract.id !== undefined) {\r\n      dataFields.push(makeInt64DataField(`${instanceName}.Id`, contract.id));\r\n    }\r\n    if (contract.count !== undefined) {\r\n      dataFields.push(makeInt64DataField(`${instanceName}.Count`, contract.count));\r\n    }\r\n    return dataFields;\r\n  }\r\n}; // Error\r\n", "import { SimpleTelemetryLogger, ISimpleTelemetryLogger } from './SimpleTelemetryLogger';\r\nimport { createActivity, IActivityScope } from './Activity';\r\nimport { Error } from './InternalContracts';\r\nimport { Activity } from './Contracts';\r\nimport { EventFlags, DataField, TelemetryEvent, CustomerContentEvent } from './DataModels';\r\nimport { ITelemetryConfig } from '.';\r\nimport { CV, getBaseCv } from './CorrelationVector';\r\n\r\nexport interface ErrorEvent {\r\n  eventName: string;\r\n  error: Error.Contract;\r\n  eventFlags: EventFlags;\r\n  dataFields?: DataField[];\r\n}\r\n\r\nexport interface ITelemetryLogger extends ISimpleTelemetryLogger {\r\n  /**\r\n   * Creates a new activity. The caller is responsible for setting the result and calling endNow.\r\n   * @param telemetryEvent - The underlying telemetry event for this activity\r\n   */\r\n  createActivity(telemetryEvent: TelemetryEvent, parent?: IActivityScope): IActivityScope;\r\n\r\n  /**\r\n   * Advanced usage: Sends an activity. The caller is responsible for setting all of the activity parameters.\r\n   * @param activityName - The name of the activity\r\n   * @param activity - The activity contract\r\n   * @param dataFields - Optional additional data fields\r\n   * @param eventFlags - Event flags\r\n   */\r\n  sendActivity(activityName: string, activity: Activity.Contract, dataFields?: DataField[], eventFlags?: EventFlags): void;\r\n\r\n  /**\r\n   * Sends an event with the Error data contract. A convenience wrapper around sendTelemetryEvent, with\r\n   * an Error as a data field.\r\n   * @param eventName - The name of the event\r\n   * @param errorGroup - The group of the error\r\n   * @param tag - The error tag\r\n   * @param code - The error code\r\n   * @param id - The error id\r\n   * @param count - The count of the error\r\n   * @param dataFields - Data fields to send with the event\r\n   * @param eventFlags - Optional event flags to use for the error\r\n   */\r\n  sendError(telemetryEvent: ErrorEvent): void;\r\n\r\n  /**\r\n   * Creates a customer content activity, which should be ended by the caller by calling endNow().\r\n   * @param customerContentEvent - The underlying customer content event for this activity\r\n   */\r\n  createCustomerContentActivity(customerContentEvent: CustomerContentEvent): IActivityScope;\r\n}\r\n\r\n/**\r\n * A TelemetryLogger that includes more advanced functions than the SimpleTelemetryLogger,\r\n * specifically activities and errors.\r\n */\r\nexport class TelemetryLogger extends SimpleTelemetryLogger implements ITelemetryLogger {\r\n  private baseCv: CV;\r\n\r\n  constructor(parent?: ISimpleTelemetryLogger, persistentDataFields?: DataField[], config?: ITelemetryConfig) {\r\n    super(parent, persistentDataFields, config);\r\n    this.baseCv = getBaseCv();\r\n  }\r\n\r\n  /**\r\n   * Creates a new activity. The caller is responsible for setting the result and calling endNow.\r\n   * @param telemetryEvent - The underlying telemetry event for this activity\r\n   */\r\n  public createActivity(telemetryEvent: TelemetryEvent): IActivityScope {\r\n    return createActivity({\r\n      sendTelemetryEvent: this.sendTelemetryEvent.bind(this),\r\n      telemetryEvent,\r\n      parentCv: this.baseCv\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Advanced usage: Sends an activity. The caller is responsible for setting all of the activity parameters.\r\n   * @param activityName - The name of the activity\r\n   * @param activity - The activity contract\r\n   * @param dataFields - Optional additional data fields\r\n   * @param eventFlags - Event flags\r\n   */\r\n  public sendActivity(activityName: string, activity: Activity.Contract, dataFields: DataField[], eventFlags: EventFlags) {\r\n    return this.sendTelemetryEvent({\r\n      eventName: activityName,\r\n      eventContract: {\r\n        name: Activity.contractName,\r\n        dataFields: Activity.getFields(activity)\r\n      },\r\n      dataFields,\r\n      eventFlags\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Sends an event with the Error data contract. A convenience wrapper around sendTelemetryEvent, with\r\n   * an Error as a data field.\r\n   * @param error - an ErrorEvent that represents the error\r\n   */\r\n  public sendError(error: ErrorEvent) {\r\n    let dataFields: DataField[] = Error.getFields(error.error);\r\n    if (error.dataFields != null) {\r\n      dataFields.push(...error.dataFields);\r\n    }\r\n    return this.sendTelemetryEvent({\r\n      eventName: error.eventName,\r\n      dataFields,\r\n      eventFlags: error.eventFlags\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates a customer content activity, which should be ended by the caller by calling endNow().\r\n   * @param telemetryEvent - the underlying telemetry event for the activity\r\n   * @param customerContentType - the type of the customer content\r\n   */\r\n  public createCustomerContentActivity(customerContentEvent: CustomerContentEvent): IActivityScope {\r\n    return createActivity({\r\n      sendTelemetryEvent: (this.sendCustomerContent as (t: TelemetryEvent) => void).bind(this),\r\n      telemetryEvent: customerContentEvent,\r\n      parentCv: this.baseCv\r\n    });\r\n  }\r\n}\r\n", "import { INotificationListener, IPlugin } from '@microsoft/1ds-core-js';\r\nimport { IXHROverride } from '@microsoft/1ds-post-js';\r\nimport { App, User, Session, FilledTelemetryEvent, EventType, Release } from '@microsoft/oteljs';\r\nimport { OneDSSink } from './OneDSSink';\r\n\r\n/**\r\n * Endpoint to send 1DS telemetry events to. Includes public and special environments endpoints.\r\n */\r\nexport enum OneDSEndpoint {\r\n  /**\r\n   * US Department of Defense endpoint (Pathfinder)\r\n   */\r\n  USGOV_DOD = 'https://pf.events.data.microsoft.com/OneCollector/1.0/',\r\n  /**\r\n   * US Department of Justice endpoint (Trailblazer)\r\n   */\r\n  USGOV_DOJ = 'https://tb.events.data.microsoft.com/OneCollector/1.0/',\r\n  /**\r\n   * Public endpoint\r\n   */\r\n  PUBLIC = 'https://browser.events.data.microsoft.com/OneCollector/1.0/',\r\n  /**\r\n   * Customer content endpoint\r\n   * @deprecated Customer Content endpoint is not exposed externally,\r\n   * the SDK internally determines the corresponding CCCO endpoint URL.\r\n   */\r\n  CUSTOMER_CONTENT = '',\r\n  /**\r\n   * EUDB endpoint\r\n   */\r\n  EUDB = 'https://eu-office.events.data.microsoft.com/OneCollector/1.0/',\r\n  /**\r\n   * EDPS endpoint\r\n   */\r\n  EDPS = 'https://eu-r-office.events.data.microsoft.com/OneCollector/1.0/'\r\n}\r\n\r\n/**\r\n * Properties for configuring a OneDS Helper\r\n */\r\nexport interface OneDSHelperProperties {\r\n  /**\r\n   * Enable sending customer content to a compliant pipeline\r\n   * @deprecated enableCustomerContent has been replaced by CustomerContentHandler\r\n   */\r\n  enableCustomerContent?: boolean;\r\n\r\n  /**\r\n   * Enable sending events with a data classification of 'Optional'\r\n   */\r\n  enableOptionalEvents?: boolean;\r\n\r\n  /**\r\n   * Core Office Event Schema fields that are required to be set on the sink\r\n   */\r\n  coreFields?: CoreFields;\r\n}\r\n\r\n/**\r\n * Basic config properties for the OneDS sink.\r\n * Only key-value pairs, no functions because this object needs to be serializable for the web worker\r\n */\r\nexport interface OneDSSinkConfig extends OneDSHelperProperties {\r\n  /**\r\n   * The endpoint URL. Should generally be OneDSEndpoint.*, but can also be specified as a custom URL string.\r\n   */\r\n  endpointUrl: OneDSEndpoint | string;\r\n\r\n  /**\r\n   * The frequency in milliseconds with which events are batched.\r\n   */\r\n  uploadFrequency?: number;\r\n\r\n  /**\r\n   * If defined, when the number of queued events reaches or exceeded this limit this will cause the queue to be immediately\r\n   * flushed rather than waiting for the normal timers.\r\n   */\r\n  autoFlushEventsLimit?: number;\r\n\r\n  /**\r\n   * The number of events that can be kept in memory before the SDK starts to drop events. By default, this is 10,000.\r\n   */\r\n  eventsLimitInMem?: number;\r\n\r\n  /**\r\n   * Extension Config to be passed to the underlying SDK\r\n   */\r\n  extensionConfig?: {\r\n    [key: string]: any;\r\n  };\r\n}\r\n\r\n/**\r\n * Properties for configuring the 1DS sink\r\n */\r\nexport interface OneDSSinkProperties extends OneDSSinkConfig {\r\n  /**\r\n   * Adds a notification listener. The SDK calls methods on the listener when an appropriate notification\r\n   * (ex: event sent/dropped) is raised.\r\n   */\r\n  notificationListener?: INotificationListener;\r\n\r\n  /**\r\n   * The HTTP override that should be used to send requests.\r\n   * CAUTION: The SDK does not provide an indication of whether the request is made during shutdown, and latest\r\n   * version of the modern browsers no longer allow synchronous requests during shutdown (and asynchronous ones\r\n   * will be simple ignored). In the idea case the SDK would provide that information which the caller can then\r\n   * use to call special fetch w/ keepalive or sendbeacon API, but since it doesn't you can only safely use\r\n   * this override for unittesting purposes.\r\n   */\r\n  httpXHROverride?: IXHROverride;\r\n\r\n  /**\r\n   * Override for setTimeout. OneDS SDK uses setTimeout for scheduling the upload task and event notification callbacks.\r\n   */\r\n  setTimeoutOverride?: typeof setTimeout;\r\n\r\n  /**\r\n   * Override for clearTimeout. OneDS SDK uses setTimeout for rescheduling the upload task.\r\n   */\r\n  clearTimeoutOverride?: typeof clearTimeout;\r\n\r\n  /**\r\n   * Callback functions for SDK performance characteristics.\r\n   */\r\n  stats?: IStatsCallbacks;\r\n\r\n  /**\r\n   * Disables OTel's automatic tracking of SDKs processed/sent/dropped events.\r\n   */\r\n  disableStatsTracking?: boolean;\r\n\r\n  /**\r\n   * Plugins to be passed to the underlying SDK\r\n   */\r\n  plugins?: IPlugin[];\r\n\r\n  /**\r\n   * Handlers for non-standard telemetry events such as CCCO and Direct Numeric Events\r\n   */\r\n  nonStandardEventHandlers?: IEventHandler[];\r\n}\r\n\r\n/**\r\n * An interface for callback functions for performance metrics\r\n */\r\nexport interface IStatsCallbacks {\r\n  /**\r\n   * Callback with how long the SDK takes to process (serialize + send) a batch of events into one request.\r\n   */\r\n  requestProcessingStats: TimeStatsCallback;\r\n\r\n  /**\r\n   * Callback with how many bytes the SDK puts out on the wire.\r\n   */\r\n  networkStats: NetworkStatsCallback;\r\n\r\n  /**\r\n   * Callback with how long the PrivacyGuard takes to process the event.\r\n   */\r\n  privacyGuardStats?: PrivacyGuardStatsCallback;\r\n}\r\n\r\n/**\r\n * Type for requestProcessingStats callback\r\n * @param duration - Time taken by the SDK to process (serialize + send) a batch of events into one request.\r\n * @param numOfEvents - Number of events processed.\r\n */\r\nexport type TimeStatsCallback = (duration: number, numOfEvents: number) => void;\r\n/**\r\n * Type for networkStats callback\r\n * @param size - total bytes the SDK puts out on the wire.\r\n */\r\nexport type NetworkStatsCallback = (size: number) => void;\r\n/**\r\n * Type for privacyGuardStats callback.\r\n * @param duration - time taken by privacy guard plugin to process the event\r\n */\r\nexport type PrivacyGuardStatsCallback = (duration: number) => void;\r\n\r\n/**\r\n * Interface for telemetry preprocessors\r\n */\r\nexport interface Preprocessor {\r\n  /**\r\n   * The name of the preprocessor\r\n   */\r\n  readonly name: string;\r\n  /**\r\n   * Preprocessors process a telemetry event, and return true if the event can be sent.\r\n   * They return false if an event cannot be sent, and they throw if there is an error.\r\n   */\r\n  processEvent: (telemetryEvent: FilledTelemetryEvent) => boolean;\r\n}\r\n\r\n/**\r\n * Interface for special event handlers\r\n */\r\nexport interface IEventHandler {\r\n  /**\r\n   * Number of events that have been processed by the handler\r\n   */\r\n  eventsProcessed: number;\r\n  /**\r\n   * Returns whether or not the handler can process the event\r\n   * @param telemetryEventType - Type of telemetry event\r\n   * @returns returns true if the event can be processed by the handler\r\n   */\r\n  canHandle(telemetryEventType: EventType): boolean;\r\n  /**\r\n   * Process and send the given telemetry event\r\n   * @param telemetryEvent - Telemetry event to be processed\r\n   */\r\n  processEvent(telemetryEvent: FilledTelemetryEvent): any;\r\n  /**\r\n   * Notifies the sink to send all outstanding events and shutdown.\r\n   */\r\n  shutdown(): void;\r\n  /**\r\n   * Notifies the sink to flush the events.\r\n   * @param async - Determines whether the operation is synchrounous or asynchrounous\r\n   */\r\n  flush(async: boolean): void;\r\n  /**\r\n   * Called internally by the sink. Do not call. Sets up the logging and initializes variables.\r\n   * @param oneDSSink - instance of the OneDSSink the helper is added to\r\n   * @param oneDSSinkProperties - Properties for setting up the OneDSSink and loggers\r\n   */\r\n  initialize(oneDSSink: OneDSSink, oneDSSinkProperties: OneDSSinkProperties): void;\r\n}\r\n\r\n/**\r\n * Configuration options for the DNM Handler\r\n */\r\nexport interface DNMHandlerProperties {\r\n  /**\r\n   * The endpoint URL. Should generally be OneDSEndpoint.*, but can also be specified as a custom URL string.\r\n   * The EUDB endpoint is not supported in the DNM environment as the data is anonymized and not subject to EUDB requirements.\r\n   */\r\n  endpointUrl: OneDSEndpoint | string;\r\n}\r\n\r\n/**\r\n * Core Office Event Schema fields that are required to be set on the sink\r\n */\r\nexport interface CoreFields {\r\n  app: App.StrictContract;\r\n  release?: Release.Contract;\r\n  user: User.StrictContract;\r\n  session: Session.Contract;\r\n}\r\n", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nexport const strShimFunction = \"function\";\r\nexport const strShimObject = \"object\";\r\nexport const strShimUndefined = \"undefined\";\r\nexport const strShimPrototype = \"prototype\";\r\nexport const strShimHasOwnProperty = \"hasOwnProperty\";\r\nexport const strDefault = \"default\";\r\n\r\nexport const ObjClass = Object;\r\nexport const ObjProto = ObjClass[strShimPrototype];\r\nexport const ObjAssign = ObjClass[\"assign\"];\r\nexport const ObjCreate = ObjClass[\"create\"];\r\nexport const ObjDefineProperty = ObjClass[\"defineProperty\"];\r\nexport const ObjHasOwnProperty = ObjProto[strShimHasOwnProperty];\r\n", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport {  ObjCreate, strShimFunction, strShimObject, strShimPrototype, strShimUndefined } from \"./Constants\";\r\n\r\ndeclare var globalThis: Window;\r\ndeclare var global: Window;\r\n\r\nlet _cachedGlobal: Window = null;\r\n\r\n/**\r\n * Returns the current global scope object, for a normal web page this will be the current\r\n * window, for a Web Worker this will be current worker global scope via \"self\". The internal\r\n * implementation returns the first available instance object in the following order\r\n * - globalThis (New standard)\r\n * - self (Will return the current window instance for supported browsers)\r\n * - window (fallback for older browser implementations)\r\n * - global (NodeJS standard)\r\n * - <null> (When all else fails)\r\n * While the return type is a Window for the normal case, not all environments will support all\r\n * of the properties or functions.\r\n */\r\nexport function getGlobal(useCached: boolean = true): Window {\r\n    let result = useCached === false ? null : _cachedGlobal;\r\n\r\n    if (!result) {\r\n        if (typeof globalThis !== strShimUndefined) {\r\n            result = globalThis;\r\n        }\r\n\r\n        if (!result && typeof self !== strShimUndefined) {\r\n            result = self;\r\n        }\r\n\r\n        if (!result && typeof window !== strShimUndefined) {\r\n            result = window;\r\n        }\r\n    \r\n        if (!result && typeof global !== strShimUndefined) {\r\n            result = global;\r\n        }\r\n\r\n        _cachedGlobal = result;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function throwTypeError(message: string): never {\r\n    throw new TypeError(message);\r\n}\r\n\r\n/**\r\n * Creates an object that has the specified prototype, and that optionally contains specified properties. This helper exists to avoid adding a polyfil\r\n * for older browsers that do not define Object.create eg. ES3 only, IE8 just in case any page checks for presence/absence of the prototype implementation.\r\n * Note: For consistency this will not use the Object.create implementation if it exists as this would cause a testing requirement to test with and without the implementations\r\n * @param obj Object to use as a prototype. May be null\r\n */\r\nexport function objCreateFn(obj: any): any {\r\n    var func = ObjCreate;\r\n    // Use build in Object.create\r\n    if (func) {\r\n        // Use Object create method if it exists\r\n        return func(obj);\r\n    }\r\n    if (obj == null) {\r\n        return {};\r\n    }\r\n    var type = typeof obj;\r\n    if (type !== strShimObject && type !== strShimFunction) {\r\n        throwTypeError(\"Object prototype may only be an Object:\" + obj);\r\n    }\r\n\r\n    function tmpFunc() {}\r\n    tmpFunc[strShimPrototype] = obj;\r\n\r\n    return new (tmpFunc as any)();\r\n}\r\n\r\n", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport {\r\n    ObjAssign, ObjClass, ObjCreate, ObjDefineProperty, ObjHasOwnProperty, ObjProto,\r\n    strDefault, strShimFunction, strShimHasOwnProperty, strShimPrototype\r\n} from \"./Constants\";\r\nimport { getGlobal, objCreateFn, throwTypeError } from \"./Helpers\";\r\n\r\n// Most of these functions have been directly shamelessly \"lifted\" from the https://github.com/@microsoft/tslib and\r\n// modified to be ES3 compatible and applying several minification and tree-shaking techniques so that Application Insights\r\n// can successfully use TypeScript \"importHelpers\" which imports tslib during compilation but it will use these at runtime\r\n// Which is also why all of the functions have not been included as Application Insights currently doesn't use or require\r\n// them.\r\n\r\nexport const SymbolObj = (getGlobal()||{})[\"Symbol\"];\r\nexport const ReflectObj = (getGlobal()||{})[\"Reflect\"];\r\nexport const __hasSymbol = !!SymbolObj;\r\nexport const __hasReflect = !!ReflectObj;\r\n\r\nconst strDecorate = \"decorate\";\r\nconst strMetadata = \"metadata\";\r\nconst strGetOwnPropertySymbols = \"getOwnPropertySymbols\";\r\nconst strIterator = \"iterator\";\r\n\r\nexport declare type ObjAssignFunc = (t: any, ...sources:any[]) => any;\r\n\r\nexport var __objAssignFnImpl: ObjAssignFunc = function(t: any): any {\r\n    // tslint:disable-next-line: ban-comma-operator\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) {\r\n            if (ObjProto[strShimHasOwnProperty].call(s, p)) {\r\n                (t as any)[p] = s[p];\r\n            }\r\n        }\r\n    }\r\n    return t;\r\n};\r\n\r\nexport var __assignFn: ObjAssignFunc = ObjAssign || __objAssignFnImpl;\r\n\r\n// tslint:disable-next-line: only-arrow-functions\r\nvar extendStaticsFn = function(d: any, b: any): any {\r\n    extendStaticsFn = ObjClass[\"setPrototypeOf\"] ||\r\n        // tslint:disable-next-line: only-arrow-functions\r\n        ({ __proto__: [] } instanceof Array && function (d: any, b: any) {\r\n            d.__proto__ = b;\r\n        }) ||\r\n        // tslint:disable-next-line: only-arrow-functions\r\n        function (d: any, b: any) {\r\n            for (var p in b) {\r\n                if (b[strShimHasOwnProperty](p)) {\r\n                    d[p] = b[p];\r\n                }\r\n            }\r\n        };\r\n    return extendStaticsFn(d, b);\r\n};\r\n\r\nexport function __extendsFn(d: any, b: any) {\r\n    if (typeof b !== strShimFunction && b !== null) {\r\n        throwTypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    }\r\n    extendStaticsFn(d, b);\r\n    function __(this: any) {\r\n        this.constructor = d;\r\n    }\r\n    // tslint:disable-next-line: ban-comma-operator\r\n    d[strShimPrototype] = b === null ? objCreateFn(b) : (__[strShimPrototype] = b[strShimPrototype], new (__ as any)());\r\n}\r\n\r\nexport function __restFn(s: any, e: any) {\r\n    var t = {};\r\n    for (var k in s) {\r\n        if (ObjHasOwnProperty.call(s, k) && e.indexOf(k) < 0) {\r\n            t[k] = s[k];\r\n        }\r\n    }\r\n    if (s != null && typeof ObjClass[strGetOwnPropertySymbols] === strShimFunction) {\r\n        for (var i = 0, p = ObjClass[strGetOwnPropertySymbols](s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && ObjProto[\"propertyIsEnumerable\"].call(s, p[i])) {\r\n                t[p[i]] = s[p[i]];\r\n            }\r\n        }\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __decorateFn(decorators: any, target: any, key: any, desc: any) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = ObjClass[\"getOwnPropertyDescriptor\"](target, key) : desc, d;\r\n    if (__hasReflect && typeof ReflectObj[strDecorate] === strShimFunction) {\r\n        r = ReflectObj[strDecorate](decorators, target, key, desc);\r\n    } else {\r\n        for (var i = decorators.length - 1; i >= 0; i--) {\r\n            // eslint-disable-next-line no-cond-assign\r\n            if (d = decorators[i]) {\r\n                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n            }\r\n        }\r\n    }\r\n\r\n    // tslint:disable-next-line:ban-comma-operator\r\n    return c > 3 && r && ObjDefineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __paramFn(paramIndex: number, decorator: Function) {\r\n    return function (target: any, key: any) {\r\n        decorator(target, key, paramIndex);\r\n    }\r\n}\r\n\r\nexport function __metadataFn(metadataKey: any, metadataValue: any) {\r\n    if (__hasReflect && ReflectObj[strMetadata] === strShimFunction) {\r\n        return ReflectObj[strMetadata](metadataKey, metadataValue);\r\n    }\r\n}\r\n\r\nexport function __exportStarFn(m: any, o: any) {\r\n    for (var p in m) {\r\n        if (p !== strDefault && !ObjHasOwnProperty.call(o, p)) {\r\n            __createBindingFn(o, m, p);\r\n        }\r\n    }\r\n}\r\n\r\nexport function __createBindingFn(o: any, m: any, k: any, k2?: any) {\r\n    if (k2 === undefined) {\r\n        k2 = k;\r\n    }\r\n    \r\n    if (!!ObjCreate) {\r\n        ObjDefineProperty(o, k2, {\r\n            enumerable: true,\r\n            get() {\r\n                return m[k];\r\n            }\r\n        });\r\n    } else {\r\n        o[k2] = m[k];\r\n    }\r\n}\r\n\r\nexport function __valuesFn(o: any) {\r\n    var s = typeof SymbolObj === strShimFunction && SymbolObj[strIterator], m = s && o[s], i = 0;\r\n    if (m) {\r\n        return m.call(o);\r\n    }\r\n\r\n    if (o && typeof o.length === \"number\") {\r\n        return {\r\n            next () {\r\n                if (o && i >= o.length) {\r\n                    o = void 0;\r\n                }\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    }\r\n\r\n    throwTypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __readFn(o: any, n: any) {\r\n    var m = typeof SymbolObj === strShimFunction && o[SymbolObj[strIterator]];\r\n    if (!m) {\r\n        return o;\r\n    }\r\n\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\r\n            ar.push(r.value);\r\n        }\r\n    } catch (error) {\r\n        e = {\r\n            error\r\n        };\r\n    } finally {\r\n        try {\r\n            // tslint:disable-next-line:no-conditional-assignment\r\n            if (r && !r.done && (m = i[\"return\"])) {\r\n                m.call(i);\r\n            }\r\n        } finally {\r\n            if (e) {\r\n                // eslint-disable-next-line no-unsafe-finally\r\n                throw e.error;\r\n            }\r\n        }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArraysFn() {\r\n    var theArgs = arguments;\r\n    // Calculate new total size\r\n    for (var s = 0, i = 0, il = theArgs.length; i < il; i++) {\r\n        s += theArgs[i].length;\r\n    }\r\n\r\n    // Create new full array\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) {\r\n        for (var a = theArgs[i], j = 0, jl = a.length; j < jl; j++, k++) {\r\n            r[k] = a[j];\r\n        }\r\n    }\r\n\r\n    return r;\r\n}\r\n\r\nexport function __spreadArrayFn(to: any, from: any) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) {\r\n        to[j] = from[i];\r\n    }\r\n\r\n    return to;\r\n}\r\n\r\nexport function __makeTemplateObjectFn(cooked: any, raw: any) {\r\n    if (ObjDefineProperty) {\r\n        ObjDefineProperty(cooked, \"raw\", { value: raw });\r\n    } else {\r\n        cooked.raw = raw;\r\n    }\r\n\r\n    return cooked;\r\n}\r\n\r\nexport function __importStarFn(mod: any) {\r\n    if (mod && mod.__esModule) {\r\n        return mod;\r\n    }\r\n\r\n    var result = {};\r\n    if (mod != null) {\r\n        for (var k in mod) {\r\n            if (k !== strDefault && Object.prototype.hasOwnProperty.call(mod, k)) {\r\n                __createBindingFn(result, mod, k);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Set default module\r\n    if (!!ObjCreate) {\r\n        ObjDefineProperty( result, strDefault, { enumerable: true, value: mod });\r\n    } else {\r\n        result[strDefault] = mod;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport function __importDefaultFn(mod:any) {\r\n    return (mod && mod.__esModule) ? mod : { strDefault: mod };\r\n}\r\n", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n// @skip-file-minify\r\n// ##############################################################\r\n// AUTO GENERATED FILE: This file is Auto Generated during build.\r\n// ##############################################################\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\nexport var _DYN_INITIALIZE = \"initialize\"; // Count: 8\r\nexport var _DYN_NAME = \"name\"; // Count: 11\r\nexport var _DYN_GET_NOTIFY_MGR = \"getNotifyMgr\"; // Count: 3\r\nexport var _DYN_IDENTIFIER = \"identifier\"; // Count: 8\r\nexport var _DYN_PUSH = \"push\"; // Count: 30\r\nexport var _DYN_IS_INITIALIZED = \"isInitialized\"; // Count: 10\r\nexport var _DYN_CONFIG = \"config\"; // Count: 7\r\nexport var _DYN_INSTRUMENTATION_KEY = \"instrumentationKey\"; // Count: 3\r\nexport var _DYN_LOGGER = \"logger\"; // Count: 10\r\nexport var _DYN_LENGTH = \"length\"; // Count: 45\r\nexport var _DYN_TIME = \"time\"; // Count: 5\r\nexport var _DYN_PROCESS_NEXT = \"processNext\"; // Count: 21\r\nexport var _DYN_GET_PROCESS_TEL_CONT0 = \"getProcessTelContext\"; // Count: 2\r\nexport var _DYN_ADD_NOTIFICATION_LIS1 = \"addNotificationListener\"; // Count: 5\r\nexport var _DYN_REMOVE_NOTIFICATION_2 = \"removeNotificationListener\"; // Count: 5\r\nexport var _DYN_STOP_POLLING_INTERNA3 = \"stopPollingInternalLogs\"; // Count: 2\r\nexport var _DYN_ON_COMPLETE = \"onComplete\"; // Count: 6\r\nexport var _DYN_GET_PLUGIN = \"getPlugin\"; // Count: 5\r\nexport var _DYN_FLUSH = \"flush\"; // Count: 5\r\nexport var _DYN__EXTENSIONS = \"_extensions\"; // Count: 4\r\nexport var _DYN_SPLICE = \"splice\"; // Count: 6\r\nexport var _DYN_TEARDOWN = \"teardown\"; // Count: 10\r\nexport var _DYN_MESSAGE_ID = \"messageId\"; // Count: 4\r\nexport var _DYN_MESSAGE = \"message\"; // Count: 7\r\nexport var _DYN_IS_ASYNC = \"isAsync\"; // Count: 7\r\nexport var _DYN__DO_TEARDOWN = \"_doTeardown\"; // Count: 4\r\nexport var _DYN_UPDATE = \"update\"; // Count: 7\r\nexport var _DYN_GET_NEXT = \"getNext\"; // Count: 12\r\nexport var _DYN_DIAG_LOG = \"diagLog\"; // Count: 8\r\nexport var _DYN_SET_NEXT_PLUGIN = \"setNextPlugin\"; // Count: 5\r\nexport var _DYN_CREATE_NEW = \"createNew\"; // Count: 6\r\nexport var _DYN_COOKIE_CFG = \"cookieCfg\"; // Count: 3\r\nexport var _DYN_INDEX_OF = \"indexOf\"; // Count: 7\r\nexport var _DYN_SUBSTRING = \"substring\"; // Count: 10\r\nexport var _DYN_USER_AGENT = \"userAgent\"; // Count: 5\r\nexport var _DYN_SPLIT = \"split\"; // Count: 6\r\nexport var _DYN_SET_ENABLED = \"setEnabled\"; // Count: 5\r\nexport var _DYN_SUBSTR = \"substr\"; // Count: 6\r\nexport var _DYN_NODE_TYPE = \"nodeType\"; // Count: 3\r\nexport var _DYN_APPLY = \"apply\"; // Count: 6\r\nexport var _DYN_REPLACE = \"replace\"; // Count: 10\r\nexport var _DYN_ENABLE_DEBUG_EXCEPTI4 = \"enableDebugExceptions\"; // Count: 2\r\nexport var _DYN_LOG_INTERNAL_MESSAGE = \"logInternalMessage\"; // Count: 2\r\nexport var _DYN_TO_LOWER_CASE = \"toLowerCase\"; // Count: 8\r\nexport var _DYN_CALL = \"call\"; // Count: 18\r\nexport var _DYN_TYPE = \"type\"; // Count: 14\r\nexport var _DYN_HANDLER = \"handler\"; // Count: 5\r\nexport var _DYN_LISTENERS = \"listeners\"; // Count: 6\r\nexport var _DYN_IS_CHILD_EVT = \"isChildEvt\"; // Count: 3\r\nexport var _DYN_GET_CTX = \"getCtx\"; // Count: 6\r\nexport var _DYN_SET_CTX = \"setCtx\"; // Count: 10\r\nexport var _DYN_COMPLETE = \"complete\"; // Count: 3\r\nexport var _DYN_TRACE_ID = \"traceId\"; // Count: 5\r\nexport var _DYN_SPAN_ID = \"spanId\"; // Count: 5\r\nexport var _DYN_TRACE_FLAGS = \"traceFlags\"; // Count: 6\r\nexport var _DYN_VERSION = \"version\"; // Count: 4\r\n//# sourceMappingURL=__DynamicConstants.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n// ###################################################################################################################################################\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// ###################################################################################################################################################\r\nexport var STR_EMPTY = \"\";\r\nexport var STR_CHANNELS = \"channels\";\r\nexport var STR_CORE = \"core\";\r\nexport var STR_CREATE_PERF_MGR = \"createPerfMgr\";\r\nexport var STR_DISABLED = \"disabled\";\r\nexport var STR_EXTENSION_CONFIG = \"extensionConfig\";\r\nexport var STR_EXTENSIONS = \"extensions\";\r\nexport var STR_PROCESS_TELEMETRY = \"processTelemetry\";\r\nexport var STR_PRIORITY = \"priority\";\r\nexport var STR_EVENTS_SENT = \"eventsSent\";\r\nexport var STR_EVENTS_DISCARDED = \"eventsDiscarded\";\r\nexport var STR_EVENTS_SEND_REQUEST = \"eventsSendRequest\";\r\nexport var STR_PERF_EVENT = \"perfEvent\";\r\nexport var STR_ERROR_TO_CONSOLE = \"errorToConsole\";\r\nexport var STR_WARN_TO_CONSOLE = \"warnToConsole\";\r\nexport var STR_GET_PERF_MGR = \"getPerfMgr\";\r\n//# sourceMappingURL=InternalConstants.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { ObjAssign, ObjClass, ObjDefineProperty, ObjHasOwnProperty, ObjProto, strShimFunction, strShimObject, strShimPrototype, strShimUndefined, throwTypeError } from \"@microsoft/applicationinsights-shims\";\r\nimport { _DYN_APPLY, _DYN_CALL, _DYN_INDEX_OF, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_REPLACE } from \"../__DynamicConstants\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n// RESTRICT and AVOID circular dependencies you should not import other contained modules or export the contents of this file directly\r\n// Added to help with minfication\r\nvar strToISOString = \"toISOString\";\r\nvar cStrEndsWith = \"endsWith\";\r\nvar cStrStartsWith = \"startsWith\";\r\nvar strIndexOf = \"indexOf\";\r\nvar strMap = \"map\";\r\nvar strReduce = \"reduce\";\r\nvar cStrTrim = \"trim\";\r\nvar strToString = \"toString\";\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar str__Proto = \"__proto__\";\r\n/**\r\n  * Constant string defined to support minimization\r\n  * @ignore\r\n  */\r\nvar strConstructor = \"constructor\";\r\nvar _objDefineProperty = ObjDefineProperty;\r\nvar _objFreeze = ObjClass.freeze;\r\nvar _objSeal = ObjClass.seal;\r\nvar _objKeys = ObjClass.keys;\r\nvar StringProto = String[strShimPrototype];\r\nvar _strTrim = StringProto[cStrTrim];\r\nvar _strEndsWith = StringProto[cStrEndsWith];\r\nvar _strStartsWith = StringProto[cStrStartsWith];\r\nvar DateProto = Date[strShimPrototype];\r\nvar _dataToISOString = DateProto[strToISOString];\r\nvar _isArray = Array.isArray;\r\nvar _objToString = ObjProto[strToString];\r\nvar _fnToString = ObjHasOwnProperty[strToString];\r\n// Cache what this browser reports as the object function constructor (as a string)\r\nvar _objFunctionString = _fnToString[_DYN_CALL /* @min:%2ecall */](ObjClass);\r\nvar rCamelCase = /-([a-z])/g;\r\nvar rNormalizeInvalid = /([^\\w\\d_$])/g;\r\nvar rLeadingNumeric = /^(\\d+[\\w\\d_$])/;\r\n/**\r\n * Pre-lookup to check if we are running on a modern browser (i.e. not IE8)\r\n * @ignore\r\n */\r\nvar _objGetPrototypeOf = Object[\"getPrototypeOf\"];\r\n/**\r\n  * Helper used to get the prototype of the target object as getPrototypeOf is not available in an ES3 environment.\r\n  * @ignore\r\n  */\r\nexport function _getObjProto(target) {\r\n    if (target) {\r\n        // This method doesn't existing in older browsers (e.g. IE8)\r\n        if (_objGetPrototypeOf) {\r\n            return _objGetPrototypeOf(target);\r\n        }\r\n        // target[Constructor] May break if the constructor has been changed or removed\r\n        var newProto = target[str__Proto] || target[strShimPrototype] || target[strConstructor];\r\n        if (newProto) {\r\n            return newProto;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function objToString(obj) {\r\n    return _objToString[_DYN_CALL /* @min:%2ecall */](obj);\r\n}\r\nexport function isTypeof(value, theType) {\r\n    return typeof value === theType;\r\n}\r\nexport function isUndefined(value) {\r\n    return value === undefined || typeof value === strShimUndefined;\r\n}\r\nexport function isNotUndefined(value) {\r\n    return !isUndefined(value);\r\n}\r\nexport function isNullOrUndefined(value) {\r\n    return (value === null || isUndefined(value));\r\n}\r\nexport function isNotNullOrUndefined(value) {\r\n    return !isNullOrUndefined(value);\r\n}\r\nexport function hasOwnProperty(obj, prop) {\r\n    return !!(obj && ObjHasOwnProperty[_DYN_CALL /* @min:%2ecall */](obj, prop));\r\n}\r\nexport function isObject(value) {\r\n    // Changing to inline for performance\r\n    return !!(value && typeof value === strShimObject);\r\n}\r\nexport function isFunction(value) {\r\n    // Changing to inline for performance\r\n    return !!(value && typeof value === strShimFunction);\r\n}\r\nexport function isPromiseLike(value) {\r\n    return value && isFunction(value.then);\r\n}\r\n/**\r\n * Validates that the string name conforms to the JS IdentifierName specification and if not\r\n * normalizes the name so that it would. This method does not identify or change any keywords\r\n * meaning that if you pass in a known keyword the same value will be returned.\r\n * This is a simplified version\r\n * @param name The name to validate\r\n */\r\nexport function normalizeJsName(name) {\r\n    var value = name;\r\n    if (value && isString(value)) {\r\n        // CamelCase everything after the \"-\" and remove the dash\r\n        value = value[_DYN_REPLACE /* @min:%2ereplace */](rCamelCase, function (_all, letter) {\r\n            return letter.toUpperCase();\r\n        });\r\n        value = value[_DYN_REPLACE /* @min:%2ereplace */](rNormalizeInvalid, \"_\");\r\n        value = value[_DYN_REPLACE /* @min:%2ereplace */](rLeadingNumeric, function (_all, match) {\r\n            return \"_\" + match;\r\n        });\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * This is a helper function for the equivalent of arForEach(objKeys(target), callbackFn), this is a\r\n * performance optimization to avoid the creation of a new array for large objects\r\n * @param target The target object to find and process the keys\r\n * @param callbackfn The function to call with the details\r\n */\r\nexport function objForEachKey(target, callbackfn) {\r\n    if (target) {\r\n        for (var prop in target) {\r\n            if (ObjHasOwnProperty[_DYN_CALL /* @min:%2ecall */](target, prop)) {\r\n                callbackfn[_DYN_CALL /* @min:%2ecall */](target, prop, target[prop]);\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * The strEndsWith() method determines whether a string ends with the characters of a specified string, returning true or false as appropriate.\r\n * @param value - The value to check whether it ends with the search value.\r\n * @param search - The characters to be searched for at the end of the value.\r\n * @returns true if the given search value is found at the end of the string, otherwise false.\r\n */\r\nexport function strEndsWith(value, search) {\r\n    var result = false;\r\n    if (value && search && !(result = value === search)) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        result = _strEndsWith ? value[cStrEndsWith](search) : _strEndsWithPoly(value, search);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * The _strEndsWith() method determines whether a string ends with the characters of a specified string, returning true or false as appropriate.\r\n * @param value - The value to check whether it ends with the search value.\r\n * @param search - The characters to be searched for at the end of the value.\r\n * @returns true if the given search value is found at the end of the string, otherwise false.\r\n */\r\nexport function _strEndsWithPoly(value, search) {\r\n    var result = false;\r\n    var searchLen = search ? search[_DYN_LENGTH /* @min:%2elength */] : 0;\r\n    var valLen = value ? value[_DYN_LENGTH /* @min:%2elength */] : 0;\r\n    if (searchLen && valLen && valLen >= searchLen && !(result = value === search)) {\r\n        var pos = valLen - 1;\r\n        for (var lp = searchLen - 1; lp >= 0; lp--) {\r\n            if (value[pos] != search[lp]) {\r\n                return false;\r\n            }\r\n            pos--;\r\n        }\r\n        result = true;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * The strStartsWith() method determines whether a string starts with the characters of the specified string, returning true or false as appropriate.\r\n * @param value - The value to check whether it ends with the search value.\r\n * @param checkValue - The characters to be searched for at the start of the value.\r\n * @returns true if the given search value is found at the start of the string, otherwise false.\r\n */\r\nexport function strStartsWith(value, checkValue) {\r\n    var result = false;\r\n    if (value && checkValue && !(result = value === checkValue)) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        result = _strStartsWith ? value[cStrStartsWith](checkValue) : _strStartsWithPoly(value, checkValue);\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * The strStartsWith() method determines whether a string starts with the characters of the specified string, returning true or false as appropriate.\r\n * @param value - The value to check whether it ends with the search value.\r\n * @param checkValue - The characters to be searched for at the start of the value.\r\n * @returns true if the given search value is found at the start of the string, otherwise false.\r\n */\r\nexport function _strStartsWithPoly(value, checkValue) {\r\n    // Using helper for performance and because string startsWith() is not available on IE\r\n    var result = false;\r\n    var chkLen = checkValue ? checkValue[_DYN_LENGTH /* @min:%2elength */] : 0;\r\n    if (value && chkLen && value[_DYN_LENGTH /* @min:%2elength */] >= chkLen && !(result = value === checkValue)) {\r\n        for (var lp = 0; lp < chkLen; lp++) {\r\n            if (value[lp] !== checkValue[lp]) {\r\n                return false;\r\n            }\r\n        }\r\n        result = true;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * A simple wrapper (for minification support) to check if the value contains the search string.\r\n * @param value - The string value to check for the existence of the search value\r\n * @param search - The value search within the value\r\n */\r\nexport function strContains(value, search) {\r\n    if (value && search) {\r\n        return value[_DYN_INDEX_OF /* @min:%2eindexOf */](search) !== -1;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Check if an object is of type Date\r\n */\r\nexport function isDate(obj) {\r\n    return !!(obj && _objToString[_DYN_CALL /* @min:%2ecall */](obj) === \"[object Date]\");\r\n}\r\n/**\r\n * Check if an object is of type Array with optional generic T, the generic type is not validated\r\n * and exists to help with TypeScript validation only.\r\n */\r\nexport var isArray = _isArray || _isArrayPoly;\r\nfunction _isArrayPoly(obj) {\r\n    return !!(obj && _objToString[_DYN_CALL /* @min:%2ecall */](obj) === \"[object Array]\");\r\n}\r\n/**\r\n * Check if an object is of type Error\r\n */\r\nexport function isError(obj) {\r\n    return !!(obj && _objToString[_DYN_CALL /* @min:%2ecall */](obj) === \"[object Error]\");\r\n}\r\n/**\r\n * Checks if the type of value is a string.\r\n * @param {any} value - Value to be checked.\r\n * @return {boolean} True if the value is a string, false otherwise.\r\n */\r\nexport function isString(value) {\r\n    // Changing to inline for performance\r\n    return typeof value === \"string\";\r\n}\r\n/**\r\n * Checks if the type of value is a number.\r\n * @param {any} value - Value to be checked.\r\n * @return {boolean} True if the value is a number, false otherwise.\r\n */\r\nexport function isNumber(value) {\r\n    // Changing to inline for performance\r\n    return typeof value === \"number\";\r\n}\r\n/**\r\n * Checks if the type of value is a boolean.\r\n * @param {any} value - Value to be checked.\r\n * @return {boolean} True if the value is a boolean, false otherwise.\r\n */\r\nexport function isBoolean(value) {\r\n    // Changing to inline for performance\r\n    return typeof value === \"boolean\";\r\n}\r\n/**\r\n * Checks if the type of value is a Symbol.\r\n * This only returns a boolean as returning value is Symbol will cause issues for older TypeScript consumers\r\n * @param {any} value - Value to be checked.\r\n * @return {boolean} True if the value is a Symbol, false otherwise.\r\n */\r\nexport function isSymbol(value) {\r\n    return typeof value === \"symbol\";\r\n}\r\n/**\r\n * Checks if the type of the value is a normal plain object (not a null or data)\r\n * @param value\r\n */\r\nexport function isPlainObject(value) {\r\n    var result = false;\r\n    if (value && typeof value === \"object\") {\r\n        // Inlining _objGetPrototypeOf for performance to avoid an additional function call\r\n        var proto = _objGetPrototypeOf ? _objGetPrototypeOf(value) : _getObjProto(value);\r\n        if (!proto) {\r\n            // No prototype found so this is a plain Object eg. 'Object.create(null)'\r\n            result = true;\r\n        }\r\n        else {\r\n            // Objects that have a prototype are plain only if they were created using the Object global (native) function\r\n            if (proto[strConstructor] && ObjHasOwnProperty[_DYN_CALL /* @min:%2ecall */](proto, strConstructor)) {\r\n                proto = proto[strConstructor];\r\n            }\r\n            result = typeof proto === strShimFunction && _fnToString[_DYN_CALL /* @min:%2ecall */](proto) === _objFunctionString;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Convert a date to I.S.O. format in IE8\r\n */\r\nexport function toISOString(date) {\r\n    if (date) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        return _dataToISOString ? date[strToISOString]() : _toISOStringPoly(date);\r\n    }\r\n}\r\n/**\r\n * Convert a date to I.S.O. format in IE8\r\n */\r\nexport function _toISOStringPoly(date) {\r\n    if (date && date.getUTCFullYear) {\r\n        var pad = function (num) {\r\n            var r = String(num);\r\n            if (r[_DYN_LENGTH /* @min:%2elength */] === 1) {\r\n                r = \"0\" + r;\r\n            }\r\n            return r;\r\n        };\r\n        return date.getUTCFullYear()\r\n            + \"-\" + pad(date.getUTCMonth() + 1)\r\n            + \"-\" + pad(date.getUTCDate())\r\n            + \"T\" + pad(date.getUTCHours())\r\n            + \":\" + pad(date.getUTCMinutes())\r\n            + \":\" + pad(date.getUTCSeconds())\r\n            + \".\" + String((date.getUTCMilliseconds() / 1000).toFixed(3)).slice(2, 5)\r\n            + \"Z\";\r\n    }\r\n}\r\n/**\r\n * Performs the specified action for each element in an array. This helper exists to avoid adding a polyfil for older browsers\r\n * that do not define Array.prototype.xxxx (eg. ES3 only, IE8) just in case any page checks for presence/absence of the prototype\r\n * implementation. Note: For consistency this will not use the Array.prototype.xxxx implementation if it exists as this would\r\n * cause a testing requirement to test with and without the implementations\r\n * @param callbackfn  A function that accepts up to three arguments. forEach calls the callbackfn function one time for each element in the array. It can return -1 to break out of the loop\r\n * @param thisArg  [Optional] An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\r\n */\r\nexport function arrForEach(arr, callbackfn, thisArg) {\r\n    var len = arr[_DYN_LENGTH /* @min:%2elength */];\r\n    try {\r\n        for (var idx = 0; idx < len; idx++) {\r\n            if (idx in arr) {\r\n                if (callbackfn[_DYN_CALL /* @min:%2ecall */](thisArg || arr, arr[idx], idx, arr) === -1) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        // This can happen with some native browser objects, but should not happen for the type we are checking for\r\n    }\r\n}\r\n/**\r\n * Returns the index of the first occurrence of a value in an array. This helper exists to avoid adding a polyfil for older browsers\r\n * that do not define Array.prototype.xxxx (eg. ES3 only, IE8) just in case any page checks for presence/absence of the prototype\r\n * implementation. Note: For consistency this will not use the Array.prototype.xxxx implementation if it exists as this would\r\n * cause a testing requirement to test with and without the implementations\r\n * @param searchElement The value to locate in the array.\r\n * @param fromIndex The array index at which to begin the search. If fromIndex is omitted, the search starts at index 0.\r\n */\r\nexport function arrIndexOf(arr, searchElement, fromIndex) {\r\n    if (arr) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        if (arr[strIndexOf]) {\r\n            return arr[strIndexOf](searchElement, fromIndex);\r\n        }\r\n        var len = arr[_DYN_LENGTH /* @min:%2elength */];\r\n        var from = fromIndex || 0;\r\n        try {\r\n            for (var lp = Math.max(from >= 0 ? from : len - Math.abs(from), 0); lp < len; lp++) {\r\n                if (lp in arr && arr[lp] === searchElement) {\r\n                    return lp;\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            // This can happen with some native browser objects, but should not happen for the type we are checking for\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n/**\r\n * Calls a defined callback function on each element of an array, and returns an array that contains the results. This helper exists\r\n * to avoid adding a polyfil for older browsers that do not define Array.prototype.xxxx (eg. ES3 only, IE8) just in case any page\r\n * checks for presence/absence of the prototype implementation. Note: For consistency this will not use the Array.prototype.xxxx\r\n * implementation if it exists as this would cause a testing requirement to test with and without the implementations\r\n * @param callbackfn A function that accepts up to three arguments. The map method calls the callbackfn function one time for each element in the array.\r\n * @param thisArg An object to which the this keyword can refer in the callbackfn function. If thisArg is omitted, undefined is used as the this value.\r\n */\r\nexport function arrMap(arr, callbackfn, thisArg) {\r\n    var results;\r\n    if (arr) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        if (arr[strMap]) {\r\n            return arr[strMap](callbackfn, thisArg);\r\n        }\r\n        var len = arr[_DYN_LENGTH /* @min:%2elength */];\r\n        var _this = thisArg || arr;\r\n        results = new Array(len);\r\n        try {\r\n            for (var lp = 0; lp < len; lp++) {\r\n                if (lp in arr) {\r\n                    results[lp] = callbackfn[_DYN_CALL /* @min:%2ecall */](_this, arr[lp], arr);\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            // This can happen with some native browser objects, but should not happen for the type we are checking for\r\n        }\r\n    }\r\n    return results;\r\n}\r\n/**\r\n * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is\r\n * provided as an argument in the next call to the callback function. This helper exists to avoid adding a polyfil for older browsers that do not define\r\n * Array.prototype.xxxx (eg. ES3 only, IE8) just in case any page checks for presence/absence of the prototype implementation. Note: For consistency\r\n * this will not use the Array.prototype.xxxx implementation if it exists as this would cause a testing requirement to test with and without the implementations\r\n * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.\r\n * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.\r\n */\r\nexport function arrReduce(arr, callbackfn, initialValue) {\r\n    var value;\r\n    if (arr) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        if (arr[strReduce]) {\r\n            return arr[strReduce](callbackfn, initialValue);\r\n        }\r\n        var len = arr[_DYN_LENGTH /* @min:%2elength */];\r\n        var lp = 0;\r\n        // Specifically checking the number of passed arguments as the value could be anything\r\n        if (arguments[_DYN_LENGTH /* @min:%2elength */] >= 3) {\r\n            value = arguments[2];\r\n        }\r\n        else {\r\n            while (lp < len && !(lp in arr)) {\r\n                lp++;\r\n            }\r\n            value = arr[lp++];\r\n        }\r\n        while (lp < len) {\r\n            if (lp in arr) {\r\n                value = callbackfn(value, arr[lp], lp, arr);\r\n            }\r\n            lp++;\r\n        }\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * helper method to trim strings (IE8 does not implement String.prototype.trim)\r\n */\r\nexport function strTrim(str) {\r\n    if (str) {\r\n        // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n        str = (_strTrim && str[cStrTrim]) ? str[cStrTrim]() : (str[_DYN_REPLACE /* @min:%2ereplace */] ? str[_DYN_REPLACE /* @min:%2ereplace */](/^\\s+|(?=\\s)\\s+$/g, STR_EMPTY) : str);\r\n    }\r\n    return str;\r\n}\r\nvar _objKeysHasDontEnumBug = !({ toString: null }).propertyIsEnumerable(\"toString\");\r\nvar _objKeysDontEnums = [\r\n    \"toString\",\r\n    \"toLocaleString\",\r\n    \"valueOf\",\r\n    \"hasOwnProperty\",\r\n    \"isPrototypeOf\",\r\n    \"propertyIsEnumerable\",\r\n    \"constructor\"\r\n];\r\n/**\r\n * Returns the names of the enumerable string properties and methods of an object. This helper exists to avoid adding a polyfil for older browsers\r\n * that do not define Object.keys eg. ES3 only, IE8 just in case any page checks for presence/absence of the prototype implementation.\r\n * Note: For consistency this will not use the Object.keys implementation if it exists as this would cause a testing requirement to test with and without the implementations\r\n * @param obj Object that contains the properties and methods. This can be an object that you created or an existing Document Object Model (DOM) object.\r\n */\r\nexport function objKeys(obj) {\r\n    var objType = typeof obj;\r\n    if (objType !== strShimFunction && (objType !== strShimObject || obj === null)) {\r\n        throwTypeError(\"objKeys called on non-object\");\r\n    }\r\n    // For Performance try and use the native instance, using string lookup of the function to easily pass the ES3 build checks and minification\r\n    if (!_objKeysHasDontEnumBug && _objKeys) {\r\n        return _objKeys(obj);\r\n    }\r\n    var result = [];\r\n    for (var prop in obj) {\r\n        if (obj && ObjHasOwnProperty[_DYN_CALL /* @min:%2ecall */](obj, prop)) {\r\n            result[_DYN_PUSH /* @min:%2epush */](prop);\r\n        }\r\n    }\r\n    if (_objKeysHasDontEnumBug) {\r\n        var dontEnumsLength = _objKeysDontEnums[_DYN_LENGTH /* @min:%2elength */];\r\n        for (var lp = 0; lp < dontEnumsLength; lp++) {\r\n            if (obj && ObjHasOwnProperty[_DYN_CALL /* @min:%2ecall */](obj, _objKeysDontEnums[lp])) {\r\n                result[_DYN_PUSH /* @min:%2epush */](_objKeysDontEnums[lp]);\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Try to define get/set object property accessors for the target object/prototype, this will provide compatibility with\r\n * existing API definition when run within an ES5+ container that supports accessors but still enable the code to be loaded\r\n * and executed in an ES3 container, providing basic IE8 compatibility.\r\n * @param target The object on which to define the property.\r\n * @param prop The name of the property to be defined or modified.\r\n * @param getProp The getter function to wire against the getter.\r\n * @param setProp The setter function to wire against the setter.\r\n * @returns True if it was able to create the accessors otherwise false\r\n */\r\nexport function objDefineAccessors(target, prop, getProp, setProp) {\r\n    if (_objDefineProperty) {\r\n        try {\r\n            var descriptor = {\r\n                enumerable: true,\r\n                configurable: true\r\n            };\r\n            if (getProp) {\r\n                descriptor.get = getProp;\r\n            }\r\n            if (setProp) {\r\n                descriptor.set = setProp;\r\n            }\r\n            _objDefineProperty(target, prop, descriptor);\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            // IE8 Defines a defineProperty on Object but it's only supported for DOM elements so it will throw\r\n            // We will just ignore this here.\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction _doNothing(value) {\r\n    return value;\r\n}\r\nexport function deepFreeze(obj) {\r\n    if (_objFreeze) {\r\n        objForEachKey(obj, function (name, value) {\r\n            if (isArray(value) || isObject(value)) {\r\n                _objFreeze(value);\r\n            }\r\n        });\r\n    }\r\n    return objFreeze(obj);\r\n}\r\nexport var objFreeze = _objFreeze || _doNothing;\r\nexport var objSeal = _objSeal || _doNothing;\r\n/**\r\n * Return the current time via the Date now() function (if available) and falls back to (new Date()).getTime() if now() is unavailable (IE8 or less)\r\n * https://caniuse.com/#search=Date.now\r\n */\r\nexport function dateNow() {\r\n    var dt = Date;\r\n    return dt.now ? dt.now() : new dt().getTime();\r\n}\r\n/**\r\n * Returns the name of object if it's an Error. Otherwise, returns empty string.\r\n */\r\nexport function getExceptionName(object) {\r\n    if (isError(object)) {\r\n        return object[_DYN_NAME /* @min:%2ename */];\r\n    }\r\n    return STR_EMPTY;\r\n}\r\n/**\r\n * Sets the provided value on the target instance using the field name when the provided chk function returns true, the chk\r\n * function will only be called if the new value is no equal to the original value.\r\n * @param target - The target object\r\n * @param field - The key of the target\r\n * @param value - The value to set\r\n * @param valChk - [Optional] Callback to check the value that if supplied will be called check if the new value can be set\r\n * @param srcChk - [Optional] Callback to check to original value that if supplied will be called if the new value should be set (if allowed)\r\n * @returns The existing or new value, depending what was set\r\n */\r\nexport function setValue(target, field, value, valChk, srcChk) {\r\n    var theValue = value;\r\n    if (target) {\r\n        theValue = target[field];\r\n        if (theValue !== value && (!srcChk || srcChk(theValue)) && (!valChk || valChk(value))) {\r\n            theValue = value;\r\n            target[field] = theValue;\r\n        }\r\n    }\r\n    return theValue;\r\n}\r\n/**\r\n * Returns the current value from the target object if not null or undefined otherwise sets the new value and returns it\r\n * @param target - The target object to return or set the default value\r\n * @param field - The key for the field to set on the target\r\n * @param defValue - [Optional] The value to set if not already present, when not provided a empty object will be added\r\n */\r\nexport function getSetValue(target, field, defValue) {\r\n    var theValue;\r\n    if (target) {\r\n        theValue = target[field];\r\n        if (!theValue && isNullOrUndefined(theValue)) {\r\n            // Supports having the default as null\r\n            theValue = !isUndefined(defValue) ? defValue : {};\r\n            target[field] = theValue;\r\n        }\r\n    }\r\n    else {\r\n        // Expanded for performance so we only check defValue if required\r\n        theValue = !isUndefined(defValue) ? defValue : {};\r\n    }\r\n    return theValue;\r\n}\r\n/**\r\n * Get the mapped config value, if null or undefined any supplied defaultValue will be returned.\r\n * @param field - The name of the field as the named enum value (number) or the string name.\r\n * @param defaultValue - The default value to return if the config field is not present, null or undefined.\r\n */\r\nexport function getCfgValue(theValue, defaultValue) {\r\n    return !isNullOrUndefined(theValue) ? theValue : defaultValue;\r\n}\r\nexport function isNotTruthy(value) {\r\n    return !value;\r\n}\r\nexport function isTruthy(value) {\r\n    return !!value;\r\n}\r\nexport function throwError(message) {\r\n    throw new Error(message);\r\n}\r\nfunction _createProxyFunction(source, funcName) {\r\n    var srcFunc = null;\r\n    var src = null;\r\n    if (isFunction(source)) {\r\n        srcFunc = source;\r\n    }\r\n    else {\r\n        src = source;\r\n    }\r\n    return function () {\r\n        // Capture the original arguments passed to the method\r\n        var originalArguments = arguments;\r\n        if (srcFunc) {\r\n            src = srcFunc();\r\n        }\r\n        if (src) {\r\n            return src[funcName][_DYN_APPLY /* @min:%2eapply */](src, originalArguments);\r\n        }\r\n    };\r\n}\r\n/**\r\n * Effectively assigns all enumerable properties (not just own properties) and functions (including inherited prototype) from\r\n * the source object to the target, it attempts to use proxy getters / setters (if possible) and proxy functions to avoid potential\r\n * implementation issues by assigning prototype functions as instance ones\r\n *\r\n * This method is the primary method used to \"update\" the snippet proxy with the ultimate implementations.\r\n *\r\n * Special ES3 Notes:\r\n * Updates (setting) of direct property values on the target or indirectly on the source object WILL NOT WORK PROPERLY, updates to the\r\n * properties of \"referenced\" object will work (target.context.newValue = 10 => will be reflected in the source.context as it's the\r\n * same object). ES3 Failures: assigning target.myProp = 3 -> Won't change source.myProp = 3, likewise the reverse would also fail.\r\n * @param target - The target object to be assigned with the source properties and functions\r\n * @param source - The source object which will be assigned / called by setting / calling the targets proxies\r\n * @param chkSet - An optional callback to determine whether a specific property/function should be proxied\r\n */\r\nexport function proxyAssign(target, source, chkSet) {\r\n    if (target && source && isObject(target) && isObject(source)) {\r\n        var _loop_1 = function (field) {\r\n            if (isString(field)) {\r\n                var value = source[field];\r\n                if (isFunction(value)) {\r\n                    if (!chkSet || chkSet(field, true, source, target)) {\r\n                        // Create a proxy function rather than just copying the (possible) prototype to the new object as an instance function\r\n                        target[field] = _createProxyFunction(source, field);\r\n                    }\r\n                }\r\n                else if (!chkSet || chkSet(field, false, source, target)) {\r\n                    if (hasOwnProperty(target, field)) {\r\n                        // Remove any previous instance property\r\n                        delete target[field];\r\n                    }\r\n                    if (!objDefineAccessors(target, field, function () {\r\n                        return source[field];\r\n                    }, function (theValue) {\r\n                        source[field] = theValue;\r\n                    })) {\r\n                        // Unable to create an accessor, so just assign the values as a fallback\r\n                        // -- this will (mostly) work for objects\r\n                        // -- but will fail for accessing primitives (if the source changes it) and all types of \"setters\" as the source won't be modified\r\n                        target[field] = value;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        // effectively apply/proxy full source to the target instance\r\n        for (var field in source) {\r\n            _loop_1(field);\r\n        }\r\n    }\r\n    return target;\r\n}\r\n/**\r\n * Creates a proxy function on the target which internally will call the source version with all arguments passed to the target method.\r\n *\r\n * @param target - The target object to be assigned with the source properties and functions\r\n * @param name - The function name that will be added on the target\r\n * @param source - The source object which will be assigned / called by setting / calling the targets proxies\r\n * @param theFunc - The function name on the source that will be proxied on the target\r\n * @param overwriteTarget - If `false` this will not replace any pre-existing name otherwise (the default) it will overwrite any existing name\r\n */\r\nexport function proxyFunctionAs(target, name, source, theFunc, overwriteTarget) {\r\n    if (target && name && source) {\r\n        if (overwriteTarget !== false || isUndefined(target[name])) {\r\n            target[name] = _createProxyFunction(source, theFunc);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Creates proxy functions on the target which internally will call the source version with all arguments passed to the target method.\r\n *\r\n * @param target - The target object to be assigned with the source properties and functions\r\n * @param source - The source object which will be assigned / called by setting / calling the targets proxies\r\n * @param functionsToProxy - An array of function names that will be proxied on the target\r\n * @param overwriteTarget - If false this will not replace any pre-existing name otherwise (the default) it will overwrite any existing name\r\n */\r\nexport function proxyFunctions(target, source, functionsToProxy, overwriteTarget) {\r\n    if (target && source && isObject(target) && isArray(functionsToProxy)) {\r\n        arrForEach(functionsToProxy, function (theFuncName) {\r\n            if (isString(theFuncName)) {\r\n                proxyFunctionAs(target, theFuncName, source, theFuncName, overwriteTarget);\r\n            }\r\n        });\r\n    }\r\n    return target;\r\n}\r\n/**\r\n * Simpler helper to create a dynamic class that implements the interface and populates the values with the defaults.\r\n * Only instance properties (hasOwnProperty) values are copied from the defaults to the new instance\r\n * @param defaults Simple helper\r\n */\r\nexport function createClassFromInterface(defaults) {\r\n    return /** @class */ (function () {\r\n        function class_1() {\r\n            var _this_1 = this;\r\n            if (defaults) {\r\n                objForEachKey(defaults, function (field, value) {\r\n                    _this_1[field] = value;\r\n                });\r\n            }\r\n        }\r\n        return class_1;\r\n    }());\r\n}\r\n/**\r\n * A helper function to assist with JIT performance for objects that have properties added / removed dynamically\r\n * this is primarily for chromium based browsers and has limited effects on Firefox and none of IE. Only call this\r\n * function after you have finished \"updating\" the object, calling this within loops reduces or defeats the benefits.\r\n * This helps when iterating using for..in, objKeys() and objForEach()\r\n * @param theObject - The object to be optimized if possible\r\n */\r\nexport function optimizeObject(theObject) {\r\n    // V8 Optimization to cause the JIT compiler to create a new optimized object for looking up the own properties\r\n    // primarily for object with <= 19 properties for >= 20 the effect is reduced or non-existent\r\n    if (theObject && ObjAssign) {\r\n        theObject = ObjClass(ObjAssign({}, theObject));\r\n    }\r\n    return theObject;\r\n}\r\nexport function objExtend(obj1, obj2, obj3, obj4, obj5, obj6) {\r\n    // Variables\r\n    var theArgs = arguments;\r\n    var extended = theArgs[0] || {};\r\n    var argLen = theArgs[_DYN_LENGTH /* @min:%2elength */];\r\n    var deep = false;\r\n    var idx = 1;\r\n    // Check for \"Deep\" flag\r\n    if (argLen > 0 && isBoolean(extended)) {\r\n        deep = extended;\r\n        extended = theArgs[idx] || {};\r\n        idx++;\r\n    }\r\n    // Handle case when target is a string or something (possible in deep copy)\r\n    if (!isObject(extended)) {\r\n        extended = {};\r\n    }\r\n    // Loop through each remaining object and conduct a merge\r\n    for (; idx < argLen; idx++) {\r\n        var arg = theArgs[idx];\r\n        var isArgArray = isArray(arg);\r\n        var isArgObj = isObject(arg);\r\n        for (var prop in arg) {\r\n            var propOk = (isArgArray && (prop in arg)) || (isArgObj && (ObjHasOwnProperty[_DYN_CALL /* @min:%2ecall */](arg, prop)));\r\n            if (!propOk) {\r\n                continue;\r\n            }\r\n            var newValue = arg[prop];\r\n            var isNewArray = void 0;\r\n            // If deep merge and property is an object, merge properties\r\n            if (deep && newValue && ((isNewArray = isArray(newValue)) || isPlainObject(newValue))) {\r\n                // Grab the current value of the extended object\r\n                var clone = extended[prop];\r\n                if (isNewArray) {\r\n                    if (!isArray(clone)) {\r\n                        // We can't \"merge\" an array with a non-array so overwrite the original\r\n                        clone = [];\r\n                    }\r\n                }\r\n                else if (!isPlainObject(clone)) {\r\n                    // We can't \"merge\" an object with a non-object\r\n                    clone = {};\r\n                }\r\n                // Never move the original objects always clone them\r\n                newValue = objExtend(deep, clone, newValue);\r\n            }\r\n            // Assign the new (or previous) value (unless undefined)\r\n            if (newValue !== undefined) {\r\n                extended[prop] = newValue;\r\n            }\r\n        }\r\n    }\r\n    return extended;\r\n}\r\n//# sourceMappingURL=HelperFuncs.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { deepFreeze, objForEachKey } from \"../JavaScriptSDK/HelperFuncs\";\r\n/**\r\n * Create an enum style object which has both the key => value and value => key mappings\r\n * @param values - The values to populate on the new object\r\n * @returns\r\n */\r\nexport function createEnumStyle(values) {\r\n    var enumClass = {};\r\n    objForEachKey(values, function (field, value) {\r\n        enumClass[field] = value;\r\n        enumClass[value] = field;\r\n    });\r\n    return deepFreeze(enumClass);\r\n}\r\n/**\r\n * Create a 2 index map that maps an enum's key as both the key and value, X[\"key\"] => \"key\" and X[0] => \"keyof 0\".\r\n * @param values - The values to populate on the new object\r\n * @returns\r\n */\r\nexport function createEnumMap(values) {\r\n    var mapClass = {};\r\n    objForEachKey(values, function (field, value) {\r\n        mapClass[field] = field;\r\n        mapClass[value] = field;\r\n    });\r\n    return deepFreeze(mapClass);\r\n}\r\n/**\r\n * Create a 2 index map that maps an enum's key and value to the defined map value, X[\"key\"] => mapValue and X[0] => mapValue.\r\n * Generic values\r\n * - E = the const enum type (typeof eRequestHeaders);\r\n * - V = Identifies the valid values for the keys, this should include both the enum numeric and string key of the type. The\r\n * resulting \"Value\" of each entry identifies the valid values withing the assignments.\r\n * @param values - The values to populate on the new object\r\n * @returns\r\n */\r\nexport function createValueMap(values) {\r\n    var mapClass = {};\r\n    objForEachKey(values, function (field, value) {\r\n        mapClass[field] = value[1];\r\n        mapClass[value[0]] = value[1];\r\n    });\r\n    return deepFreeze(mapClass);\r\n}\r\n//# sourceMappingURL=EnumHelperFuncs.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { createEnumStyle } from \"../JavaScriptSDK.Enums/EnumHelperFuncs\";\r\n/**\r\n * The EventsDiscardedReason enumeration contains a set of values that specify the reason for discarding an event.\r\n */\r\nexport var EventsDiscardedReason = createEnumStyle({\r\n    /**\r\n     * Unknown.\r\n     */\r\n    Unknown: 0 /* eEventsDiscardedReason.Unknown */,\r\n    /**\r\n     * Status set to non-retryable.\r\n     */\r\n    NonRetryableStatus: 1 /* eEventsDiscardedReason.NonRetryableStatus */,\r\n    /**\r\n     * The event is invalid.\r\n     */\r\n    InvalidEvent: 2 /* eEventsDiscardedReason.InvalidEvent */,\r\n    /**\r\n     * The size of the event is too large.\r\n     */\r\n    SizeLimitExceeded: 3 /* eEventsDiscardedReason.SizeLimitExceeded */,\r\n    /**\r\n     * The server is not accepting events from this instrumentation key.\r\n     */\r\n    KillSwitch: 4 /* eEventsDiscardedReason.KillSwitch */,\r\n    /**\r\n     * The event queue is full.\r\n     */\r\n    QueueFull: 5 /* eEventsDiscardedReason.QueueFull */\r\n});\r\n//# sourceMappingURL=EventsDiscardedReason.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nvar _a;\r\n;\r\nvar UNDEFINED = \"undefined\";\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar Constructor = 'constructor';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar Prototype = 'prototype';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar strFunction = 'function';\r\n/**\r\n * Used to define the name of the instance function lookup table\r\n * @ignore\r\n */\r\nvar DynInstFuncTable = '_dynInstFuncs';\r\n/**\r\n * Name used to tag the dynamic prototype function\r\n * @ignore\r\n */\r\nvar DynProxyTag = '_isDynProxy';\r\n/**\r\n * Name added to a prototype to define the dynamic prototype \"class\" name used to lookup the function table\r\n * @ignore\r\n */\r\nvar DynClassName = '_dynClass';\r\n/**\r\n * Prefix added to the classname to avoid any name clashes with other instance level properties\r\n * @ignore\r\n */\r\nvar DynClassNamePrefix = '_dynCls$';\r\n/**\r\n * A tag which is used to check if we have already to attempted to set the instance function if one is not present\r\n * @ignore\r\n */\r\nvar DynInstChkTag = '_dynInstChk';\r\n/**\r\n * A tag which is used to check if we are allows to try and set an instance function is one is not present. Using the same\r\n * tag name as the function level but a different const name for readability only.\r\n */\r\nvar DynAllowInstChkTag = DynInstChkTag;\r\n/**\r\n * The global (imported) instances where the global performance options are stored\r\n */\r\nvar DynProtoDefaultOptions = '_dfOpts';\r\n/**\r\n * Value used as the name of a class when it cannot be determined\r\n * @ignore\r\n */\r\nvar UnknownValue = '_unknown_';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar str__Proto = \"__proto__\";\r\n/**\r\n * The polyfill version of __proto__ so that it doesn't cause issues for anyone not expecting it to exist\r\n */\r\nvar DynProtoBaseProto = \"_dyn\" + str__Proto;\r\n/**\r\n * Runtime Global holder for dynamicProto settings\r\n */\r\nvar DynProtoGlobalSettings = \"__dynProto$Gbl\";\r\n/**\r\n * Track the current prototype for IE8 as you can't look back to get the prototype\r\n */\r\nvar DynProtoCurrent = \"_dynInstProto\";\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar strUseBaseInst = 'useBaseInst';\r\n/**\r\n * Constant string defined to support minimization\r\n * @ignore\r\n */\r\nvar strSetInstFuncs = 'setInstFuncs';\r\nvar Obj = Object;\r\n/**\r\n * Pre-lookup to check if we are running on a modern browser (i.e. not IE8)\r\n * @ignore\r\n */\r\nvar _objGetPrototypeOf = Obj[\"getPrototypeOf\"];\r\n/**\r\n * Pre-lookup to check for the existence of this function\r\n */\r\nvar _objGetOwnProps = Obj[\"getOwnPropertyNames\"];\r\n/**\r\n * Gets the runtime global reference\r\n * @returns\r\n */\r\nfunction _getGlobal() {\r\n    var result;\r\n    if (typeof globalThis !== UNDEFINED) {\r\n        result = globalThis;\r\n    }\r\n    if (!result && typeof self !== UNDEFINED) {\r\n        result = self;\r\n    }\r\n    if (!result && typeof window !== UNDEFINED) {\r\n        result = window;\r\n    }\r\n    if (!result && typeof global !== UNDEFINED) {\r\n        result = global;\r\n    }\r\n    return result || {};\r\n}\r\n// Since 1.1.7 moving these to the runtime global to work around mixed version and module issues\r\n// See Issue https://github.com/microsoft/DynamicProto-JS/issues/57 for details\r\nvar _gbl = _getGlobal();\r\nvar _gblInst = _gbl[DynProtoGlobalSettings] || (_gbl[DynProtoGlobalSettings] = {\r\n    o: (_a = {},\r\n        _a[strSetInstFuncs] = true,\r\n        _a[strUseBaseInst] = true,\r\n        _a),\r\n    n: 1000 // Start new global index @ 1000 so we \"fix\" some cases when mixed with 1.1.6 or earlier\r\n});\r\n/**\r\n * Helper to check if the object contains a property of the name\r\n * @ignore\r\n */\r\nfunction _hasOwnProperty(obj, prop) {\r\n    return obj && Obj[Prototype].hasOwnProperty.call(obj, prop);\r\n}\r\n/**\r\n * Helper used to check whether the target is an Object prototype or Array prototype\r\n * @ignore\r\n */\r\nfunction _isObjectOrArrayPrototype(target) {\r\n    return target && (target === Obj[Prototype] || target === Array[Prototype]);\r\n}\r\n/**\r\n * Helper used to check whether the target is an Object prototype, Array prototype or Function prototype\r\n * @ignore\r\n */\r\nfunction _isObjectArrayOrFunctionPrototype(target) {\r\n    return _isObjectOrArrayPrototype(target) || target === Function[Prototype];\r\n}\r\n/**\r\n * Helper used to get the prototype of the target object as getPrototypeOf is not available in an ES3 environment.\r\n * @ignore\r\n */\r\nfunction _getObjProto(target) {\r\n    var newProto;\r\n    if (target) {\r\n        // This method doesn't exist in older browsers (e.g. IE8)\r\n        if (_objGetPrototypeOf) {\r\n            return _objGetPrototypeOf(target);\r\n        }\r\n        var curProto = target[str__Proto] || target[Prototype] || (target[Constructor] ? target[Constructor][Prototype] : null);\r\n        // Using the pre-calculated value as IE8 doesn't support looking up the prototype of a prototype and thus fails for more than 1 base class\r\n        newProto = target[DynProtoBaseProto] || curProto;\r\n        if (!_hasOwnProperty(target, DynProtoBaseProto)) {\r\n            // As this prototype doesn't have this property then this is from an inherited class so newProto is the base to return so save it\r\n            // so we can look it up value (which for a multiple hierarchy dynamicProto will be the base class)\r\n            delete target[DynProtoCurrent]; // Delete any current value allocated to this instance so we pick up the value from prototype hierarchy\r\n            newProto = target[DynProtoBaseProto] = target[DynProtoCurrent] || target[DynProtoBaseProto];\r\n            target[DynProtoCurrent] = curProto;\r\n        }\r\n    }\r\n    return newProto;\r\n}\r\n/**\r\n * Helper to get the properties of an object, including none enumerable ones as functions on a prototype in ES6\r\n * are not enumerable.\r\n * @param target\r\n */\r\nfunction _forEachProp(target, func) {\r\n    var props = [];\r\n    if (_objGetOwnProps) {\r\n        props = _objGetOwnProps(target);\r\n    }\r\n    else {\r\n        for (var name_1 in target) {\r\n            if (typeof name_1 === \"string\" && _hasOwnProperty(target, name_1)) {\r\n                props.push(name_1);\r\n            }\r\n        }\r\n    }\r\n    if (props && props.length > 0) {\r\n        for (var lp = 0; lp < props.length; lp++) {\r\n            func(props[lp]);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Helper function to check whether the provided function name is a potential candidate for dynamic\r\n * callback and prototype generation.\r\n * @param target The target object, may be a prototype or class object\r\n * @param funcName The function name\r\n * @param skipOwn Skips the check for own property\r\n * @ignore\r\n */\r\nfunction _isDynamicCandidate(target, funcName, skipOwn) {\r\n    return (funcName !== Constructor && typeof target[funcName] === strFunction && (skipOwn || _hasOwnProperty(target, funcName)) && funcName !== str__Proto && funcName !== Prototype);\r\n}\r\n/**\r\n * Helper to throw a TypeError exception\r\n * @param message the message\r\n * @ignore\r\n */\r\nfunction _throwTypeError(message) {\r\n    throw new TypeError(\"DynamicProto: \" + message);\r\n}\r\nfunction _newObject() {\r\n    return Object.create ? Object.create(null) : {};\r\n}\r\n/**\r\n * Returns a collection of the instance functions that are defined directly on the thisTarget object, it does\r\n * not return any inherited functions\r\n * @param thisTarget The object to get the instance functions from\r\n * @ignore\r\n */\r\nfunction _getInstanceFuncs(thisTarget) {\r\n    // Get the base proto\r\n    var instFuncs = _newObject();\r\n    // Save any existing instance functions\r\n    _forEachProp(thisTarget, function (name) {\r\n        // Don't include any dynamic prototype instances - as we only want the real functions\r\n        if (!instFuncs[name] && _isDynamicCandidate(thisTarget, name, false)) {\r\n            // Create an instance callback for passing the base function to the caller\r\n            instFuncs[name] = thisTarget[name];\r\n        }\r\n    });\r\n    return instFuncs;\r\n}\r\n/**\r\n * Returns whether the value is included in the array\r\n * @param values The array of values\r\n * @param value  The value\r\n */\r\nfunction _hasVisited(values, value) {\r\n    for (var lp = values.length - 1; lp >= 0; lp--) {\r\n        if (values[lp] === value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Returns an object that contains callback functions for all \"base/super\" functions, this is used to \"save\"\r\n * enabling calling super.xxx() functions without requiring that the base \"class\" has defined a prototype references\r\n * @param target The current instance\r\n * @ignore\r\n */\r\nfunction _getBaseFuncs(classProto, thisTarget, instFuncs, useBaseInst) {\r\n    function _instFuncProxy(target, funcHost, funcName) {\r\n        var theFunc = funcHost[funcName];\r\n        if (theFunc[DynProxyTag] && useBaseInst) {\r\n            // grab and reuse the hosted looking function (if available) otherwise the original passed function\r\n            var instFuncTable = target[DynInstFuncTable] || {};\r\n            if (instFuncTable[DynAllowInstChkTag] !== false) {\r\n                theFunc = (instFuncTable[funcHost[DynClassName]] || {})[funcName] || theFunc;\r\n            }\r\n        }\r\n        return function () {\r\n            // eslint-disable-next-line prefer-rest-params\r\n            return theFunc.apply(target, arguments);\r\n        };\r\n    }\r\n    // Start creating a new baseFuncs by creating proxies for the instance functions (as they may get replaced)\r\n    var baseFuncs = _newObject();\r\n    _forEachProp(instFuncs, function (name) {\r\n        // Create an instance callback for passing the base function to the caller\r\n        baseFuncs[name] = _instFuncProxy(thisTarget, instFuncs, name);\r\n    });\r\n    // Get the base prototype functions\r\n    var baseProto = _getObjProto(classProto);\r\n    var visited = [];\r\n    // Don't include base object functions for Object, Array or Function\r\n    while (baseProto && !_isObjectArrayOrFunctionPrototype(baseProto) && !_hasVisited(visited, baseProto)) {\r\n        // look for prototype functions\r\n        _forEachProp(baseProto, function (name) {\r\n            // Don't include any dynamic prototype instances - as we only want the real functions\r\n            // For IE 7/8 the prototype lookup doesn't provide the full chain so we need to bypass the \r\n            // hasOwnProperty check we get all of the methods, main difference is that IE7/8 doesn't return\r\n            // the Object prototype methods while bypassing the check\r\n            if (!baseFuncs[name] && _isDynamicCandidate(baseProto, name, !_objGetPrototypeOf)) {\r\n                // Create an instance callback for passing the base function to the caller\r\n                baseFuncs[name] = _instFuncProxy(thisTarget, baseProto, name);\r\n            }\r\n        });\r\n        // We need to find all possible functions that might be overloaded by walking the entire prototype chain\r\n        // This avoids the caller from needing to check whether it's direct base class implements the function or not\r\n        // by walking the entire chain it simplifies the usage and issues from upgrading any of the base classes.\r\n        visited.push(baseProto);\r\n        baseProto = _getObjProto(baseProto);\r\n    }\r\n    return baseFuncs;\r\n}\r\nfunction _getInstFunc(target, funcName, proto, currentDynProtoProxy) {\r\n    var instFunc = null;\r\n    // We need to check whether the class name is defined directly on this prototype otherwise\r\n    // it will walk the proto chain and return any parent proto classname.\r\n    if (target && _hasOwnProperty(proto, DynClassName)) {\r\n        var instFuncTable = target[DynInstFuncTable] || _newObject();\r\n        instFunc = (instFuncTable[proto[DynClassName]] || _newObject())[funcName];\r\n        if (!instFunc) {\r\n            // Avoid stack overflow from recursive calling the same function\r\n            _throwTypeError(\"Missing [\" + funcName + \"] \" + strFunction);\r\n        }\r\n        // We have the instance function, lets check it we can speed up further calls\r\n        // by adding the instance function back directly on the instance (avoiding the dynamic func lookup)\r\n        if (!instFunc[DynInstChkTag] && instFuncTable[DynAllowInstChkTag] !== false) {\r\n            // If the instance already has an instance function we can't replace it\r\n            var canAddInst = !_hasOwnProperty(target, funcName);\r\n            // Get current prototype\r\n            var objProto = _getObjProto(target);\r\n            var visited = [];\r\n            // Lookup the function starting at the top (instance level prototype) and traverse down, if the first matching function\r\n            // if nothing is found or if the first hit is a dynamic proto instance then we can safely add an instance shortcut\r\n            while (canAddInst && objProto && !_isObjectArrayOrFunctionPrototype(objProto) && !_hasVisited(visited, objProto)) {\r\n                var protoFunc = objProto[funcName];\r\n                if (protoFunc) {\r\n                    canAddInst = (protoFunc === currentDynProtoProxy);\r\n                    break;\r\n                }\r\n                // We need to find all possible initial functions to ensure that we don't bypass a valid override function\r\n                visited.push(objProto);\r\n                objProto = _getObjProto(objProto);\r\n            }\r\n            try {\r\n                if (canAddInst) {\r\n                    // This instance doesn't have an instance func and the class hierarchy does have a higher level prototype version\r\n                    // so it's safe to directly assign for any subsequent calls (for better performance)\r\n                    target[funcName] = instFunc;\r\n                }\r\n                // Block further attempts to set the instance function for any\r\n                instFunc[DynInstChkTag] = 1;\r\n            }\r\n            catch (e) {\r\n                // Don't crash if the object is readonly or the runtime doesn't allow changing this\r\n                // And set a flag so we don't try again for any function\r\n                instFuncTable[DynAllowInstChkTag] = false;\r\n            }\r\n        }\r\n    }\r\n    return instFunc;\r\n}\r\nfunction _getProtoFunc(funcName, proto, currentDynProtoProxy) {\r\n    var protoFunc = proto[funcName];\r\n    // Check that the prototype function is not a self reference -- try to avoid stack overflow!\r\n    if (protoFunc === currentDynProtoProxy) {\r\n        // It is so lookup the base prototype\r\n        protoFunc = _getObjProto(proto)[funcName];\r\n    }\r\n    if (typeof protoFunc !== strFunction) {\r\n        _throwTypeError(\"[\" + funcName + \"] is not a \" + strFunction);\r\n    }\r\n    return protoFunc;\r\n}\r\n/**\r\n * Add the required dynamic prototype methods to the the class prototype\r\n * @param proto - The class prototype\r\n * @param className - The instance classname\r\n * @param target - The target instance\r\n * @param baseInstFuncs - The base instance functions\r\n * @param setInstanceFunc - Flag to allow prototype function to reset the instance function if one does not exist\r\n * @ignore\r\n */\r\nfunction _populatePrototype(proto, className, target, baseInstFuncs, setInstanceFunc) {\r\n    function _createDynamicPrototype(proto, funcName) {\r\n        var dynProtoProxy = function () {\r\n            // Use the instance or prototype function\r\n            var instFunc = _getInstFunc(this, funcName, proto, dynProtoProxy) || _getProtoFunc(funcName, proto, dynProtoProxy);\r\n            // eslint-disable-next-line prefer-rest-params\r\n            return instFunc.apply(this, arguments);\r\n        };\r\n        // Tag this function as a proxy to support replacing dynamic proxy elements (primary use case is for unit testing\r\n        // via which can dynamically replace the prototype function reference)\r\n        dynProtoProxy[DynProxyTag] = 1;\r\n        return dynProtoProxy;\r\n    }\r\n    if (!_isObjectOrArrayPrototype(proto)) {\r\n        var instFuncTable = target[DynInstFuncTable] = target[DynInstFuncTable] || _newObject();\r\n        if (!_isObjectOrArrayPrototype(instFuncTable)) {\r\n            var instFuncs_1 = instFuncTable[className] = (instFuncTable[className] || _newObject()); // fetch and assign if as it may not exist yet\r\n            // Set whether we are allow to lookup instances, if someone has set to false then do not re-enable\r\n            if (instFuncTable[DynAllowInstChkTag] !== false) {\r\n                instFuncTable[DynAllowInstChkTag] = !!setInstanceFunc;\r\n            }\r\n            if (!_isObjectOrArrayPrototype(instFuncs_1)) {\r\n                _forEachProp(target, function (name) {\r\n                    // Only add overridden functions\r\n                    if (_isDynamicCandidate(target, name, false) && target[name] !== baseInstFuncs[name]) {\r\n                        // Save the instance Function to the lookup table and remove it from the instance as it's not a dynamic proto function\r\n                        instFuncs_1[name] = target[name];\r\n                        delete target[name];\r\n                        // Add a dynamic proto if one doesn't exist or if a prototype function exists and it's not a dynamic one\r\n                        if (!_hasOwnProperty(proto, name) || (proto[name] && !proto[name][DynProxyTag])) {\r\n                            proto[name] = _createDynamicPrototype(proto, name);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * Checks whether the passed prototype object appears to be correct by walking the prototype hierarchy of the instance\r\n * @param classProto The class prototype instance\r\n * @param thisTarget The current instance that will be checked whether the passed prototype instance is in the hierarchy\r\n * @ignore\r\n */\r\nfunction _checkPrototype(classProto, thisTarget) {\r\n    // This method doesn't existing in older browsers (e.g. IE8)\r\n    if (_objGetPrototypeOf) {\r\n        // As this is primarily a coding time check, don't bother checking if running in IE8 or lower\r\n        var visited = [];\r\n        var thisProto = _getObjProto(thisTarget);\r\n        while (thisProto && !_isObjectArrayOrFunctionPrototype(thisProto) && !_hasVisited(visited, thisProto)) {\r\n            if (thisProto === classProto) {\r\n                return true;\r\n            }\r\n            // This avoids the caller from needing to check whether it's direct base class implements the function or not\r\n            // by walking the entire chain it simplifies the usage and issues from upgrading any of the base classes.\r\n            visited.push(thisProto);\r\n            thisProto = _getObjProto(thisProto);\r\n        }\r\n        return false;\r\n    }\r\n    // If objGetPrototypeOf doesn't exist then just assume everything is ok.\r\n    return true;\r\n}\r\n/**\r\n * Gets the current prototype name using the ES6 name if available otherwise falling back to a use unknown as the name.\r\n * It's not critical for this to return a name, it's used to decorate the generated unique name for easier debugging only.\r\n * @param target\r\n * @param unknownValue\r\n * @ignore\r\n */\r\nfunction _getObjName(target, unknownValue) {\r\n    if (_hasOwnProperty(target, Prototype)) {\r\n        // Look like a prototype\r\n        return target.name || unknownValue || UnknownValue;\r\n    }\r\n    return (((target || {})[Constructor]) || {}).name || unknownValue || UnknownValue;\r\n}\r\n/**\r\n * Helper function when creating dynamic (inline) functions for classes, this helper performs the following tasks :-\r\n * - Saves references to all defined base class functions\r\n * - Calls the delegateFunc with the current target (this) and a base object reference that can be used to call all \"super\" functions.\r\n * - Will populate the class prototype for all overridden functions to support class extension that call the prototype instance.\r\n * Callers should use this helper when declaring all function within the constructor of a class, as mentioned above the delegateFunc is\r\n * passed both the target \"this\" and an object that can be used to call any base (super) functions, using this based object in place of\r\n * super.XXX() (which gets expanded to _super.prototype.XXX()) provides a better minification outcome and also ensures the correct \"this\"\r\n * context is maintained as TypeScript creates incorrect references using super.XXXX() for dynamically defined functions i.e. Functions\r\n * defined in the constructor or some other function (rather than declared as complete typescript functions).\r\n * ### Usage\r\n * ```typescript\r\n * import dynamicProto from \"@microsoft/dynamicproto-js\";\r\n * class ExampleClass extends BaseClass {\r\n *     constructor() {\r\n *         dynamicProto(ExampleClass, this, (_self, base) => {\r\n *             // This will define a function that will be converted to a prototype function\r\n *             _self.newFunc = () => {\r\n *                 // Access any \"this\" instance property\r\n *                 if (_self.someProperty) {\r\n *                     ...\r\n *                 }\r\n *             }\r\n *             // This will define a function that will be converted to a prototype function\r\n *             _self.myFunction = () => {\r\n *                 // Access any \"this\" instance property\r\n *                 if (_self.someProperty) {\r\n *                     // Call the base version of the function that we are overriding\r\n *                     base.myFunction();\r\n *                 }\r\n *                 ...\r\n *             }\r\n *             _self.initialize = () => {\r\n *                 ...\r\n *             }\r\n *             // Warnings: While the following will work as _self is simply a reference to\r\n *             // this, if anyone overrides myFunction() the overridden will be called first\r\n *             // as the normal JavaScript method resolution will occur and the defined\r\n *             // _self.initialize() function is actually gets removed from the instance and\r\n *             // a proxy prototype version is created to reference the created method.\r\n *             _self.initialize();\r\n *         });\r\n *     }\r\n * }\r\n * ```\r\n * @typeparam DPType This is the generic type of the class, used to keep intellisense valid\r\n * @typeparam DPCls The type that contains the prototype of the current class\r\n * @param theClass - This is the current class instance which contains the prototype for the current class\r\n * @param target - The current \"this\" (target) reference, when the class has been extended this.prototype will not be the 'theClass' value.\r\n * @param delegateFunc - The callback function (closure) that will create the dynamic function\r\n * @param options - Additional options to configure how the dynamic prototype operates\r\n */\r\nexport default function dynamicProto(theClass, target, delegateFunc, options) {\r\n    // Make sure that the passed theClass argument looks correct\r\n    if (!_hasOwnProperty(theClass, Prototype)) {\r\n        _throwTypeError(\"theClass is an invalid class definition.\");\r\n    }\r\n    // Quick check to make sure that the passed theClass argument looks correct (this is a common copy/paste error)\r\n    var classProto = theClass[Prototype];\r\n    if (!_checkPrototype(classProto, target)) {\r\n        _throwTypeError(\"[\" + _getObjName(theClass) + \"] not in hierarchy of [\" + _getObjName(target) + \"]\");\r\n    }\r\n    var className = null;\r\n    if (_hasOwnProperty(classProto, DynClassName)) {\r\n        // Only grab the class name if it's defined on this prototype (i.e. don't walk the prototype chain)\r\n        className = classProto[DynClassName];\r\n    }\r\n    else {\r\n        // As not all browser support name on the prototype creating a unique dynamic one if we have not already\r\n        // assigned one, so we can use a simple string as the lookup rather than an object for the dynamic instance\r\n        // function table lookup.\r\n        className = DynClassNamePrefix + _getObjName(theClass, \"_\") + \"$\" + _gblInst.n;\r\n        _gblInst.n++;\r\n        classProto[DynClassName] = className;\r\n    }\r\n    var perfOptions = dynamicProto[DynProtoDefaultOptions];\r\n    var useBaseInst = !!perfOptions[strUseBaseInst];\r\n    if (useBaseInst && options && options[strUseBaseInst] !== undefined) {\r\n        useBaseInst = !!options[strUseBaseInst];\r\n    }\r\n    // Get the current instance functions\r\n    var instFuncs = _getInstanceFuncs(target);\r\n    // Get all of the functions for any base instance (before they are potentially overridden)\r\n    var baseFuncs = _getBaseFuncs(classProto, target, instFuncs, useBaseInst);\r\n    // Execute the delegate passing in both the current target \"this\" and \"base\" function references\r\n    // Note casting the same type as we don't actually have the base class here and this will provide some intellisense support\r\n    delegateFunc(target, baseFuncs);\r\n    // Don't allow setting instance functions for older IE instances\r\n    var setInstanceFunc = !!_objGetPrototypeOf && !!perfOptions[strSetInstFuncs];\r\n    if (setInstanceFunc && options) {\r\n        setInstanceFunc = !!options[strSetInstFuncs];\r\n    }\r\n    // Populate the Prototype for any overridden instance functions\r\n    _populatePrototype(classProto, className, target, instFuncs, setInstanceFunc !== false);\r\n}\r\n/**\r\n * Exposes the default global options to allow global configuration, if the global values are disabled these will override\r\n * any passed values. This is primarily exposed to support unit-testing without the need for individual classes to expose\r\n * their internal usage of dynamic proto.\r\n */\r\ndynamicProto[DynProtoDefaultOptions] = _gblInst.o;\r\n//# sourceMappingURL=DynamicProto.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport { getGlobal, strShimObject, strShimPrototype, strShimUndefined } from \"@microsoft/applicationinsights-shims\";\r\nimport { _DYN_CALL, _DYN_INDEX_OF, _DYN_LENGTH, _DYN_NAME, _DYN_SPLIT, _DYN_TO_LOWER_CASE, _DYN_USER_AGENT } from \"../__DynamicConstants\";\r\nimport { isFunction, isString, isUndefined, strContains } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n/**\r\n * This file exists to hold environment utilities that are required to check and\r\n * validate the current operating environment. Unless otherwise required, please\r\n * only use defined methods (functions) in this class so that users of these\r\n * functions/properties only need to include those that are used within their own modules.\r\n */\r\nvar strWindow = \"window\";\r\nvar strDocument = \"document\";\r\nvar strDocumentMode = \"documentMode\";\r\nvar strNavigator = \"navigator\";\r\nvar strHistory = \"history\";\r\nvar strLocation = \"location\";\r\nvar strConsole = \"console\";\r\nvar strPerformance = \"performance\";\r\nvar strJSON = \"JSON\";\r\nvar strCrypto = \"crypto\";\r\nvar strMsCrypto = \"msCrypto\";\r\nvar strReactNative = \"ReactNative\";\r\nvar strMsie = \"msie\";\r\nvar strTrident = \"trident/\";\r\nvar strXMLHttpRequest = \"XMLHttpRequest\";\r\nvar _isTrident = null;\r\nvar _navUserAgentCheck = null;\r\nvar _enableMocks = false;\r\nvar _useXDomainRequest = null;\r\nvar _beaconsSupported = null;\r\nfunction _hasProperty(theClass, property) {\r\n    var supported = false;\r\n    if (theClass) {\r\n        try {\r\n            supported = property in theClass;\r\n            if (!supported) {\r\n                var proto = theClass[strShimPrototype];\r\n                if (proto) {\r\n                    supported = property in proto;\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Do Nothing\r\n        }\r\n        if (!supported) {\r\n            try {\r\n                var tmp = new theClass();\r\n                supported = !isUndefined(tmp[property]);\r\n            }\r\n            catch (e) {\r\n                // Do Nothing\r\n            }\r\n        }\r\n    }\r\n    return supported;\r\n}\r\n/**\r\n * Enable the lookup of test mock objects if requested\r\n * @param enabled\r\n */\r\nexport function setEnableEnvMocks(enabled) {\r\n    _enableMocks = enabled;\r\n}\r\n/**\r\n * Return the named global object if available, will return null if the object is not available.\r\n * @param name The globally named object\r\n */\r\nexport function getGlobalInst(name) {\r\n    var gbl = getGlobal();\r\n    if (gbl && gbl[name]) {\r\n        return gbl[name];\r\n    }\r\n    // Test workaround, for environments where <global>.window (when global == window) doesn't return the base window\r\n    if (name === strWindow && hasWindow()) {\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        return window;\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Checks if window object is available, this is required as we support the API running without a\r\n * window /document (eg. Node server, electron webworkers) and if we attempt to assign a window\r\n * object to a local variable or pass as an argument an \"Uncaught ReferenceError: window is not defined\"\r\n * exception will be thrown.\r\n * Defined as a function to support lazy / late binding environments.\r\n */\r\nexport function hasWindow() {\r\n    return Boolean(typeof window === strShimObject && window);\r\n}\r\n/**\r\n * Returns the global window object if it is present otherwise null.\r\n * This helper is used to access the window object without causing an exception\r\n * \"Uncaught ReferenceError: window is not defined\"\r\n */\r\nexport function getWindow() {\r\n    if (hasWindow()) {\r\n        return window;\r\n    }\r\n    // Return the global instance or null\r\n    return getGlobalInst(strWindow);\r\n}\r\n/**\r\n * Checks if document object is available, this is required as we support the API running without a\r\n * window /document (eg. Node server, electron webworkers) and if we attempt to assign a document\r\n * object to a local variable or pass as an argument an \"Uncaught ReferenceError: document is not defined\"\r\n * exception will be thrown.\r\n * Defined as a function to support lazy / late binding environments.\r\n */\r\nexport function hasDocument() {\r\n    return Boolean(typeof document === strShimObject && document);\r\n}\r\n/**\r\n * Returns the global document object if it is present otherwise null.\r\n * This helper is used to access the document object without causing an exception\r\n * \"Uncaught ReferenceError: document is not defined\"\r\n */\r\nexport function getDocument() {\r\n    if (hasDocument()) {\r\n        return document;\r\n    }\r\n    return getGlobalInst(strDocument);\r\n}\r\n/**\r\n * Checks if navigator object is available, this is required as we support the API running without a\r\n * window /document (eg. Node server, electron webworkers) and if we attempt to assign a navigator\r\n * object to a local variable or pass as an argument an \"Uncaught ReferenceError: navigator is not defined\"\r\n * exception will be thrown.\r\n * Defined as a function to support lazy / late binding environments.\r\n */\r\nexport function hasNavigator() {\r\n    return Boolean(typeof navigator === strShimObject && navigator);\r\n}\r\n/**\r\n * Returns the global navigator object if it is present otherwise null.\r\n * This helper is used to access the navigator object without causing an exception\r\n * \"Uncaught ReferenceError: navigator is not defined\"\r\n */\r\nexport function getNavigator() {\r\n    if (hasNavigator()) {\r\n        return navigator;\r\n    }\r\n    return getGlobalInst(strNavigator);\r\n}\r\n/**\r\n * Checks if history object is available, this is required as we support the API running without a\r\n * window /document (eg. Node server, electron webworkers) and if we attempt to assign a history\r\n * object to a local variable or pass as an argument an \"Uncaught ReferenceError: history is not defined\"\r\n * exception will be thrown.\r\n * Defined as a function to support lazy / late binding environments.\r\n */\r\nexport function hasHistory() {\r\n    return Boolean(typeof history === strShimObject && history);\r\n}\r\n/**\r\n * Returns the global history object if it is present otherwise null.\r\n * This helper is used to access the history object without causing an exception\r\n * \"Uncaught ReferenceError: history is not defined\"\r\n */\r\nexport function getHistory() {\r\n    if (hasHistory()) {\r\n        return history;\r\n    }\r\n    return getGlobalInst(strHistory);\r\n}\r\n/**\r\n * Returns the global location object if it is present otherwise null.\r\n * This helper is used to access the location object without causing an exception\r\n * \"Uncaught ReferenceError: location is not defined\"\r\n */\r\nexport function getLocation(checkForMock) {\r\n    if (checkForMock && _enableMocks) {\r\n        var mockLocation = getGlobalInst(\"__mockLocation\");\r\n        if (mockLocation) {\r\n            return mockLocation;\r\n        }\r\n    }\r\n    if (typeof location === strShimObject && location) {\r\n        return location;\r\n    }\r\n    return getGlobalInst(strLocation);\r\n}\r\n/**\r\n * Returns the global console object\r\n */\r\nexport function getConsole() {\r\n    if (typeof console !== strShimUndefined) {\r\n        return console;\r\n    }\r\n    return getGlobalInst(strConsole);\r\n}\r\n/**\r\n * Returns the performance object if it is present otherwise null.\r\n * This helper is used to access the performance object from the current\r\n * global instance which could be window or globalThis for a web worker\r\n */\r\nexport function getPerformance() {\r\n    return getGlobalInst(strPerformance);\r\n}\r\n/**\r\n * Checks if JSON object is available, this is required as we support the API running without a\r\n * window /document (eg. Node server, electron webworkers) and if we attempt to assign a history\r\n * object to a local variable or pass as an argument an \"Uncaught ReferenceError: JSON is not defined\"\r\n * exception will be thrown.\r\n * Defined as a function to support lazy / late binding environments.\r\n */\r\nexport function hasJSON() {\r\n    return Boolean((typeof JSON === strShimObject && JSON) || getGlobalInst(strJSON) !== null);\r\n}\r\n/**\r\n * Returns the global JSON object if it is present otherwise null.\r\n * This helper is used to access the JSON object without causing an exception\r\n * \"Uncaught ReferenceError: JSON is not defined\"\r\n */\r\nexport function getJSON() {\r\n    if (hasJSON()) {\r\n        return JSON || getGlobalInst(strJSON);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Returns the crypto object if it is present otherwise null.\r\n * This helper is used to access the crypto object from the current\r\n * global instance which could be window or globalThis for a web worker\r\n */\r\nexport function getCrypto() {\r\n    return getGlobalInst(strCrypto);\r\n}\r\n/**\r\n * Returns the crypto object if it is present otherwise null.\r\n * This helper is used to access the crypto object from the current\r\n * global instance which could be window or globalThis for a web worker\r\n */\r\nexport function getMsCrypto() {\r\n    return getGlobalInst(strMsCrypto);\r\n}\r\n/**\r\n * Returns whether the environment is reporting that we are running in a React Native Environment\r\n */\r\nexport function isReactNative() {\r\n    // If running in React Native, navigator.product will be populated\r\n    var nav = getNavigator();\r\n    if (nav && nav.product) {\r\n        return nav.product === strReactNative;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Identifies whether the current environment appears to be IE\r\n */\r\nexport function isIE() {\r\n    var nav = getNavigator();\r\n    if (nav && (nav[_DYN_USER_AGENT /* @min:%2euserAgent */] !== _navUserAgentCheck || _isTrident === null)) {\r\n        // Added to support test mocking of the user agent\r\n        _navUserAgentCheck = nav[_DYN_USER_AGENT /* @min:%2euserAgent */];\r\n        var userAgent = (_navUserAgentCheck || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n        _isTrident = (strContains(userAgent, strMsie) || strContains(userAgent, strTrident));\r\n    }\r\n    return _isTrident;\r\n}\r\n/**\r\n * Gets IE version returning the document emulation mode if we are running on IE, or null otherwise\r\n */\r\nexport function getIEVersion(userAgentStr) {\r\n    if (userAgentStr === void 0) { userAgentStr = null; }\r\n    if (!userAgentStr) {\r\n        var navigator_1 = getNavigator() || {};\r\n        userAgentStr = navigator_1 ? (navigator_1[_DYN_USER_AGENT /* @min:%2euserAgent */] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() : STR_EMPTY;\r\n    }\r\n    var ua = (userAgentStr || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n    // Also check for documentMode in case X-UA-Compatible meta tag was included in HTML.\r\n    if (strContains(ua, strMsie)) {\r\n        var doc = getDocument() || {};\r\n        return Math.max(parseInt(ua[_DYN_SPLIT /* @min:%2esplit */](strMsie)[1]), (doc[strDocumentMode] || 0));\r\n    }\r\n    else if (strContains(ua, strTrident)) {\r\n        var tridentVer = parseInt(ua[_DYN_SPLIT /* @min:%2esplit */](strTrident)[1]);\r\n        if (tridentVer) {\r\n            return tridentVer + 4;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Returns string representation of an object suitable for diagnostics logging.\r\n */\r\nexport function dumpObj(object) {\r\n    var objectTypeDump = Object[strShimPrototype].toString[_DYN_CALL /* @min:%2ecall */](object);\r\n    var propertyValueDump = STR_EMPTY;\r\n    if (objectTypeDump === \"[object Error]\") {\r\n        propertyValueDump = \"{ stack: '\" + object.stack + \"', message: '\" + object.message + \"', name: '\" + object[_DYN_NAME /* @min:%2ename */] + \"'\";\r\n    }\r\n    else if (hasJSON()) {\r\n        propertyValueDump = getJSON().stringify(object);\r\n    }\r\n    return objectTypeDump + propertyValueDump;\r\n}\r\nexport function isSafari(userAgentStr) {\r\n    if (!userAgentStr || !isString(userAgentStr)) {\r\n        var navigator_2 = getNavigator() || {};\r\n        userAgentStr = navigator_2 ? (navigator_2[_DYN_USER_AGENT /* @min:%2euserAgent */] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]() : STR_EMPTY;\r\n    }\r\n    var ua = (userAgentStr || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]();\r\n    return (ua[_DYN_INDEX_OF /* @min:%2eindexOf */](\"safari\") >= 0);\r\n}\r\n/**\r\n * Checks if HTML5 Beacons are supported in the current environment.\r\n * @returns True if supported, false otherwise.\r\n */\r\nexport function isBeaconsSupported() {\r\n    if (_beaconsSupported === null) {\r\n        _beaconsSupported = hasNavigator() && Boolean(getNavigator().sendBeacon);\r\n    }\r\n    return _beaconsSupported;\r\n}\r\n/**\r\n * Checks if the Fetch API is supported in the current environment.\r\n * @param withKeepAlive - [Optional] If True, check if fetch is available and it supports the keepalive feature, otherwise only check if fetch is supported\r\n * @returns True if supported, otherwise false\r\n */\r\nexport function isFetchSupported(withKeepAlive) {\r\n    var isSupported = false;\r\n    try {\r\n        isSupported = !!getGlobalInst(\"fetch\");\r\n        var request = getGlobalInst(\"Request\");\r\n        if (isSupported && withKeepAlive && request) {\r\n            isSupported = _hasProperty(request, \"keepalive\");\r\n        }\r\n    }\r\n    catch (e) {\r\n        // Just Swallow any failure during availability checks\r\n    }\r\n    return isSupported;\r\n}\r\nexport function useXDomainRequest() {\r\n    if (_useXDomainRequest === null) {\r\n        _useXDomainRequest = (typeof XDomainRequest !== strShimUndefined);\r\n        if (_useXDomainRequest && isXhrSupported()) {\r\n            _useXDomainRequest = _useXDomainRequest && !_hasProperty(getGlobalInst(strXMLHttpRequest), \"withCredentials\");\r\n        }\r\n    }\r\n    return _useXDomainRequest;\r\n}\r\n/**\r\n * Checks if XMLHttpRequest is supported\r\n * @returns True if supported, otherwise false\r\n */\r\nexport function isXhrSupported() {\r\n    var isSupported = false;\r\n    try {\r\n        var xmlHttpRequest = getGlobalInst(strXMLHttpRequest);\r\n        isSupported = !!xmlHttpRequest;\r\n    }\r\n    catch (e) {\r\n        // Just Swallow any failure during availability checks\r\n    }\r\n    return isSupported;\r\n}\r\nfunction _getNamedValue(values, name) {\r\n    if (values) {\r\n        for (var i = 0; i < values[_DYN_LENGTH /* @min:%2elength */]; i++) {\r\n            var value = values[i];\r\n            if (value[_DYN_NAME /* @min:%2ename */]) {\r\n                if (value[_DYN_NAME /* @min:%2ename */] === name) {\r\n                    return value;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return {};\r\n}\r\n/**\r\n * Helper function to fetch the named meta-tag from the page.\r\n * @param name\r\n */\r\nexport function findMetaTag(name) {\r\n    var doc = getDocument();\r\n    if (doc && name) {\r\n        // Look for a meta-tag\r\n        return _getNamedValue(doc.querySelectorAll(\"meta\"), name).content;\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Helper function to fetch the named server timing value from the page response (first navigation event).\r\n * @param name\r\n */\r\nexport function findNamedServerTiming(name) {\r\n    var value;\r\n    var perf = getPerformance();\r\n    if (perf) {\r\n        // Try looking for a server-timing header\r\n        var navPerf = perf.getEntriesByType(\"navigation\") || [];\r\n        value = _getNamedValue((navPerf[_DYN_LENGTH /* @min:%2elength */] > 0 ? navPerf[0] : {}).serverTiming, name).description;\r\n    }\r\n    return value;\r\n}\r\n// TODO: should reuse this method for analytics plugin\r\nexport function dispatchEvent(target, evnt) {\r\n    if (target && target.dispatchEvent && evnt) {\r\n        target.dispatchEvent(evnt);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nexport function createCustomDomEvent(eventName, details) {\r\n    var event = null;\r\n    var detail = { detail: details || null };\r\n    if (isFunction(CustomEvent)) { // Use CustomEvent constructor when available\r\n        event = new CustomEvent(eventName, detail);\r\n    }\r\n    else { // CustomEvent has no constructor in IE\r\n        var doc = getDocument();\r\n        if (doc && doc.createEvent) {\r\n            event = doc.createEvent(\"CustomEvent\");\r\n            event.initCustomEvent(eventName, true, true, detail);\r\n        }\r\n    }\r\n    return event;\r\n}\r\nexport function sendCustomEvent(evtName, cfg, customDetails) {\r\n    var global = getGlobal();\r\n    if (global && global.CustomEvent) {\r\n        try {\r\n            var details = { cfg: cfg || null, customDetails: customDetails || null };\r\n            return dispatchEvent(global, createCustomDomEvent(evtName, details));\r\n        }\r\n        catch (e) {\r\n            // eslint-disable-next-line no-empty\r\n        }\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=EnvUtils.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { _DYN_APPLY, _DYN_LENGTH } from \"../__DynamicConstants\";\r\nimport { getGlobalInst } from \"./EnvUtils\";\r\nvar listenerFuncs = [\"eventsSent\", \"eventsDiscarded\", \"eventsSendRequest\", \"perfEvent\"];\r\nvar _aiNamespace = null;\r\nvar _debugListener;\r\nfunction _listenerProxyFunc(name, config) {\r\n    return function () {\r\n        var args = arguments;\r\n        var dbgExt = getDebugExt(config);\r\n        if (dbgExt) {\r\n            var listener = dbgExt.listener;\r\n            if (listener && listener[name]) {\r\n                listener[name][_DYN_APPLY /* @min:%2eapply */](listener, args);\r\n            }\r\n        }\r\n    };\r\n}\r\nfunction _getExtensionNamespace() {\r\n    // Cache the lookup of the global namespace object\r\n    var target = getGlobalInst(\"Microsoft\");\r\n    if (target) {\r\n        _aiNamespace = target[\"ApplicationInsights\"];\r\n    }\r\n    return _aiNamespace;\r\n}\r\nexport function getDebugExt(config) {\r\n    var ns = _aiNamespace;\r\n    if (!ns && config.disableDbgExt !== true) {\r\n        ns = _aiNamespace || _getExtensionNamespace();\r\n    }\r\n    return ns ? ns[\"ChromeDbgExt\"] : null;\r\n}\r\nexport function getDebugListener(config) {\r\n    if (!_debugListener) {\r\n        _debugListener = {};\r\n        for (var lp = 0; lp < listenerFuncs[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n            _debugListener[listenerFuncs[lp]] = _listenerProxyFunc(listenerFuncs[lp], config);\r\n        }\r\n    }\r\n    return _debugListener;\r\n}\r\n//# sourceMappingURL=DbgExtensionUtils.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_DIAG_LOG, _DYN_ENABLE_DEBUG_EXCEPTI4, _DYN_LOGGER, _DYN_LOG_INTERNAL_MESSAGE, _DYN_MESSAGE, _DYN_MESSAGE_ID, _DYN_PUSH, _DYN_REPLACE } from \"../__DynamicConstants\";\r\nimport { getDebugExt } from \"./DbgExtensionUtils\";\r\nimport { dumpObj, getConsole, getJSON, hasJSON } from \"./EnvUtils\";\r\nimport { getCfgValue, isFunction, isUndefined } from \"./HelperFuncs\";\r\nimport { STR_EMPTY, STR_ERROR_TO_CONSOLE, STR_WARN_TO_CONSOLE } from \"./InternalConstants\";\r\n/**\r\n * For user non actionable traces use AI Internal prefix.\r\n */\r\nvar AiNonUserActionablePrefix = \"AI (Internal): \";\r\n/**\r\n * Prefix of the traces in portal.\r\n */\r\nvar AiUserActionablePrefix = \"AI: \";\r\n/**\r\n *  Session storage key for the prefix for the key indicating message type already logged\r\n */\r\nvar AIInternalMessagePrefix = \"AITR_\";\r\nfunction _sanitizeDiagnosticText(text) {\r\n    if (text) {\r\n        return \"\\\"\" + text[_DYN_REPLACE /* @min:%2ereplace */](/\\\"/g, STR_EMPTY) + \"\\\"\";\r\n    }\r\n    return STR_EMPTY;\r\n}\r\nfunction _logToConsole(func, message) {\r\n    var theConsole = getConsole();\r\n    if (!!theConsole) {\r\n        var logFunc = \"log\";\r\n        if (theConsole[func]) {\r\n            logFunc = func;\r\n        }\r\n        if (isFunction(theConsole[logFunc])) {\r\n            theConsole[logFunc](message);\r\n        }\r\n    }\r\n}\r\nvar _InternalLogMessage = /** @class */ (function () {\r\n    function _InternalLogMessage(msgId, msg, isUserAct, properties) {\r\n        if (isUserAct === void 0) { isUserAct = false; }\r\n        var _self = this;\r\n        _self[_DYN_MESSAGE_ID /* @min:%2emessageId */] = msgId;\r\n        _self[_DYN_MESSAGE /* @min:%2emessage */] =\r\n            (isUserAct ? AiUserActionablePrefix : AiNonUserActionablePrefix) +\r\n                msgId;\r\n        var strProps = STR_EMPTY;\r\n        if (hasJSON()) {\r\n            strProps = getJSON().stringify(properties);\r\n        }\r\n        var diagnosticText = (msg ? \" message:\" + _sanitizeDiagnosticText(msg) : STR_EMPTY) +\r\n            (properties ? \" props:\" + _sanitizeDiagnosticText(strProps) : STR_EMPTY);\r\n        _self[_DYN_MESSAGE /* @min:%2emessage */] += diagnosticText;\r\n    }\r\n    _InternalLogMessage.dataType = \"MessageData\";\r\n    return _InternalLogMessage;\r\n}());\r\nexport { _InternalLogMessage };\r\nexport function safeGetLogger(core, config) {\r\n    return (core || {})[_DYN_LOGGER /* @min:%2elogger */] || new DiagnosticLogger(config);\r\n}\r\nvar DiagnosticLogger = /** @class */ (function () {\r\n    function DiagnosticLogger(config) {\r\n        this.identifier = \"DiagnosticLogger\";\r\n        /**\r\n         * The internal logging queue\r\n         */\r\n        this.queue = [];\r\n        /**\r\n         * Count of internal messages sent\r\n         */\r\n        var _messageCount = 0;\r\n        /**\r\n         * Holds information about what message types were already logged to console or sent to server.\r\n         */\r\n        var _messageLogged = {};\r\n        var _loggingLevelConsole;\r\n        var _loggingLevelTelemetry;\r\n        var _maxInternalMessageLimit;\r\n        var _enableDebug;\r\n        dynamicProto(DiagnosticLogger, this, function (_self) {\r\n            _setDefaultsFromConfig(config || {});\r\n            _self.consoleLoggingLevel = function () { return _loggingLevelConsole; };\r\n            _self.telemetryLoggingLevel = function () { return _loggingLevelTelemetry; };\r\n            _self.maxInternalMessageLimit = function () { return _maxInternalMessageLimit; };\r\n            _self[_DYN_ENABLE_DEBUG_EXCEPTI4 /* @min:%2eenableDebugExceptions */] = function () { return _enableDebug; };\r\n            /**\r\n             * This method will throw exceptions in debug mode or attempt to log the error as a console warning.\r\n             * @param severity {LoggingSeverity} - The severity of the log message\r\n             * @param message {_InternalLogMessage} - The log message.\r\n             */\r\n            _self.throwInternal = function (severity, msgId, msg, properties, isUserAct) {\r\n                if (isUserAct === void 0) { isUserAct = false; }\r\n                var message = new _InternalLogMessage(msgId, msg, isUserAct, properties);\r\n                if (_enableDebug) {\r\n                    throw dumpObj(message);\r\n                }\r\n                else {\r\n                    // Get the logging function and fallback to warnToConsole of for some reason errorToConsole doesn't exist\r\n                    var logFunc = severity === 1 /* eLoggingSeverity.CRITICAL */ ? STR_ERROR_TO_CONSOLE : STR_WARN_TO_CONSOLE;\r\n                    if (!isUndefined(message[_DYN_MESSAGE /* @min:%2emessage */])) {\r\n                        if (isUserAct) {\r\n                            // check if this message type was already logged to console for this page view and if so, don't log it again\r\n                            var messageKey = +message[_DYN_MESSAGE_ID /* @min:%2emessageId */];\r\n                            if (!_messageLogged[messageKey] && _loggingLevelConsole >= severity) {\r\n                                _self[logFunc](message[_DYN_MESSAGE /* @min:%2emessage */]);\r\n                                _messageLogged[messageKey] = true;\r\n                            }\r\n                        }\r\n                        else {\r\n                            // Only log traces if the console Logging Level is >= the throwInternal severity level\r\n                            if (_loggingLevelConsole >= severity) {\r\n                                _self[logFunc](message[_DYN_MESSAGE /* @min:%2emessage */]);\r\n                            }\r\n                        }\r\n                        _logInternalMessage(severity, message);\r\n                    }\r\n                    else {\r\n                        _debugExtMsg(\"throw\" + (severity === 1 /* eLoggingSeverity.CRITICAL */ ? \"Critical\" : \"Warning\"), message);\r\n                    }\r\n                }\r\n            };\r\n            /**\r\n             * This will write a warning to the console if possible\r\n             * @param message {string} - The warning message\r\n             */\r\n            _self[STR_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */] = function (message) {\r\n                _logToConsole(\"warn\", message);\r\n                _debugExtMsg(\"warning\", message);\r\n            };\r\n            /**\r\n             * This will write an error to the console if possible\r\n             * @param message {string} - The error message\r\n             */\r\n            _self[STR_ERROR_TO_CONSOLE /* @min:%2eerrorToConsole */] = function (message) {\r\n                _logToConsole(\"error\", message);\r\n                _debugExtMsg(\"error\", message);\r\n            };\r\n            /**\r\n             * Resets the internal message count\r\n             */\r\n            _self.resetInternalMessageCount = function () {\r\n                _messageCount = 0;\r\n                _messageLogged = {};\r\n            };\r\n            /**\r\n             * Logs a message to the internal queue.\r\n             * @param severity {LoggingSeverity} - The severity of the log message\r\n             * @param message {_InternalLogMessage} - The message to log.\r\n             */\r\n            _self[_DYN_LOG_INTERNAL_MESSAGE /* @min:%2elogInternalMessage */] = _logInternalMessage;\r\n            function _logInternalMessage(severity, message) {\r\n                if (_areInternalMessagesThrottled()) {\r\n                    return;\r\n                }\r\n                // check if this message type was already logged for this session and if so, don't log it again\r\n                var logMessage = true;\r\n                var messageKey = AIInternalMessagePrefix + message[_DYN_MESSAGE_ID /* @min:%2emessageId */];\r\n                // if the session storage is not available, limit to only one message type per page view\r\n                if (_messageLogged[messageKey]) {\r\n                    logMessage = false;\r\n                }\r\n                else {\r\n                    _messageLogged[messageKey] = true;\r\n                }\r\n                if (logMessage) {\r\n                    // Push the event in the internal queue\r\n                    if (severity <= _loggingLevelTelemetry) {\r\n                        _self.queue[_DYN_PUSH /* @min:%2epush */](message);\r\n                        _messageCount++;\r\n                        _debugExtMsg((severity === 1 /* eLoggingSeverity.CRITICAL */ ? \"error\" : \"warn\"), message);\r\n                    }\r\n                    // When throttle limit reached, send a special event\r\n                    if (_messageCount === _maxInternalMessageLimit) {\r\n                        var throttleLimitMessage = \"Internal events throttle limit per PageView reached for this app.\";\r\n                        var throttleMessage = new _InternalLogMessage(23 /* _eInternalMessageId.MessageLimitPerPVExceeded */, throttleLimitMessage, false);\r\n                        _self.queue[_DYN_PUSH /* @min:%2epush */](throttleMessage);\r\n                        if (severity === 1 /* eLoggingSeverity.CRITICAL */) {\r\n                            _self[STR_ERROR_TO_CONSOLE /* @min:%2eerrorToConsole */](throttleLimitMessage);\r\n                        }\r\n                        else {\r\n                            _self[STR_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */](throttleLimitMessage);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            function _setDefaultsFromConfig(config) {\r\n                _loggingLevelConsole = getCfgValue(config.loggingLevelConsole, 0);\r\n                _loggingLevelTelemetry = getCfgValue(config.loggingLevelTelemetry, 1);\r\n                _maxInternalMessageLimit = getCfgValue(config.maxMessageLimit, 25);\r\n                _enableDebug = getCfgValue(config.enableDebug, getCfgValue(config[_DYN_ENABLE_DEBUG_EXCEPTI4 /* @min:%2eenableDebugExceptions */], false));\r\n            }\r\n            function _areInternalMessagesThrottled() {\r\n                return _messageCount >= _maxInternalMessageLimit;\r\n            }\r\n            function _debugExtMsg(name, data) {\r\n                var dbgExt = getDebugExt(config || {});\r\n                if (dbgExt && dbgExt[_DYN_DIAG_LOG /* @min:%2ediagLog */]) {\r\n                    dbgExt[_DYN_DIAG_LOG /* @min:%2ediagLog */](name, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * When this is true the SDK will throw exceptions to aid in debugging.\r\n     */\r\n    DiagnosticLogger.prototype.enableDebugExceptions = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * 0: OFF (default)\r\n     * 1: CRITICAL\r\n     * 2: >= WARNING\r\n     */\r\n    DiagnosticLogger.prototype.consoleLoggingLevel = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return 0;\r\n    };\r\n    /**\r\n     * 0: OFF\r\n     * 1: CRITICAL (default)\r\n     * 2: >= WARNING\r\n     */\r\n    DiagnosticLogger.prototype.telemetryLoggingLevel = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return 1;\r\n    };\r\n    /**\r\n     * The maximum number of internal messages allowed to be sent per page view\r\n     */\r\n    DiagnosticLogger.prototype.maxInternalMessageLimit = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return 25;\r\n    };\r\n    /**\r\n     * This method will throw exceptions in debug mode or attempt to log the error as a console warning.\r\n     * @param severity {LoggingSeverity} - The severity of the log message\r\n     * @param message {_InternalLogMessage} - The log message.\r\n     */\r\n    DiagnosticLogger.prototype.throwInternal = function (severity, msgId, msg, properties, isUserAct) {\r\n        if (isUserAct === void 0) { isUserAct = false; }\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * This will write a warning to the console if possible\r\n     * @param message {string} - The warning message\r\n     */\r\n    DiagnosticLogger.prototype.warnToConsole = function (message) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * This will write an error to the console if possible\r\n     * @param message {string} - The warning message\r\n     */\r\n    DiagnosticLogger.prototype.errorToConsole = function (message) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Resets the internal message count\r\n     */\r\n    DiagnosticLogger.prototype.resetInternalMessageCount = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Logs a message to the internal queue.\r\n     * @param severity {LoggingSeverity} - The severity of the log message\r\n     * @param message {_InternalLogMessage} - The message to log.\r\n     */\r\n    DiagnosticLogger.prototype.logInternalMessage = function (severity, message) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return DiagnosticLogger;\r\n}());\r\nexport { DiagnosticLogger };\r\nfunction _getLogger(logger) {\r\n    return (logger || new DiagnosticLogger());\r\n}\r\n/**\r\n * This is a helper method which will call throwInternal on the passed logger, will throw exceptions in\r\n * debug mode or attempt to log the error as a console warning. This helper is provided mostly to better\r\n * support minification as logger.throwInternal() will not compress the publish \"throwInternal\" used throughout\r\n * the code.\r\n * @param logger - The Diagnostic Logger instance to use.\r\n * @param severity {LoggingSeverity} - The severity of the log message\r\n * @param message {_InternalLogMessage} - The log message.\r\n */\r\nexport function _throwInternal(logger, severity, msgId, msg, properties, isUserAct) {\r\n    if (isUserAct === void 0) { isUserAct = false; }\r\n    _getLogger(logger).throwInternal(severity, msgId, msg, properties, isUserAct);\r\n}\r\n/**\r\n * This is a helper method which will call warnToConsole on the passed logger with the provided message.\r\n * @param logger - The Diagnostic Logger instance to use.\r\n * @param message {_InternalLogMessage} - The log message.\r\n */\r\nexport function _warnToConsole(logger, message) {\r\n    _getLogger(logger)[STR_WARN_TO_CONSOLE /* @min:%2ewarnToConsole */](message);\r\n}\r\n/**\r\n * Logs a message to the internal queue.\r\n * @param logger - The Diagnostic Logger instance to use.\r\n * @param severity {LoggingSeverity} - The severity of the log message\r\n * @param message {_InternalLogMessage} - The message to log.\r\n */\r\nexport function _logInternalMessage(logger, severity, message) {\r\n    _getLogger(logger)[_DYN_LOG_INTERNAL_MESSAGE /* @min:%2elogInternalMessage */](severity, message);\r\n}\r\n//# sourceMappingURL=DiagnosticLogger.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_COMPLETE, _DYN_GET_CTX, _DYN_IS_ASYNC, _DYN_IS_CHILD_EVT, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_SET_CTX, _DYN_TIME } from \"../__DynamicConstants\";\r\nimport { dateNow, isArray, isFunction, objDefineAccessors } from \"./HelperFuncs\";\r\nimport { STR_GET_PERF_MGR, STR_PERF_EVENT } from \"./InternalConstants\";\r\nvar strExecutionContextKey = \"ctx\";\r\nvar strParentContextKey = \"ParentContextKey\";\r\nvar strChildrenContextKey = \"ChildrenContextKey\";\r\nvar _defaultPerfManager = null;\r\nvar PerfEvent = /** @class */ (function () {\r\n    function PerfEvent(name, payloadDetails, isAsync) {\r\n        var _self = this;\r\n        var accessorDefined = false;\r\n        _self.start = dateNow();\r\n        _self[_DYN_NAME /* @min:%2ename */] = name;\r\n        _self[_DYN_IS_ASYNC /* @min:%2eisAsync */] = isAsync;\r\n        _self[_DYN_IS_CHILD_EVT /* @min:%2eisChildEvt */] = function () { return false; };\r\n        if (isFunction(payloadDetails)) {\r\n            // Create an accessor to minimize the potential performance impact of executing the payloadDetails callback\r\n            var theDetails_1;\r\n            accessorDefined = objDefineAccessors(_self, \"payload\", function () {\r\n                // Delay the execution of the payloadDetails until needed\r\n                if (!theDetails_1 && isFunction(payloadDetails)) {\r\n                    theDetails_1 = payloadDetails();\r\n                    // clear it out now so the referenced objects can be garbage collected\r\n                    payloadDetails = null;\r\n                }\r\n                return theDetails_1;\r\n            });\r\n        }\r\n        _self[_DYN_GET_CTX /* @min:%2egetCtx */] = function (key) {\r\n            if (key) {\r\n                // The parent and child links are located directly on the object (for better viewing in the DebugPlugin)\r\n                if (key === PerfEvent[strParentContextKey] || key === PerfEvent[strChildrenContextKey]) {\r\n                    return _self[key];\r\n                }\r\n                return (_self[strExecutionContextKey] || {})[key];\r\n            }\r\n            return null;\r\n        };\r\n        _self[_DYN_SET_CTX /* @min:%2esetCtx */] = function (key, value) {\r\n            if (key) {\r\n                // Put the parent and child links directly on the object (for better viewing in the DebugPlugin)\r\n                if (key === PerfEvent[strParentContextKey]) {\r\n                    // Simple assumption, if we are setting a parent then we must be a child\r\n                    if (!_self[key]) {\r\n                        _self[_DYN_IS_CHILD_EVT /* @min:%2eisChildEvt */] = function () { return true; };\r\n                    }\r\n                    _self[key] = value;\r\n                }\r\n                else if (key === PerfEvent[strChildrenContextKey]) {\r\n                    _self[key] = value;\r\n                }\r\n                else {\r\n                    var ctx = _self[strExecutionContextKey] = _self[strExecutionContextKey] || {};\r\n                    ctx[key] = value;\r\n                }\r\n            }\r\n        };\r\n        _self[_DYN_COMPLETE /* @min:%2ecomplete */] = function () {\r\n            var childTime = 0;\r\n            var childEvts = _self[_DYN_GET_CTX /* @min:%2egetCtx */](PerfEvent[strChildrenContextKey]);\r\n            if (isArray(childEvts)) {\r\n                for (var lp = 0; lp < childEvts[_DYN_LENGTH /* @min:%2elength */]; lp++) {\r\n                    var childEvt = childEvts[lp];\r\n                    if (childEvt) {\r\n                        childTime += childEvt[_DYN_TIME /* @min:%2etime */];\r\n                    }\r\n                }\r\n            }\r\n            _self[_DYN_TIME /* @min:%2etime */] = dateNow() - _self.start;\r\n            _self.exTime = _self[_DYN_TIME /* @min:%2etime */] - childTime;\r\n            _self[_DYN_COMPLETE /* @min:%2ecomplete */] = function () { };\r\n            if (!accessorDefined && isFunction(payloadDetails)) {\r\n                // If we couldn't define the property set during complete -- to minimize the perf impact until after the time\r\n                _self.payload = payloadDetails();\r\n            }\r\n        };\r\n    }\r\n    PerfEvent.ParentContextKey = \"parent\";\r\n    PerfEvent.ChildrenContextKey = \"childEvts\";\r\n    return PerfEvent;\r\n}());\r\nexport { PerfEvent };\r\nvar PerfManager = /** @class */ (function () {\r\n    function PerfManager(manager) {\r\n        /**\r\n         * General bucket used for execution context set and retrieved via setCtx() and getCtx.\r\n         * Defined as private so it can be visualized via the DebugPlugin\r\n         */\r\n        this.ctx = {};\r\n        dynamicProto(PerfManager, this, function (_self) {\r\n            _self.create = function (src, payloadDetails, isAsync) {\r\n                // TODO (@MSNev): at some point we will want to add additional configuration to \"select\" which events to instrument\r\n                // for now this is just a simple do everything.\r\n                return new PerfEvent(src, payloadDetails, isAsync);\r\n            };\r\n            _self.fire = function (perfEvent) {\r\n                if (perfEvent) {\r\n                    perfEvent[_DYN_COMPLETE /* @min:%2ecomplete */]();\r\n                    if (manager && isFunction(manager[STR_PERF_EVENT /* @min:%2eperfEvent */])) {\r\n                        manager[STR_PERF_EVENT /* @min:%2eperfEvent */](perfEvent);\r\n                    }\r\n                }\r\n            };\r\n            _self[_DYN_SET_CTX /* @min:%2esetCtx */] = function (key, value) {\r\n                if (key) {\r\n                    var ctx = _self[strExecutionContextKey] = _self[strExecutionContextKey] || {};\r\n                    ctx[key] = value;\r\n                }\r\n            };\r\n            _self[_DYN_GET_CTX /* @min:%2egetCtx */] = function (key) {\r\n                return (_self[strExecutionContextKey] || {})[key];\r\n            };\r\n        });\r\n    }\r\n    /**\r\n     * Create a new event and start timing, the manager may return null/undefined to indicate that it does not\r\n     * want to monitor this source event.\r\n     * @param src The source name of the event\r\n     * @param payloadDetails - An optional callback function to fetch the payload details for the event.\r\n     * @param isAsync - Is the event occurring from a async event\r\n     */\r\n    PerfManager.prototype.create = function (src, payload, isAsync) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Complete the perfEvent and fire any notifications.\r\n     * @param perfEvent Fire the event which will also complete the passed event\r\n     */\r\n    PerfManager.prototype.fire = function (perfEvent) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Set an execution context value\r\n     * @param key - The context key name\r\n     * @param value - The value\r\n     */\r\n    PerfManager.prototype.setCtx = function (key, value) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Get the execution context value\r\n     * @param key - The context key\r\n     */\r\n    PerfManager.prototype.getCtx = function (key) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return PerfManager;\r\n}());\r\nexport { PerfManager };\r\nvar doPerfActiveKey = \"CoreUtils.doPerf\";\r\n/**\r\n * Helper function to wrap a function with a perf event\r\n * @param mgrSource - The Performance Manager or a Performance provider source (may be null)\r\n * @param getSource - The callback to create the source name for the event (if perf monitoring is enabled)\r\n * @param func - The function to call and measure\r\n * @param details - A function to return the payload details\r\n * @param isAsync - Is the event / function being call asynchronously or synchronously\r\n */\r\nexport function doPerf(mgrSource, getSource, func, details, isAsync) {\r\n    if (mgrSource) {\r\n        var perfMgr = mgrSource;\r\n        if (perfMgr[STR_GET_PERF_MGR]) {\r\n            // Looks like a perf manager provider object\r\n            perfMgr = perfMgr[STR_GET_PERF_MGR]();\r\n        }\r\n        if (perfMgr) {\r\n            var perfEvt = void 0;\r\n            var currentActive = perfMgr[_DYN_GET_CTX /* @min:%2egetCtx */](doPerfActiveKey);\r\n            try {\r\n                perfEvt = perfMgr.create(getSource(), details, isAsync);\r\n                if (perfEvt) {\r\n                    if (currentActive && perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */]) {\r\n                        perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */](PerfEvent[strParentContextKey], currentActive);\r\n                        if (currentActive[_DYN_GET_CTX /* @min:%2egetCtx */] && currentActive[_DYN_SET_CTX /* @min:%2esetCtx */]) {\r\n                            var children = currentActive[_DYN_GET_CTX /* @min:%2egetCtx */](PerfEvent[strChildrenContextKey]);\r\n                            if (!children) {\r\n                                children = [];\r\n                                currentActive[_DYN_SET_CTX /* @min:%2esetCtx */](PerfEvent[strChildrenContextKey], children);\r\n                            }\r\n                            children[_DYN_PUSH /* @min:%2epush */](perfEvt);\r\n                        }\r\n                    }\r\n                    // Set this event as the active event now\r\n                    perfMgr[_DYN_SET_CTX /* @min:%2esetCtx */](doPerfActiveKey, perfEvt);\r\n                    return func(perfEvt);\r\n                }\r\n            }\r\n            catch (ex) {\r\n                if (perfEvt && perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */]) {\r\n                    perfEvt[_DYN_SET_CTX /* @min:%2esetCtx */](\"exception\", ex);\r\n                }\r\n            }\r\n            finally {\r\n                // fire the perf event\r\n                if (perfEvt) {\r\n                    perfMgr.fire(perfEvt);\r\n                }\r\n                // Reset the active event to the previous value\r\n                perfMgr[_DYN_SET_CTX /* @min:%2esetCtx */](doPerfActiveKey, currentActive);\r\n            }\r\n        }\r\n    }\r\n    return func();\r\n}\r\n/**\r\n * Set the global performance manager to use when there is no core instance or it has not been initialized yet.\r\n * @param perfManager - The IPerfManager instance to use when no performance manager is supplied.\r\n */\r\nexport function setGblPerfMgr(perfManager) {\r\n    _defaultPerfManager = perfManager;\r\n}\r\n/**\r\n * Get the current global performance manager that will be used with no performance manager is supplied.\r\n * @returns - The current default manager\r\n */\r\nexport function getGblPerfMgr() {\r\n    return _defaultPerfManager;\r\n}\r\n//# sourceMappingURL=PerfManager.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { _DYN_LENGTH } from \"../__DynamicConstants\";\r\nimport { getCrypto, getMsCrypto, isIE } from \"./EnvUtils\";\r\nimport { dateNow } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nvar UInt32Mask = 0x100000000;\r\nvar MaxUInt32 = 0xffffffff;\r\n// MWC based Random generator (for IE)\r\nvar _mwcSeeded = false;\r\nvar _mwcW = 123456789;\r\nvar _mwcZ = 987654321;\r\n// Takes any integer\r\nfunction _mwcSeed(seedValue) {\r\n    if (seedValue < 0) {\r\n        // Make sure we end up with a positive number and not -ve one.\r\n        seedValue >>>= 0;\r\n    }\r\n    _mwcW = (123456789 + seedValue) & MaxUInt32;\r\n    _mwcZ = (987654321 - seedValue) & MaxUInt32;\r\n    _mwcSeeded = true;\r\n}\r\nfunction _autoSeedMwc() {\r\n    // Simple initialization using default Math.random() - So we inherit any entropy from the browser\r\n    // and bitwise XOR with the current milliseconds\r\n    try {\r\n        var now = dateNow() & 0x7fffffff;\r\n        _mwcSeed(((Math.random() * UInt32Mask) ^ now) + now);\r\n    }\r\n    catch (e) {\r\n        // Don't crash if something goes wrong\r\n    }\r\n}\r\n/**\r\n * Generate a random value between 0 and maxValue, max value should be limited to a 32-bit maximum.\r\n * So maxValue(16) will produce a number from 0..16 (range of 17)\r\n * @param maxValue\r\n */\r\nexport function randomValue(maxValue) {\r\n    if (maxValue > 0) {\r\n        return Math.floor((random32() / MaxUInt32) * (maxValue + 1)) >>> 0;\r\n    }\r\n    return 0;\r\n}\r\n/**\r\n * generate a random 32-bit number (0x000000..0xFFFFFFFF) or (-0x80000000..0x7FFFFFFF), defaults un-unsigned.\r\n * @param signed - True to return a signed 32-bit number (-0x80000000..0x7FFFFFFF) otherwise an unsigned one (0x000000..0xFFFFFFFF)\r\n */\r\nexport function random32(signed) {\r\n    var value = 0;\r\n    var c = getCrypto() || getMsCrypto();\r\n    if (c && c.getRandomValues) {\r\n        // Make sure the number is converted into the specified range (-0x80000000..0x7FFFFFFF)\r\n        value = c.getRandomValues(new Uint32Array(1))[0] & MaxUInt32;\r\n    }\r\n    if (value === 0 && isIE()) {\r\n        // For IE 6, 7, 8 (especially on XP) Math.random is not very random\r\n        if (!_mwcSeeded) {\r\n            // Set the seed for the Mwc algorithm\r\n            _autoSeedMwc();\r\n        }\r\n        // Don't use Math.random for IE\r\n        // Make sure the number is converted into the specified range (-0x80000000..0x7FFFFFFF)\r\n        value = mwcRandom32() & MaxUInt32;\r\n    }\r\n    if (value === 0) {\r\n        // Make sure the number is converted into the specified range (-0x80000000..0x7FFFFFFF)\r\n        value = Math.floor((UInt32Mask * Math.random()) | 0);\r\n    }\r\n    if (!signed) {\r\n        // Make sure we end up with a positive number and not -ve one.\r\n        value >>>= 0;\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Seed the MWC random number generator with the specified seed or a random value\r\n * @param value - optional the number to used as the seed, if undefined, null or zero a random value will be chosen\r\n */\r\nexport function mwcRandomSeed(value) {\r\n    if (!value) {\r\n        _autoSeedMwc();\r\n    }\r\n    else {\r\n        _mwcSeed(value);\r\n    }\r\n}\r\n/**\r\n * Generate a random 32-bit number between (0x000000..0xFFFFFFFF) or (-0x80000000..0x7FFFFFFF), using MWC (Multiply with carry)\r\n * instead of Math.random() defaults to un-signed.\r\n * Used as a replacement random generator for IE to avoid issues with older IE instances.\r\n * @param signed - True to return a signed 32-bit number (-0x80000000..0x7FFFFFFF) otherwise an unsigned one (0x000000..0xFFFFFFFF)\r\n */\r\nexport function mwcRandom32(signed) {\r\n    _mwcZ = (36969 * (_mwcZ & 0xFFFF) + (_mwcZ >> 16)) & MaxUInt32;\r\n    _mwcW = (18000 * (_mwcW & 0xFFFF) + (_mwcW >> 16)) & MaxUInt32;\r\n    var value = (((_mwcZ << 16) + (_mwcW & 0xFFFF)) >>> 0) & MaxUInt32 | 0;\r\n    if (!signed) {\r\n        // Make sure we end up with a positive number and not -ve one.\r\n        value >>>= 0;\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * Generate random base64 id string.\r\n * The default length is 22 which is 132-bits so almost the same as a GUID but as base64 (the previous default was 5)\r\n * @param maxLength - Optional value to specify the length of the id to be generated, defaults to 22\r\n */\r\nexport function newId(maxLength) {\r\n    if (maxLength === void 0) { maxLength = 22; }\r\n    var base64chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n    // Start with an initial random number, consuming the value in reverse byte order\r\n    var number = random32() >>> 0; // Make sure it's a +ve number\r\n    var chars = 0;\r\n    var result = STR_EMPTY;\r\n    while (result[_DYN_LENGTH /* @min:%2elength */] < maxLength) {\r\n        chars++;\r\n        result += base64chars.charAt(number & 0x3F);\r\n        number >>>= 6; // Zero fill with right shift\r\n        if (chars === 5) {\r\n            // 5 base64 characters === 30 bits so we don't have enough bits for another base64 char\r\n            // So add on another 30 bits and make sure it's +ve\r\n            number = (((random32() << 2) & 0xFFFFFFFF) | (number & 0x03)) >>> 0;\r\n            chars = 0; // We need to reset the number every 5 chars (30 bits)\r\n        }\r\n    }\r\n    return result;\r\n}\r\n//# sourceMappingURL=RandomHelper.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { ObjDefineProperty } from \"@microsoft/applicationinsights-shims\";\r\nimport { _DYN_NODE_TYPE } from \"../__DynamicConstants\";\r\nimport { normalizeJsName } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { newId } from \"./RandomHelper\";\r\nvar _objDefineProperty = ObjDefineProperty;\r\nvar version = '2.8.18';\r\nvar instanceName = \".\" + newId(6);\r\nvar _dataUid = 0;\r\nfunction _createAccessor(target, prop, value) {\r\n    if (_objDefineProperty) {\r\n        try {\r\n            _objDefineProperty(target, prop, {\r\n                value: value,\r\n                enumerable: false,\r\n                configurable: true\r\n            });\r\n            return true;\r\n        }\r\n        catch (e) {\r\n            // IE8 Defines a defineProperty on Object but it's only supported for DOM elements so it will throw\r\n            // We will just ignore this here.\r\n        }\r\n    }\r\n    return false;\r\n}\r\n// Accepts only:\r\n//  - Node\r\n//    - Node.ELEMENT_NODE\r\n//    - Node.DOCUMENT_NODE\r\n//  - Object\r\n//    - Any\r\nfunction _canAcceptData(target) {\r\n    return target[_DYN_NODE_TYPE /* @min:%2enodeType */] === 1 || target[_DYN_NODE_TYPE /* @min:%2enodeType */] === 9 || !(+target[_DYN_NODE_TYPE /* @min:%2enodeType */]);\r\n}\r\nfunction _getCache(data, target) {\r\n    var theCache = target[data.id];\r\n    if (!theCache) {\r\n        theCache = {};\r\n        try {\r\n            if (_canAcceptData(target)) {\r\n                if (!_createAccessor(target, data.id, theCache)) {\r\n                    // Environment doesn't support accessor, so just use direct assignment\r\n                    target[data.id] = theCache;\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Not all environments allow extending all objects, so just ignore the cache in those cases\r\n        }\r\n    }\r\n    return theCache;\r\n}\r\nexport function createUniqueNamespace(name, includeVersion) {\r\n    if (includeVersion === void 0) { includeVersion = false; }\r\n    return normalizeJsName(name + (_dataUid++) + (includeVersion ? \".\" + version : STR_EMPTY) + instanceName);\r\n}\r\nexport function createElmNodeData(name) {\r\n    var data = {\r\n        id: createUniqueNamespace(\"_aiData-\" + (name || STR_EMPTY) + \".\" + version),\r\n        accept: function (target) {\r\n            return _canAcceptData(target);\r\n        },\r\n        get: function (target, name, defValue, addDefault) {\r\n            var theCache = target[data.id];\r\n            if (!theCache) {\r\n                if (addDefault) {\r\n                    // Side effect is adds the cache\r\n                    theCache = _getCache(data, target);\r\n                    theCache[normalizeJsName(name)] = defValue;\r\n                }\r\n                return defValue;\r\n            }\r\n            return theCache[normalizeJsName(name)];\r\n        },\r\n        kill: function (target, name) {\r\n            if (target && target[name]) {\r\n                try {\r\n                    delete target[name];\r\n                }\r\n                catch (e) {\r\n                    // Just cleaning up, so if this fails -- ignore\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return data;\r\n}\r\n//# sourceMappingURL=DataCacheHelper.js.map", "import { _DYN_COOKIE_CFG, _DYN_INDEX_OF, _DYN_LENGTH, _DYN_LOGGER, _DYN_SET_ENABLED, _DYN_SPLIT, _DYN_SUBSTRING, _DYN_USER_AGENT } from \"../__DynamicConstants\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nimport { dumpObj, getDocument, getLocation, getNavigator, isIE } from \"./EnvUtils\";\r\nimport { arrForEach, dateNow, getExceptionName, isArray, isFunction, isNotNullOrUndefined, isNullOrUndefined, isString, isTruthy, isUndefined, objForEachKey, setValue, strContains, strEndsWith, strTrim } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nvar strToGMTString = \"toGMTString\";\r\nvar strToUTCString = \"toUTCString\";\r\nvar strCookie = \"cookie\";\r\nvar strExpires = \"expires\";\r\nvar strEnabled = \"enabled\";\r\nvar strIsCookieUseDisabled = \"isCookieUseDisabled\";\r\nvar strDisableCookiesUsage = \"disableCookiesUsage\";\r\nvar strConfigCookieMgr = \"_ckMgr\";\r\nvar _supportsCookies = null;\r\nvar _allowUaSameSite = null;\r\nvar _parsedCookieValue = null;\r\nvar _doc = getDocument();\r\nvar _cookieCache = {};\r\nvar _globalCookieConfig = {};\r\n/**\r\n * @ignore\r\n * DO NOT USE or export from the module, this is exposed as public to support backward compatibility of previous static utility methods only.\r\n * If you want to manager cookies either use the ICookieMgr available from the core instance via getCookieMgr() or create\r\n * your own instance of the CookieMgr and use that.\r\n * Using this directly for enabling / disabling cookie handling will not only affect your usage but EVERY user of cookies.\r\n * Example, if you are using a shared component that is also using Application Insights you will affect their cookie handling.\r\n * @param logger - The DiagnosticLogger to use for reporting errors.\r\n */\r\nexport function _gblCookieMgr(config, logger) {\r\n    // Stash the global instance against the BaseCookieMgr class\r\n    var inst = createCookieMgr[strConfigCookieMgr] || _globalCookieConfig[strConfigCookieMgr];\r\n    if (!inst) {\r\n        // Note: not using the getSetValue() helper as that would require always creating a temporary cookieMgr\r\n        // that ultimately is never used\r\n        inst = createCookieMgr[strConfigCookieMgr] = createCookieMgr(config, logger);\r\n        _globalCookieConfig[strConfigCookieMgr] = inst;\r\n    }\r\n    return inst;\r\n}\r\nfunction _isMgrEnabled(cookieMgr) {\r\n    if (cookieMgr) {\r\n        return cookieMgr.isEnabled();\r\n    }\r\n    return true;\r\n}\r\nfunction _createCookieMgrConfig(rootConfig) {\r\n    var cookieMgrCfg = rootConfig[_DYN_COOKIE_CFG /* @min:%2ecookieCfg */] = rootConfig[_DYN_COOKIE_CFG /* @min:%2ecookieCfg */] || {};\r\n    // Sets the values from the root config if not already present on the cookieMgrCfg\r\n    setValue(cookieMgrCfg, \"domain\", rootConfig.cookieDomain, isNotNullOrUndefined, isNullOrUndefined);\r\n    setValue(cookieMgrCfg, \"path\", rootConfig.cookiePath || \"/\", null, isNullOrUndefined);\r\n    if (isNullOrUndefined(cookieMgrCfg[strEnabled])) {\r\n        // Set the enabled from the provided setting or the legacy root values\r\n        var cookieEnabled = void 0;\r\n        if (!isUndefined(rootConfig[strIsCookieUseDisabled])) {\r\n            cookieEnabled = !rootConfig[strIsCookieUseDisabled];\r\n        }\r\n        if (!isUndefined(rootConfig[strDisableCookiesUsage])) {\r\n            cookieEnabled = !rootConfig[strDisableCookiesUsage];\r\n        }\r\n        cookieMgrCfg[strEnabled] = cookieEnabled;\r\n    }\r\n    return cookieMgrCfg;\r\n}\r\nfunction _isIgnoredCookie(cookieMgrCfg, name) {\r\n    if (name && cookieMgrCfg && isArray(cookieMgrCfg.ignoreCookies)) {\r\n        return cookieMgrCfg.ignoreCookies[_DYN_INDEX_OF /* @min:%2eindexOf */](name) !== -1;\r\n    }\r\n    return false;\r\n}\r\nfunction _isBlockedCookie(cookieMgrCfg, name) {\r\n    if (name && cookieMgrCfg && isArray(cookieMgrCfg.blockedCookies)) {\r\n        if (cookieMgrCfg.blockedCookies[_DYN_INDEX_OF /* @min:%2eindexOf */](name) !== -1) {\r\n            return true;\r\n        }\r\n    }\r\n    return _isIgnoredCookie(cookieMgrCfg, name);\r\n}\r\n/**\r\n * Helper to return the ICookieMgr from the core (if not null/undefined) or a default implementation\r\n * associated with the configuration or a legacy default.\r\n * @param core\r\n * @param config\r\n * @returns\r\n */\r\nexport function safeGetCookieMgr(core, config) {\r\n    var cookieMgr;\r\n    if (core) {\r\n        // Always returns an instance\r\n        cookieMgr = core.getCookieMgr();\r\n    }\r\n    else if (config) {\r\n        var cookieCfg = config[_DYN_COOKIE_CFG /* @min:%2ecookieCfg */];\r\n        if (cookieCfg[strConfigCookieMgr]) {\r\n            cookieMgr = cookieCfg[strConfigCookieMgr];\r\n        }\r\n        else {\r\n            cookieMgr = createCookieMgr(config);\r\n        }\r\n    }\r\n    if (!cookieMgr) {\r\n        // Get or initialize the default global (legacy) cookie manager if we couldn't find one\r\n        cookieMgr = _gblCookieMgr(config, (core || {})[_DYN_LOGGER /* @min:%2elogger */]);\r\n    }\r\n    return cookieMgr;\r\n}\r\nexport function createCookieMgr(rootConfig, logger) {\r\n    var _a;\r\n    var cookieMgrConfig = _createCookieMgrConfig(rootConfig || _globalCookieConfig);\r\n    var _path = cookieMgrConfig.path || \"/\";\r\n    var _domain = cookieMgrConfig.domain;\r\n    // Explicitly checking against false, so that setting to undefined will === true\r\n    var _enabled = cookieMgrConfig[strEnabled] !== false;\r\n    var cookieMgr = (_a = {\r\n            isEnabled: function () {\r\n                var enabled = _enabled && areCookiesSupported(logger);\r\n                // Using an indirect lookup for any global cookie manager to support tree shaking for SDK's\r\n                // that don't use the \"applicationinsights-core\" version of the default cookie function\r\n                var gblManager = _globalCookieConfig[strConfigCookieMgr];\r\n                if (enabled && gblManager && cookieMgr !== gblManager) {\r\n                    // Make sure the GlobalCookie Manager instance (if not this instance) is also enabled.\r\n                    // As the global (deprecated) functions may have been called (for backward compatibility)\r\n                    enabled = _isMgrEnabled(gblManager);\r\n                }\r\n                return enabled;\r\n            }\r\n        },\r\n        _a[_DYN_SET_ENABLED /* @min:setEnabled */] = function (value) {\r\n            // Explicitly checking against false, so that setting to undefined will === true\r\n            _enabled = value !== false;\r\n        },\r\n        _a.set = function (name, value, maxAgeSec, domain, path) {\r\n            var result = false;\r\n            if (_isMgrEnabled(cookieMgr) && !_isBlockedCookie(cookieMgrConfig, name)) {\r\n                var values = {};\r\n                var theValue = strTrim(value || STR_EMPTY);\r\n                var idx = theValue[_DYN_INDEX_OF /* @min:%2eindexOf */](\";\");\r\n                if (idx !== -1) {\r\n                    theValue = strTrim(value[_DYN_SUBSTRING /* @min:%2esubstring */](0, idx));\r\n                    values = _extractParts(value[_DYN_SUBSTRING /* @min:%2esubstring */](idx + 1));\r\n                }\r\n                // Only update domain if not already present (isUndefined) and the value is truthy (not null, undefined or empty string)\r\n                setValue(values, \"domain\", domain || _domain, isTruthy, isUndefined);\r\n                if (!isNullOrUndefined(maxAgeSec)) {\r\n                    var _isIE = isIE();\r\n                    if (isUndefined(values[strExpires])) {\r\n                        var nowMs = dateNow();\r\n                        // Only add expires if not already present\r\n                        var expireMs = nowMs + (maxAgeSec * 1000);\r\n                        // Sanity check, if zero or -ve then ignore\r\n                        if (expireMs > 0) {\r\n                            var expiry = new Date();\r\n                            expiry.setTime(expireMs);\r\n                            setValue(values, strExpires, _formatDate(expiry, !_isIE ? strToUTCString : strToGMTString) || _formatDate(expiry, _isIE ? strToGMTString : strToUTCString) || STR_EMPTY, isTruthy);\r\n                        }\r\n                    }\r\n                    if (!_isIE) {\r\n                        // Only replace if not already present\r\n                        setValue(values, \"max-age\", STR_EMPTY + maxAgeSec, null, isUndefined);\r\n                    }\r\n                }\r\n                var location_1 = getLocation();\r\n                if (location_1 && location_1.protocol === \"https:\") {\r\n                    setValue(values, \"secure\", null, null, isUndefined);\r\n                    // Only set same site if not also secure\r\n                    if (_allowUaSameSite === null) {\r\n                        _allowUaSameSite = !uaDisallowsSameSiteNone((getNavigator() || {})[_DYN_USER_AGENT /* @min:%2euserAgent */]);\r\n                    }\r\n                    if (_allowUaSameSite) {\r\n                        setValue(values, \"SameSite\", \"None\", null, isUndefined);\r\n                    }\r\n                }\r\n                setValue(values, \"path\", path || _path, null, isUndefined);\r\n                var setCookieFn = cookieMgrConfig.setCookie || _setCookieValue;\r\n                setCookieFn(name, _formatCookieValue(theValue, values));\r\n                result = true;\r\n            }\r\n            return result;\r\n        },\r\n        _a.get = function (name) {\r\n            var value = STR_EMPTY;\r\n            if (_isMgrEnabled(cookieMgr) && !_isIgnoredCookie(cookieMgrConfig, name)) {\r\n                value = (cookieMgrConfig.getCookie || _getCookieValue)(name);\r\n            }\r\n            return value;\r\n        },\r\n        _a.del = function (name, path) {\r\n            var result = false;\r\n            if (_isMgrEnabled(cookieMgr)) {\r\n                // Only remove the cookie if the manager and cookie support has not been disabled\r\n                result = cookieMgr.purge(name, path);\r\n            }\r\n            return result;\r\n        },\r\n        _a.purge = function (name, path) {\r\n            var _a;\r\n            var result = false;\r\n            if (areCookiesSupported(logger)) {\r\n                // Setting the expiration date in the past immediately removes the cookie\r\n                var values = (_a = {},\r\n                    _a[\"path\"] = path ? path : \"/\",\r\n                    _a[strExpires] = \"Thu, 01 Jan 1970 00:00:01 GMT\",\r\n                    _a);\r\n                if (!isIE()) {\r\n                    // Set max age to expire now\r\n                    values[\"max-age\"] = \"0\";\r\n                }\r\n                var delCookie = cookieMgrConfig.delCookie || _setCookieValue;\r\n                delCookie(name, _formatCookieValue(STR_EMPTY, values));\r\n                result = true;\r\n            }\r\n            return result;\r\n        },\r\n        _a);\r\n    // Associated this cookie manager with the config\r\n    cookieMgr[strConfigCookieMgr] = cookieMgr;\r\n    return cookieMgr;\r\n}\r\n/*\r\n* Helper method to tell if document.cookie object is supported by the runtime\r\n*/\r\nexport function areCookiesSupported(logger) {\r\n    if (_supportsCookies === null) {\r\n        _supportsCookies = false;\r\n        try {\r\n            var doc = _doc || {};\r\n            _supportsCookies = doc[strCookie] !== undefined;\r\n        }\r\n        catch (e) {\r\n            _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 68 /* _eInternalMessageId.CannotAccessCookie */, \"Cannot access document.cookie - \" + getExceptionName(e), { exception: dumpObj(e) });\r\n        }\r\n    }\r\n    return _supportsCookies;\r\n}\r\nfunction _extractParts(theValue) {\r\n    var values = {};\r\n    if (theValue && theValue[_DYN_LENGTH /* @min:%2elength */]) {\r\n        var parts = strTrim(theValue)[_DYN_SPLIT /* @min:%2esplit */](\";\");\r\n        arrForEach(parts, function (thePart) {\r\n            thePart = strTrim(thePart || STR_EMPTY);\r\n            if (thePart) {\r\n                var idx = thePart[_DYN_INDEX_OF /* @min:%2eindexOf */](\"=\");\r\n                if (idx === -1) {\r\n                    values[thePart] = null;\r\n                }\r\n                else {\r\n                    values[strTrim(thePart[_DYN_SUBSTRING /* @min:%2esubstring */](0, idx))] = strTrim(thePart[_DYN_SUBSTRING /* @min:%2esubstring */](idx + 1));\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return values;\r\n}\r\nfunction _formatDate(theDate, func) {\r\n    if (isFunction(theDate[func])) {\r\n        return theDate[func]();\r\n    }\r\n    return null;\r\n}\r\nfunction _formatCookieValue(value, values) {\r\n    var cookieValue = value || STR_EMPTY;\r\n    objForEachKey(values, function (name, theValue) {\r\n        cookieValue += \"; \" + name + (!isNullOrUndefined(theValue) ? \"=\" + theValue : STR_EMPTY);\r\n    });\r\n    return cookieValue;\r\n}\r\nfunction _getCookieValue(name) {\r\n    var cookieValue = STR_EMPTY;\r\n    if (_doc) {\r\n        var theCookie = _doc[strCookie] || STR_EMPTY;\r\n        if (_parsedCookieValue !== theCookie) {\r\n            _cookieCache = _extractParts(theCookie);\r\n            _parsedCookieValue = theCookie;\r\n        }\r\n        cookieValue = strTrim(_cookieCache[name] || STR_EMPTY);\r\n    }\r\n    return cookieValue;\r\n}\r\nfunction _setCookieValue(name, cookieValue) {\r\n    if (_doc) {\r\n        _doc[strCookie] = name + \"=\" + cookieValue;\r\n    }\r\n}\r\nexport function uaDisallowsSameSiteNone(userAgent) {\r\n    if (!isString(userAgent)) {\r\n        return false;\r\n    }\r\n    // Cover all iOS based browsers here. This includes:\r\n    // - Safari on iOS 12 for iPhone, iPod Touch, iPad\r\n    // - WkWebview on iOS 12 for iPhone, iPod Touch, iPad\r\n    // - Chrome on iOS 12 for iPhone, iPod Touch, iPad\r\n    // All of which are broken by SameSite=None, because they use the iOS networking stack\r\n    if (strContains(userAgent, \"CPU iPhone OS 12\") || strContains(userAgent, \"iPad; CPU OS 12\")) {\r\n        return true;\r\n    }\r\n    // Cover Mac OS X based browsers that use the Mac OS networking stack. This includes:\r\n    // - Safari on Mac OS X\r\n    // This does not include:\r\n    // - Internal browser on Mac OS X\r\n    // - Chrome on Mac OS X\r\n    // - Chromium on Mac OS X\r\n    // Because they do not use the Mac OS networking stack.\r\n    if (strContains(userAgent, \"Macintosh; Intel Mac OS X 10_14\") && strContains(userAgent, \"Version/\") && strContains(userAgent, \"Safari\")) {\r\n        return true;\r\n    }\r\n    // Cover Mac OS X internal browsers that use the Mac OS networking stack. This includes:\r\n    // - Internal browser on Mac OS X\r\n    // This does not include:\r\n    // - Safari on Mac OS X\r\n    // - Chrome on Mac OS X\r\n    // - Chromium on Mac OS X\r\n    // Because they do not use the Mac OS networking stack.\r\n    if (strContains(userAgent, \"Macintosh; Intel Mac OS X 10_14\") && strEndsWith(userAgent, \"AppleWebKit/605.1.15 (KHTML, like Gecko)\")) {\r\n        return true;\r\n    }\r\n    // Cover Chrome 50-69, because some versions are broken by SameSite=None, and none in this range require it.\r\n    // Note: this covers some pre-Chromium Edge versions, but pre-Chromim Edge does not require SameSite=None, so this is fine.\r\n    // Note: this regex applies to Windows, Mac OS X, and Linux, deliberately.\r\n    if (strContains(userAgent, \"Chrome/5\") || strContains(userAgent, \"Chrome/6\")) {\r\n        return true;\r\n    }\r\n    // Unreal Engine runs Chromium 59, but does not advertise as Chrome until 4.23. Treat versions of Unreal\r\n    // that don't specify their Chrome version as lacking support for SameSite=None.\r\n    if (strContains(userAgent, \"UnrealEngine\") && !strContains(userAgent, \"Chrome\")) {\r\n        return true;\r\n    }\r\n    // UCBrowser < 12.13.2 ignores Set-Cookie headers with SameSite=None\r\n    // NB: this rule isn't complete - you need regex to make a complete rule.\r\n    // See: https://www.chromium.org/updates/same-site/incompatible-clients\r\n    if (strContains(userAgent, \"UCBrowser/12\") || strContains(userAgent, \"UCBrowser/11\")) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n//# sourceMappingURL=CookieMgr.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { _DYN_HANDLER, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_REPLACE, _DYN_SPLICE, _DYN_SPLIT, _DYN_TYPE } from \"../__DynamicConstants\";\r\nimport { createElmNodeData, createUniqueNamespace } from \"./DataCacheHelper\";\r\nimport { getDocument, getWindow } from \"./EnvUtils\";\r\nimport { arrForEach, arrIndexOf, isArray, objForEachKey, objKeys } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n// Added to help with minfication\r\nvar strOnPrefix = \"on\";\r\nvar strAttachEvent = \"attachEvent\";\r\nvar strAddEventHelper = \"addEventListener\";\r\nvar strDetachEvent = \"detachEvent\";\r\nvar strRemoveEventListener = \"removeEventListener\";\r\nvar strEvents = \"events\";\r\nvar strVisibilityChangeEvt = \"visibilitychange\";\r\nvar strPageHide = \"pagehide\";\r\nvar strPageShow = \"pageshow\";\r\nvar strUnload = \"unload\";\r\nvar strBeforeUnload = \"beforeunload\";\r\nvar strPageHideNamespace = createUniqueNamespace(\"aiEvtPageHide\");\r\nvar strPageShowNamespace = createUniqueNamespace(\"aiEvtPageShow\");\r\nvar rRemoveEmptyNs = /\\.[\\.]+/g;\r\nvar rRemoveTrailingEmptyNs = /[\\.]+$/;\r\nvar _guid = 1;\r\nvar elmNodeData = createElmNodeData(\"events\");\r\nvar eventNamespace = /^([^.]*)(?:\\.(.+)|)/;\r\nfunction _normalizeNamespace(name) {\r\n    if (name && name[_DYN_REPLACE /* @min:%2ereplace */]) {\r\n        return name[_DYN_REPLACE /* @min:%2ereplace */](/^[\\s\\.]+|(?=[\\s\\.])[\\.\\s]+$/g, STR_EMPTY);\r\n    }\r\n    return name;\r\n}\r\nfunction _getEvtNamespace(eventName, evtNamespace) {\r\n    var _a;\r\n    if (evtNamespace) {\r\n        var theNamespace_1 = STR_EMPTY;\r\n        if (isArray(evtNamespace)) {\r\n            theNamespace_1 = STR_EMPTY;\r\n            arrForEach(evtNamespace, function (name) {\r\n                name = _normalizeNamespace(name);\r\n                if (name) {\r\n                    if (name[0] !== \".\") {\r\n                        name = \".\" + name;\r\n                    }\r\n                    theNamespace_1 += name;\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            theNamespace_1 = _normalizeNamespace(evtNamespace);\r\n        }\r\n        if (theNamespace_1) {\r\n            if (theNamespace_1[0] !== \".\") {\r\n                theNamespace_1 = \".\" + theNamespace_1;\r\n            }\r\n            // We may only have the namespace and not an eventName\r\n            eventName = (eventName || STR_EMPTY) + theNamespace_1;\r\n        }\r\n    }\r\n    var parsedEvent = (eventNamespace.exec(eventName || STR_EMPTY) || []);\r\n    return _a = {},\r\n        _a[_DYN_TYPE /* @min:type */] = parsedEvent[1],\r\n        _a.ns = ((parsedEvent[2] || STR_EMPTY).replace(rRemoveEmptyNs, \".\").replace(rRemoveTrailingEmptyNs, STR_EMPTY)[_DYN_SPLIT /* @min:%2esplit */](\".\").sort()).join(\".\"),\r\n        _a;\r\n}\r\n/**\r\n * Get all of the registered events on the target object, this is primarily used for testing cleanup but may also be used by\r\n * applications to remove their own events\r\n * @param target - The EventTarget that has registered events\r\n * @param eventName - [Optional] The name of the event to return the registered handlers and full name (with namespaces)\r\n * @param evtNamespace - [Optional] Additional namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace,\r\n * if the eventName also includes a namespace the namespace(s) are merged into a single namespace\r\n */\r\nexport function __getRegisteredEvents(target, eventName, evtNamespace) {\r\n    var theEvents = [];\r\n    var eventCache = elmNodeData.get(target, strEvents, {}, false);\r\n    var evtName = _getEvtNamespace(eventName, evtNamespace);\r\n    objForEachKey(eventCache, function (evtType, registeredEvents) {\r\n        arrForEach(registeredEvents, function (value) {\r\n            var _a;\r\n            if (!evtName[_DYN_TYPE /* @min:%2etype */] || evtName[_DYN_TYPE /* @min:%2etype */] === value.evtName[_DYN_TYPE /* @min:%2etype */]) {\r\n                if (!evtName.ns || evtName.ns === evtName.ns) {\r\n                    theEvents[_DYN_PUSH /* @min:%2epush */]((_a = {},\r\n                        _a[_DYN_NAME /* @min:name */] = value.evtName[_DYN_TYPE /* @min:%2etype */] + (value.evtName.ns ? \".\" + value.evtName.ns : STR_EMPTY),\r\n                        _a.handler = value[_DYN_HANDLER /* @min:%2ehandler */],\r\n                        _a));\r\n                }\r\n            }\r\n        });\r\n    });\r\n    return theEvents;\r\n}\r\n// Exported for internal unit testing only\r\nfunction _getRegisteredEvents(target, evtName, addDefault) {\r\n    if (addDefault === void 0) { addDefault = true; }\r\n    var aiEvts = elmNodeData.get(target, strEvents, {}, addDefault);\r\n    var registeredEvents = aiEvts[evtName];\r\n    if (!registeredEvents) {\r\n        registeredEvents = aiEvts[evtName] = [];\r\n    }\r\n    return registeredEvents;\r\n}\r\nfunction _doDetach(obj, evtName, handlerRef, useCapture) {\r\n    if (obj && evtName && evtName[_DYN_TYPE /* @min:%2etype */]) {\r\n        if (obj[strRemoveEventListener]) {\r\n            obj[strRemoveEventListener](evtName[_DYN_TYPE /* @min:%2etype */], handlerRef, useCapture);\r\n        }\r\n        else if (obj[strDetachEvent]) {\r\n            obj[strDetachEvent](strOnPrefix + evtName[_DYN_TYPE /* @min:%2etype */], handlerRef);\r\n        }\r\n    }\r\n}\r\nfunction _doAttach(obj, evtName, handlerRef, useCapture) {\r\n    var result = false;\r\n    if (obj && evtName && evtName[_DYN_TYPE /* @min:%2etype */] && handlerRef) {\r\n        if (obj[strAddEventHelper]) {\r\n            // all browsers except IE before version 9\r\n            obj[strAddEventHelper](evtName[_DYN_TYPE /* @min:%2etype */], handlerRef, useCapture);\r\n            result = true;\r\n        }\r\n        else if (obj[strAttachEvent]) {\r\n            // IE before version 9\r\n            obj[strAttachEvent](strOnPrefix + evtName[_DYN_TYPE /* @min:%2etype */], handlerRef);\r\n            result = true;\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction _doUnregister(target, events, evtName, unRegFn) {\r\n    var idx = events[_DYN_LENGTH /* @min:%2elength */];\r\n    while (idx--) {\r\n        var theEvent = events[idx];\r\n        if (theEvent) {\r\n            if (!evtName.ns || evtName.ns === theEvent.evtName.ns) {\r\n                if (!unRegFn || unRegFn(theEvent)) {\r\n                    _doDetach(target, theEvent.evtName, theEvent[_DYN_HANDLER /* @min:%2ehandler */], theEvent.capture);\r\n                    // Remove the registered event\r\n                    events[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction _unregisterEvents(target, evtName, unRegFn) {\r\n    if (evtName[_DYN_TYPE /* @min:%2etype */]) {\r\n        _doUnregister(target, _getRegisteredEvents(target, evtName[_DYN_TYPE /* @min:%2etype */]), evtName, unRegFn);\r\n    }\r\n    else {\r\n        var eventCache = elmNodeData.get(target, strEvents, {});\r\n        objForEachKey(eventCache, function (evtType, events) {\r\n            _doUnregister(target, events, evtName, unRegFn);\r\n        });\r\n        // Cleanup\r\n        if (objKeys(eventCache)[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n            elmNodeData.kill(target, strEvents);\r\n        }\r\n    }\r\n}\r\nexport function mergeEvtNamespace(theNamespace, namespaces) {\r\n    var newNamespaces;\r\n    if (namespaces) {\r\n        if (isArray(namespaces)) {\r\n            newNamespaces = [theNamespace].concat(namespaces);\r\n        }\r\n        else {\r\n            newNamespaces = [theNamespace, namespaces];\r\n        }\r\n        // resort the namespaces so they are always in order\r\n        newNamespaces = (_getEvtNamespace(\"xx\", newNamespaces).ns)[_DYN_SPLIT /* @min:%2esplit */](\".\");\r\n    }\r\n    else {\r\n        newNamespaces = theNamespace;\r\n    }\r\n    return newNamespaces;\r\n}\r\n/**\r\n * Binds the specified function to an event, so that the function gets called whenever the event fires on the object\r\n * @param obj Object to add the event too.\r\n * @param eventName String that specifies any of the standard DHTML Events without \"on\" prefix, if may also include an optional (dot \".\" prefixed)\r\n * namespaces \"click\" \"click.mynamespace\" in addition to specific namespaces.\r\n * @param handlerRef Pointer that specifies the function to call when event fires\r\n * @param evtNamespace - [Optional] Additional namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace,\r\n * if the eventName also includes a namespace the namespace(s) are merged into a single namespace\r\n * @param useCapture [Optional] Defaults to false\r\n * @returns True if the function was bound successfully to the event, otherwise false\r\n */\r\nexport function eventOn(target, eventName, handlerRef, evtNamespace, useCapture) {\r\n    var _a;\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    var result = false;\r\n    if (target) {\r\n        try {\r\n            var evtName = _getEvtNamespace(eventName, evtNamespace);\r\n            result = _doAttach(target, evtName, handlerRef, useCapture);\r\n            if (result && elmNodeData.accept(target)) {\r\n                var registeredEvent = (_a = {\r\n                        guid: _guid++,\r\n                        evtName: evtName\r\n                    },\r\n                    _a[_DYN_HANDLER /* @min:handler */] = handlerRef,\r\n                    _a.capture = useCapture,\r\n                    _a);\r\n                _getRegisteredEvents(target, evtName.type)[_DYN_PUSH /* @min:%2epush */](registeredEvent);\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Just Ignore any error so that we don't break any execution path\r\n        }\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Removes an event handler for the specified event\r\n * @param Object to remove the event from\r\n * @param eventName {string} - The name of the event, with optional namespaces or just the namespaces,\r\n * such as \"click\", \"click.mynamespace\" or \".mynamespace\"\r\n * @param handlerRef {any} - The callback function that needs to be removed from the given event, when using a\r\n * namespace (with or without a qualifying event) this may be null to remove all previously attached event handlers\r\n * otherwise this will only remove events with this specific handler.\r\n * @param evtNamespace - [Optional] Additional namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace,\r\n * if the eventName also includes a namespace the namespace(s) are merged into a single namespace\r\n * @param useCapture [Optional] Defaults to false\r\n */\r\nexport function eventOff(target, eventName, handlerRef, evtNamespace, useCapture) {\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    if (target) {\r\n        try {\r\n            var evtName_1 = _getEvtNamespace(eventName, evtNamespace);\r\n            var found_1 = false;\r\n            _unregisterEvents(target, evtName_1, function (regEvent) {\r\n                if ((evtName_1.ns && !handlerRef) || regEvent[_DYN_HANDLER /* @min:%2ehandler */] === handlerRef) {\r\n                    found_1 = true;\r\n                    return true;\r\n                }\r\n                return false;\r\n            });\r\n            if (!found_1) {\r\n                // fallback to try and remove as requested\r\n                _doDetach(target, evtName_1, handlerRef, useCapture);\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Just Ignore any error so that we don't break any execution path\r\n        }\r\n    }\r\n}\r\n/**\r\n * Binds the specified function to an event, so that the function gets called whenever the event fires on the object\r\n * @param obj Object to add the event too.\r\n * @param eventNameWithoutOn String that specifies any of the standard DHTML Events without \"on\" prefix and optional (dot \".\" prefixed) namespaces \"click\" \"click.mynamespace\".\r\n * @param handlerRef Pointer that specifies the function to call when event fires\r\n * @param useCapture [Optional] Defaults to false\r\n * @returns True if the function was bound successfully to the event, otherwise false\r\n */\r\nexport function attachEvent(obj, eventNameWithoutOn, handlerRef, useCapture) {\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    return eventOn(obj, eventNameWithoutOn, handlerRef, null, useCapture);\r\n}\r\n/**\r\n * Removes an event handler for the specified event\r\n * @param Object to remove the event from\r\n * @param eventNameWithoutOn {string} - The name of the event, with optional namespaces or just the namespaces,\r\n * such as \"click\", \"click.mynamespace\" or \".mynamespace\"\r\n * @param handlerRef {any} - The callback function that needs to be removed from the given event, when using a\r\n * namespace (with or without a qualifying event) this may be null to remove all previously attached event handlers\r\n * otherwise this will only remove events with this specific handler.\r\n * @param useCapture [Optional] Defaults to false\r\n */\r\nexport function detachEvent(obj, eventNameWithoutOn, handlerRef, useCapture) {\r\n    if (useCapture === void 0) { useCapture = false; }\r\n    eventOff(obj, eventNameWithoutOn, handlerRef, null, useCapture);\r\n}\r\n/**\r\n * Trys to add an event handler for the specified event to the window, body and document\r\n * @param eventName {string} - The name of the event\r\n * @param callback {any} - The callback function that needs to be executed for the given event\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @return {boolean} - true if the handler was successfully added\r\n */\r\nexport function addEventHandler(eventName, callback, evtNamespace) {\r\n    var result = false;\r\n    var w = getWindow();\r\n    if (w) {\r\n        result = eventOn(w, eventName, callback, evtNamespace);\r\n        result = eventOn(w[\"body\"], eventName, callback, evtNamespace) || result;\r\n    }\r\n    var doc = getDocument();\r\n    if (doc) {\r\n        result = eventOn(doc, eventName, callback, evtNamespace) || result;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Trys to remove event handler(s) for the specified event/namespace to the window, body and document\r\n * @param eventName {string} - The name of the event, with optional namespaces or just the namespaces,\r\n * such as \"click\", \"click.mynamespace\" or \".mynamespace\"\r\n * @param callback {any} - - The callback function that needs to be removed from the given event, when using a\r\n * namespace (with or without a qualifying event) this may be null to remove all previously attached event handlers\r\n * otherwise this will only remove events with this specific handler.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n */\r\nexport function removeEventHandler(eventName, callback, evtNamespace) {\r\n    var w = getWindow();\r\n    if (w) {\r\n        eventOff(w, eventName, callback, evtNamespace);\r\n        eventOff(w[\"body\"], eventName, callback, evtNamespace);\r\n    }\r\n    var doc = getDocument();\r\n    if (doc) {\r\n        eventOff(doc, eventName, callback, evtNamespace);\r\n    }\r\n}\r\n/**\r\n * Bind the listener to the array of events\r\n * @param events An string array of event names to bind the listener to\r\n * @param listener The event callback to call when the event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nfunction _addEventListeners(events, listener, excludeEvents, evtNamespace) {\r\n    var added = false;\r\n    if (listener && events && events[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        arrForEach(events, function (name) {\r\n            if (name) {\r\n                if (!excludeEvents || arrIndexOf(excludeEvents, name) === -1) {\r\n                    added = addEventHandler(name, listener, evtNamespace) || added;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return added;\r\n}\r\n/**\r\n * Bind the listener to the array of events\r\n * @param events An string array of event names to bind the listener to\r\n * @param listener The event callback to call when the event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addEventListeners(events, listener, excludeEvents, evtNamespace) {\r\n    var added = false;\r\n    if (listener && events && isArray(events)) {\r\n        added = _addEventListeners(events, listener, excludeEvents, evtNamespace);\r\n        if (!added && excludeEvents && excludeEvents[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            // Failed to add any listeners and we excluded some, so just attempt to add the excluded events\r\n            added = _addEventListeners(events, listener, null, evtNamespace);\r\n        }\r\n    }\r\n    return added;\r\n}\r\n/**\r\n * Remove the listener from the array of events\r\n * @param events An string array of event names to bind the listener to\r\n * @param listener The event callback to call when the event is triggered\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n */\r\nexport function removeEventListeners(events, listener, evtNamespace) {\r\n    if (events && isArray(events)) {\r\n        arrForEach(events, function (name) {\r\n            if (name) {\r\n                removeEventHandler(name, listener, evtNamespace);\r\n            }\r\n        });\r\n    }\r\n}\r\n/**\r\n * Listen to the 'beforeunload', 'unload' and 'pagehide' events which indicates a page unload is occurring,\r\n * this does NOT listen to the 'visibilitychange' event as while it does indicate that the page is being hidden\r\n * it does not *necessarily* mean that the page is being completely unloaded, it can mean that the user is\r\n * just navigating to a different Tab and may come back (without unloading the page). As such you may also\r\n * need to listen to the 'addPageHideEventListener' and 'addPageShowEventListener' events.\r\n * @param listener - The event callback to call when a page unload event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked, unless no other events can be.\r\n * @param evtNamespace - [Optional] Namespace(s) to append to the event listeners so they can be uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addPageUnloadEventListener(listener, excludeEvents, evtNamespace) {\r\n    // Hook the unload event for the document, window and body to ensure that the client events are flushed to the server\r\n    // As just hooking the window does not always fire (on chrome) for page navigation's.\r\n    return addEventListeners([strBeforeUnload, strUnload, strPageHide], listener, excludeEvents, evtNamespace);\r\n}\r\n/**\r\n * Remove any matching 'beforeunload', 'unload' and 'pagehide' events that may have been added via addEventListener,\r\n * addEventListeners, addPageUnloadEventListener or addPageHideEventListener.\r\n * @param listener - The specific event callback to to be removed\r\n * @param evtNamespace - [Optional] Namespace(s) uniquely identified and removed based on this namespace.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function removePageUnloadEventListener(listener, evtNamespace) {\r\n    removeEventListeners([strBeforeUnload, strUnload, strPageHide], listener, evtNamespace);\r\n}\r\n/**\r\n * Listen to the pagehide and visibility changing to 'hidden' events, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when if you plan to call\r\n * removePageShowEventListener as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The event callback to call when a page hide event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional] A Namespace to append to the event listeners so they can be uniquely identified and removed\r\n * based on this namespace. This call also adds an additional unique \"pageshow\" namespace to the events\r\n * so that only the matching \"removePageHideEventListener\" can remove these events.\r\n * Suggestion: pass as true if you are also calling addPageUnloadEventListener as that also hooks pagehide\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addPageHideEventListener(listener, excludeEvents, evtNamespace) {\r\n    function _handlePageVisibility(evt) {\r\n        var doc = getDocument();\r\n        if (listener && doc && doc.visibilityState === \"hidden\") {\r\n            listener(evt);\r\n        }\r\n    }\r\n    // add the unique page show namespace to any provided namespace so we can only remove the ones added by \"pagehide\"\r\n    var newNamespaces = mergeEvtNamespace(strPageHideNamespace, evtNamespace);\r\n    var pageUnloadAdded = _addEventListeners([strPageHide], listener, excludeEvents, newNamespaces);\r\n    if (!excludeEvents || arrIndexOf(excludeEvents, strVisibilityChangeEvt) === -1) {\r\n        pageUnloadAdded = _addEventListeners([strVisibilityChangeEvt], _handlePageVisibility, excludeEvents, newNamespaces) || pageUnloadAdded;\r\n    }\r\n    if (!pageUnloadAdded && excludeEvents) {\r\n        // Failed to add any listeners and we where requested to exclude some, so just call again without excluding anything\r\n        pageUnloadAdded = addPageHideEventListener(listener, null, evtNamespace);\r\n    }\r\n    return pageUnloadAdded;\r\n}\r\n/**\r\n * Removes the pageHide event listeners added by addPageHideEventListener, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when calling addPageHideEventListener\r\n * as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The specific listener to remove for the 'pageshow' event only (ignored for 'visibilitychange')\r\n * @param evtNamespace - The unique namespace used when calling addPageShowEventListener\r\n */\r\nexport function removePageHideEventListener(listener, evtNamespace) {\r\n    // add the unique page show namespace to any provided namespace so we only remove the ones added by \"pagehide\"\r\n    var newNamespaces = mergeEvtNamespace(strPageHideNamespace, evtNamespace);\r\n    removeEventListeners([strPageHide], listener, newNamespaces);\r\n    removeEventListeners([strVisibilityChangeEvt], null, newNamespaces);\r\n}\r\n/**\r\n * Listen to the pageshow and visibility changing to 'visible' events, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when if you plan to call\r\n * removePageShowEventListener as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The event callback to call when a page is show event is triggered\r\n * @param excludeEvents - [Optional] An array of events that should not be hooked (if possible), unless no other events can be.\r\n * @param evtNamespace - [Optional/Recommended] A Namespace to append to the event listeners so they can be uniquely\r\n * identified and removed based on this namespace. This call also adds an additional unique \"pageshow\" namespace to the events\r\n * so that only the matching \"removePageShowEventListener\" can remove these events.\r\n * @returns true - when at least one of the events was registered otherwise false\r\n */\r\nexport function addPageShowEventListener(listener, excludeEvents, evtNamespace) {\r\n    function _handlePageVisibility(evt) {\r\n        var doc = getDocument();\r\n        if (listener && doc && doc.visibilityState === \"visible\") {\r\n            listener(evt);\r\n        }\r\n    }\r\n    // add the unique page show namespace to any provided namespace so we can only remove the ones added by \"pageshow\"\r\n    var newNamespaces = mergeEvtNamespace(strPageShowNamespace, evtNamespace);\r\n    var pageShowAdded = _addEventListeners([strPageShow], listener, excludeEvents, newNamespaces);\r\n    pageShowAdded = _addEventListeners([strVisibilityChangeEvt], _handlePageVisibility, excludeEvents, newNamespaces) || pageShowAdded;\r\n    if (!pageShowAdded && excludeEvents) {\r\n        // Failed to add any listeners and we where requested to exclude some, so just call again without excluding anything\r\n        pageShowAdded = addPageShowEventListener(listener, null, evtNamespace);\r\n    }\r\n    return pageShowAdded;\r\n}\r\n/**\r\n * Removes the pageShow event listeners added by addPageShowEventListener, because the 'visibilitychange' uses\r\n * an internal proxy to detect the visibility state you SHOULD use a unique namespace when calling addPageShowEventListener\r\n * as the remove ignores the listener argument for the 'visibilitychange' event.\r\n * @param listener - The specific listener to remove for the 'pageshow' event only (ignored for 'visibilitychange')\r\n * @param evtNamespace - The unique namespace used when calling addPageShowEventListener\r\n */\r\nexport function removePageShowEventListener(listener, evtNamespace) {\r\n    // add the unique page show namespace to any provided namespace so we only remove the ones added by \"pageshow\"\r\n    var newNamespaces = mergeEvtNamespace(strPageShowNamespace, evtNamespace);\r\n    removeEventListeners([strPageShow], listener, newNamespaces);\r\n    removeEventListeners([strVisibilityChangeEvt], null, newNamespaces);\r\n}\r\n//# sourceMappingURL=EventHelpers.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport { objCreateFn, strShimUndefined } from \"@microsoft/applicationinsights-shims\";\r\nimport { _DYN_LENGTH, _DYN_PUSH, _DYN_SET_ENABLED, _DYN_SUBSTR, _DYN_SUBSTRING } from \"../__DynamicConstants\";\r\nimport { _gblCookieMgr } from \"./CookieMgr\";\r\nimport { getPerformance, isIE } from \"./EnvUtils\";\r\nimport { addEventHandler, attachEvent, detachEvent } from \"./EventHelpers\";\r\nimport { arrForEach, arrIndexOf, arrMap, arrReduce, dateNow, hasOwnProperty, isArray, isBoolean, isDate, isError, isFunction, isNullOrUndefined, isNumber, isObject, isString, isTypeof, isUndefined, objDefineAccessors, objKeys, strTrim, toISOString } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nimport { mwcRandom32, mwcRandomSeed, newId, random32, randomValue } from \"./RandomHelper\";\r\nvar _cookieMgrs = null;\r\nvar _canUseCookies; // legacy supported config\r\n// Added to help with minfication\r\nexport var Undefined = strShimUndefined;\r\nexport function newGuid() {\r\n    var uuid = generateW3CId();\r\n    return uuid[_DYN_SUBSTRING /* @min:%2esubstring */](0, 8) + \"-\" + uuid[_DYN_SUBSTRING /* @min:%2esubstring */](8, 12) + \"-\" + uuid[_DYN_SUBSTRING /* @min:%2esubstring */](12, 16) + \"-\" + uuid[_DYN_SUBSTRING /* @min:%2esubstring */](16, 20) + \"-\" + uuid[_DYN_SUBSTRING /* @min:%2esubstring */](20);\r\n}\r\n/**\r\n * Return the current value of the Performance Api now() function (if available) and fallback to dateNow() if it is unavailable (IE9 or less)\r\n * https://caniuse.com/#search=performance.now\r\n */\r\nexport function perfNow() {\r\n    var perf = getPerformance();\r\n    if (perf && perf.now) {\r\n        return perf.now();\r\n    }\r\n    return dateNow();\r\n}\r\n/**\r\n * The strEndsWith() method determines whether a string ends with the characters of a specified string, returning true or false as appropriate.\r\n * @param value - The value to check whether it ends with the search value.\r\n * @param search - The characters to be searched for at the end of the value.\r\n * @returns true if the given search value is found at the end of the string, otherwise false.\r\n */\r\nexport function strEndsWith(value, search) {\r\n    if (value && search) {\r\n        var len = value[_DYN_LENGTH /* @min:%2elength */];\r\n        var start = len - search[_DYN_LENGTH /* @min:%2elength */];\r\n        return value[_DYN_SUBSTRING /* @min:%2esubstring */](start >= 0 ? start : 0, len) === search;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * generate W3C trace id\r\n */\r\nexport function generateW3CId() {\r\n    var hexValues = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\r\n    // rfc4122 version 4 UUID without dashes and with lowercase letters\r\n    var oct = STR_EMPTY, tmp;\r\n    for (var a = 0; a < 4; a++) {\r\n        tmp = random32();\r\n        oct +=\r\n            hexValues[tmp & 0xF] +\r\n                hexValues[tmp >> 4 & 0xF] +\r\n                hexValues[tmp >> 8 & 0xF] +\r\n                hexValues[tmp >> 12 & 0xF] +\r\n                hexValues[tmp >> 16 & 0xF] +\r\n                hexValues[tmp >> 20 & 0xF] +\r\n                hexValues[tmp >> 24 & 0xF] +\r\n                hexValues[tmp >> 28 & 0xF];\r\n    }\r\n    // \"Set the two most significant bits (bits 6 and 7) of the clock_seq_hi_and_reserved to zero and one, respectively\"\r\n    var clockSequenceHi = hexValues[8 + (random32() & 0x03) | 0];\r\n    return oct[_DYN_SUBSTR /* @min:%2esubstr */](0, 8) + oct[_DYN_SUBSTR /* @min:%2esubstr */](9, 4) + \"4\" + oct[_DYN_SUBSTR /* @min:%2esubstr */](13, 3) + clockSequenceHi + oct[_DYN_SUBSTR /* @min:%2esubstr */](16, 3) + oct[_DYN_SUBSTR /* @min:%2esubstr */](19, 12);\r\n}\r\n/**\r\n * Provides a collection of utility functions, included for backward compatibility with previous releases.\r\n * @deprecated Marking this instance as deprecated in favor of direct usage of the helper functions\r\n * as direct usage provides better tree-shaking and minification by avoiding the inclusion of the unused items\r\n * in your resulting code.\r\n */\r\nexport var CoreUtils = {\r\n    _canUseCookies: undefined,\r\n    isTypeof: isTypeof,\r\n    isUndefined: isUndefined,\r\n    isNullOrUndefined: isNullOrUndefined,\r\n    hasOwnProperty: hasOwnProperty,\r\n    isFunction: isFunction,\r\n    isObject: isObject,\r\n    isDate: isDate,\r\n    isArray: isArray,\r\n    isError: isError,\r\n    isString: isString,\r\n    isNumber: isNumber,\r\n    isBoolean: isBoolean,\r\n    toISOString: toISOString,\r\n    arrForEach: arrForEach,\r\n    arrIndexOf: arrIndexOf,\r\n    arrMap: arrMap,\r\n    arrReduce: arrReduce,\r\n    strTrim: strTrim,\r\n    objCreate: objCreateFn,\r\n    objKeys: objKeys,\r\n    objDefineAccessors: objDefineAccessors,\r\n    addEventHandler: addEventHandler,\r\n    dateNow: dateNow,\r\n    isIE: isIE,\r\n    disableCookies: disableCookies,\r\n    newGuid: newGuid,\r\n    perfNow: perfNow,\r\n    newId: newId,\r\n    randomValue: randomValue,\r\n    random32: random32,\r\n    mwcRandomSeed: mwcRandomSeed,\r\n    mwcRandom32: mwcRandom32,\r\n    generateW3CId: generateW3CId\r\n};\r\nvar GuidRegex = /[xy]/g;\r\nexport var EventHelper = {\r\n    Attach: attachEvent,\r\n    AttachEvent: attachEvent,\r\n    Detach: detachEvent,\r\n    DetachEvent: detachEvent\r\n};\r\n/**\r\n * Helper to support backward compatibility for users that use the legacy cookie handling functions and the use the internal\r\n * CoreUtils._canUseCookies global flag to enable/disable cookies usage.\r\n * Note: This has the following deliberate side-effects\r\n * - Creates the global (legacy) cookie manager if it does not already exist\r\n * - Attempts to add \"listeners\" to the CoreUtils._canUseCookies property to support the legacy usage\r\n * @param config\r\n * @param logger\r\n * @returns\r\n */\r\nexport function _legacyCookieMgr(config, logger) {\r\n    var cookieMgr = _gblCookieMgr(config, logger);\r\n    var legacyCanUseCookies = CoreUtils._canUseCookies;\r\n    if (_cookieMgrs === null) {\r\n        _cookieMgrs = [];\r\n        _canUseCookies = legacyCanUseCookies;\r\n        // Dynamically create get/set property accessors for backward compatibility for enabling / disabling cookies\r\n        // this WILL NOT work for ES3 browsers (< IE8)\r\n        objDefineAccessors(CoreUtils, \"_canUseCookies\", function () {\r\n            return _canUseCookies;\r\n        }, function (value) {\r\n            _canUseCookies = value;\r\n            arrForEach(_cookieMgrs, function (mgr) {\r\n                mgr[_DYN_SET_ENABLED /* @min:%2esetEnabled */](value);\r\n            });\r\n        });\r\n    }\r\n    if (arrIndexOf(_cookieMgrs, cookieMgr) === -1) {\r\n        _cookieMgrs[_DYN_PUSH /* @min:%2epush */](cookieMgr);\r\n    }\r\n    if (isBoolean(legacyCanUseCookies)) {\r\n        cookieMgr[_DYN_SET_ENABLED /* @min:%2esetEnabled */](legacyCanUseCookies);\r\n    }\r\n    if (isBoolean(_canUseCookies)) {\r\n        cookieMgr[_DYN_SET_ENABLED /* @min:%2esetEnabled */](_canUseCookies);\r\n    }\r\n    return cookieMgr;\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().disable()\r\n * Force the SDK not to store and read any data from cookies.\r\n */\r\nexport function disableCookies() {\r\n    _legacyCookieMgr()[_DYN_SET_ENABLED /* @min:%2esetEnabled */](false);\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().isEnabled()\r\n * Helper method to tell if document.cookie object is available and whether it can be used.\r\n */\r\nexport function canUseCookies(logger) {\r\n    return _legacyCookieMgr(null, logger).isEnabled();\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().get()\r\n * helper method to access userId and sessionId cookie\r\n */\r\nexport function getCookie(logger, name) {\r\n    return _legacyCookieMgr(null, logger).get(name);\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().set()\r\n * helper method to set userId and sessionId cookie\r\n */\r\nexport function setCookie(logger, name, value, domain) {\r\n    _legacyCookieMgr(null, logger).set(name, value, null, domain);\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().del()\r\n * Deletes a cookie by setting it's expiration time in the past.\r\n * @param name - The name of the cookie to delete.\r\n */\r\nexport function deleteCookie(logger, name) {\r\n    return _legacyCookieMgr(null, logger).del(name);\r\n}\r\n//# sourceMappingURL=CoreUtils.js.map", "import { _DYN_INDEX_OF, _DYN_LENGTH, _DYN_SPAN_ID, _DYN_SPLIT, _DYN_SUBSTR, _DYN_TO_LOWER_CASE, _DYN_TRACE_FLAGS, _DYN_TRACE_ID, _DYN_VERSION } from \"../__DynamicConstants\";\r\nimport { generateW3CId } from \"./CoreUtils\";\r\nimport { findMetaTag, findNamedServerTiming } from \"./EnvUtils\";\r\nimport { isArray, isString, strTrim } from \"./HelperFuncs\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n// using {0,16} for leading and trailing whitespace just to constrain the possible runtime of a random string\r\nvar TRACE_PARENT_REGEX = /^([\\da-f]{2})-([\\da-f]{32})-([\\da-f]{16})-([\\da-f]{2})(-[^\\s]{1,64})?$/i;\r\nvar DEFAULT_VERSION = \"00\";\r\nvar INVALID_VERSION = \"ff\";\r\nvar INVALID_TRACE_ID = \"00000000000000000000000000000000\";\r\nvar INVALID_SPAN_ID = \"0000000000000000\";\r\nvar SAMPLED_FLAG = 0x01;\r\nfunction _isValid(value, len, invalidValue) {\r\n    if (value && value[_DYN_LENGTH /* @min:%2elength */] === len && value !== invalidValue) {\r\n        return !!value.match(/^[\\da-f]*$/i);\r\n    }\r\n    return false;\r\n}\r\nfunction _formatValue(value, len, defValue) {\r\n    if (_isValid(value, len)) {\r\n        return value;\r\n    }\r\n    return defValue;\r\n}\r\nfunction _formatFlags(value) {\r\n    if (isNaN(value) || value < 0 || value > 255) {\r\n        value = 0x01;\r\n    }\r\n    var result = value.toString(16);\r\n    while (result[_DYN_LENGTH /* @min:%2elength */] < 2) {\r\n        result = \"0\" + result;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * Create a new ITraceParent instance using the provided values.\r\n * @param traceId - The traceId to use, when invalid a new random W3C id will be generated.\r\n * @param spanId - The parent/span id to use, a new random value will be generated if it is invalid.\r\n * @param flags - The traceFlags to use, defaults to zero (0) if not supplied or invalid\r\n * @param version - The version to used, defaults to version \"01\" if not supplied or invalid.\r\n * @returns\r\n */\r\nexport function createTraceParent(traceId, spanId, flags, version) {\r\n    var _a;\r\n    return _a = {},\r\n        _a[_DYN_VERSION /* @min:version */] = _isValid(version, 2, INVALID_VERSION) ? version : DEFAULT_VERSION,\r\n        _a[_DYN_TRACE_ID /* @min:traceId */] = isValidTraceId(traceId) ? traceId : generateW3CId(),\r\n        _a.spanId = isValidSpanId(spanId) ? spanId : generateW3CId()[_DYN_SUBSTR /* @min:%2esubstr */](0, 16),\r\n        _a.traceFlags = flags >= 0 && flags <= 0xFF ? flags : 1,\r\n        _a;\r\n}\r\n/**\r\n * Attempt to parse the provided string as a W3C TraceParent header value (https://www.w3.org/TR/trace-context/#traceparent-header)\r\n *\r\n * @param value - The value to be parsed\r\n * @param selectIdx - If the found value is comma separated which is the preferred entry to select, defaults to the first\r\n * @returns\r\n */\r\nexport function parseTraceParent(value, selectIdx) {\r\n    var _a;\r\n    if (!value) {\r\n        // Don't pass a null/undefined or empty string\r\n        return null;\r\n    }\r\n    if (isArray(value)) {\r\n        // The value may have been encoded on the page into an array so handle this automatically\r\n        value = value[0] || \"\";\r\n    }\r\n    if (!value || !isString(value) || value[_DYN_LENGTH /* @min:%2elength */] > 8192) {\r\n        // limit potential processing based on total length\r\n        return null;\r\n    }\r\n    if (value[_DYN_INDEX_OF /* @min:%2eindexOf */](\",\") !== -1) {\r\n        var values = value[_DYN_SPLIT /* @min:%2esplit */](\",\");\r\n        value = values[selectIdx > 0 && values[_DYN_LENGTH /* @min:%2elength */] > selectIdx ? selectIdx : 0];\r\n    }\r\n    // See https://www.w3.org/TR/trace-context/#versioning-of-traceparent\r\n    var match = TRACE_PARENT_REGEX.exec(strTrim(value));\r\n    if (!match || // No match\r\n        match[1] === INVALID_VERSION || // version ff is forbidden\r\n        match[2] === INVALID_TRACE_ID || // All zeros is considered to be invalid\r\n        match[3] === INVALID_SPAN_ID) { // All zeros is considered to be invalid\r\n        return null;\r\n    }\r\n    return _a = {\r\n            version: (match[1] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */](),\r\n            traceId: (match[2] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */](),\r\n            spanId: (match[3] || STR_EMPTY)[_DYN_TO_LOWER_CASE /* @min:%2etoLowerCase */]()\r\n        },\r\n        _a[_DYN_TRACE_FLAGS /* @min:traceFlags */] = parseInt(match[4], 16),\r\n        _a;\r\n}\r\n/**\r\n * Is the provided W3c Trace Id a valid string representation, it must be a 32-character string\r\n * of lowercase hexadecimal characters for example, 4bf92f3577b34da6a3ce929d0e0e4736.\r\n * If all characters as zero (00000000000000000000000000000000) it will be considered an invalid value.\r\n * @param value - The W3c trace Id to be validated\r\n * @returns true if valid otherwise false\r\n */\r\nexport function isValidTraceId(value) {\r\n    return _isValid(value, 32, INVALID_TRACE_ID);\r\n}\r\n/**\r\n * Is the provided W3c span id (aka. parent id) a valid string representation, it must be a 16-character\r\n * string of lowercase hexadecimal characters, for example, 00f067aa0ba902b7.\r\n * If all characters are zero (0000000000000000) this is considered an invalid value.\r\n * @param value - The W3c span id to be validated\r\n * @returns true if valid otherwise false\r\n */\r\nexport function isValidSpanId(value) {\r\n    return _isValid(value, 16, INVALID_SPAN_ID);\r\n}\r\n/**\r\n * Validates that the provided ITraceParent instance conforms to the currently supported specifications\r\n * @param value\r\n * @returns\r\n */\r\nexport function isValidTraceParent(value) {\r\n    if (!value ||\r\n        !_isValid(value[_DYN_VERSION /* @min:%2eversion */], 2, INVALID_VERSION) ||\r\n        !_isValid(value[_DYN_TRACE_ID /* @min:%2etraceId */], 32, INVALID_TRACE_ID) ||\r\n        !_isValid(value[_DYN_SPAN_ID /* @min:%2espanId */], 16, INVALID_SPAN_ID) ||\r\n        !_isValid(_formatFlags(value[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */]), 2)) {\r\n        // Each known field must contain a valid value\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Is the parsed traceParent indicating that the trace is currently sampled.\r\n * @param value - The parsed traceParent value\r\n * @returns\r\n */\r\nexport function isSampledFlag(value) {\r\n    if (isValidTraceParent(value)) {\r\n        return (value[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */] & SAMPLED_FLAG) === SAMPLED_FLAG;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Format the ITraceParent value as a string using the supported and know version formats.\r\n * So even if the passed traceParent is a later version the string value returned from this\r\n * function will convert it to only the known version formats.\r\n * This currently only supports version \"00\" and invalid \"ff\"\r\n * @param value - The parsed traceParent value\r\n * @returns\r\n */\r\nexport function formatTraceParent(value) {\r\n    if (value) {\r\n        // Special Note: This only supports formatting as version 00, future versions should encode any known supported version\r\n        // So parsing a future version will populate the correct version value but reformatting will reduce it to version 00.\r\n        var flags = _formatFlags(value[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */]);\r\n        if (!_isValid(flags, 2)) {\r\n            flags = \"01\";\r\n        }\r\n        var version = value[_DYN_VERSION /* @min:%2eversion */] || DEFAULT_VERSION;\r\n        if (version !== \"00\" && version !== \"ff\") {\r\n            // Reduce version to \"00\"\r\n            version = DEFAULT_VERSION;\r\n        }\r\n        // Format as version 00\r\n        return \"\".concat(version.toLowerCase(), \"-\").concat(_formatValue(value.traceId, 32, INVALID_TRACE_ID).toLowerCase(), \"-\").concat(_formatValue(value.spanId, 16, INVALID_SPAN_ID).toLowerCase(), \"-\").concat(flags.toLowerCase());\r\n    }\r\n    return \"\";\r\n}\r\n/**\r\n * Helper function to fetch the passed traceparent from the page, looking for it as a meta-tag or a Server-Timing header.\r\n * @param selectIdx - If the found value is comma separated which is the preferred entry to select, defaults to the first\r\n * @returns\r\n */\r\nexport function findW3cTraceParent(selectIdx) {\r\n    var name = \"traceparent\";\r\n    var traceParent = parseTraceParent(findMetaTag(name), selectIdx);\r\n    if (!traceParent) {\r\n        traceParent = parseTraceParent(findNamedServerTiming(name), selectIdx);\r\n    }\r\n    return traceParent;\r\n}\r\n//# sourceMappingURL=W3cTraceParent.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport { _DYN_CALL, _DYN_GET_NEXT, _DYN_GET_PLUGIN, _DYN_INITIALIZE, _DYN_IS_INITIALIZED, _DYN_LENGTH, _DYN_NAME, _DYN_PUSH, _DYN_SET_NEXT_PLUGIN, _DYN_SPAN_ID, _DYN_TEARDOWN, _DYN_TRACE_FLAGS, _DYN_TRACE_ID, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { createElmNodeData } from \"./DataCacheHelper\";\r\nimport { arrForEach, isFunction } from \"./HelperFuncs\";\r\nimport { STR_CORE, STR_PRIORITY, STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nimport { isValidSpanId, isValidTraceId } from \"./W3cTraceParent\";\r\nvar pluginStateData = createElmNodeData(\"plugin\");\r\nexport function _getPluginState(plugin) {\r\n    return pluginStateData.get(plugin, \"state\", {}, true);\r\n}\r\n/**\r\n * Initialize the queue of plugins\r\n * @param plugins - The array of plugins to initialize and setting of the next plugin\r\n * @param config The current config for the instance\r\n * @param core THe current core instance\r\n * @param extensions The extensions\r\n */\r\nexport function initializePlugins(processContext, extensions) {\r\n    // Set the next plugin and identified the uninitialized plugins\r\n    var initPlugins = [];\r\n    var lastPlugin = null;\r\n    var proxy = processContext[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n    var pluginState;\r\n    while (proxy) {\r\n        var thePlugin = proxy[_DYN_GET_PLUGIN /* @min:%2egetPlugin */]();\r\n        if (thePlugin) {\r\n            if (lastPlugin &&\r\n                isFunction(lastPlugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */]) &&\r\n                isFunction(thePlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */])) {\r\n                // Set this plugin as the next for the previous one\r\n                lastPlugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */](thePlugin);\r\n            }\r\n            var isInitialized = false;\r\n            if (isFunction(thePlugin[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */])) {\r\n                isInitialized = thePlugin[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]();\r\n            }\r\n            else {\r\n                pluginState = _getPluginState(thePlugin);\r\n                isInitialized = pluginState[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */];\r\n            }\r\n            if (!isInitialized) {\r\n                initPlugins[_DYN_PUSH /* @min:%2epush */](thePlugin);\r\n            }\r\n            lastPlugin = thePlugin;\r\n            proxy = proxy[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n        }\r\n    }\r\n    // Now initialize the plugins\r\n    arrForEach(initPlugins, function (thePlugin) {\r\n        var core = processContext[STR_CORE]();\r\n        thePlugin[_DYN_INITIALIZE /* @min:%2einitialize */](processContext.getCfg(), core, extensions, processContext[_DYN_GET_NEXT /* @min:%2egetNext */]());\r\n        pluginState = _getPluginState(thePlugin);\r\n        // Only add the core to the state if the plugin didn't set it (doesn't extent from BaseTelemetryPlugin)\r\n        if (!thePlugin[STR_CORE] && !pluginState[STR_CORE]) {\r\n            pluginState[STR_CORE] = core;\r\n        }\r\n        pluginState[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = true;\r\n        delete pluginState[_DYN_TEARDOWN /* @min:%2eteardown */];\r\n    });\r\n}\r\nexport function sortPlugins(plugins) {\r\n    // Sort by priority\r\n    return plugins.sort(function (extA, extB) {\r\n        var result = 0;\r\n        if (extB) {\r\n            var bHasProcess = isFunction(extB[STR_PROCESS_TELEMETRY]);\r\n            if (isFunction(extA[STR_PROCESS_TELEMETRY])) {\r\n                result = bHasProcess ? extA[STR_PRIORITY] - extB[STR_PRIORITY] : 1;\r\n            }\r\n            else if (bHasProcess) {\r\n                result = -1;\r\n            }\r\n        }\r\n        else {\r\n            result = extA ? 1 : -1;\r\n        }\r\n        return result;\r\n    });\r\n    // sort complete\r\n}\r\n/**\r\n * Teardown / Unload helper to perform teardown/unloading operations for the provided components synchronously or asynchronously, this will call any\r\n * _doTeardown() or _doUnload() functions on the provided components to allow them to finish removal.\r\n * @param components - The components you want to unload\r\n * @param unloadCtx - This is the context that should be used during unloading.\r\n * @param unloadState - The details / state of the unload process, it holds details like whether it should be unloaded synchronously or asynchronously and the reason for the unload.\r\n * @param asyncCallback - An optional callback that the plugin must call if it returns true to inform the caller that it has completed any async unload/teardown operations.\r\n * @returns boolean - true if the plugin has or will call asyncCallback, this allows the plugin to perform any asynchronous operations.\r\n */\r\nexport function unloadComponents(components, unloadCtx, unloadState, asyncCallback) {\r\n    var idx = 0;\r\n    function _doUnload() {\r\n        while (idx < components[_DYN_LENGTH /* @min:%2elength */]) {\r\n            var component = components[idx++];\r\n            if (component) {\r\n                var func = component._doUnload || component[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */];\r\n                if (isFunction(func)) {\r\n                    if (func[_DYN_CALL /* @min:%2ecall */](component, unloadCtx, unloadState, _doUnload) === true) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return _doUnload();\r\n}\r\n/**\r\n * Creates a IDistributedTraceContext which optionally also \"sets\" the value on a parent\r\n * @param parentCtx - An optional parent distributed trace instance\r\n * @returns A new IDistributedTraceContext instance that uses an internal temporary object\r\n */\r\nexport function createDistributedTraceContext(parentCtx) {\r\n    var trace = {};\r\n    return {\r\n        getName: function () {\r\n            return trace[_DYN_NAME /* @min:%2ename */];\r\n        },\r\n        setName: function (newValue) {\r\n            parentCtx && parentCtx.setName(newValue);\r\n            trace[_DYN_NAME /* @min:%2ename */] = newValue;\r\n        },\r\n        getTraceId: function () {\r\n            return trace[_DYN_TRACE_ID /* @min:%2etraceId */];\r\n        },\r\n        setTraceId: function (newValue) {\r\n            parentCtx && parentCtx.setTraceId(newValue);\r\n            if (isValidTraceId(newValue)) {\r\n                trace[_DYN_TRACE_ID /* @min:%2etraceId */] = newValue;\r\n            }\r\n        },\r\n        getSpanId: function () {\r\n            return trace[_DYN_SPAN_ID /* @min:%2espanId */];\r\n        },\r\n        setSpanId: function (newValue) {\r\n            parentCtx && parentCtx.setSpanId(newValue);\r\n            if (isValidSpanId(newValue)) {\r\n                trace[_DYN_SPAN_ID /* @min:%2espanId */] = newValue;\r\n            }\r\n        },\r\n        getTraceFlags: function () {\r\n            return trace[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */];\r\n        },\r\n        setTraceFlags: function (newTraceFlags) {\r\n            parentCtx && parentCtx.setTraceFlags(newTraceFlags);\r\n            trace[_DYN_TRACE_FLAGS /* @min:%2etraceFlags */] = newTraceFlags;\r\n        }\r\n    };\r\n}\r\n//# sourceMappingURL=TelemetryHelpers.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport { _DYN_CALL, _DYN_CONFIG, _DYN_CREATE_NEW, _DYN_DIAG_LOG, _DYN_GET_NEXT, _DYN_GET_PLUGIN, _DYN_IDENTIFIER, _DYN_IS_ASYNC, _DYN_IS_INITIALIZED, _DYN_LENGTH, _DYN_LOGGER, _DYN_PROCESS_NEXT, _DYN_PUSH, _DYN_SET_NEXT_PLUGIN, _DYN_TEARDOWN, _DYN_UPDATE } from \"../__DynamicConstants\";\r\nimport { _throwInternal, safeGetLogger } from \"./DiagnosticLogger\";\r\nimport { dumpObj } from \"./EnvUtils\";\r\nimport { arrForEach, isArray, isFunction, isNullOrUndefined, isObject, isUndefined, objExtend, objForEachKey, objFreeze, objKeys, proxyFunctions } from \"./HelperFuncs\";\r\nimport { STR_CORE, STR_DISABLED, STR_EMPTY, STR_EXTENSION_CONFIG, STR_PRIORITY, STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nimport { doPerf } from \"./PerfManager\";\r\nimport { _getPluginState } from \"./TelemetryHelpers\";\r\nvar strTelemetryPluginChain = \"TelemetryPluginChain\";\r\nvar strHasRunFlags = \"_hasRun\";\r\nvar strGetTelCtx = \"_getTelCtx\";\r\nvar _chainId = 0;\r\nfunction _getNextProxyStart(proxy, core, startAt) {\r\n    while (proxy) {\r\n        if (proxy[_DYN_GET_PLUGIN /* @min:%2egetPlugin */]() === startAt) {\r\n            return proxy;\r\n        }\r\n        proxy = proxy[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n    }\r\n    // This wasn't found in the existing chain so create an isolated one with just this plugin\r\n    return createTelemetryProxyChain([startAt], core[_DYN_CONFIG /* @min:%2econfig */] || {}, core);\r\n}\r\n/**\r\n * @ignore\r\n * @param telemetryChain\r\n * @param config\r\n * @param core\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n * @returns\r\n */\r\nfunction _createInternalContext(telemetryChain, config, core, startAt) {\r\n    // We have a special case where we want to start execution from this specific plugin\r\n    // or we simply reuse the existing telemetry plugin chain (normal execution case)\r\n    var _nextProxy = null; // By Default set as no next plugin\r\n    var _onComplete = [];\r\n    if (startAt !== null) {\r\n        // There is no next element (null) vs not defined (undefined) so use the full chain\r\n        _nextProxy = startAt ? _getNextProxyStart(telemetryChain, core, startAt) : telemetryChain;\r\n    }\r\n    var context = {\r\n        _next: _moveNext,\r\n        ctx: {\r\n            core: function () {\r\n                return core;\r\n            },\r\n            diagLog: function () {\r\n                return safeGetLogger(core, config);\r\n            },\r\n            getCfg: function () {\r\n                return config;\r\n            },\r\n            getExtCfg: _getExtCfg,\r\n            getConfig: _getConfig,\r\n            hasNext: function () {\r\n                return !!_nextProxy;\r\n            },\r\n            getNext: function () {\r\n                return _nextProxy;\r\n            },\r\n            setNext: function (nextPlugin) {\r\n                _nextProxy = nextPlugin;\r\n            },\r\n            iterate: _iterateChain,\r\n            onComplete: _addOnComplete\r\n        }\r\n    };\r\n    function _addOnComplete(onComplete, that) {\r\n        var args = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            args[_i - 2] = arguments[_i];\r\n        }\r\n        if (onComplete) {\r\n            _onComplete[_DYN_PUSH /* @min:%2epush */]({\r\n                func: onComplete,\r\n                self: !isUndefined(that) ? that : context.ctx,\r\n                args: args\r\n            });\r\n        }\r\n    }\r\n    function _moveNext() {\r\n        var nextProxy = _nextProxy;\r\n        // Automatically move to the next plugin\r\n        _nextProxy = nextProxy ? nextProxy[_DYN_GET_NEXT /* @min:%2egetNext */]() : null;\r\n        if (!nextProxy) {\r\n            var onComplete = _onComplete;\r\n            if (onComplete && onComplete[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                arrForEach(onComplete, function (completeDetails) {\r\n                    try {\r\n                        completeDetails.func[_DYN_CALL /* @min:%2ecall */](completeDetails.self, completeDetails.args);\r\n                    }\r\n                    catch (e) {\r\n                        _throwInternal(core[_DYN_LOGGER /* @min:%2elogger */], 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, \"Unexpected Exception during onComplete - \" + dumpObj(e));\r\n                    }\r\n                });\r\n                _onComplete = [];\r\n            }\r\n        }\r\n        return nextProxy;\r\n    }\r\n    function _getExtCfg(identifier, defaultValue, mergeDefault) {\r\n        if (defaultValue === void 0) { defaultValue = {}; }\r\n        if (mergeDefault === void 0) { mergeDefault = 0 /* GetExtCfgMergeType.None */; }\r\n        var theConfig;\r\n        if (config) {\r\n            var extConfig = config[STR_EXTENSION_CONFIG /* @min:%2eextensionConfig */];\r\n            if (extConfig && identifier) {\r\n                theConfig = extConfig[identifier];\r\n            }\r\n        }\r\n        if (!theConfig) {\r\n            // Just use the defaults\r\n            theConfig = defaultValue;\r\n        }\r\n        else if (isObject(defaultValue)) {\r\n            if (mergeDefault !== 0 /* GetExtCfgMergeType.None */) {\r\n                // Merge the defaults and configured values\r\n                var newConfig_1 = objExtend(true, defaultValue, theConfig);\r\n                if (config && mergeDefault === 2 /* GetExtCfgMergeType.MergeDefaultFromRootOrDefault */) {\r\n                    // Enumerate over the defaultValues and if not already populated attempt to\r\n                    // find a value from the root config\r\n                    objForEachKey(defaultValue, function (field) {\r\n                        // for each unspecified field, set the default value\r\n                        if (isNullOrUndefined(newConfig_1[field])) {\r\n                            var cfgValue = config[field];\r\n                            if (!isNullOrUndefined(cfgValue)) {\r\n                                newConfig_1[field] = cfgValue;\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                theConfig = newConfig_1;\r\n            }\r\n        }\r\n        return theConfig;\r\n    }\r\n    function _getConfig(identifier, field, defaultValue) {\r\n        if (defaultValue === void 0) { defaultValue = false; }\r\n        var theValue;\r\n        var extConfig = _getExtCfg(identifier, null);\r\n        if (extConfig && !isNullOrUndefined(extConfig[field])) {\r\n            theValue = extConfig[field];\r\n        }\r\n        else if (config && !isNullOrUndefined(config[field])) {\r\n            theValue = config[field];\r\n        }\r\n        return !isNullOrUndefined(theValue) ? theValue : defaultValue;\r\n    }\r\n    function _iterateChain(cb) {\r\n        // Keep processing until we reach the end of the chain\r\n        var nextPlugin;\r\n        while (!!(nextPlugin = context._next())) {\r\n            var plugin = nextPlugin[_DYN_GET_PLUGIN /* @min:%2egetPlugin */]();\r\n            if (plugin) {\r\n                // callback with the current on\r\n                cb(plugin);\r\n            }\r\n        }\r\n    }\r\n    return context;\r\n}\r\n/**\r\n * Creates a new Telemetry Item context with the current config, core and plugin execution chain\r\n * @param plugins - The plugin instances that will be executed\r\n * @param config - The current config\r\n * @param core - The current core instance\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n */\r\nexport function createProcessTelemetryContext(telemetryChain, config, core, startAt) {\r\n    var internalContext = _createInternalContext(telemetryChain, config, core, startAt);\r\n    var context = internalContext.ctx;\r\n    function _processNext(env) {\r\n        var nextPlugin = internalContext._next();\r\n        // Run the next plugin which will call \"processNext()\"\r\n        nextPlugin && nextPlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */](env, context);\r\n        return !nextPlugin;\r\n    }\r\n    function _createNew(plugins, startAt) {\r\n        if (plugins === void 0) { plugins = null; }\r\n        if (isArray(plugins)) {\r\n            plugins = createTelemetryProxyChain(plugins, config, core, startAt);\r\n        }\r\n        return createProcessTelemetryContext(plugins || context[_DYN_GET_NEXT /* @min:%2egetNext */](), config, core, startAt);\r\n    }\r\n    context[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = _processNext;\r\n    context[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = _createNew;\r\n    return context;\r\n}\r\n/**\r\n * Creates a new Telemetry Item context with the current config, core and plugin execution chain for handling the unloading of the chain\r\n * @param plugins - The plugin instances that will be executed\r\n * @param config - The current config\r\n * @param core - The current core instance\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n */\r\nexport function createProcessTelemetryUnloadContext(telemetryChain, core, startAt) {\r\n    var config = core[_DYN_CONFIG /* @min:%2econfig */] || {};\r\n    var internalContext = _createInternalContext(telemetryChain, config, core, startAt);\r\n    var context = internalContext.ctx;\r\n    function _processNext(unloadState) {\r\n        var nextPlugin = internalContext._next();\r\n        nextPlugin && nextPlugin.unload(context, unloadState);\r\n        return !nextPlugin;\r\n    }\r\n    function _createNew(plugins, startAt) {\r\n        if (plugins === void 0) { plugins = null; }\r\n        if (isArray(plugins)) {\r\n            plugins = createTelemetryProxyChain(plugins, config, core, startAt);\r\n        }\r\n        return createProcessTelemetryUnloadContext(plugins || context[_DYN_GET_NEXT /* @min:%2egetNext */](), core, startAt);\r\n    }\r\n    context[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = _processNext;\r\n    context[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = _createNew;\r\n    return context;\r\n}\r\n/**\r\n * Creates a new Telemetry Item context with the current config, core and plugin execution chain for updating the configuration\r\n * @param plugins - The plugin instances that will be executed\r\n * @param config - The current config\r\n * @param core - The current core instance\r\n * @param startAt - Identifies the next plugin to execute, if null there is no \"next\" plugin and if undefined it should assume the start of the chain\r\n */\r\nexport function createProcessTelemetryUpdateContext(telemetryChain, core, startAt) {\r\n    var config = core[_DYN_CONFIG /* @min:%2econfig */] || {};\r\n    var internalContext = _createInternalContext(telemetryChain, config, core, startAt);\r\n    var context = internalContext.ctx;\r\n    function _processNext(updateState) {\r\n        return context.iterate(function (plugin) {\r\n            if (isFunction(plugin[_DYN_UPDATE /* @min:%2eupdate */])) {\r\n                plugin[_DYN_UPDATE /* @min:%2eupdate */](context, updateState);\r\n            }\r\n        });\r\n    }\r\n    function _createNew(plugins, startAt) {\r\n        if (plugins === void 0) { plugins = null; }\r\n        if (isArray(plugins)) {\r\n            plugins = createTelemetryProxyChain(plugins, config, core, startAt);\r\n        }\r\n        return createProcessTelemetryUpdateContext(plugins || context[_DYN_GET_NEXT /* @min:%2egetNext */](), core, startAt);\r\n    }\r\n    context[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = _processNext;\r\n    context[_DYN_CREATE_NEW /* @min:%2ecreateNew */] = _createNew;\r\n    return context;\r\n}\r\n/**\r\n * Creates an execution chain from the array of plugins\r\n * @param plugins - The array of plugins that will be executed in this order\r\n * @param defItemCtx - The default execution context to use when no telemetry context is passed to processTelemetry(), this\r\n * should be for legacy plugins only. Currently, only used for passing the current core instance and to provide better error\r\n * reporting (hasRun) when errors occur.\r\n */\r\nexport function createTelemetryProxyChain(plugins, config, core, startAt) {\r\n    var firstProxy = null;\r\n    var add = startAt ? false : true;\r\n    if (isArray(plugins) && plugins[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        // Create the proxies and wire up the next plugin chain\r\n        var lastProxy_1 = null;\r\n        arrForEach(plugins, function (thePlugin) {\r\n            if (!add && startAt === thePlugin) {\r\n                add = true;\r\n            }\r\n            if (add && thePlugin && isFunction(thePlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */])) {\r\n                // Only add plugins that are processors\r\n                var newProxy = createTelemetryPluginProxy(thePlugin, config, core);\r\n                if (!firstProxy) {\r\n                    firstProxy = newProxy;\r\n                }\r\n                if (lastProxy_1) {\r\n                    // Set this new proxy as the next for the previous one\r\n                    lastProxy_1._setNext(newProxy);\r\n                }\r\n                lastProxy_1 = newProxy;\r\n            }\r\n        });\r\n    }\r\n    if (startAt && !firstProxy) {\r\n        // Special case where the \"startAt\" was not in the original list of plugins\r\n        return createTelemetryProxyChain([startAt], config, core);\r\n    }\r\n    return firstProxy;\r\n}\r\n/**\r\n * Create the processing telemetry proxy instance, the proxy is used to abstract the current plugin to allow monitoring and\r\n * execution plugins while passing around the dynamic execution state (IProcessTelemetryContext), the proxy instance no longer\r\n * contains any execution state and can be reused between requests (this was not the case for 2.7.2 and earlier with the\r\n * TelemetryPluginChain class).\r\n * @param plugin - The plugin instance to proxy\r\n * @param config - The default execution context to use when no telemetry context is passed to processTelemetry(), this\r\n * should be for legacy plugins only. Currently, only used for passing the current core instance and to provide better error\r\n * reporting (hasRun) when errors occur.\r\n * @returns\r\n */\r\nexport function createTelemetryPluginProxy(plugin, config, core) {\r\n    var nextProxy = null;\r\n    var hasProcessTelemetry = isFunction(plugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */]);\r\n    var hasSetNext = isFunction(plugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */]);\r\n    var chainId;\r\n    if (plugin) {\r\n        chainId = plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] + \"-\" + plugin[STR_PRIORITY /* @min:%2epriority */] + \"-\" + _chainId++;\r\n    }\r\n    else {\r\n        chainId = \"Unknown-0-\" + _chainId++;\r\n    }\r\n    var proxyChain = {\r\n        getPlugin: function () {\r\n            return plugin;\r\n        },\r\n        getNext: function () {\r\n            return nextProxy;\r\n        },\r\n        processTelemetry: _processTelemetry,\r\n        unload: _unloadPlugin,\r\n        update: _updatePlugin,\r\n        _id: chainId,\r\n        _setNext: function (nextPlugin) {\r\n            nextProxy = nextPlugin;\r\n        }\r\n    };\r\n    function _getTelCtx() {\r\n        var itemCtx;\r\n        // Looks like a plugin didn't pass the (optional) context, so create a new one\r\n        if (plugin && isFunction(plugin[strGetTelCtx])) {\r\n            // This plugin extends from the BaseTelemetryPlugin so lets use it\r\n            itemCtx = plugin[strGetTelCtx]();\r\n        }\r\n        if (!itemCtx) {\r\n            // Create a temporary one\r\n            itemCtx = createProcessTelemetryContext(proxyChain, config, core);\r\n        }\r\n        return itemCtx;\r\n    }\r\n    function _processChain(itemCtx, processPluginFn, name, details, isAsync) {\r\n        var hasRun = false;\r\n        var identifier = plugin ? plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] : strTelemetryPluginChain;\r\n        var hasRunContext = itemCtx[strHasRunFlags];\r\n        if (!hasRunContext) {\r\n            // Assign and populate\r\n            hasRunContext = itemCtx[strHasRunFlags] = {};\r\n        }\r\n        // Ensure that we keep the context in sync\r\n        itemCtx.setNext(nextProxy);\r\n        if (plugin) {\r\n            doPerf(itemCtx[STR_CORE /* @min:%2ecore */](), function () { return identifier + \":\" + name; }, function () {\r\n                // Mark this component as having run\r\n                hasRunContext[chainId] = true;\r\n                try {\r\n                    // Set a flag on the next plugin so we know if it was attempted to be executed\r\n                    var nextId = nextProxy ? nextProxy._id : STR_EMPTY;\r\n                    if (nextId) {\r\n                        hasRunContext[nextId] = false;\r\n                    }\r\n                    hasRun = processPluginFn(itemCtx);\r\n                }\r\n                catch (error) {\r\n                    var hasNextRun = nextProxy ? hasRunContext[nextProxy._id] : true;\r\n                    if (hasNextRun) {\r\n                        // The next plugin after us has already run so set this one as complete\r\n                        hasRun = true;\r\n                    }\r\n                    if (!nextProxy || !hasNextRun) {\r\n                        // Either we have no next plugin or the current one did not attempt to call the next plugin\r\n                        // Which means the current one is the root of the failure so log/report this failure\r\n                        _throwInternal(itemCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 73 /* _eInternalMessageId.PluginException */, \"Plugin [\" + identifier + \"] failed during \" + name + \" - \" + dumpObj(error) + \", run flags: \" + dumpObj(hasRunContext));\r\n                    }\r\n                }\r\n            }, details, isAsync);\r\n        }\r\n        return hasRun;\r\n    }\r\n    function _processTelemetry(env, itemCtx) {\r\n        itemCtx = itemCtx || _getTelCtx();\r\n        function _callProcessTelemetry(itemCtx) {\r\n            if (!plugin || !hasProcessTelemetry) {\r\n                return false;\r\n            }\r\n            var pluginState = _getPluginState(plugin);\r\n            if (pluginState[_DYN_TEARDOWN /* @min:%2eteardown */] || pluginState[STR_DISABLED]) {\r\n                return false;\r\n            }\r\n            // Ensure that we keep the context in sync (for processNext()), just in case a plugin\r\n            // doesn't calls processTelemetry() instead of itemContext.processNext() or some\r\n            // other form of error occurred\r\n            if (hasSetNext) {\r\n                // Backward compatibility setting the next plugin on the instance\r\n                plugin[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */](nextProxy);\r\n            }\r\n            plugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */](env, itemCtx);\r\n            // Process Telemetry is expected to call itemCtx.processNext() or nextPlugin.processTelemetry()\r\n            return true;\r\n        }\r\n        if (!_processChain(itemCtx, _callProcessTelemetry, \"processTelemetry\", function () { return ({ item: env }); }, !(env.sync))) {\r\n            // The underlying plugin is either not defined, not enabled or does not have a processTelemetry implementation\r\n            // so we still want the next plugin to be executed.\r\n            itemCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](env);\r\n        }\r\n    }\r\n    function _unloadPlugin(unloadCtx, unloadState) {\r\n        function _callTeardown() {\r\n            // Setting default of hasRun as false so the proxyProcessFn() is called as teardown() doesn't have to exist or call unloadNext().\r\n            var hasRun = false;\r\n            if (plugin) {\r\n                var pluginState = _getPluginState(plugin);\r\n                var pluginCore = plugin[STR_CORE] || pluginState[STR_CORE /* @min:%2ecore */];\r\n                // Only teardown the plugin if it was initialized by the current core (i.e. It's not a shared plugin)\r\n                if (plugin && (!pluginCore || pluginCore === unloadCtx.core()) && !pluginState[_DYN_TEARDOWN /* @min:%2eteardown */]) {\r\n                    // Handle plugins that don't extend from the BaseTelemetryPlugin\r\n                    pluginState[STR_CORE /* @min:%2ecore */] = null;\r\n                    pluginState[_DYN_TEARDOWN /* @min:%2eteardown */] = true;\r\n                    pluginState[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = false;\r\n                    if (plugin[_DYN_TEARDOWN /* @min:%2eteardown */] && plugin[_DYN_TEARDOWN /* @min:%2eteardown */](unloadCtx, unloadState) === true) {\r\n                        // plugin told us that it was going to (or has) call unloadCtx.processNext()\r\n                        hasRun = true;\r\n                    }\r\n                }\r\n            }\r\n            return hasRun;\r\n        }\r\n        if (!_processChain(unloadCtx, _callTeardown, \"unload\", function () { }, unloadState[_DYN_IS_ASYNC /* @min:%2eisAsync */])) {\r\n            // Only called if we hasRun was not true\r\n            unloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](unloadState);\r\n        }\r\n    }\r\n    function _updatePlugin(updateCtx, updateState) {\r\n        function _callUpdate() {\r\n            // Setting default of hasRun as false so the proxyProcessFn() is called as teardown() doesn't have to exist or call unloadNext().\r\n            var hasRun = false;\r\n            if (plugin) {\r\n                var pluginState = _getPluginState(plugin);\r\n                var pluginCore = plugin[STR_CORE] || pluginState[STR_CORE /* @min:%2ecore */];\r\n                // Only update the plugin if it was initialized by the current core (i.e. It's not a shared plugin)\r\n                if (plugin && (!pluginCore || pluginCore === updateCtx.core()) && !pluginState[_DYN_TEARDOWN /* @min:%2eteardown */]) {\r\n                    if (plugin[_DYN_UPDATE /* @min:%2eupdate */] && plugin[_DYN_UPDATE /* @min:%2eupdate */](updateCtx, updateState) === true) {\r\n                        // plugin told us that it was going to (or has) call unloadCtx.processNext()\r\n                        hasRun = true;\r\n                    }\r\n                }\r\n            }\r\n            return hasRun;\r\n        }\r\n        if (!_processChain(updateCtx, _callUpdate, \"update\", function () { }, false)) {\r\n            // Only called if we hasRun was not true\r\n            updateCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](updateState);\r\n        }\r\n    }\r\n    return objFreeze(proxyChain);\r\n}\r\n/**\r\n * This class will be removed!\r\n * @deprecated use createProcessTelemetryContext() instead\r\n */\r\nvar ProcessTelemetryContext = /** @class */ (function () {\r\n    /**\r\n     * Creates a new Telemetry Item context with the current config, core and plugin execution chain\r\n     * @param plugins - The plugin instances that will be executed\r\n     * @param config - The current config\r\n     * @param core - The current core instance\r\n     */\r\n    function ProcessTelemetryContext(pluginChain, config, core, startAt) {\r\n        var _self = this;\r\n        var context = createProcessTelemetryContext(pluginChain, config, core, startAt);\r\n        // Proxy all functions of the context to this object\r\n        proxyFunctions(_self, context, objKeys(context));\r\n    }\r\n    return ProcessTelemetryContext;\r\n}());\r\nexport { ProcessTelemetryContext };\r\n//# sourceMappingURL=ProcessTelemetryContext.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// // Licensed under the MIT License.\r\nimport { _DYN_CONFIG, _DYN_CREATE_NEW, _DYN_FLUSH, _DYN_IDENTIFIER, _DYN_LENGTH, _DYN_ON_COMPLETE, _DYN_PROCESS_NEXT, _DYN_PUSH } from \"../__DynamicConstants\";\r\nimport { arrForEach, isArray, objFreeze, throwError } from \"./HelperFuncs\";\r\nimport { STR_PRIORITY } from \"./InternalConstants\";\r\nimport { createProcessTelemetryContext, createTelemetryProxyChain } from \"./ProcessTelemetryContext\";\r\nimport { initializePlugins } from \"./TelemetryHelpers\";\r\nexport var ChannelControllerPriority = 500;\r\nvar ChannelValidationMessage = \"Channel has invalid priority - \";\r\nfunction _addChannelQueue(channelQueue, queue, core) {\r\n    if (queue && isArray(queue) && queue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n        queue = queue.sort(function (a, b) {\r\n            return a[STR_PRIORITY /* @min:%2epriority */] - b[STR_PRIORITY /* @min:%2epriority */];\r\n        });\r\n        arrForEach(queue, function (queueItem) {\r\n            if (queueItem[STR_PRIORITY /* @min:%2epriority */] < ChannelControllerPriority) {\r\n                throwError(ChannelValidationMessage + queueItem[_DYN_IDENTIFIER /* @min:%2eidentifier */]);\r\n            }\r\n        });\r\n        channelQueue[_DYN_PUSH /* @min:%2epush */]({\r\n            queue: objFreeze(queue),\r\n            chain: createTelemetryProxyChain(queue, core[_DYN_CONFIG /* @min:%2econfig */], core)\r\n        });\r\n    }\r\n}\r\nexport function createChannelControllerPlugin(channelQueue, core) {\r\n    function _getTelCtx() {\r\n        return createProcessTelemetryContext(null, core[_DYN_CONFIG /* @min:%2econfig */], core, null);\r\n    }\r\n    function _processChannelQueue(theChannels, itemCtx, processFn, onComplete) {\r\n        var waiting = theChannels ? (theChannels[_DYN_LENGTH /* @min:%2elength */] + 1) : 1;\r\n        function _runChainOnComplete() {\r\n            waiting--;\r\n            if (waiting === 0) {\r\n                onComplete && onComplete();\r\n                onComplete = null;\r\n            }\r\n        }\r\n        if (waiting > 0) {\r\n            arrForEach(theChannels, function (channels) {\r\n                // pass on to first item in queue\r\n                if (channels && channels.queue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var channelChain = channels.chain;\r\n                    var chainCtx = itemCtx[_DYN_CREATE_NEW /* @min:%2ecreateNew */](channelChain);\r\n                    chainCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](_runChainOnComplete);\r\n                    // Cause this chain to start processing\r\n                    processFn(chainCtx);\r\n                }\r\n                else {\r\n                    waiting--;\r\n                }\r\n            });\r\n        }\r\n        _runChainOnComplete();\r\n    }\r\n    function _doUpdate(updateCtx, updateState) {\r\n        var theUpdateState = updateState || {\r\n            reason: 0 /* TelemetryUpdateReason.Unknown */\r\n        };\r\n        _processChannelQueue(channelQueue, updateCtx, function (chainCtx) {\r\n            chainCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](theUpdateState);\r\n        }, function () {\r\n            updateCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](theUpdateState);\r\n        });\r\n        return true;\r\n    }\r\n    function _doTeardown(unloadCtx, unloadState) {\r\n        var theUnloadState = unloadState || {\r\n            reason: 0 /* TelemetryUnloadReason.ManualTeardown */,\r\n            isAsync: false\r\n        };\r\n        _processChannelQueue(channelQueue, unloadCtx, function (chainCtx) {\r\n            chainCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](theUnloadState);\r\n        }, function () {\r\n            unloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](theUnloadState);\r\n            isInitialized = false;\r\n        });\r\n        return true;\r\n    }\r\n    function _getChannel(pluginIdentifier) {\r\n        var thePlugin = null;\r\n        if (channelQueue && channelQueue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n            arrForEach(channelQueue, function (channels) {\r\n                // pass on to first item in queue\r\n                if (channels && channels.queue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    arrForEach(channels.queue, function (ext) {\r\n                        if (ext[_DYN_IDENTIFIER /* @min:%2eidentifier */] === pluginIdentifier) {\r\n                            thePlugin = ext;\r\n                            // Cause arrForEach to stop iterating\r\n                            return -1;\r\n                        }\r\n                    });\r\n                    if (thePlugin) {\r\n                        // Cause arrForEach to stop iterating\r\n                        return -1;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return thePlugin;\r\n    }\r\n    var isInitialized = false;\r\n    var channelController = {\r\n        identifier: \"ChannelControllerPlugin\",\r\n        priority: ChannelControllerPriority,\r\n        initialize: function (config, core, extensions, pluginChain) {\r\n            isInitialized = true;\r\n            arrForEach(channelQueue, function (channels) {\r\n                if (channels && channels.queue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    initializePlugins(createProcessTelemetryContext(channels.chain, config, core), extensions);\r\n                }\r\n            });\r\n        },\r\n        isInitialized: function () {\r\n            return isInitialized;\r\n        },\r\n        processTelemetry: function (item, itemCtx) {\r\n            _processChannelQueue(channelQueue, itemCtx || _getTelCtx(), function (chainCtx) {\r\n                chainCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](item);\r\n            }, function () {\r\n                itemCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](item);\r\n            });\r\n        },\r\n        update: _doUpdate,\r\n        pause: function () {\r\n            _processChannelQueue(channelQueue, _getTelCtx(), function (chainCtx) {\r\n                chainCtx.iterate(function (plugin) {\r\n                    plugin.pause && plugin.pause();\r\n                });\r\n            }, null);\r\n        },\r\n        resume: function () {\r\n            _processChannelQueue(channelQueue, _getTelCtx(), function (chainCtx) {\r\n                chainCtx.iterate(function (plugin) {\r\n                    plugin.resume && plugin.resume();\r\n                });\r\n            }, null);\r\n        },\r\n        teardown: _doTeardown,\r\n        getChannel: _getChannel,\r\n        flush: function (isAsync, callBack, sendReason, cbTimeout) {\r\n            // Setting waiting to one so that we don't call the callBack until we finish iterating\r\n            var waiting = 1;\r\n            var doneIterating = false;\r\n            var cbTimer = null;\r\n            cbTimeout = cbTimeout || 5000;\r\n            function doCallback() {\r\n                waiting--;\r\n                if (doneIterating && waiting === 0) {\r\n                    if (cbTimer) {\r\n                        clearTimeout(cbTimer);\r\n                        cbTimer = null;\r\n                    }\r\n                    callBack && callBack(doneIterating);\r\n                    callBack = null;\r\n                }\r\n            }\r\n            _processChannelQueue(channelQueue, _getTelCtx(), function (chainCtx) {\r\n                chainCtx.iterate(function (plugin) {\r\n                    if (plugin[_DYN_FLUSH /* @min:%2eflush */]) {\r\n                        waiting++;\r\n                        var handled_1 = false;\r\n                        // Not all channels will call this callback for every scenario\r\n                        if (!plugin[_DYN_FLUSH /* @min:%2eflush */](isAsync, function () {\r\n                            handled_1 = true;\r\n                            doCallback();\r\n                        }, sendReason)) {\r\n                            if (!handled_1) {\r\n                                // If any channel doesn't return true and it didn't call the callback, then we should assume that the callback\r\n                                // will never be called, so use a timeout to allow the channel(s) some time to \"finish\" before triggering any\r\n                                // followup function (such as unloading)\r\n                                if (isAsync && cbTimer == null) {\r\n                                    cbTimer = setTimeout(function () {\r\n                                        cbTimer = null;\r\n                                        doCallback();\r\n                                    }, cbTimeout);\r\n                                }\r\n                                else {\r\n                                    doCallback();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }, function () {\r\n                doneIterating = true;\r\n                doCallback();\r\n            });\r\n            return true;\r\n        },\r\n        _setQueue: function (queue) {\r\n            channelQueue = queue;\r\n        }\r\n    };\r\n    return channelController;\r\n}\r\nexport function createChannelQueues(channels, extensions, core) {\r\n    var channelQueue = [];\r\n    if (channels) {\r\n        // Add and sort the configuration channel queues\r\n        arrForEach(channels, function (queue) { return _addChannelQueue(channelQueue, queue, core); });\r\n    }\r\n    if (extensions) {\r\n        // Create a new channel queue for any extensions with a priority > the ChannelControllerPriority\r\n        var extensionQueue_1 = [];\r\n        arrForEach(extensions, function (plugin) {\r\n            if (plugin[STR_PRIORITY /* @min:%2epriority */] > ChannelControllerPriority) {\r\n                extensionQueue_1[_DYN_PUSH /* @min:%2epush */](plugin);\r\n            }\r\n        });\r\n        _addChannelQueue(channelQueue, extensionQueue_1, core);\r\n    }\r\n    return channelQueue;\r\n}\r\n//# sourceMappingURL=ChannelController.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport { _DYN_DIAG_LOG, _DYN_PUSH } from \"../__DynamicConstants\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nimport { dumpObj } from \"./EnvUtils\";\r\nimport { arrForEach } from \"./HelperFuncs\";\r\nexport function createUnloadHandlerContainer() {\r\n    var handlers = [];\r\n    function _addHandler(handler) {\r\n        if (handler) {\r\n            handlers[_DYN_PUSH /* @min:%2epush */](handler);\r\n        }\r\n    }\r\n    function _runHandlers(unloadCtx, unloadState) {\r\n        arrForEach(handlers, function (handler) {\r\n            try {\r\n                handler(unloadCtx, unloadState);\r\n            }\r\n            catch (e) {\r\n                _throwInternal(unloadCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, \"Unexpected error calling unload handler - \" + dumpObj(e));\r\n            }\r\n        });\r\n        handlers = [];\r\n    }\r\n    return {\r\n        add: _addHandler,\r\n        run: _runHandlers\r\n    };\r\n}\r\n//# sourceMappingURL=UnloadHandlerContainer.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_CREATE_NEW, _DYN_DIAG_LOG, _DYN_GET_NEXT, _DYN_GET_PROCESS_TEL_CONT0, _DYN_INITIALIZE, _DYN_IS_ASYNC, _DYN_IS_INITIALIZED, _DYN_PROCESS_NEXT, _DYN_PUSH, _DYN_SET_NEXT_PLUGIN, _DYN_TEARDOWN, _DYN_UPDATE, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { arrForEach, isArray, isFunction, isNullOrUndefined, proxyFunctionAs, setValue } from \"./HelperFuncs\";\r\nimport { STR_CORE, STR_EXTENSION_CONFIG, STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nimport { createProcessTelemetryContext, createProcessTelemetryUnloadContext, createProcessTelemetryUpdateContext } from \"./ProcessTelemetryContext\";\r\nimport { createUnloadHandlerContainer } from \"./UnloadHandlerContainer\";\r\nvar strGetPlugin = \"getPlugin\";\r\n/**\r\n * BaseTelemetryPlugin provides a basic implementation of the ITelemetryPlugin interface so that plugins\r\n * can avoid implementation the same set of boiler plate code as well as provide a base\r\n * implementation so that new default implementations can be added without breaking all plugins.\r\n */\r\nvar BaseTelemetryPlugin = /** @class */ (function () {\r\n    function BaseTelemetryPlugin() {\r\n        var _self = this; // Setting _self here as it's used outside of the dynamicProto as well\r\n        // NOTE!: DON'T set default values here, instead set them in the _initDefaults() function as it is also called during teardown()\r\n        var _isinitialized;\r\n        var _rootCtx; // Used as the root context, holding the current config and initialized core\r\n        var _nextPlugin; // Used for backward compatibility where plugins don't call the main pipeline\r\n        var _unloadHandlerContainer;\r\n        var _hooks;\r\n        _initDefaults();\r\n        dynamicProto(BaseTelemetryPlugin, _self, function (_self) {\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, core, extensions, pluginChain) {\r\n                _setDefaults(config, core, pluginChain);\r\n                _isinitialized = true;\r\n            };\r\n            _self[_DYN_TEARDOWN /* @min:%2eteardown */] = function (unloadCtx, unloadState) {\r\n                var _a;\r\n                // If this plugin has already been torn down (not operational) or is not initialized (core is not set)\r\n                // or the core being used for unload was not the same core used for initialization.\r\n                var core = _self[STR_CORE /* @min:%2ecore */];\r\n                if (!core || (unloadCtx && core !== unloadCtx[STR_CORE /* @min:%2ecore */]())) {\r\n                    // Do Nothing as either the plugin is not initialized or was not initialized by the current core\r\n                    return;\r\n                }\r\n                var result;\r\n                var unloadDone = false;\r\n                var theUnloadCtx = unloadCtx || createProcessTelemetryUnloadContext(null, core, _nextPlugin && _nextPlugin[strGetPlugin] ? _nextPlugin[strGetPlugin]() : _nextPlugin);\r\n                var theUnloadState = unloadState || (_a = {\r\n                        reason: 0 /* TelemetryUnloadReason.ManualTeardown */\r\n                    },\r\n                    _a[_DYN_IS_ASYNC /* @min:isAsync */] = false,\r\n                    _a);\r\n                function _unloadCallback() {\r\n                    if (!unloadDone) {\r\n                        unloadDone = true;\r\n                        _unloadHandlerContainer.run(theUnloadCtx, unloadState);\r\n                        var oldHooks = _hooks;\r\n                        _hooks = [];\r\n                        // Remove all instrumentation hooks\r\n                        arrForEach(oldHooks, function (fn) {\r\n                            fn.rm();\r\n                        });\r\n                        if (result === true) {\r\n                            theUnloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](theUnloadState);\r\n                        }\r\n                        _initDefaults();\r\n                    }\r\n                }\r\n                if (!_self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */] || _self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */](theUnloadCtx, theUnloadState, _unloadCallback) !== true) {\r\n                    _unloadCallback();\r\n                }\r\n                else {\r\n                    // Tell the caller that we will be calling processNext()\r\n                    result = true;\r\n                }\r\n                return result;\r\n            };\r\n            _self[_DYN_UPDATE /* @min:%2eupdate */] = function (updateCtx, updateState) {\r\n                // If this plugin has already been torn down (not operational) or is not initialized (core is not set)\r\n                // or the core being used for unload was not the same core used for initialization.\r\n                var core = _self[STR_CORE /* @min:%2ecore */];\r\n                if (!core || (updateCtx && core !== updateCtx[STR_CORE /* @min:%2ecore */]())) {\r\n                    // Do Nothing\r\n                    return;\r\n                }\r\n                var result;\r\n                var updateDone = false;\r\n                var theUpdateCtx = updateCtx || createProcessTelemetryUpdateContext(null, core, _nextPlugin && _nextPlugin[strGetPlugin] ? _nextPlugin[strGetPlugin]() : _nextPlugin);\r\n                var theUpdateState = updateState || {\r\n                    reason: 0 /* TelemetryUpdateReason.Unknown */\r\n                };\r\n                function _updateCallback() {\r\n                    if (!updateDone) {\r\n                        updateDone = true;\r\n                        _setDefaults(theUpdateCtx.getCfg(), theUpdateCtx.core(), theUpdateCtx[_DYN_GET_NEXT /* @min:%2egetNext */]());\r\n                    }\r\n                }\r\n                if (!_self._doUpdate || _self._doUpdate(theUpdateCtx, theUpdateState, _updateCallback) !== true) {\r\n                    _updateCallback();\r\n                }\r\n                else {\r\n                    result = true;\r\n                }\r\n                return result;\r\n            };\r\n            _self._addHook = function (hooks) {\r\n                if (hooks) {\r\n                    if (isArray(hooks)) {\r\n                        _hooks = _hooks.concat(hooks);\r\n                    }\r\n                    else {\r\n                        _hooks[_DYN_PUSH /* @min:%2epush */](hooks);\r\n                    }\r\n                }\r\n            };\r\n            proxyFunctionAs(_self, \"_addUnloadCb\", function () { return _unloadHandlerContainer; }, \"add\");\r\n        });\r\n        // These are added after the dynamicProto so that are not moved to the prototype\r\n        _self[_DYN_DIAG_LOG /* @min:%2ediagLog */] = function (itemCtx) {\r\n            return _getTelCtx(itemCtx)[_DYN_DIAG_LOG /* @min:%2ediagLog */]();\r\n        };\r\n        _self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = function () {\r\n            return _isinitialized;\r\n        };\r\n        _self.setInitialized = function (isInitialized) {\r\n            _isinitialized = isInitialized;\r\n        };\r\n        // _self.getNextPlugin = () => DO NOT IMPLEMENT\r\n        // Sub-classes of this base class *should* not be relying on this value and instead\r\n        // should use processNext() function. If you require access to the plugin use the\r\n        // IProcessTelemetryContext.getNext().getPlugin() while in the pipeline, Note getNext() may return null.\r\n        _self[_DYN_SET_NEXT_PLUGIN /* @min:%2esetNextPlugin */] = function (next) {\r\n            _nextPlugin = next;\r\n        };\r\n        _self[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */] = function (env, itemCtx) {\r\n            if (itemCtx) {\r\n                // Normal core execution sequence\r\n                itemCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](env);\r\n            }\r\n            else if (_nextPlugin && isFunction(_nextPlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */])) {\r\n                // Looks like backward compatibility or out of band processing. And as it looks\r\n                // like a ITelemetryPlugin or ITelemetryPluginChain, just call processTelemetry\r\n                _nextPlugin[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */](env, null);\r\n            }\r\n        };\r\n        _self._getTelCtx = _getTelCtx;\r\n        function _getTelCtx(currentCtx) {\r\n            if (currentCtx === void 0) { currentCtx = null; }\r\n            var itemCtx = currentCtx;\r\n            if (!itemCtx) {\r\n                var rootCtx = _rootCtx || createProcessTelemetryContext(null, {}, _self[STR_CORE /* @min:%2ecore */]);\r\n                // tslint:disable-next-line: prefer-conditional-expression\r\n                if (_nextPlugin && _nextPlugin[strGetPlugin]) {\r\n                    // Looks like a chain object\r\n                    itemCtx = rootCtx[_DYN_CREATE_NEW /* @min:%2ecreateNew */](null, _nextPlugin[strGetPlugin]);\r\n                }\r\n                else {\r\n                    itemCtx = rootCtx[_DYN_CREATE_NEW /* @min:%2ecreateNew */](null, _nextPlugin);\r\n                }\r\n            }\r\n            return itemCtx;\r\n        }\r\n        function _setDefaults(config, core, pluginChain) {\r\n            if (config) {\r\n                // Make sure the extensionConfig exists\r\n                setValue(config, STR_EXTENSION_CONFIG, [], null, isNullOrUndefined);\r\n            }\r\n            if (!pluginChain && core) {\r\n                // Get the first plugin from the core\r\n                pluginChain = core[_DYN_GET_PROCESS_TEL_CONT0 /* @min:%2egetProcessTelContext */]()[_DYN_GET_NEXT /* @min:%2egetNext */]();\r\n            }\r\n            var nextPlugin = _nextPlugin;\r\n            if (_nextPlugin && _nextPlugin[strGetPlugin]) {\r\n                // If it looks like a proxy/chain then get the plugin\r\n                nextPlugin = _nextPlugin[strGetPlugin]();\r\n            }\r\n            // Support legacy plugins where core was defined as a property\r\n            _self[STR_CORE /* @min:%2ecore */] = core;\r\n            _rootCtx = createProcessTelemetryContext(pluginChain, config, core, nextPlugin);\r\n        }\r\n        function _initDefaults() {\r\n            _isinitialized = false;\r\n            _self[STR_CORE /* @min:%2ecore */] = null;\r\n            _rootCtx = null;\r\n            _nextPlugin = null;\r\n            _hooks = [];\r\n            _unloadHandlerContainer = createUnloadHandlerContainer();\r\n        }\r\n    }\r\n    BaseTelemetryPlugin.prototype.initialize = function (config, core, extensions, pluginChain) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Tear down the plugin and remove any hooked value, the plugin should be removed so that it is no longer initialized and\r\n     * therefore could be re-initialized after being torn down. The plugin should ensure that once this has been called any further\r\n     * processTelemetry calls are ignored and it just calls the processNext() with the provided context.\r\n     * @param unloadCtx - This is the context that should be used during unloading.\r\n     * @param unloadState - The details / state of the unload process, it holds details like whether it should be unloaded synchronously or asynchronously and the reason for the unload.\r\n     * @returns boolean - true if the plugin has or will call processNext(), this for backward compatibility as previously teardown was synchronous and returned nothing.\r\n     */\r\n    BaseTelemetryPlugin.prototype.teardown = function (unloadCtx, unloadState) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * The the plugin should re-evaluate configuration and update any cached configuration settings.\r\n     * @param updateCtx - This is the context that should be used during updating.\r\n     * @param updateState - The details / state of the update process, it holds details like the current and previous configuration.\r\n     * @returns boolean - true if the plugin has or will call updateCtx.processNext(), this allows the plugin to perform any asynchronous operations.\r\n     */\r\n    BaseTelemetryPlugin.prototype.update = function (updateCtx, updateState) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add an unload handler that will be called when the SDK is being unloaded\r\n     * @param handler - the handler\r\n     */\r\n    BaseTelemetryPlugin.prototype._addUnloadCb = function (handler) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add this hook so that it is automatically removed during unloading\r\n     * @param hooks - The single hook or an array of IInstrumentHook objects\r\n     */\r\n    BaseTelemetryPlugin.prototype._addHook = function (hooks) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return BaseTelemetryPlugin;\r\n}());\r\nexport { BaseTelemetryPlugin };\r\n//# sourceMappingURL=BaseTelemetryPlugin.js.map", "// // Copyright (c) Microsoft Corporation. All rights reserved.\r\n// // Licensed under the MIT License.\r\nimport { __extends } from \"tslib\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_APPLY, _DYN_DIAG_LOG, _DYN_LENGTH, _DYN_PROCESS_NEXT, _DYN_PUSH, _DYN_SPLICE, _DYN__DO_TEARDOWN } from \"../__DynamicConstants\";\r\nimport { BaseTelemetryPlugin } from \"./BaseTelemetryPlugin\";\r\nimport { _throwInternal } from \"./DiagnosticLogger\";\r\nimport { dumpObj } from \"./EnvUtils\";\r\nimport { arrForEach, getExceptionName } from \"./HelperFuncs\";\r\nimport { STR_PROCESS_TELEMETRY } from \"./InternalConstants\";\r\nvar TelemetryInitializerPlugin = /** @class */ (function (_super) {\r\n    __extends(TelemetryInitializerPlugin, _super);\r\n    function TelemetryInitializerPlugin() {\r\n        var _this = _super.call(this) || this;\r\n        _this.identifier = \"TelemetryInitializerPlugin\";\r\n        _this.priority = 199;\r\n        // NOTE!: DON'T set default values here, instead set them in the _initDefaults() function as it is also called during teardown()\r\n        var _id;\r\n        var _initializers;\r\n        _initDefaults();\r\n        dynamicProto(TelemetryInitializerPlugin, _this, function (_self, _base) {\r\n            _self.addTelemetryInitializer = function (telemetryInitializer) {\r\n                var theInitializer = {\r\n                    id: _id++,\r\n                    fn: telemetryInitializer\r\n                };\r\n                _initializers[_DYN_PUSH /* @min:%2epush */](theInitializer);\r\n                var handler = {\r\n                    remove: function () {\r\n                        arrForEach(_initializers, function (initializer, idx) {\r\n                            if (initializer.id === theInitializer.id) {\r\n                                _initializers[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n                                return -1;\r\n                            }\r\n                        });\r\n                    }\r\n                };\r\n                return handler;\r\n            };\r\n            _self[STR_PROCESS_TELEMETRY /* @min:%2eprocessTelemetry */] = function (item, itemCtx) {\r\n                var doNotSendItem = false;\r\n                var telemetryInitializersCount = _initializers[_DYN_LENGTH /* @min:%2elength */];\r\n                for (var i = 0; i < telemetryInitializersCount; ++i) {\r\n                    var telemetryInitializer = _initializers[i];\r\n                    if (telemetryInitializer) {\r\n                        try {\r\n                            if (telemetryInitializer.fn[_DYN_APPLY /* @min:%2eapply */](null, [item]) === false) {\r\n                                doNotSendItem = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        catch (e) {\r\n                            // log error but dont stop executing rest of the telemetry initializers\r\n                            // doNotSendItem = true;\r\n                            _throwInternal(itemCtx[_DYN_DIAG_LOG /* @min:%2ediagLog */](), 1 /* eLoggingSeverity.CRITICAL */, 64 /* _eInternalMessageId.TelemetryInitializerFailed */, \"One of telemetry initializers failed, telemetry item will not be sent: \" + getExceptionName(e), { exception: dumpObj(e) }, true);\r\n                        }\r\n                    }\r\n                }\r\n                if (!doNotSendItem) {\r\n                    _self[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](item, itemCtx);\r\n                }\r\n            };\r\n            _self[_DYN__DO_TEARDOWN /* @min:%2e_doTeardown */] = function () {\r\n                _initDefaults();\r\n            };\r\n        });\r\n        function _initDefaults() {\r\n            _id = 0;\r\n            _initializers = [];\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * Add a telemetry processor to decorate or drop telemetry events.\r\n     * @param telemetryInitializer - The Telemetry Initializer function\r\n     * @returns - A ITelemetryInitializerHandler to enable the initializer to be removed\r\n     */\r\n    TelemetryInitializerPlugin.prototype.addTelemetryInitializer = function (telemetryInitializer) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    TelemetryInitializerPlugin.prototype.processTelemetry = function (env, itemCtx) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return TelemetryInitializerPlugin;\r\n}(BaseTelemetryPlugin));\r\nexport { TelemetryInitializerPlugin };\r\n//# sourceMappingURL=TelemetryInitializerPlugin.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\"use strict\";\r\nimport { __spreadArray } from \"tslib\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { objCreateFn } from \"@microsoft/applicationinsights-shims\";\r\nimport { _DYN_ADD_NOTIFICATION_LIS1, _DYN_CONFIG, _DYN_FLUSH, _DYN_GET_NOTIFY_MGR, _DYN_GET_PLUGIN, _DYN_GET_PROCESS_TEL_CONT0, _DYN_IDENTIFIER, _DYN_INITIALIZE, _DYN_INSTRUMENTATION_KEY, _DYN_IS_ASYNC, _DYN_IS_INITIALIZED, _DYN_LENGTH, _DYN_LOGGER, _DYN_MESSAGE, _DYN_MESSAGE_ID, _DYN_NAME, _DYN_ON_COMPLETE, _DYN_PROCESS_NEXT, _DYN_PUSH, _DYN_REMOVE_NOTIFICATION_2, _DYN_SET_ENABLED, _DYN_SPLICE, _DYN_STOP_POLLING_INTERNA3, _DYN_TEARDOWN, _DYN_TIME, _DYN__EXTENSIONS } from \"../__DynamicConstants\";\r\nimport { ChannelControllerPriority, createChannelControllerPlugin, createChannelQueues } from \"./ChannelController\";\r\nimport { createCookieMgr } from \"./CookieMgr\";\r\nimport { createUniqueNamespace } from \"./DataCacheHelper\";\r\nimport { getDebugListener } from \"./DbgExtensionUtils\";\r\nimport { DiagnosticLogger, _InternalLogMessage, _throwInternal, _warnToConsole } from \"./DiagnosticLogger\";\r\nimport { arrForEach, arrIndexOf, getCfgValue, getSetValue, isFunction, isNullOrUndefined, objExtend, objFreeze, proxyFunctionAs, proxyFunctions, throwError, toISOString } from \"./HelperFuncs\";\r\nimport { STR_CHANNELS, STR_CORE, STR_CREATE_PERF_MGR, STR_DISABLED, STR_EVENTS_DISCARDED, STR_EVENTS_SEND_REQUEST, STR_EVENTS_SENT, STR_EXTENSIONS, STR_EXTENSION_CONFIG, STR_GET_PERF_MGR, STR_PRIORITY } from \"./InternalConstants\";\r\nimport { PerfManager, getGblPerfMgr } from \"./PerfManager\";\r\nimport { createProcessTelemetryContext, createProcessTelemetryUnloadContext, createProcessTelemetryUpdateContext, createTelemetryProxyChain } from \"./ProcessTelemetryContext\";\r\nimport { _getPluginState, createDistributedTraceContext, initializePlugins, sortPlugins } from \"./TelemetryHelpers\";\r\nimport { TelemetryInitializerPlugin } from \"./TelemetryInitializerPlugin\";\r\nimport { createUnloadHandlerContainer } from \"./UnloadHandlerContainer\";\r\nvar strValidationError = \"Plugins must provide initialize method\";\r\nvar strNotificationManager = \"_notificationManager\";\r\nvar strSdkUnloadingError = \"SDK is still unloading...\";\r\nvar strSdkNotInitialized = \"SDK is not initialized\";\r\n// const strPluginUnloadFailed = \"Failed to unload plugin\";\r\nvar defaultInitConfig = {\r\n    // Have the Diagnostic Logger default to log critical errors to the console\r\n    loggingLevelConsole: 1 /* eLoggingSeverity.CRITICAL */\r\n};\r\n/**\r\n * Helper to create the default performance manager\r\n * @param core\r\n * @param notificationMgr\r\n */\r\nfunction _createPerfManager(core, notificationMgr) {\r\n    return new PerfManager(notificationMgr);\r\n}\r\nfunction _validateExtensions(logger, channelPriority, allExtensions) {\r\n    var _a;\r\n    // Concat all available extensions\r\n    var coreExtensions = [];\r\n    // Check if any two extensions have the same priority, then warn to console\r\n    // And extract the local extensions from the\r\n    var extPriorities = {};\r\n    // Extension validation\r\n    arrForEach(allExtensions, function (ext) {\r\n        // Check for ext.initialize\r\n        if (isNullOrUndefined(ext) || isNullOrUndefined(ext[_DYN_INITIALIZE /* @min:%2einitialize */])) {\r\n            throwError(strValidationError);\r\n        }\r\n        var extPriority = ext[STR_PRIORITY /* @min:%2epriority */];\r\n        var identifier = ext[_DYN_IDENTIFIER /* @min:%2eidentifier */];\r\n        if (ext && extPriority) {\r\n            if (!isNullOrUndefined(extPriorities[extPriority])) {\r\n                _warnToConsole(logger, \"Two extensions have same priority #\" + extPriority + \" - \" + extPriorities[extPriority] + \", \" + identifier);\r\n            }\r\n            else {\r\n                // set a value\r\n                extPriorities[extPriority] = identifier;\r\n            }\r\n        }\r\n        // Split extensions to core and channelController\r\n        if (!extPriority || extPriority < channelPriority) {\r\n            // Add to core extension that will be managed by BaseCore\r\n            coreExtensions[_DYN_PUSH /* @min:%2epush */](ext);\r\n        }\r\n    });\r\n    return _a = {\r\n            all: allExtensions\r\n        },\r\n        _a[STR_CORE /* @min:core */] = coreExtensions,\r\n        _a;\r\n}\r\nfunction _isPluginPresent(thePlugin, plugins) {\r\n    var exists = false;\r\n    arrForEach(plugins, function (plugin) {\r\n        if (plugin === thePlugin) {\r\n            exists = true;\r\n            return -1;\r\n        }\r\n    });\r\n    return exists;\r\n}\r\nfunction _createDummyNotificationManager() {\r\n    var _a;\r\n    return objCreateFn((_a = {},\r\n        _a[_DYN_ADD_NOTIFICATION_LIS1 /* @min:addNotificationListener */] = function (listener) { },\r\n        _a[_DYN_REMOVE_NOTIFICATION_2 /* @min:removeNotificationListener */] = function (listener) { },\r\n        _a[STR_EVENTS_SENT /* @min:eventsSent */] = function (events) { },\r\n        _a[STR_EVENTS_DISCARDED /* @min:eventsDiscarded */] = function (events, reason) { },\r\n        _a[STR_EVENTS_SEND_REQUEST /* @min:eventsSendRequest */] = function (sendReason, isAsync) { },\r\n        _a));\r\n}\r\nvar BaseCore = /** @class */ (function () {\r\n    function BaseCore() {\r\n        // NOTE!: DON'T set default values here, instead set them in the _initDefaults() function as it is also called during teardown()\r\n        var _config;\r\n        var _isInitialized;\r\n        var _eventQueue;\r\n        var _notificationManager;\r\n        var _perfManager;\r\n        var _cfgPerfManager;\r\n        var _cookieManager;\r\n        var _pluginChain;\r\n        var _configExtensions;\r\n        var _coreExtensions;\r\n        var _channelControl;\r\n        var _channelConfig;\r\n        var _channelQueue;\r\n        var _isUnloading;\r\n        var _telemetryInitializerPlugin;\r\n        var _internalLogsEventName;\r\n        var _evtNamespace;\r\n        var _unloadHandlers;\r\n        var _debugListener;\r\n        var _traceCtx;\r\n        /**\r\n         * Internal log poller\r\n         */\r\n        var _internalLogPoller = 0;\r\n        var _forceStopInternalLogPoller = false;\r\n        dynamicProto(BaseCore, this, function (_self) {\r\n            // Set the default values (also called during teardown)\r\n            _initDefaults();\r\n            _self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */] = function () { return _isInitialized; };\r\n            // Creating the self.initialize = ()\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, extensions, logger, notificationManager) {\r\n                if (_isUnloading) {\r\n                    throwError(strSdkUnloadingError);\r\n                }\r\n                // Make sure core is only initialized once\r\n                if (_self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]()) {\r\n                    throwError(\"Core should not be initialized more than once\");\r\n                }\r\n                _config = config || {};\r\n                _self[_DYN_CONFIG /* @min:%2econfig */] = _config;\r\n                if (isNullOrUndefined(config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */])) {\r\n                    throwError(\"Please provide instrumentation key\");\r\n                }\r\n                _notificationManager = notificationManager;\r\n                // For backward compatibility only\r\n                _self[strNotificationManager] = notificationManager;\r\n                _initDebugListener();\r\n                _initPerfManager();\r\n                // add notification to the extensions in the config so other plugins can access it\r\n                _initExtConfig();\r\n                if (logger) {\r\n                    _self[_DYN_LOGGER /* @min:%2elogger */] = logger;\r\n                }\r\n                var cfgExtensions = getSetValue(_config, STR_EXTENSIONS, []);\r\n                // Extension validation\r\n                _configExtensions = [];\r\n                _configExtensions[_DYN_PUSH /* @min:%2epush */].apply(_configExtensions, __spreadArray(__spreadArray([], extensions, false), cfgExtensions, false));\r\n                _channelConfig = getSetValue(_config, STR_CHANNELS, []);\r\n                _initPluginChain(null);\r\n                if (!_channelQueue || _channelQueue[_DYN_LENGTH /* @min:%2elength */] === 0) {\r\n                    throwError(\"No \" + STR_CHANNELS + \" available\");\r\n                }\r\n                _isInitialized = true;\r\n                _self.releaseQueue();\r\n            };\r\n            _self.getTransmissionControls = function () {\r\n                var controls = [];\r\n                if (_channelQueue) {\r\n                    arrForEach(_channelQueue, function (channels) {\r\n                        controls[_DYN_PUSH /* @min:%2epush */](channels.queue);\r\n                    });\r\n                }\r\n                return objFreeze(controls);\r\n            };\r\n            _self.track = function (telemetryItem) {\r\n                // setup default iKey if not passed in\r\n                telemetryItem.iKey = telemetryItem.iKey || _config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */];\r\n                // add default timestamp if not passed in\r\n                telemetryItem[_DYN_TIME /* @min:%2etime */] = telemetryItem[_DYN_TIME /* @min:%2etime */] || toISOString(new Date());\r\n                // Common Schema 4.0\r\n                telemetryItem.ver = telemetryItem.ver || \"4.0\";\r\n                if (!_isUnloading && _self[_DYN_IS_INITIALIZED /* @min:%2eisInitialized */]()) {\r\n                    // Process the telemetry plugin chain\r\n                    _createTelCtx()[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](telemetryItem);\r\n                }\r\n                else {\r\n                    // Queue events until all extensions are initialized\r\n                    _eventQueue[_DYN_PUSH /* @min:%2epush */](telemetryItem);\r\n                }\r\n            };\r\n            _self[_DYN_GET_PROCESS_TEL_CONT0 /* @min:%2egetProcessTelContext */] = _createTelCtx;\r\n            _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */] = function () {\r\n                if (!_notificationManager) {\r\n                    // Create Dummy notification manager\r\n                    _notificationManager = _createDummyNotificationManager();\r\n                    // For backward compatibility only\r\n                    _self[strNotificationManager] = _notificationManager;\r\n                }\r\n                return _notificationManager;\r\n            };\r\n            /**\r\n             * Adds a notification listener. The SDK calls methods on the listener when an appropriate notification is raised.\r\n             * The added plugins must raise notifications. If the plugins do not implement the notifications, then no methods will be\r\n             * called.\r\n             * @param {INotificationListener} listener - An INotificationListener object.\r\n             */\r\n            _self[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */] = function (listener) {\r\n                if (_notificationManager) {\r\n                    _notificationManager[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */](listener);\r\n                }\r\n            };\r\n            /**\r\n             * Removes all instances of the listener.\r\n             * @param {INotificationListener} listener - INotificationListener to remove.\r\n             */\r\n            _self[_DYN_REMOVE_NOTIFICATION_2 /* @min:%2eremoveNotificationListener */] = function (listener) {\r\n                if (_notificationManager) {\r\n                    _notificationManager[_DYN_REMOVE_NOTIFICATION_2 /* @min:%2eremoveNotificationListener */](listener);\r\n                }\r\n            };\r\n            _self.getCookieMgr = function () {\r\n                if (!_cookieManager) {\r\n                    _cookieManager = createCookieMgr(_config, _self[_DYN_LOGGER /* @min:%2elogger */]);\r\n                }\r\n                return _cookieManager;\r\n            };\r\n            _self.setCookieMgr = function (cookieMgr) {\r\n                _cookieManager = cookieMgr;\r\n            };\r\n            _self[STR_GET_PERF_MGR /* @min:%2egetPerfMgr */] = function () {\r\n                if (!_perfManager && !_cfgPerfManager) {\r\n                    if (getCfgValue(_config.enablePerfMgr)) {\r\n                        var createPerfMgr = getCfgValue(_config[STR_CREATE_PERF_MGR /* @min:%2ecreatePerfMgr */]);\r\n                        if (isFunction(createPerfMgr)) {\r\n                            _cfgPerfManager = createPerfMgr(_self, _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */]());\r\n                        }\r\n                    }\r\n                }\r\n                return _perfManager || _cfgPerfManager || getGblPerfMgr();\r\n            };\r\n            _self.setPerfMgr = function (perfMgr) {\r\n                _perfManager = perfMgr;\r\n            };\r\n            _self.eventCnt = function () {\r\n                return _eventQueue[_DYN_LENGTH /* @min:%2elength */];\r\n            };\r\n            _self.releaseQueue = function () {\r\n                if (_isInitialized && _eventQueue[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var eventQueue = _eventQueue;\r\n                    _eventQueue = [];\r\n                    arrForEach(eventQueue, function (event) {\r\n                        _createTelCtx()[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](event);\r\n                    });\r\n                }\r\n            };\r\n            _self.pollInternalLogs = function (eventName) {\r\n                _internalLogsEventName = eventName || null;\r\n                _forceStopInternalLogPoller = false;\r\n                if (_internalLogPoller) {\r\n                    clearInterval(_internalLogPoller);\r\n                    _internalLogPoller = null;\r\n                }\r\n                return _startInternalLogTimer(true);\r\n            };\r\n            function _startInternalLogTimer(alwaysStart) {\r\n                if (!_internalLogPoller && !_forceStopInternalLogPoller) {\r\n                    var shouldStart = alwaysStart || (_self[_DYN_LOGGER /* @min:%2elogger */] && _self[_DYN_LOGGER /* @min:%2elogger */].queue[_DYN_LENGTH /* @min:%2elength */] > 0);\r\n                    if (shouldStart) {\r\n                        var interval = getCfgValue(_config.diagnosticLogInterval);\r\n                        if (!interval || !(interval > 0)) {\r\n                            interval = 10000;\r\n                        }\r\n                        // Keeping as an interval timer for backward compatibility as it returns the result\r\n                        _internalLogPoller = setInterval(function () {\r\n                            clearInterval(_internalLogPoller);\r\n                            _internalLogPoller = 0;\r\n                            _flushInternalLogs();\r\n                        }, interval);\r\n                    }\r\n                }\r\n                return _internalLogPoller;\r\n            }\r\n            _self[_DYN_STOP_POLLING_INTERNA3 /* @min:%2estopPollingInternalLogs */] = function () {\r\n                _forceStopInternalLogPoller = true;\r\n                if (_internalLogPoller) {\r\n                    clearInterval(_internalLogPoller);\r\n                    _internalLogPoller = 0;\r\n                    _flushInternalLogs();\r\n                }\r\n            };\r\n            // Add addTelemetryInitializer\r\n            proxyFunctions(_self, function () { return _telemetryInitializerPlugin; }, [\"addTelemetryInitializer\"]);\r\n            _self.unload = function (isAsync, unloadComplete, cbTimeout) {\r\n                var _a;\r\n                if (isAsync === void 0) { isAsync = true; }\r\n                if (!_isInitialized) {\r\n                    // The SDK is not initialized\r\n                    throwError(strSdkNotInitialized);\r\n                }\r\n                // Check if the SDK still unloading so throw\r\n                if (_isUnloading) {\r\n                    // The SDK is already unloading\r\n                    throwError(strSdkUnloadingError);\r\n                }\r\n                var unloadState = (_a = {\r\n                        reason: 50 /* TelemetryUnloadReason.SdkUnload */\r\n                    },\r\n                    _a[_DYN_IS_ASYNC /* @min:isAsync */] = isAsync,\r\n                    _a.flushComplete = false,\r\n                    _a);\r\n                var processUnloadCtx = createProcessTelemetryUnloadContext(_getPluginChain(), _self);\r\n                processUnloadCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](function () {\r\n                    _initDefaults();\r\n                    unloadComplete && unloadComplete(unloadState);\r\n                }, _self);\r\n                function _doUnload(flushComplete) {\r\n                    unloadState.flushComplete = flushComplete;\r\n                    _isUnloading = true;\r\n                    // Run all of the unload handlers first (before unloading the plugins)\r\n                    _unloadHandlers.run(processUnloadCtx, unloadState);\r\n                    // Stop polling the internal logs\r\n                    _self[_DYN_STOP_POLLING_INTERNA3 /* @min:%2estopPollingInternalLogs */]();\r\n                    // Start unloading the components, from this point onwards the SDK should be considered to be in an unstable state\r\n                    processUnloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](unloadState);\r\n                }\r\n                _flushInternalLogs();\r\n                if (!_flushChannels(isAsync, _doUnload, 6 /* SendRequestReason.SdkUnload */, cbTimeout)) {\r\n                    _doUnload(false);\r\n                }\r\n            };\r\n            _self[_DYN_GET_PLUGIN /* @min:%2egetPlugin */] = _getPlugin;\r\n            _self.addPlugin = function (plugin, replaceExisting, isAsync, addCb) {\r\n                if (!plugin) {\r\n                    addCb && addCb(false);\r\n                    _logOrThrowError(strValidationError);\r\n                    return;\r\n                }\r\n                var existingPlugin = _getPlugin(plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */]);\r\n                if (existingPlugin && !replaceExisting) {\r\n                    addCb && addCb(false);\r\n                    _logOrThrowError(\"Plugin [\" + plugin[_DYN_IDENTIFIER /* @min:%2eidentifier */] + \"] is already loaded!\");\r\n                    return;\r\n                }\r\n                var updateState = {\r\n                    reason: 16 /* TelemetryUpdateReason.PluginAdded */\r\n                };\r\n                function _addPlugin(removed) {\r\n                    _configExtensions[_DYN_PUSH /* @min:%2epush */](plugin);\r\n                    updateState.added = [plugin];\r\n                    // Re-Initialize the plugin chain\r\n                    _initPluginChain(updateState);\r\n                    addCb && addCb(true);\r\n                }\r\n                if (existingPlugin) {\r\n                    var removedPlugins_1 = [existingPlugin.plugin];\r\n                    var unloadState = {\r\n                        reason: 2 /* TelemetryUnloadReason.PluginReplace */,\r\n                        isAsync: !!isAsync\r\n                    };\r\n                    _removePlugins(removedPlugins_1, unloadState, function (removed) {\r\n                        if (!removed) {\r\n                            // Previous plugin was successfully removed or was not installed\r\n                            addCb && addCb(false);\r\n                        }\r\n                        else {\r\n                            updateState.removed = removedPlugins_1;\r\n                            updateState.reason |= 32 /* TelemetryUpdateReason.PluginRemoved */;\r\n                            _addPlugin(true);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    _addPlugin(false);\r\n                }\r\n            };\r\n            _self.evtNamespace = function () {\r\n                return _evtNamespace;\r\n            };\r\n            _self[_DYN_FLUSH /* @min:%2eflush */] = _flushChannels;\r\n            _self.getTraceCtx = function (createNew) {\r\n                if (!_traceCtx) {\r\n                    _traceCtx = createDistributedTraceContext();\r\n                }\r\n                return _traceCtx;\r\n            };\r\n            _self.setTraceCtx = function (traceCtx) {\r\n                _traceCtx = traceCtx || null;\r\n            };\r\n            // Create the addUnloadCb\r\n            proxyFunctionAs(_self, \"addUnloadCb\", function () { return _unloadHandlers; }, \"add\");\r\n            function _initDefaults() {\r\n                _isInitialized = false;\r\n                // Use a default logger so initialization errors are not dropped on the floor with full logging\r\n                _config = objExtend(true, {}, defaultInitConfig);\r\n                _self[_DYN_CONFIG /* @min:%2econfig */] = _config;\r\n                _self[_DYN_LOGGER /* @min:%2elogger */] = new DiagnosticLogger(_config);\r\n                _self[_DYN__EXTENSIONS /* @min:%2e_extensions */] = [];\r\n                _telemetryInitializerPlugin = new TelemetryInitializerPlugin();\r\n                _eventQueue = [];\r\n                _notificationManager = null;\r\n                _perfManager = null;\r\n                _cfgPerfManager = null;\r\n                _cookieManager = null;\r\n                _pluginChain = null;\r\n                _coreExtensions = null;\r\n                _configExtensions = [];\r\n                _channelControl = null;\r\n                _channelConfig = null;\r\n                _channelQueue = null;\r\n                _isUnloading = false;\r\n                _internalLogsEventName = null;\r\n                _evtNamespace = createUniqueNamespace(\"AIBaseCore\", true);\r\n                _unloadHandlers = createUnloadHandlerContainer();\r\n                _traceCtx = null;\r\n            }\r\n            function _createTelCtx() {\r\n                var theCtx = createProcessTelemetryContext(_getPluginChain(), _config, _self);\r\n                theCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](_startInternalLogTimer);\r\n                return theCtx;\r\n            }\r\n            // Initialize or Re-initialize the plugins\r\n            function _initPluginChain(updateState) {\r\n                // Extension validation\r\n                var theExtensions = _validateExtensions(_self[_DYN_LOGGER /* @min:%2elogger */], ChannelControllerPriority, _configExtensions);\r\n                _coreExtensions = theExtensions[STR_CORE /* @min:%2ecore */];\r\n                _pluginChain = null;\r\n                // Sort the complete set of extensions by priority\r\n                var allExtensions = theExtensions.all;\r\n                // Initialize the Channel Queues and the channel plugins first\r\n                _channelQueue = objFreeze(createChannelQueues(_channelConfig, allExtensions, _self));\r\n                if (_channelControl) {\r\n                    // During add / remove of a plugin this may get called again, so don't re-add if already present\r\n                    // But we also want the controller as the last, so remove if already present\r\n                    // And reusing the existing instance, just in case an installed plugin has a reference and\r\n                    // is using it.\r\n                    var idx = arrIndexOf(allExtensions, _channelControl);\r\n                    if (idx !== -1) {\r\n                        allExtensions[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n                    }\r\n                    idx = arrIndexOf(_coreExtensions, _channelControl);\r\n                    if (idx !== -1) {\r\n                        _coreExtensions[_DYN_SPLICE /* @min:%2esplice */](idx, 1);\r\n                    }\r\n                    _channelControl._setQueue(_channelQueue);\r\n                }\r\n                else {\r\n                    _channelControl = createChannelControllerPlugin(_channelQueue, _self);\r\n                }\r\n                // Add on \"channelController\" as the last \"plugin\"\r\n                allExtensions[_DYN_PUSH /* @min:%2epush */](_channelControl);\r\n                _coreExtensions[_DYN_PUSH /* @min:%2epush */](_channelControl);\r\n                // Required to allow plugins to call core.getPlugin() during their own initialization\r\n                _self[_DYN__EXTENSIONS /* @min:%2e_extensions */] = sortPlugins(allExtensions);\r\n                // Initialize the controls\r\n                _channelControl[_DYN_INITIALIZE /* @min:%2einitialize */](_config, _self, allExtensions);\r\n                var initCtx = _createTelCtx();\r\n                initializePlugins(initCtx, allExtensions);\r\n                // Now reset the extensions to just those being managed by Basecore\r\n                _self[_DYN__EXTENSIONS /* @min:%2e_extensions */] = objFreeze(sortPlugins(_coreExtensions || [])).slice();\r\n                if (updateState) {\r\n                    _doUpdate(updateState);\r\n                }\r\n            }\r\n            function _getPlugin(pluginIdentifier) {\r\n                var _a;\r\n                var theExt = null;\r\n                var thePlugin = null;\r\n                arrForEach(_self[_DYN__EXTENSIONS /* @min:%2e_extensions */], function (ext) {\r\n                    if (ext[_DYN_IDENTIFIER /* @min:%2eidentifier */] === pluginIdentifier && ext !== _channelControl && ext !== _telemetryInitializerPlugin) {\r\n                        thePlugin = ext;\r\n                        return -1;\r\n                    }\r\n                });\r\n                if (!thePlugin && _channelControl) {\r\n                    // Check the channel Controller\r\n                    thePlugin = _channelControl.getChannel(pluginIdentifier);\r\n                }\r\n                if (thePlugin) {\r\n                    theExt = (_a = {\r\n                            plugin: thePlugin\r\n                        },\r\n                        _a[_DYN_SET_ENABLED /* @min:setEnabled */] = function (enabled) {\r\n                            _getPluginState(thePlugin)[STR_DISABLED] = !enabled;\r\n                        },\r\n                        _a.isEnabled = function () {\r\n                            var pluginState = _getPluginState(thePlugin);\r\n                            return !pluginState[_DYN_TEARDOWN /* @min:%2eteardown */] && !pluginState[STR_DISABLED];\r\n                        },\r\n                        _a.remove = function (isAsync, removeCb) {\r\n                            var _a;\r\n                            if (isAsync === void 0) { isAsync = true; }\r\n                            var pluginsToRemove = [thePlugin];\r\n                            var unloadState = (_a = {\r\n                                    reason: 1 /* TelemetryUnloadReason.PluginUnload */\r\n                                },\r\n                                _a[_DYN_IS_ASYNC /* @min:isAsync */] = isAsync,\r\n                                _a);\r\n                            _removePlugins(pluginsToRemove, unloadState, function (removed) {\r\n                                if (removed) {\r\n                                    // Re-Initialize the plugin chain\r\n                                    _initPluginChain({\r\n                                        reason: 32 /* TelemetryUpdateReason.PluginRemoved */,\r\n                                        removed: pluginsToRemove\r\n                                    });\r\n                                }\r\n                                removeCb && removeCb(removed);\r\n                            });\r\n                        },\r\n                        _a);\r\n                }\r\n                return theExt;\r\n            }\r\n            function _getPluginChain() {\r\n                if (!_pluginChain) {\r\n                    // copy the collection of extensions\r\n                    var extensions = (_coreExtensions || []).slice();\r\n                    // During add / remove this may get called again, so don't readd if already present\r\n                    if (arrIndexOf(extensions, _telemetryInitializerPlugin) === -1) {\r\n                        extensions[_DYN_PUSH /* @min:%2epush */](_telemetryInitializerPlugin);\r\n                    }\r\n                    _pluginChain = createTelemetryProxyChain(sortPlugins(extensions), _config, _self);\r\n                }\r\n                return _pluginChain;\r\n            }\r\n            function _removePlugins(thePlugins, unloadState, removeComplete) {\r\n                if (thePlugins && thePlugins[_DYN_LENGTH /* @min:%2elength */] > 0) {\r\n                    var unloadChain = createTelemetryProxyChain(thePlugins, _config, _self);\r\n                    var unloadCtx = createProcessTelemetryUnloadContext(unloadChain, _self);\r\n                    unloadCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](function () {\r\n                        var removed = false;\r\n                        // Remove the listed config extensions\r\n                        var newConfigExtensions = [];\r\n                        arrForEach(_configExtensions, function (plugin, idx) {\r\n                            if (!_isPluginPresent(plugin, thePlugins)) {\r\n                                newConfigExtensions[_DYN_PUSH /* @min:%2epush */](plugin);\r\n                            }\r\n                            else {\r\n                                removed = true;\r\n                            }\r\n                        });\r\n                        _configExtensions = newConfigExtensions;\r\n                        // Re-Create the channel config\r\n                        var newChannelConfig = [];\r\n                        if (_channelConfig) {\r\n                            arrForEach(_channelConfig, function (queue, idx) {\r\n                                var newQueue = [];\r\n                                arrForEach(queue, function (channel) {\r\n                                    if (!_isPluginPresent(channel, thePlugins)) {\r\n                                        newQueue[_DYN_PUSH /* @min:%2epush */](channel);\r\n                                    }\r\n                                    else {\r\n                                        removed = true;\r\n                                    }\r\n                                });\r\n                                newChannelConfig[_DYN_PUSH /* @min:%2epush */](newQueue);\r\n                            });\r\n                            _channelConfig = newChannelConfig;\r\n                        }\r\n                        removeComplete && removeComplete(removed);\r\n                        _startInternalLogTimer();\r\n                    });\r\n                    unloadCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](unloadState);\r\n                }\r\n                else {\r\n                    removeComplete(false);\r\n                }\r\n            }\r\n            function _flushInternalLogs() {\r\n                if (_self[_DYN_LOGGER /* @min:%2elogger */] && _self[_DYN_LOGGER /* @min:%2elogger */].queue) {\r\n                    var queue = _self[_DYN_LOGGER /* @min:%2elogger */].queue.slice(0);\r\n                    _self[_DYN_LOGGER /* @min:%2elogger */].queue[_DYN_LENGTH /* @min:%2elength */] = 0;\r\n                    arrForEach(queue, function (logMessage) {\r\n                        var _a;\r\n                        var item = (_a = {},\r\n                            _a[_DYN_NAME /* @min:name */] = _internalLogsEventName ? _internalLogsEventName : \"InternalMessageId: \" + logMessage[_DYN_MESSAGE_ID /* @min:%2emessageId */],\r\n                            _a.iKey = getCfgValue(_config[_DYN_INSTRUMENTATION_KEY /* @min:%2einstrumentationKey */]),\r\n                            _a.time = toISOString(new Date()),\r\n                            _a.baseType = _InternalLogMessage.dataType,\r\n                            _a.baseData = { message: logMessage[_DYN_MESSAGE /* @min:%2emessage */] },\r\n                            _a);\r\n                        _self.track(item);\r\n                    });\r\n                }\r\n            }\r\n            function _flushChannels(isAsync, callBack, sendReason, cbTimeout) {\r\n                if (_channelControl) {\r\n                    return _channelControl[_DYN_FLUSH /* @min:%2eflush */](isAsync, callBack, sendReason || 6 /* SendRequestReason.SdkUnload */, cbTimeout);\r\n                }\r\n                callBack && callBack(false);\r\n                return true;\r\n            }\r\n            function _initDebugListener() {\r\n                var disableDbgExt = getCfgValue(_config.disableDbgExt);\r\n                if (disableDbgExt === true && _debugListener) {\r\n                    // Remove any previously loaded debug listener\r\n                    _notificationManager[_DYN_REMOVE_NOTIFICATION_2 /* @min:%2eremoveNotificationListener */](_debugListener);\r\n                    _debugListener = null;\r\n                }\r\n                if (_notificationManager && !_debugListener && disableDbgExt !== true) {\r\n                    _debugListener = getDebugListener(_config);\r\n                    _notificationManager[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */](_debugListener);\r\n                }\r\n            }\r\n            function _initPerfManager() {\r\n                var enablePerfMgr = getCfgValue(_config.enablePerfMgr);\r\n                if (!enablePerfMgr && _cfgPerfManager) {\r\n                    // Remove any existing config based performance manager\r\n                    _cfgPerfManager = null;\r\n                }\r\n                if (enablePerfMgr) {\r\n                    // Set the performance manager creation function if not defined\r\n                    getSetValue(_config, STR_CREATE_PERF_MGR, _createPerfManager);\r\n                }\r\n            }\r\n            function _initExtConfig() {\r\n                var extConfig = getSetValue(_config, STR_EXTENSION_CONFIG, {});\r\n                extConfig.NotificationManager = _notificationManager;\r\n            }\r\n            function _doUpdate(updateState) {\r\n                var updateCtx = createProcessTelemetryUpdateContext(_getPluginChain(), _self);\r\n                updateCtx[_DYN_ON_COMPLETE /* @min:%2eonComplete */](_startInternalLogTimer);\r\n                if (!_self._updateHook || _self._updateHook(updateCtx, updateState) !== true) {\r\n                    updateCtx[_DYN_PROCESS_NEXT /* @min:%2eprocessNext */](updateState);\r\n                }\r\n            }\r\n            function _logOrThrowError(message) {\r\n                var logger = _self[_DYN_LOGGER /* @min:%2elogger */];\r\n                if (logger) {\r\n                    // there should always be a logger\r\n                    _throwInternal(logger, 2 /* eLoggingSeverity.WARNING */, 73 /* _eInternalMessageId.PluginException */, message);\r\n                    _startInternalLogTimer();\r\n                }\r\n                else {\r\n                    throwError(message);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    BaseCore.prototype.initialize = function (config, extensions, logger, notificationManager) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    BaseCore.prototype.getTransmissionControls = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    BaseCore.prototype.track = function (telemetryItem) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    BaseCore.prototype.getProcessTelContext = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    BaseCore.prototype.getNotifyMgr = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Adds a notification listener. The SDK calls methods on the listener when an appropriate notification is raised.\r\n     * The added plugins must raise notifications. If the plugins do not implement the notifications, then no methods will be\r\n     * called.\r\n     * @param {INotificationListener} listener - An INotificationListener object.\r\n     */\r\n    BaseCore.prototype.addNotificationListener = function (listener) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Removes all instances of the listener.\r\n     * @param {INotificationListener} listener - INotificationListener to remove.\r\n     */\r\n    BaseCore.prototype.removeNotificationListener = function (listener) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Get the current cookie manager for this instance\r\n     */\r\n    BaseCore.prototype.getCookieMgr = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Set the current cookie manager for this instance\r\n     * @param cookieMgr - The manager, if set to null/undefined will cause the default to be created\r\n     */\r\n    BaseCore.prototype.setCookieMgr = function (cookieMgr) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    BaseCore.prototype.getPerfMgr = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    BaseCore.prototype.setPerfMgr = function (perfMgr) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    BaseCore.prototype.eventCnt = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return 0;\r\n    };\r\n    /**\r\n     * Enable the timer that checks the logger.queue for log messages to be flushed.\r\n     * Note: Since 3.0.1 and 2.8.13 this is no longer an interval timer but is a normal\r\n     * timer that is only started when this function is called and then subsequently\r\n     * only _if_ there are any logger.queue messages to be sent.\r\n     */\r\n    BaseCore.prototype.pollInternalLogs = function (eventName) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return 0;\r\n    };\r\n    /**\r\n     * Stop the timer that log messages from logger.queue when available\r\n     */\r\n    BaseCore.prototype.stopPollingInternalLogs = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add a telemetry processor to decorate or drop telemetry events.\r\n     * @param telemetryInitializer - The Telemetry Initializer function\r\n     * @returns - A ITelemetryInitializerHandler to enable the initializer to be removed\r\n     */\r\n    BaseCore.prototype.addTelemetryInitializer = function (telemetryInitializer) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Unload and Tear down the SDK and any initialized plugins, after calling this the SDK will be considered\r\n     * to be un-initialized and non-operational, re-initializing the SDK should only be attempted if the previous\r\n     * unload call return `true` stating that all plugins reported that they also unloaded, the recommended\r\n     * approach is to create a new instance and initialize that instance.\r\n     * This is due to possible unexpected side effects caused by plugins not supporting unload / teardown, unable\r\n     * to successfully remove any global references or they may just be completing the unload process asynchronously.\r\n     * @param isAsync - Can the unload be performed asynchronously (default)\r\n     * @param unloadComplete - An optional callback that will be called once the unload has completed\r\n     * @param cbTimeout - An optional timeout to wait for any flush operations to complete before proceeding with the unload. Defaults to 5 seconds.\r\n     */\r\n    BaseCore.prototype.unload = function (isAsync, unloadComplete, cbTimeout) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    BaseCore.prototype.getPlugin = function (pluginIdentifier) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Add a new plugin to the installation\r\n     * @param plugin - The new plugin to add\r\n     * @param replaceExisting - should any existing plugin be replaced, default is false\r\n     * @param doAsync - Should the add be performed asynchronously\r\n     * @param addCb - [Optional] callback to call after the plugin has been added\r\n     */\r\n    BaseCore.prototype.addPlugin = function (plugin, replaceExisting, doAsync, addCb) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Returns the unique event namespace that should be used\r\n     */\r\n    BaseCore.prototype.evtNamespace = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Add an unload handler that will be called when the SDK is being unloaded\r\n     * @param handler - the handler\r\n     */\r\n    BaseCore.prototype.addUnloadCb = function (handler) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Flush and send any batched / cached data immediately\r\n     * @param async - send data asynchronously when true (defaults to true)\r\n     * @param callBack - if specified, notify caller when send is complete, the channel should return true to indicate to the caller that it will be called.\r\n     * If the caller doesn't return true the caller should assume that it may never be called.\r\n     * @param sendReason - specify the reason that you are calling \"flush\" defaults to ManualFlush (1) if not specified\r\n     * @returns - true if the callback will be return after the flush is complete otherwise the caller should assume that any provided callback will never be called\r\n     */\r\n    BaseCore.prototype.flush = function (isAsync, callBack, sendReason) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Gets the current distributed trace context for this instance if available\r\n     * @param createNew - Optional flag to create a new instance if one doesn't currently exist, defaults to true\r\n     */\r\n    BaseCore.prototype.getTraceCtx = function (createNew) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Sets the current distributed trace context for this instance if available\r\n     */\r\n    BaseCore.prototype.setTraceCtx = function (newTracectx) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    BaseCore.prototype.releaseQueue = function () {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Hook for Core extensions to allow them to update their own configuration before updating all of the plugins.\r\n     * @param updateCtx - The plugin update context\r\n     * @param updateState - The Update State\r\n     * @returns boolean - True means the extension class will call updateState otherwise the Core will\r\n     */\r\n    BaseCore.prototype._updateHook = function (updateCtx, updateState) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    return BaseCore;\r\n}());\r\nexport { BaseCore };\r\n//# sourceMappingURL=BaseCore.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_ADD_NOTIFICATION_LIS1, _DYN_IS_ASYNC, _DYN_IS_CHILD_EVT, _DYN_LISTENERS, _DYN_PUSH, _DYN_REMOVE_NOTIFICATION_2, _DYN_SPLICE } from \"../__DynamicConstants\";\r\nimport { arrForEach, arrIndexOf } from \"./HelperFuncs\";\r\nimport { STR_EVENTS_DISCARDED, STR_EVENTS_SEND_REQUEST, STR_EVENTS_SENT, STR_PERF_EVENT } from \"./InternalConstants\";\r\nfunction _runListeners(listeners, name, isAsync, callback) {\r\n    arrForEach(listeners, function (listener) {\r\n        if (listener && listener[name]) {\r\n            if (isAsync) {\r\n                setTimeout(function () { return callback(listener); }, 0);\r\n            }\r\n            else {\r\n                try {\r\n                    callback(listener);\r\n                }\r\n                catch (e) {\r\n                    // Catch errors to ensure we don't block sending the requests\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n/**\r\n * Class to manage sending notifications to all the listeners.\r\n */\r\nvar NotificationManager = /** @class */ (function () {\r\n    function NotificationManager(config) {\r\n        this.listeners = [];\r\n        var perfEvtsSendAll = !!(config || {}).perfEvtsSendAll;\r\n        dynamicProto(NotificationManager, this, function (_self) {\r\n            _self[_DYN_ADD_NOTIFICATION_LIS1 /* @min:%2eaddNotificationListener */] = function (listener) {\r\n                _self.listeners[_DYN_PUSH /* @min:%2epush */](listener);\r\n            };\r\n            /**\r\n             * Removes all instances of the listener.\r\n             * @param {INotificationListener} listener - AWTNotificationListener to remove.\r\n             */\r\n            _self[_DYN_REMOVE_NOTIFICATION_2 /* @min:%2eremoveNotificationListener */] = function (listener) {\r\n                var index = arrIndexOf(_self[_DYN_LISTENERS /* @min:%2elisteners */], listener);\r\n                while (index > -1) {\r\n                    _self.listeners[_DYN_SPLICE /* @min:%2esplice */](index, 1);\r\n                    index = arrIndexOf(_self[_DYN_LISTENERS /* @min:%2elisteners */], listener);\r\n                }\r\n            };\r\n            /**\r\n             * Notification for events sent.\r\n             * @param {ITelemetryItem[]} events - The array of events that have been sent.\r\n             */\r\n            _self[STR_EVENTS_SENT /* @min:%2eeventsSent */] = function (events) {\r\n                _runListeners(_self[_DYN_LISTENERS /* @min:%2elisteners */], STR_EVENTS_SENT, true, function (listener) {\r\n                    listener[STR_EVENTS_SENT /* @min:%2eeventsSent */](events);\r\n                });\r\n            };\r\n            /**\r\n             * Notification for events being discarded.\r\n             * @param {ITelemetryItem[]} events - The array of events that have been discarded by the SDK.\r\n             * @param {number} reason           - The reason for which the SDK discarded the events. The EventsDiscardedReason\r\n             * constant should be used to check the different values.\r\n             */\r\n            _self[STR_EVENTS_DISCARDED /* @min:%2eeventsDiscarded */] = function (events, reason) {\r\n                _runListeners(_self[_DYN_LISTENERS /* @min:%2elisteners */], STR_EVENTS_DISCARDED, true, function (listener) {\r\n                    listener[STR_EVENTS_DISCARDED /* @min:%2eeventsDiscarded */](events, reason);\r\n                });\r\n            };\r\n            /**\r\n             * [Optional] A function called when the events have been requested to be sent to the sever.\r\n             * @param {number} sendReason - The reason why the event batch is being sent.\r\n             * @param {boolean} isAsync   - A flag which identifies whether the requests are being sent in an async or sync manner.\r\n             */\r\n            _self[STR_EVENTS_SEND_REQUEST /* @min:%2eeventsSendRequest */] = function (sendReason, isAsync) {\r\n                _runListeners(_self[_DYN_LISTENERS /* @min:%2elisteners */], STR_EVENTS_SEND_REQUEST, isAsync, function (listener) {\r\n                    listener[STR_EVENTS_SEND_REQUEST /* @min:%2eeventsSendRequest */](sendReason, isAsync);\r\n                });\r\n            };\r\n            _self[STR_PERF_EVENT /* @min:%2eperfEvent */] = function (perfEvent) {\r\n                if (perfEvent) {\r\n                    // Send all events or only parent events\r\n                    if (perfEvtsSendAll || !perfEvent[_DYN_IS_CHILD_EVT /* @min:%2eisChildEvt */]()) {\r\n                        _runListeners(_self[_DYN_LISTENERS /* @min:%2elisteners */], STR_PERF_EVENT, false, function (listener) {\r\n                            if (perfEvent[_DYN_IS_ASYNC /* @min:%2eisAsync */]) {\r\n                                setTimeout(function () { return listener[STR_PERF_EVENT /* @min:%2eperfEvent */](perfEvent); }, 0);\r\n                            }\r\n                            else {\r\n                                listener[STR_PERF_EVENT /* @min:%2eperfEvent */](perfEvent);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            };\r\n        });\r\n    }\r\n    /**\r\n     * Adds a notification listener.\r\n     * @param {INotificationListener} listener - The notification listener to be added.\r\n     */\r\n    NotificationManager.prototype.addNotificationListener = function (listener) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Removes all instances of the listener.\r\n     * @param {INotificationListener} listener - AWTNotificationListener to remove.\r\n     */\r\n    NotificationManager.prototype.removeNotificationListener = function (listener) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Notification for events sent.\r\n     * @param {ITelemetryItem[]} events - The array of events that have been sent.\r\n     */\r\n    NotificationManager.prototype.eventsSent = function (events) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Notification for events being discarded.\r\n     * @param {ITelemetryItem[]} events - The array of events that have been discarded by the SDK.\r\n     * @param {number} reason           - The reason for which the SDK discarded the events. The EventsDiscardedReason\r\n     * constant should be used to check the different values.\r\n     */\r\n    NotificationManager.prototype.eventsDiscarded = function (events, reason) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * [Optional] A function called when the events have been requested to be sent to the sever.\r\n     * @param {number} sendReason - The reason why the event batch is being sent.\r\n     * @param {boolean} isAsync   - A flag which identifies whether the requests are being sent in an async or sync manner.\r\n     */\r\n    NotificationManager.prototype.eventsSendRequest = function (sendReason, isAsync) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return NotificationManager;\r\n}());\r\nexport { NotificationManager };\r\n//# sourceMappingURL=NotificationManager.js.map", "import { __extends } from \"tslib\";\r\n// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { _DYN_GET_NOTIFY_MGR, _DYN_INITIALIZE, _DYN_NAME } from \"../__DynamicConstants\";\r\nimport { BaseCore } from \"./BaseCore\";\r\nimport { DiagnosticLogger } from \"./DiagnosticLogger\";\r\nimport { isNullOrUndefined, throwError } from \"./HelperFuncs\";\r\nimport { STR_EVENTS_DISCARDED, STR_GET_PERF_MGR } from \"./InternalConstants\";\r\nimport { NotificationManager } from \"./NotificationManager\";\r\nimport { doPerf } from \"./PerfManager\";\r\nvar AppInsightsCore = /** @class */ (function (_super) {\r\n    __extends(AppInsightsCore, _super);\r\n    function AppInsightsCore() {\r\n        var _this = _super.call(this) || this;\r\n        dynamicProto(AppInsightsCore, _this, function (_self, _base) {\r\n            _self[_DYN_INITIALIZE /* @min:%2einitialize */] = function (config, extensions, logger, notificationManager) {\r\n                _base[_DYN_INITIALIZE /* @min:%2einitialize */](config, extensions, logger || new DiagnosticLogger(config), notificationManager || new NotificationManager(config));\r\n            };\r\n            _self.track = function (telemetryItem) {\r\n                doPerf(_self[STR_GET_PERF_MGR /* @min:%2egetPerfMgr */](), function () { return \"AppInsightsCore:track\"; }, function () {\r\n                    if (telemetryItem === null) {\r\n                        _notifyInvalidEvent(telemetryItem);\r\n                        // throw error\r\n                        throwError(\"Invalid telemetry item\");\r\n                    }\r\n                    // do basic validation before sending it through the pipeline\r\n                    _validateTelemetryItem(telemetryItem);\r\n                    _base.track(telemetryItem);\r\n                }, function () { return ({ item: telemetryItem }); }, !(telemetryItem.sync));\r\n            };\r\n            function _validateTelemetryItem(telemetryItem) {\r\n                if (isNullOrUndefined(telemetryItem[_DYN_NAME /* @min:%2ename */])) {\r\n                    _notifyInvalidEvent(telemetryItem);\r\n                    throwError(\"telemetry name required\");\r\n                }\r\n            }\r\n            function _notifyInvalidEvent(telemetryItem) {\r\n                var manager = _self[_DYN_GET_NOTIFY_MGR /* @min:%2egetNotifyMgr */]();\r\n                if (manager) {\r\n                    manager[STR_EVENTS_DISCARDED /* @min:%2eeventsDiscarded */]([telemetryItem], 2 /* eEventsDiscardedReason.InvalidEvent */);\r\n                }\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    AppInsightsCore.prototype.initialize = function (config, extensions, logger, notificationManager) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    AppInsightsCore.prototype.track = function (telemetryItem) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return AppInsightsCore;\r\n}(BaseCore));\r\nexport { AppInsightsCore };\r\n//# sourceMappingURL=AppInsightsCore.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Generally you should only put values that are used more than 2 times and then only if not already exposed as a constant (such as SdkCoreNames)\r\n// as when using \"short\" named values from here they will be will be minified smaller than the SdkCoreNames[eSdkCoreNames.xxxx] value.\r\nexport var STR_EMPTY = \"\";\r\nexport var STR_DEFAULT_ENDPOINT_URL = \"https://browser.events.data.microsoft.com/OneCollector/1.0/\";\r\nexport var STR_PLUGIN_VERSION_STRING = \"pluginVersionString\";\r\nexport var STR_PLUGIN_VERSION_STRING_ARR = STR_PLUGIN_VERSION_STRING + \"Arr\";\r\nexport var STR_VERSION = \"version\";\r\nexport var STR_PROPERTIES = \"properties\";\r\n//# sourceMappingURL=InternalConstants.js.map", "var _a;\r\n/**\r\n* Utils.ts\r\n* @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n* @copyright Microsoft 2018\r\n* File containing utility functions.\r\n*/\r\nimport { addEventHandler, addPageUnloadEventListener, areCookiesSupported, arrForEach, arrIndexOf, arrMap, arrReduce, dateNow, generateW3CId, getDocument, getGlobalInst, getNavigator, getWindow, hasOwnProperty, isArray, isBeaconsSupported, isBoolean, isDate, isError, isFunction, isIE, isNullOrUndefined, isNumber, isObject, isReactNative, isString, isTypeof, isUndefined, mwcRandom32, mwcRandomSeed, newGuid, newId, objDefineAccessors, objForEachKey, objKeys, perfNow, random32, randomValue, safeGetCookieMgr, strEndsWith, strObject, strTrim, strUndefined, toISOString, uaDisallowsSameSiteNone, useXDomainRequest } from \"@microsoft/applicationinsights-core-js\";\r\nimport { ObjHasOwnProperty, objCreateFn, strShimObject, strShimPrototype } from \"@microsoft/applicationinsights-shims\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\nexport var Version = '3.2.18';\r\nexport var FullVersionString = \"1DS-Web-JS-\" + Version;\r\n// Defining here so we don't need to take (import) the ApplicationInsights Common module\r\nvar strDisabledPropertyName = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nvar strWithCredentials = \"withCredentials\";\r\nvar strTimeout = \"timeout\";\r\n// If value is array just get the type for the first element\r\nvar _fieldTypeEventPropMap = (_a = {},\r\n    _a[0 /* FieldValueSanitizerType.NotSet */] = 0 /* eEventPropertyType.Unspecified */,\r\n    _a[2 /* FieldValueSanitizerType.Number */] = 6 /* eEventPropertyType.Double */,\r\n    _a[1 /* FieldValueSanitizerType.String */] = 1 /* eEventPropertyType.String */,\r\n    _a[3 /* FieldValueSanitizerType.Boolean */] = 7 /* eEventPropertyType.Bool */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 2 /* FieldValueSanitizerType.Number */] = 6 /* eEventPropertyType.Double */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 1 /* FieldValueSanitizerType.String */] = 1 /* eEventPropertyType.String */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 3 /* FieldValueSanitizerType.Boolean */] = 7 /* eEventPropertyType.Bool */,\r\n    _a);\r\n/**\r\n * @ignore\r\n */\r\n// let _uaDisallowsSameSiteNone = null;\r\nvar uInt8ArraySupported = null;\r\n// var _areCookiesAvailable: boolean | undefined;\r\n/**\r\n * Checks if document object is available\r\n */\r\nexport var isDocumentObjectAvailable = Boolean(getDocument());\r\n/**\r\n * Checks if window object is available\r\n */\r\nexport var isWindowObjectAvailable = Boolean(getWindow());\r\n/**\r\n * Checks if value is assigned to the given param.\r\n * @param value - The token from which the tenant id is to be extracted.\r\n * @returns True/false denoting if value is assigned to the param.\r\n */\r\nexport function isValueAssigned(value) {\r\n    /// <summary> takes a value and checks for undefined, null and empty string </summary>\r\n    /// <param type=\"any\"> value to be tested </param>\r\n    /// <returns> true if value is null undefined or emptyString </returns>\r\n    return !(value === STR_EMPTY || isNullOrUndefined(value));\r\n}\r\n/**\r\n * Gets the tenant id from the tenant token.\r\n * @param apiKey - The token from which the tenant id is to be extracted.\r\n * @returns The tenant id.\r\n */\r\nexport function getTenantId(apiKey) {\r\n    if (apiKey) {\r\n        var indexTenantId = apiKey.indexOf(\"-\");\r\n        if (indexTenantId > -1) {\r\n            return apiKey.substring(0, indexTenantId);\r\n        }\r\n    }\r\n    return STR_EMPTY;\r\n}\r\n/**\r\n * Checks if Uint8Array are available in the current environment. Safari and Firefox along with\r\n * ReactNative are known to not support Uint8Array properly.\r\n * @returns True if available, false otherwise.\r\n */\r\nexport function isUint8ArrayAvailable() {\r\n    if (uInt8ArraySupported === null) {\r\n        uInt8ArraySupported = !isUndefined(Uint8Array) && !isSafariOrFirefox() && !isReactNative();\r\n    }\r\n    return uInt8ArraySupported;\r\n}\r\n/**\r\n * Checks if the value is a valid EventLatency.\r\n * @param value - The value that needs to be checked.\r\n * @returns True if the value is in AWTEventLatency, false otherwise.\r\n */\r\nexport function isLatency(value) {\r\n    if (value && isNumber(value) && value >= 1 /* EventLatencyValue.Normal */ && value <= 4 /* EventLatencyValue.Immediate */) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Sanitizes the Property. It checks the that the property name and value are valid. It also\r\n * checks/populates the correct type and pii of the property value.\r\n * @param name - property name                          - The property name.\r\n * @param property - The property value or an IEventProperty containing value,\r\n * type ,pii and customer content.\r\n * @returns IEventProperty containing valid name, value, pii and type or null if invalid.\r\n */\r\nexport function sanitizeProperty(name, property, stringifyObjects) {\r\n    // Check that property is valid\r\n    if ((!property && !isValueAssigned(property)) || typeof name !== \"string\") {\r\n        return null;\r\n    }\r\n    // Perf optimization -- only need to get the type once not multiple times\r\n    var propType = typeof property;\r\n    // If the property isn't IEventProperty (and is either string, number, boolean or array), convert it into one.\r\n    if (propType === \"string\" || propType === \"number\" || propType === \"boolean\" || isArray(property)) {\r\n        property = { value: property };\r\n    }\r\n    else if (propType === \"object\" && !ObjHasOwnProperty.call(property, \"value\")) {\r\n        property = { value: stringifyObjects ? JSON.stringify(property) : property };\r\n    }\r\n    else if (isNullOrUndefined(property.value)\r\n        || property.value === STR_EMPTY || (!isString(property.value)\r\n        && !isNumber(property.value) && !isBoolean(property.value)\r\n        && !isArray(property.value))) {\r\n        // Since property is IEventProperty, we need to validate its value\r\n        return null;\r\n    }\r\n    // We need to check that if the property value is an array, it is valid\r\n    if (isArray(property.value) &&\r\n        !isArrayValid(property.value)) {\r\n        return null;\r\n    }\r\n    // If either pii or cc is set convert value to string (since only string pii/cc is allowed).\r\n    // If the value is a complex type like an array that can't be converted to string we will drop\r\n    // the property.\r\n    if (!isNullOrUndefined(property.kind)) {\r\n        if (isArray(property.value) || !isValueKind(property.kind)) {\r\n            return null;\r\n        }\r\n        property.value = property.value.toString();\r\n    }\r\n    return property;\r\n}\r\nexport function getCommonSchemaMetaData(value, kind, type) {\r\n    var encodedTypeValue = -1;\r\n    if (!isUndefined(value)) {\r\n        if (kind > 0) {\r\n            if (kind === 32) {\r\n                // encode customer content. Value can only be string. bit 13-16 are for cc\r\n                encodedTypeValue = (1 << 13);\r\n            }\r\n            else if (kind <= 13) {\r\n                // encode PII. Value can only be string. bits 5-12 are for Pii\r\n                encodedTypeValue = (kind << 5);\r\n            }\r\n        }\r\n        // isDataType checks that the \"type\" is a number so we don't need to check for undefined\r\n        if (isDataType(type)) {\r\n            // Data Type is provided and valid, so use that\r\n            if (encodedTypeValue === -1) {\r\n                // Don't return -1\r\n                encodedTypeValue = 0;\r\n            }\r\n            encodedTypeValue |= type;\r\n        }\r\n        else {\r\n            var propType = _fieldTypeEventPropMap[getFieldValueType(value)] || -1;\r\n            if (encodedTypeValue !== -1 && propType !== -1) {\r\n                // pii exists so we must return correct type\r\n                encodedTypeValue |= propType;\r\n            }\r\n            else if (propType === 6 /* eEventPropertyType.Double */) {\r\n                encodedTypeValue = propType;\r\n            }\r\n        }\r\n    }\r\n    return encodedTypeValue;\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().disable()\r\n * Force the SDK not to store and read any data from cookies.\r\n * Overriding the applicationinsights-core version for tree-shaking\r\n */\r\nexport function disableCookies() {\r\n    safeGetCookieMgr(null).setEnabled(false);\r\n}\r\n/**\r\n * @deprecated - Use the oneDs.getCookieMgr().set()\r\n * Sets the value of a cookie.\r\n * @param name - Cookie name.\r\n * @param value - Cookie value.\r\n * @param days - Expiration days.\r\n */\r\nexport function setCookie(name, value, days) {\r\n    if (areCookiesSupported(null)) {\r\n        safeGetCookieMgr(null).set(name, value, days * 86400, null, \"/\");\r\n    }\r\n}\r\n/**\r\n * @deprecated - Use the oneDs.getCookieMgr().del()\r\n * Deletes a cookie, by setting its expiration to -1.\r\n * @param name - Cookie name to delete.\r\n */\r\nexport function deleteCookie(name) {\r\n    if (areCookiesSupported(null)) {\r\n        safeGetCookieMgr(null).del(name);\r\n    }\r\n}\r\n/**\r\n * @deprecated - Use the oneDs.getCookieMgr().get()\r\n * Gets the cookie value for the specified cookie.\r\n * if value is k1=v1&k2==v2 then will return 'v1' for key 'k1'\r\n * @param cookieName - Cookie name.\r\n */\r\nexport function getCookie(name) {\r\n    if (areCookiesSupported(null)) {\r\n        return getCookieValue(safeGetCookieMgr(null), name);\r\n    }\r\n    return STR_EMPTY;\r\n}\r\n/**\r\n * Helper to get and decode the cookie value using decodeURIComponent, this is for historical\r\n * backward compatibility where the document.cookie value was decoded before parsing.\r\n * @param cookieMgr - The cookie manager to use\r\n * @param name - The name of the cookie to get\r\n * @param decode - A flag to indicate whether the cookie value should be decoded\r\n * @returns The decoded cookie value (if available) otherwise an empty string.\r\n */\r\nexport function getCookieValue(cookieMgr, name, decode) {\r\n    if (decode === void 0) { decode = true; }\r\n    var cookieValue;\r\n    if (cookieMgr) {\r\n        cookieValue = cookieMgr.get(name);\r\n        if (decode && cookieValue && decodeURIComponent) {\r\n            cookieValue = decodeURIComponent(cookieValue);\r\n        }\r\n    }\r\n    return cookieValue || STR_EMPTY;\r\n}\r\n/**\r\n * Create a new guid.\r\n * @param style - The style of guid to generated, defaults to Digits\r\n * Digits (Default) : 32 digits separated by hyphens: 00000000-0000-0000-0000-000000000000\r\n * Braces - 32 digits separated by hyphens, enclosed in braces: {00000000-0000-0000-0000-000000000000}\r\n * Parentheses - 32 digits separated by hyphens, enclosed in parentheses: (00000000-0000-0000-0000-000000000000)\r\n * Numeric - 32 digits: 00000000000000000000000000000000\r\n * @returns The formatted guid.\r\n */\r\nexport function createGuid(style) {\r\n    if (style === void 0) { style = \"D\" /* GuidStyle.Digits */; }\r\n    var theGuid = newGuid();\r\n    if (style === \"B\" /* GuidStyle.Braces */) {\r\n        theGuid = \"{\" + theGuid + \"}\";\r\n    }\r\n    else if (style === \"P\" /* GuidStyle.Parentheses */) {\r\n        theGuid = \"(\" + theGuid + \")\";\r\n    }\r\n    else if (style === \"N\" /* GuidStyle.Numeric */) {\r\n        theGuid = theGuid.replace(/-/g, STR_EMPTY);\r\n    }\r\n    return theGuid;\r\n}\r\n/**\r\n * Pass in the objects to merge as arguments.\r\n * @param obj1 - object to merge.  Set this argument to 'true' for a deep extend.\r\n * @param obj2 - object to merge.\r\n * @param obj3 - object to merge.\r\n * @param obj4 - object to merge.\r\n * @param obj5 - object to merge.\r\n * @returns The extended object.\r\n */\r\nexport function extend(obj, obj2, obj3, obj4, obj5) {\r\n    // Variables\r\n    var extended = {};\r\n    var deep = false;\r\n    var i = 0;\r\n    var length = arguments.length;\r\n    var objProto = Object[strShimPrototype];\r\n    var theArgs = arguments;\r\n    // Check if a deep merge\r\n    if (objProto.toString.call(theArgs[0]) === \"[object Boolean]\") {\r\n        deep = theArgs[0];\r\n        i++;\r\n    }\r\n    // Loop through each object and conduct a merge\r\n    for (; i < length; i++) {\r\n        var obj = theArgs[i];\r\n        objForEachKey(obj, function (prop, value) {\r\n            // If deep merge and property is an object, merge properties\r\n            if (deep && value && isObject(value)) {\r\n                if (isArray(value)) {\r\n                    extended[prop] = extended[prop] || [];\r\n                    arrForEach(value, function (arrayValue, arrayIndex) {\r\n                        if (arrayValue && isObject(arrayValue)) {\r\n                            extended[prop][arrayIndex] = extend(true, extended[prop][arrayIndex], arrayValue);\r\n                        }\r\n                        else {\r\n                            extended[prop][arrayIndex] = arrayValue;\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    extended[prop] = extend(true, extended[prop], value);\r\n                }\r\n            }\r\n            else {\r\n                extended[prop] = value;\r\n            }\r\n        });\r\n    }\r\n    return extended;\r\n}\r\nexport var getTime = perfNow;\r\nexport function isValueKind(value) {\r\n    // Always assume that it's a number (no type checking) for performance as this is used during the JSON serialization\r\n    if (value === 0 /* eValueKind.NotSet */ || ((value > 0 /* eValueKind.NotSet */ && value <= 13 /* eValueKind.Pii_IPV4AddressLegacy */) || value === 32 /* eValueKind.CustomerContent_GenericContent */)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isDataType(value) {\r\n    // Remark: 0 returns false, but it doesn't affect encoding anyways\r\n    // Always assume that it's a number (no type checking) for performance as this is used during the JSON serialization\r\n    if (value >= 0 && value <= 9) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isSafariOrFirefox() {\r\n    var nav = getNavigator();\r\n    // If non-browser navigator will be undefined\r\n    if (!isUndefined(nav) && nav.userAgent) {\r\n        var ua = nav.userAgent.toLowerCase();\r\n        if ((ua.indexOf(\"safari\") >= 0 || ua.indexOf(\"firefox\") >= 0) && ua.indexOf(\"chrome\") < 0) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function isArrayValid(value) {\r\n    return value.length > 0;\r\n}\r\nexport function setProcessTelemetryTimings(event, identifier) {\r\n    var evt = event;\r\n    evt.timings = evt.timings || {};\r\n    evt.timings.processTelemetryStart = evt.timings.processTelemetryStart || {};\r\n    evt.timings.processTelemetryStart[identifier] = getTime();\r\n}\r\n/**\r\n * Returns a bitwise value for the FieldValueSanitizerType enum representing the decoded type of the passed value\r\n * @param value The value to determine the type\r\n */\r\nexport function getFieldValueType(value) {\r\n    var theType = 0 /* FieldValueSanitizerType.NotSet */;\r\n    if (value !== null && value !== undefined) {\r\n        var objType = typeof value;\r\n        if (objType === \"string\") {\r\n            theType = 1 /* FieldValueSanitizerType.String */;\r\n        }\r\n        else if (objType === \"number\") {\r\n            theType = 2 /* FieldValueSanitizerType.Number */;\r\n        }\r\n        else if (objType === \"boolean\") {\r\n            theType = 3 /* FieldValueSanitizerType.Boolean */;\r\n        }\r\n        else if (objType === strShimObject) {\r\n            theType = 4 /* FieldValueSanitizerType.Object */;\r\n            if (isArray(value)) {\r\n                theType = 4096 /* FieldValueSanitizerType.Array */;\r\n                if (value.length > 0) {\r\n                    // Empty arrays are not supported and are considered to be the same as null\r\n                    theType |= getFieldValueType(value[0]);\r\n                }\r\n            }\r\n            else if (ObjHasOwnProperty.call(value, \"value\")) {\r\n                // Looks like an IEventProperty\r\n                theType = 8192 /* FieldValueSanitizerType.EventProperty */ | getFieldValueType(value.value);\r\n            }\r\n        }\r\n    }\r\n    return theType;\r\n}\r\nexport var Utils = {\r\n    Version: Version,\r\n    FullVersionString: FullVersionString,\r\n    strUndefined: strUndefined,\r\n    strObject: strObject,\r\n    Undefined: strUndefined,\r\n    arrForEach: arrForEach,\r\n    arrIndexOf: arrIndexOf,\r\n    arrMap: arrMap,\r\n    arrReduce: arrReduce,\r\n    objKeys: objKeys,\r\n    toISOString: toISOString,\r\n    isReactNative: isReactNative,\r\n    isString: isString,\r\n    isNumber: isNumber,\r\n    isBoolean: isBoolean,\r\n    isFunction: isFunction,\r\n    isArray: isArray,\r\n    isObject: isObject,\r\n    strTrim: strTrim,\r\n    isDocumentObjectAvailable: isDocumentObjectAvailable,\r\n    isWindowObjectAvailable: isWindowObjectAvailable,\r\n    isValueAssigned: isValueAssigned,\r\n    getTenantId: getTenantId,\r\n    isBeaconsSupported: isBeaconsSupported,\r\n    isUint8ArrayAvailable: isUint8ArrayAvailable,\r\n    isLatency: isLatency,\r\n    sanitizeProperty: sanitizeProperty,\r\n    getISOString: toISOString,\r\n    useXDomainRequest: useXDomainRequest,\r\n    getCommonSchemaMetaData: getCommonSchemaMetaData,\r\n    cookieAvailable: areCookiesSupported,\r\n    disallowsSameSiteNone: uaDisallowsSameSiteNone,\r\n    setCookie: setCookie,\r\n    deleteCookie: deleteCookie,\r\n    getCookie: getCookie,\r\n    createGuid: createGuid,\r\n    extend: extend,\r\n    getTime: getTime,\r\n    isValueKind: isValueKind,\r\n    isArrayValid: isArrayValid,\r\n    objDefineAccessors: objDefineAccessors,\r\n    addPageUnloadEventListener: addPageUnloadEventListener,\r\n    setProcessTelemetryTimings: setProcessTelemetryTimings,\r\n    addEventHandler: addEventHandler,\r\n    getFieldValueType: getFieldValueType,\r\n    strEndsWith: strEndsWith,\r\n    objForEachKey: objForEachKey\r\n};\r\n/**\r\n * Provides a collection of utility functions, included for backward compatibility with previous releases.\r\n * @deprecated Marking this instance as deprecated in favor of direct usage of the helper functions\r\n * as direct usage provides better tree-shaking and minification by avoiding the inclusion of the unused items\r\n * in your resulting code.\r\n * Overriding the applicationinsights-core version for tree-shaking\r\n */\r\nexport var CoreUtils = {\r\n    _canUseCookies: undefined,\r\n    isTypeof: isTypeof,\r\n    isUndefined: isUndefined,\r\n    isNullOrUndefined: isNullOrUndefined,\r\n    hasOwnProperty: hasOwnProperty,\r\n    isFunction: isFunction,\r\n    isObject: isObject,\r\n    isDate: isDate,\r\n    isArray: isArray,\r\n    isError: isError,\r\n    isString: isString,\r\n    isNumber: isNumber,\r\n    isBoolean: isBoolean,\r\n    toISOString: toISOString,\r\n    arrForEach: arrForEach,\r\n    arrIndexOf: arrIndexOf,\r\n    arrMap: arrMap,\r\n    arrReduce: arrReduce,\r\n    strTrim: strTrim,\r\n    objCreate: objCreateFn,\r\n    objKeys: objKeys,\r\n    objDefineAccessors: objDefineAccessors,\r\n    addEventHandler: addEventHandler,\r\n    dateNow: dateNow,\r\n    isIE: isIE,\r\n    disableCookies: disableCookies,\r\n    newGuid: newGuid,\r\n    perfNow: perfNow,\r\n    newId: newId,\r\n    randomValue: randomValue,\r\n    random32: random32,\r\n    mwcRandomSeed: mwcRandomSeed,\r\n    mwcRandom32: mwcRandom32,\r\n    generateW3CId: generateW3CId\r\n};\r\n/**\r\n * Helper to identify whether we are running in a chromium based browser environment\r\n */\r\nexport function isChromium() {\r\n    return !!getGlobalInst(\"chrome\");\r\n}\r\n/**\r\n * Create and open an XMLHttpRequest object\r\n * @param method - The request method\r\n * @param urlString - The url\r\n * @param withCredentials - Option flag indicating that credentials should be sent\r\n * @param disabled - Optional flag indicating that the XHR object should be marked as disabled and not tracked (default is false)\r\n * @param isSync - Optional flag indicating if the instance should be a synchronous request (defaults to false)\r\n * @param timeout - Optional value identifying the timeout value that should be assigned to the XHR request\r\n * @returns A new opened XHR request\r\n */\r\nexport function openXhr(method, urlString, withCredentials, disabled, isSync, timeout) {\r\n    if (disabled === void 0) { disabled = false; }\r\n    if (isSync === void 0) { isSync = false; }\r\n    function _wrapSetXhrProp(xhr, prop, value) {\r\n        try {\r\n            xhr[prop] = value;\r\n        }\r\n        catch (e) {\r\n            // - Wrapping as depending on the environment setting the property may fail (non-terminally)\r\n        }\r\n    }\r\n    var xhr = new XMLHttpRequest();\r\n    if (disabled) {\r\n        // Tag the instance so it's not tracked (trackDependency)\r\n        // If the environment has locked down the XMLHttpRequest (preventExtensions and/or freeze), this would\r\n        // cause the request to fail and we no telemetry would be sent\r\n        _wrapSetXhrProp(xhr, strDisabledPropertyName, disabled);\r\n    }\r\n    if (withCredentials) {\r\n        // Some libraries require that the withCredentials flag is set \"before\" open and\r\n        // - Wrapping as IE 10 has started throwing when setting before open\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    xhr.open(method, urlString, !isSync);\r\n    if (withCredentials) {\r\n        // withCredentials should be set AFTER open (https://xhr.spec.whatwg.org/#the-withcredentials-attribute)\r\n        // And older firefox instances from 11+ will throw for sync events (current versions don't) which happens during unload processing\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    // Only set the timeout for asynchronous requests as\r\n    // \"Timeout shouldn't be used for synchronous XMLHttpRequests requests used in a document environment or it will throw an InvalidAccessError exception.\"\"\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/timeout\r\n    if (!isSync && timeout) {\r\n        _wrapSetXhrProp(xhr, strTimeout, timeout);\r\n    }\r\n    return xhr;\r\n}\r\n//# sourceMappingURL=Utils.js.map", "import { __extends } from \"tslib\";\r\n/**\r\n* AppInsightsCore.ts\r\n* @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n* @copyright Microsoft 2018\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { AppInsightsCore as InternalCore, DiagnosticLogger, _throwInternal, arrForEach, doPerf, dumpObj, throwError } from \"@microsoft/applicationinsights-core-js\";\r\nimport { STR_DEFAULT_ENDPOINT_URL, STR_EMPTY, STR_PROPERTIES, STR_VERSION } from \"./InternalConstants\";\r\nimport { FullVersionString, getTime, isLatency } from \"./Utils\";\r\nvar AppInsightsCore = /** @class */ (function (_super) {\r\n    __extends(AppInsightsCore, _super);\r\n    function AppInsightsCore() {\r\n        var _this = _super.call(this) || this;\r\n        _this.pluginVersionStringArr = [];\r\n        dynamicProto(AppInsightsCore, _this, function (_self, _base) {\r\n            if (!_self.logger || !_self.logger.queue) {\r\n                // The AI Base can inject a No-Op logger so if not defined or the No-Op, change to use a default logger so initialization errors\r\n                // are not dropped on the floor if one is not already defined\r\n                _self.logger = new DiagnosticLogger({ loggingLevelConsole: 1 /* eLoggingSeverity.CRITICAL */ });\r\n            }\r\n            _self.initialize = function (config, extensions, logger, notificationManager) {\r\n                doPerf(_self, function () { return \"AppInsightsCore.initialize\"; }, function () {\r\n                    var _pluginVersionStringArr = _self.pluginVersionStringArr;\r\n                    // Add default collector url\r\n                    if (config) {\r\n                        if (!config.endpointUrl) {\r\n                            config.endpointUrl = STR_DEFAULT_ENDPOINT_URL;\r\n                        }\r\n                        var propertyStorageOverride = config.propertyStorageOverride;\r\n                        // Validate property storage override\r\n                        if (propertyStorageOverride && (!propertyStorageOverride.getProperty || !propertyStorageOverride.setProperty)) {\r\n                            throwError(\"Invalid property storage override passed.\");\r\n                        }\r\n                        if (config.channels) {\r\n                            arrForEach(config.channels, function (channels) {\r\n                                if (channels) {\r\n                                    arrForEach(channels, function (channel) {\r\n                                        if (channel.identifier && channel.version) {\r\n                                            var ver = channel.identifier + \"=\" + channel.version;\r\n                                            _pluginVersionStringArr.push(ver);\r\n                                        }\r\n                                    });\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                    _self.getWParam = function () {\r\n                        return (typeof document !== \"undefined\" || !!config.enableWParam) ? 0 : -1;\r\n                    };\r\n                    if (extensions) {\r\n                        arrForEach(extensions, function (ext) {\r\n                            if (ext && ext.identifier && ext.version) {\r\n                                var ver = ext.identifier + \"=\" + ext.version;\r\n                                _pluginVersionStringArr.push(ver);\r\n                            }\r\n                        });\r\n                    }\r\n                    _self.pluginVersionString = _pluginVersionStringArr.join(\";\");\r\n                    _self.pluginVersionStringArr = _pluginVersionStringArr;\r\n                    try {\r\n                        _base.initialize(config, extensions, logger, notificationManager);\r\n                        _self.pollInternalLogs(\"InternalLog\");\r\n                    }\r\n                    catch (e) {\r\n                        var logger_1 = _self.logger;\r\n                        var message = dumpObj(e);\r\n                        if (message.indexOf(\"channels\") !== -1) {\r\n                            // Add some additional context to the underlying reported error\r\n                            message += \"\\n - Channels must be provided through config.channels only!\";\r\n                        }\r\n                        _throwInternal(logger_1, 1 /* eLoggingSeverity.CRITICAL */, 514 /* _eExtendedInternalMessageId.FailedToInitializeSDK */, \"SDK Initialization Failed - no telemetry will be sent: \" + message);\r\n                    }\r\n                }, function () { return ({ config: config, extensions: extensions, logger: logger, notificationManager: notificationManager }); });\r\n            };\r\n            _self.track = function (item) {\r\n                doPerf(_self, function () { return \"AppInsightsCore.track\"; }, function () {\r\n                    var telemetryItem = item;\r\n                    if (telemetryItem) {\r\n                        telemetryItem.timings = telemetryItem.timings || {};\r\n                        telemetryItem.timings.trackStart = getTime();\r\n                        if (!isLatency(telemetryItem.latency)) {\r\n                            telemetryItem.latency = 1 /* EventLatencyValue.Normal */;\r\n                        }\r\n                        var itemExt = telemetryItem.ext = telemetryItem.ext || {};\r\n                        itemExt.sdk = itemExt.sdk || {};\r\n                        itemExt.sdk.ver = FullVersionString;\r\n                        var baseData = telemetryItem.baseData = telemetryItem.baseData || {};\r\n                        baseData[STR_PROPERTIES] = baseData[STR_PROPERTIES] || {};\r\n                        var itemProperties = baseData[STR_PROPERTIES];\r\n                        itemProperties[STR_VERSION] = itemProperties[STR_VERSION] || _self.pluginVersionString || STR_EMPTY;\r\n                    }\r\n                    _base.track(telemetryItem);\r\n                }, function () { return ({ item: item }); }, !(item.sync));\r\n            };\r\n        });\r\n        return _this;\r\n    }\r\n    /**\r\n     * Initialize the sdk.\r\n     * @param config - The configuration to initialize the SDK.\r\n     * @param extensions - An array of extensions that are to be used by the core.\r\n     */\r\n    AppInsightsCore.prototype.initialize = function (config, extensions, logger, notificationManager) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    AppInsightsCore.prototype.track = function (item) {\r\n        // @DynamicProtoStub -- DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return AppInsightsCore;\r\n}(InternalCore));\r\nexport default AppInsightsCore;\r\n//# sourceMappingURL=AppInsightsCore.js.map", "import { IExtendedTelemetryItem, IEventProperty, isBoolean, isString, isNullOrUndefined } from '@microsoft/1ds-core-js';\r\nimport {\r\n  DataField,\r\n  DataFieldType,\r\n  DataClassification,\r\n  logError,\r\n  Category,\r\n  FilledTelemetryEvent,\r\n  logNotification,\r\n  LogLevel,\r\n  EventType,\r\n  Platform,\r\n  AudienceGroup,\r\n  PrimaryIdentitySpace,\r\n  DnmInterval\r\n} from '@microsoft/oteljs';\r\nimport { Preprocessor } from './DataModels';\r\n\r\n// Constants\r\nconst DATA_TOKEN = 'Data.';\r\nconst CONTRACT_TOKEN = 'zC.';\r\nexport const RELEASE_AUDIENCEGROUP: string = 'Release.AudienceGroup';\r\nexport const WAC_RING: string = 'WAC.Ring';\r\nexport const APP_NAME: string = 'App.Name';\r\nexport const APP_PLATFORM: string = 'App.Platform';\r\nexport const APP_VERSION: string = 'App.Version';\r\nconst USER_PRIMARYIDENTITYHASH = 'User.PrimaryIdentityHash';\r\nconst USER_PRIMARYIDENTITYSPACE = 'User.PrimaryIdentitySpace';\r\nconst USER_TENANTID = 'User.TenantId';\r\nconst USER_ISANONYMOUS = 'User.IsAnonymous';\r\nconst USER_ISSIGNEDIN = 'User.IsSignedIn';\r\nconst SESSION_ID = 'Session.Id';\r\n\r\n/**\r\n * Aria token for Office.Telemetry\r\n */\r\nexport const ARIA_OFFICE_TELEMETRY_TOKEN = 'f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405'; // Office.Telemetry\r\nexport const CUSTOMER_CONTENT_TENANT_TOKEN = 'b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121';\r\n\r\nexport const voidValue: void = undefined;\r\nexport type OneDSData = { [name: string]: IEventProperty | string | boolean };\r\n\r\n/**\r\n * Enum for property types.\r\n *\r\n * Duplicated here to keep references to 1ds-core-js from bloating our code.\r\n * Copied from @microsoft/1ds-core-js in shared/core/src/Enums.ts\r\n * If you include EventPropertyType from 1ds-core-js, it also grabs 4KB of other enums\r\n * The '1DS SDK tests'=>'EventPropertyType' verify that these are in sync\r\n */\r\nexport const enum EventPropertyType {\r\n  Unspecified = 0,\r\n  // eslint-disable-next-line id-denylist\r\n  String = 1,\r\n  Int32 = 2,\r\n  UInt32 = 3,\r\n  Int64 = 4,\r\n  UInt64 = 5,\r\n  Double = 6,\r\n  Bool = 7,\r\n  Guid = 8,\r\n  DateTime = 9\r\n}\r\n\r\n/**\r\n * Endpoint to send 1DS CCCO telemetry events to. Includes public and special environments endpoints.\r\n */\r\nexport const enum OneDSCCCOEndpoint {\r\n  /**\r\n   * Public endpoint\r\n   */ PUBLIC = 'https://office-c.events.data.microsoft.com/OneCollector/1.0/',\r\n  /**\r\n   * EUDB endpoint\r\n   */ EUDB = 'https://eu-office-c.events.data.microsoft.com/OneCollector/1.0/'\r\n}\r\n\r\n/**\r\n * Add OTelJS DataField fields to a 1DS data object\r\n * @param data The object to hold 1DS fields\r\n * @param fields The DataField fields to add\r\n * @param options The IOneDSFieldOptions for changing how fields are added\r\n * @return true if event is valid, false is event is invalid\r\n */\r\nexport function addOneDSFields(\r\n  data: IExtendedTelemetryItem['data'],\r\n  fields: DataField[] | undefined,\r\n  prependDataToken: boolean,\r\n  eventType: EventType\r\n): boolean {\r\n  let validEvent: boolean = true;\r\n\r\n  if (fields) {\r\n    for (let field of fields) {\r\n      const fieldClassification = field.classification;\r\n      const fieldDataType = field.dataType;\r\n      const fieldName = field.name;\r\n\r\n      // We can usually only send SystemMetadata or EssentialServiceMetadata\r\n      // CustomerContent is also possible if it's enabled\r\n      // We drop events with other fields\r\n      if (\r\n        fieldClassification &&\r\n        !(\r\n          fieldClassification === DataClassification.SystemMetadata ||\r\n          fieldClassification === DataClassification.EssentialServiceMetadata ||\r\n          (eventType === EventType.CustomerContent && fieldClassification === DataClassification.CustomerContent) ||\r\n          (eventType === EventType.DirectNumericEvent && fieldClassification === DataClassification.DirectMeasurementData)\r\n        )\r\n      ) {\r\n        validEvent = false;\r\n        break;\r\n      }\r\n\r\n      // Part C Direct Numeric fields can only be of boolean, double, or int64 data type\r\n      // Prepend data token indicates that the field is a Part C field\r\n      if (\r\n        eventType === EventType.DirectNumericEvent &&\r\n        prependDataToken &&\r\n        fieldDataType !== DataFieldType.Double &&\r\n        fieldDataType !== DataFieldType.Boolean &&\r\n        fieldDataType !== DataFieldType.Int64 &&\r\n        fieldName !== 'OTelJS.Version' &&\r\n        fieldName !== 'OTelJS.Sink'\r\n      ) {\r\n        logNotification(LogLevel.Error, Category.Sink, () => 'DNM: Invalid field type ' + fieldName);\r\n        validEvent = false;\r\n        break;\r\n      }\r\n\r\n      let modifiedFieldName;\r\n      if (prependDataToken) {\r\n        if (fieldName.substr(0, 3) === CONTRACT_TOKEN) {\r\n          modifiedFieldName = CONTRACT_TOKEN + DATA_TOKEN + fieldName.substr(3);\r\n        } else {\r\n          modifiedFieldName = DATA_TOKEN + fieldName;\r\n        }\r\n      } else {\r\n        modifiedFieldName = fieldName;\r\n      }\r\n\r\n      let eventPropertyType: number;\r\n      switch (fieldDataType) {\r\n        case DataFieldType.Double:\r\n          eventPropertyType = EventPropertyType.Double;\r\n          break;\r\n        case DataFieldType.Int64:\r\n          eventPropertyType = EventPropertyType.Int64;\r\n          break;\r\n        case DataFieldType.Guid:\r\n          eventPropertyType = EventPropertyType.Guid;\r\n          break;\r\n        case DataFieldType.String:\r\n          // Strings and booleans are set directly, not as IEventProperties -\r\n          // tables get created with the appropriate data types on the collector side.\r\n          // This helps to save about 25% of the event size!\r\n          // The 1DS SDK assigns a default type of Double to any numbers, so we still\r\n          // to send the data types for those values.\r\n\r\n          // Limit the maximum allowed string length on a data field to avoid accidentally going over\r\n          // the maximum allowed serialized size for a 1DS event and having the event dropped.\r\n          // That and 1ds-post v2.4.4 and v3.0.0 have a bug that will put the code into an infinite\r\n          // loop if that condition is trigged.\r\n\r\n          // Some callers erroneously pass a non-string value here, which we pass on to the SDK as-is.\r\n          data![modifiedFieldName] = typeof field.value === 'string' ? field.value.substr(0, 25000) : (field as any).value;\r\n          continue;\r\n        case DataFieldType.Boolean:\r\n        default:\r\n          data![modifiedFieldName] = field.value;\r\n          continue;\r\n      }\r\n\r\n      let eventProperty: IEventProperty = {\r\n        value: field.value,\r\n        propertyType: eventPropertyType\r\n      };\r\n\r\n      data![modifiedFieldName] = eventProperty;\r\n    }\r\n  }\r\n\r\n  return validEvent;\r\n}\r\n\r\nexport function tryCatch<T>(func: () => T, errorReturn: T) {\r\n  try {\r\n    return func();\r\n  } catch (error) {\r\n    logError(Category.Sink, '1DS Sink', error);\r\n    return errorReturn;\r\n  }\r\n}\r\n\r\nexport function preprocessEvent(telemetryEvent: FilledTelemetryEvent, preprocessors: Preprocessor[]) {\r\n  for (let i = 0; i < preprocessors.length; i++) {\r\n    const preprocessor = preprocessors[i];\r\n    if (!preprocessor.processEvent(telemetryEvent)) {\r\n      logNotification(LogLevel.Info, Category.Sink, () => {\r\n        return `${telemetryEvent.eventName} suppressed by ${preprocessor.name}`;\r\n      });\r\n\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction logInvalidField(fieldName: string) {\r\n  logNotification(LogLevel.Error, Category.Sink, () => {\r\n    return 'Invalid ' + fieldName;\r\n  });\r\n}\r\n\r\nfunction isNonEmptyString(value: any): boolean {\r\n  return isString(value) && value !== '';\r\n}\r\nfunction matchesEnum(value: any, enumType: Record<string, string>) {\r\n  // eslint-disable-next-line no-restricted-properties\r\n  return Object.values(enumType).includes(value);\r\n}\r\nfunction isValidAppPlatform(value: any) {\r\n  return matchesEnum(value, Platform);\r\n}\r\nfunction isValidReleaseAudienceGroup(value: any) {\r\n  return matchesEnum(value, AudienceGroup);\r\n}\r\nfunction isValidPrimaryIdentitySpace(value: any) {\r\n  // In v5 we can save some bytes and iterate through the PrimaryIdentitySpace enum directly.\r\n  // Currently that list has a bunch of deprecated values.\r\n  return [\r\n    PrimaryIdentitySpace.MSACID,\r\n    PrimaryIdentitySpace.MSAPUID,\r\n    PrimaryIdentitySpace.OrgIdCID,\r\n    PrimaryIdentitySpace.OrgIdPUID,\r\n    PrimaryIdentitySpace.UserObjectId,\r\n    PrimaryIdentitySpace.Other\r\n  ].includes(value);\r\n}\r\nfunction isOtherIfDefined(value: any) {\r\n  return !value || value === PrimaryIdentitySpace.Other;\r\n}\r\n\r\nexport function areCoreFieldsValid(data: OneDSData, strict: boolean) {\r\n  let isValid = true;\r\n\r\n  function validateField(fieldName: string, validate: (value: any) => boolean) {\r\n    if (!validate(data[fieldName])) {\r\n      logInvalidField(fieldName);\r\n      isValid = false;\r\n    }\r\n  }\r\n  function isValidGuid(value: string): boolean {\r\n    // If not strict, use \"i\" for case-insensitive match\r\n    const regexpFlags = strict ? '' : 'i';\r\n    // Manually reviewed regex\r\n    // eslint-disable-next-line security/detect-unsafe-regex\r\n    const guid = new RegExp('^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$', regexpFlags);\r\n    return guid.test(value as string);\r\n  }\r\n\r\n  validateField(APP_NAME, isNonEmptyString);\r\n  validateField(APP_PLATFORM, strict ? isValidAppPlatform : isNonEmptyString);\r\n  validateField(APP_VERSION, isNonEmptyString);\r\n  validateField(SESSION_ID, isValidGuid);\r\n  if (strict) {\r\n    validateField(RELEASE_AUDIENCEGROUP, isValidReleaseAudienceGroup);\r\n    validateField(USER_ISSIGNEDIN, isBoolean);\r\n\r\n    if (data[USER_ISSIGNEDIN]) {\r\n      validateField(USER_PRIMARYIDENTITYHASH, isNonEmptyString);\r\n      validateField(USER_PRIMARYIDENTITYSPACE, isValidPrimaryIdentitySpace);\r\n      if (\r\n        [PrimaryIdentitySpace.OrgIdCID, PrimaryIdentitySpace.OrgIdPUID, PrimaryIdentitySpace.UserObjectId].includes(\r\n          data[USER_PRIMARYIDENTITYSPACE] as any\r\n        )\r\n      ) {\r\n        validateField(USER_TENANTID, isValidGuid);\r\n      } else {\r\n        validateField(USER_TENANTID, isNullOrUndefined);\r\n      }\r\n    } else {\r\n      validateField(USER_PRIMARYIDENTITYSPACE, isOtherIfDefined);\r\n      validateField(USER_TENANTID, isNullOrUndefined);\r\n    }\r\n  } else {\r\n    // If IsAnonymous is false or unset, then User fields must be defined.\r\n    // If IsAnonymous is true, we don't check user fields.\r\n    if (!data[USER_ISANONYMOUS] && data[USER_ISSIGNEDIN] !== false) {\r\n      validateField(USER_PRIMARYIDENTITYHASH, isNonEmptyString);\r\n      validateField(USER_PRIMARYIDENTITYSPACE, isNonEmptyString);\r\n      if (data[USER_TENANTID]) {\r\n        validateField(USER_TENANTID, isValidGuid);\r\n      }\r\n    }\r\n  }\r\n\r\n  // IsAnonymous and IsSignedIn cannot have the same value\r\n  if (!isNullOrUndefined(data[USER_ISANONYMOUS]) && data[USER_ISSIGNEDIN] === data[USER_ISANONYMOUS]) {\r\n    logInvalidField(USER_ISANONYMOUS);\r\n    isValid = false;\r\n  }\r\n\r\n  return isValid;\r\n}\r\n\r\n/**\r\n * Get a properly formatted timestamp\r\n * @param event - Telemetry event to calculate timestamp for\r\n */\r\nexport function getTimestamp(event: FilledTelemetryEvent): Date {\r\n  return event.timestamp ? new Date(event.timestamp) : new Date();\r\n}\r\n\r\n/**\r\n * Get a properly formatted timestamp based on DNM interval\r\n * @param event - Telemetry event to calculate timestamp for\r\n */\r\nexport function getDnmTimestamp(event: FilledTelemetryEvent): Date {\r\n  let eventTime: Date = getTimestamp(event);\r\n  // To reduce risk of a privacy incident, direct numeric events\r\n  // will always have seconds and milliseconds zeroed out\r\n  eventTime.setMilliseconds(0);\r\n  eventTime.setSeconds(0);\r\n  eventTime.setMinutes(0);\r\n  if (event.telemetryProperties.dnmInterval === DnmInterval.Daily) {\r\n    eventTime.setHours(0);\r\n  }\r\n  return eventTime;\r\n}\r\n", "import {\r\n  TelemetryEvent,\r\n  DataField,\r\n  CustomerContentType,\r\n  EventType,\r\n  FilledTelemetryEvent,\r\n  CustomerContentEvent,\r\n  DiagnosticLevel,\r\n  logNotification,\r\n  Category,\r\n  LogLevel,\r\n  cloneEvent,\r\n  User,\r\n  App,\r\n  Session,\r\n  Release\r\n} from '@microsoft/oteljs';\r\nimport {\r\n  addOneDSFields,\r\n  preprocessEvent,\r\n  areCoreFieldsValid,\r\n  OneDSData,\r\n  OneDSCCCOEndpoint,\r\n  CUSTOMER_CONTENT_TENANT_TOKEN,\r\n  EventPropertyType,\r\n  getTimestamp\r\n} from './InternalUtils';\r\nimport { IExtendedTelemetryItem, IEventProperty, ITelemetryItem, newGuid } from '@microsoft/1ds-core-js';\r\nimport { Preprocessor, OneDSHelperProperties, OneDSEndpoint } from './DataModels';\r\n\r\nconst MAX_CUSTOMER_CONTENT_MAJOR_VERSION = 2;\r\n\r\ninterface IOneDSEventProperties {\r\n  eventType: EventType;\r\n  timestamp?: number;\r\n}\r\n\r\n/**\r\n * Get the corresponding 1DS CCCO Endpoint for a customer content event, for sending via an external instance of the 1DS SDK\r\n * @param oneDSEndpoint - The public 1DS Endpoint.\r\n */\r\nexport function getCorrespondingCCCOEndpoint(oneDSEndpoint: OneDSEndpoint | string): string | undefined {\r\n  switch (oneDSEndpoint) {\r\n    case OneDSEndpoint.PUBLIC:\r\n      return OneDSCCCOEndpoint.PUBLIC;\r\n    case OneDSEndpoint.EUDB:\r\n      return OneDSCCCOEndpoint.EUDB;\r\n    default:\r\n      return undefined;\r\n  }\r\n}\r\n\r\n/**\r\n * OneDSHelper helps to create a 1DS telemetry event\r\n *\r\n */\r\nexport class OneDSHelper {\r\n  /**\r\n   * Number of telemetry events processed\r\n   * Also equal to the Event Sequence\r\n   */\r\n  public eventsProcessed: number = 0;\r\n\r\n  /**\r\n   * Number of telemetry events sent\r\n   */\r\n  public eventsSent: number = 0;\r\n\r\n  /**\r\n   * Number of telemetry events discarded by the 1DS SDK\r\n   */\r\n  public eventsDiscarded: number = 0;\r\n\r\n  /**\r\n   * Constructs an 1DS Helper\r\n   * @param persistentDataFields - Data fields to be sent with every event; these data fields are assumed to\r\n   * be top-level static fields, and will not be prepended with \"Data.\"\r\n   * @param oneDSHelperProperties - Properties on the sinks\r\n   */\r\n  constructor(persistentDataFields: DataField[], oneDSHelperProperties: OneDSHelperProperties) {\r\n    // #region Private variables\r\n    let _preprocessors: Preprocessor[] = [];\r\n    let _optionalEventsEnabled: boolean = false;\r\n    let _isEnabled = true;\r\n    let _diagnosticLevelChecker: Preprocessor = {\r\n      name: 'DiagnosticLevel',\r\n      /**\r\n       * Determine whether an event can be sent. Generally returns true; returns\r\n       * false if the event does not have the appropriate event flags and the optional events override is not enabled.\r\n       * @param telemetryEvent - An event to process\r\n       */\r\n      processEvent: (telemetryEvent: FilledTelemetryEvent) => {\r\n        const diagnosticLevel = telemetryEvent.eventFlags.diagnosticLevel;\r\n        return (\r\n          _optionalEventsEnabled ||\r\n          diagnosticLevel === DiagnosticLevel.Required ||\r\n          diagnosticLevel === DiagnosticLevel.RequiredServiceData ||\r\n          diagnosticLevel === DiagnosticLevel.RequiredServiceDataForEssentialServices\r\n        );\r\n      }\r\n    };\r\n    // These are persistent data fields kept by the OneDSHelper\r\n    let _helperPersistentOneDSDataFields: OneDSData = {};\r\n    let _oneDSSinkSessionId = newGuid();\r\n    // let _epoch = new Date().getTime().toString();\r\n    // #endregion\r\n\r\n    // #region Public functions\r\n    this.init = (_disableSinkOnInvalidCoreFields?: boolean) => {\r\n      return areCoreFieldsValid(_helperPersistentOneDSDataFields, false);\r\n    };\r\n\r\n    this.begin = () => {\r\n      _isEnabled = _isEnabled && areCoreFieldsValid(_helperPersistentOneDSDataFields, true);\r\n      return _isEnabled;\r\n    };\r\n\r\n    this.getOneDSTelemetryEvent = (telemetryEvent: TelemetryEvent) => {\r\n      return getOneDSEventInternal(telemetryEvent, {\r\n        eventType: EventType.SendTelemetryEvent\r\n      });\r\n    };\r\n\r\n    this.getOneDSCustomerContent = (telemetryEvent: TelemetryEvent) => {\r\n      let customerContentVersion = telemetryEvent.telemetryProperties!.customerContentVersion;\r\n      if (\r\n        customerContentVersion &&\r\n        Math.floor(customerContentVersion) <= MAX_CUSTOMER_CONTENT_MAJOR_VERSION &&\r\n        telemetryEvent.telemetryProperties!.customerContentType === CustomerContentType.MocaAddIn\r\n      ) {\r\n        return getOneDSEventInternal(telemetryEvent, { eventType: EventType.CustomerContent });\r\n      }\r\n      return undefined;\r\n    };\r\n\r\n    /**\r\n     * Gets a tenant token to use for sending the event\r\n     * @param telemetryEvent - The event to be sent, which should have a tenant token in its properties\r\n     */\r\n    const getTenantToken = (telemetryEvent: TelemetryEvent, eventType: EventType): string | undefined => {\r\n      if (eventType === EventType.CustomerContent) {\r\n        return CUSTOMER_CONTENT_TENANT_TOKEN;\r\n      }\r\n      if (\r\n        !telemetryEvent.telemetryProperties ||\r\n        (eventType === EventType.SendTelemetryEvent && !telemetryEvent.telemetryProperties.ariaTenantToken)\r\n      ) {\r\n        logNotification(LogLevel.Error, Category.Sink, () => 'Missing Aria Token');\r\n        return undefined;\r\n      }\r\n      if (eventType === EventType.SendTelemetryEvent) {\r\n        return telemetryEvent.telemetryProperties.ariaTenantToken;\r\n      }\r\n\r\n      return undefined;\r\n    };\r\n\r\n    /**\r\n     * Create a 1DS telemetry event with the Event contract and data fields\r\n     * @param telemetryEvent - The telemetry event to be sent\r\n     * @param eventProperties - Properties for the event\r\n     */\r\n    const getOneDSEventInternal = (telemetryEvent: TelemetryEvent, eventProperties: IOneDSEventProperties) => {\r\n      if (!_isEnabled) {\r\n        return;\r\n      }\r\n\r\n      // Clone the event, because preprocessEvent might modify it\r\n      const internalEvent = cloneEvent(telemetryEvent);\r\n      if (preprocessEvent(internalEvent, _preprocessors)) {\r\n        const eventTime = getTimestamp(internalEvent).toISOString();\r\n\r\n        const data: IExtendedTelemetryItem['data'] = {\r\n          'Event.Name': internalEvent.eventName,\r\n          'Event.Source': 'OTelJS',\r\n          'Event.Time': { value: eventTime, propertyType: EventPropertyType.DateTime }\r\n        };\r\n\r\n        this.eventsProcessed++;\r\n\r\n        data['Event.Sequence'] = { value: this.eventsProcessed, propertyType: EventPropertyType.Int64 };\r\n        data['Event.Id'] = _oneDSSinkSessionId + '.' + this.eventsProcessed;\r\n\r\n        for (let fieldName in _helperPersistentOneDSDataFields) {\r\n          data[fieldName] = _helperPersistentOneDSDataFields[fieldName];\r\n        }\r\n\r\n        // If a field is found that makes the event invalid, drop the event\r\n        if (!addOneDSFields(data, internalEvent.dataFields, /*prependDataToken*/ true, eventProperties.eventType)) {\r\n          logNotification(LogLevel.Error, Category.Sink, () => 'Dropping Event: ' + internalEvent.eventName);\r\n          return undefined;\r\n        }\r\n\r\n        let baseType = 'custom';\r\n\r\n        // Event Contract\r\n        if (internalEvent.eventContract) {\r\n          if (internalEvent.eventContract.name) {\r\n            data['Event.Contract'] = internalEvent.eventContract.name;\r\n            baseType += '.' + internalEvent.eventContract.name.toLowerCase().replace(/\\./g, '_');\r\n          }\r\n          addOneDSFields(data, internalEvent.eventContract.dataFields, /*prependDataToken*/ false, eventProperties.eventType);\r\n        }\r\n\r\n        const token = getTenantToken(internalEvent, eventProperties.eventType);\r\n\r\n        if (!token) {\r\n          return undefined;\r\n        }\r\n\r\n        const oneDSEvent: ITelemetryItem = {\r\n          iKey: token,\r\n          name: internalEvent.eventName,\r\n          data,\r\n          time: eventTime,\r\n          baseType,\r\n          ext: {\r\n            sdk: {\r\n              seq: this.eventsProcessed\r\n            }\r\n          }\r\n        };\r\n\r\n        return oneDSEvent;\r\n      }\r\n      return undefined;\r\n    };\r\n\r\n    this.addPreprocessor = (preprocessor: Preprocessor) => {\r\n      _preprocessors.push(preprocessor);\r\n    };\r\n\r\n    this.getOneDSPersistentDataFields = () => {\r\n      return _helperPersistentOneDSDataFields;\r\n    };\r\n\r\n    this.getPreprocessors = () => {\r\n      return _preprocessors;\r\n    };\r\n\r\n    // Persistent data fields should not contain customer content\r\n    // or direct numeric data\r\n    // We use this later in the constructor, so saving it as a temporary variable to save bytes\r\n    const addPersistentDataFields = (dataFields: DataField[]) => {\r\n      addOneDSFields(_helperPersistentOneDSDataFields, dataFields, /*prependDataToken*/ false, EventType.SendTelemetryEvent);\r\n    };\r\n    this.addPersistentDataFields = addPersistentDataFields;\r\n\r\n    this.setOptionalEventsEnabled = (enabled: boolean) => {\r\n      _optionalEventsEnabled = enabled;\r\n    };\r\n\r\n    this.setFullEventsEnabled = this.setOptionalEventsEnabled;\r\n    // #endregion\r\n\r\n    // #region Actual constructor stuff\r\n    if (oneDSHelperProperties.enableOptionalEvents) {\r\n      _optionalEventsEnabled = true;\r\n    }\r\n    addPersistentDataFields(persistentDataFields);\r\n    const coreFields = oneDSHelperProperties.coreFields;\r\n    if (coreFields) {\r\n      addPersistentDataFields(App.getFields(coreFields.app));\r\n      addPersistentDataFields(User.getFields(coreFields.user));\r\n      addPersistentDataFields(Session.getFields(coreFields.session));\r\n      const release = coreFields.release;\r\n      if (release) {\r\n        addPersistentDataFields(Release.getFields(release));\r\n      }\r\n    }\r\n    this.addPreprocessor(_diagnosticLevelChecker);\r\n    // #endregion\r\n  }\r\n\r\n  /**\r\n   * @deprecated - use begin() instead\r\n   * Initialize and validate the 1DS Helper/Sink\r\n   * Returns whether the sink is valid\r\n   */\r\n  init: () => boolean;\r\n\r\n  /**\r\n   * Validate and initialize the 1DS Helper/Sink\r\n   * Returns whether the sink is valid\r\n   */\r\n  begin: () => boolean;\r\n\r\n  /**\r\n   * Get an IExtendedTelemetryItem for a telemetry event, for sending via an external instance of the 1DS SDK\r\n   * @param telemetryEvent - The telemetry event to be sent\r\n   */\r\n  getOneDSTelemetryEvent: (telemetryEvent: TelemetryEvent) => IExtendedTelemetryItem | undefined;\r\n\r\n  /**\r\n   * Get an IExtendedTelemetryItem for a customer content event, for sending via an external instance of the 1DS SDK\r\n   * @param customerContentEvent - The telemetry event to be sent\r\n   */\r\n  getOneDSCustomerContent: (customerContentEvent: CustomerContentEvent) => IExtendedTelemetryItem | undefined;\r\n\r\n  /**\r\n   * Add a preprocessor, which can process events before they get sent\r\n   * @param preprocessor - The preprocessor to add\r\n   */\r\n  addPreprocessor: (preprocessor: Preprocessor) => void;\r\n\r\n  /**\r\n   * Add data fields to be set on every event.\r\n   * @param dataFields - Data fields to be set on every event; will not be prepended with \"Data.\"\r\n   */\r\n  addPersistentDataFields: (dataFields: DataField[]) => void;\r\n\r\n  /**\r\n   * Enable sending optional events to Aria. On native clients, the user must explicitly allow optional events to be sent.\r\n   * @param enabled - Whether optional events are enabled\r\n   */\r\n  setOptionalEventsEnabled: (enabled: boolean) => void;\r\n\r\n  /**\r\n   * Deprecated: Enable sending optional events to Aria. Use setOptionalEventsEnabled instead.\r\n   * @param enabled - Whether optional events are enabled\r\n   */\r\n  setFullEventsEnabled: (enabled: boolean) => void;\r\n\r\n  /**\r\n   * Get all of the persistent data fields for the sink\r\n   */\r\n  getOneDSPersistentDataFields: () => { [name: string]: IEventProperty | string | boolean };\r\n\r\n  /**\r\n   * Get array of preprocessors that have been added to the sink\r\n   */\r\n  getPreprocessors: () => Preprocessor[];\r\n}\r\n", "/**\r\n * Real Time profile (default profile). RealTime Latency events are sent every 1 sec and\r\n * Normal Latency events are sent every 2 sec.\r\n */\r\nexport var RT_PROFILE = \"REAL_TIME\";\r\n/**\r\n * Near Real Time profile. RealTime Latency events are sent every 3 sec and\r\n * Normal Latency events are sent every 6 sec.\r\n */\r\nexport var NRT_PROFILE = \"NEAR_REAL_TIME\";\r\n/**\r\n * Best Effort. RealTime Latency events are sent every 9 sec and\r\n * Normal Latency events are sent every 18 sec.\r\n */\r\nexport var BE_PROFILE = \"BEST_EFFORT\";\r\n//# sourceMappingURL=DataModels.js.map", "// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Note: DON'T Export these const from the package as we are still targeting ES3 this will export a mutable variables that someone could change!!!\r\n// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n// Generally you should only put values that are used more than 2 times and then only if not already exposed as a constant (such as SdkCoreNames)\r\n// as when using \"short\" named values from here they will be will be minified smaller than the SdkCoreNames[eSdkCoreNames.xxxx] value.\r\nexport var STR_EMPTY = \"\";\r\nexport var STR_POST_METHOD = \"POST\";\r\nexport var STR_DISABLED_PROPERTY_NAME = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nexport var STR_DROPPED = \"drop\";\r\nexport var STR_SENDING = \"send\";\r\nexport var STR_REQUEUE = \"requeue\";\r\nexport var STR_RESPONSE_FAIL = \"rspFail\";\r\nexport var STR_OTHER = \"oth\";\r\nexport var DEFAULT_CACHE_CONTROL = \"no-cache, no-store\";\r\nexport var DEFAULT_CONTENT_TYPE = \"application/x-json-stream\";\r\nexport var STR_CACHE_CONTROL = \"cache-control\";\r\nexport var STR_CONTENT_TYPE_HEADER = \"content-type\";\r\nexport var STR_KILL_TOKENS_HEADER = \"kill-tokens\";\r\nexport var STR_KILL_DURATION_HEADER = \"kill-duration\";\r\nexport var STR_KILL_DURATION_SECONDS_HEADER = \"kill-duration-seconds\";\r\nexport var STR_TIME_DELTA_HEADER = \"time-delta-millis\";\r\nexport var STR_CLIENT_VERSION = \"client-version\";\r\nexport var STR_CLIENT_ID = \"client-id\";\r\nexport var STR_TIME_DELTA_TO_APPLY = \"time-delta-to-apply-millis\";\r\nexport var STR_UPLOAD_TIME = \"upload-time\";\r\nexport var STR_API_KEY = \"apikey\";\r\nexport var STR_MSA_DEVICE_TICKET = \"AuthMsaDeviceTicket\";\r\nexport var STR_AUTH_XTOKEN = \"AuthXToken\";\r\nexport var STR_SDK_VERSION = \"sdk-version\";\r\nexport var STR_NO_RESPONSE_BODY = \"NoResponseBody\";\r\nexport var STR_MSFPC = \"msfpc\";\r\nexport var STR_TRACE = \"trace\";\r\nexport var STR_USER = \"user\";\r\n//# sourceMappingURL=InternalConstants.js.map", "/**\r\n* EventBatch.ts\r\n* @author Nev Wylie (newylie)\r\n* @copyright Microsoft 2020\r\n*/\r\nimport { isNullOrUndefined, isValueAssigned } from \"@microsoft/1ds-core-js\";\r\nimport { STR_EMPTY, STR_MSFPC } from \"./InternalConstants\";\r\nfunction _getEventMsfpc(theEvent) {\r\n    var intWeb = ((theEvent.ext || {})[\"intweb\"]);\r\n    if (intWeb && isValueAssigned(intWeb[STR_MSFPC])) {\r\n        return intWeb[STR_MSFPC];\r\n    }\r\n    return null;\r\n}\r\nfunction _getMsfpc(theEvents) {\r\n    var msfpc = null;\r\n    for (var lp = 0; msfpc === null && lp < theEvents.length; lp++) {\r\n        msfpc = _getEventMsfpc(theEvents[lp]);\r\n    }\r\n    return msfpc;\r\n}\r\n/**\r\n* This class defines a \"batch\" events related to a specific iKey, it is used by the PostChannel and HttpManager\r\n* to collect and transfer ownership of events without duplicating them in-memory. This reduces the previous\r\n* array duplication and shared ownership issues that occurred due to race conditions caused by the async nature\r\n* of sending requests.\r\n*/\r\nvar EventBatch = /** @class */ (function () {\r\n    /**\r\n     * Private constructor so that caller is forced to use the static create method.\r\n     * @param iKey - The iKey to associate with the events (not validated)\r\n     * @param addEvents - The optional collection of events to assign to this batch - defaults to an empty array.\r\n     */\r\n    function EventBatch(iKey, addEvents) {\r\n        var events = addEvents ? [].concat(addEvents) : [];\r\n        var _self = this;\r\n        var _msfpc = _getMsfpc(events);\r\n        _self.iKey = function () {\r\n            return iKey;\r\n        };\r\n        _self.Msfpc = function () {\r\n            // return the cached value unless it's undefined -- used to avoid cpu\r\n            return _msfpc || STR_EMPTY;\r\n        };\r\n        _self.count = function () {\r\n            return events.length;\r\n        };\r\n        _self.events = function () {\r\n            return events;\r\n        };\r\n        _self.addEvent = function (theEvent) {\r\n            if (theEvent) {\r\n                events.push(theEvent);\r\n                if (!_msfpc) {\r\n                    // Not found so try and find one\r\n                    _msfpc = _getEventMsfpc(theEvent);\r\n                }\r\n                return true;\r\n            }\r\n            return false;\r\n        };\r\n        _self.split = function (fromEvent, numEvents) {\r\n            // Create a new batch with the same iKey\r\n            var theEvents;\r\n            if (fromEvent < events.length) {\r\n                var cnt = events.length - fromEvent;\r\n                if (!isNullOrUndefined(numEvents)) {\r\n                    cnt = numEvents < cnt ? numEvents : cnt;\r\n                }\r\n                theEvents = events.splice(fromEvent, cnt);\r\n                // reset the fetched msfpc value\r\n                _msfpc = _getMsfpc(events);\r\n            }\r\n            return new EventBatch(iKey, theEvents);\r\n        };\r\n    }\r\n    /**\r\n     * Creates a new Event Batch object\r\n     * @param iKey The iKey associated with this batch of events\r\n     */\r\n    EventBatch.create = function (iKey, theEvents) {\r\n        return new EventBatch(iKey, theEvents);\r\n    };\r\n    return EventBatch;\r\n}());\r\nexport { EventBatch };\r\n//# sourceMappingURL=EventBatch.js.map", "/**\r\n* ClockSkewManager.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\n/**\r\n* Class to manage clock skew correction.\r\n*/\r\nvar ClockSkewManager = /** @class */ (function () {\r\n    function ClockSkewManager() {\r\n        var _allowRequestSending = true;\r\n        var _shouldAddClockSkewHeaders = true;\r\n        var _isFirstRequest = true;\r\n        var _clockSkewHeaderValue = \"use-collector-delta\";\r\n        var _clockSkewSet = false;\r\n        dynamicProto(ClockSkewManager, this, function (_self) {\r\n            /**\r\n             * Determine if requests can be sent.\r\n             * @returns True if requests can be sent, false otherwise.\r\n             */\r\n            _self.allowRequestSending = function () {\r\n                return _allowRequestSending;\r\n            };\r\n            /**\r\n             * Tells the ClockSkewManager that it should assume that the first request has now been sent,\r\n             * If this method had not yet been called AND the clock Skew had not been set this will set\r\n             * allowRequestSending to false until setClockSet() is called.\r\n             */\r\n            _self.firstRequestSent = function () {\r\n                if (_isFirstRequest) {\r\n                    _isFirstRequest = false;\r\n                    if (!_clockSkewSet) {\r\n                        // Block sending until we get the first clock Skew\r\n                        _allowRequestSending = false;\r\n                    }\r\n                }\r\n            };\r\n            /**\r\n             * Determine if clock skew headers should be added to the request.\r\n             * @returns True if clock skew headers should be added, false otherwise.\r\n             */\r\n            _self.shouldAddClockSkewHeaders = function () {\r\n                return _shouldAddClockSkewHeaders;\r\n            };\r\n            /**\r\n             * Gets the clock skew header value.\r\n             * @returns The clock skew header value.\r\n             */\r\n            _self.getClockSkewHeaderValue = function () {\r\n                return _clockSkewHeaderValue;\r\n            };\r\n            /**\r\n             * Sets the clock skew header value. Once clock skew is set this method\r\n             * is no-op.\r\n             * @param timeDeltaInMillis - Time delta to be saved as the clock skew header value.\r\n             */\r\n            _self.setClockSkew = function (timeDeltaInMillis) {\r\n                if (!_clockSkewSet) {\r\n                    if (timeDeltaInMillis) {\r\n                        _clockSkewHeaderValue = timeDeltaInMillis;\r\n                        _shouldAddClockSkewHeaders = true;\r\n                        _clockSkewSet = true;\r\n                    }\r\n                    else {\r\n                        _shouldAddClockSkewHeaders = false;\r\n                    }\r\n                    // Unblock sending\r\n                    _allowRequestSending = true;\r\n                }\r\n            };\r\n        });\r\n    }\r\n    /**\r\n     * Determine if the request can be sent.\r\n     * @returns True if requests can be sent, false otherwise.\r\n     */\r\n    ClockSkewManager.prototype.allowRequestSending = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Tells the ClockSkewManager that it should assume that the first request has now been sent,\r\n     * If this method had not yet been called AND the clock Skew had not been set this will set\r\n     * allowRequestSending to false until setClockSet() is called.\r\n     */\r\n    ClockSkewManager.prototype.firstRequestSent = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Determine if clock skew headers should be added to the request.\r\n     * @returns True if clock skew headers should be added, false otherwise.\r\n     */\r\n    ClockSkewManager.prototype.shouldAddClockSkewHeaders = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Gets the clock skew header value.\r\n     * @returns The clock skew header value.\r\n     */\r\n    ClockSkewManager.prototype.getClockSkewHeaderValue = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Sets the clock skew header value. Once clock skew is set this method\r\n     * is no-op.\r\n     * @param timeDeltaInMillis - Time delta to be saved as the clock skew header value.\r\n     */\r\n    ClockSkewManager.prototype.setClockSkew = function (timeDeltaInMillis) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return ClockSkewManager;\r\n}());\r\nexport default ClockSkewManager;\r\n//# sourceMappingURL=ClockSkewManager.js.map", "/**\r\n* KillSwitch.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { arrForEach, dateNow, strTrim } from \"@microsoft/1ds-core-js\";\r\nvar SecToMsMultiplier = 1000;\r\n/**\r\n* Class to stop certain tenants sending events.\r\n*/\r\nvar KillSwitch = /** @class */ (function () {\r\n    function KillSwitch() {\r\n        var _killedTokenDictionary = {};\r\n        function _normalizeTenants(values) {\r\n            var result = [];\r\n            if (values) {\r\n                arrForEach(values, function (value) {\r\n                    result.push(strTrim(value));\r\n                });\r\n            }\r\n            return result;\r\n        }\r\n        dynamicProto(KillSwitch, this, function (_self) {\r\n            _self.setKillSwitchTenants = function (killTokens, killDuration) {\r\n                if (killTokens && killDuration) {\r\n                    try {\r\n                        var killedTokens = _normalizeTenants(killTokens.split(\",\"));\r\n                        if (killDuration === \"this-request-only\") {\r\n                            return killedTokens;\r\n                        }\r\n                        var durationMs = parseInt(killDuration, 10) * SecToMsMultiplier;\r\n                        for (var i = 0; i < killedTokens.length; ++i) {\r\n                            _killedTokenDictionary[killedTokens[i]] = dateNow() + durationMs;\r\n                        }\r\n                    }\r\n                    catch (ex) {\r\n                        return [];\r\n                    }\r\n                }\r\n                return [];\r\n            };\r\n            _self.isTenantKilled = function (tenantToken) {\r\n                var killDictionary = _killedTokenDictionary;\r\n                var name = strTrim(tenantToken);\r\n                if (killDictionary[name] !== undefined && killDictionary[name] > dateNow()) {\r\n                    return true;\r\n                }\r\n                delete killDictionary[name];\r\n                return false;\r\n            };\r\n        });\r\n    }\r\n    /**\r\n     * Set the tenants that are to be killed along with the duration. If the duration is\r\n     * a special value identifying that the tokens are too be killed for only this request, then\r\n     * a array of tokens is returned.\r\n     * @param killedTokens - Tokens that are too be marked to be killed.\r\n     * @param killDuration - The duration for which the tokens are to be killed.\r\n     * @returns The tokens that are killed only for this given request.\r\n     */\r\n    KillSwitch.prototype.setKillSwitchTenants = function (killTokens, killDuration) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return [];\r\n    };\r\n    /**\r\n     * Determing if the given tenant token has been killed for the moment.\r\n     * @param tenantToken - The token to be checked.\r\n     * @returns True if token has been killed, false otherwise.\r\n     */\r\n    KillSwitch.prototype.isTenantKilled = function (tenantToken) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    return KillSwitch;\r\n}());\r\nexport default KillSwitch;\r\n//# sourceMappingURL=KillSwitch.js.map", "/**\r\n* RetryPolicy.ts\r\n* @author Abhilash Panwar (abpanwar)\r\n* @copyright Microsoft 2018\r\n*/\r\nvar RandomizationLowerThreshold = 0.8;\r\nvar RandomizationUpperThreshold = 1.2;\r\nvar BaseBackoff = 3000;\r\nvar MaxBackoff = 600000;\r\n/**\r\n * Determine if the request should be retried for the given status code.\r\n * The below expression reads that we should only retry for:\r\n *      - HttpStatusCodes that are smaller than 300.\r\n *      - HttpStatusCodes greater or equal to 500 (except for 501-NotImplement\r\n *        and 505-HttpVersionNotSupport).\r\n *      - HttpStatusCode 408-RequestTimeout.\r\n *      - HttpStatusCode 429.\r\n * This is based on Microsoft.WindowsAzure.Storage.RetryPolicies.ExponentialRetry class\r\n * @param httpStatusCode - The status code returned for the request.\r\n * @returns True if request should be retried, false otherwise.\r\n */\r\nexport function retryPolicyShouldRetryForStatus(httpStatusCode) {\r\n    /* tslint:disable:triple-equals */\r\n    // Disabling triple-equals rule to avoid httpOverrides from failing because they are returning a string value\r\n    return !((httpStatusCode >= 300 && httpStatusCode < 500 && httpStatusCode != 408 && httpStatusCode != 429)\r\n        || (httpStatusCode == 501)\r\n        || (httpStatusCode == 505));\r\n    /* tslint:enable:triple-equals */\r\n}\r\n/**\r\n * Gets the number of milliseconds to back off before retrying the request. The\r\n * back off duration is exponentially scaled based on the number of retries already\r\n * done for the request.\r\n * @param retriesSoFar - The number of times the request has already been retried.\r\n * @returns The back off duration for the request before it can be retried.\r\n */\r\nexport function retryPolicyGetMillisToBackoffForRetry(retriesSoFar) {\r\n    var waitDuration = 0;\r\n    var minBackoff = BaseBackoff * RandomizationLowerThreshold;\r\n    var maxBackoff = BaseBackoff * RandomizationUpperThreshold;\r\n    var randomBackoff = Math.floor(Math.random() * (maxBackoff - minBackoff)) + minBackoff;\r\n    waitDuration = Math.pow(2, retriesSoFar) * randomBackoff;\r\n    return Math.min(waitDuration, MaxBackoff);\r\n}\r\n//# sourceMappingURL=RetryPolicy.js.map", "/**\r\n* Serializer.ts\r\n* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)\r\n* @copyright Microsoft 2018-2020\r\n*/\r\n// @skip-file-minify\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { arrIndexOf, doPerf, getCommonSchemaMetaData, getTenantId, isArray, isValueAssigned, objForEachKey, sanitizeProperty, strStartsWith } from \"@microsoft/1ds-core-js\";\r\nimport { EventBatch } from \"./EventBatch\";\r\nimport { STR_EMPTY } from \"./InternalConstants\";\r\n/**\r\n * Note: This is an optimization for V8-based browsers. When V8 concatenates a string,\r\n * the strings are only joined logically using a \"cons string\" or \"constructed/concatenated\r\n * string\". These containers keep references to one another and can result in very large\r\n * memory usage. For example, if a 2MB string is constructed by concatenating 4 bytes\r\n * together at a time, the memory usage will be ~44MB; so ~22x increase. The strings are\r\n * only joined together when an operation requiring their joining takes place, such as\r\n * substr(). This function is called when adding data to this buffer to ensure these\r\n * types of strings are periodically joined to reduce the memory footprint.\r\n * Setting to every 20 events as the JSON.stringify() may have joined many strings\r\n * and calling this too much causes a minor delay while processing.\r\n */\r\nvar _MAX_STRING_JOINS = 20;\r\nvar RequestSizeLimitBytes = 3984588; // approx 3.8 Mb\r\nvar BeaconRequestSizeLimitBytes = 65000; // approx 64kb (the current Edge, Firefox and Chrome max limit)\r\nvar MaxRecordSize = 2000000; // approx 2 Mb\r\nvar MaxBeaconRecordSize = Math.min(MaxRecordSize, BeaconRequestSizeLimitBytes);\r\nvar metadata = \"metadata\";\r\nvar f = \"f\";\r\nvar rCheckDot = /\\./;\r\n/**\r\n* Class to handle serialization of event and request.\r\n* Currently uses Bond for serialization. Please note that this may be subject to change.\r\n*/\r\nvar Serializer = /** @class */ (function () {\r\n    function Serializer(perfManager, valueSanitizer, stringifyObjects, enableCompoundKey) {\r\n        var strData = \"data\";\r\n        var strBaseData = \"baseData\";\r\n        var strExt = \"ext\";\r\n        var _checkForCompoundkey = !!enableCompoundKey;\r\n        var _processSubMetaData = true;\r\n        var _theSanitizer = valueSanitizer;\r\n        var _isReservedCache = {};\r\n        dynamicProto(Serializer, this, function (_self) {\r\n            _self.createPayload = function (retryCnt, isTeardown, isSync, isReducedPayload, sendReason, sendType) {\r\n                return {\r\n                    apiKeys: [],\r\n                    payloadBlob: STR_EMPTY,\r\n                    overflow: null,\r\n                    sizeExceed: [],\r\n                    failedEvts: [],\r\n                    batches: [],\r\n                    numEvents: 0,\r\n                    retryCnt: retryCnt,\r\n                    isTeardown: isTeardown,\r\n                    isSync: isSync,\r\n                    isBeacon: isReducedPayload,\r\n                    sendType: sendType,\r\n                    sendReason: sendReason\r\n                };\r\n            };\r\n            _self.appendPayload = function (payload, theBatch, maxEventsPerBatch) {\r\n                var canAddEvents = payload && theBatch && !payload.overflow;\r\n                if (canAddEvents) {\r\n                    doPerf(perfManager, function () { return \"Serializer:appendPayload\"; }, function () {\r\n                        var theEvents = theBatch.events();\r\n                        var payloadBlob = payload.payloadBlob;\r\n                        var payloadEvents = payload.numEvents;\r\n                        var eventsAdded = false;\r\n                        var sizeExceeded = [];\r\n                        var failedEvts = [];\r\n                        var isBeaconPayload = payload.isBeacon;\r\n                        var requestMaxSize = isBeaconPayload ? BeaconRequestSizeLimitBytes : RequestSizeLimitBytes;\r\n                        var recordMaxSize = isBeaconPayload ? MaxBeaconRecordSize : MaxRecordSize;\r\n                        var lp = 0;\r\n                        var joinCount = 0;\r\n                        while (lp < theEvents.length) {\r\n                            var theEvent = theEvents[lp];\r\n                            if (theEvent) {\r\n                                if (payloadEvents >= maxEventsPerBatch) {\r\n                                    // Maximum events per payload reached, so don't add any more\r\n                                    payload.overflow = theBatch.split(lp);\r\n                                    break;\r\n                                }\r\n                                var eventBlob = _self.getEventBlob(theEvent);\r\n                                if (eventBlob && eventBlob.length <= recordMaxSize) {\r\n                                    // This event will fit into the payload\r\n                                    var blobLength = eventBlob.length;\r\n                                    var currentSize = payloadBlob.length;\r\n                                    if (currentSize + blobLength > requestMaxSize) {\r\n                                        // Request or batch size exceeded, so don't add any more to the payload\r\n                                        payload.overflow = theBatch.split(lp);\r\n                                        break;\r\n                                    }\r\n                                    if (payloadBlob) {\r\n                                        payloadBlob += \"\\n\";\r\n                                    }\r\n                                    payloadBlob += eventBlob;\r\n                                    joinCount++;\r\n                                    // v8 memory optimization only\r\n                                    if (joinCount > _MAX_STRING_JOINS) {\r\n                                        // this substr() should cause the constructed string to join\r\n                                        payloadBlob.substr(0, 1);\r\n                                        joinCount = 0;\r\n                                    }\r\n                                    eventsAdded = true;\r\n                                    payloadEvents++;\r\n                                }\r\n                                else {\r\n                                    if (eventBlob) {\r\n                                        // Single event size exceeded so remove from the batch\r\n                                        sizeExceeded.push(theEvent);\r\n                                    }\r\n                                    else {\r\n                                        failedEvts.push(theEvent);\r\n                                    }\r\n                                    // We also need to remove this event from the existing array, otherwise a notification will be sent\r\n                                    // indicating that it was successfully sent\r\n                                    theEvents.splice(lp, 1);\r\n                                    lp--;\r\n                                }\r\n                            }\r\n                            lp++;\r\n                        }\r\n                        if (sizeExceeded && sizeExceeded.length > 0) {\r\n                            payload.sizeExceed.push(EventBatch.create(theBatch.iKey(), sizeExceeded));\r\n                            // Remove the exceeded events from the batch\r\n                        }\r\n                        if (failedEvts && failedEvts.length > 0) {\r\n                            payload.failedEvts.push(EventBatch.create(theBatch.iKey(), failedEvts));\r\n                            // Remove the failed events from the batch\r\n                        }\r\n                        if (eventsAdded) {\r\n                            payload.batches.push(theBatch);\r\n                            payload.payloadBlob = payloadBlob;\r\n                            payload.numEvents = payloadEvents;\r\n                            var apiKey = theBatch.iKey();\r\n                            if (arrIndexOf(payload.apiKeys, apiKey) === -1) {\r\n                                payload.apiKeys.push(apiKey);\r\n                            }\r\n                        }\r\n                    }, function () { return ({ payload: payload, theBatch: { iKey: theBatch.iKey(), evts: theBatch.events() }, max: maxEventsPerBatch }); });\r\n                }\r\n                return canAddEvents;\r\n            };\r\n            _self.getEventBlob = function (eventData) {\r\n                try {\r\n                    return doPerf(perfManager, function () { return \"Serializer.getEventBlob\"; }, function () {\r\n                        var serializedEvent = {};\r\n                        // Adding as dynamic keys for v8 performance\r\n                        serializedEvent.name = eventData.name;\r\n                        serializedEvent.time = eventData.time;\r\n                        serializedEvent.ver = eventData.ver;\r\n                        serializedEvent.iKey = \"o:\" + getTenantId(eventData.iKey);\r\n                        // Assigning local var so usage in part b/c don't throw if there is no ext\r\n                        var serializedExt = {};\r\n                        // Part A\r\n                        var eventExt = eventData[strExt];\r\n                        if (eventExt) {\r\n                            // Only assign ext if the event had one (There are tests covering this use case)\r\n                            serializedEvent[strExt] = serializedExt;\r\n                            objForEachKey(eventExt, function (key, value) {\r\n                                var data = serializedExt[key] = {};\r\n                                // Don't include a metadata callback as we don't currently set metadata Part A fields\r\n                                _processPathKeys(value, data, \"ext.\" + key, true, null, null, true);\r\n                            });\r\n                        }\r\n                        var serializedData = serializedEvent[strData] = {};\r\n                        serializedData.baseType = eventData.baseType;\r\n                        var serializedBaseData = serializedData[strBaseData] = {};\r\n                        // Part B\r\n                        _processPathKeys(eventData.baseData, serializedBaseData, strBaseData, false, [strBaseData], function (pathKeys, name, value) {\r\n                            _addJSONPropertyMetaData(serializedExt, pathKeys, name, value);\r\n                        }, _processSubMetaData);\r\n                        // Part C\r\n                        _processPathKeys(eventData.data, serializedData, strData, false, [], function (pathKeys, name, value) {\r\n                            _addJSONPropertyMetaData(serializedExt, pathKeys, name, value);\r\n                        }, _processSubMetaData);\r\n                        return JSON.stringify(serializedEvent);\r\n                    }, function () { return ({ item: eventData }); });\r\n                }\r\n                catch (e) {\r\n                    return null;\r\n                }\r\n            };\r\n            function _isReservedField(path, name) {\r\n                var result = _isReservedCache[path];\r\n                if (result === undefined) {\r\n                    if (path.length >= 7) {\r\n                        // Do not allow the changing of fields located in the ext.metadata or ext.web extension\r\n                        result = strStartsWith(path, \"ext.metadata\") || strStartsWith(path, \"ext.web\");\r\n                    }\r\n                    _isReservedCache[path] = result;\r\n                }\r\n                return result;\r\n            }\r\n            function _processPathKeys(srcObj, target, thePath, checkReserved, metadataPathKeys, metadataCallback, processSubKeys) {\r\n                objForEachKey(srcObj, function (key, srcValue) {\r\n                    var prop = null;\r\n                    if (srcValue || isValueAssigned(srcValue)) {\r\n                        var path = thePath;\r\n                        var name_1 = key;\r\n                        var theMetaPathKeys = metadataPathKeys;\r\n                        var destObj = target;\r\n                        // Handle keys with embedded '.', like \"TestObject.testProperty\"\r\n                        if (_checkForCompoundkey && !checkReserved && rCheckDot.test(key)) {\r\n                            var subKeys = key.split(\".\");\r\n                            var keyLen = subKeys.length;\r\n                            if (keyLen > 1) {\r\n                                if (theMetaPathKeys) {\r\n                                    // Create a copy of the meta path keys so we can add the extra ones\r\n                                    theMetaPathKeys = theMetaPathKeys.slice();\r\n                                }\r\n                                for (var lp = 0; lp < keyLen - 1; lp++) {\r\n                                    var subKey = subKeys[lp];\r\n                                    // Add/reuse the sub key object\r\n                                    destObj = destObj[subKey] = destObj[subKey] || {};\r\n                                    path += \".\" + subKey;\r\n                                    if (theMetaPathKeys) {\r\n                                        theMetaPathKeys.push(subKey);\r\n                                    }\r\n                                }\r\n                                name_1 = subKeys[keyLen - 1];\r\n                            }\r\n                        }\r\n                        var isReserved = checkReserved && _isReservedField(path, name_1);\r\n                        if (!isReserved && _theSanitizer && _theSanitizer.handleField(path, name_1)) {\r\n                            prop = _theSanitizer.value(path, name_1, srcValue, stringifyObjects);\r\n                        }\r\n                        else {\r\n                            prop = sanitizeProperty(name_1, srcValue, stringifyObjects);\r\n                        }\r\n                        if (prop) {\r\n                            // Set the value\r\n                            var newValue = prop.value;\r\n                            destObj[name_1] = newValue;\r\n                            if (metadataCallback) {\r\n                                metadataCallback(theMetaPathKeys, name_1, prop);\r\n                            }\r\n                            if (processSubKeys && typeof newValue === \"object\" && !isArray(newValue)) {\r\n                                var newPath = theMetaPathKeys;\r\n                                if (newPath) {\r\n                                    newPath = newPath.slice();\r\n                                    newPath.push(name_1);\r\n                                }\r\n                                // Make sure we process sub objects as well (for value sanitization and metadata)\r\n                                _processPathKeys(srcValue, newValue, path + \".\" + name_1, checkReserved, newPath, metadataCallback, processSubKeys);\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Create a serializer payload package\r\n     * @param retryCnt The retry count for the events in this payload\r\n     * @param isTeardown Is this payload being created as part of a teardown request\r\n     * @param isSync Should this payload be sent as a synchronous request\r\n     * @param isReducedPayload Is this payload going to be sent via sendBeacon() API\r\n     * @param sendReason The reason the payload is being sent\r\n     * @param sendType Identifies how this payload will be sent\r\n     */\r\n    Serializer.prototype.createPayload = function (retryCnt, isTeardown, isSync, isReducedPayload, sendReason, sendType) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Append the batched events into the payload\r\n     * @param payload The serialized payload detail object\r\n     * @param theBatch The batched events to append to the payload\r\n     * @param maxEventsPerBatch The maximum number of events to allow in the payload\r\n     * @returns True if the events from the new batch where attempted to be added to the payload otherwise false\r\n     */\r\n    Serializer.prototype.appendPayload = function (payload, theBatch, maxEventsPerBatch) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Bond serialize the event.\r\n     * @param eventData - The event that needs to be serialized.\r\n     * @returns The serialized json event.\r\n     */\r\n    Serializer.prototype.getEventBlob = function (eventData) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    /**\r\n     * Does this field value sanitizer handle this path / field combination\r\n     * @param path - The field path\r\n     * @param name - The name of the field\r\n     */\r\n    Serializer.prototype.handleField = function (path, name) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Get the field sanitizer for this type of field based on the field type, value kind and/or event property type\r\n     * @param path - The field path\r\n     * @param name - The name of the field\r\n     * @param theType - The type of field\r\n     * @param theKind - The value kind of the field\r\n     * @param propType - The property type of the field\r\n     */\r\n    Serializer.prototype.getSanitizer = function (path, name, theType, theKind, propType) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return null;\r\n    };\r\n    return Serializer;\r\n}());\r\nexport { Serializer };\r\n/**\r\n * @ignore\r\n */\r\nfunction _addJSONPropertyMetaData(json, propKeys, name, propertyValue) {\r\n    if (propertyValue && json) {\r\n        var encodedTypeValue = getCommonSchemaMetaData(propertyValue.value, propertyValue.kind, propertyValue.propertyType);\r\n        if (encodedTypeValue > -1) {\r\n            // Add the root metadata\r\n            var metaData = json[metadata];\r\n            if (!metaData) {\r\n                // Sets the root 'f'\r\n                metaData = json[metadata] = { f: {} };\r\n            }\r\n            var metaTarget = metaData[f];\r\n            if (!metaTarget) {\r\n                // This can occur if someone has manually added an ext.metadata object\r\n                // Such as ext.metadata.privLevel and ext.metadata.privTags\r\n                metaTarget = metaData[f] = {};\r\n            }\r\n            // Traverse the metadata path and build each object (contains an 'f' key) -- if required\r\n            if (propKeys) {\r\n                for (var lp = 0; lp < propKeys.length; lp++) {\r\n                    var key = propKeys[lp];\r\n                    if (!metaTarget[key]) {\r\n                        metaTarget[key] = { f: {} };\r\n                    }\r\n                    var newTarget = metaTarget[key][f];\r\n                    if (!newTarget) {\r\n                        // Not expected, but can occur if the metadata context was pre-created as part of the event\r\n                        newTarget = metaTarget[key][f] = {};\r\n                    }\r\n                    metaTarget = newTarget;\r\n                }\r\n            }\r\n            metaTarget = metaTarget[name] = {};\r\n            if (isArray(propertyValue.value)) {\r\n                metaTarget[\"a\"] = {\r\n                    t: encodedTypeValue\r\n                };\r\n            }\r\n            else {\r\n                metaTarget[\"t\"] = encodedTypeValue;\r\n            }\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=Serializer.js.map", "var _a;\r\n/**\r\n* HttpManager.ts\r\n* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)\r\n* @copyright Microsoft 2018-2020\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport EVTClockSkewManager from \"./ClockSkewManager\";\r\nimport EVTKillSwitch from \"./KillSwitch\";\r\nimport { FullVersionString, _throwInternal, _warnToConsole, arrForEach, dateNow, doPerf, dumpObj, extend, getLocation, getNavigator, getTime, hasOwnProperty, isArray, isBeaconsSupported, isFetchSupported, isNullOrUndefined, isNumber, isReactNative, isString, isUndefined, isValueAssigned, isXhrSupported, objForEachKey, objKeys, openXhr, strTrim, strUndefined, useXDomainRequest } from \"@microsoft/1ds-core-js\";\r\nimport { DEFAULT_CACHE_CONTROL, DEFAULT_CONTENT_TYPE, STR_API_KEY, STR_AUTH_XTOKEN, STR_CACHE_CONTROL, STR_CLIENT_ID, STR_CLIENT_VERSION, STR_CONTENT_TYPE_HEADER, STR_DISABLED_PROPERTY_NAME, STR_DROPPED, STR_EMPTY, STR_KILL_DURATION_HEADER, STR_KILL_DURATION_SECONDS_HEADER, STR_KILL_TOKENS_HEADER, STR_MSA_DEVICE_TICKET, STR_MSFPC, STR_NO_RESPONSE_BODY, STR_OTHER, STR_POST_METHOD, STR_REQUEUE, STR_RESPONSE_FAIL, STR_SENDING, STR_TIME_DELTA_HEADER, STR_TIME_DELTA_TO_APPLY, STR_UPLOAD_TIME } from \"./InternalConstants\";\r\nimport { retryPolicyGetMillisToBackoffForRetry, retryPolicyShouldRetryForStatus } from \"./RetryPolicy\";\r\nimport { Serializer } from \"./Serializer\";\r\nvar strSendAttempt = \"sendAttempt\";\r\nvar _noResponseQs = \"&\" + STR_NO_RESPONSE_BODY + \"=true\";\r\n/**\r\n * Identifies the default notification reason to the action names\r\n */\r\nvar _eventActionMap = (_a = {},\r\n    _a[1 /* EventBatchNotificationReason.Paused */] = STR_REQUEUE,\r\n    _a[100 /* EventBatchNotificationReason.RequeueEvents */] = STR_REQUEUE,\r\n    _a[200 /* EventBatchNotificationReason.Complete */] = \"sent\",\r\n    _a[8004 /* EventBatchNotificationReason.KillSwitch */] = STR_DROPPED,\r\n    _a[8003 /* EventBatchNotificationReason.SizeLimitExceeded */] = STR_DROPPED,\r\n    _a);\r\nvar _collectorQsHeaders = {};\r\nvar _collectorHeaderToQs = {};\r\nfunction _addCollectorHeaderQsMapping(qsName, headerName, allowQs) {\r\n    _collectorQsHeaders[qsName] = headerName;\r\n    if (allowQs !== false) {\r\n        _collectorHeaderToQs[headerName] = qsName;\r\n    }\r\n}\r\n_addCollectorHeaderQsMapping(STR_MSA_DEVICE_TICKET, STR_MSA_DEVICE_TICKET, false);\r\n_addCollectorHeaderQsMapping(STR_CLIENT_VERSION, STR_CLIENT_VERSION);\r\n_addCollectorHeaderQsMapping(STR_CLIENT_ID, \"Client-Id\");\r\n_addCollectorHeaderQsMapping(STR_API_KEY, STR_API_KEY);\r\n_addCollectorHeaderQsMapping(STR_TIME_DELTA_TO_APPLY, STR_TIME_DELTA_TO_APPLY);\r\n_addCollectorHeaderQsMapping(STR_UPLOAD_TIME, STR_UPLOAD_TIME);\r\n_addCollectorHeaderQsMapping(STR_AUTH_XTOKEN, STR_AUTH_XTOKEN);\r\nfunction _getResponseText(xhr) {\r\n    try {\r\n        return xhr.responseText;\r\n    }\r\n    catch (e) {\r\n        // Best effort, as XHR may throw while XDR wont so just ignore\r\n    }\r\n    return STR_EMPTY;\r\n}\r\nfunction _hasHeader(headers, header) {\r\n    var hasHeader = false;\r\n    if (headers && header) {\r\n        var keys = objKeys(headers);\r\n        if (keys && keys.length > 0) {\r\n            var lowerHeader = header.toLowerCase();\r\n            for (var lp = 0; lp < keys.length; lp++) {\r\n                var value = keys[lp];\r\n                if (value && hasOwnProperty(header, value) &&\r\n                    value.toLowerCase() === lowerHeader) {\r\n                    hasHeader = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return hasHeader;\r\n}\r\nfunction _addRequestDetails(details, name, value, useHeaders) {\r\n    if (name && value && value.length > 0) {\r\n        if (useHeaders && _collectorQsHeaders[name]) {\r\n            details.hdrs[_collectorQsHeaders[name]] = value;\r\n            details.useHdrs = true;\r\n        }\r\n        else {\r\n            details.url += \"&\" + name + \"=\" + value;\r\n        }\r\n    }\r\n}\r\nfunction _prependTransports(theTransports, newTransports) {\r\n    if (newTransports) {\r\n        if (isNumber(newTransports)) {\r\n            theTransports = [newTransports].concat(theTransports);\r\n        }\r\n        else if (isArray(newTransports)) {\r\n            theTransports = newTransports.concat(theTransports);\r\n        }\r\n    }\r\n    return theTransports;\r\n}\r\n/**\r\n * Class managing the sending of requests.\r\n */\r\nvar HttpManager = /** @class */ (function () {\r\n    /**\r\n     * @constructor\r\n     * @param requestQueue   - The queue that contains the requests to be sent.\r\n     */\r\n    function HttpManager(maxEventsPerBatch, maxConnections, maxRequestRetriesBeforeBackoff, actions, timeoutOverride) {\r\n        this._responseHandlers = [];\r\n        var _urlString = \"?cors=true&\" + STR_CONTENT_TYPE_HEADER.toLowerCase() + \"=\" + DEFAULT_CONTENT_TYPE;\r\n        var _killSwitch = new EVTKillSwitch();\r\n        var _paused = false;\r\n        var _clockSkewManager = new EVTClockSkewManager();\r\n        var _useBeacons = false;\r\n        var _outstandingRequests = 0; // Holds the number of outstanding async requests that have not returned a response yet\r\n        var _postManager;\r\n        var _logger;\r\n        var _sendInterfaces;\r\n        var _core;\r\n        var _customHttpInterface = true;\r\n        var _queryStringParameters = [];\r\n        var _headers = {};\r\n        var _batchQueue = [];\r\n        var _serializer = null;\r\n        var _enableEventTimings = false;\r\n        var _cookieMgr;\r\n        var _isUnloading = false;\r\n        var _useHeaders = false;\r\n        var _xhrTimeout;\r\n        var _disableXhrSync;\r\n        var _disableFetchKeepAlive;\r\n        var _canHaveReducedPayload;\r\n        var _addNoResponse;\r\n        dynamicProto(HttpManager, this, function (_self) {\r\n            var _sendCredentials = true;\r\n            _self.initialize = function (endpointUrl, core, postChannel, httpInterface, channelConfig) {\r\n                var _a;\r\n                if (!channelConfig) {\r\n                    channelConfig = {};\r\n                }\r\n                _urlString = endpointUrl + _urlString;\r\n                _useHeaders = !isUndefined(channelConfig.avoidOptions) ? !channelConfig.avoidOptions : true;\r\n                _core = core;\r\n                _cookieMgr = core.getCookieMgr();\r\n                _enableEventTimings = !_core.config.disableEventTimings;\r\n                var enableCompoundKey = !!_core.config.enableCompoundKey;\r\n                _postManager = postChannel;\r\n                _logger = _postManager.diagLog();\r\n                var valueSanitizer = channelConfig.valueSanitizer;\r\n                var stringifyObjects = channelConfig.stringifyObjects;\r\n                if (!isUndefined(channelConfig.enableCompoundKey)) {\r\n                    enableCompoundKey = !!channelConfig.enableCompoundKey;\r\n                }\r\n                _xhrTimeout = channelConfig.xhrTimeout;\r\n                _disableXhrSync = !!channelConfig.disableXhrSync;\r\n                _disableFetchKeepAlive = !!channelConfig.disableFetchKeepAlive;\r\n                _addNoResponse = channelConfig.addNoResponse !== false;\r\n                _useBeacons = !isReactNative(); // Only use beacons if not running in React Native\r\n                _serializer = new Serializer(_core, valueSanitizer, stringifyObjects, enableCompoundKey);\r\n                if (!isNullOrUndefined(channelConfig.useSendBeacon)) {\r\n                    _useBeacons = !!channelConfig.useSendBeacon;\r\n                }\r\n                var syncHttpInterface = httpInterface;\r\n                var beaconHttpInterface = channelConfig.alwaysUseXhrOverride ? httpInterface : null;\r\n                var fetchSyncHttpInterface = channelConfig.alwaysUseXhrOverride ? httpInterface : null;\r\n                var beaconUnloadTransports = [3 /* TransportType.Beacon */, 2 /* TransportType.Fetch */];\r\n                if (!httpInterface) {\r\n                    _customHttpInterface = false;\r\n                    var location_1 = getLocation();\r\n                    if (location_1 && location_1.protocol && location_1.protocol.toLowerCase() === \"file:\") {\r\n                        // Special case where a local html file fails with a CORS error on Chromium browsers\r\n                        _sendCredentials = false;\r\n                    }\r\n                    var theTransports = [];\r\n                    if (isReactNative()) {\r\n                        // Use Fetch or XDR/XHR\r\n                        theTransports = [2 /* TransportType.Fetch */, 1 /* TransportType.Xhr */];\r\n                        beaconUnloadTransports = [2 /* TransportType.Fetch */, 1 /* TransportType.Xhr */, 3 /* TransportType.Beacon */];\r\n                    }\r\n                    else {\r\n                        // Use XDR/XHR, Fetch or beacons\r\n                        theTransports = [1 /* TransportType.Xhr */, 2 /* TransportType.Fetch */, 3 /* TransportType.Beacon */];\r\n                    }\r\n                    // Prefix any user requested transport(s) values\r\n                    theTransports = _prependTransports(theTransports, channelConfig.transports);\r\n                    httpInterface = _getSenderInterface(theTransports, false);\r\n                    if (!httpInterface) {\r\n                        _warnToConsole(_logger, \"No available transport to send events\");\r\n                    }\r\n                    syncHttpInterface = _getSenderInterface(theTransports, true);\r\n                }\r\n                if (!beaconHttpInterface) {\r\n                    // Allow overriding the usage of sendBeacon\r\n                    beaconUnloadTransports = _prependTransports(beaconUnloadTransports, channelConfig.unloadTransports);\r\n                    beaconHttpInterface = _getSenderInterface(beaconUnloadTransports, true);\r\n                }\r\n                _canHaveReducedPayload = !_customHttpInterface && ((_useBeacons && isBeaconsSupported()) || (!_disableFetchKeepAlive && isFetchSupported(true)));\r\n                _sendInterfaces = (_a = {},\r\n                    _a[0 /* EventSendType.Batched */] = httpInterface,\r\n                    _a[1 /* EventSendType.Synchronous */] = syncHttpInterface || _getSenderInterface([1 /* TransportType.Xhr */, 2 /* TransportType.Fetch */, 3 /* TransportType.Beacon */], true),\r\n                    _a[2 /* EventSendType.SendBeacon */] = beaconHttpInterface || syncHttpInterface || _getSenderInterface([1 /* TransportType.Xhr */], true),\r\n                    _a[3 /* EventSendType.SyncFetch */] = fetchSyncHttpInterface || _getSenderInterface([2 /* TransportType.Fetch */, 3 /* TransportType.Beacon */], true) || syncHttpInterface || _getSenderInterface([1 /* TransportType.Xhr */], true),\r\n                    _a);\r\n            };\r\n            // Special internal method to allow the DebugPlugin to hook embedded objects\r\n            function _getSenderInterface(transports, syncSupport) {\r\n                var transportType = 0 /* TransportType.NotSet */;\r\n                var sendPostFunc = null;\r\n                var lp = 0;\r\n                while (sendPostFunc == null && lp < transports.length) {\r\n                    transportType = transports[lp];\r\n                    if (transportType === 1 /* TransportType.Xhr */) {\r\n                        if (useXDomainRequest()) {\r\n                            sendPostFunc = _xdrSendPost;\r\n                        }\r\n                        else if (isXhrSupported()) {\r\n                            sendPostFunc = _xhrSendPost;\r\n                        }\r\n                    }\r\n                    else if (transportType === 2 /* TransportType.Fetch */ && isFetchSupported(syncSupport) && (!syncSupport || (syncSupport && !_disableFetchKeepAlive))) {\r\n                        sendPostFunc = _fetchSendPost;\r\n                    }\r\n                    else if (_useBeacons && transportType === 3 /* TransportType.Beacon */ && isBeaconsSupported()) {\r\n                        sendPostFunc = _beaconSendPost;\r\n                    }\r\n                    lp++;\r\n                }\r\n                if (sendPostFunc) {\r\n                    return {\r\n                        _transport: transportType,\r\n                        _isSync: syncSupport,\r\n                        sendPOST: sendPostFunc\r\n                    };\r\n                }\r\n                return null;\r\n            }\r\n            _self[\"_getDbgPlgTargets\"] = function () {\r\n                return [_sendInterfaces[0 /* EventSendType.Batched */], _killSwitch, _serializer, _sendInterfaces];\r\n            };\r\n            function _xdrSendPost(payload, oncomplete, sync) {\r\n                // It doesn't support custom headers, so no action is taken with current requestHeaders\r\n                var xdr = new XDomainRequest();\r\n                xdr.open(STR_POST_METHOD, payload.urlString);\r\n                if (payload.timeout) {\r\n                    xdr.timeout = payload.timeout;\r\n                }\r\n                // can't get the status code in xdr.\r\n                xdr.onload = function () {\r\n                    // we will assume onload means the request succeeded.\r\n                    var response = _getResponseText(xdr);\r\n                    _doOnComplete(oncomplete, 200, {}, response);\r\n                    _handleCollectorResponse(response);\r\n                };\r\n                // we will assume onerror means we need to drop the events.\r\n                xdr.onerror = function () {\r\n                    _doOnComplete(oncomplete, 400, {});\r\n                };\r\n                // we will assume ontimeout means we need to retry the events.\r\n                xdr.ontimeout = function () {\r\n                    _doOnComplete(oncomplete, 500, {});\r\n                };\r\n                // https://cypressnorth.com/web-programming-and-development/internet-explorer-aborting-ajax-requests-fixed/\r\n                // tslint:disable-next-line:no-empty\r\n                xdr.onprogress = function () { };\r\n                if (sync) {\r\n                    xdr.send(payload.data);\r\n                }\r\n                else {\r\n                    timeoutOverride.set(function () {\r\n                        xdr.send(payload.data);\r\n                    }, 0);\r\n                }\r\n            }\r\n            function _fetchSendPost(payload, oncomplete, sync) {\r\n                var _a;\r\n                var theUrl = payload.urlString;\r\n                var ignoreResponse = false;\r\n                var responseHandled = false;\r\n                var requestInit = (_a = {\r\n                        body: payload.data,\r\n                        method: STR_POST_METHOD\r\n                    },\r\n                    _a[STR_DISABLED_PROPERTY_NAME] = true,\r\n                    _a);\r\n                if (sync) {\r\n                    requestInit.keepalive = true;\r\n                    if (payload._sendReason === 2 /* SendRequestReason.Unload */) {\r\n                        // As a sync request (during unload), it is unlikely that we will get a chance to process the response so\r\n                        // just like beacon send assume that the events have been accepted and processed\r\n                        ignoreResponse = true;\r\n                        if (_addNoResponse) {\r\n                            theUrl += _noResponseQs;\r\n                        }\r\n                    }\r\n                }\r\n                if (_sendCredentials) {\r\n                    // Don't send credentials when URL is file://\r\n                    requestInit.credentials = \"include\";\r\n                }\r\n                // Only add headers if there are headers to add, due to issue with some polyfills\r\n                if (payload.headers && objKeys(payload.headers).length > 0) {\r\n                    requestInit.headers = payload.headers;\r\n                }\r\n                fetch(theUrl, requestInit).then(function (response) {\r\n                    var headerMap = {};\r\n                    var responseText = STR_EMPTY;\r\n                    var headers = response.headers;\r\n                    if (headers) {\r\n                        headers[\"forEach\"](function (value, name) {\r\n                            headerMap[name] = value;\r\n                        });\r\n                    }\r\n                    if (response.body) {\r\n                        response.text().then(function (text) {\r\n                            responseText = text;\r\n                        });\r\n                    }\r\n                    if (!responseHandled) {\r\n                        responseHandled = true;\r\n                        _doOnComplete(oncomplete, response.status, headerMap, responseText);\r\n                        _handleCollectorResponse(responseText);\r\n                    }\r\n                })[\"catch\"](function (error) {\r\n                    // In case there is an error in the request. Set the status to 0\r\n                    // so that the events can be retried later.\r\n                    if (!responseHandled) {\r\n                        responseHandled = true;\r\n                        _doOnComplete(oncomplete, 0, {});\r\n                    }\r\n                });\r\n                if (ignoreResponse && !responseHandled) {\r\n                    // Assume success during unload processing\r\n                    responseHandled = true;\r\n                    _doOnComplete(oncomplete, 200, {});\r\n                }\r\n                if (!responseHandled && payload.timeout > 0) {\r\n                    // Simulate timeout\r\n                    timeoutOverride.set(function () {\r\n                        if (!responseHandled) {\r\n                            // Assume a 500 response (which will cause a retry)\r\n                            responseHandled = true;\r\n                            _doOnComplete(oncomplete, 500, {});\r\n                        }\r\n                    }, payload.timeout);\r\n                }\r\n            }\r\n            function _xhrSendPost(payload, oncomplete, sync) {\r\n                var theUrl = payload.urlString;\r\n                function _appendHeader(theHeaders, xhr, name) {\r\n                    if (!theHeaders[name] && xhr && xhr.getResponseHeader) {\r\n                        var value = xhr.getResponseHeader(name);\r\n                        if (value) {\r\n                            theHeaders[name] = strTrim(value);\r\n                        }\r\n                    }\r\n                    return theHeaders;\r\n                }\r\n                function _getAllResponseHeaders(xhr) {\r\n                    var theHeaders = {};\r\n                    if (!xhr.getAllResponseHeaders) {\r\n                        // Firefox 2-63 doesn't have getAllResponseHeaders function but it does have getResponseHeader\r\n                        // Only call these if getAllResponseHeaders doesn't exist, otherwise we can get invalid response errors\r\n                        // as collector is not currently returning the correct header to allow JS to access these headers\r\n                        theHeaders = _appendHeader(theHeaders, xhr, STR_TIME_DELTA_HEADER);\r\n                        theHeaders = _appendHeader(theHeaders, xhr, STR_KILL_DURATION_HEADER);\r\n                        theHeaders = _appendHeader(theHeaders, xhr, STR_KILL_DURATION_SECONDS_HEADER);\r\n                    }\r\n                    else {\r\n                        theHeaders = _convertAllHeadersToMap(xhr.getAllResponseHeaders());\r\n                    }\r\n                    return theHeaders;\r\n                }\r\n                function xhrComplete(xhr, responseTxt) {\r\n                    _doOnComplete(oncomplete, xhr.status, _getAllResponseHeaders(xhr), responseTxt);\r\n                }\r\n                if (sync && payload.disableXhrSync) {\r\n                    sync = false;\r\n                }\r\n                var xhrRequest = openXhr(STR_POST_METHOD, theUrl, _sendCredentials, true, sync, payload.timeout);\r\n                // Set custom headers (e.g. gzip) here (after open())\r\n                objForEachKey(payload.headers, function (name, value) {\r\n                    xhrRequest.setRequestHeader(name, value);\r\n                });\r\n                xhrRequest.onload = function () {\r\n                    var response = _getResponseText(xhrRequest);\r\n                    xhrComplete(xhrRequest, response);\r\n                    _handleCollectorResponse(response);\r\n                };\r\n                xhrRequest.onerror = function () {\r\n                    xhrComplete(xhrRequest);\r\n                };\r\n                xhrRequest.ontimeout = function () {\r\n                    xhrComplete(xhrRequest);\r\n                };\r\n                xhrRequest.send(payload.data);\r\n            }\r\n            function _doOnComplete(oncomplete, status, headers, response) {\r\n                try {\r\n                    oncomplete(status, headers, response);\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(_logger, 2 /* eLoggingSeverity.WARNING */, 518 /* _eExtendedInternalMessageId.SendPostOnCompleteFailure */, dumpObj(e));\r\n                }\r\n            }\r\n            function _beaconSendPost(payload, oncomplete, sync) {\r\n                // Custom headers not supported in sendBeacon payload.headers would be ignored\r\n                var internalPayloadData = payload;\r\n                var status = 200;\r\n                var thePayload = internalPayloadData._thePayload;\r\n                var theUrl = payload.urlString + (_addNoResponse ? _noResponseQs : STR_EMPTY);\r\n                try {\r\n                    var nav_1 = getNavigator();\r\n                    if (!nav_1.sendBeacon(theUrl, payload.data)) {\r\n                        if (thePayload) {\r\n                            // Failed to send entire payload so try and split data and try to send as much events as possible\r\n                            var droppedBatches_1 = [];\r\n                            arrForEach(thePayload.batches, function (theBatch) {\r\n                                if (droppedBatches_1 && theBatch && theBatch.count() > 0) {\r\n                                    var theEvents = theBatch.events();\r\n                                    for (var lp = 0; lp < theEvents.length; lp++) {\r\n                                        if (!nav_1.sendBeacon(theUrl, _serializer.getEventBlob(theEvents[lp]))) {\r\n                                            // Can't send anymore, so split the batch and drop the rest\r\n                                            droppedBatches_1.push(theBatch.split(lp));\r\n                                            break;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    // Remove all of the events from the existing batch in the payload as the copy includes the original\r\n                                    droppedBatches_1.push(theBatch.split(0));\r\n                                }\r\n                            });\r\n                            _sendBatchesNotification(droppedBatches_1, 8003 /* EventBatchNotificationReason.SizeLimitExceeded */, thePayload.sendType, true);\r\n                        }\r\n                        else {\r\n                            status = 0;\r\n                        }\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                    _warnToConsole(_logger, \"Failed to send telemetry using sendBeacon API. Ex:\" + dumpObj(ex));\r\n                    status = 0;\r\n                }\r\n                finally {\r\n                    _doOnComplete(oncomplete, status, {}, STR_EMPTY);\r\n                }\r\n            }\r\n            function _isBeaconPayload(sendType) {\r\n                // Sync Fetch has the same payload limitation as sendBeacon -- 64kb limit, so treat both as a beacon send\r\n                return sendType === 2 /* EventSendType.SendBeacon */ || sendType === 3 /* EventSendType.SyncFetch */;\r\n            }\r\n            function _adjustSendType(sendType) {\r\n                if (_isUnloading && _isBeaconPayload(sendType)) {\r\n                    sendType = 2 /* EventSendType.SendBeacon */;\r\n                }\r\n                return sendType;\r\n            }\r\n            _self.addQueryStringParameter = function (name, value) {\r\n                for (var i = 0; i < _queryStringParameters.length; i++) {\r\n                    if (_queryStringParameters[i].name === name) {\r\n                        _queryStringParameters[i].value = value;\r\n                        return;\r\n                    }\r\n                }\r\n                _queryStringParameters.push({ name: name, value: value });\r\n            };\r\n            _self.addHeader = function (name, value) {\r\n                _headers[name] = value;\r\n            };\r\n            _self.canSendRequest = function () {\r\n                return _hasIdleConnection() && _clockSkewManager.allowRequestSending();\r\n            };\r\n            _self.sendQueuedRequests = function (sendType, sendReason) {\r\n                if (isUndefined(sendType)) {\r\n                    sendType = 0 /* EventSendType.Batched */;\r\n                }\r\n                if (_isUnloading) {\r\n                    sendType = _adjustSendType(sendType);\r\n                    sendReason = 2 /* SendRequestReason.Unload */;\r\n                }\r\n                if (_canSendPayload(_batchQueue, sendType, 0)) {\r\n                    _sendBatches(_clearQueue(), 0, false, sendType, sendReason || 0 /* SendRequestReason.Undefined */);\r\n                }\r\n            };\r\n            _self.isCompletelyIdle = function () {\r\n                return !_paused && _outstandingRequests === 0 && _batchQueue.length === 0;\r\n            };\r\n            _self.setUnloading = function (value) {\r\n                _isUnloading = value;\r\n            };\r\n            _self.addBatch = function (theBatch) {\r\n                if (theBatch && theBatch.count() > 0) {\r\n                    // Try and kill the event faster\r\n                    if (_killSwitch.isTenantKilled(theBatch.iKey())) {\r\n                        return false;\r\n                    }\r\n                    _batchQueue.push(theBatch);\r\n                }\r\n                return true;\r\n            };\r\n            /**\r\n             * Queue all the remaining requests to be sent. The requests will be\r\n             * sent using HTML5 Beacons if they are available.\r\n             */\r\n            _self.teardown = function () {\r\n                if (_batchQueue.length > 0) {\r\n                    _sendBatches(_clearQueue(), 0, true, 2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                }\r\n            };\r\n            /**\r\n             * Pause the sending of requests. No new requests will be sent.\r\n             */\r\n            _self.pause = function () {\r\n                _paused = true;\r\n            };\r\n            /**\r\n             * Resume the sending of requests.\r\n             */\r\n            _self.resume = function () {\r\n                _paused = false;\r\n                _self.sendQueuedRequests(0 /* EventSendType.Batched */, 4 /* SendRequestReason.Resumed */);\r\n            };\r\n            /**\r\n             * Sends a request synchronously to the Aria collector. This api is used to send\r\n             * a request containing a single immediate event.\r\n             *\r\n             * @param batch - The request to be sent.\r\n             * @param sendReason   - The token used to send the request.\r\n             */\r\n            _self.sendSynchronousBatch = function (batch, sendType, sendReason) {\r\n                // This will not take into account the max connections restriction. Since this is sync, we can\r\n                // only send one of this request at a time and thus should not worry about multiple connections\r\n                // being used to send synchronous events.\r\n                // Increment active connection since we are still going to use a connection to send the request.\r\n                if (batch && batch.count() > 0) {\r\n                    if (isNullOrUndefined(sendType)) {\r\n                        sendType = 1 /* EventSendType.Synchronous */;\r\n                    }\r\n                    if (_isUnloading) {\r\n                        sendType = _adjustSendType(sendType);\r\n                        sendReason = 2 /* SendRequestReason.Unload */;\r\n                    }\r\n                    // For sync requests we will not wait for the clock skew.\r\n                    _sendBatches([batch], 0, false, sendType, sendReason || 0 /* SendRequestReason.Undefined */);\r\n                }\r\n            };\r\n            function _hasIdleConnection() {\r\n                return !_paused && _outstandingRequests < maxConnections;\r\n            }\r\n            function _clearQueue() {\r\n                var theQueue = _batchQueue;\r\n                _batchQueue = [];\r\n                return theQueue;\r\n            }\r\n            function _canSendPayload(theBatches, sendType, retryCnt) {\r\n                var result = false;\r\n                if (theBatches && theBatches.length > 0 && !_paused && _sendInterfaces[sendType] && _serializer) {\r\n                    // Always attempt to send synchronous events don't wait for idle or clockSkew\r\n                    // and don't block retry requests if clockSkew is not yet set\r\n                    result = (sendType !== 0 /* EventSendType.Batched */) || (_hasIdleConnection() && (retryCnt > 0 || _clockSkewManager.allowRequestSending()));\r\n                }\r\n                return result;\r\n            }\r\n            function _createDebugBatches(theBatches) {\r\n                var values = {};\r\n                if (theBatches) {\r\n                    arrForEach(theBatches, function (theBatch, idx) {\r\n                        values[idx] = {\r\n                            iKey: theBatch.iKey(),\r\n                            evts: theBatch.events()\r\n                        };\r\n                    });\r\n                }\r\n                return values;\r\n            }\r\n            function _sendBatches(theBatches, retryCount, isTeardown, sendType, sendReason) {\r\n                if (!theBatches || theBatches.length === 0) {\r\n                    // Nothing to do\r\n                    return;\r\n                }\r\n                if (_paused) {\r\n                    _sendBatchesNotification(theBatches, 1 /* EventBatchNotificationReason.Paused */, sendType);\r\n                    return;\r\n                }\r\n                // Make sure that if we are unloading the sendType is a supported version\r\n                sendType = _adjustSendType(sendType);\r\n                try {\r\n                    var orgBatches_1 = theBatches;\r\n                    var isSynchronous_1 = sendType !== 0 /* EventSendType.Batched */;\r\n                    doPerf(_core, function () { return \"HttpManager:_sendBatches\"; }, function (perfEvt) {\r\n                        if (perfEvt) {\r\n                            // Perf Monitoring is enabled, so create a \"Quick\" copy of the original batches so we still report\r\n                            // the original values as part of the perfEvent. This is because theBatches uses .shift() to remove each\r\n                            // batch as they are processed - removing from the original array, so by the time the _createDebugBatches()\r\n                            // function is called the passed in value has changed and therefore the reported value for the perfEvent is incorrect\r\n                            theBatches = theBatches.slice(0);\r\n                        }\r\n                        var droppedBatches = [];\r\n                        var thePayload = null;\r\n                        var serializationStart = getTime();\r\n                        var sendInterface = _sendInterfaces[sendType] || (isSynchronous_1 ? _sendInterfaces[1 /* EventSendType.Synchronous */] : _sendInterfaces[0 /* EventSendType.Batched */]);\r\n                        var sendTransport = sendInterface && sendInterface._transport;\r\n                        // Sync Fetch has the same payload limitation as sendBeacon -- 64kb limit\r\n                        var isReducedPayload = _canHaveReducedPayload && (_isUnloading || _isBeaconPayload(sendType) || (sendTransport === 3 /* TransportType.Beacon */ || (sendInterface._isSync && sendTransport === 2 /* TransportType.Fetch */)));\r\n                        while (_canSendPayload(theBatches, sendType, retryCount)) {\r\n                            var theBatch = theBatches.shift();\r\n                            if (theBatch && theBatch.count() > 0) {\r\n                                if (!_killSwitch.isTenantKilled(theBatch.iKey())) {\r\n                                    // Make sure we have a payload object\r\n                                    thePayload = thePayload || _serializer.createPayload(retryCount, isTeardown, isSynchronous_1, isReducedPayload, sendReason, sendType);\r\n                                    // Add the batch to the current payload\r\n                                    if (!_serializer.appendPayload(thePayload, theBatch, maxEventsPerBatch)) {\r\n                                        // Entire batch was not added so send the payload and retry adding this batch\r\n                                        _doPayloadSend(thePayload, serializationStart, getTime(), sendReason);\r\n                                        serializationStart = getTime();\r\n                                        theBatches = [theBatch].concat(theBatches);\r\n                                        thePayload = null;\r\n                                    }\r\n                                    else if (thePayload.overflow !== null) {\r\n                                        // Total Payload size was exceeded so send the payload and add the unsent as the next batch to send\r\n                                        theBatches = [thePayload.overflow].concat(theBatches);\r\n                                        thePayload.overflow = null;\r\n                                        _doPayloadSend(thePayload, serializationStart, getTime(), sendReason);\r\n                                        serializationStart = getTime();\r\n                                        thePayload = null;\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    droppedBatches.push(theBatch);\r\n                                }\r\n                            }\r\n                        }\r\n                        // Make sure to flush any remaining payload\r\n                        if (thePayload) {\r\n                            _doPayloadSend(thePayload, serializationStart, getTime(), sendReason);\r\n                        }\r\n                        if (theBatches.length > 0) {\r\n                            // Add any unsent batches back to the head of the queue\r\n                            _batchQueue = theBatches.concat(_batchQueue);\r\n                        }\r\n                        // Now send notification about any dropped events\r\n                        _sendBatchesNotification(droppedBatches, 8004 /* EventBatchNotificationReason.KillSwitch */, sendType);\r\n                    }, function () { return ({ batches: _createDebugBatches(orgBatches_1), retryCount: retryCount, isTeardown: isTeardown, isSynchronous: isSynchronous_1, sendReason: sendReason, useSendBeacon: _isBeaconPayload(sendType), sendType: sendType }); }, !isSynchronous_1);\r\n                }\r\n                catch (ex) {\r\n                    _throwInternal(_logger, 2 /* eLoggingSeverity.WARNING */, 48 /* _eInternalMessageId.CannotSerializeObject */, \"Unexpected Exception sending batch: \" + dumpObj(ex));\r\n                }\r\n            }\r\n            function _buildRequestDetails(thePayload, useHeaders) {\r\n                var requestDetails = {\r\n                    url: _urlString,\r\n                    hdrs: {},\r\n                    useHdrs: false // Assume no headers\r\n                };\r\n                if (!useHeaders) {\r\n                    // Attempt to map headers to a query string if possible\r\n                    objForEachKey(_headers, function (name, value) {\r\n                        if (_collectorHeaderToQs[name]) {\r\n                            _addRequestDetails(requestDetails, _collectorHeaderToQs[name], value, false);\r\n                        }\r\n                        else {\r\n                            // No mapping, so just include in the headers anyway (may not get sent if using sendBeacon())\r\n                            requestDetails.hdrs[name] = value;\r\n                            requestDetails.useHdrs = true;\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    // Copy the pre-defined headers into the payload headers\r\n                    requestDetails.hdrs = extend(requestDetails.hdrs, _headers);\r\n                    requestDetails.useHdrs = (objKeys(requestDetails.hdrs).length > 0);\r\n                }\r\n                _addRequestDetails(requestDetails, STR_CLIENT_ID, \"NO_AUTH\", useHeaders);\r\n                _addRequestDetails(requestDetails, STR_CLIENT_VERSION, FullVersionString, useHeaders);\r\n                var apiQsKeys = STR_EMPTY;\r\n                arrForEach(thePayload.apiKeys, function (apiKey) {\r\n                    if (apiQsKeys.length > 0) {\r\n                        apiQsKeys += \",\";\r\n                    }\r\n                    apiQsKeys += apiKey;\r\n                });\r\n                _addRequestDetails(requestDetails, STR_API_KEY, apiQsKeys, useHeaders);\r\n                _addRequestDetails(requestDetails, STR_UPLOAD_TIME, dateNow().toString(), useHeaders);\r\n                var msfpc = _getMsfpc(thePayload);\r\n                if (isValueAssigned(msfpc)) {\r\n                    requestDetails.url += \"&ext.intweb.msfpc=\" + msfpc;\r\n                }\r\n                if (_clockSkewManager.shouldAddClockSkewHeaders()) {\r\n                    _addRequestDetails(requestDetails, STR_TIME_DELTA_TO_APPLY, _clockSkewManager.getClockSkewHeaderValue(), useHeaders);\r\n                }\r\n                if (_core.getWParam) {\r\n                    var wParam = _core.getWParam();\r\n                    if (wParam >= 0) {\r\n                        requestDetails.url += \"&w=\" + wParam;\r\n                    }\r\n                }\r\n                for (var i = 0; i < _queryStringParameters.length; i++) {\r\n                    requestDetails.url += \"&\" + _queryStringParameters[i].name + \"=\" + _queryStringParameters[i].value;\r\n                }\r\n                return requestDetails;\r\n            }\r\n            function _setTimingValue(timings, name, value) {\r\n                timings[name] = timings[name] || {};\r\n                timings[name][_postManager.identifier] = value;\r\n            }\r\n            function _doPayloadSend(thePayload, serializationStart, serializationCompleted, sendReason) {\r\n                if (thePayload && thePayload.payloadBlob && thePayload.payloadBlob.length > 0) {\r\n                    var useSendHook_1 = !!_self.sendHook;\r\n                    var sendInterface_1 = _sendInterfaces[thePayload.sendType];\r\n                    // Send all data using a beacon style transport if closing mode is on or channel was teared down\r\n                    if (!_isBeaconPayload(thePayload.sendType) && thePayload.isBeacon && thePayload.sendReason === 2 /* SendRequestReason.Unload */) {\r\n                        sendInterface_1 = _sendInterfaces[2 /* EventSendType.SendBeacon */] || _sendInterfaces[3 /* EventSendType.SyncFetch */] || sendInterface_1;\r\n                    }\r\n                    var useHeaders_1 = _useHeaders;\r\n                    // Disable header usage if we know we are using sendBeacon as additional headers are not supported\r\n                    if (thePayload.isBeacon || sendInterface_1._transport === 3 /* TransportType.Beacon */) {\r\n                        useHeaders_1 = false;\r\n                    }\r\n                    var requestDetails_1 = _buildRequestDetails(thePayload, useHeaders_1);\r\n                    useHeaders_1 = useHeaders_1 || requestDetails_1.useHdrs;\r\n                    var sendEventStart_1 = getTime();\r\n                    doPerf(_core, function () { return \"HttpManager:_doPayloadSend\"; }, function () {\r\n                        // Increment the send attempt count and add timings after packaging (So it's not serialized in the 1st attempt)\r\n                        for (var batchLp = 0; batchLp < thePayload.batches.length; batchLp++) {\r\n                            var theBatch = thePayload.batches[batchLp];\r\n                            var theEvents = theBatch.events();\r\n                            for (var evtLp = 0; evtLp < theEvents.length; evtLp++) {\r\n                                var telemetryItem = theEvents[evtLp];\r\n                                if (_enableEventTimings) {\r\n                                    var timings = telemetryItem.timings = telemetryItem.timings || {};\r\n                                    _setTimingValue(timings, \"sendEventStart\", sendEventStart_1);\r\n                                    _setTimingValue(timings, \"serializationStart\", serializationStart);\r\n                                    _setTimingValue(timings, \"serializationCompleted\", serializationCompleted);\r\n                                }\r\n                                telemetryItem[strSendAttempt] > 0 ? telemetryItem[strSendAttempt]++ : telemetryItem[strSendAttempt] = 1;\r\n                            }\r\n                        }\r\n                        // Note: always sending this notification in a synchronous manner.\r\n                        _sendBatchesNotification(thePayload.batches, (1000 /* EventBatchNotificationReason.SendingUndefined */ + (sendReason || 0 /* SendRequestReason.Undefined */)), thePayload.sendType, true);\r\n                        // Disabling the use of const because of Issue: \r\n                        // - Task 9227844: [1DS] Some environments and packagers automatically \"freeze\" objects which are defined as const which causes any mutations to throw\r\n                        // eslint-disable-next-line prefer-const\r\n                        var orgPayloadData = {\r\n                            data: thePayload.payloadBlob,\r\n                            urlString: requestDetails_1.url,\r\n                            headers: requestDetails_1.hdrs,\r\n                            _thePayload: thePayload,\r\n                            _sendReason: sendReason,\r\n                            timeout: _xhrTimeout,\r\n                            disableXhrSync: _disableXhrSync,\r\n                            disableFetchKeepAlive: _disableFetchKeepAlive\r\n                        };\r\n                        // Only automatically add the following headers if already sending headers and we are not attempting to avoid an options call\r\n                        if (useHeaders_1) {\r\n                            if (!_hasHeader(orgPayloadData.headers, STR_CACHE_CONTROL)) {\r\n                                orgPayloadData.headers[STR_CACHE_CONTROL] = DEFAULT_CACHE_CONTROL;\r\n                            }\r\n                            if (!_hasHeader(orgPayloadData.headers, STR_CONTENT_TYPE_HEADER)) {\r\n                                orgPayloadData.headers[STR_CONTENT_TYPE_HEADER] = DEFAULT_CONTENT_TYPE;\r\n                            }\r\n                        }\r\n                        var sender = null;\r\n                        if (sendInterface_1) {\r\n                            // Send sync requests if the request is immediate or we are tearing down telemetry.\r\n                            sender = function (payload) {\r\n                                // Notify the clock skew manager that we are sending the first request (Potentially blocking all further requests)\r\n                                _clockSkewManager.firstRequestSent();\r\n                                var onComplete = function (status, headers) {\r\n                                    _retryRequestIfNeeded(status, headers, thePayload, sendReason);\r\n                                };\r\n                                var isSync = thePayload.isTeardown || thePayload.isSync;\r\n                                try {\r\n                                    sendInterface_1.sendPOST(payload, onComplete, isSync);\r\n                                    if (_self.sendListener) {\r\n                                        // Send the original payload to the listener\r\n                                        _self.sendListener(orgPayloadData, payload, isSync, thePayload.isBeacon);\r\n                                    }\r\n                                }\r\n                                catch (ex) {\r\n                                    _warnToConsole(_logger, \"Unexpected exception sending payload. Ex:\" + dumpObj(ex));\r\n                                    _doOnComplete(onComplete, 0, {});\r\n                                }\r\n                            };\r\n                        }\r\n                        doPerf(_core, function () { return \"HttpManager:_doPayloadSend.sender\"; }, function () {\r\n                            if (sender) {\r\n                                if (thePayload.sendType === 0 /* EventSendType.Batched */) {\r\n                                    _outstandingRequests++;\r\n                                }\r\n                                // Only call the hook if it's defined and we are not using sendBeacon as additional headers are not supported\r\n                                if (useSendHook_1 && !thePayload.isBeacon && sendInterface_1._transport !== 3 /* TransportType.Beacon */) {\r\n                                    // Create a new IPayloadData that is sent into the hook method, so that the hook method\r\n                                    // can't change the object references to the orgPayloadData (it can still change the content -- mainly the headers)\r\n                                    // Disabling the use of const because of Issue: \r\n                                    // - Task 9227844: [1DS] Some environments and packagers automatically \"freeze\" objects which are defined as const which causes any mutations to throw\r\n                                    // eslint-disable-next-line prefer-const\r\n                                    var hookData_1 = {\r\n                                        data: orgPayloadData.data,\r\n                                        urlString: orgPayloadData.urlString,\r\n                                        headers: extend({}, orgPayloadData.headers),\r\n                                        timeout: orgPayloadData.timeout,\r\n                                        disableXhrSync: orgPayloadData.disableXhrSync,\r\n                                        disableFetchKeepAlive: orgPayloadData.disableFetchKeepAlive\r\n                                    };\r\n                                    var senderCalled_1 = false;\r\n                                    doPerf(_core, function () { return \"HttpManager:_doPayloadSend.sendHook\"; }, function () {\r\n                                        try {\r\n                                            _self.sendHook(hookData_1, function (payload) {\r\n                                                senderCalled_1 = true;\r\n                                                // Add back the internal properties\r\n                                                if (!_customHttpInterface && !payload._thePayload) {\r\n                                                    payload._thePayload = payload._thePayload || orgPayloadData._thePayload;\r\n                                                    payload._sendReason = payload._sendReason || orgPayloadData._sendReason;\r\n                                                }\r\n                                                sender(payload);\r\n                                            }, thePayload.isSync || thePayload.isTeardown);\r\n                                        }\r\n                                        catch (ex) {\r\n                                            if (!senderCalled_1) {\r\n                                                // The hook never called the sender -- assume that it never will\r\n                                                sender(orgPayloadData);\r\n                                            }\r\n                                        }\r\n                                    });\r\n                                }\r\n                                else {\r\n                                    sender(orgPayloadData);\r\n                                }\r\n                            }\r\n                        });\r\n                    }, function () { return ({ thePayload: thePayload, serializationStart: serializationStart, serializationCompleted: serializationCompleted, sendReason: sendReason }); }, thePayload.isSync);\r\n                }\r\n                if (thePayload.sizeExceed && thePayload.sizeExceed.length > 0) {\r\n                    // Ensure that we send any discard events for oversize events even when there was no payload to send\r\n                    _sendBatchesNotification(thePayload.sizeExceed, 8003 /* EventBatchNotificationReason.SizeLimitExceeded */, thePayload.sendType);\r\n                }\r\n                if (thePayload.failedEvts && thePayload.failedEvts.length > 0) {\r\n                    // Ensure that we send any discard events for events that could not be serialized even when there was no payload to send\r\n                    _sendBatchesNotification(thePayload.failedEvts, 8002 /* EventBatchNotificationReason.InvalidEvent */, thePayload.sendType);\r\n                }\r\n            }\r\n            function _addEventCompletedTimings(theEvents, sendEventCompleted) {\r\n                if (_enableEventTimings) {\r\n                    arrForEach(theEvents, function (theEvent) {\r\n                        var timings = theEvent.timings = theEvent.timings || {};\r\n                        _setTimingValue(timings, \"sendEventCompleted\", sendEventCompleted);\r\n                    });\r\n                }\r\n            }\r\n            function _retryRequestIfNeeded(status, headers, thePayload, sendReason) {\r\n                var reason = 9000 /* EventBatchNotificationReason.ResponseFailure */;\r\n                var droppedBatches = null;\r\n                var isRetrying = false;\r\n                var backOffTrans = false;\r\n                try {\r\n                    var shouldRetry = true;\r\n                    if (typeof status !== strUndefined) {\r\n                        if (headers) {\r\n                            _clockSkewManager.setClockSkew(headers[STR_TIME_DELTA_HEADER]);\r\n                            var killDuration = headers[STR_KILL_DURATION_HEADER] || headers[\"kill-duration-seconds\"];\r\n                            arrForEach(_killSwitch.setKillSwitchTenants(headers[STR_KILL_TOKENS_HEADER], killDuration), function (killToken) {\r\n                                arrForEach(thePayload.batches, function (theBatch) {\r\n                                    if (theBatch.iKey() === killToken) {\r\n                                        // Make sure we have initialized the array\r\n                                        droppedBatches = droppedBatches || [];\r\n                                        // Create a copy of the batch with all of the events (and more importantly the action functions)\r\n                                        var removedEvents = theBatch.split(0);\r\n                                        // And then remove the events for the payload batch and reduce the actual number of processed\r\n                                        thePayload.numEvents -= removedEvents.count();\r\n                                        droppedBatches.push(removedEvents);\r\n                                    }\r\n                                });\r\n                            });\r\n                        }\r\n                        // Disabling triple-equals rule to avoid httpOverrides from failing because they are returning a string value\r\n                        // tslint:disable-next-line:triple-equals\r\n                        if (status == 200 || status == 204) {\r\n                            // Response was successfully sent\r\n                            reason = 200 /* EventBatchNotificationReason.Complete */;\r\n                            return;\r\n                        }\r\n                        if (!retryPolicyShouldRetryForStatus(status) || thePayload.numEvents <= 0) {\r\n                            // Only retry for specific response codes and if there is still events after kill switch processing\r\n                            shouldRetry = false;\r\n                        }\r\n                        // Derive the notification response from the HttpStatus Code\r\n                        reason = 9000 /* EventBatchNotificationReason.ResponseFailure */ + (status % 1000);\r\n                    }\r\n                    if (shouldRetry) {\r\n                        // The events should be retried -- so change notification to requeue them\r\n                        reason = 100 /* EventBatchNotificationReason.RequeueEvents */;\r\n                        var retryCount_1 = thePayload.retryCnt;\r\n                        if (thePayload.sendType === 0 /* EventSendType.Batched */) {\r\n                            // attempt to resend the entire batch\r\n                            if (retryCount_1 < maxRequestRetriesBeforeBackoff) {\r\n                                isRetrying = true;\r\n                                _doAction(function () {\r\n                                    // try to resend the same batches\r\n                                    if (thePayload.sendType === 0 /* EventSendType.Batched */) {\r\n                                        // Reduce the outstanding request count (if this was an async request) as we didn't reduce the count\r\n                                        // previously and we are about to reschedule our retry attempt and we want an attempt to send\r\n                                        // to occur, it's also required to ensure that a follow up handleRequestFinished() call occurs\r\n                                        _outstandingRequests--;\r\n                                    }\r\n                                    _sendBatches(thePayload.batches, retryCount_1 + 1, thePayload.isTeardown, _isUnloading ? 2 /* EventSendType.SendBeacon */ : thePayload.sendType, 5 /* SendRequestReason.Retry */);\r\n                                }, _isUnloading, retryPolicyGetMillisToBackoffForRetry(retryCount_1));\r\n                            }\r\n                            else {\r\n                                backOffTrans = true;\r\n                                if (_isUnloading) {\r\n                                    // we are unloading so don't try and requeue the events otherwise let the events get requeued and resent during the backoff sending\r\n                                    // This will also cause the events to be purged based on the priority (if necessary)\r\n                                    reason = 8001 /* EventBatchNotificationReason.NonRetryableStatus */;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                finally {\r\n                    if (!isRetrying) {\r\n                        // Make sure the clockSkewManager doesn't blocking further sending of requests once we have a proper response\r\n                        // This won't override any previously sent clock Skew value\r\n                        _clockSkewManager.setClockSkew();\r\n                        _handleRequestFinished(thePayload, reason, sendReason, backOffTrans);\r\n                    }\r\n                    _sendBatchesNotification(droppedBatches, 8004 /* EventBatchNotificationReason.KillSwitch */, thePayload.sendType);\r\n                }\r\n            }\r\n            function _handleRequestFinished(thePayload, batchReason, sendReason, backOffTrans) {\r\n                try {\r\n                    if (backOffTrans) {\r\n                        // Slow down the transmission requests\r\n                        _postManager._backOffTransmission();\r\n                    }\r\n                    if (batchReason === 200 /* EventBatchNotificationReason.Complete */) {\r\n                        if (!backOffTrans && !thePayload.isSync) {\r\n                            // We have a successful async response, so the lets open the floodgates\r\n                            // The reason for checking isSync is to avoid unblocking if beacon send occurred as it\r\n                            // doesn't wait for a response.\r\n                            _postManager._clearBackOff();\r\n                        }\r\n                        _addCompleteTimings(thePayload.batches);\r\n                    }\r\n                    // Send the notifications synchronously\r\n                    _sendBatchesNotification(thePayload.batches, batchReason, thePayload.sendType, true);\r\n                }\r\n                finally {\r\n                    if (thePayload.sendType === 0 /* EventSendType.Batched */) {\r\n                        // we always need to decrement this value otherwise the httpmanager locks up and won't send any more events\r\n                        _outstandingRequests--;\r\n                        // Don't try to send additional queued events if this is a retry operation as the retried\r\n                        // response will eventually call _handleRequestFinished for the retried event\r\n                        if (sendReason !== 5 /* SendRequestReason.Retry */) {\r\n                            // Try and send any other queued batched events\r\n                            _self.sendQueuedRequests(thePayload.sendType, sendReason);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            function _addCompleteTimings(theBatches) {\r\n                if (_enableEventTimings) {\r\n                    var sendEventCompleted_1 = getTime();\r\n                    arrForEach(theBatches, function (theBatch) {\r\n                        if (theBatch && theBatch.count() > 0) {\r\n                            _addEventCompletedTimings(theBatch.events(), sendEventCompleted_1);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            function _doAction(cb, isSync, interval) {\r\n                if (isSync) {\r\n                    cb();\r\n                }\r\n                else {\r\n                    timeoutOverride.set(cb, interval);\r\n                }\r\n            }\r\n            /**\r\n            * Converts the XHR getAllResponseHeaders to a map containing the header key and value.\r\n            */\r\n            // tslint:disable-next-line: align\r\n            function _convertAllHeadersToMap(headersString) {\r\n                var headers = {};\r\n                if (isString(headersString)) {\r\n                    var headersArray = strTrim(headersString).split(/[\\r\\n]+/);\r\n                    arrForEach(headersArray, function (headerEntry) {\r\n                        if (headerEntry) {\r\n                            var idx = headerEntry.indexOf(\": \");\r\n                            if (idx !== -1) {\r\n                                // The new spec has the headers returning all as lowercase -- but not all browsers do this yet\r\n                                var header = strTrim(headerEntry.substring(0, idx)).toLowerCase();\r\n                                var value = strTrim(headerEntry.substring(idx + 1));\r\n                                headers[header] = value;\r\n                            }\r\n                            else {\r\n                                headers[strTrim(headerEntry)] = 1;\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n                return headers;\r\n            }\r\n            function _getMsfpc(thePayload) {\r\n                for (var lp = 0; lp < thePayload.batches.length; lp++) {\r\n                    var msfpc = thePayload.batches[lp].Msfpc();\r\n                    if (msfpc) {\r\n                        return encodeURIComponent(msfpc);\r\n                    }\r\n                }\r\n                return STR_EMPTY;\r\n            }\r\n            function _handleCollectorResponse(responseText) {\r\n                var responseHandlers = _self._responseHandlers;\r\n                try {\r\n                    for (var i = 0; i < responseHandlers.length; i++) {\r\n                        try {\r\n                            responseHandlers[i](responseText);\r\n                        }\r\n                        catch (e) {\r\n                            _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 519 /* _eExtendedInternalMessageId.PostResponseHandler */, \"Response handler failed: \" + e);\r\n                        }\r\n                    }\r\n                    if (responseText) {\r\n                        var response = JSON.parse(responseText);\r\n                        if (isValueAssigned(response.webResult) && isValueAssigned(response.webResult[STR_MSFPC])) {\r\n                            // Set cookie\r\n                            _cookieMgr.set(\"MSFPC\", response.webResult[STR_MSFPC], 365 * 86400);\r\n                        }\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                    // Doing nothing\r\n                }\r\n            }\r\n            function _sendBatchesNotification(theBatches, batchReason, sendType, sendSync) {\r\n                if (theBatches && theBatches.length > 0 && actions) {\r\n                    var theAction_1 = actions[_getNotificationAction(batchReason)];\r\n                    if (theAction_1) {\r\n                        var isSyncRequest_1 = sendType !== 0 /* EventSendType.Batched */;\r\n                        doPerf(_core, function () { return \"HttpManager:_sendBatchesNotification\"; }, function () {\r\n                            _doAction(function () {\r\n                                try {\r\n                                    theAction_1.call(actions, theBatches, batchReason, isSyncRequest_1, sendType);\r\n                                }\r\n                                catch (e) {\r\n                                    _throwInternal(_logger, 1 /* eLoggingSeverity.CRITICAL */, 74 /* _eInternalMessageId.NotificationException */, \"send request notification failed: \" + e);\r\n                                }\r\n                            }, sendSync || isSyncRequest_1, 0);\r\n                        }, function () { return ({ batches: _createDebugBatches(theBatches), reason: batchReason, isSync: isSyncRequest_1, sendSync: sendSync, sendType: sendType }); }, !isSyncRequest_1);\r\n                    }\r\n                }\r\n            }\r\n            function _getNotificationAction(reason) {\r\n                var action = _eventActionMap[reason];\r\n                if (!isValueAssigned(action)) {\r\n                    action = STR_OTHER;\r\n                    if (reason >= 9000 /* EventBatchNotificationReason.ResponseFailure */ && reason <= 9999 /* EventBatchNotificationReason.ResponseFailureMax */) {\r\n                        action = STR_RESPONSE_FAIL;\r\n                    }\r\n                    else if (reason >= 8000 /* EventBatchNotificationReason.EventsDropped */ && reason <= 8999 /* EventBatchNotificationReason.EventsDroppedMax */) {\r\n                        action = STR_DROPPED;\r\n                    }\r\n                    else if (reason >= 1000 /* EventBatchNotificationReason.SendingUndefined */ && reason <= 1999 /* EventBatchNotificationReason.SendingEventMax */) {\r\n                        action = STR_SENDING;\r\n                    }\r\n                }\r\n                return action;\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * @constructor\r\n     * @param requestQueue   - The queue that contains the requests to be sent.\r\n     * @param endpointUrl   - The collector url to which the requests must be sent.\r\n     * @param postManager   - The post manager that we should add requests back to if needed.\r\n     * @param httpInterface - The http interface that should be used to send HTTP requests.\r\n     * @param channelConfig - The IChannelConfiguration the should be used to get additional configuration\r\n     */\r\n    HttpManager.prototype.initialize = function (endpointUrl, core, postChannel, httpInterface, channelConfig) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add query string parameter to url\r\n     * @param name   - Query string name.\r\n     * @param value  - Query string value.\r\n     */\r\n    HttpManager.prototype.addQueryStringParameter = function (name, value) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add header to request\r\n     * @param name   - Header name.\r\n     * @param value  - Header value.\r\n     */\r\n    HttpManager.prototype.addHeader = function (name, value) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add the batch of events to the queue for sending\r\n     * @param batch The batch with the events to send\r\n     * @returns True if the http manager has accepted the batch (including if the batch is empty) otherwise false\r\n     */\r\n    HttpManager.prototype.addBatch = function (batch) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Check if there is an idle connection and we can send a request.\r\n     * @returns True if there is an idle connection, false otherwise.\r\n     */\r\n    HttpManager.prototype.canSendRequest = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Send requests in the request queue up if there is an idle connection, sending is\r\n     * not pause and clock skew manager allows sending request.\r\n     * @param sendType - Identifies how the batched events should be send, defaults to Batched\r\n     * @param sendReason   - The reason the batch is being sent\r\n     */\r\n    HttpManager.prototype.sendQueuedRequests = function (sendType, sendReason) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Check if there are no active requests being sent.\r\n     * @returns True if idle, false otherwise.\r\n     */\r\n    HttpManager.prototype.isCompletelyIdle = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Inform the HttpManager that a page unload event was received\r\n     */\r\n    HttpManager.prototype.setUnloading = function (value) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Queue all the remaining requests to be sent. The requests will be\r\n     * sent using HTML5 Beacons if they are available.\r\n     */\r\n    HttpManager.prototype.teardown = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Pause the sending of requests. No new requests will be sent.\r\n     */\r\n    HttpManager.prototype.pause = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Resume the sending of requests.\r\n     */\r\n    HttpManager.prototype.resume = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Sends the batches synchronously to the collector. This api is used to send a batches immediate event.\r\n     *\r\n     * @param batch - The batch of events to be sent.\r\n     * @param sendReason   - The reason the batch is being sent\r\n     * @param sendType - Identifies the sending type to use when sending the batch\r\n     */\r\n    HttpManager.prototype.sendSynchronousBatch = function (batch, sendType, sendReason) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return HttpManager;\r\n}());\r\nexport { HttpManager };\r\n//# sourceMappingURL=HttpManager.js.map", "/**\r\n* TimeoutOverrideWrapper.ts\r\n* @author  Nev Wylie (newylie)\r\n* @copyright Microsoft 2022\r\n* Simple internal timeout wrapper\r\n*/\r\nexport function defaultSetTimeout(callback, ms) {\r\n    var args = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        args[_i - 2] = arguments[_i];\r\n    }\r\n    return setTimeout(callback, ms, args);\r\n}\r\nexport function defaultClearTimeout(timeoutId) {\r\n    clearTimeout(timeoutId);\r\n}\r\nexport function createTimeoutWrapper(argSetTimeout, argClearTimeout) {\r\n    return {\r\n        set: argSetTimeout || defaultSetTimeout,\r\n        clear: argClearTimeout || defaultClearTimeout\r\n    };\r\n}\r\n//# sourceMappingURL=TimeoutOverrideWrapper.js.map", "import { __extends } from \"tslib\";\r\n/**\r\n* PostManager.ts\r\n* @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)\r\n* @copyright Microsoft 2018-2020\r\n*/\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { BaseTelemetryPlugin, EventsDiscardedReason, _throwInternal, addPageHideEventListener, addPageShowEventListener, addPageUnloadEventListener, arrForEach, createUniqueNamespace, doPerf, getWindow, isChromium, isNumber, isValueAssigned, mergeEvtNamespace, objDefineAccessors, objForEachKey, optimizeObject, removePageHideEventListener, removePageShowEventListener, removePageUnloadEventListener, setProcessTelemetryTimings } from \"@microsoft/1ds-core-js\";\r\nimport { BE_PROFILE, NRT_PROFILE, RT_PROFILE } from \"./DataModels\";\r\nimport { EventBatch } from \"./EventBatch\";\r\nimport { HttpManager } from \"./HttpManager\";\r\nimport { STR_MSA_DEVICE_TICKET, STR_TRACE, STR_USER } from \"./InternalConstants\";\r\nimport { retryPolicyGetMillisToBackoffForRetry } from \"./RetryPolicy\";\r\nimport { createTimeoutWrapper } from \"./TimeoutOverrideWrapper\";\r\nvar FlushCheckTimer = 0.250; // This needs to be in seconds, so this is 250ms\r\nvar MaxNumberEventPerBatch = 500;\r\nvar EventsDroppedAtOneTime = 20;\r\nvar MaxSendAttempts = 6;\r\nvar MaxSyncUnloadSendAttempts = 2; // Assuming 2 based on beforeunload and unload\r\nvar MaxBackoffCount = 4;\r\nvar MaxConnections = 2;\r\nvar MaxRequestRetriesBeforeBackoff = 1;\r\nvar strEventsDiscarded = \"eventsDiscarded\";\r\nvar strOverrideInstrumentationKey = \"overrideInstrumentationKey\";\r\nvar strMaxEventRetryAttempts = \"maxEventRetryAttempts\";\r\nvar strMaxUnloadEventRetryAttempts = \"maxUnloadEventRetryAttempts\";\r\nvar strAddUnloadCb = \"addUnloadCb\";\r\n/**\r\n * Class that manages adding events to inbound queues and batching of events\r\n * into requests.\r\n */\r\nvar PostChannel = /** @class */ (function (_super) {\r\n    __extends(PostChannel, _super);\r\n    function PostChannel() {\r\n        var _this = _super.call(this) || this;\r\n        _this.identifier = \"PostChannel\";\r\n        _this.priority = 1011;\r\n        _this.version = '3.2.18';\r\n        var _config;\r\n        var _isTeardownCalled = false;\r\n        var _flushCallbackQueue = [];\r\n        var _flushCallbackTimerId = null;\r\n        var _paused = false;\r\n        var _immediateQueueSize = 0;\r\n        var _immediateQueueSizeLimit = 500;\r\n        var _queueSize = 0;\r\n        var _queueSizeLimit = 10000;\r\n        var _profiles = {};\r\n        var _currentProfile = RT_PROFILE;\r\n        var _scheduledTimerId = null;\r\n        var _immediateTimerId = null;\r\n        var _currentBackoffCount = 0;\r\n        var _timerCount = 0;\r\n        var _xhrOverride;\r\n        var _httpManager;\r\n        var _batchQueues = {};\r\n        var _autoFlushEventsLimit;\r\n        // either MaxBatchSize * (1+ Max Connections) or _queueLimit / 6 (where 3 latency Queues [normal, realtime, cost deferred] * 2 [allow half full -- allow for retry])\r\n        var _autoFlushBatchLimit;\r\n        var _delayedBatchSendLatency = -1;\r\n        var _delayedBatchReason;\r\n        var _optimizeObject = true;\r\n        var _isPageUnloadTriggered = false;\r\n        var _maxEventSendAttempts = MaxSendAttempts;\r\n        var _maxUnloadEventSendAttempts = MaxSyncUnloadSendAttempts;\r\n        var _evtNamespace;\r\n        var _timeoutWrapper;\r\n        dynamicProto(PostChannel, _this, function (_self, _base) {\r\n            _initDefaults();\r\n            // Special internal method to allow the DebugPlugin to hook embedded objects\r\n            _self[\"_getDbgPlgTargets\"] = function () {\r\n                return [_httpManager];\r\n            };\r\n            _self.initialize = function (coreConfig, core, extensions) {\r\n                doPerf(core, function () { return \"PostChannel:initialize\"; }, function () {\r\n                    var extendedCore = core;\r\n                    _base.initialize(coreConfig, core, extensions);\r\n                    try {\r\n                        var hasAddUnloadCb = !!core[strAddUnloadCb];\r\n                        _evtNamespace = mergeEvtNamespace(createUniqueNamespace(_self.identifier), core.evtNamespace && core.evtNamespace());\r\n                        var ctx = _self._getTelCtx();\r\n                        coreConfig.extensionConfig[_self.identifier] = coreConfig.extensionConfig[_self.identifier] || {};\r\n                        _config = ctx.getExtCfg(_self.identifier);\r\n                        _timeoutWrapper = createTimeoutWrapper(_config.setTimeoutOverride, _config.clearTimeoutOverride);\r\n                        // Only try and use the optimizeObject() if this appears to be a chromium based browser and it has not been explicitly disabled\r\n                        _optimizeObject = !_config.disableOptimizeObj && isChromium();\r\n                        _hookWParam(extendedCore);\r\n                        if (_config.eventsLimitInMem > 0) {\r\n                            _queueSizeLimit = _config.eventsLimitInMem;\r\n                        }\r\n                        if (_config.immediateEventLimit > 0) {\r\n                            _immediateQueueSizeLimit = _config.immediateEventLimit;\r\n                        }\r\n                        if (_config.autoFlushEventsLimit > 0) {\r\n                            _autoFlushEventsLimit = _config.autoFlushEventsLimit;\r\n                        }\r\n                        if (isNumber(_config[strMaxEventRetryAttempts])) {\r\n                            _maxEventSendAttempts = _config[strMaxEventRetryAttempts];\r\n                        }\r\n                        if (isNumber(_config[strMaxUnloadEventRetryAttempts])) {\r\n                            _maxUnloadEventSendAttempts = _config[strMaxUnloadEventRetryAttempts];\r\n                        }\r\n                        _setAutoLimits();\r\n                        if (_config.httpXHROverride && _config.httpXHROverride.sendPOST) {\r\n                            _xhrOverride = _config.httpXHROverride;\r\n                        }\r\n                        if (isValueAssigned(coreConfig.anonCookieName)) {\r\n                            _httpManager.addQueryStringParameter(\"anoncknm\", coreConfig.anonCookieName);\r\n                        }\r\n                        _httpManager.sendHook = _config.payloadPreprocessor;\r\n                        _httpManager.sendListener = _config.payloadListener;\r\n                        // Override endpointUrl if provided in Post config\r\n                        var endpointUrl = _config.overrideEndpointUrl ? _config.overrideEndpointUrl : coreConfig.endpointUrl;\r\n                        _self._notificationManager = core.getNotifyMgr();\r\n                        _httpManager.initialize(endpointUrl, _self.core, _self, _xhrOverride, _config);\r\n                        var excludePageUnloadEvents = coreConfig.disablePageUnloadEvents || [];\r\n                        // When running in Web browsers try to send all telemetry if page is unloaded\r\n                        addPageUnloadEventListener(_handleUnloadEvents, excludePageUnloadEvents, _evtNamespace);\r\n                        addPageHideEventListener(_handleUnloadEvents, excludePageUnloadEvents, _evtNamespace);\r\n                        addPageShowEventListener(_handleShowEvents, coreConfig.disablePageShowEvents, _evtNamespace);\r\n                    }\r\n                    catch (e) {\r\n                        // resetting the initialized state because of failure\r\n                        _self.setInitialized(false);\r\n                        throw e;\r\n                    }\r\n                }, function () { return ({ coreConfig: coreConfig, core: core, extensions: extensions }); });\r\n            };\r\n            _self.processTelemetry = function (ev, itemCtx) {\r\n                setProcessTelemetryTimings(ev, _self.identifier);\r\n                itemCtx = _self._getTelCtx(itemCtx);\r\n                // Get the channel instance from the current request/instance\r\n                var channelConfig = itemCtx.getExtCfg(_self.identifier);\r\n                // DisableTelemetry was defined in the config provided during initialization\r\n                var disableTelemetry = !!_config.disableTelemetry;\r\n                if (channelConfig) {\r\n                    // DisableTelemetry is defined in the config for this request/instance\r\n                    disableTelemetry = disableTelemetry || !!channelConfig.disableTelemetry;\r\n                }\r\n                var event = ev;\r\n                if (!disableTelemetry && !_isTeardownCalled) {\r\n                    // Override iKey if provided in Post config if provided for during initialization\r\n                    if (_config[strOverrideInstrumentationKey]) {\r\n                        event.iKey = _config[strOverrideInstrumentationKey];\r\n                    }\r\n                    // Override iKey if provided in Post config if provided for this instance\r\n                    if (channelConfig && channelConfig[strOverrideInstrumentationKey]) {\r\n                        event.iKey = channelConfig[strOverrideInstrumentationKey];\r\n                    }\r\n                    _addEventToQueues(event, true);\r\n                    if (_isPageUnloadTriggered) {\r\n                        // Unload event has been received so we need to try and flush new events\r\n                        _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                    }\r\n                    else {\r\n                        _scheduleTimer();\r\n                    }\r\n                }\r\n                _self.processNext(event, itemCtx);\r\n            };\r\n            _self._doTeardown = function (unloadCtx, unloadState) {\r\n                _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                _isTeardownCalled = true;\r\n                _httpManager.teardown();\r\n                removePageUnloadEventListener(null, _evtNamespace);\r\n                removePageHideEventListener(null, _evtNamespace);\r\n                removePageShowEventListener(null, _evtNamespace);\r\n                // Just register to remove all events associated with this namespace\r\n                _initDefaults();\r\n            };\r\n            function _hookWParam(extendedCore) {\r\n                var existingGetWParamMethod = extendedCore.getWParam;\r\n                extendedCore.getWParam = function () {\r\n                    var wparam = 0;\r\n                    if (_config.ignoreMc1Ms0CookieProcessing) {\r\n                        wparam = wparam | 2;\r\n                    }\r\n                    return wparam | existingGetWParamMethod();\r\n                };\r\n            }\r\n            // Moving event handlers out from the initialize closure so that any local variables can be garbage collected\r\n            function _handleUnloadEvents(evt) {\r\n                var theEvt = evt || getWindow().event; // IE 8 does not pass the event\r\n                if (theEvt.type !== \"beforeunload\") {\r\n                    // Only set the unload trigger if not beforeunload event as beforeunload can be cancelled while the other events can't\r\n                    _isPageUnloadTriggered = true;\r\n                    _httpManager.setUnloading(_isPageUnloadTriggered);\r\n                }\r\n                _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n            }\r\n            function _handleShowEvents(evt) {\r\n                // Handle the page becoming visible again\r\n                _isPageUnloadTriggered = false;\r\n                _httpManager.setUnloading(_isPageUnloadTriggered);\r\n            }\r\n            function _addEventToQueues(event, append) {\r\n                // If send attempt field is undefined we should set it to 0.\r\n                if (!event.sendAttempt) {\r\n                    event.sendAttempt = 0;\r\n                }\r\n                // Add default latency\r\n                if (!event.latency) {\r\n                    event.latency = 1 /* EventLatencyValue.Normal */;\r\n                }\r\n                // Remove extra AI properties if present\r\n                if (event.ext && event.ext[STR_TRACE]) {\r\n                    delete (event.ext[STR_TRACE]);\r\n                }\r\n                if (event.ext && event.ext[STR_USER] && event.ext[STR_USER][\"id\"]) {\r\n                    delete (event.ext[STR_USER][\"id\"]);\r\n                }\r\n                // v8 performance optimization for iterating over the keys\r\n                if (_optimizeObject) {\r\n                    setProcessTelemetryTimings;\r\n                    event.ext = optimizeObject(event.ext);\r\n                    if (event.baseData) {\r\n                        event.baseData = optimizeObject(event.baseData);\r\n                    }\r\n                    if (event.data) {\r\n                        event.data = optimizeObject(event.data);\r\n                    }\r\n                }\r\n                if (event.sync) {\r\n                    // If the transmission is backed off then do not send synchronous events.\r\n                    // We will convert these events to Real time latency instead.\r\n                    if (_currentBackoffCount || _paused) {\r\n                        event.latency = 3 /* EventLatencyValue.RealTime */;\r\n                        event.sync = false;\r\n                    }\r\n                    else {\r\n                        // Log the event synchronously\r\n                        if (_httpManager) {\r\n                            // v8 performance optimization for iterating over the keys\r\n                            if (_optimizeObject) {\r\n                                event = optimizeObject(event);\r\n                            }\r\n                            _httpManager.sendSynchronousBatch(EventBatch.create(event.iKey, [event]), event.sync === true ? 1 /* EventSendType.Synchronous */ : event.sync, 3 /* SendRequestReason.SyncEvent */);\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n                var evtLatency = event.latency;\r\n                var queueSize = _queueSize;\r\n                var queueLimit = _queueSizeLimit;\r\n                if (evtLatency === 4 /* EventLatencyValue.Immediate */) {\r\n                    queueSize = _immediateQueueSize;\r\n                    queueLimit = _immediateQueueSizeLimit;\r\n                }\r\n                var eventDropped = false;\r\n                // Only add the event if the queue isn't full or it's a direct event (which don't add to the queue sizes)\r\n                if (queueSize < queueLimit) {\r\n                    eventDropped = !_addEventToProperQueue(event, append);\r\n                }\r\n                else {\r\n                    var dropLatency = 1 /* EventLatencyValue.Normal */;\r\n                    var dropNumber = EventsDroppedAtOneTime;\r\n                    if (evtLatency === 4 /* EventLatencyValue.Immediate */) {\r\n                        // Only drop other immediate events as they are not technically sharing the general queue\r\n                        dropLatency = 4 /* EventLatencyValue.Immediate */;\r\n                        dropNumber = 1;\r\n                    }\r\n                    // Drop old event from lower or equal latency\r\n                    eventDropped = true;\r\n                    if (_dropEventWithLatencyOrLess(event.iKey, event.latency, dropLatency, dropNumber)) {\r\n                        eventDropped = !_addEventToProperQueue(event, append);\r\n                    }\r\n                }\r\n                if (eventDropped) {\r\n                    // Can't drop events from current queues because the all the slots are taken by queues that are being flushed.\r\n                    _notifyEvents(strEventsDiscarded, [event], EventsDiscardedReason.QueueFull);\r\n                }\r\n            }\r\n            _self.setEventQueueLimits = function (eventLimit, autoFlushLimit) {\r\n                _queueSizeLimit = eventLimit > 0 ? eventLimit : 10000;\r\n                _autoFlushEventsLimit = autoFlushLimit > 0 ? autoFlushLimit : 0;\r\n                _setAutoLimits();\r\n                // We only do this check here as during normal event addition if the queue is > then events start getting dropped\r\n                var doFlush = _queueSize > eventLimit;\r\n                if (!doFlush && _autoFlushBatchLimit > 0) {\r\n                    // Check the auto flush max batch size\r\n                    for (var latency = 1 /* EventLatencyValue.Normal */; !doFlush && latency <= 3 /* EventLatencyValue.RealTime */; latency++) {\r\n                        var batchQueue = _batchQueues[latency];\r\n                        if (batchQueue && batchQueue.batches) {\r\n                            arrForEach(batchQueue.batches, function (theBatch) {\r\n                                if (theBatch && theBatch.count() >= _autoFlushBatchLimit) {\r\n                                    // If any 1 batch is > than the limit then trigger an auto flush\r\n                                    doFlush = true;\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n                _performAutoFlush(true, doFlush);\r\n            };\r\n            _self.pause = function () {\r\n                _clearScheduledTimer();\r\n                _paused = true;\r\n                _httpManager.pause();\r\n            };\r\n            _self.resume = function () {\r\n                _paused = false;\r\n                _httpManager.resume();\r\n                _scheduleTimer();\r\n            };\r\n            _self.addResponseHandler = function (responseHandler) {\r\n                _httpManager._responseHandlers.push(responseHandler);\r\n            };\r\n            _self._loadTransmitProfiles = function (profiles) {\r\n                _resetTransmitProfiles();\r\n                objForEachKey(profiles, function (profileName, profileValue) {\r\n                    var profLen = profileValue.length;\r\n                    if (profLen >= 2) {\r\n                        var directValue = (profLen > 2 ? profileValue[2] : 0);\r\n                        profileValue.splice(0, profLen - 2);\r\n                        // Make sure if a higher latency is set to not send then don't send lower latency\r\n                        if (profileValue[1] < 0) {\r\n                            profileValue[0] = -1;\r\n                        }\r\n                        // Make sure each latency is multiple of the latency higher then it. If not a multiple\r\n                        // we round up so that it becomes a multiple.\r\n                        if (profileValue[1] > 0 && profileValue[0] > 0) {\r\n                            var timerMultiplier = profileValue[0] / profileValue[1];\r\n                            profileValue[0] = Math.ceil(timerMultiplier) * profileValue[1];\r\n                        }\r\n                        // Add back the direct profile timeout\r\n                        if (directValue >= 0 && profileValue[1] >= 0 && directValue > profileValue[1]) {\r\n                            // Make sure if it's not disabled (< 0) then make sure it's not larger than RealTime\r\n                            directValue = profileValue[1];\r\n                        }\r\n                        profileValue.push(directValue);\r\n                        _profiles[profileName] = profileValue;\r\n                    }\r\n                });\r\n            };\r\n            _self.flush = function (async, callback, sendReason) {\r\n                if (async === void 0) { async = true; }\r\n                if (!_paused) {\r\n                    sendReason = sendReason || 1 /* SendRequestReason.ManualFlush */;\r\n                    if (async) {\r\n                        if (_flushCallbackTimerId == null) {\r\n                            // Clear the normal schedule timer as we are going to try and flush ASAP\r\n                            _clearScheduledTimer();\r\n                            // Move all queued events to the HttpManager so that we don't discard new events (Auto flush scenario)\r\n                            _queueBatches(1 /* EventLatencyValue.Normal */, 0 /* EventSendType.Batched */, sendReason);\r\n                            _flushCallbackTimerId = _createTimer(function () {\r\n                                _flushCallbackTimerId = null;\r\n                                _flushImpl(callback, sendReason);\r\n                            }, 0);\r\n                        }\r\n                        else {\r\n                            // Even if null (no callback) this will ensure after the flushImpl finishes waiting\r\n                            // for a completely idle connection it will attempt to re-flush any queued events on the next cycle\r\n                            _flushCallbackQueue.push(callback);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Clear the normal schedule timer as we are going to try and flush ASAP\r\n                        var cleared = _clearScheduledTimer();\r\n                        // Now cause all queued events to be sent synchronously\r\n                        _sendEventsForLatencyAndAbove(1 /* EventLatencyValue.Normal */, 1 /* EventSendType.Synchronous */, sendReason);\r\n                        if (callback !== null && callback !== undefined) {\r\n                            callback();\r\n                        }\r\n                        if (cleared) {\r\n                            // restart the normal event timer if it was cleared\r\n                            _scheduleTimer();\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            _self.setMsaAuthTicket = function (ticket) {\r\n                _httpManager.addHeader(STR_MSA_DEVICE_TICKET, ticket);\r\n            };\r\n            _self.hasEvents = _hasEvents;\r\n            _self._setTransmitProfile = function (profileName) {\r\n                if (_currentProfile !== profileName && _profiles[profileName] !== undefined) {\r\n                    _clearScheduledTimer();\r\n                    _currentProfile = profileName;\r\n                    _scheduleTimer();\r\n                }\r\n            };\r\n            /**\r\n             * Batch and send events currently in the queue for the given latency.\r\n             * @param latency - Latency for which to send events.\r\n             */\r\n            function _sendEventsForLatencyAndAbove(latency, sendType, sendReason) {\r\n                var queued = _queueBatches(latency, sendType, sendReason);\r\n                // Always trigger the request as while the post channel may not have queued additional events, the httpManager may already have waiting events\r\n                _httpManager.sendQueuedRequests(sendType, sendReason);\r\n                return queued;\r\n            }\r\n            function _hasEvents() {\r\n                return _queueSize > 0;\r\n            }\r\n            /**\r\n             * Try to schedule the timer after which events will be sent. If there are\r\n             * no events to be sent, or there is already a timer scheduled, or the\r\n             * http manager doesn't have any idle connections this method is no-op.\r\n             */\r\n            function _scheduleTimer() {\r\n                // If we had previously attempted to send requests, but the http manager didn't have any idle connections then the requests where delayed\r\n                // so try and requeue then again now\r\n                if (_delayedBatchSendLatency >= 0 && _queueBatches(_delayedBatchSendLatency, 0 /* EventSendType.Batched */, _delayedBatchReason)) {\r\n                    _httpManager.sendQueuedRequests(0 /* EventSendType.Batched */, _delayedBatchReason);\r\n                }\r\n                if (_immediateQueueSize > 0 && !_immediateTimerId && !_paused) {\r\n                    // During initialization _profiles enforce that the direct [2] is less than real time [1] timer value\r\n                    // If the immediateTimeout is disabled the immediate events will be sent with Real Time events\r\n                    var immediateTimeOut = _profiles[_currentProfile][2];\r\n                    if (immediateTimeOut >= 0) {\r\n                        _immediateTimerId = _createTimer(function () {\r\n                            _immediateTimerId = null;\r\n                            // Only try to send direct events\r\n                            _sendEventsForLatencyAndAbove(4 /* EventLatencyValue.Immediate */, 0 /* EventSendType.Batched */, 1 /* SendRequestReason.NormalSchedule */);\r\n                            _scheduleTimer();\r\n                        }, immediateTimeOut);\r\n                    }\r\n                }\r\n                // During initialization the _profiles enforce that the normal [0] is a multiple of the real time [1] timer value\r\n                var timeOut = _profiles[_currentProfile][1];\r\n                if (!_scheduledTimerId && !_flushCallbackTimerId && timeOut >= 0 && !_paused) {\r\n                    if (_hasEvents()) {\r\n                        _scheduledTimerId = _createTimer(function () {\r\n                            _scheduledTimerId = null;\r\n                            _sendEventsForLatencyAndAbove(_timerCount === 0 ? 3 /* EventLatencyValue.RealTime */ : 1 /* EventLatencyValue.Normal */, 0 /* EventSendType.Batched */, 1 /* SendRequestReason.NormalSchedule */);\r\n                            // Increment the count for next cycle\r\n                            _timerCount++;\r\n                            _timerCount %= 2;\r\n                            _scheduleTimer();\r\n                        }, timeOut);\r\n                    }\r\n                    else {\r\n                        _timerCount = 0;\r\n                    }\r\n                }\r\n            }\r\n            _self._backOffTransmission = function () {\r\n                if (_currentBackoffCount < MaxBackoffCount) {\r\n                    _currentBackoffCount++;\r\n                    _clearScheduledTimer();\r\n                    _scheduleTimer();\r\n                }\r\n            };\r\n            _self._clearBackOff = function () {\r\n                if (_currentBackoffCount) {\r\n                    _currentBackoffCount = 0;\r\n                    _clearScheduledTimer();\r\n                    _scheduleTimer();\r\n                }\r\n            };\r\n            function _initDefaults() {\r\n                _config = null;\r\n                _isTeardownCalled = false;\r\n                _flushCallbackQueue = [];\r\n                _flushCallbackTimerId = null;\r\n                _paused = false;\r\n                _immediateQueueSize = 0;\r\n                _immediateQueueSizeLimit = 500;\r\n                _queueSize = 0;\r\n                _queueSizeLimit = 10000;\r\n                _profiles = {};\r\n                _currentProfile = RT_PROFILE;\r\n                _scheduledTimerId = null;\r\n                _immediateTimerId = null;\r\n                _currentBackoffCount = 0;\r\n                _timerCount = 0;\r\n                _xhrOverride = null;\r\n                _batchQueues = {};\r\n                _autoFlushEventsLimit = undefined;\r\n                // either MaxBatchSize * (1+ Max Connections) or _queueLimit / 6 (where 3 latency Queues [normal, realtime, cost deferred] * 2 [allow half full -- allow for retry])\r\n                _autoFlushBatchLimit = 0;\r\n                _delayedBatchSendLatency = -1;\r\n                _delayedBatchReason = null;\r\n                _optimizeObject = true;\r\n                _isPageUnloadTriggered = false;\r\n                _maxEventSendAttempts = MaxSendAttempts;\r\n                _maxUnloadEventSendAttempts = MaxSyncUnloadSendAttempts;\r\n                _evtNamespace = null;\r\n                _timeoutWrapper = createTimeoutWrapper();\r\n                _httpManager = new HttpManager(MaxNumberEventPerBatch, MaxConnections, MaxRequestRetriesBeforeBackoff, {\r\n                    requeue: _requeueEvents,\r\n                    send: _sendingEvent,\r\n                    sent: _eventsSentEvent,\r\n                    drop: _eventsDropped,\r\n                    rspFail: _eventsResponseFail,\r\n                    oth: _otherEvent\r\n                }, _timeoutWrapper);\r\n                _initializeProfiles();\r\n                _clearQueues();\r\n                _setAutoLimits();\r\n            }\r\n            function _createTimer(theTimerFunc, timeOut) {\r\n                // If the transmission is backed off make the timer at least 1 sec to allow for back off.\r\n                if (timeOut === 0 && _currentBackoffCount) {\r\n                    timeOut = 1;\r\n                }\r\n                var timerMultiplier = 1000;\r\n                if (_currentBackoffCount) {\r\n                    timerMultiplier = retryPolicyGetMillisToBackoffForRetry(_currentBackoffCount - 1);\r\n                }\r\n                return _timeoutWrapper.set(theTimerFunc, timeOut * timerMultiplier);\r\n            }\r\n            function _clearScheduledTimer() {\r\n                if (_scheduledTimerId !== null) {\r\n                    _timeoutWrapper.clear(_scheduledTimerId);\r\n                    _scheduledTimerId = null;\r\n                    _timerCount = 0;\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            // Try to send all queued events using beacons if available\r\n            function _releaseAllQueues(sendType, sendReason) {\r\n                _clearScheduledTimer();\r\n                // Cancel all flush callbacks\r\n                if (_flushCallbackTimerId) {\r\n                    _timeoutWrapper.clear(_flushCallbackTimerId);\r\n                    _flushCallbackTimerId = null;\r\n                }\r\n                if (!_paused) {\r\n                    // Queue all the remaining requests to be sent. The requests will be sent using HTML5 Beacons if they are available.\r\n                    _sendEventsForLatencyAndAbove(1 /* EventLatencyValue.Normal */, sendType, sendReason);\r\n                }\r\n            }\r\n            /**\r\n             * Add empty queues for all latencies in the inbound queues map. This is called\r\n             * when Transmission Manager is being flushed. This ensures that new events added\r\n             * after flush are stored separately till we flush the current events.\r\n             */\r\n            function _clearQueues() {\r\n                _batchQueues[4 /* EventLatencyValue.Immediate */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n                _batchQueues[3 /* EventLatencyValue.RealTime */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n                _batchQueues[2 /* EventLatencyValue.CostDeferred */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n                _batchQueues[1 /* EventLatencyValue.Normal */] = {\r\n                    batches: [],\r\n                    iKeyMap: {}\r\n                };\r\n            }\r\n            function _getEventBatch(iKey, latency, create) {\r\n                var batchQueue = _batchQueues[latency];\r\n                if (!batchQueue) {\r\n                    latency = 1 /* EventLatencyValue.Normal */;\r\n                    batchQueue = _batchQueues[latency];\r\n                }\r\n                var eventBatch = batchQueue.iKeyMap[iKey];\r\n                if (!eventBatch && create) {\r\n                    eventBatch = EventBatch.create(iKey);\r\n                    batchQueue.batches.push(eventBatch);\r\n                    batchQueue.iKeyMap[iKey] = eventBatch;\r\n                }\r\n                return eventBatch;\r\n            }\r\n            function _performAutoFlush(isAsync, doFlush) {\r\n                // Only perform the auto flush check if the httpManager has an idle connection and we are not in a backoff situation\r\n                if (_httpManager.canSendRequest() && !_currentBackoffCount) {\r\n                    if (_autoFlushEventsLimit > 0 && _queueSize > _autoFlushEventsLimit) {\r\n                        // Force flushing\r\n                        doFlush = true;\r\n                    }\r\n                    if (doFlush && _flushCallbackTimerId == null) {\r\n                        // Auto flush the queue\r\n                        _self.flush(isAsync, null, 20 /* SendRequestReason.MaxQueuedEvents */);\r\n                    }\r\n                }\r\n            }\r\n            function _addEventToProperQueue(event, append) {\r\n                // v8 performance optimization for iterating over the keys\r\n                if (_optimizeObject) {\r\n                    event = optimizeObject(event);\r\n                }\r\n                var latency = event.latency;\r\n                var eventBatch = _getEventBatch(event.iKey, latency, true);\r\n                if (eventBatch.addEvent(event)) {\r\n                    if (latency !== 4 /* EventLatencyValue.Immediate */) {\r\n                        _queueSize++;\r\n                        // Check for auto flushing based on total events in the queue, but not for requeued or retry events\r\n                        if (append && event.sendAttempt === 0) {\r\n                            // Force the flushing of the batch if the batch (specific iKey / latency combination) reaches it's auto flush limit\r\n                            _performAutoFlush(!event.sync, _autoFlushBatchLimit > 0 && eventBatch.count() >= _autoFlushBatchLimit);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // Direct events don't need auto flushing as they are scheduled (by default) for immediate delivery\r\n                        _immediateQueueSize++;\r\n                    }\r\n                    return true;\r\n                }\r\n                return false;\r\n            }\r\n            function _dropEventWithLatencyOrLess(iKey, latency, currentLatency, dropNumber) {\r\n                while (currentLatency <= latency) {\r\n                    var eventBatch = _getEventBatch(iKey, latency, true);\r\n                    if (eventBatch && eventBatch.count() > 0) {\r\n                        // Dropped oldest events from lowest possible latency\r\n                        var droppedEvents = eventBatch.split(0, dropNumber);\r\n                        var droppedCount = droppedEvents.count();\r\n                        if (droppedCount > 0) {\r\n                            if (currentLatency === 4 /* EventLatencyValue.Immediate */) {\r\n                                _immediateQueueSize -= droppedCount;\r\n                            }\r\n                            else {\r\n                                _queueSize -= droppedCount;\r\n                            }\r\n                            _notifyBatchEvents(strEventsDiscarded, [droppedEvents], EventsDiscardedReason.QueueFull);\r\n                            return true;\r\n                        }\r\n                    }\r\n                    currentLatency++;\r\n                }\r\n                // Unable to drop any events -- lets just make sure the queue counts are correct to avoid exhaustion\r\n                _resetQueueCounts();\r\n                return false;\r\n            }\r\n            /**\r\n             * Internal helper to reset the queue counts, used as a backstop to avoid future queue exhaustion errors\r\n             * that might occur because of counting issues.\r\n             */\r\n            function _resetQueueCounts() {\r\n                var immediateQueue = 0;\r\n                var normalQueue = 0;\r\n                var _loop_1 = function (latency) {\r\n                    var batchQueue = _batchQueues[latency];\r\n                    if (batchQueue && batchQueue.batches) {\r\n                        arrForEach(batchQueue.batches, function (theBatch) {\r\n                            if (latency === 4 /* EventLatencyValue.Immediate */) {\r\n                                immediateQueue += theBatch.count();\r\n                            }\r\n                            else {\r\n                                normalQueue += theBatch.count();\r\n                            }\r\n                        });\r\n                    }\r\n                };\r\n                for (var latency = 1 /* EventLatencyValue.Normal */; latency <= 4 /* EventLatencyValue.Immediate */; latency++) {\r\n                    _loop_1(latency);\r\n                }\r\n                _queueSize = normalQueue;\r\n                _immediateQueueSize = immediateQueue;\r\n            }\r\n            function _queueBatches(latency, sendType, sendReason) {\r\n                var eventsQueued = false;\r\n                var isAsync = sendType === 0 /* EventSendType.Batched */;\r\n                // Only queue batches (to the HttpManager) if this is a sync request or the httpManager has an idle connection\r\n                // Thus keeping the events within the PostChannel until the HttpManager has a connection available\r\n                // This is so we can drop \"old\" events if the queue is getting full because we can't successfully send events\r\n                if (!isAsync || _httpManager.canSendRequest()) {\r\n                    doPerf(_self.core, function () { return \"PostChannel._queueBatches\"; }, function () {\r\n                        var droppedEvents = [];\r\n                        var latencyToProcess = 4 /* EventLatencyValue.Immediate */;\r\n                        while (latencyToProcess >= latency) {\r\n                            var batchQueue = _batchQueues[latencyToProcess];\r\n                            if (batchQueue && batchQueue.batches && batchQueue.batches.length > 0) {\r\n                                arrForEach(batchQueue.batches, function (theBatch) {\r\n                                    // Add the batch to the http manager to send the requests\r\n                                    if (!_httpManager.addBatch(theBatch)) {\r\n                                        // The events from this iKey are being dropped (killed)\r\n                                        droppedEvents = droppedEvents.concat(theBatch.events());\r\n                                    }\r\n                                    else {\r\n                                        eventsQueued = eventsQueued || (theBatch && theBatch.count() > 0);\r\n                                    }\r\n                                    if (latencyToProcess === 4 /* EventLatencyValue.Immediate */) {\r\n                                        _immediateQueueSize -= theBatch.count();\r\n                                    }\r\n                                    else {\r\n                                        _queueSize -= theBatch.count();\r\n                                    }\r\n                                });\r\n                                // Remove all batches from this Queue\r\n                                batchQueue.batches = [];\r\n                                batchQueue.iKeyMap = {};\r\n                            }\r\n                            latencyToProcess--;\r\n                        }\r\n                        if (droppedEvents.length > 0) {\r\n                            _notifyEvents(strEventsDiscarded, droppedEvents, EventsDiscardedReason.KillSwitch);\r\n                        }\r\n                        if (eventsQueued && _delayedBatchSendLatency >= latency) {\r\n                            // We have queued events at the same level as the delayed values so clear the setting\r\n                            _delayedBatchSendLatency = -1;\r\n                            _delayedBatchReason = 0 /* SendRequestReason.Undefined */;\r\n                        }\r\n                    }, function () { return ({ latency: latency, sendType: sendType, sendReason: sendReason }); }, !isAsync);\r\n                }\r\n                else {\r\n                    // remember the min latency so that we can re-trigger later\r\n                    _delayedBatchSendLatency = _delayedBatchSendLatency >= 0 ? Math.min(_delayedBatchSendLatency, latency) : latency;\r\n                    _delayedBatchReason = Math.max(_delayedBatchReason, sendReason);\r\n                }\r\n                return eventsQueued;\r\n            }\r\n            /**\r\n             * This is the callback method is called as part of the manual flushing process.\r\n             * @param callback\r\n             * @param sendReason\r\n             */\r\n            function _flushImpl(callback, sendReason) {\r\n                // Add any additional queued events and cause all queued events to be sent asynchronously\r\n                _sendEventsForLatencyAndAbove(1 /* EventLatencyValue.Normal */, 0 /* EventSendType.Batched */, sendReason);\r\n                // All events (should) have been queue -- lets just make sure the queue counts are correct to avoid queue exhaustion (previous bug #9685112)\r\n                _resetQueueCounts();\r\n                _waitForIdleManager(function () {\r\n                    // Only called AFTER the httpManager does not have any outstanding requests\r\n                    if (callback) {\r\n                        callback();\r\n                    }\r\n                    if (_flushCallbackQueue.length > 0) {\r\n                        _flushCallbackTimerId = _createTimer(function () {\r\n                            _flushCallbackTimerId = null;\r\n                            _flushImpl(_flushCallbackQueue.shift(), sendReason);\r\n                        }, 0);\r\n                    }\r\n                    else {\r\n                        // No more flush requests\r\n                        _flushCallbackTimerId = null;\r\n                        // Restart the normal timer schedule\r\n                        _scheduleTimer();\r\n                    }\r\n                });\r\n            }\r\n            function _waitForIdleManager(callback) {\r\n                if (_httpManager.isCompletelyIdle()) {\r\n                    callback();\r\n                }\r\n                else {\r\n                    _flushCallbackTimerId = _createTimer(function () {\r\n                        _flushCallbackTimerId = null;\r\n                        _waitForIdleManager(callback);\r\n                    }, FlushCheckTimer);\r\n                }\r\n            }\r\n            /**\r\n             * Resets the transmit profiles to the default profiles of Real Time, Near Real Time\r\n             * and Best Effort. This removes all the custom profiles that were loaded.\r\n             */\r\n            function _resetTransmitProfiles() {\r\n                _clearScheduledTimer();\r\n                _initializeProfiles();\r\n                _currentProfile = RT_PROFILE;\r\n                _scheduleTimer();\r\n            }\r\n            function _initializeProfiles() {\r\n                _profiles = {};\r\n                _profiles[RT_PROFILE] = [2, 1, 0];\r\n                _profiles[NRT_PROFILE] = [6, 3, 0];\r\n                _profiles[BE_PROFILE] = [18, 9, 0];\r\n            }\r\n            /**\r\n             * The notification handler for requeue events\r\n             * @ignore\r\n             */\r\n            function _requeueEvents(batches, reason) {\r\n                var droppedEvents = [];\r\n                var maxSendAttempts = _maxEventSendAttempts;\r\n                if (_isPageUnloadTriggered) {\r\n                    // If a page unlaod has been triggered reduce the number of times we try to \"retry\"\r\n                    maxSendAttempts = _maxUnloadEventSendAttempts;\r\n                }\r\n                arrForEach(batches, function (theBatch) {\r\n                    if (theBatch && theBatch.count() > 0) {\r\n                        arrForEach(theBatch.events(), function (theEvent) {\r\n                            if (theEvent) {\r\n                                // Check if the request being added back is for a sync event in which case mark it no longer a sync event\r\n                                if (theEvent.sync) {\r\n                                    theEvent.latency = 4 /* EventLatencyValue.Immediate */;\r\n                                    theEvent.sync = false;\r\n                                }\r\n                                if (theEvent.sendAttempt < maxSendAttempts) {\r\n                                    // Reset the event timings\r\n                                    setProcessTelemetryTimings(theEvent, _self.identifier);\r\n                                    _addEventToQueues(theEvent, false);\r\n                                }\r\n                                else {\r\n                                    droppedEvents.push(theEvent);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n                if (droppedEvents.length > 0) {\r\n                    _notifyEvents(strEventsDiscarded, droppedEvents, EventsDiscardedReason.NonRetryableStatus);\r\n                }\r\n                if (_isPageUnloadTriggered) {\r\n                    // Unload event has been received so we need to try and flush new events\r\n                    _releaseAllQueues(2 /* EventSendType.SendBeacon */, 2 /* SendRequestReason.Unload */);\r\n                }\r\n            }\r\n            function _callNotification(evtName, theArgs) {\r\n                var manager = (_self._notificationManager || {});\r\n                var notifyFunc = manager[evtName];\r\n                if (notifyFunc) {\r\n                    try {\r\n                        notifyFunc.apply(manager, theArgs);\r\n                    }\r\n                    catch (e) {\r\n                        _throwInternal(_self.diagLog(), 1 /* eLoggingSeverity.CRITICAL */, 74 /* _eInternalMessageId.NotificationException */, evtName + \" notification failed: \" + e);\r\n                    }\r\n                }\r\n            }\r\n            function _notifyEvents(evtName, theEvents) {\r\n                var extraArgs = [];\r\n                for (var _i = 2; _i < arguments.length; _i++) {\r\n                    extraArgs[_i - 2] = arguments[_i];\r\n                }\r\n                if (theEvents && theEvents.length > 0) {\r\n                    _callNotification(evtName, [theEvents].concat(extraArgs));\r\n                }\r\n            }\r\n            function _notifyBatchEvents(evtName, batches) {\r\n                var extraArgs = [];\r\n                for (var _i = 2; _i < arguments.length; _i++) {\r\n                    extraArgs[_i - 2] = arguments[_i];\r\n                }\r\n                if (batches && batches.length > 0) {\r\n                    arrForEach(batches, function (theBatch) {\r\n                        if (theBatch && theBatch.count() > 0) {\r\n                            _callNotification(evtName, [theBatch.events()].concat(extraArgs));\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            /**\r\n             * The notification handler for when batches are about to be sent\r\n             * @ignore\r\n             */\r\n            function _sendingEvent(batches, reason, isSyncRequest) {\r\n                if (batches && batches.length > 0) {\r\n                    _callNotification(\"eventsSendRequest\", [(reason >= 1000 /* EventBatchNotificationReason.SendingUndefined */ && reason <= 1999 /* EventBatchNotificationReason.SendingEventMax */ ?\r\n                            reason - 1000 /* EventBatchNotificationReason.SendingUndefined */ :\r\n                            0 /* SendRequestReason.Undefined */), isSyncRequest !== true]);\r\n                }\r\n            }\r\n            /**\r\n             * This event represents that a batch of events have been successfully sent and a response received\r\n             * @param batches The notification handler for when the batches have been successfully sent\r\n             * @param reason For this event the reason will always be EventBatchNotificationReason.Complete\r\n             */\r\n            function _eventsSentEvent(batches, reason) {\r\n                _notifyBatchEvents(\"eventsSent\", batches, reason);\r\n                // Try and schedule the processing timer if we have events\r\n                _scheduleTimer();\r\n            }\r\n            function _eventsDropped(batches, reason) {\r\n                _notifyBatchEvents(strEventsDiscarded, batches, (reason >= 8000 /* EventBatchNotificationReason.EventsDropped */ && reason <= 8999 /* EventBatchNotificationReason.EventsDroppedMax */ ?\r\n                    reason - 8000 /* EventBatchNotificationReason.EventsDropped */ :\r\n                    EventsDiscardedReason.Unknown));\r\n            }\r\n            function _eventsResponseFail(batches) {\r\n                _notifyBatchEvents(strEventsDiscarded, batches, EventsDiscardedReason.NonRetryableStatus);\r\n                // Try and schedule the processing timer if we have events\r\n                _scheduleTimer();\r\n            }\r\n            function _otherEvent(batches, reason) {\r\n                _notifyBatchEvents(strEventsDiscarded, batches, EventsDiscardedReason.Unknown);\r\n                // Try and schedule the processing timer if we have events\r\n                _scheduleTimer();\r\n            }\r\n            function _setAutoLimits() {\r\n                if (!_config || !_config.disableAutoBatchFlushLimit) {\r\n                    _autoFlushBatchLimit = Math.max(MaxNumberEventPerBatch * (MaxConnections + 1), _queueSizeLimit / 6);\r\n                }\r\n                else {\r\n                    _autoFlushBatchLimit = 0;\r\n                }\r\n            }\r\n            // Provided for backward compatibility they are not \"expected\" to be in current use but they are public\r\n            objDefineAccessors(_self, \"_setTimeoutOverride\", function () { return _timeoutWrapper.set; }, function (value) {\r\n                // Recreate the timeout wrapper\r\n                _timeoutWrapper = createTimeoutWrapper(value, _timeoutWrapper.clear);\r\n            });\r\n            objDefineAccessors(_self, \"_clearTimeoutOverride\", function () { return _timeoutWrapper.clear; }, function (value) {\r\n                // Recreate the timeout wrapper\r\n                _timeoutWrapper = createTimeoutWrapper(_timeoutWrapper.set, value);\r\n            });\r\n        });\r\n        return _this;\r\n    }\r\n    /**\r\n     * Start the queue manager to batch and send events via post.\r\n     * @param config - The core configuration.\r\n     */\r\n    PostChannel.prototype.initialize = function (coreConfig, core, extensions) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Add an event to the appropriate inbound queue based on its latency.\r\n     * @param ev - The event to be added to the queue.\r\n     * @param itemCtx - This is the context for the current request, ITelemetryPlugin instances\r\n     * can optionally use this to access the current core instance or define / pass additional information\r\n     * to later plugins (vs appending items to the telemetry item)\r\n     */\r\n    PostChannel.prototype.processTelemetry = function (ev, itemCtx) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Sets the event queue limits at runtime (after initialization), if the number of queued events is greater than the\r\n     * eventLimit or autoFlushLimit then a flush() operation will be scheduled.\r\n     * @param eventLimit The number of events that can be kept in memory before the SDK starts to drop events. If the value passed is less than or\r\n     * equal to zero the value will be reset to the default (10,000).\r\n     * @param autoFlushLimit When defined, once this number of events has been queued the system perform a flush() to send the queued events\r\n     * without waiting for the normal schedule timers. Passing undefined, null or a value less than or equal to zero will disable the auto flush.\r\n     */\r\n    PostChannel.prototype.setEventQueueLimits = function (eventLimit, autoFlushLimit) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Pause the transmission of any requests\r\n     */\r\n    PostChannel.prototype.pause = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Resumes transmission of events.\r\n     */\r\n    PostChannel.prototype.resume = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n    * Add handler to be executed with request response text.\r\n    */\r\n    PostChannel.prototype.addResponseHandler = function (responseHanlder) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Flush to send data immediately; channel should default to sending data asynchronously\r\n     * @param async - send data asynchronously when true\r\n     * @param callback - if specified, notify caller when send is complete\r\n     */\r\n    PostChannel.prototype.flush = function (async, callback, sendReason) {\r\n        if (async === void 0) { async = true; }\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Set AuthMsaDeviceTicket header\r\n     * @param ticket - Ticket value.\r\n     */\r\n    PostChannel.prototype.setMsaAuthTicket = function (ticket) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Check if there are any events waiting to be scheduled for sending.\r\n     * @returns True if there are events, false otherwise.\r\n     */\r\n    PostChannel.prototype.hasEvents = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n        return false;\r\n    };\r\n    /**\r\n     * Load custom transmission profiles. Each profile should have timers for real time, and normal and can\r\n     * optionally specify the immediate latency time in ms (defaults to 0 when not defined). Each profile should\r\n     * make sure that a each normal latency timer is a multiple of the real-time latency and the immediate\r\n     * is smaller than the real-time.\r\n     * Setting the timer value to -1 means that the events for that latency will not be scheduled to be sent.\r\n     * Note that once a latency has been set to not send, all latencies below it will also not be sent. The\r\n     * timers should be in the form of [normal, high, [immediate]].\r\n     * e.g Custom:\r\n     * [10,5] - Sets the normal latency time to 10 seconds and real-time to 5 seconds; Immediate will default to 0ms\r\n     * [10,5,1] - Sets the normal latency time to 10 seconds and real-time to 5 seconds; Immediate will default to 1ms\r\n     * [10,5,0] - Sets the normal latency time to 10 seconds and real-time to 5 seconds; Immediate will default to 0ms\r\n     * [10,5,-1] - Sets the normal latency time to 10 seconds and real-time to 5 seconds; Immediate events will not be\r\n     * scheduled on their own and but they will be included with real-time or normal events as the first events in a batch.\r\n     * This also removes any previously loaded custom profiles.\r\n     * @param profiles - A dictionary containing the transmit profiles.\r\n     */\r\n    PostChannel.prototype._loadTransmitProfiles = function (profiles) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Set the transmit profile to be used. This will change the transmission timers\r\n     * based on the transmit profile.\r\n     * @param profileName - The name of the transmit profile to be used.\r\n     */\r\n    PostChannel.prototype._setTransmitProfile = function (profileName) {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Backs off transmission. This exponentially increases all the timers.\r\n     */\r\n    PostChannel.prototype._backOffTransmission = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    /**\r\n     * Clears backoff for transmission.\r\n     */\r\n    PostChannel.prototype._clearBackOff = function () {\r\n        // @DynamicProtoStub - DO NOT add any code as this will be removed during packaging\r\n    };\r\n    return PostChannel;\r\n}(BaseTelemetryPlugin));\r\nexport default PostChannel;\r\n//# sourceMappingURL=PostChannel.js.map", "import { IPerfEvent, IPerfManager } from '@microsoft/1ds-core-js';\r\nimport { getCurrentMilliseconds } from '@microsoft/oteljs';\r\nimport { IStatsCallbacks } from './DataModels';\r\n\r\n// For the duration and number of events.\r\nconst SEND_BATCHES_EVENT = 'HttpManager:_sendBatches';\r\n// For the time taken by privacy guard to process the event.\r\nconst PRIVACY_GUARD_PROCESSING_TIME_EVENT = 'PrivacyGuard:_processTelemetry';\r\n\r\nexport class PerfEvent implements IPerfEvent {\r\n  /**\r\n   * The name of the event\r\n   */\r\n  name: string;\r\n\r\n  /**\r\n   * The start time of the event in ms\r\n   */\r\n  start: number;\r\n\r\n  /**\r\n   * The included payload of the event\r\n   */\r\n  payload: any;\r\n\r\n  isAsync: boolean;\r\n\r\n  /**\r\n   * Identifies the total time spent for this event, including the time spent for child events\r\n   */\r\n  time?: number;\r\n\r\n  /**\r\n   * Identifies the exclusive time spent in for this event (not including child events)\r\n   */\r\n  exTime?: number;\r\n\r\n  /**\r\n   * Identifies whether this event is a child event of a parent\r\n   */\r\n  isChildEvt(): boolean {\r\n    return false;\r\n  }\r\n\r\n  constructor(name: string, payload: any, isAsync?: boolean) {\r\n    this.start = getCurrentMilliseconds();\r\n    this.name = name;\r\n    this.isAsync = isAsync === true ? true : false;\r\n    this.payload = payload;\r\n  }\r\n\r\n  complete(): void {\r\n    this.time = getCurrentMilliseconds() - this.start;\r\n    this.exTime = this.time;\r\n  }\r\n}\r\n\r\nexport class PerfManager implements IPerfManager {\r\n  private _callbacks: IStatsCallbacks;\r\n\r\n  constructor(callbacks: IStatsCallbacks) {\r\n    this._callbacks = callbacks;\r\n  }\r\n\r\n  create(src: string, payload?: any, isAsync?: boolean): IPerfEvent {\r\n    if (src === SEND_BATCHES_EVENT || src === PRIVACY_GUARD_PROCESSING_TIME_EVENT) {\r\n      let evt: IPerfEvent = new PerfEvent(src, payload, isAsync);\r\n\r\n      return evt;\r\n    }\r\n    return null as any as IPerfEvent;\r\n  }\r\n\r\n  fire(perfEvent: IPerfEvent) {\r\n    if (perfEvent) {\r\n      perfEvent.complete();\r\n    }\r\n\r\n    if (this._callbacks) {\r\n      switch (perfEvent.name) {\r\n        case SEND_BATCHES_EVENT:\r\n          this.handleSendBatches(perfEvent);\r\n          break;\r\n        case PRIVACY_GUARD_PROCESSING_TIME_EVENT:\r\n          this.handlePrivacyGuardNotification(perfEvent);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  setCtx(_key: string, _value: any): void {}\r\n\r\n  getCtx(_key: string): any {}\r\n\r\n  handleSendBatches(perfEvent: IPerfEvent) {\r\n    if (this._callbacks.requestProcessingStats) {\r\n      let eventCount = 0;\r\n      if (perfEvent.payload) {\r\n        let payload = perfEvent.payload();\r\n        if (payload.batches) {\r\n          for (let index in payload.batches) {\r\n            eventCount += payload.batches[index].evts.length;\r\n          }\r\n        }\r\n      }\r\n      this._callbacks.requestProcessingStats(perfEvent.time || 0, eventCount);\r\n    }\r\n  }\r\n\r\n  handlePrivacyGuardNotification(perfEvent: IPerfEvent) {\r\n    if (this._callbacks.privacyGuardStats && perfEvent.time && perfEvent.time > 0) {\r\n      this._callbacks.privacyGuardStats(perfEvent.time);\r\n    }\r\n  }\r\n}\r\n", "import { AppInsightsCore, IPlugin, IExtendedConfiguration as IInternalConfiguration, EventsDiscardedReason } from '@microsoft/1ds-core-js';\r\nimport { PostChannel, IChannelConfiguration } from '@microsoft/1ds-post-js';\r\nimport { Category, LogLevel, logNotification } from '@microsoft/oteljs';\r\nimport { OneDSSinkProperties } from './DataModels';\r\nimport { OneDSSink } from './OneDSSink';\r\nimport { PerfManager } from './PerfManager';\r\n\r\n/**\r\n * The IExtendedConfiguration interface holds the configuration details passed to core during initialize.\r\n */\r\nexport interface IExtendedConfiguration extends IInternalConfiguration {\r\n  /**\r\n   * [Optional] Configuration for the Post Channel to the OneCollector.\r\n   */\r\n  channelConfiguration?: IChannelConfiguration;\r\n}\r\n\r\nexport function getAppInsights(oneDSSinkProperties: OneDSSinkProperties, instrumentationKey: string) {\r\n  const httpXHROverride = oneDSSinkProperties.httpXHROverride;\r\n  const appInsightsConfig: IExtendedConfiguration = {\r\n    instrumentationKey,\r\n    endpointUrl: oneDSSinkProperties.endpointUrl,\r\n    channelConfiguration: {\r\n      eventsLimitInMem: oneDSSinkProperties.eventsLimitInMem,\r\n      httpXHROverride,\r\n      autoFlushEventsLimit: oneDSSinkProperties.autoFlushEventsLimit,\r\n      setTimeoutOverride: oneDSSinkProperties.setTimeoutOverride,\r\n      clearTimeoutOverride: oneDSSinkProperties.clearTimeoutOverride,\r\n      ignoreMc1Ms0CookieProcessing: true,\r\n      // 1ds-post-js in 3.1.x adds some optimization code that purportedly improves overall performance, but\r\n      // in our testing regresses synchronous API performance. Disabling it here.\r\n      disableOptimizeObj: true\r\n    },\r\n    // Force a \"w\" parameter on the URL string, which tells the Collector that this is a web request and that it\r\n    // should parse the user agent string to determine the browser name and version\r\n    // In the URL string, this looks like \"&w=2\"\r\n    //   (the presence of a \"w\" string indicates it's a web request, and \"2\" means disable cookies)\r\n    // The 1DS SDK generally automatically sets the \"w\" parameter when it detects the active document (i.e. webpage),\r\n    // but in the web worker it doesn't have access to the document, so we have to force it.\r\n    // As a good heuristic, we are probably in a web environment (i.e. not Node.js) if we didn't have to override XHR.\r\n    // This should be sufficient for our purposes, and covers the web worker scenario.\r\n    enableWParam: !httpXHROverride,\r\n    // Sets the value of the \"w\" parameter to 2, which means \"disable cookies\"\r\n    disableCookiesUsage: true,\r\n    extensionConfig: { ...oneDSSinkProperties.extensionConfig }\r\n  };\r\n\r\n  if (oneDSSinkProperties.stats && oneDSSinkProperties.stats.networkStats && appInsightsConfig.channelConfiguration) {\r\n    appInsightsConfig.channelConfiguration.payloadListener = (originalPayload, modifiedPayload) => {\r\n      const actualPayload = modifiedPayload ? modifiedPayload : originalPayload;\r\n      if (actualPayload.data) {\r\n        oneDSSinkProperties.stats?.networkStats(actualPayload.data.length);\r\n      }\r\n    };\r\n  }\r\n\r\n  const applicationInsights = new ApplicationInsights();\r\n  applicationInsights.initialize(appInsightsConfig, oneDSSinkProperties.plugins);\r\n  applicationInsights.setUploadFrequency(oneDSSinkProperties.uploadFrequency);\r\n  if (oneDSSinkProperties.notificationListener) {\r\n    applicationInsights.addNotificationListener(oneDSSinkProperties.notificationListener);\r\n  }\r\n  if (oneDSSinkProperties.stats) {\r\n    applicationInsights.setPerfMgr(new PerfManager(oneDSSinkProperties.stats));\r\n  }\r\n  return applicationInsights;\r\n}\r\n\r\nexport const hookUp1DSNotifications = (oneDSSink: OneDSSink, applicationInsights?: ApplicationInsights) => {\r\n  if (applicationInsights) {\r\n    applicationInsights.addNotificationListener({\r\n      eventsSent: events => {\r\n        logNotification(LogLevel.Info, Category.Transport, () => {\r\n          return `Successfully sent ${events.length} event(s)`;\r\n        });\r\n        logNotification(LogLevel.Verbose, Category.Transport, () => {\r\n          return `Sent event(s) details : ${JSON.stringify(events, null, 2)}`;\r\n        });\r\n        oneDSSink.eventsSent += events.length;\r\n      },\r\n      eventsDiscarded: (events, reason: EventsDiscardedReason) => {\r\n        logNotification(LogLevel.Error, Category.Transport, () => {\r\n          return `Discarded ${events.length} event(s) because ${EventsDiscardedReason[reason] || reason}`;\r\n        });\r\n        logNotification(LogLevel.Verbose, Category.Transport, () => {\r\n          return `Discarded event(s) details : ${JSON.stringify(events, null, 2)}`;\r\n        });\r\n        oneDSSink.eventsDiscarded += events.length;\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\nexport class ApplicationInsights extends AppInsightsCore {\r\n  private _postChannel?: PostChannel;\r\n\r\n  /**\r\n   * Initialize the sdk.\r\n   * @param {IExtendedConfiguration} config - The configuration to initialize the SDK.\r\n   * @param {IPlugin[]} extensions          - An array of extensions that are to be used by the core.\r\n   */\r\n  initialize(config: IExtendedConfiguration, extensions?: IPlugin[]): void {\r\n    this._postChannel = new PostChannel();\r\n    let plugins: IPlugin[] = extensions ?? [];\r\n    config.channels = [[this._postChannel]];\r\n    config.extensionConfig = config.extensionConfig || [];\r\n    config.extensionConfig[this._postChannel.identifier] = {\r\n      // The explicitly set extension config passed from the caller has priority over\r\n      // the computed config.channelConfiguration\r\n      ...config.channelConfiguration,\r\n      ...config.extensionConfig[this._postChannel.identifier]\r\n    };\r\n\r\n    try {\r\n      super.initialize(config, plugins);\r\n    } catch (error) {\r\n      this.logger.warnToConsole('Failed to initialize SDK.' + error);\r\n    }\r\n  }\r\n\r\n  setUploadFrequency(uploadFrequency?: number) {\r\n    if (!this._postChannel || !uploadFrequency) {\r\n      return;\r\n    }\r\n\r\n    // OneDS SDK allows to specify \"Latency\" of the event (think priority). At the moment the SDK supports two meaningful latencies\r\n    // (three if you look at the enum definition, but the third one is not used) - EventLatency.Normal (default) and EventLatency.RealTime.\r\n    // The idea here is to upload events with RealTime latency at a higher frequency than the events with Normal latency. To determine the\r\n    // upload frequency for the event, OneDS uses the \"concept\" of transmission profile. A transmission profile is simply a name that is\r\n    // associated with an array of two numbers - { 'Name' = [Normal, RealTime] }. OneDS documentation specifies that each latency timer\r\n    // needs to be a multiple of the latency higher than it - more on this later.\r\n    // There are three built in profiles:\r\n    //  - RT_PROFILE     = [2, 1]; (default)\r\n    //  - NRT_PROFILE    = [6, 3];\r\n    //  - BE_PROFILE     = [18, 9];\r\n    // Now here is the fun part, only the RealTime latency frequency is used in the code - the code simply doubles the RealTime latency\r\n    //  frequency and uses it for Normal latency frequency - i.e. Normal = RealTime * 2 (see PostChannel._batchAndSendEvents for details).\r\n    // OTel SDK does not expose RealTime latency and uses the default Normal one. So the upload frequency that we are interested here is\r\n    // the Normal one, and to keep things sane for the consumers of the SDK that's what the uploadFrequency parameter will be mapped to.\r\n    let normalLatencyFrequency = uploadFrequency / 1000;\r\n    let realtimeLatencyFrequency = normalLatencyFrequency / 2;\r\n\r\n    let customProfiles: { [profileName: string]: number[] } = {};\r\n    customProfiles['OTelCustomTransmissionProfile'] = [normalLatencyFrequency, realtimeLatencyFrequency];\r\n\r\n    this._postChannel._loadTransmitProfiles(customProfiles);\r\n    this._postChannel._setTransmitProfile('OTelCustomTransmissionProfile');\r\n  }\r\n\r\n  public flush(async: boolean) {\r\n    if (this._postChannel) {\r\n      this._postChannel.flush(async);\r\n    }\r\n  }\r\n\r\n  public shutdown() {\r\n    if (this._postChannel) {\r\n      this._postChannel.teardown();\r\n    }\r\n  }\r\n}\r\n", "import {\r\n  TelemetryEvent,\r\n  TelemetrySink,\r\n  DataField,\r\n  EventType,\r\n  LogLevel,\r\n  Category,\r\n  logNotification,\r\n  FilledTelemetryEvent\r\n} from '@microsoft/oteljs';\r\nimport { ARIA_OFFICE_TELEMETRY_TOKEN, tryCatch, voidValue } from './InternalUtils';\r\nimport { IExtendedTelemetryItem, INotificationListener, ITelemetryItem } from '@microsoft/1ds-core-js';\r\nimport { IXHROverride } from '@microsoft/1ds-post-js';\r\nimport { OneDSSinkProperties, IEventHandler } from './DataModels';\r\nimport { OneDSHelper } from './OneDSHelper';\r\nimport { ApplicationInsights, getAppInsights, hookUp1DSNotifications } from './ApplicationInsights';\r\n\r\n// Indirect type dependencies of OneDSSinkProperties\r\nexport { INotificationListener, ITelemetryItem, IXHROverride };\r\n\r\n/**\r\n * OTelJS 1DS Sink sends telemetry using the Web 1DS sdk\r\n */\r\nexport class OneDSSink extends OneDSHelper implements TelemetrySink {\r\n  private static instanceCounter: number = 0;\r\n  public readonly instanceId: number;\r\n\r\n  /**\r\n   * Constructs an 1DS Sink\r\n   * @param persistentDataFields - Data fields to be sent with every event; these data fields are assumed to\r\n   * be top-level static fields, and will not be prepended with \"Data.\"\r\n   * @param oneDSSinkProperties - Properties on the sinks\r\n   */\r\n  constructor(persistentDataFields: DataField[], oneDSSinkProperties: OneDSSinkProperties) {\r\n    super(persistentDataFields, oneDSSinkProperties);\r\n    this.instanceId = ++OneDSSink.instanceCounter;\r\n\r\n    // #region Private variables\r\n    let _applicationInsights: ApplicationInsights | undefined;\r\n\r\n    // #endregion\r\n\r\n    // #region Public functions\r\n    this.sendTelemetryEvent = (telemetryEvent: TelemetryEvent) => {\r\n      return tryCatch(() => {\r\n        const event = this.getOneDSTelemetryEvent(telemetryEvent);\r\n        if (event && _applicationInsights) {\r\n          _applicationInsights.track(event);\r\n        }\r\n      }, voidValue);\r\n    };\r\n\r\n    this.sendOneDSTelemetryEvent = (telemetryEvent: IExtendedTelemetryItem | ITelemetryItem) => {\r\n      return tryCatch(() => {\r\n        _applicationInsights?.track(telemetryEvent);\r\n      }, voidValue);\r\n    };\r\n\r\n    this.sendCustomerContent = (_customerContentEvent: TelemetryEvent) => {\r\n      return undefined;\r\n    };\r\n\r\n    this.sendNonStandardEvent = (telemetryEvent: FilledTelemetryEvent, eventType: EventType) => {\r\n      let isHandled: boolean = false;\r\n      nonStandardEventHandlers.forEach(handler => {\r\n        if (handler.canHandle(eventType)) {\r\n          handler.processEvent(telemetryEvent);\r\n          isHandled = true;\r\n        }\r\n      });\r\n\r\n      if (!isHandled) {\r\n        logNotification(LogLevel.Error, Category.Sink, () => 'Missing Handler for ' + eventType + 'to process' + telemetryEvent.eventName);\r\n      }\r\n    };\r\n\r\n    this.flush = (async: boolean) => {\r\n      _applicationInsights?.flush(async);\r\n\r\n      nonStandardEventHandlers.forEach(handler => {\r\n        handler.flush(async);\r\n      });\r\n    };\r\n\r\n    this.shutdown = () => {\r\n      try {\r\n        _applicationInsights?.shutdown();\r\n\r\n        nonStandardEventHandlers.forEach(handler => {\r\n          handler.shutdown();\r\n        });\r\n      } catch (e) {\r\n        logNotification(LogLevel.Error, Category.Transport, () => 'An error occurred on shutdown');\r\n      }\r\n    };\r\n    // #endregion\r\n\r\n    // #region Actual constructor stuff\r\n    const nonStandardEventHandlers: IEventHandler[] = oneDSSinkProperties.nonStandardEventHandlers || [];\r\n\r\n    _applicationInsights = getAppInsights(oneDSSinkProperties, ARIA_OFFICE_TELEMETRY_TOKEN);\r\n\r\n    // Initialize each special event handler\r\n    nonStandardEventHandlers.forEach(handler => {\r\n      handler.initialize(this, oneDSSinkProperties);\r\n    });\r\n\r\n    if (!oneDSSinkProperties.endpointUrl) {\r\n      throw new Error('Missing Endpoint Url');\r\n    }\r\n\r\n    if (!oneDSSinkProperties.disableStatsTracking) {\r\n      hookUp1DSNotifications(this, _applicationInsights);\r\n    }\r\n\r\n    // #endregion\r\n  }\r\n\r\n  /**\r\n   * Preprocess and send telemetry using the 1DS Sink\r\n   * @param telemetryEvent - The telemetry event to be sent\r\n   */\r\n  sendTelemetryEvent: (telemetryEvent: TelemetryEvent) => void;\r\n\r\n  /**\r\n   * Send telemetry using the 1DS Sink\r\n   * @param telemetryEvent - The telemetry event to be sent\r\n   */\r\n  sendOneDSTelemetryEvent: (telemetryEvent: IExtendedTelemetryItem | ITelemetryItem) => void;\r\n\r\n  /**\r\n   * Preprocess and send customer content using the 1DS Sink.\r\n   * @deprecated Use sendNonStandardEvent instead.\r\n   * @param customerContentEvent - The telemetry event to be sent\r\n   */\r\n  sendCustomerContent: (customerContentEvent: TelemetryEvent) => void;\r\n\r\n  /**\r\n   * Preprocess and sends non-standard telemetry events using the 1DS Sink\r\n   * @param telemetryEvent - the telemetry event to be sent\r\n   * @package eventType - The type of special event to be processed and sent\r\n   */\r\n  sendNonStandardEvent: (telemetryEvent: FilledTelemetryEvent, eventType: EventType) => void;\r\n\r\n  /**\r\n   * Notifies the sink to flush the events.\r\n   * @param async - Determines whether the operation is synchrounous or asynchrounous\r\n   */\r\n  flush: (async: boolean) => void;\r\n\r\n  /**\r\n   * Notifies the sink to send all outstanding events and shutdown.\r\n   */\r\n  shutdown: () => void;\r\n}\r\n", "import { TelemetrySink, DataField, FilledTelemetryEvent, User, App, Session } from \"@microsoft/oteljs\";\r\nimport { OneDSSink, OneDSEndpoint } from '@microsoft/oteljs-1ds';\r\n\r\nexport class TelemetrySinkProvider {\r\n\r\n    private sink: TelemetrySink;\r\n\r\n    // This is the callback that the Floodgate SDK will call to get the TelemetrySink.\r\n    public getTelemetrySink(): TelemetrySink {\r\n\r\n        if (!this.sink) {\r\n            // this.sink = this.createSink(); // Note to partners: Use this as the reference for your implementation.\r\n            this.sink = this.createMockConsoleSink(); // Note to partners: ignore this mock sink, it's only for testing this sample app.\r\n        }\r\n\r\n        return this.sink;\r\n    }\r\n\r\n    // daespino note: Create an Otel TelemetrySink to pass it to the FG SDK so it can be attached to the SDK's internal logger.\r\n    // Reference this wiki page for OneDSSink creation, the TelemetryLogger is not needed because FG SDK implements it internally:  https://www.owiki.ms/wiki/Telemetry/OTelJS#1DS_sink\r\n    private createSink(isEUDBUser: boolean = false): TelemetrySink {\r\n\r\n        // Setting the required persistent data fields. Host sets User, App and Session fields for themselves.\r\n        let persistentDataFields: DataField[] = [\r\n            ...User.getFields({\r\n                // Required if applicable\r\n                primaryIdentityHash: \"11111111-2222-2222-2222-333333333333\", // should be a real GUID or identifier\r\n                primaryIdentitySpace: 'UserObjectId', // UserObjectId, MSACID, OrgIdPuid, OrgIdCID, MsaPuid, WopiAuth, or ThirdParty,\r\n                tenantId: \"33333333-2222-2222-2222-111111111111\", // should be a real GUID\r\n                isAnonymous: false,\r\n            }),\r\n            ...App.getFields({\r\n                name: \"Microsoft Fabric\",\r\n                platform: \"Web\",\r\n                version: \"42.42.43\",\r\n            }),\r\n            ...Session.getFields({\r\n                id: \"sampleSessionId\",\r\n            }),\r\n        ];\r\n\r\n        // For EUDB users, use OneDSEndpoint.EUDB. The host app has the context on which to use and has to set it appropriately.\r\n        const oneDsSink = isEUDBUser ?\r\n            new OneDSSink(persistentDataFields, { endpointUrl: OneDSEndpoint.EUDB } ) :\r\n            new OneDSSink(persistentDataFields, { endpointUrl: OneDSEndpoint.PUBLIC } );\r\n\r\n        return oneDsSink;\r\n    }\r\n\r\n    private createMockConsoleSink(): TelemetrySink {\r\n        return {\r\n            sendTelemetryEvent:  function sendTelemetryEvent(telemetryEvent: FilledTelemetryEvent, timestamp?: number) {\r\n\r\n                const eventId = telemetryEvent.dataFields.find((field) => field.name === 'EventId')?.value;\r\n                const message = telemetryEvent.dataFields.find((field) => field.name === 'Message')?.value;\r\n                const errorMessage = telemetryEvent.dataFields.find((field) => field.name === 'ErrorMessage')?.value;\r\n\r\n                const floodgateLogString = `FG LOG: EventId: ${eventId}, Message: ${message}, ErrorMessage: ${errorMessage}`;\r\n                console.log(floodgateLogString);\r\n            },\r\n\r\n        };\r\n    }\r\n\r\n}", null, null, null, "{\r\n    \"name\": \"@ms-ofb/officebrowserfeedback-ext-dynamic-campaign\",\r\n    \"version\": \"0.0.13\",\r\n    \"description\": \"Dynamic campaign fetching extension for Floodgate web sdk.\",\r\n    \"author\": \"Feedback/Floodgate Team\",\r\n    \"main\": \"dist/esm/index.js\",\r\n    \"types\": \"dist/esm/types/index.d.ts\",\r\n    \"repository\": {\r\n        \"type\": \"git\",\r\n        \"url\": \"https://office.visualstudio.com/CLE/_git/OfficeFeedback-Web\"\r\n    },\r\n    \"devDependencies\": {\r\n        \"@babel/core\": \"^7.19.6\",\r\n        \"@babel/preset-env\": \"^7.19.4\",\r\n        \"@babel/preset-typescript\": \"^7.18.6\",\r\n        \"@jsdevtools/coverage-istanbul-loader\": \"^3.0.5\",\r\n        \"@types/jasmine\": \"^4.3.0\",\r\n        \"@types/node\": \"^16.11.61\",\r\n        \"@typescript-eslint/eslint-plugin\": \"^5.38.0\",\r\n        \"@typescript-eslint/parser\": \"^5.38.0\",\r\n        \"babel-loader\": \"^9.0.0\",\r\n        \"eslint\": \"^8.23.1\",\r\n        \"gulp-nuget-pack\": \"^0.1.0\",\r\n        \"husky\": \"^8.0.1\",\r\n        \"jasmine-core\": \"^4.4.0\",\r\n        \"karma\": \"^6.4.1\",\r\n        \"karma-chrome-launcher\": \"^3.1.1\",\r\n        \"karma-cli\": \"^2.0.0\",\r\n        \"karma-coverage\": \"^2.2.0\",\r\n        \"karma-jasmine\": \"^5.1.0\",\r\n        \"karma-junit-reporter\": \"^2.0.1\",\r\n        \"karma-spec-reporter\": \"^0.0.34\",\r\n        \"karma-webpack\": \"^5.0.0\",\r\n        \"source-map-loader\": \"^4.0.1\",\r\n        \"terser-webpack-plugin\": \"^5.3.6\",\r\n        \"ts-node\": \"^10.9.1\",\r\n        \"typescript\": \"^4.5\",\r\n        \"webpack\": \"^5.74.0\",\r\n        \"webpack-cli\": \"^4.10.0\",\r\n        \"webpack-merge\": \"^5.8.0\",\r\n        \"webpackbar\": \"^5.0.2\"\r\n    },\r\n    \"dependencies\": {\r\n        \"@ms-ofb/floodgate-shared-typings\": \"^1.0.26\",\r\n        \"@skype/ecsclient\": \"^2.2.1\",\r\n        \"core-js\": \"^3.33.0\",\r\n        \"subscribableevent\": \"^1.0.1\",\r\n        \"synctasks\": \"^0.3.3\"\r\n    },\r\n    \"scripts\": {\r\n        \"build\": \"tsc & webpack -c ./webpack/webpack.prod.config.js\",\r\n        \"build-dev\": \"tsc & webpack -c ./webpack/webpack.dev.config.js\",\r\n        \"build-esm\": \"tsc\",\r\n        \"build-js-bundle\": \"webpack -c ./webpack/webpack.prod.config.js\",\r\n        \"lint\": \"eslint --ext .ts .\",\r\n        \"prepare\": \"cd ../.. & husky install .githooks/husky\",\r\n        \"test\": \"karma start './karma.conf.js'\"\r\n    }\r\n}\r\n", null, null, "/**\r\n * App_Floodgate.ts\r\n *\r\n * The entry point for floodgate.\r\n */\r\n\r\nimport { DynamicUxClientState, IFloodgateSettingIdMap, ISurvey, ISurveyForm, RoamingSettingIdMap } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { TelemetryLogger } from \"@ms-ofb/officefloodgatecore\";\r\nimport { setDynamicUxSchemaVariables } from \"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider\";\r\nimport { TelemetryEvent } from \"@ms-ofb/officefloodgatecore/dist/src/Constants\";\r\nimport { renderCVSurvey } from \"gatecrash\";\r\nimport * as CommonApp from \"./CommonApp\";\r\nimport * as CommonFloodgate from \"./CommonFloodgate\";\r\nimport * as CommonUI from \"./CommonUI\";\r\nimport * as Configuration from \"./Configuration/Configuration\";\r\nimport { customerVoiceLauncherType } from \"./Constants\";\r\nimport FloodgateTelemetryLogger from \"./FloodgateCore/FloodgateTelemetryLogger\";\r\nimport ICustomSurvey from \"./FloodgateCore/ICustomSurvey\";\r\nimport CustomUISurvey from \"./FloodgateCore/UISurvey/CustomUISurvey\";\r\nimport DummyUISurvey from \"./FloodgateCore/UISurvey/DummyUISurvey\";\r\nimport IUISurvey from \"./FloodgateCore/UISurvey/IUISurvey\";\r\nimport UISurvey from \"./FloodgateCore/UISurvey/UISurvey\";\r\nimport { IHandleSurveyEvent } from \"./IHandleSurveyEvent\";\r\nimport { IOverrideRenderCallback } from \"./IOverrideRenderCallback\";\r\nimport { IContextParams, IRenderSurvey, ISurveyOptionalConfigParams, ISurveyRenderContext, IURLParams } from \"./IRenderSurvey\";\r\nimport * as Logging from \"./Logging/Logging\";\r\nimport * as DynamicUxClient from \"./UI/DynamicUx/DynamicUxClient\";\r\nimport { handleSurveyEvent, updateSurveyStyling } from \"./UI/Toast/CVToast\";\r\nimport * as UI from \"./UI/UI\";\r\nimport * as Window from \"./Window/Window\";\r\n\r\nexport { getEngineStartPromise, getStorageProvider, resetEngine, setEngineStartPromise, start, startInternal, stop } from \"./CommonFloodgate\";\r\n\r\n/**\r\n * Has the control been opened. Prevents more than one dialog being generated.\r\n */\r\nlet opened = false;\r\n\r\n/**\r\n * Initialize. Must be called before any other call to floodgate.\r\n * @returns A promise which will be rejected if the call fails.\r\n */\r\nexport function initialize(): Promise<any> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst rejectAndLogError = (errorMessage: string) => {\r\n\t\t\tconst telemetryLogger = TelemetryLogger.getTelemetryLogger();\r\n\t\t\tif (telemetryLogger) {\r\n\t\t\t\ttelemetryLogger.log_Event(TelemetryEvent.Floodgate.Initialize.Failed, { ErrorMessage: errorMessage });\r\n\t\t\t}\r\n\r\n\t\t\treject(errorMessage);\r\n\t\t};\r\n\r\n\t\tif (!CommonFloodgate.getInitialized()) {\r\n\t\t\ttry {\r\n\t\t\t\tCommonApp.initialize();\r\n\t\t\t} catch (err) {\r\n\t\t\t\treject(\"CommonApp initialization failed: {\" + err + \"}\");\r\n\t\t\t}\r\n\r\n\t\t\tTelemetryLogger.setTelemetryLogger(new FloodgateTelemetryLogger());\r\n\r\n\t\t\tCommonUI.initialize()\r\n\t\t\t\t.then(\r\n\t\t\t\t\tfunction onInitializeFulfilled() {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tCommonFloodgate.initialize();\r\n\t\t\t\t\t\t\tinitializeDynamicUx();\r\n\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\trejectAndLogError(\"CommonFloodgate initialization failed: {\" + err + \"}\");\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t)\r\n\t\t\t\t.catch(\r\n\t\t\t\t\tfunction onInitializeRejected(err) {\r\n\t\t\t\t\t\trejectAndLogError(\"Initialization failed: {\" + err + \"}\");\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t} else {\r\n\t\t\tresolve(null);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction initializeDynamicUx() {\r\n\ttry {\r\n\t\t// Setting the DynamicUxSchemaVariables regardless of the DynamicUx enabled, because the CampaignDefinitions will be \r\n\t\t// deserialized in any cases, and we don't want to get deserialization failure logging.\r\n\t\t// Deserialization failure should be only be logged if CampaignDefinition is actually wrong.\r\n\t\tsetDynamicUxSchemaVariables(Configuration.get().getDynamicUxConfig().dynamicVariables);\r\n\t\tif (Configuration.get().getDynamicUxConfig().enabled && Configuration.get().checkIfSurveysEnabled()) {\r\n\t\t\tDynamicUxClient.setup(Configuration.get().getDynamicUxConfig());\r\n\t\t\tDynamicUxClient.get().delayLoadCentroUx();\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tLogging.getLogger().logEvent(Logging.EventIds.DYNAMICUX_INITIALIZATION_FAILURE,\r\n\t\t\tLogging.LogLevel.Error,\r\n\t\t\t{ ErrorMessage: \"DynamicUx intialization failed: {\" + err + \"}\" }\r\n\t\t);\r\n\t\tConfiguration.get().resetDynamicUxConfig();\r\n\t}\r\n}\r\n\r\n/**\r\n * Display the given Survey with it's prompt\r\n * @param survey the survey to show\r\n * @param overrideUXRenderCallbackAsync a callback to override rendering\r\n * (currently only supports CV surveys)\r\n * @returns A promise which will be rejected if the call fails.\r\n */\r\nexport function showSurvey(\r\n\tsurvey: IUISurvey,\r\n\toverrideUXRenderCallbackAsync?: IOverrideRenderCallback\r\n): Promise<void> {\r\n\tif (!Configuration.get().checkIfSurveysEnabled()) {\r\n\t\treturn Promise.reject(\"Survey is disabled.\");\r\n\t}\r\n\r\n\tif (survey.getUxSchema()) {\r\n\t\tif (Configuration.get().getDynamicUxConfig().enabled && Configuration.get().checkIfSurveysEnabled()) {\r\n\t\t\tconst dynamicUxClient = DynamicUxClient.get();\r\n\t\t\tconst status = dynamicUxClient.getStatus();\r\n\r\n\t\t\t// acting on DynamicUx status\r\n\t\t\tif (status === DynamicUxClientState.Success || status === DynamicUxClientState.Failure) {\r\n\t\t\t\treturn showSurveyPromise(survey, overrideUXRenderCallbackAsync, status);\r\n\t\t\t}\r\n\t\t\telse if (status === DynamicUxClientState.Starting) {\r\n\t\t\t\tdynamicUxClient.setOnSurveyActivatedCallback((status: DynamicUxClientState) => {\r\n\t\t\t\t\t// Success or legacy content is available for survey trigger\r\n\t\t\t\t\tshowSurveyPromise(survey, overrideUXRenderCallbackAsync, status).catch((error) => {\r\n\t\t\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_TRIGGER_DYNAMICUX_FAILURE,\r\n\t\t\t\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\t\t\t\t\tSurveyId: survey.getId(),\r\n\t\t\t\t\t\t\t\tSurveyType: survey.getSurveyType(),\r\n\t\t\t\t\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\t\t\t\t\tDynamicUxClientState: status\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\tErrorMessage: error && error.toString()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t}, survey)\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Shouldn't get here\r\n\t\t\t\treturn Promise.reject(\"DynamicUx is not started\");\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!survey.isContentValid()) {\r\n\t\t\treturn Promise.reject(\"No content available with DynamicUx is disabled\");\r\n\t\t}\r\n\t}\r\n\r\n\treturn showSurveyPromise(survey, overrideUXRenderCallbackAsync);\r\n}\r\n\r\nfunction showSurveyPromise(\r\n\tsurvey: IUISurvey,\r\n\toverrideUXRenderCallbackAsync?: IOverrideRenderCallback,\r\n\tdynamicUxStatus = DynamicUxClientState.Success\r\n): Promise<void> {\r\n\tif (dynamicUxStatus === DynamicUxClientState.Success || (dynamicUxStatus === DynamicUxClientState.Failure && survey.isContentValid())) {\r\n\t\treturn new Promise<void>((resolve, reject) => {\r\n\t\t\tif (opened) {\r\n\t\t\t\treject(\"Control already open\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!Configuration.get().isFeedbackSurveyEnabledByAADC()) {\r\n\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_UI_DISABLED_AADC,\r\n\t\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\t\t\tData: JSON.stringify({\r\n\t\t\t\t\t\t\tageGroup: Configuration.get().getCommonInitOptions().ageGroup,\r\n\t\t\t\t\t\t\tauthenticationType: Configuration.get().getCommonInitOptions().authenticationType,\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t});\r\n\t\t\t\treject(\"Prompt is prohibited by AADC\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tConfiguration.get().setFloodgateSurvey(survey ? survey : new DummyUISurvey());\r\n\t\t\tconst isCVSurveyEnabled = Configuration.get().isCVSurveyEnabled();\r\n\t\t\t/**\r\n\t\t\t * Branching logic to determine if Customer Voice survey is shown to user.\r\n\t\t\t */\r\n\t\t\tif (isCVSurveyEnabled && survey.getLauncherType() === customerVoiceLauncherType) {\r\n\t\t\t\tconst contextParams: IContextParams = getContextParams(survey);\r\n\t\t\t\tconst optionalConfigParams: ISurveyOptionalConfigParams = getOptionalConfigParams();\r\n\r\n\t\t\t\tconst renderContext: ISurveyRenderContext = UI.createCVSurvey(\r\n\t\t\t\t\tcontextParams,\r\n\t\t\t\t\tfunction () { opened = false; },\r\n\t\t\t\t\toptionalConfigParams,\r\n\t\t\t\t\toverrideUXRenderCallbackAsync\r\n\t\t\t\t);\r\n\t\t\t\tConfiguration.get().setCVRenderContext(renderContext);\r\n\t\t\t\topened = true;\r\n\t\t\t\tresolve();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tUI.createSurvey(function () { opened = false; });\r\n\t\t\topened = true;\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\telse {\r\n\t\treturn Promise.reject(\"Survey Content is not valid or DynamicUx failed to load\")\r\n\t}\r\n}\r\n\r\n/**\r\n * Method to create the context params object\r\n * @param survey the survey being shown\r\n */\r\nfunction getContextParams(survey: IUISurvey): IContextParams {\r\n\tconst urlParams: IURLParams = {};\r\n\tif (Configuration.get().getCommonInitOptions().primaryColour) {\r\n\t\turlParams.appPrimaryColor = Configuration.get().getCommonInitOptions().primaryColour.replace(\"#\", \"\");\r\n\t}\r\n\tif (Configuration.get().getCommonInitOptions().secondaryColour) {\r\n\t\turlParams.appSecondaryColor = Configuration.get().getCommonInitOptions().secondaryColour.replace(\"#\", \"\");\r\n\t}\r\n\r\n\treturn {\r\n\t\tcustomerVoiceFormId: survey.getCVSurveyFormId(),\r\n\t\tflights: Configuration.get().getCVSurveyFlights(),\r\n\t\tisCommercialHost: Configuration.get().getCommonInitOptions().isCommercialHost,\r\n\t\tlocale: Configuration.get().getCommonInitOptions().locale,\r\n\t\tplatform: Configuration.get().getCommonInitOptions().telemetryGroup.platform,\r\n\t\tshowUserEmailAddress: Configuration.get().getFloodgateInitOptions().showEmailAddress,\r\n\t\tproductName: Configuration.get().getProductName(),\r\n\t\tuiHost: Configuration.get().getUIHost(),\r\n\t\tuiHostCVSurveyDispatcher: Configuration.get().getUIHostCVSurveyDispatcher(),\r\n\t\tstylesUrl: Configuration.get().getCommonInitOptions().stylesUrl,\r\n\t\turlParams,\r\n\t\tisCopilotLicenseEnabled: Configuration.get().isCopilotLicenseEnabled(),\r\n\r\n\t};\r\n}\r\n\r\n/**\r\n * Method to create the optional config params\r\n * @param survey the survey being shown\r\n */\r\nfunction getOptionalConfigParams(): ISurveyOptionalConfigParams {\r\n\tconst optionalConfigParams: ISurveyOptionalConfigParams = {\r\n\t\tcloseButtonEnabled: true,\r\n\t\tcancelButtonEnabled: true,\r\n\t\ttimeOutEnabled: true,\r\n\t};\r\n\tif (Configuration.get().getCSSPosition()) {\r\n\t\toptionalConfigParams.cssPosition = Configuration.get().getCSSPosition();\r\n\t}\r\n\tif (Configuration.get().getCSSZIndex()) {\r\n\t\toptionalConfigParams.cssZIndex = Configuration.get().getCSSZIndex();\r\n\t}\r\n\tif (Configuration.get().getCSSBottom()) {\r\n\t\toptionalConfigParams.cssBottom = Configuration.get().getCSSBottom();\r\n\t}\r\n\tif (Configuration.get().getCSSRight()) {\r\n\t\toptionalConfigParams.cssRight = Configuration.get().getCSSRight();\r\n\t}\r\n\tif (Configuration.get().getRuntimeCssVars()) {\r\n\t\toptionalConfigParams.runtimeCssVars = Configuration.get().getRuntimeCssVars();\r\n\t}\r\n\tif (Configuration.get().getRuntimeHtmlDataAttrs()) {\r\n\t\toptionalConfigParams.runtimeHtmlDataAttrs = Configuration.get().getRuntimeHtmlDataAttrs();\r\n\t}\r\n\treturn optionalConfigParams;\r\n}\r\n\r\n/**\r\n * Method to allow users to launch a survey from an ISurveyForm\r\n * @param survey the survey to show\r\n * @param overrideUXRenderCallbackAsync a callback to override rendering\r\n * (currently only supports CV surveys)\r\n */\r\nexport function showFormSurvey(\r\n\tsurvey: ISurveyForm,\r\n\toverrideUXRenderCallbackAsync?: IOverrideRenderCallback\r\n): Promise<any> {\r\n\tconst genericSurvey: ISurvey = survey as ISurvey;\r\n\r\n\tconst formattedSurvey: IUISurvey = new UISurvey(genericSurvey);\r\n\treturn showSurvey(formattedSurvey, overrideUXRenderCallbackAsync);\r\n}\r\n\r\n/**\r\n * Method to allow users to launch a custom survey directly\r\n * @param survey the survey to show\r\n * @returns A promise which will be rejected if the call fails.\r\n */\r\nexport function showCustomSurvey(survey: ICustomSurvey): Promise<any> {\r\n\r\n\tif (!CommonFloodgate.getInitialized()) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_FLOODGATE_SHOWCUSTOMSURVEY_FAILED,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: \"App_Floodgate.showCustomSurvey called when CommonFloodgate has not initialized\",\r\n\t\t\t\t\tCampaignId: survey?.campaignId,\r\n\t\t\t\t},\r\n\t\t\t\t0.01 /* 1% internalSampleRate */\r\n\t\t\t);\r\n\r\n\t\t\treject(\"Floodgate has not been initialized.\");\r\n\t\t});\r\n\t}\r\n\r\n\treturn showSurvey(new CustomUISurvey(survey), null);\r\n}\r\n\r\n/**\r\n * Method to allow users to call survey rendering independent from showSurvey().\r\n * @param parentElement the container in which the survey will be rendered\r\n * @param onSurveyEvent a handler for all events emitted by survey tools\r\n * @param contextParams information about the context in which the survey is shown\r\n * @param surveyOptionalConfigParams additional survey configuration parameters\r\n */\r\nexport const renderSurvey: IRenderSurvey = (\r\n\tparentElement: string | HTMLElement,\r\n\tonSurveyEvent: IHandleSurveyEvent,\r\n\tcontextParams: IContextParams,\r\n\tsurveyOptionalConfigParams?: ISurveyOptionalConfigParams\r\n): void => {\r\n\tconst isMainContext = Configuration.get().getFloodgateSurvey() ? true : false;\r\n\r\n\t// If a CV form ID is provided, we classify this request as a Customer Voice survey\r\n\tconst formIdBool = !!contextParams.customerVoiceFormId;\r\n\tif (formIdBool) {\r\n\t\trenderCVSurvey(\r\n\t\t\tparentElement,\r\n\t\t\tonSurveyEvent,\r\n\t\t\tcontextParams,\r\n\t\t\tsurveyOptionalConfigParams,\r\n\t\t\tisMainContext\r\n\t\t);\r\n\t} else {\r\n\t\tconst telemetryLogger = TelemetryLogger.getTelemetryLogger();\r\n\t\tif (telemetryLogger) {\r\n\t\t\ttelemetryLogger.log_Event(\r\n\t\t\t\tTelemetryEvent.Floodgate.RenderSurvey.Unsupported,\r\n\t\t\t\t{ ErrorMessage: `WARN: renderSurvey currently only supports Customer Voice surveys.` }\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * Reset the floodgate module. Used in unit tests.\r\n */\r\nexport function reset() {\r\n\tCommonApp.reset();\r\n\tCommonUI.reset();\r\n\tCommonFloodgate.reset();\r\n\topened = false;\r\n}\r\n\r\n/**\r\n * Get a list of setting names and ids\r\n * @returns the setting names and ids list\r\n */\r\nexport function getSettingIdMap(): IFloodgateSettingIdMap {\r\n\treturn RoamingSettingIdMap;\r\n}\r\n\r\nWindow.setFloodgateCustomUXHandler({ renderSurvey, handleSurveyEvent, updateSurveyStyling });\r\nWindow.setFloodgateShowSurvey(showSurvey);\r\nWindow.setFloodgateShowFormSurvey(showFormSurvey);\r\nWindow.setFloodgateShowCustomSurvey(showCustomSurvey);\r\nWindow.setFloodgateInitialize(initialize);\r\nWindow.getSettingIdMap(getSettingIdMap);\r\n", "import \"es6-promise/auto\";\r\n", "// Logging Interfaces\r\nexport interface ICustomLogData {\r\n\t[key: string]: string | number | boolean | undefined;\r\n}\r\n\r\nexport interface IPersonalizationLogger {\r\n\terror(message: string, ...data: unknown[]): void;\r\n\tinfo(message: string, ...data: unknown[]): void;\r\n\twarn(message: string, ...data: unknown[]): void;\r\n\ttrace(message: string, ...data: unknown[]): void;\r\n\tevent(eventName: string, customLogData?: ICustomLogData, samplingRatio?: number): void;\r\n\tuserFactEvent?(userFact: string, userFactValue: string): void;\r\n}\r\n\r\nlet globalLogger: IPersonalizationLogger = {\r\n\terror(message: string, ...data: unknown[]): void {},\r\n\tinfo(message: string, ...data: unknown[]): void {},\r\n\twarn(message: string, ...data: unknown[]): void {},\r\n\ttrace(message: string, ...data: unknown[]): void {},\r\n\tevent(eventName: string, customLogData?: ICustomLogData, samplingRatio = 1): void {},\r\n\tuserFactEvent(eventName: string, userFactValue: string): void {},\r\n};\r\n\r\nexport function getLogger(): IPersonalizationLogger {\r\n\treturn globalLogger;\r\n}\r\n\r\nexport function setLogger(logger: IPersonalizationLogger): void {\r\n\tif (logger) {\r\n\t\tglobalLogger = logger;\r\n\t}\r\n}\r\n", "/**\r\n * Class representing a configuration (user provided options)\r\n * for personalization\r\n */\r\n\r\nimport { IUserFactRulesMap } from \"../Common/Models\";\r\n\r\nexport class Configuration {\r\n\r\n    private sessionId: string;\r\n    private userFactRules: IUserFactRulesMap;\r\n\r\n    public setSessionId(sessionId: string) {\r\n        this.sessionId = sessionId;\r\n    }\r\n\r\n    public setUserFactRules(userFactRules: IUserFactRulesMap) {\r\n        this.userFactRules = userFactRules;\r\n    }\r\n\r\n    public getSessionId(): string {\r\n        return this.sessionId;\r\n    }\r\n\r\n    public getUserFactRules(): IUserFactRulesMap {\r\n        return this.userFactRules;\r\n    }\r\n}\r\n\r\nconst configuration: Configuration = new Configuration();\r\n\r\n/**\r\n * Get the current configuration\r\n */\r\nexport function get(): Configuration {\r\n\treturn configuration;\r\n\r\n}", "import { IPersonalizationSettings } from \"./Models\";\r\n\r\nexport const PERSONALIZATION_DEFAULT_CACHE_EXPIRATION = 4 * 60 * 60 * 1000 // 4 hrs in ms\r\n\r\nconst defaultSettingsProd: IPersonalizationSettings = {\r\n\tenvironment: \"prod\",\r\n\tuserFactsUrl: \"https://attributes.engagement.office.com/facts\",\r\n\tuserFactsRequestTimeOut: 3000,\r\n\tuserFactsCacheExpiration: PERSONALIZATION_DEFAULT_CACHE_EXPIRATION,\r\n\teventSamplingRate: 1, //sample at 1%\r\n};\r\n\r\nconst defaultSettingsInt: IPersonalizationSettings = {\r\n\tenvironment: \"int\",\r\n\tuserFactsUrl: \"https://attributes.engagement.office-int.com/facts\",\r\n\tuserFactsRequestTimeOut: 3000,\r\n\tuserFactsCacheExpiration: PERSONALIZATION_DEFAULT_CACHE_EXPIRATION,\r\n\teventSamplingRate: 1, //sample at 1%\r\n};\r\n\r\nconst defaultSettingsEdog: IPersonalizationSettings = {\r\n\tenvironment: \"edog\",\r\n\tuserFactsUrl: \"https://attributes.engagement.officeppe.com/facts\",\r\n\tuserFactsRequestTimeOut: 3000,\r\n\tuserFactsCacheExpiration: PERSONALIZATION_DEFAULT_CACHE_EXPIRATION,\r\n\teventSamplingRate: 1, //sample at 1%\r\n};\r\n\r\nlet customSettings: IPersonalizationSettings = defaultSettingsProd;\r\n\r\nexport function initSettings(inputSettings?: IPersonalizationSettings) {\r\n\tif (!initSettings) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet defaultSettings = defaultSettingsProd;\r\n\tconst environment = inputSettings?.environment ?? defaultSettingsProd.environment;\r\n\tswitch (environment) {\r\n\t\tcase \"int\":\r\n\t\t\tdefaultSettings = defaultSettingsInt;\r\n\t\t\tbreak;\r\n\t\tcase \"edog\":\r\n\t\t\tdefaultSettings = defaultSettingsEdog;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tcustomSettings = { ...defaultSettings, ...inputSettings };\r\n}\r\n\r\nexport function getSetting<T>(name: keyof IPersonalizationSettings): T {\r\n\treturn (customSettings[name] ?? defaultSettingsProd[name]) as unknown as T;\r\n}\r\n\r\nexport function getSamplingRate(): number {\r\n\tconst rate = getSetting(\"eventSamplingRate\") as number;\r\n\treturn !rate ? 0.01 : rate/100.0;\r\n}\r\n", "\r\n/**\r\n * Window.ts\r\n *\r\n * Module wrapping around the global window object\r\n */\r\n\r\nconst w = typeof window !== \"undefined\" && window;\r\n\r\n/**\r\n * Get the IWindow object\r\n */\r\nexport function get(): WindowLocalStorage { return w; }\r\n\r\n/**\r\n * Get the IWindow object\r\n */\r\nexport function getGlobal(): WindowLocalStorage { return w; }\r\n", "/**\r\n * Local storage wrapper\r\n */\r\n\r\nimport * as Window from \"../Utils/Window\";\r\n\r\n/**\r\n * Code to detect localStorage presence.\r\n * Copied from MDN: https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n */\r\nexport function isStorageAvailable(): boolean {\r\n\ttry {\r\n\t\tconst x = \"__storage_test__\";\r\n\t\tWindow.getGlobal().localStorage.setItem(x, x);\r\n\t\tWindow.getGlobal().localStorage.removeItem(x);\r\n\t\treturn true;\r\n\t} catch (e) {\r\n\t\treturn e instanceof DOMException && (\r\n\t\t\t// everything except Firefox\r\n\t\t\te.code === 22 ||\r\n\t\t\t// Firefox\r\n\t\t\te.code === 1014 ||\r\n\t\t\t// test name field too, because code might not be present\r\n\t\t\t// everything except Firefox\r\n\t\t\te.name === \"QuotaExceededError\" ||\r\n\t\t\t// Firefox\r\n\t\t\te.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\r\n\t\t\t// acknowledge QuotaExceededError only if there's something already stored\r\n\t\t\tWindow.getGlobal().localStorage.length !== 0;\r\n\t}\r\n}\r\n\r\n/**\r\n * Safely read an object\r\n */\r\nexport function readObjectFromStorage<T>(storageKey: string, defaultValue?: T): T {\r\n\tif (!storageKey) {\r\n\t\treturn defaultValue;\r\n\t}\r\n\r\n\ttry {\r\n\t\tconst result = Window.getGlobal().localStorage.getItem(storageKey);\r\n\t\tconst parsedObject = result && (result[0] === \"{\" || result[0] === \"[\") ? JSON.parse(result) : result;\r\n\t\treturn parsedObject ?? defaultValue;\r\n\t} catch (e) {\r\n\t\t// ignore\r\n\t}\r\n\r\n\treturn defaultValue;\r\n}\r\n\r\n/**\r\n * Write to the localStorage\r\n */\r\nexport function writeToStorage<T>(storageKey: string, content: T): void {\r\n\tif (!storageKey || !content) {\r\n\t\treturn;\r\n\t}\r\n\r\n\ttry {\r\n\t\tconst contentString = typeof content === \"string\" ? content : JSON.stringify(content);\r\n\t\tWindow.getGlobal().localStorage.setItem(storageKey, contentString);\r\n\t} catch (e) {\r\n\t\t// ignore\r\n\t}\r\n}\r\n", "import { ContentType } from \"../Common/ContentType\";\r\nimport { readObjectFromStorage, writeToStorage } from \"./Storage\";\r\n\r\nexport interface ICacheItem {\r\n\tcontentType: ContentType;\r\n\tcontent: any;\r\n\texpiryDate: Date;\r\n\tlastRetrievedDate: Date;\r\n}\r\n\r\nexport function saveToCache(contentType: ContentType, content: any, expiryTime: number, storageKey?: string): ICacheItem {\r\n\tconst cacheItem = createItem(contentType, content, expiryTime);\r\n\tsetItem(cacheItem, storageKey);\r\n\treturn cacheItem;\r\n}\r\n\r\nexport function updateCache(contentType: ContentType, content: any, expiryTime: number, storageKey?: string): ICacheItem {\r\n\tconst cacheItem = getItem(storageKey);\r\n\tif (!cacheItem) {\r\n\t\treturn saveToCache(contentType, content, expiryTime, storageKey);\r\n\t}\r\n\r\n\tcacheItem.content = content;\r\n\tsetItem(cacheItem, storageKey);\r\n\treturn cacheItem;\r\n}\r\n\r\nexport function getCachedContent<T>(storageKey: string): T {\r\n\tconst cacheItem = getItem(storageKey);\r\n\treturn cacheItem && cacheItem.content;\r\n}\r\n\r\nexport function getValidCachedContent<T>(storageKey: string, defaultValue: T): T {\r\n\tconst cacheItem = getItem(storageKey);\r\n\treturn isCacheItemExpired(cacheItem) ? defaultValue : cacheItem.content;\r\n}\r\n\r\nexport function isCachedTypeExpired(storageKey: string): boolean {\r\n\tconst cacheItem = getItem(storageKey);\r\n\treturn isCacheItemExpired(cacheItem);\r\n}\r\n\r\nexport function createItem(contentType: ContentType, content: any, expiryTime: number): ICacheItem {\r\n\tconst cacheItem: ICacheItem = {\r\n\t\tcontentType,\r\n\t\tcontent,\r\n\t\texpiryDate:  new Date(Date.now() + expiryTime),\r\n\t\tlastRetrievedDate: new Date(),\r\n\t};\r\n\r\n\treturn cacheItem;\r\n}\r\n\r\nfunction isCacheItemExpired(cacheItem: ICacheItem): boolean {\r\n\treturn !cacheItem\r\n\t\t|| !cacheItem.expiryDate\r\n\t\t|| cacheItem.expiryDate < new Date();\r\n}\r\n\r\nfunction setItem(cacheItem: ICacheItem, storageKey?: string): void {\r\n\twriteToStorage(storageKey ?? cacheItem.contentType, cacheItem);\r\n}\r\n\r\nfunction getItem(storageKey: string): ICacheItem {\r\n\tconst cachedItem = readObjectFromStorage<ICacheItem>(storageKey);\r\n\tif (cachedItem) {\r\n\t\tcachedItem.expiryDate = typeof cachedItem.expiryDate === \"string\" ?\r\n\t\t\tnew Date(cachedItem.expiryDate) : cachedItem.expiryDate;\r\n\t}\r\n\r\n\treturn cachedItem;\r\n}\r\n", "/**\r\n * Constants.ts\r\n *\r\n * Module to hold userFact-related constants\r\n */\r\n\r\nexport const AppUsageUserFactType = \"AppUsage\";\r\n\r\nexport enum ComparatorType {\r\n\tEqual = 0,\r\n\tNotEqual,\r\n\tGreaterThan,\r\n\tGreaterThanOrEqual,\r\n\tLessThan,\r\n\tLessThanOrEqual,\r\n}\r\n\r\nexport const AppLastUsedEventNames: { [appId: number]: string } = {\r\n\t2155: \"WordWebLastUsed\",\r\n\t2156: \"ExcelWebLastUsed\",\r\n\t2157: \"PowerPointWebLastUsed\",\r\n};\r\n\r\n", "import { ComparatorType } from \"./Constants\";\r\nimport { IUserFactDataProperty, IUserFactManifest } from \"../Common/Models\";\r\nimport { EventIds } from \"../Logging/Constants\";\r\nimport * as Logger from \"../Logging/Logger\";\r\nimport { TelemetryEvent, DataField } from \"@microsoft/oteljs\";\r\nimport { getSamplingRate } from \"../Common/Settings\";\r\n\r\nexport function CompareDataPropertyToDataField(prop: IUserFactDataProperty, dataField: DataField): boolean {\r\n\tif (dataField.dataType != prop.type) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tswitch (prop.comparator) {\r\n\t\tcase ComparatorType.Equal:\r\n\t\t\treturn dataField.value === prop.value;\r\n\t\tcase ComparatorType.NotEqual:\r\n\t\t\treturn dataField.value != prop.value;\r\n\t\tcase ComparatorType.GreaterThan:\r\n\t\t\treturn dataField.value > prop.value;\r\n\t\tcase ComparatorType.GreaterThanOrEqual:\r\n\t\t\treturn dataField.value >= prop.value;\r\n\t\tcase ComparatorType.LessThan:\r\n\t\t\treturn dataField.value < prop.value;\r\n\t\tcase ComparatorType.LessThanOrEqual:\r\n\t\t\treturn dataField.value <= prop.value;\r\n\t\tdefault:\r\n\t\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport function CompareDataPropertyToTelemetryEvent(prop: IUserFactDataProperty, event: TelemetryEvent): boolean {\r\n\tif (event.dataFields) {\r\n\t\tconst dataField = event.dataFields.find(property => property.name === prop.propertyName);\r\n\r\n\t\tif (dataField) {\r\n\t\t\treturn CompareDataPropertyToDataField(prop, dataField);\r\n\t\t}\t\r\n\t}\r\n\r\n\t// if the datafield property resides as part of the EventContract object search and compare those data fields\r\n\tif (event.eventContract && event.eventContract.dataFields) {\r\n\t\tconst eventContractData = event.eventContract.dataFields.find(property => property.name === prop.propertyName);\r\n\r\n\t\tif (eventContractData) {\r\n\t\t\treturn CompareDataPropertyToDataField(prop, eventContractData);\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\n// Called when canSendUserFact is called by the host apps\r\nexport function EvaluateEvent(manifest: IUserFactManifest, eventTime: Date , lastSourceTime: Date): boolean {\r\n\tif (manifest === null || eventTime === null) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst dedupPassed = HasDedupIntervalPassed(manifest.dedupIntervalSeconds,  eventTime, lastSourceTime);\r\n\tif (!dedupPassed) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsUserFactNotSentDedupInterval, { eventName: manifest.userFactName }, getSamplingRate());\r\n\t}\r\n\treturn dedupPassed;\r\n}\r\n\r\n// Called when canSendUserFact is called through the otel telemetry sink\r\nexport function EvaluateTelemetryEvent(manifest: IUserFactManifest, event: TelemetryEvent, eventTime: Date, lastSourceTime: Date): boolean {\r\n\tif (manifest === null || eventTime === null) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// check that all data properties match values in telemetry event\r\n\tif (!manifest.props.every(m => CompareDataPropertyToTelemetryEvent(m, event))) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsTelemetryEventManifestMismatch, { eventName: manifest.userFactName }, getSamplingRate());\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst dedupPassed = HasDedupIntervalPassed(manifest.dedupIntervalSeconds, eventTime, lastSourceTime);\r\n\tif (!dedupPassed) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsTelemetryEventNotSentDedupInterval, { eventName: manifest.userFactName }, getSamplingRate());\r\n\t}\r\n\treturn dedupPassed;\r\n}\r\n\r\n/**\r\n * Check if the dedupInterval provided in the user fact manifest has elapsed between the eventTime and the lastSourceTime\r\n * @param dedupIntervalSeconds the dedup interval for the user fact, obtained from the user fact manifest\r\n * @param eventTime the most recent time the user fact has occured\r\n * @param lastSourceTime the last time the user fact has occured, pulled from local storage\r\n */\r\nexport function HasDedupIntervalPassed(dedupIntervalSeconds: number, eventTime: Date, lastSourceTime: Date): boolean {\r\n\tif (eventTime == null) {\r\n\t\treturn false;\r\n\t}\r\n\t// if the last source time does not exist or is an invalid date, fact is being added for the first time\r\n\tif (!lastSourceTime) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// validate the the dedupIntervalSeconds has elapsed since the last sourceDateTime\r\n\treturn (eventTime.getTime() - lastSourceTime.getTime() >= dedupIntervalSeconds * 1000 /*convert to milliseconds*/);\r\n}", "/* eslint-disable no-prototype-builtins */\nvar g =\n  (typeof globalThis !== 'undefined' && globalThis) ||\n  (typeof self !== 'undefined' && self) ||\n  // eslint-disable-next-line no-undef\n  (typeof global !== 'undefined' && global) ||\n  {}\n\nvar support = {\n  searchParams: 'URLSearchParams' in g,\n  iterable: 'Symbol' in g && 'iterator' in Symbol,\n  blob:\n    'FileReader' in g &&\n    'Blob' in g &&\n    (function() {\n      try {\n        new Blob()\n        return true\n      } catch (e) {\n        return false\n      }\n    })(),\n  formData: 'FormData' in g,\n  arrayBuffer: 'ArrayBuffer' in g\n}\n\nfunction isDataView(obj) {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nif (support.arrayBuffer) {\n  var viewClasses = [\n    '[object Int8Array]',\n    '[object Uint8Array]',\n    '[object Uint8ClampedArray]',\n    '[object Int16Array]',\n    '[object Uint16Array]',\n    '[object Int32Array]',\n    '[object Uint32Array]',\n    '[object Float32Array]',\n    '[object Float64Array]'\n  ]\n\n  var isArrayBufferView =\n    ArrayBuffer.isView ||\n    function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name)\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~!]/i.test(name) || name === '') {\n    throw new TypeError('Invalid character in header field name: \"' + name + '\"')\n  }\n  return name.toLowerCase()\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value)\n  }\n  return value\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  var iterator = {\n    next: function() {\n      var value = items.shift()\n      return {done: value === undefined, value: value}\n    }\n  }\n\n  if (support.iterable) {\n    iterator[Symbol.iterator] = function() {\n      return iterator\n    }\n  }\n\n  return iterator\n}\n\nexport function Headers(headers) {\n  this.map = {}\n\n  if (headers instanceof Headers) {\n    headers.forEach(function(value, name) {\n      this.append(name, value)\n    }, this)\n  } else if (Array.isArray(headers)) {\n    headers.forEach(function(header) {\n      if (header.length != 2) {\n        throw new TypeError('Headers constructor: expected name/value pair to be length 2, found' + header.length)\n      }\n      this.append(header[0], header[1])\n    }, this)\n  } else if (headers) {\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\n      this.append(name, headers[name])\n    }, this)\n  }\n}\n\nHeaders.prototype.append = function(name, value) {\n  name = normalizeName(name)\n  value = normalizeValue(value)\n  var oldValue = this.map[name]\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\n}\n\nHeaders.prototype['delete'] = function(name) {\n  delete this.map[normalizeName(name)]\n}\n\nHeaders.prototype.get = function(name) {\n  name = normalizeName(name)\n  return this.has(name) ? this.map[name] : null\n}\n\nHeaders.prototype.has = function(name) {\n  return this.map.hasOwnProperty(normalizeName(name))\n}\n\nHeaders.prototype.set = function(name, value) {\n  this.map[normalizeName(name)] = normalizeValue(value)\n}\n\nHeaders.prototype.forEach = function(callback, thisArg) {\n  for (var name in this.map) {\n    if (this.map.hasOwnProperty(name)) {\n      callback.call(thisArg, this.map[name], name, this)\n    }\n  }\n}\n\nHeaders.prototype.keys = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push(name)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.values = function() {\n  var items = []\n  this.forEach(function(value) {\n    items.push(value)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.entries = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push([name, value])\n  })\n  return iteratorFor(items)\n}\n\nif (support.iterable) {\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n}\n\nfunction consumed(body) {\n  if (body._noBody) return\n  if (body.bodyUsed) {\n    return Promise.reject(new TypeError('Already read'))\n  }\n  body.bodyUsed = true\n}\n\nfunction fileReaderReady(reader) {\n  return new Promise(function(resolve, reject) {\n    reader.onload = function() {\n      resolve(reader.result)\n    }\n    reader.onerror = function() {\n      reject(reader.error)\n    }\n  })\n}\n\nfunction readBlobAsArrayBuffer(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nfunction readBlobAsText(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  var match = /charset=([A-Za-z0-9_-]+)/.exec(blob.type)\n  var encoding = match ? match[1] : 'utf-8'\n  reader.readAsText(blob, encoding)\n  return promise\n}\n\nfunction readArrayBufferAsText(buf) {\n  var view = new Uint8Array(buf)\n  var chars = new Array(view.length)\n\n  for (var i = 0; i < view.length; i++) {\n    chars[i] = String.fromCharCode(view[i])\n  }\n  return chars.join('')\n}\n\nfunction bufferClone(buf) {\n  if (buf.slice) {\n    return buf.slice(0)\n  } else {\n    var view = new Uint8Array(buf.byteLength)\n    view.set(new Uint8Array(buf))\n    return view.buffer\n  }\n}\n\nfunction Body() {\n  this.bodyUsed = false\n\n  this._initBody = function(body) {\n    /*\n      fetch-mock wraps the Response object in an ES6 Proxy to\n      provide useful test harness features such as flush. However, on\n      ES5 browsers without fetch or Proxy support pollyfills must be used;\n      the proxy-pollyfill is unable to proxy an attribute unless it exists\n      on the object before the Proxy is created. This change ensures\n      Response.bodyUsed exists on the instance, while maintaining the\n      semantic of setting Request.bodyUsed in the constructor before\n      _initBody is called.\n    */\n    // eslint-disable-next-line no-self-assign\n    this.bodyUsed = this.bodyUsed\n    this._bodyInit = body\n    if (!body) {\n      this._noBody = true;\n      this._bodyText = ''\n    } else if (typeof body === 'string') {\n      this._bodyText = body\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n      this._bodyBlob = body\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n      this._bodyFormData = body\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n      this._bodyText = body.toString()\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n      this._bodyArrayBuffer = bufferClone(body.buffer)\n      // IE 10-11 can't handle a DataView body.\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n      this._bodyArrayBuffer = bufferClone(body)\n    } else {\n      this._bodyText = body = Object.prototype.toString.call(body)\n    }\n\n    if (!this.headers.get('content-type')) {\n      if (typeof body === 'string') {\n        this.headers.set('content-type', 'text/plain;charset=UTF-8')\n      } else if (this._bodyBlob && this._bodyBlob.type) {\n        this.headers.set('content-type', this._bodyBlob.type)\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n      }\n    }\n  }\n\n  if (support.blob) {\n    this.blob = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return Promise.resolve(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as blob')\n      } else {\n        return Promise.resolve(new Blob([this._bodyText]))\n      }\n    }\n  }\n\n  this.arrayBuffer = function() {\n    if (this._bodyArrayBuffer) {\n      var isConsumed = consumed(this)\n      if (isConsumed) {\n        return isConsumed\n      } else if (ArrayBuffer.isView(this._bodyArrayBuffer)) {\n        return Promise.resolve(\n          this._bodyArrayBuffer.buffer.slice(\n            this._bodyArrayBuffer.byteOffset,\n            this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength\n          )\n        )\n      } else {\n        return Promise.resolve(this._bodyArrayBuffer)\n      }\n    } else if (support.blob) {\n      return this.blob().then(readBlobAsArrayBuffer)\n    } else {\n      throw new Error('could not read as ArrayBuffer')\n    }\n  }\n\n  this.text = function() {\n    var rejected = consumed(this)\n    if (rejected) {\n      return rejected\n    }\n\n    if (this._bodyBlob) {\n      return readBlobAsText(this._bodyBlob)\n    } else if (this._bodyArrayBuffer) {\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n    } else if (this._bodyFormData) {\n      throw new Error('could not read FormData body as text')\n    } else {\n      return Promise.resolve(this._bodyText)\n    }\n  }\n\n  if (support.formData) {\n    this.formData = function() {\n      return this.text().then(decode)\n    }\n  }\n\n  this.json = function() {\n    return this.text().then(JSON.parse)\n  }\n\n  return this\n}\n\n// HTTP methods whose capitalization should be normalized\nvar methods = ['CONNECT', 'DELETE', 'GET', 'HEAD', 'OPTIONS', 'PATCH', 'POST', 'PUT', 'TRACE']\n\nfunction normalizeMethod(method) {\n  var upcased = method.toUpperCase()\n  return methods.indexOf(upcased) > -1 ? upcased : method\n}\n\nexport function Request(input, options) {\n  if (!(this instanceof Request)) {\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\n  }\n\n  options = options || {}\n  var body = options.body\n\n  if (input instanceof Request) {\n    if (input.bodyUsed) {\n      throw new TypeError('Already read')\n    }\n    this.url = input.url\n    this.credentials = input.credentials\n    if (!options.headers) {\n      this.headers = new Headers(input.headers)\n    }\n    this.method = input.method\n    this.mode = input.mode\n    this.signal = input.signal\n    if (!body && input._bodyInit != null) {\n      body = input._bodyInit\n      input.bodyUsed = true\n    }\n  } else {\n    this.url = String(input)\n  }\n\n  this.credentials = options.credentials || this.credentials || 'same-origin'\n  if (options.headers || !this.headers) {\n    this.headers = new Headers(options.headers)\n  }\n  this.method = normalizeMethod(options.method || this.method || 'GET')\n  this.mode = options.mode || this.mode || null\n  this.signal = options.signal || this.signal || (function () {\n    if ('AbortController' in g) {\n      var ctrl = new AbortController();\n      return ctrl.signal;\n    }\n  }());\n  this.referrer = null\n\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n    throw new TypeError('Body not allowed for GET or HEAD requests')\n  }\n  this._initBody(body)\n\n  if (this.method === 'GET' || this.method === 'HEAD') {\n    if (options.cache === 'no-store' || options.cache === 'no-cache') {\n      // Search for a '_' parameter in the query string\n      var reParamSearch = /([?&])_=[^&]*/\n      if (reParamSearch.test(this.url)) {\n        // If it already exists then set the value with the current time\n        this.url = this.url.replace(reParamSearch, '$1_=' + new Date().getTime())\n      } else {\n        // Otherwise add a new '_' parameter to the end with the current time\n        var reQueryString = /\\?/\n        this.url += (reQueryString.test(this.url) ? '&' : '?') + '_=' + new Date().getTime()\n      }\n    }\n  }\n}\n\nRequest.prototype.clone = function() {\n  return new Request(this, {body: this._bodyInit})\n}\n\nfunction decode(body) {\n  var form = new FormData()\n  body\n    .trim()\n    .split('&')\n    .forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nfunction parseHeaders(rawHeaders) {\n  var headers = new Headers()\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n  // https://tools.ietf.org/html/rfc7230#section-3.2\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n  // Avoiding split via regex to work around a common IE11 bug with the core-js 3.6.0 regex polyfill\n  // https://github.com/github/fetch/issues/748\n  // https://github.com/zloirock/core-js/issues/751\n  preProcessedHeaders\n    .split('\\r')\n    .map(function(header) {\n      return header.indexOf('\\n') === 0 ? header.substr(1, header.length) : header\n    })\n    .forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        try {\n          headers.append(key, value)\n        } catch (error) {\n          console.warn('Response ' + error.message)\n        }\n      }\n    })\n  return headers\n}\n\nBody.call(Request.prototype)\n\nexport function Response(bodyInit, options) {\n  if (!(this instanceof Response)) {\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\n  }\n  if (!options) {\n    options = {}\n  }\n\n  this.type = 'default'\n  this.status = options.status === undefined ? 200 : options.status\n  if (this.status < 200 || this.status > 599) {\n    throw new RangeError(\"Failed to construct 'Response': The status provided (0) is outside the range [200, 599].\")\n  }\n  this.ok = this.status >= 200 && this.status < 300\n  this.statusText = options.statusText === undefined ? '' : '' + options.statusText\n  this.headers = new Headers(options.headers)\n  this.url = options.url || ''\n  this._initBody(bodyInit)\n}\n\nBody.call(Response.prototype)\n\nResponse.prototype.clone = function() {\n  return new Response(this._bodyInit, {\n    status: this.status,\n    statusText: this.statusText,\n    headers: new Headers(this.headers),\n    url: this.url\n  })\n}\n\nResponse.error = function() {\n  var response = new Response(null, {status: 200, statusText: ''})\n  response.ok = false\n  response.status = 0\n  response.type = 'error'\n  return response\n}\n\nvar redirectStatuses = [301, 302, 303, 307, 308]\n\nResponse.redirect = function(url, status) {\n  if (redirectStatuses.indexOf(status) === -1) {\n    throw new RangeError('Invalid status code')\n  }\n\n  return new Response(null, {status: status, headers: {location: url}})\n}\n\nexport var DOMException = g.DOMException\ntry {\n  new DOMException()\n} catch (err) {\n  DOMException = function(message, name) {\n    this.message = message\n    this.name = name\n    var error = Error(message)\n    this.stack = error.stack\n  }\n  DOMException.prototype = Object.create(Error.prototype)\n  DOMException.prototype.constructor = DOMException\n}\n\nexport function fetch(input, init) {\n  return new Promise(function(resolve, reject) {\n    var request = new Request(input, init)\n\n    if (request.signal && request.signal.aborted) {\n      return reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    var xhr = new XMLHttpRequest()\n\n    function abortXhr() {\n      xhr.abort()\n    }\n\n    xhr.onload = function() {\n      var options = {\n        statusText: xhr.statusText,\n        headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n      }\n      // This check if specifically for when a user fetches a file locally from the file system\n      // Only if the status is out of a normal range\n      if (request.url.indexOf('file://') === 0 && (xhr.status < 200 || xhr.status > 599)) {\n        options.status = 200;\n      } else {\n        options.status = xhr.status;\n      }\n      options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n      var body = 'response' in xhr ? xhr.response : xhr.responseText\n      setTimeout(function() {\n        resolve(new Response(body, options))\n      }, 0)\n    }\n\n    xhr.onerror = function() {\n      setTimeout(function() {\n        reject(new TypeError('Network request failed'))\n      }, 0)\n    }\n\n    xhr.ontimeout = function() {\n      setTimeout(function() {\n        reject(new TypeError('Network request timed out'))\n      }, 0)\n    }\n\n    xhr.onabort = function() {\n      setTimeout(function() {\n        reject(new DOMException('Aborted', 'AbortError'))\n      }, 0)\n    }\n\n    function fixUrl(url) {\n      try {\n        return url === '' && g.location.href ? g.location.href : url\n      } catch (e) {\n        return url\n      }\n    }\n\n    xhr.open(request.method, fixUrl(request.url), true)\n\n    if (request.credentials === 'include') {\n      xhr.withCredentials = true\n    } else if (request.credentials === 'omit') {\n      xhr.withCredentials = false\n    }\n\n    if ('responseType' in xhr) {\n      if (support.blob) {\n        xhr.responseType = 'blob'\n      } else if (\n        support.arrayBuffer\n      ) {\n        xhr.responseType = 'arraybuffer'\n      }\n    }\n\n    if (init && typeof init.headers === 'object' && !(init.headers instanceof Headers || (g.Headers && init.headers instanceof g.Headers))) {\n      var names = [];\n      Object.getOwnPropertyNames(init.headers).forEach(function(name) {\n        names.push(normalizeName(name))\n        xhr.setRequestHeader(name, normalizeValue(init.headers[name]))\n      })\n      request.headers.forEach(function(value, name) {\n        if (names.indexOf(name) === -1) {\n          xhr.setRequestHeader(name, value)\n        }\n      })\n    } else {\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n    }\n\n    if (request.signal) {\n      request.signal.addEventListener('abort', abortXhr)\n\n      xhr.onreadystatechange = function() {\n        // DONE (success or failure)\n        if (xhr.readyState === 4) {\n          request.signal.removeEventListener('abort', abortXhr)\n        }\n      }\n    }\n\n    xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n  })\n}\n\nfetch.polyfill = true\n\nif (!g.fetch) {\n  g.fetch = fetch\n  g.Headers = Headers\n  g.Request = Request\n  g.Response = Response\n}\n", "/*\r\n * Utils.ts\r\n *\r\n * Module for utility functions\r\n */\r\n\r\n// Creates a promise that rejects in <ms> milliseconds and\r\n// returns the race between the created timeout promise and the passed in promise\r\nexport function createTimeoutPromise<T>(ms: number, promise: Promise<T>): Promise<T> {\r\n\t// Create a promise that rejects in <ms> milliseconds\r\n\tconst timeout = new Promise((resolve, reject) => {\r\n\t\tconst id = setTimeout(() => {\r\n\t\t\tclearTimeout(id);\r\n\t\t\treject(\"Timed out after \" + ms + \"ms.\");\r\n\t\t}, ms);\r\n\t});\r\n\r\n\t// Returns a race between our timeout and the passed in promise\r\n\treturn Promise.race([promise, timeout]) as Promise<T>;\r\n}\r\n\r\n// gets error message\r\nexport function getErrorMessage(value?: Error | string | object): string {\r\n\treturn (value as Error)?.message?.toString() ?? value?.toString();\r\n}\r\n\r\n/**\r\n * Check if an input value is null or undefined\r\n * @param value: input value\r\n */\r\nexport function isNOU(value: any): boolean {\r\n\treturn (value === null || value === undefined);\r\n}\r\n\r\n/**\r\n * Create guid string\r\n */\r\nexport function guid(): string {\r\n\t// Stitch in '4' in the third group\r\n\treturn (randomHex4() + randomHex4() + \"-\" + randomHex4() + \"-4\" + randomHex4().substr(0, 3) + \"-\" + randomHex4() + \"-\"\r\n\t\t+ randomHex4() + randomHex4() + randomHex4()).toLowerCase();\r\n}\r\n\r\n/**\r\n * Create random Hex4 string\r\n */\r\nfunction randomHex4(): string {\r\n\treturn (Math.floor(((1 + Math.random()) * 0x10000))).toString(16).substring(1);\r\n}\r\n\r\n/**\r\n * Check if an input value is an array\r\n * @param value: input value\r\n */\r\nexport function isArray(value: any): boolean {\r\n\treturn (value !== null && value !== undefined && (Array.isArray(value)));\r\n}\r\n\r\n/**\r\n * Check if an input value is an array\r\n * @param value: input value\r\n */\r\nexport function isFunction(value: any): boolean {\r\n\treturn (value !== null && value !== undefined && (typeof value === \"function\"));\r\n}\r\n\r\n/**\r\n * Check if an input value is an object\r\n * @param value: input value\r\n */\r\nexport function isObject(value: any): boolean {\r\n\treturn (value !== null && value !== undefined && (typeof value === \"object\"));\r\n}\r\n", "import \"../Polyfills/Fetch\";\r\nimport * as Utils from \"./Utils\";\r\n\r\nexport const FETCH_TIMEOUT = 5000;\r\n\r\nexport function sendGetRequest(requestUrl: string, token?: string, sessionId?: string,\r\n\tuseTimeout?: boolean, timeout?: number): Promise<Response> {\r\n\tconst requestInit = {\r\n\t\tmethod: \"GET\",\r\n\t\theaders: createHeaders(token, null, sessionId),\r\n\t};\r\n\r\n\treturn useTimeout ?\r\n\t\ttimeoutFetch(requestUrl, requestInit, timeout ?? FETCH_TIMEOUT) :\r\n\t\tfetch(requestUrl, requestInit);\r\n}\r\n\r\nexport function sendPostRequest(\r\n\trequestUrl: string, requestBody: string, token?: string, requestHeaders?: Record<string, string>, sessionId?: string,\r\n\tuseTimeout?: boolean, timeout?: number): Promise<Response> {\r\n\tconst requestInit = {\r\n\t\tmethod: \"POST\",\r\n\t\theaders: createHeaders(token, requestHeaders, sessionId),\r\n\t\tbody: requestBody,\r\n\t};\r\n\r\n\treturn useTimeout ?\r\n\t\ttimeoutFetch(requestUrl, requestInit, timeout ?? FETCH_TIMEOUT) :\r\n\t\tfetch(requestUrl, requestInit);\r\n}\r\n\r\nfunction createHeaders(token?: string, requestHeaders?: Record<string, string>, sessionId?: string): Headers {\r\n\tconst headers: Headers = typeof Headers !== \"undefined\" && new Headers();\r\n\r\n\tif (headers) {\r\n\t\tif (!Utils.isNOU(token)) {\r\n\t\t\theaders.append(\"Authorization\", \"Bearer \" + token);\r\n\t\t}\r\n\r\n\t\tif (!Utils.isNOU(requestHeaders)) {\r\n\t\t\tfor (const key in requestHeaders) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(requestHeaders, key)) {\r\n\t\t\t\t\theaders.append(key, requestHeaders[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\theaders.append(\"X-CorrelationId\", Utils.guid());\r\n\t\tif (sessionId) {\r\n\t\t\theaders.append(\"X-ClientSessionId\", sessionId);\r\n\t\t}\r\n\t}\r\n\r\n\treturn headers;\r\n}\r\n\r\nfunction timeoutFetch(input: RequestInfo, init: RequestInit = {}, timeout: number): Promise<Response> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tfetch(input, init).then(resolve, reject);\r\n\t\tsetTimeout(() => reject(new Error(\"Service request timed out\")), timeout);\r\n\t});\r\n}\r\n", "export const enum ContentType {\r\n\tmessageMetadata     = \"MessageMetadata\",    // metadata about messages\r\n\tuserGovernanceRules = \"UserGovernance\",     // user Governance (ATC) from IRIS\r\n\tcampaignContent     = \"CampaignContent\",    // campaigns for Floodgate\r\n\tdynamicSettings     = \"DynamicSettings\",    // dynamic settings from TMS service\r\n\tlogLevelSettings    = \"LogLevelSettings\",   // log level settings from TMS service\r\n\tuserFacts           = \"UserFacts\",          // user facts from TULIPS service\r\n}\r\n\r\nexport const ContentTypeToStorageKeyMap: { [k in ContentType]: string } = {\r\n\t[ContentType.campaignContent]: \"obf-TmsCampaignContent\",\r\n\t[ContentType.dynamicSettings]: \"obf-TmsDynamicSettings\",\r\n\t[ContentType.logLevelSettings]: \"obf-LogLevelSettings\",\r\n\t[ContentType.messageMetadata]: \"obf-TmsMessageMetadata\",\r\n\t[ContentType.userFacts]: \"obf-UserFacts\",\r\n\t[ContentType.userGovernanceRules]: \"obf-TmsUserGovernance\",\r\n};\r\n", "import { ContentType, ContentTypeToStorageKeyMap } from \"../Common/ContentType\";\r\nimport { ISourcedUserFact, IUserFact, UserFactSource } from \"../Common/Models\";\r\nimport { getCachedContent, getValidCachedContent } from \"../Utils/Caching\";\r\n\r\nexport const UserFactLocalStorageKey = ContentTypeToStorageKeyMap[ContentType.userFacts];\r\n\r\n// Get UserFacts\r\nexport function getCachedUserFacts(userId?: string): IUserFact[] {\r\n\treturn getCachedContent(UserFactLocalStorageKey);\r\n}\r\n\r\n// Get UserFacts\r\nexport function getUnExpiredCachedUserFacts(userId?: string): IUserFact[] {\r\n\treturn getValidCachedContent(UserFactLocalStorageKey, null);\r\n}\r\n\r\n// Merges or appends local UserFacts into the input array (usually remote facts)\r\nexport function mergeLocalUserFacts(inputUserFacts?: IUserFact[]): IUserFact[] {\r\n\tconst localUserFacts: IUserFact[] = getCachedContent(UserFactLocalStorageKey);\r\n\tif (!localUserFacts) {\r\n\t\treturn inputUserFacts;\r\n\t}\r\n\r\n\tif (!inputUserFacts) {\r\n\t\treturn localUserFacts;\r\n\t}\r\n\r\n\tlocalUserFacts.forEach(localFact => {\r\n\t\tconst localSourcedFact = localFact as ISourcedUserFact;\r\n\t\tif (localSourcedFact?.source == UserFactSource.Local) {\r\n\t\t\tconst matchingInputFact = inputUserFacts.find(inputFact => inputFact.userFactName == localFact.userFactName);\r\n\t\t\tif (!matchingInputFact) {\r\n\t\t\t\t// if the local fact doesn't exist in input/remote list, then append to the list\r\n\t\t\t\tinputUserFacts.push(localSourcedFact);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// if local fact is newer, update the fact value from local cache\r\n\t\t\tif (localFact.sourceDateTime > matchingInputFact.sourceDateTime) {\r\n\t\t\t\tmatchingInputFact.sourceDateTime = localFact.sourceDateTime;\r\n\t\t\t\tmatchingInputFact.userFactValue = localFact.userFactValue;\r\n\t\t\t\t(matchingInputFact as ISourcedUserFact).source = UserFactSource.Local;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\treturn inputUserFacts;\r\n}\r\n", "import { ContentType } from \"../Common/ContentType\";\r\nimport { ISourcedUserFact, IUserFact, UserFactSource } from \"../Common/Models\";\r\nimport { getSetting, getSamplingRate } from \"../Common/Settings\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport { EventIds } from \"../Logging/Constants\";\r\nimport * as Logging from \"../Logging/Logger\";\r\nimport { saveToCache } from \"../Utils/Caching\";\r\nimport { sendGetRequest } from \"../Utils/Transport\";\r\nimport { createTimeoutPromise, getErrorMessage } from \"../Utils/Utils\";\r\nimport { UserFactLocalStorageKey, mergeLocalUserFacts } from \"./CachedUserFacts\";\r\nimport { AppUsageUserFactType } from \"./Constants\";\r\n\r\nexport function createStringOfFactNames(factNames: string[]): string {\r\n\tif (!factNames)\r\n\t\treturn undefined;\r\n\r\n\treturn factNames.join(\", \");\r\n}\r\n\r\nexport function getUserFactNames(userFacts: IUserFact[]): string[] {\r\n\treturn userFacts?.map(uf => uf.userFactName);\r\n}\r\n\r\nfunction createTelemetryData(requestStartTimestamp: number, response: Response, count = -1, factNames: string[] = undefined, samplingRate = -1) {\r\n\tconst { headers, status, statusText } = response || {} as Response;\r\n\tconst serverSessionId = headers && headers.get(\"X-ClientSessionId\");\r\n\tconst serverCorrelationId = headers && headers.get(\"X-CorrelationId\");\r\n\r\n\treturn {\r\n\t\tCorrelationId: serverCorrelationId || undefined,\r\n\t\tCount: count,\r\n\t\tHttpStatusCode: status || undefined,\r\n\t\tHttpStatusText: statusText || undefined,\r\n\t\tFactNames: createStringOfFactNames(factNames),\r\n\t\tSamplingRate: samplingRate,\r\n\t\tSessionId: serverSessionId,\r\n\t\tTimeMilliseconds: +new Date() - requestStartTimestamp,\r\n\t};\r\n}\r\n\r\nexport async function fetchUserFacts(authToken: string): Promise<IUserFact[]> {\r\n\tconst requestStartTime = +new Date();\r\n\tlet userFacts = null;\r\n\r\n\t// make service call and save the response to local cache\r\n\ttry {\r\n\t\tconst serviceUrl = getSetting(\"userFactsUrl\") as string;\r\n\t\tconst samplingRate = getSamplingRate();\r\n\t\tconst response: Response = await sendGetRequest(serviceUrl, authToken, Configuration.get().getSessionId());\r\n\t\tif (response.status === 200 || response.status === 204) {\r\n\t\t\tconst userFactsResponse: IUserFact[] = await response.json();\r\n\t\t\tuserFacts = updateAndSaveUserFacts(userFactsResponse);\r\n\r\n\t\t\tif (!userFacts || userFacts.length === 0) {\r\n\t\t\t\tLogging.getLogger().event(EventIds.UserFactsCommonErrorNoFactsReturned, createTelemetryData(requestStartTime, response));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tLogging.getLogger().event(EventIds.UserFactsCommonInfo, createTelemetryData(requestStartTime, response, \r\n\t\t\t\t\tuserFacts.length, getUserFactNames(userFacts), samplingRate), samplingRate);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tLogging.getLogger().event(EventIds.UserFactsCommonError, createTelemetryData(requestStartTime, response));\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tLogging.getLogger().event(EventIds.UserFactsCommonError, { ...createTelemetryData(requestStartTime, null),\r\n\t\t\terror: getErrorMessage(error) });\r\n\t}\r\n\r\n\treturn userFacts;\r\n}\r\n\r\nexport function fetchUserFactsWithTimeout(authToken: string): Promise<IUserFact[]> {\r\n\tconst userFactsPromise = fetchUserFacts(authToken);\r\n\tconst requestTimeout = getSetting<number>(\"userFactsRequestTimeOut\");\r\n\r\n\treturn createTimeoutPromise(requestTimeout, userFactsPromise);\r\n}\r\n\r\nfunction updateAndSaveUserFacts(userFactsResponse: IUserFact[]): IUserFact[] {\r\n\tif (!userFactsResponse || userFactsResponse.length == 0) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst normalizedUserFacts = addClientIngestionTimeAndNormalizeKeys(userFactsResponse);\r\n\tconst userFacts = mergeLocalUserFacts(normalizedUserFacts);\r\n\tconst cacheExpiration = getSetting<number>(\"userFactsCacheExpiration\");\r\n\tsaveToCache(ContentType.userFacts, userFacts, cacheExpiration, UserFactLocalStorageKey);\r\n\treturn userFacts;\r\n}\r\n\r\nexport function addClientIngestionTimeAndNormalizeKeys(tulipsResponseFacts: IUserFact[]): IUserFact[] {\r\n\tconst currentDateTime = new Date(Date.now()).toISOString();\r\n\r\n\treturn tulipsResponseFacts.map((responseFact) => {\r\n\t\tconst fact = normalizeKeys(responseFact);\r\n\t\tfact.clientIngestionDateTime = currentDateTime;\r\n\t\treturn fact;\r\n\t});\r\n}\r\n\r\n/**\r\n * Iterate through the current list of user facts to update the source date time of given fact\r\n * @param userFactName the user fact to be updated\r\n * @param newSourceDateTime the new source date time\r\n * @param userFacts the list of user facts\r\n */\r\nexport function addOrUpdateAppUsageUserFact(userFactName: string, newSourceDateTime: string, userFacts: IUserFact[]): IUserFact[] {\r\n\tif (!userFacts) {\r\n\t\tuserFacts = [];\r\n\t}\r\n\r\n\tconst fact: ISourcedUserFact = userFacts.find(uf => uf.userFactName === userFactName);\r\n\tif (fact) { \r\n\t\tfact.sourceDateTime = newSourceDateTime;\r\n\t\tfact.userFactValue = newSourceDateTime;\r\n\t\tfact.storageDateTime = newSourceDateTime;\r\n\t\tfact.source = UserFactSource.Local;\r\n\t} else { \r\n\t\t// if fact did not already exist in cache, add it\r\n\t\tconst newFact: ISourcedUserFact = {\r\n\t\t\tuserFactType: AppUsageUserFactType,\r\n\t\t\tuserFactName: userFactName,\r\n\t\t\tuserFactValue: newSourceDateTime,\r\n\t\t\tsourceDateTime: newSourceDateTime,\r\n\t\t\tstorageDateTime: newSourceDateTime,\r\n\t\t\tclientIngestionDateTime: \"\",\r\n\t\t\tsource: UserFactSource.Local\r\n\t\t};\r\n\r\n\t\tuserFacts.push(newFact);\r\n\t}\r\n\r\n\treturn userFacts;\r\n}\r\n\r\n/**\r\n * This method normalizes the keys of the user fact object retrieved from the TULIPS service.\r\n * Specifically it converts the first letter of each key in the object to lower case.\r\n * For example the key \"UserFactType\" returned from the service will be converted to \"userFactType\".\r\n * @param userFact the user fact object\r\n */\r\nfunction normalizeKeys(userFact: IUserFact) {\r\n\tconst normalizedUserFact = {} as IUserFact;\r\n\tfor (const key of Object.keys(userFact)) {\r\n\t\tconst normalizedKey = (key.charAt(0).toLowerCase() + key.substring(1)) as keyof IUserFact;\r\n\t\tnormalizedUserFact[normalizedKey] = (userFact as any)[key] as (string & Date);\r\n\t}\r\n\r\n\treturn normalizedUserFact;\r\n}\r\n", "import { IPersonalizationAuthConfig, IUserFact, IUserFactManifest, IUserFactMap, IUserFactRulesMap } from \"../Common/Models\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport { getSamplingRate, getSetting } from \"../Common/Settings\";\r\nimport { ContentType } from \"../Common/ContentType\";\r\nimport { EventIds } from \"../Logging/Constants\";\r\nimport * as Logger from \"../Logging/Logger\";\r\nimport { updateCache } from \"../Utils/Caching\";\r\nimport { AppLastUsedEventNames } from \"./Constants\";\r\nimport { EvaluateEvent, EvaluateTelemetryEvent } from \"./UserFactManifest\";\r\nimport { addOrUpdateAppUsageUserFact, createStringOfFactNames, fetchUserFactsWithTimeout, getUserFactNames } from \"./UserFactsClient\";\r\nimport { getCachedUserFacts, getUnExpiredCachedUserFacts, UserFactLocalStorageKey } from \"./CachedUserFacts\";\r\nimport { TelemetryEvent } from \"@microsoft/oteljs\";\r\nimport { getErrorMessage } from \"../Utils/Utils\";\r\n\r\nconst authTokenConfigProd: IPersonalizationAuthConfig = {\r\n\tscenario: \"tulips\",\r\n\tappId: \"https://attributes.engagement.office.com/UserFacts.Read\",\r\n};\r\n\r\nexport function mapUserFacts(userFacts: IUserFact[]): IUserFactMap {\r\n\tif (!userFacts) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst userFactMap: IUserFactMap = {};\r\n\tuserFacts.forEach((uf) => userFactMap[uf.userFactName] = uf);\r\n\treturn userFactMap;\r\n}\r\n\r\n// Get UserFacts\r\nexport async function getUserFactList(userId: string,\r\n\tauthCallback: (authTokenConfig: IPersonalizationAuthConfig) => Promise<string>): Promise<IUserFact[]> {\r\n\tlet userFacts = getUnExpiredCachedUserFacts(userId);\r\n\tif (!userFacts || userFacts.length == 0) {\r\n\t\ttry {\r\n\t\t\tconst authToken = authCallback && await authCallback(authTokenConfigProd);\r\n\t\t\tuserFacts = authToken && await fetchUserFactsWithTimeout(authToken);\r\n\t\t} catch (exception) {\r\n\t\t\tLogger.getLogger().event(EventIds.UserFactsCommonError, { error: getErrorMessage(exception) });\r\n\t\t}\r\n\t} else {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsCommonCacheLoad,\r\n\t\t\tcreateTelemetryDataForCacheRead(userFacts?.length, getUserFactNames(userFacts)), getSamplingRate());\r\n\t}\r\n\r\n\treturn userFacts;\r\n}\r\n\r\n// Get UserFacts\r\nexport async function getUserFacts(userId: string,\r\n\tauthCallback: (authTokenConfig: IPersonalizationAuthConfig) => Promise<string>): Promise<IUserFactMap> {\r\n\tconst userFactList = await getUserFactList(userId, authCallback);\r\n\treturn userFactList && mapUserFacts(userFactList);\r\n}\r\n\r\nexport function getUserFactManifest(): IUserFactRulesMap {\r\n\treturn Configuration.get().getUserFactRules();\r\n}\r\n\r\nexport function sendAppLastUsed(appId: number, lastUsedTime: Date): void {\r\n\tif (!AppLastUsedEventNames[appId]) {\r\n\t\treturn;\r\n\t}\r\n\tprocessUserFactEvent(AppLastUsedEventNames[appId], lastUsedTime);\r\n}\r\n\r\nexport function processTelemetryEvent(telemetryEvent: TelemetryEvent) {\r\n\tif (!telemetryEvent || !telemetryEvent.eventName) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst userFactRules = getUserFactManifest();\r\n\tif (!userFactRules) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsNullTelemetryEventRulesMap, { Name: telemetryEvent.eventName }, getSamplingRate());\r\n\t\treturn;\r\n\t}\r\n\tconst manifest = userFactRules[telemetryEvent.eventName];\r\n\t\r\n\ttry {\r\n\t\tif (!manifest) {\r\n\t\t\t// Manifest for this event does not exist\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst cachedFactLastSourceTime = readLastSourceTimeFromCache(manifest.userFactName);\r\n\t\tconst userFactTime = new Date(telemetryEvent.timestamp)\r\n\r\n\t\tif (!EvaluateTelemetryEvent(manifest, telemetryEvent, userFactTime, cachedFactLastSourceTime)) {\r\n\t\t\t// fact was not written to local storage\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsendUserFact(manifest.userFactName, userFactTime)\r\n\r\n\t} catch (error) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsProcessTelemetryEventError, { error: getErrorMessage(error), Name: telemetryEvent.eventName });\r\n\t\treturn;\r\n\t}\r\n}\r\n\r\nexport function processUserFactEvent(eventName: string, userFactTime: Date) {\r\n\tif (!eventName || !userFactTime) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst userFactRules = getUserFactManifest();\r\n\tif (!userFactRules) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsNullUserFactRulesMap, { Name: eventName }, getSamplingRate());\r\n\t\treturn;\r\n\t}\r\n\tconst manifest = userFactRules[eventName];\r\n\r\n\ttry {\r\n\t\tif (!manifest) {\r\n\t\t\t// Manifest for this user fact event does not exist\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst cachedFactLastSourceTime = readLastSourceTimeFromCache(manifest.userFactName);\r\n\t\t\r\n\t\tif (!EvaluateEvent(manifest, userFactTime, cachedFactLastSourceTime)) {\r\n\t\t\t// fact was not written to local storage\r\n\t\t\treturn;\r\n\t\t} \r\n\t\tsendUserFact(manifest.userFactName, userFactTime);\r\n\t\treturn;\r\n\t\t\r\n\t} catch (error) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsProcessUserFactEventError, { error: getErrorMessage(error), Name: eventName });\r\n\t\treturn;\r\n\t}\r\n}\r\n\r\nexport function sendUserFact(userFactName: string, userFactTime: Date) {\t\r\n\tLogger.getLogger().userFactEvent(userFactName, userFactTime.toISOString());\r\n\twriteFactToCache(userFactName, userFactTime.toISOString());\r\n\tLogger.getLogger().event(EventIds.UserFactsSendUserFactSuccess, { Name: userFactName }, getSamplingRate());\r\n}\r\n\r\nexport function readLastSourceTimeFromCache(factKey: string): Date {\r\n\tlet cachedUserFacts;\r\n\ttry {\r\n\t\tcachedUserFacts = mapUserFacts(getCachedUserFacts());\r\n\t\tif (!cachedUserFacts) {\r\n\t\t\tLogger.getLogger().event(EventIds.UserFactsEmptyCache, { Name: factKey });\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst lastSourceTime = (cachedUserFacts[factKey]) ? cachedUserFacts[factKey].sourceDateTime : null;\r\n\t\tif (!lastSourceTime) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn new Date(lastSourceTime);\r\n\r\n\t} catch(error) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsReadCacheError, { error: getErrorMessage(error), Name: factKey });\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport function writeFactToCache(factKey: string, factTime: string) {\r\n\tlet cachedUserFacts;\r\n\ttry {\r\n\t\tcachedUserFacts = getCachedUserFacts();\r\n\r\n\t\t// Do not set expiration if there are no cached entries in first time boot scenarios.\r\n\t\t// This to let subsequent service call go through.\r\n\t\tconst cacheExpiration = cachedUserFacts ? getSetting<number>(\"userFactsCacheExpiration\") : -1;\r\n\t\tconst mergedFacts = addOrUpdateAppUsageUserFact(factKey, factTime, cachedUserFacts);\r\n\t\t\r\n\t\tupdateCache(ContentType.userFacts, mergedFacts, cacheExpiration, UserFactLocalStorageKey);\r\n\t} catch(error) {\r\n\t\tLogger.getLogger().event(EventIds.UserFactsWriteCacheError, { error: getErrorMessage(error), Name: factKey })\r\n\t}\r\n}\r\n\r\nfunction createTelemetryDataForCacheRead(count = -1, factNames: string[] = undefined): Logger.ICustomLogData {\r\n\treturn {\r\n\t\tCount: count,\r\n\t\tFactNames: createStringOfFactNames(factNames),\r\n\t};\r\n}\r\n", "import { setLogger } from \"../Logging/Logger\";\r\nimport * as Logger from \"../Logging/Logger\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport { IPersonalizationConfig, IUserFactRulesMap } from \"./Models\";\r\nimport { getSamplingRate, initSettings } from \"./Settings\";\r\nimport { sendAppLastUsed } from \"../Facts/UserFacts\";\r\nimport { EventIds } from \"../Logging/Constants\";\r\n\r\nexport function initialize(config?: IPersonalizationConfig) {\r\n\tsetLogger(config?.logger);\r\n\tinitSettings(config?.settings);\r\n\r\n\tif (config?.sessionId) {\r\n\t\tConfiguration.get().setSessionId(config.sessionId);\r\n\t}\r\n\r\n\tif (config?.userFactConfig?.enableSendUserFacts) {\r\n\t\tconst currentDateTime = new Date();\r\n\r\n\t\tconst filteredRules = filterDisabledUserFactRules(config.userFactConfig.disabledUserFacts, config.userFactConfig.userFactRules)\r\n\t\tConfiguration.get().setUserFactRules(filteredRules);\r\n\t\tLogger.getLogger().event(EventIds.UserFactsConfigRules, { Message: JSON.stringify(filteredRules) }, getSamplingRate());\r\n\t\t\r\n\t\tif (config.settings?.appId) {\r\n\t\t\tsendAppLastUsed(config.settings.appId, currentDateTime);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Removes manifests for disabled UserFacts\r\n * @param disabledUserFacts list of UserFacts to disable and not send\r\n * @param userFactRules static map of all UserFactManifests. Modifies map\r\n * by removing disabled userFacts\r\n */\r\nexport function filterDisabledUserFactRules(disabledUserFacts: string[], userFactRules: IUserFactRulesMap) : IUserFactRulesMap {\r\n\t\r\n\tconst enabledRulesMap : IUserFactRulesMap = userFactRules;\r\n\r\n\tif (!userFactRules || !disabledUserFacts) {\r\n\t\treturn enabledRulesMap;\r\n\t}\r\n\r\n\tObject.keys(enabledRulesMap).forEach(key => {\r\n\t\tif(disabledUserFacts.find(fact => fact == enabledRulesMap[key].userFactName)) {\r\n\t\t\tdelete enabledRulesMap[key];\r\n\t\t}\r\n\t});\r\n\r\n\treturn enabledRulesMap;\r\n}\r\n", "/**\r\n * Constants.ts\r\n *\r\n * A module for non-UI constants.\r\n */\r\n\r\n/**\r\n * Value for the Customer Voice Launcher Type\r\n */\r\nexport const customerVoiceLauncherType = \"customervoice\";\r\n\r\n/**\r\n * Value for the Customer Voice Survey text for adding to App data\r\n */\r\nexport const customerVoiceSurveyUX = \"Customer Voice Survey UX\";\r\n\r\n/**\r\n * Values for types of feedback that go into the json\r\n * Also used to determine the FormTemplate used on each one of the feedback types.\r\n */\r\nexport enum FeedbackType {\r\n\tSmile,\r\n\tFrown,\r\n\tIdea,\r\n\tBug,\r\n\tIdeaRedirect,\r\n}\r\n\r\n/**\r\n * Values for types of panels that go into the json\r\n * Also used to determine the PanelTemplate used on each one of the panel types.\r\n */\r\nexport const enum PanelType {\r\n\tThanks\r\n}\r\n\r\n/**\r\n * Values for the environment\r\n */\r\nexport const enum Environment {\r\n\tProduction,\r\n\tInt\r\n}\r\n\r\n/**\r\n * Values for autodismiss\r\n */\r\nexport const enum AutoDismissValues {\r\n\tNoAutoDismiss,\r\n\tSevenSeconds,\r\n\tFourteenSeconds,\r\n\tTwentyOneSeconds,\r\n\tTwentyEightSeconds,\r\n\tSixtySeconds,\r\n\tNinetySeconds,\r\n\tOneHundredAndTwentySeconds,\r\n\tOneHundredAndFiftySeconds,\r\n}\r\n\r\n/**\r\n * Dynamic scripts\r\n */\r\nexport class DynamicScriptUrls {\r\n\t/**\r\n\t * Link to the Office WebSurfaces UX package\r\n\t */\r\n\tpublic static WebSurfacesIntLink = \"https://res-sdf.cdn.office.net/office-growth/resources/programmablesurfaces/int/officewebsurfaces.core.min.js\";\r\n\tpublic static WebSurfacesProdLink = \"https://res.cdn.office.net/office-growth/resources/programmablesurfaces/prod/officewebsurfaces.core.min.js\";\r\n}\r\n\r\n/**\r\n * Constant GUIDs\r\n */\r\nexport class GUIDs {\r\n\tpublic static TMSAppID = \"4c4f550b-42b2-4a16-93f9-fdb9e01bb6ed\";\r\n\tpublic static TULIPSAppID = \"05c88d91-956e-46b4-91b0-77a33cc21a4d\";\r\n}\r\n\r\nexport const enum OCPSValues {\r\n\tNotConfigured = 0,\r\n\tEnabled = 1,\r\n\tDisabled = 2\r\n}\r\n\r\nexport const enum FeedbackStatus {\r\n\tEnabled,\r\n\tDisabledByAdmin,\r\n\tDisabledByAgeGroup\r\n}\r\n\r\n/**\r\n * Prefix for SDK version string\r\n */\r\nexport const SDK_VERSION_PREFIX = \"Web SDK v\";\r\n\r\n/**\r\n * UxId version constant. (This needs to be changed if a significant UX modification is made.)\r\n * This is concatenated to the sdkVersion string in the manifest.\r\n */\r\nexport const SDK_UXID_VERSION = \"UxId:built-in|comp2022_v1\";\r\n\r\n\r\n/**\r\n * Default Personalization Sampling Rate to be used if no value is passed in\r\n */\r\nexport const SDK_DEFAULT_PERSONALIZATIONSAMPLINGRATE = 1;\r\n\r\n/**\r\n * Centro default theme string value\r\n */\r\nexport const CentroDefaultTheme = 'M365Light';\r\n\r\n/**\r\n * mapping for feature gate name to feature gate string \r\n * Microsoft.Office.SharedOnline will be prepended in host app implementation \r\n */\r\nexport enum FeatureGateNames {\r\n\tTeachingChannelServiceGovernanceEnabled = \"TeachingChannelServiceGovernanceEnabled\",\r\n\tGovernanceLocalUserIdOverride = \"GovernanceLocalUserIdOverride\",\r\n\tGovernanceServiceCheckAllowedCampaignIds = \"GovernanceServiceCheckAllowedCampaignIds\",\r\n\tGovernanceServiceCheckAllowedCampaignIdsExt = \"GovernanceServiceCheckAllowedCampaignIdsExt\",\r\n\tGovernanceServiceEnabledChannels = \"GovernanceServiceEnabledChannels\",\r\n\tGovernanceServiceIntURL = \"GovernanceServiceIntURL\",\r\n\tGovernanceServiceProdURL = \"GovernanceServiceProdURL\",\r\n\tTestBooleanFeatureGate = \"DynamicFeatureStatusTestBoolean\",\r\n\tTestStringFeatureGate = \"DynamicFeatureStatusTestString\",\r\n\tTestIntFeatureGate = \"DynamicFeatureStatusTestInt\",\r\n}\r\n", "/**\r\n * Localization.ts\r\n *\r\n * Module for Localization\r\n */\r\n\r\n/**\r\n * List of supported Locales\r\n * REMINDER: update readme to match the list below if change is made\r\n */\r\nconst supportedLocales: string[] = [\r\n\t\"af\",\r\n\t\"am\",\r\n\t\"ar\",\r\n\t\"as\",\r\n\t\"az\",\r\n\t\"be\",\r\n\t\"bg\",\r\n\t\"bn-BD\",\r\n\t\"bn-IN\",\r\n\t\"bs\",\r\n\t\"ca\",\r\n\t\"ca-Es-VALENCIA\",\r\n\t\"chr-Cher\",\r\n\t\"cs\",\r\n\t\"cy\",\r\n\t\"da\",\r\n\t\"de\",\r\n\t\"el\",\r\n\t\"en-GB\",\r\n\t\"es\",\r\n\t\"es-MX\",\r\n\t\"et\",\r\n\t\"eu\",\r\n\t\"fa\",\r\n\t\"fi\",\r\n\t\"fil\",\r\n\t\"fr\",\r\n\t\"fr-CA\",\r\n\t\"ga\",\r\n\t\"gd\",\r\n\t\"gl\",\r\n\t\"gu\",\r\n\t\"ha-Latn-NG\",\r\n\t\"he\",\r\n\t\"hi\",\r\n\t\"hr\",\r\n\t\"hu\",\r\n\t\"hy\",\r\n\t\"id\",\r\n\t\"is\",\r\n\t\"it\",\r\n\t\"ja\",\r\n\t\"ka\",\r\n\t\"kk\",\r\n\t\"km-KH\",\r\n\t\"kn\",\r\n\t\"ko\",\r\n\t\"kok\",\r\n\t\"ky\",\r\n\t\"lb\",\r\n\t\"lo\",\r\n\t\"lt\",\r\n\t\"lv\",\r\n\t\"mi\",\r\n\t\"mk\",\r\n\t\"ml\",\r\n\t\"mn\",\r\n\t\"mr\",\r\n\t\"ms\",\r\n\t\"mt\",\r\n\t\"nb-NO\",\r\n\t\"ne\",\r\n\t\"nl\",\r\n\t\"nn-NO\",\r\n\t\"or\",\r\n\t\"pa\",\r\n\t\"pl\",\r\n\t\"prs\",\r\n\t\"pt-BR\",\r\n\t\"pt-PT\",\r\n\t\"quz\",\r\n\t\"ro\",\r\n\t\"ru\",\r\n\t\"sd\",\r\n\t\"si\",\r\n\t\"sk\",\r\n\t\"sl\",\r\n\t\"sq\",\r\n\t\"sr-Cyrl-BA\",\r\n\t\"sr-Cyrl-RS\",\r\n\t\"sr-Latn-RS\",\r\n\t\"sv\",\r\n\t\"sw\",\r\n\t\"ta\",\r\n\t\"te\",\r\n\t\"th\",\r\n\t\"tk\",\r\n\t\"tr\",\r\n\t\"tt\",\r\n\t\"ug\",\r\n\t\"uk\",\r\n\t\"ur\",\r\n\t\"uz-Latn-UZ\",\r\n\t\"vi\",\r\n\t\"zh-Hans\",\r\n\t\"zh-Hant\",\r\n];\r\n\r\nconst localeVariantToSupportedlocaleMap: { [key: string]: string } = {\r\n\t\"ZH-CN\": \"zh-Hans\",\r\n\t\"ZH-HK\": \"zh-Hant\",\r\n\t\"ZH-MO\": \"zh-Hant\",\r\n\t\"ZH-SG\": \"zh-Hans\",\r\n\t\"ZH-TW\": \"zh-Hant\",\r\n};\r\n\r\nexport function validate(locale: string): string {\r\n\tconst localeUpperCase = locale.toLocaleUpperCase();\r\n\r\n\t// support for Chinese ll-cc, VSO Bug 1583389\r\n\tif (localeUpperCase in localeVariantToSupportedlocaleMap) {\r\n\t\treturn localeVariantToSupportedlocaleMap[localeUpperCase];\r\n\t}\r\n\r\n\t// return supported locale if exact match found\r\n\tfor (const supportedLocale of supportedLocales) {\r\n\t\tif (supportedLocale.toUpperCase() === localeUpperCase) {\r\n\t\t\treturn supportedLocale;\r\n\t\t}\r\n\t}\r\n\r\n\tconst localePartOne = localeUpperCase.split(\"-\")[0];\r\n\t// return supported \"ll\" if exact match not found, but \"ll\" matches\r\n\tfor (const supportedLocale of supportedLocales) {\r\n\t\tif (supportedLocale.toUpperCase() === localePartOne) {\r\n\t\t\treturn supportedLocale;\r\n\t\t}\r\n\t}\r\n\r\n\t// default everything else to en\r\n\treturn \"en\";\r\n}\r\n", "/*\r\n * Utils.ts\r\n *\r\n * Module for utility functions\r\n */\r\n\r\nimport { Utils } from \"@ms-ofb/officefloodgatecore\";\r\nimport * as Constants from \"./Constants\";\r\nconst { guid, overrideValues, isNOU, isBoolean, isString, isObject, isEnumValue } = Utils;\r\nexport { guid, isBoolean, isNOU, isObject, isString, overrideValues };\r\n\r\n/**\r\n * Check if given value is a number\r\n * @param {any} value value\r\n */\r\nfunction isNumber(value: any): boolean {\r\n\treturn (typeof value === \"number\");\r\n}\r\n\r\n/**\r\n * Check if given value is an integer\r\n * @param {any} value value\r\n */\r\nexport function isInteger(value: any): boolean {\r\n\treturn typeof value === \"number\" &&\r\n\t\tisFinite(value) &&\r\n\t\tMath.floor(value) === value;\r\n}\r\n\r\n/**\r\n * Check if value is a valid guid\r\n * @param {any} value value\r\n */\r\nfunction isGuid(value: any): boolean {\r\n\treturn (isString(value) &&\r\n\t\t/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(value));\r\n}\r\n\r\n/**\r\n * Throw if not object\r\n */\r\nexport function expectObject(value: any, name: string): void {\r\n\tif (!isObject(value)) {\r\n\t\tthrow name + \" is not an object: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not number\r\n */\r\nexport function expectNumber(value: any, name: string): void {\r\n\tif (!isNumber(value)) {\r\n\t\tthrow name + \" is not a number: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not string\r\n */\r\nexport function expectString(value: any, name: string): void {\r\n\tif (!isString(value)) {\r\n\t\tthrow name + \" is not a string: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not boolean\r\n */\r\nexport function expectBoolean(value: any, name: string): void {\r\n\tif (!isBoolean(value)) {\r\n\t\tthrow name + \" is not a boolean: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not guid\r\n */\r\nexport function expectGuid(value: any, name: string): void {\r\n\tif (!isGuid(value)) {\r\n\t\tthrow name + \" is not a guid: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not array\r\n */\r\nexport function expectArray(value: any, name: string): void {\r\n\tif (!Array.isArray(value)) {\r\n\t\tthrow name + \" is not an array: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not valid enum\r\n * Note: this won't work with const enum\r\n */\r\nexport function expectEnum(value: any, enumType: any, name: string): void {\r\n\tif (!isNumber(value) || !isEnumValue(value, enumType)) {\r\n\t\tthrow name + \" is not an enum: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * Throw if not number or string or boolean\r\n */\r\nexport function expectSimpleType(value: any, name: string): void {\r\n\tif (!isString(value) && !isNumber(value) && !isBoolean(value)) {\r\n\t\tthrow name + \" is not a string or number or boolean: \" + value;\r\n\t}\r\n}\r\n\r\n/**\r\n * throw if not a function\r\n */\r\nexport function expectFunction(value: any, name: string): void {\r\n\tif (isNOU(value) && typeof value !== \"function\") {\r\n\t\tthrow name + \" is not a function: \" + value;\r\n\t}\r\n}\r\n\r\n// Creates a promise that rejects in <ms> milliseconds and\r\n// returns the race between the created timeout promise and the passed in promise\r\nexport function createTimeoutPromise<T>(ms: number, promise: Promise<T>): Promise<T> {\r\n\t// Create a promise that rejects in <ms> milliseconds\r\n\tconst timeout = new Promise((resolve, reject) => {\r\n\t\tconst id = setTimeout(() => {\r\n\t\t\tclearTimeout(id);\r\n\t\t\treject(\"Timed out in \" + ms + \"ms.\");\r\n\t\t}, ms);\r\n\t});\r\n\r\n\t// Returns a race between our timeout and the passed in promise\r\n\treturn Promise.race([promise, timeout]) as Promise<T>;\r\n}\r\n\r\nexport function isTenantIdCommercial (tenantId: string): boolean {\r\n\r\n\t// if tenantId is not defined correctly -> consumer\r\n\tif (isNOU(tenantId) || tenantId === \"\" || !isGuid(tenantId)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconst lowerTenantId = tenantId.toLowerCase();\r\n\r\n\t// if id is all zeros or one of the special consumer tenant ids -> consumer\r\n\t// For further reference see how OCV treats these IDs: \r\n\t// https://office.visualstudio.com/CLE/_git/OfficeCustomerVoice?path=%2FIngestion%2FIngestion.Floodgate%2FFloodgateDataExtractor.cs\r\n\tif (lowerTenantId === \"00000000-0000-0000-0000-000000000000\"\r\n\t\t|| lowerTenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\"\r\n\t\t|| lowerTenantId === \"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa\") {\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// any other case -> commercial\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Convert the policy value from Office Control Policy Service (ocps) to string\r\n * @param policyValue \r\n * @returns string\r\n */\r\nexport function ocpsBooleanToString(policyValue?: boolean) {\r\n\tif (policyValue === undefined) {\r\n\t\treturn \"Not Configured\";\r\n\t}\r\n\r\n\tif (policyValue) {\r\n\t\treturn \"Enabled\";\r\n\t}\r\n\r\n\treturn \"Disabled\";\r\n}\r\n\r\n/**\r\n * Convert the policy enum from Office Control Policy Service (ocps) to string\r\n * @param policyValue \r\n * @returns string\r\n */\r\nexport function ocpsEnumToString(policyValue?: Constants.OCPSValues) {\r\n\tif (!policyValue) {\r\n\t\treturn \"Not Configured\";\r\n\t}\r\n\tswitch (policyValue) {\r\n\t\tcase Constants.OCPSValues.Disabled:\r\n\t\t\treturn \"Disabled\";\r\n\t\tcase Constants.OCPSValues.Enabled:\r\n\t\t\treturn \"Enabled\";\r\n\t\tdefault:\r\n\t\t\treturn \"Not Configured\";\r\n\t}\r\n}\r\n\r\n/**\r\n * Convert AutoDismiss enum to time in miliseconds\r\n * @return {number} time in miliseconds\r\n */\r\nexport function convertAutoDismissToTimeInMs(autoDismiss: Constants.AutoDismissValues): number {\r\n\tlet autoDismissDuration: number;\r\n\r\n\tswitch (autoDismiss) {\r\n\t\tcase (Constants.AutoDismissValues.SevenSeconds):\r\n\t\t\tautoDismissDuration = 7000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.FourteenSeconds):\r\n\t\t\tautoDismissDuration = 14000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.TwentyOneSeconds):\r\n\t\t\tautoDismissDuration = 21000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.TwentyEightSeconds):\r\n\t\t\tautoDismissDuration = 28000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.SixtySeconds):\r\n\t\t\tautoDismissDuration = 60000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.NinetySeconds):\r\n\t\t\tautoDismissDuration = 90000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.OneHundredAndTwentySeconds):\r\n\t\t\tautoDismissDuration = 120000;\r\n\t\t\tbreak;\r\n\t\tcase (Constants.AutoDismissValues.OneHundredAndFiftySeconds):\r\n\t\t\tautoDismissDuration = 150000;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tautoDismissDuration = 0;\r\n\t\t\tbreak;\r\n\t}\r\n\treturn autoDismissDuration;\r\n}\r\n\r\n/**\r\n * Scrubs XML, HTML, and other privacy fields from string content\r\n * @return scrubbed string\r\n */\r\nexport function scrubContent(input: string){\r\n\tif(!input){\r\n\t\treturn \"\";\r\n\t}\r\n\tconst tagPatterns = [\r\n\t\t/<\\?XML[\\s\\S]*?<\\/\\?XML>/gi, //removing XML tags and content within\r\n\t\t/<\\?XML[\\s\\S]*?\\?>/gi,\r\n\t\t/<[^>]*>[\\s\\S]*?<\\/[^>]*>/gi, // removing HTML content\r\n        /<[^>]*>/g,\r\n        /]*>/gi,\r\n\t\t/<ASP:[\\s\\S]*?<\\/ASP:[^>]*>/gi, //removing ASP content\r\n\t\t/MIME-VERSION:.*?([,\\n]|$)/gi,\r\n\t\t/{\\\\RTF[\\s\\S]*?}/gi,\r\n\t\t/ACCESS_TOKEN:.*?([.,\\n]|$)/gi,\r\n\t\t/AWSACCESSKEYID:.*?([.,\\n]|$)/gi,\r\n\t\t/([A-Z0-9_]|\\.|%2E){1,50}(@|_AT_|%40)([A-Z0-9_]{1,50}(\\.|_|%2E))+(COM|ORG|GOV|EDU)/gi, // removing email addresses\r\n\t\t/\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b/gi // removing ip addresses\r\n\t];\r\n\r\n\tlet scrubbedContent = input;\r\n\ttagPatterns.forEach(pattern => {\r\n\t\tscrubbedContent = scrubbedContent.replace(pattern, 'redacted');\r\n\t});\r\n\treturn scrubbedContent.replace(/\\s+/g, ' ').trim();\r\n}", "import * as Constants from \"./../Constants\";\r\n\r\nimport {\r\n\tAlignmentType,\r\n\tEcsResponseBase,\r\n\tIAppGovernanceProvider,\r\n\tICVSurveyParams,\r\n\tICampaignDefinition,\r\n\tICampaignTelemetrySamplingConfig,\r\n\tIEcsAdapter,\r\n\tIFloodgateAuthTokenCallback,\r\n\tIFloodgateFeatureStatusCallback,\r\n\tIFloodgateSettingStorageCallback,\r\n\tILogExperimentTrigger,\r\n\tIOnSurveyActivatedCallback,\r\n\tIUxSchemaVariables\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { IManifestDataApplication, IManifestDataTelemetry, IManifestDataWeb } from \"./../Transport/Transport\";\r\n\r\nimport { TelemetrySink } from \"@microsoft/oteljs\";\r\nimport { IPersonalizationSettings, IUserFactConfig } from \"@ms-ofb/officepersonalization/dist/lib/Common/Models\";\r\nimport { IOnDismissDelegate } from \"./../IOnDismissDelegate\";\r\nimport { ISurveyCSSParams } from \"./ISurveyCSSParams\";\r\n\r\n/**\r\n * Interface for common initialization options\r\n */\r\nexport interface IInitOptionsCommon {\r\n\t// An id uniquely identifying the host app in the OCV world\r\n\tappId: number;\r\n\t// The Otel.TelemetrySink implementing object that the logger will attach to.\r\n\ttelemetrySink: TelemetrySink;\r\n\t// The url at which the styles reside\r\n\tstylesUrl?: string;\r\n\t// The url at which the internationalization files reside\r\n\tintlUrl?: string;\r\n\t// The filename for the internationalization strings, if different than the default filename\r\n\tintlFilename?: string;\r\n\t// Base url where any ux assets reside. Mainly used by coaching ux\r\n\twebSurfacesResourceBaseUrl?: string;\r\n\t// Environment\r\n\tenvironment: Constants.Environment;\r\n\t// A string uniquely identifying the current session\r\n\tsessionId?: string;\r\n\t// cid string which is in-scope for GDPR compliance for export and deletion request\r\n\tcid?: string;\r\n\t// A build version for your app\r\n\tbuild?: string;\r\n\t// The primary colour in hex form #[0-9a-f]{6}\r\n\tprimaryColour?: string;\r\n\t// The secondary colour in hex form #[0-9a-f]{6}\r\n\tsecondaryColour?: string;\r\n\t// The UI locale name of the calling page\r\n\tlocale?: string;\r\n\t// System-Use only\r\n\toriginalLocale?: string;\r\n\t// A callback which will be called when the SDK encounters errors\r\n\tonError?: (err: string) => void;\r\n\t// Application related metadata\r\n\tapplicationGroup?: IManifestDataApplication;\r\n\t// Telemetry related metadata\r\n\ttelemetryGroup?: IManifestDataTelemetry;\r\n\t// Web related metadata\r\n\twebGroup?: IManifestDataWeb;\r\n\t// User Email \r\n\tuserEmail?: string;\r\n\t// The json string to define event sampling\r\n\teventSampling?: ISamplingEvent[];\r\n\t// The timeout for sending response in petrol\r\n\tpetrolTimeout?: number;\r\n\t// check to see if user is consumer/commercial to dynamically display UI\r\n\tisCommercialHost?: boolean;\r\n\t// Option to see if the host will be providing their own resources such as strings or CSS\r\n\tcustomResourcesSetExternally?: CustomResources;\r\n\t// the email policy value from OCPS to determines if the user can see an option to include their email when they submit feedback\r\n\temailPolicyValue?: Constants.OCPSValues;\r\n\t// the screenshot policy value from OCPS to determines if the user can see an option to include their screenshot when they submit feedback\r\n\tscreenshotPolicyValue?: Constants.OCPSValues;\r\n\t// AgeGroup enum which user is classfied as\r\n\tageGroup?: AgeGroup;\r\n\t// Authentication Type of user\r\n\tauthenticationType?: AuthenticationType;\r\n\t// Application settings\r\n\tapplicationSettings?: IApplicationSettings;\r\n\t// Package settings for the new web surfaces urls (after migration of the CDN)\r\n\twebSurfacesSettings?: IWebSurfacesSettings;\r\n\t// Privacy Url\r\n\tprivacyUrl?: string;\r\n\t// Retention Duration in Days \r\n\tretentionDurationDays?: number;\r\n\t// Config options for UserFacts\r\n\tuserfactConfig?: IUserFactConfig;\r\n\t// Config for Personalization\r\n\tpersonalizationSettings?: IPersonalizationSettings;\r\n\t// Allowed domains script injection (Trusted types)\r\n\tallowedDomains?: string[];\r\n}\r\n\r\n/**\r\n * Interface for messaging service settings\r\n */\r\nexport interface IMessagingServiceSettings {\r\n\t// Internal campaign metadata aggregator url\r\n\tcampaignMetadataAggregatorInt?: string;\r\n\t// Production campaign metadata aggregator url \r\n\tcampaignMetadataAggregatorProd?: string;\r\n\t// Internal set campaign action url\r\n\tsetCampaignActionInt?: string;\r\n\t// Production set campaign action url\r\n\tsetCampaignActionProd?: string;\r\n}\r\n\r\n/**\r\n * Interface for package settings\r\n */\r\nexport interface IWebSurfacesSettings {\r\n\t// Internal web surfaces url\r\n\twebSurfacesIntUrl?: string;\r\n\t// Production web surfaces url \r\n\twebSurfacesProdUrl?: string;\r\n}\r\n\r\n/**\r\n * Interface for host application settings\r\n */\r\nexport interface IApplicationSettings {\r\n\treadonly [key: string]: unknown;\r\n}\r\n\r\n/**\r\n * Interface for inAppFeedback initialization options\r\n */\r\nexport interface IInitOptionsInAppFeedback {\r\n\t// Method called on feedback submission\r\n\tonDismiss?: IOnDismissDelegate;\r\n\t// Bug form toggle\r\n\tbugForm?: boolean;\r\n\t// email enabled\r\n\tshowEmailAddress?: boolean;\r\n\t// User email\r\n\tuserEmail?: string;\r\n\t// Screenshot toggle\r\n\tscreenshot?: boolean;\r\n\t// The switch to show a thank you panel\r\n\tisShowThanks?: boolean;\r\n\t// Flag to enable/disable transistion on the UI.\r\n\ttransitionEnabled?: boolean;\r\n\t// the feedback policy value from OCPS to determines if the user can submit feedback\r\n\tsendFeedbackPolicyValue?: Constants.OCPSValues;\r\n\t// Feedback Forum URL\r\n\tfeedbackForumUrl?: string;\r\n\t// My feedback Forum URL\r\n\tmyFeedbackForumUrl?: string;\r\n}\r\n\r\n/**\r\n * Interface for floodgate initialization options\r\n */\r\nexport interface IInitOptionsFloodgate {\r\n\t// Should the floodgate prompt automatically dismiss if not clicked? Default is false\r\n\tautoDismiss?: Constants.AutoDismissValues;\r\n\r\n\t// Campaign definitions\r\n\tcampaignDefinitions?: ICampaignDefinition[];\r\n\r\n\t// Flights for TMS service\r\n\tcampaignFlights?: string;\r\n\r\n\t// Additional query parameters for TMS service\r\n\tcampaignQueryParameters?: string;\r\n\r\n\t// Delegate to be called when the floodgate UI is dismissed, whether on a submission or not\r\n\tonDismiss?: (campiagnId: string, submitted: boolean) => void;\r\n\r\n\t// The callback to be executed when a survey is activated\r\n\tonSurveyActivatedCallback?: IOnSurveyActivatedCallback;\r\n\r\n\t// The callback to be executed when host-based data operations are needed\r\n\tsettingStorageCallback?: IFloodgateSettingStorageCallback;\r\n\r\n\t// Optionally provide a method which will accept the custom strings in Campaign Definitions and return actual\r\n\t// strings that must be displayed. Used for localization.\r\n\tuIStringGetter?: (str: string) => string;\r\n\r\n\t// The callback to be executed when host-based auth token is needed\r\n\tauthTokenCallback?: IFloodgateAuthTokenCallback;\r\n\r\n\t// Calback for retrieving feature gate values from host app to enable experimental features \r\n\tfeatureStatusCallback?: IFloodgateFeatureStatusCallback;\r\n\r\n\t// The boolean option to enforce if surveys are allowed by a policy, such as an OCPS policy for a tenant.\r\n\t// True: Surveys are enabled, floodgate works normally; False: Surveys are disabled\r\n\tsurveyEnabled?: boolean;\r\n\r\n\t// Used to determine whether or LPP campaigns should be available to a user.\r\n\t// This is used to check the eligibility of a campaign prior to the nomination process.\r\n\t// Note: messagingEnabled and SurveyEnabled fall under the same \"enabled types\" for what type of surface a user can view.\r\n\tmessagingEnabled?: boolean;\r\n\r\n\t// The boolean option to enforce if email address collection in a survey is allowed by a policy, such as an OCPS policy for a tenant.\r\n\t// True: email address collection is enabled, floodgate works normally; False: email address collection is disabled\r\n\tshowEmailAddress?: boolean;\r\n\r\n\t// Interface to pass the params for the Customer Voice Survey\r\n\tcustomerVoiceSurveyParams?: ICVSurveyParamsExtended;\r\n\r\n\t// Interface for CSS params to modify survey position\r\n\tsurveyCSSParams?: ISurveyCSSParams;\r\n\r\n\t// The boolean option to enabl the governance service\r\n\tgovernanceServiceEnabled?: boolean;\r\n\r\n\t// configuration for governance service\r\n\tgovernanceServiceConfig?: IGovernanceServiceConfig;\r\n\r\n\t// is personalizer enabled on client side.\r\n\tpersonalizerEnabled?: boolean;\r\n\r\n\t// Messaging service settings for the new base urls (after migration of the CDN)\r\n\tmessagingServiceSettings?: IMessagingServiceSettings;\r\n\r\n\t// is priority filter enabled on client side.\r\n\tisPriorityEnabled?: boolean;\r\n\r\n\t// is EUDB compliant UX enabled on client side.\r\n\tisEudbUxEnabled?: boolean;\r\n\r\n\t// The App provided callback to be executed when app governance needs to be applied\r\n\tappGovernanceProvider?: IAppGovernanceProvider;\r\n\r\n\t// Configuration for Dynamic Campaigns\r\n\tdynamicCampaignConfig?: IDynamicCampaignConfig;\r\n\r\n\t// Configuration for Personalization package\r\n\tuserfactConfig?: IUserFactConfig;\r\n\r\n\t// Callback for triggering LPP Scorecards\r\n\tlogExperimentTrigger?: ILogExperimentTrigger;\r\n\r\n\t// setting to check if user facts Read service is enabled\r\n\tuserFactsReadConfig?: IUserFactsReadConfig;\r\n\r\n\t// settings for dynamic ux\r\n\tdynamicUxConfig?: IDynamicUxConfig;\r\n\r\n\t// Sampling rate config for web funnel campaign feature, may include sampling rates for other campaign telemetry in the future\r\n\tcampaignTelemetrySamplingConfig?: ICampaignTelemetrySamplingConfig;\r\n\r\n\t// HtmlElement on which the survey should be rendered. It can either be a string (elementId) or an HTMLElement. The element is created if it does not exist.\r\n\tsurveyContainer?: string | HTMLElement;\r\n}\r\n\r\n/**\r\n * Interface for Dynamic Campaign options\r\n */\r\nexport interface IDynamicCampaignConfig {\r\n\tenabled: boolean;\r\n\tecsClient?: IEcsAdapter<unknown & EcsResponseBase>;\r\n}\r\n\r\n/**\r\n * Interface for Dynamic Ux options\r\n */\r\nexport interface IDynamicUxConfig {\r\n\tenabled?: boolean;\r\n\tdynamicVariables?: IUxSchemaVariables;\r\n\tdelayLoadingTimeout?: number;\r\n\ttheme?: string;\r\n\tcustomTheme?: object;\r\n\tcdnStringConfig?: IDynamicUxCdnConfig;\r\n\thostName?: string;\r\n\tfooterButtonsAlignment?: AlignmentType;\r\n}\r\n\r\n/**\r\n * Type for Dynamic Ux theme options\r\n */\r\nexport type IDynamicUxThemeConfig = Pick<IDynamicUxConfig, \"theme\" | \"customTheme\">;\r\n\r\n/**\r\n * Interface for Dynamic Ux CDN string options.\r\n * It defines how the CDN will be fetched: concurrently or sequentially with timeout and retry\r\n */\r\nexport interface IDynamicUxCdnConfig {\r\n\tuiStringsCdnEnabled: boolean;\r\n\tfetchCdnConcurrently?: boolean;\r\n\tuiStringsLoadingTimeout?: number;\r\n\tuiStringCdnRetryLimit?: number;\r\n}\r\n\r\n/**\r\n * Interface for floodgate event sampling options\r\n */\r\nexport interface ISamplingEvent {\r\n\ttype: string;\r\n\tname: string;\r\n\tsampleRate: number;\r\n}\r\n\r\nexport interface ISamplingInitOption {\r\n\tevent?: Record<string, number>;\r\n}\r\n\r\n/**\r\n * Interface for User facts Read service settings\r\n */\r\nexport interface IUserFactsReadConfig {\r\n\tenabled: boolean;\r\n}\r\n\r\nexport interface IGovernanceServiceConfig {\r\n\t// limit number of retry\r\n\tretry?: number;\r\n\r\n\t// timeout in second\r\n\ttimeout?: number;\r\n\r\n\t// In case of failure call, option to whether continue display survey or fall off\r\n\tforceServicelessSurveyDisplay?: boolean;\r\n\r\n\t// Toggle the survey level governance\r\n\tisSurveyLevelGovernanceEnabled?: boolean;\r\n}\r\n\r\n// bit mask flag: values should be set 0,1,2,4,8,16, etc...\r\n// Example for Css and Strings both, use 3.\r\nexport enum CustomResources {\r\n\tNone = 0,\r\n\tCss = 1,\r\n\tStrings = 2,\r\n}\r\n\r\nexport enum AgeGroup {\r\n\tUndefined, // Unknown age\r\n\tMinorWithoutParentalConsent, // Minor under the age of consent\r\n\tMinorWithParentalConsent, // Minor under age of consent\r\n\tAdult, // Adult\r\n\tNotAdult, // Minor above age of consent\t\r\n\tMinorNoParentalConsentRequired, // Minor above age of consent\r\n}\r\n\r\nexport enum AuthenticationType {\r\n\tMSA,\r\n\tAAD,\r\n\tUnauthenticated\r\n}\r\n\r\n// Taken from %SRCROOT%\\privacy\\options\\public\\UserConsentGroup.h\r\n// Enum that describes the different consent categories of the user.\r\nexport const enum UserConsentGroup {\r\n\t// Unknown consent group, we do not have info to determine this\r\n\tUnknown = 0,\r\n\t// Can give consent to data collection, upsell messages\r\n\tCanConsent = 1,\r\n\t// Can still give consent but is only a limited consent.\r\n\t// As an example, upsell / cross sell should not be shown.\r\n\tPartialConsent = 2,\r\n\t// They cannot provide any form of consent. No consent dialogs / upsell should not be shown.\r\n\tCannotConsent = 3,\r\n}\r\n\r\n// TODO: Clean this code as part of the Migration of the CV surveys to FG 2.0. This code will be deprecated.\r\nexport interface ICVSurveyParamsExtended extends ICVSurveyParams {\r\n\tisCopilotLicenseEnabled?: boolean;\r\n}", "/**\r\n * Configuration.ts\r\n *\r\n * Module for logic relating to the sdk user configuration\r\n */\r\n\r\nimport * as Constants from \"./../Constants\";\r\nimport * as Localization from \"./../Localization\";\r\nimport * as Utils from \"./../Utils\";\r\nimport * as IInitOptions from \"./IInitOptions\";\r\nimport * as ILaunchOptions from \"./ILaunchOptions\";\r\n\r\nimport { AlignmentType, IOnSurveyActivatedCallback, ISurveyForm, ISurveyLauncher, ISurveyParams } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { IPersonalizationConfig, IPersonalizationSettings } from \"@ms-ofb/officepersonalization/dist/lib/Common/Models\";\r\n\r\nimport { TelemetrySink } from \"@microsoft/oteljs\";\r\nimport { ISurveyRenderContext } from \"gatecrash\";\r\nimport FeatureGateProvider from \"../FloodgateCore/FeatureGateProvider\";\r\nimport { PersonalizationLogger } from \"../TargetedMessaging/PersonalizationLogger\";\r\nimport { CentroFloodgateHostName } from \"../UI/DynamicUx/CentroConstants\";\r\nimport { CentroThemeDataSource } from '../UI/DynamicUx/CentroThemeDataSource';\r\nimport { Urls } from \"../UI/UiConstants\";\r\nimport { SDK_DEFAULT_PERSONALIZATIONSAMPLINGRATE } from \"./../Constants\";\r\nimport IUISurvey from \"./../FloodgateCore/UISurvey/IUISurvey\";\r\nimport { ICategoryOptions } from \"./ICategoryOptions\";\r\n\r\nexport * from \"./IInitOptions\";\r\nexport * from \"./ILaunchOptions\";\r\n\r\n/**\r\n * Class representing a configuration (user provided options)\r\n */\r\n\r\nexport class Configuration {\r\n\tdefaultAllowedDomains = [\r\n\t\t\"microsoft.com\",\r\n\t\t\"office.com\",\r\n\t\t\"office.net\",\r\n\t\t\"office365.com\",\r\n\t\t\"microsoft365.com\",\r\n\t\t\"outlook.com\",\r\n\t\t\"live.com\",\r\n\t\t\"onedrive.com\"\r\n\t];\r\n\t/**\r\n\t * Validate category options, default \"show\" to false if CategoryOptions is not provided.\r\n\t * @param categories Category options\r\n\t * @returns {ICategoryOptions} the validated CategoryOptions\r\n\t */\r\n\tprivate static validateCategoryOptions(categories?: ICategoryOptions): ICategoryOptions {\r\n\t\tif (!categories) {\r\n\t\t\treturn { show: false };\r\n\t\t}\r\n\r\n\t\tUtils.expectBoolean(categories.show, \"categories.show\");\r\n\t\tif (categories.customCategories) {\r\n\t\t\tUtils.expectArray(categories.customCategories, \"categories.customCategories\");\r\n\r\n\t\t\tfor (const customCategory of categories.customCategories) {\r\n\t\t\t\tUtils.expectString(customCategory, \"custom category '\" + customCategory + \"'\");\r\n\t\t\t\tif (customCategory.length > 20) {\r\n\t\t\t\t\tthrow \"custom category '\" + customCategory + \"' too long, max 20 characters.\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn categories;\r\n\t}\r\n\r\n\tprivate commonInitOptions: IInitOptions.IInitOptionsCommon;\r\n\r\n\tprivate inAppFeedbackInitOptions: IInitOptions.IInitOptionsInAppFeedback;\r\n\tprivate inAppFeedbackLaunchOptions: ILaunchOptions.ILaunchOptionsInAppFeedback;\r\n\r\n\tprivate floodgateInitOptions: IInitOptions.IInitOptionsFloodgate;\r\n\tprivate floodgateSurvey: IUISurvey;\r\n\tprivate cvRenderContext: ISurveyRenderContext;\r\n\r\n\tprivate personalizationInitOptions: IPersonalizationConfig;\r\n\r\n\tprivate sdkSessionId: string;\r\n\r\n\tprivate eventSampling: IInitOptions.ISamplingInitOption;\r\n\r\n\tprivate commonPolicyAllowAADC: boolean;\r\n\r\n\tprivate feedbackSubmitted = false;\r\n\r\n\tprivate featureGateProvider: FeatureGateProvider;\r\n\r\n\tpublic getFeedbackSubmitted(): boolean {\r\n\t\treturn this.feedbackSubmitted;\r\n\t}\r\n\r\n\tpublic setFeedbackSubmitted(value: boolean): void {\r\n\t\tthis.feedbackSubmitted = value;\r\n\t}\r\n\r\n\tpublic getCommonInitOptions(): IInitOptions.IInitOptionsCommon {\r\n\t\treturn this.commonInitOptions;\r\n\t}\r\n\r\n\tpublic getInAppFeedbackInitOptions(): IInitOptions.IInitOptionsInAppFeedback {\r\n\t\treturn this.inAppFeedbackInitOptions;\r\n\t}\r\n\r\n\tpublic getInAppFeedbackLaunchOptions(): ILaunchOptions.ILaunchOptionsInAppFeedback {\r\n\t\treturn this.inAppFeedbackLaunchOptions;\r\n\t}\r\n\r\n\tpublic getFloodgateInitOptions(): IInitOptions.IInitOptionsFloodgate {\r\n\t\treturn this.floodgateInitOptions;\r\n\t}\r\n\r\n\tpublic getPersonalizationInitOptions(): IPersonalizationConfig {\r\n\t\tif (this.personalizationInitOptions === undefined) {\r\n\t\t\tthis.createPersonalizationInitOptions();\r\n\t\t}\r\n\t\treturn this.personalizationInitOptions;\r\n\t}\r\n\r\n\tpublic getFloodgateSurvey(): IUISurvey {\r\n\t\treturn this.floodgateSurvey;\r\n\t}\r\n\r\n\tpublic getCVRenderContext(): ISurveyRenderContext {\r\n\t\treturn this.cvRenderContext;\r\n\t}\r\n\r\n\tpublic getSdkSessionId(): string {\r\n\t\tif (!this.sdkSessionId) {\r\n\t\t\tthis.sdkSessionId = Utils.guid();\r\n\t\t}\r\n\r\n\t\treturn this.sdkSessionId;\r\n\t}\r\n\r\n\tpublic getEventSampling(): IInitOptions.ISamplingInitOption {\r\n\t\treturn this.eventSampling;\r\n\t}\r\n\r\n\t/**\r\n\t * Set initOptions for common functionality.\r\n\t */\r\n\tpublic setCommonInitOptions(passedInitOptions: IInitOptions.IInitOptionsCommon) {\r\n\t\tUtils.expectObject(passedInitOptions, \"passedInitOptions\");\r\n\t\tconst initOptions: IInitOptions.IInitOptionsCommon = {\r\n\t\t\tappId: passedInitOptions.appId,\r\n\t\t\tapplicationGroup: passedInitOptions.applicationGroup || {},\r\n\t\t\tbuild: passedInitOptions.build,\r\n\t\t\tcid: passedInitOptions.cid,\r\n\t\t\tenvironment: passedInitOptions.environment,\r\n\t\t\tintlFilename: passedInitOptions.intlFilename,\r\n\t\t\tintlUrl: passedInitOptions.intlUrl,\r\n\t\t\twebSurfacesResourceBaseUrl: passedInitOptions.webSurfacesResourceBaseUrl,\r\n\t\t\tlocale: passedInitOptions.locale,\r\n\t\t\tonError: passedInitOptions.onError,\r\n\t\t\toriginalLocale: passedInitOptions.locale,\r\n\t\t\tprimaryColour: passedInitOptions.primaryColour,\r\n\t\t\tsecondaryColour: passedInitOptions.secondaryColour,\r\n\t\t\tsessionId: passedInitOptions.sessionId,\r\n\t\t\tstylesUrl: passedInitOptions.stylesUrl,\r\n\t\t\ttelemetryGroup: passedInitOptions.telemetryGroup || {},\r\n\t\t\tuserEmail: passedInitOptions.userEmail,\r\n\t\t\twebGroup: passedInitOptions.webGroup || {},\r\n\t\t\teventSampling: passedInitOptions.eventSampling,\r\n\t\t\tpetrolTimeout: passedInitOptions.petrolTimeout,\r\n\t\t\tisCommercialHost: passedInitOptions.isCommercialHost,\r\n\t\t\tcustomResourcesSetExternally: passedInitOptions.customResourcesSetExternally,\r\n\t\t\temailPolicyValue: passedInitOptions.emailPolicyValue,\r\n\t\t\tscreenshotPolicyValue: passedInitOptions.screenshotPolicyValue,\r\n\t\t\tageGroup: passedInitOptions.ageGroup,\r\n\t\t\tauthenticationType: passedInitOptions.authenticationType,\r\n\t\t\tapplicationSettings: passedInitOptions.applicationSettings,\r\n\t\t\twebSurfacesSettings: passedInitOptions.webSurfacesSettings,\r\n\t\t\tprivacyUrl: passedInitOptions.privacyUrl || Urls.PrivacyStatementLink,\r\n\t\t\tretentionDurationDays: passedInitOptions.retentionDurationDays,\r\n\t\t\ttelemetrySink: passedInitOptions.telemetrySink,\r\n\t\t\tuserfactConfig: passedInitOptions.userfactConfig,\r\n\t\t\tpersonalizationSettings: passedInitOptions.personalizationSettings,\r\n\t\t\tallowedDomains: passedInitOptions.allowedDomains,\r\n\t\t};\r\n\r\n\t\tUtils.expectNumber(initOptions.appId, \"initOptions.appId\");\r\n\t\tif (!(initOptions.appId % 1 === 0 && initOptions.appId > 0)) {\r\n\t\t\tthrow \"initOptions.appId is not a positive integer: \" + initOptions.appId;\r\n\t\t}\r\n\r\n\t\t// if defined, it should be a positive number\r\n\t\tif (initOptions.retentionDurationDays !== undefined) {\r\n\t\t\tUtils.expectNumber(initOptions.retentionDurationDays, \"initOptions.retentionDurationDays\");\r\n\t\t\tif (!(initOptions.retentionDurationDays % 1 === 0 && initOptions.retentionDurationDays > 0)) {\r\n\t\t\t\tthrow \"initOptions.retentionDurationDays is not a positive integer: \" + initOptions.retentionDurationDays;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst expectedValues = IInitOptions.CustomResources.Strings | IInitOptions.CustomResources.Css;\r\n\r\n\t\tif (initOptions.customResourcesSetExternally === undefined) {\r\n\t\t\tinitOptions.customResourcesSetExternally = IInitOptions.CustomResources.None;\r\n\t\t} else if (typeof (initOptions.customResourcesSetExternally) !== \"number\" ||\r\n\t\t\t(initOptions.customResourcesSetExternally | expectedValues) !== expectedValues) {\r\n\t\t\tthrow \"initOptions.customResourcesSetExternally has an invalid value: \" + initOptions.customResourcesSetExternally;\r\n\t\t}\r\n\t\tif ((initOptions.customResourcesSetExternally & IInitOptions.CustomResources.Css) === IInitOptions.CustomResources.Css || initOptions.stylesUrl) {\r\n\t\t\tconst warnMessage = `WARNING: OfficeBrowserFeedback is no longer supporting the host application setting the styles for the surveys. \r\n\t\t\tPlease use the default styling.`;\r\n\t\t\tconsole.warn(warnMessage);\r\n\t\t}\r\n\t\tif ((initOptions.customResourcesSetExternally & IInitOptions.CustomResources.Strings) !== IInitOptions.CustomResources.Strings) {\r\n\t\t\tUtils.expectString(initOptions.intlUrl, \"initOptions.intlUrl\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.intlFilename !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.intlFilename, \"initOptions.intlFilename\");\r\n\t\t} else {\r\n\t\t\tinitOptions.intlFilename = \"officebrowserfeedbackstrings.js\";\r\n\t\t}\r\n\r\n\t\tUtils.expectNumber(initOptions.environment, \"initOptions.environment\");\r\n\t\tif (!(initOptions.environment === 1 || initOptions.environment === 0)) {\r\n\t\t\tthrow \"initOptions.environment has a bad value: \" + initOptions.environment;\r\n\t\t}\r\n\r\n\t\tif (initOptions.userEmail !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.userEmail, \"initOptions.userEmail\");\r\n\t\t} else {\r\n\t\t\tinitOptions.userEmail = \"\";\r\n\t\t}\r\n\r\n\t\tif (initOptions.sessionId !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.sessionId, \"initOptions.sessionId\");\r\n\t\t} else {\r\n\t\t\tinitOptions.sessionId = \"00000000-0000-0000-0000-000000000000\";\r\n\t\t}\r\n\r\n\t\t// Copy sessionID over to telemetryGroup\r\n\t\tinitOptions.telemetryGroup.processSessionId = initOptions.sessionId;\r\n\r\n\t\tif (initOptions.cid !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.cid, \"initOptions.cid\");\r\n\r\n\t\t\t// Copy cid over to extendedManifestData of applicationGroup\r\n\t\t\tinitOptions.applicationGroup.extendedManifestData = JSON.stringify({ cid: initOptions.cid });\r\n\t\t}\r\n\r\n\t\tif (initOptions.build !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.build, \"initOptions.build\");\r\n\t\t} else {\r\n\t\t\tinitOptions.build = \"0.0.0.0\";\r\n\t\t}\r\n\t\t// Copy build over to telemetryGroup\r\n\t\tinitOptions.telemetryGroup.officeBuild = initOptions.build;\r\n\r\n\t\tconst hexColourRegex = new RegExp(\"^#[0-9a-f]{3}([0-9a-f]{3})?$\", \"i\");\r\n\t\tif (initOptions.primaryColour !== undefined) {\r\n\t\t\tif (!hexColourRegex.test(initOptions.primaryColour)) {\r\n\t\t\t\tinitOptions.primaryColour = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (initOptions.secondaryColour !== undefined) {\r\n\t\t\tif (!hexColourRegex.test(initOptions.secondaryColour)) {\r\n\t\t\t\tinitOptions.secondaryColour = undefined;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (initOptions.locale !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.locale, \"initOptions.locale\");\r\n\t\t\tinitOptions.locale = Localization.validate(initOptions.locale);\r\n\t\t} else {\r\n\t\t\tinitOptions.locale = \"en\";\r\n\t\t}\r\n\r\n\t\tif (initOptions.onError === undefined) {\r\n\t\t\tinitOptions.onError = (err: string) => { return; };\r\n\t\t}\r\n\r\n\t\tif (initOptions.petrolTimeout !== undefined) {\r\n\t\t\tUtils.expectNumber(initOptions.petrolTimeout, \"initOptions.petrolTimeout\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.authenticationType !== undefined) {\r\n\t\t\tUtils.expectEnum(initOptions.authenticationType, IInitOptions.AuthenticationType, \"initOptions.authenticationType\");\r\n\t\t} else {\r\n\t\t\tinitOptions.authenticationType = IInitOptions.AuthenticationType.Unauthenticated;\r\n\t\t}\r\n\r\n\t\t// For AAD or Unauthenticated, ageGroup value is unknown, so it's safe to only parse for MSA\r\n\t\tif (initOptions.ageGroup !== undefined) {\r\n\t\t\tUtils.expectEnum(initOptions.ageGroup, IInitOptions.AgeGroup, \"initOptions.ageGroup\");\r\n\t\t} else {\r\n\t\t\tinitOptions.ageGroup = IInitOptions.AgeGroup.Undefined;\r\n\t\t}\r\n\r\n\t\tthis.eventSampling = this.parseEventSamplingOption(initOptions.eventSampling);\r\n\r\n\t\tthis.commonInitOptions = initOptions;\r\n\t\tthis.commonPolicyAllowAADC = this.determineAADCPolicy(initOptions.authenticationType, initOptions.ageGroup);\r\n\r\n\t\tif (initOptions.isCommercialHost === undefined || initOptions.isCommercialHost == null) {\r\n\t\t\tinitOptions.isCommercialHost = false; // By default privacy consent is not shown. (From SDK's perspective)\r\n\t\t} else {\r\n\t\t\tUtils.expectBoolean(initOptions.isCommercialHost, \"initOptions.isCommercialHost\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.emailPolicyValue === undefined) {\r\n\t\t\tinitOptions.emailPolicyValue = Constants.OCPSValues.NotConfigured;\r\n\t\t} else if (typeof (initOptions.emailPolicyValue) !== \"number\" ||\r\n\t\t\t(initOptions.emailPolicyValue !== Constants.OCPSValues.NotConfigured &&\r\n\t\t\t\tinitOptions.emailPolicyValue !== Constants.OCPSValues.Enabled &&\r\n\t\t\t\tinitOptions.emailPolicyValue !== Constants.OCPSValues.Disabled)) {\r\n\t\t\tthrow \"initOptions.emailPolicyValue has an invalid value: \" + initOptions.emailPolicyValue;\r\n\t\t}\r\n\r\n\t\tif (initOptions.screenshotPolicyValue === undefined) {\r\n\t\t\tinitOptions.screenshotPolicyValue = Constants.OCPSValues.NotConfigured;\r\n\t\t} else if (typeof (initOptions.screenshotPolicyValue) !== \"number\" ||\r\n\t\t\tinitOptions.screenshotPolicyValue !== Constants.OCPSValues.NotConfigured &&\r\n\t\t\tinitOptions.screenshotPolicyValue !== Constants.OCPSValues.Enabled &&\r\n\t\t\tinitOptions.screenshotPolicyValue !== Constants.OCPSValues.Disabled) {\r\n\t\t\tthrow \"initOptions.screenshotPolicyValue has an invalid value: \" + initOptions.screenshotPolicyValue;\r\n\t\t}\r\n\r\n\t\tif (initOptions.privacyUrl !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.privacyUrl, \"initOptions.privacyUrl\");\r\n\t\t} else {\r\n\t\t\tinitOptions.privacyUrl = Urls.PrivacyStatementLink;\r\n\t\t}\r\n\r\n\t\t// Expecting telemetrySink is given\r\n\t\tUtils.expectObject(initOptions.telemetrySink, \"initOptions.telemetrySink\");\r\n\r\n\t\tif (initOptions.allowedDomains !== undefined) {\r\n\t\t\tUtils.expectArray(initOptions.allowedDomains, \"initOptions.allowedDomains\");\r\n\t\t\tinitOptions.allowedDomains = [...this.defaultAllowedDomains.concat(initOptions.allowedDomains)]\r\n\t\t} else {\r\n\t\t\tinitOptions.allowedDomains = this.defaultAllowedDomains;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set init options for inAppFeedback\r\n\t */\r\n\tpublic setInAppFeedbackInitOptions(passedInitOptions: IInitOptions.IInitOptionsInAppFeedback) {\r\n\t\tUtils.expectObject(passedInitOptions, \"passedInitOptions\");\r\n\r\n\t\tconst initOptions: IInitOptions.IInitOptionsInAppFeedback = {\r\n\t\t\tbugForm: passedInitOptions.bugForm,\r\n\t\t\tonDismiss: passedInitOptions.onDismiss,\r\n\t\t\tscreenshot: passedInitOptions.screenshot,\r\n\t\t\tshowEmailAddress: passedInitOptions.showEmailAddress,\r\n\t\t\tuserEmail: passedInitOptions.userEmail,\r\n\t\t\ttransitionEnabled: passedInitOptions.transitionEnabled,\r\n\t\t\tisShowThanks: passedInitOptions.isShowThanks,\r\n\t\t\tsendFeedbackPolicyValue: passedInitOptions.sendFeedbackPolicyValue,\r\n\t\t\tfeedbackForumUrl: passedInitOptions.feedbackForumUrl !== undefined ?\r\n\t\t\t\tpassedInitOptions.feedbackForumUrl :\r\n\t\t\t\tundefined,\r\n\t\t\tmyFeedbackForumUrl: passedInitOptions.myFeedbackForumUrl !== undefined ?\r\n\t\t\t\tpassedInitOptions.myFeedbackForumUrl :\r\n\t\t\t\tundefined,\r\n\t\t};\r\n\r\n\t\tif (initOptions.onDismiss === undefined) {\r\n\t\t\tinitOptions.onDismiss = function (submitted: boolean) { return; };\r\n\t\t}\r\n\r\n\t\tif (initOptions.bugForm !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.bugForm, \"initOptions.bugForm\");\r\n\t\t} else {\r\n\t\t\tinitOptions.bugForm = false;\r\n\t\t}\r\n\r\n\t\tif (initOptions.userEmail !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.userEmail, \"initOptions.userEmail\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.screenshot !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.screenshot, \"initOptions.screenshot\");\r\n\t\t} else {\r\n\t\t\tinitOptions.screenshot = true;\r\n\t\t}\r\n\r\n\t\tif (initOptions.showEmailAddress !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.showEmailAddress, \"initOptions.showEmailAddress\");\r\n\t\t} else {\r\n\t\t\tinitOptions.showEmailAddress = true;\r\n\t\t}\r\n\r\n\t\tif (initOptions.feedbackForumUrl !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.feedbackForumUrl, \"initOptions.feedbackForumUrl\");\r\n\t\t} else {\r\n\t\t\tinitOptions.feedbackForumUrl = undefined;\r\n\t\t}\r\n\r\n\t\tif (initOptions.isShowThanks !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.isShowThanks, \"initOptions.isShowThanks\");\r\n\t\t} else {\r\n\t\t\tinitOptions.isShowThanks = true;\r\n\t\t}\r\n\r\n\t\tif (initOptions.myFeedbackForumUrl !== undefined) {\r\n\t\t\tUtils.expectString(initOptions.myFeedbackForumUrl, \"initOptions.myFeedbackForumUrl\");\r\n\t\t} else {\r\n\t\t\tinitOptions.myFeedbackForumUrl = undefined;\r\n\t\t}\r\n\r\n\t\tif (initOptions.transitionEnabled === undefined) {\r\n\t\t\tinitOptions.transitionEnabled = true;\r\n\t\t}\r\n\r\n\t\tif (initOptions.sendFeedbackPolicyValue === undefined) {\r\n\t\t\tinitOptions.sendFeedbackPolicyValue = Constants.OCPSValues.NotConfigured;\r\n\t\t} else if (typeof (initOptions.sendFeedbackPolicyValue) !== \"number\" ||\r\n\t\t\t(initOptions.sendFeedbackPolicyValue !== Constants.OCPSValues.NotConfigured &&\r\n\t\t\t\tinitOptions.sendFeedbackPolicyValue !== Constants.OCPSValues.Enabled &&\r\n\t\t\t\tinitOptions.sendFeedbackPolicyValue !== Constants.OCPSValues.Disabled)) {\r\n\t\t\tthrow \"initOptions.sendFeedbackPolicyValue has an invalid value: \" + initOptions.sendFeedbackPolicyValue;\r\n\t\t}\r\n\r\n\t\tthis.inAppFeedbackInitOptions = initOptions;\r\n\t}\r\n\r\n\t/**\r\n\t * Set launch options for inAppFeedback\r\n\t */\r\n\tpublic setInAppFeedbackLaunchOptions(launchOptions?: ILaunchOptions.ILaunchOptionsInAppFeedback) {\r\n\t\tif (!this.commonInitOptions) {\r\n\t\t\tthrow \"commonInitOptions not set\";\r\n\t\t}\r\n\r\n\t\tif (!launchOptions) {\r\n\t\t\tlaunchOptions = {};\r\n\t\t}\r\n\r\n\t\t// Override any setting done in LaunchOptions for the metadataGroups\r\n\t\tthis.commonInitOptions.applicationGroup = Utils.overrideValues(launchOptions.applicationGroup,\r\n\t\t\tthis.commonInitOptions.applicationGroup);\r\n\t\tthis.commonInitOptions.telemetryGroup = Utils.overrideValues(launchOptions.telemetryGroup,\r\n\t\t\tthis.commonInitOptions.telemetryGroup);\r\n\t\tthis.commonInitOptions.webGroup = Utils.overrideValues(launchOptions.webGroup,\r\n\t\t\tthis.commonInitOptions.webGroup);\r\n\r\n\t\tlaunchOptions.categories = Configuration.validateCategoryOptions(launchOptions.categories);\r\n\r\n\t\tthis.inAppFeedbackLaunchOptions = launchOptions;\r\n\t}\r\n\r\n\t/**\r\n\t * Set init options for floodgate\r\n\t */\r\n\tpublic setFloodgateInitOptions(passedInitOptions: IInitOptions.IInitOptionsFloodgate) {\r\n\t\tUtils.expectObject(passedInitOptions, \"passedInitOptions\");\r\n\r\n\t\tconst initOptions: IInitOptions.IInitOptionsFloodgate = {\r\n\t\t\tautoDismiss: passedInitOptions.autoDismiss,\r\n\t\t\tcampaignDefinitions: passedInitOptions.campaignDefinitions,\r\n\t\t\tcampaignFlights: passedInitOptions.campaignFlights,\r\n\t\t\tcampaignQueryParameters: passedInitOptions.campaignQueryParameters,\r\n\t\t\tonDismiss: passedInitOptions.onDismiss,\r\n\t\t\tonSurveyActivatedCallback: passedInitOptions.onSurveyActivatedCallback,\r\n\t\t\tsettingStorageCallback: passedInitOptions.settingStorageCallback,\r\n\t\t\tuIStringGetter: passedInitOptions.uIStringGetter,\r\n\t\t\tauthTokenCallback: passedInitOptions.authTokenCallback,\r\n\t\t\tfeatureStatusCallback: passedInitOptions.featureStatusCallback,\r\n\t\t\tsurveyEnabled: passedInitOptions.surveyEnabled,\r\n\t\t\tmessagingEnabled: passedInitOptions.messagingEnabled,\r\n\t\t\tshowEmailAddress: passedInitOptions.showEmailAddress,\r\n\t\t\tcustomerVoiceSurveyParams: passedInitOptions.customerVoiceSurveyParams,\r\n\t\t\tsurveyCSSParams: passedInitOptions.surveyCSSParams,\r\n\t\t\tgovernanceServiceEnabled: passedInitOptions.governanceServiceEnabled,\r\n\t\t\tgovernanceServiceConfig: passedInitOptions.governanceServiceConfig,\r\n\t\t\tpersonalizerEnabled: passedInitOptions.personalizerEnabled,\r\n\t\t\tmessagingServiceSettings: passedInitOptions.messagingServiceSettings,\r\n\t\t\tisPriorityEnabled: passedInitOptions.isPriorityEnabled,\r\n\t\t\tisEudbUxEnabled: passedInitOptions.isEudbUxEnabled,\r\n\t\t\tappGovernanceProvider: passedInitOptions.appGovernanceProvider,\r\n\t\t\tdynamicCampaignConfig: passedInitOptions.dynamicCampaignConfig,\r\n\t\t\tlogExperimentTrigger: passedInitOptions.logExperimentTrigger,\r\n\t\t\tuserFactsReadConfig: passedInitOptions.userFactsReadConfig,\r\n\t\t\tdynamicUxConfig: passedInitOptions.dynamicUxConfig,\r\n\t\t\tcampaignTelemetrySamplingConfig: passedInitOptions.campaignTelemetrySamplingConfig,\r\n\t\t\tsurveyContainer: passedInitOptions.surveyContainer,\r\n\t\t};\r\n\r\n\t\tif (initOptions.autoDismiss === undefined) {\r\n\t\t\tinitOptions.autoDismiss = Constants.AutoDismissValues.NoAutoDismiss;\r\n\t\t}\r\n\r\n\t\tif (initOptions.onDismiss === undefined) {\r\n\t\t\tinitOptions.onDismiss = (campaignId: string, submitted: boolean) => { return; };\r\n\t\t}\r\n\r\n\t\tif (initOptions.onSurveyActivatedCallback === undefined) {\r\n\t\t\tconst defaultOnSurveyActivatedCallback: IOnSurveyActivatedCallback = {\r\n\t\t\t\tonSurveyActivated(launcher: ISurveyLauncher, survey?: ISurveyForm, surveyParams?: ISurveyParams): void {\r\n\t\t\t\t\tlauncher.launch();\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tinitOptions.onSurveyActivatedCallback = defaultOnSurveyActivatedCallback;\r\n\t\t}\r\n\r\n\t\tif (initOptions.uIStringGetter === undefined) {\r\n\t\t\tinitOptions.uIStringGetter = (str: string) => str; // By default return the string as is.\r\n\t\t}\r\n\r\n\t\t// Note: surveyEnabled and messagingEnabled are both used to determine Floodgate's capabilities for the user.\r\n\t\tif (initOptions.surveyEnabled === undefined) {\r\n\t\t\tinitOptions.surveyEnabled = true; // By default surveys are enabled. (From SDK's perspective)\r\n\t\t} else {\r\n\t\t\tUtils.expectBoolean(initOptions.surveyEnabled, \"surveyEnabled\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.messagingEnabled === undefined) {\r\n\t\t\tinitOptions.messagingEnabled = true; // By default messaging is enabled. (From SDK's perspective)\r\n\t\t} else {\r\n\t\t\tUtils.expectBoolean(initOptions.messagingEnabled, \"messagingEnabled\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.showEmailAddress !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.showEmailAddress, \"initOptionsFloodgate.showEmailAddress\");\r\n\t\t} else {\r\n\t\t\tinitOptions.showEmailAddress = true;  // By default email field and collection is enabled. (From SDK's perspective)\r\n\t\t}\r\n\r\n\t\tif (initOptions.governanceServiceEnabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.governanceServiceEnabled, \"initOptionsFloodgate.governanceServiceEnable\");\r\n\t\t} else {\r\n\t\t\tinitOptions.governanceServiceEnabled = true;  // By default governanceServiceEnable is enabled\r\n\t\t}\r\n\r\n\t\tif (initOptions.governanceServiceEnabled) {\r\n\t\t\tinitOptions.governanceServiceConfig = this.parseGovernanceServiceConfig(\r\n\t\t\t\tinitOptions.governanceServiceConfig !== undefined ?\r\n\t\t\t\t\tinitOptions.governanceServiceConfig :\r\n\t\t\t\t\t{});\r\n\t\t}\r\n\r\n\t\tif (initOptions.customerVoiceSurveyParams === undefined) {\r\n\t\t\tinitOptions.customerVoiceSurveyParams = { cvFlights: \"\", isCVSurveyEnabled: true, productName: \"\", uiHost: \"\", isCopilotLicenseEnabled: false };\r\n\t\t} else {\r\n\t\t\tif (Utils.isNOU(initOptions.customerVoiceSurveyParams.isCVSurveyEnabled)) {\r\n\t\t\t\tinitOptions.customerVoiceSurveyParams.isCVSurveyEnabled = true;\r\n\t\t\t}\r\n\t\t\tif (Utils.isNOU(initOptions.customerVoiceSurveyParams.isCopilotLicenseEnabled)) {\r\n\t\t\t\tinitOptions.customerVoiceSurveyParams.isCopilotLicenseEnabled = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (initOptions.personalizerEnabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.personalizerEnabled, \"initOptionsFloodgate.personalizerEnabled\");\r\n\t\t} else {\r\n\t\t\tinitOptions.personalizerEnabled = false;  // By default personalizerEnabled is disabled\r\n\t\t}\r\n\r\n\t\tif (initOptions.isPriorityEnabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.isPriorityEnabled, \"initOptionsFloodgate.isPriorityEnabled\");\r\n\t\t} else {\r\n\t\t\tinitOptions.isPriorityEnabled = true;  // By default isPriorityEnabled is enabled\r\n\t\t}\r\n\r\n\t\tif (initOptions.isEudbUxEnabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(initOptions.isEudbUxEnabled, \"initOptionsFloodgate.isEudbUxEnabled\");\r\n\t\t} else {\r\n\t\t\tinitOptions.isEudbUxEnabled = true;  // By default isEudbUxEnabled is enabled\r\n\t\t}\r\n\r\n\t\tif (initOptions.featureStatusCallback) {\r\n\t\t\tUtils.expectFunction(initOptions.featureStatusCallback.getStringFeatureStatus, \"initOptions.featureStatusCallback.getStringFeatureStatus\");\r\n\t\t\tUtils.expectFunction(initOptions.featureStatusCallback.getIntFeatureStatus, \"initOptions.featureStatusCallback.getIntFeatureStatus\");\r\n\t\t\tUtils.expectFunction(initOptions.featureStatusCallback.getBoolFeatureStatus, \"initOptions.featureStatusCallback.getBoolFeatureStatus\");\r\n\t\t}\r\n\r\n\t\tif (initOptions.surveyContainer !== undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tUtils.expectString(initOptions.surveyContainer, \"initOptionsFloodgate.surveyContainer\");\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// If the surveyContainer is not a string, check for being an object\r\n\t\t\t\tUtils.expectObject(initOptions.surveyContainer, \"initOptionsFloodgate.surveyContainer\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tinitOptions.dynamicCampaignConfig = this.parseDynamicCampaignConfig(initOptions.dynamicCampaignConfig ?? { enabled: false });\r\n\r\n\t\tinitOptions.dynamicUxConfig = this.parseDynamicUxConfig(initOptions.dynamicUxConfig ?? { enabled: false });\r\n\r\n\t\t// Setup feature gates provider\r\n\t\tthis.featureGateProvider = new FeatureGateProvider(initOptions.featureStatusCallback);\r\n\r\n\t\tthis.floodgateInitOptions = initOptions;\r\n\t}\r\n\r\n\t/**\r\n\t * get personalization environment from userfactConfig. This allows the host to override what deployment of the service to call.\r\n\t * default is prod.\r\n\t */\r\n\tprivate getEnvironmentSetting() {\r\n\t\tconst environmentOverride = this.commonInitOptions.userfactConfig?.environment?.toLowerCase();\r\n\t\tswitch (environmentOverride) {\r\n\t\t\tcase \"int\":\r\n\t\t\t\treturn \"int\";\r\n\t\t\tcase \"edog\":\r\n\t\t\t\treturn \"edog\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"prod\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set init options for Personalization\r\n\t */\r\n\tprivate createPersonalizationInitOptions() {\r\n\t\tUtils.expectObject(this.commonInitOptions, \"passedInitOptions\");\r\n\t\tUtils.expectNumber(this.commonInitOptions.appId, \"expected appId\");\r\n\r\n\t\t// keep default sampling rate at 1% if userfactConfig objec is not present\r\n\t\tlet samplingRate = SDK_DEFAULT_PERSONALIZATIONSAMPLINGRATE;\r\n\r\n\t\t//populate personalizationSetting.eventSamplingRate with personalizationEventSamplingRate if it is present\r\n\t\tif (this.commonInitOptions.userfactConfig?.personalizationEventSamplingRate) {\r\n\t\t\tsamplingRate = this.commonInitOptions.userfactConfig.personalizationEventSamplingRate;\r\n\t\t}\r\n\r\n\t\tconst personalizationSettings: IPersonalizationSettings = {\r\n\t\t\tappId: this.commonInitOptions.appId,\r\n\t\t\tenvironment: this.getEnvironmentSetting(),\r\n\t\t\teventSamplingRate: samplingRate,\r\n\r\n\t\t\t// To be used for userFactsRequestTimeOut, userFactsCacheExpiration and other settings\r\n\t\t\t...this.commonInitOptions.personalizationSettings\r\n\t\t}\r\n\r\n\t\tconst initOptions: IPersonalizationConfig = {\r\n\t\t\tlogger: new PersonalizationLogger(),\r\n\t\t\tsessionId: this.commonInitOptions.sessionId,\r\n\t\t\tsettings: personalizationSettings,\r\n\t\t\tuserFactConfig: this.commonInitOptions.userfactConfig,\r\n\t\t}\r\n\r\n\t\tthis.personalizationInitOptions = initOptions;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Set the floodgate survey\r\n\t */\r\n\tpublic setFloodgateSurvey(survey: IUISurvey): void {\r\n\t\tthis.floodgateSurvey = survey;\r\n\t}\r\n\r\n\t/**\r\n\t * Set the Customer Voice render context\r\n\t */\r\n\tpublic setCVRenderContext(context: ISurveyRenderContext): void {\r\n\t\tthis.cvRenderContext = context;\r\n\t}\r\n\r\n\t// Checks if the surveyEnabled policy is true or false.\r\n\tpublic checkIfSurveysEnabled(): boolean {\r\n\t\t// If no floodgateInitOptions defined, return true for surveyEnabled\r\n\t\tconst policyAllowSurvey = this.floodgateInitOptions ? this.floodgateInitOptions.surveyEnabled : true;\r\n\t\treturn policyAllowSurvey && this.commonPolicyAllowAADC;\r\n\t}\r\n\r\n\t// Checks if the messagingEnabled policy is true or false.\r\n\tpublic checkIfMessagingEnabled(): boolean {\r\n\t\t// If no floodgateInitOptions defined, return true for messagingEnabled\r\n\t\tconst policyAllowMessaging = this.floodgateInitOptions ? this.floodgateInitOptions.messagingEnabled : true;\r\n\t\treturn policyAllowMessaging;\r\n\t}\r\n\r\n\t/**\r\n\t * Return the flag the Feedback and Survey enabled by AADC.\r\n\t */\r\n\tpublic isFeedbackSurveyEnabledByAADC(): boolean {\r\n\t\treturn this.commonPolicyAllowAADC;\r\n\t}\r\n\r\n\tpublic getCVSurveyFlights(): string | null {\r\n\t\treturn this.floodgateInitOptions && this.floodgateInitOptions.customerVoiceSurveyParams ?\r\n\t\t\tthis.floodgateInitOptions.customerVoiceSurveyParams.cvFlights : \"\";\r\n\t}\r\n\r\n\tpublic isCVSurveyEnabled(): boolean {\r\n\t\treturn this.floodgateInitOptions && this.floodgateInitOptions.customerVoiceSurveyParams ?\r\n\t\t\tthis.floodgateInitOptions.customerVoiceSurveyParams.isCVSurveyEnabled : true;\r\n\t}\r\n\r\n\tpublic getProductName(): string {\r\n\t\treturn this.floodgateInitOptions && this.floodgateInitOptions.customerVoiceSurveyParams ?\r\n\t\t\tthis.floodgateInitOptions.customerVoiceSurveyParams.productName : \"\";\r\n\t}\r\n\r\n\tpublic getUIHost(): string {\r\n\t\treturn this.floodgateInitOptions && this.floodgateInitOptions.customerVoiceSurveyParams ?\r\n\t\t\tthis.floodgateInitOptions.customerVoiceSurveyParams.uiHost : \"\";\r\n\t}\r\n\r\n\tpublic isCopilotLicenseEnabled(): boolean {\r\n\t\treturn this.floodgateInitOptions && this.floodgateInitOptions.customerVoiceSurveyParams ?\r\n\t\t\tthis.floodgateInitOptions.customerVoiceSurveyParams.isCopilotLicenseEnabled : false;\r\n\t}\r\n\r\n\tpublic getUIHostCVSurveyDispatcher(): string {\r\n\t\treturn this.floodgateInitOptions && this.floodgateInitOptions.customerVoiceSurveyParams ?\r\n\t\t\tthis.floodgateInitOptions.customerVoiceSurveyParams.uiHostCVSurveyDispatcher : \"\";\r\n\t}\r\n\r\n\tpublic getCSSPosition(): string {\r\n\t\treturn this.floodgateInitOptions &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssPosition ?\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssPosition :\r\n\t\t\t\"\";\r\n\t}\r\n\r\n\tpublic getCSSZIndex(): string {\r\n\t\treturn this.floodgateInitOptions &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssZIndex ?\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssZIndex :\r\n\t\t\t\"\";\r\n\t}\r\n\r\n\tpublic getCSSBottom(): string {\r\n\t\treturn this.floodgateInitOptions &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssBottom ?\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssBottom :\r\n\t\t\t\"\";\r\n\t}\r\n\r\n\tpublic getCSSRight(): string {\r\n\t\treturn this.floodgateInitOptions &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams &&\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssRight ?\r\n\t\t\tthis.floodgateInitOptions.surveyCSSParams.cssRight :\r\n\t\t\t\"\";\r\n\t}\r\n\r\n\tpublic getRuntimeCssVars(): { [key: string]: string } {\r\n\t\treturn this.floodgateInitOptions?.surveyCSSParams?.runtimeCssVars ?? {};\r\n\t}\r\n\r\n\tpublic getRuntimeHtmlDataAttrs(): { [key: string]: string } {\r\n\t\treturn this.floodgateInitOptions?.surveyCSSParams?.runtimeHtmlDataAttrs ?? {};\r\n\t}\r\n\r\n\tpublic getCSSVarString(): string {\r\n\t\tconst styleSubstrings: string[] = [];\r\n\t\tif (this.floodgateInitOptions && this.floodgateInitOptions.surveyCSSParams) {\r\n\t\t\tif (this.floodgateInitOptions.surveyCSSParams.cssPosition) {\r\n\t\t\t\tstyleSubstrings.push(\"--obf-position:\", this.floodgateInitOptions.surveyCSSParams.cssPosition, \";\");\r\n\t\t\t}\r\n\t\t\tif (this.floodgateInitOptions.surveyCSSParams.cssZIndex) {\r\n\t\t\t\tstyleSubstrings.push(\"--obf-zIndex:\", this.floodgateInitOptions.surveyCSSParams.cssZIndex, \";\");\r\n\t\t\t}\r\n\t\t\tif (this.floodgateInitOptions.surveyCSSParams.cssBottom) {\r\n\t\t\t\tstyleSubstrings.push(\"--obf-bottom:\", this.floodgateInitOptions.surveyCSSParams.cssBottom, \";\");\r\n\t\t\t}\r\n\t\t\tif (this.floodgateInitOptions.surveyCSSParams.cssRight) {\r\n\t\t\t\tstyleSubstrings.push(\"--obf-right:\", this.floodgateInitOptions.surveyCSSParams.cssRight, \";\");\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn styleSubstrings.join(\"\");\r\n\t}\r\n\r\n\tpublic getDynamicUxConfig(): IInitOptions.IDynamicUxConfig {\r\n\t\treturn this.floodgateInitOptions?.dynamicUxConfig;\r\n\t}\r\n\r\n\tprivate setDynamicUxThemeConfig(themeConfig: IInitOptions.IDynamicUxThemeConfig): void {\r\n\t\tif (this.floodgateInitOptions?.dynamicUxConfig) {\r\n\t\t\tthis.floodgateInitOptions.dynamicUxConfig.theme = themeConfig.theme;\r\n\t\t\tthis.floodgateInitOptions.dynamicUxConfig.customTheme = themeConfig.customTheme ?? undefined;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Reset the dynamicUxConfig to disable the feature\r\n\t */\r\n\tpublic resetDynamicUxConfig(): void {\r\n\t\tif (this.floodgateInitOptions?.dynamicUxConfig) {\r\n\t\t\tthis.floodgateInitOptions.dynamicUxConfig = {\r\n\t\t\t\tenabled: false,\r\n\t\t\t\tcdnStringConfig: {\r\n\t\t\t\t\tuiStringsCdnEnabled: true\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Check AADC rule at once since Configuration cannot be set again.\r\n\t * So that we don't need to repeat the same process over again.\r\n\t */\r\n\tpublic determineAADCPolicy(authenticationType: IInitOptions.AuthenticationType,\r\n\t\tageGroup: IInitOptions.AgeGroup): boolean {\r\n\t\t// Return Based on authentication first\r\n\t\tif (authenticationType === IInitOptions.AuthenticationType.Unauthenticated ||\r\n\t\t\tauthenticationType === IInitOptions.AuthenticationType.AAD) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t// Return based on AgeGroup\r\n\t\treturn ageGroup !== IInitOptions.AgeGroup.MinorWithParentalConsent &&\r\n\t\t\tageGroup !== IInitOptions.AgeGroup.MinorWithoutParentalConsent;\r\n\t}\r\n\r\n\t// Keep implementation in sync with %SRCROOT%\\privacy\\idconsentprovider\\IdentityBasedConsentGroupProvider.cpp\r\n\tpublic getUserConsentGroup(): IInitOptions.UserConsentGroup {\r\n\t\tconst authenticationType = this.commonInitOptions.authenticationType;\r\n\t\tif (authenticationType === IInitOptions.AuthenticationType.Unauthenticated ||\r\n\t\t\tauthenticationType === IInitOptions.AuthenticationType.AAD) {\r\n\t\t\treturn IInitOptions.UserConsentGroup.CanConsent;\r\n\t\t}\r\n\r\n\t\tconst ageGroup = this.commonInitOptions.ageGroup;\r\n\t\tswitch (ageGroup) {\r\n\t\t\tcase IInitOptions.AgeGroup.Undefined:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.CanConsent;\r\n\t\t\tcase IInitOptions.AgeGroup.MinorWithoutParentalConsent:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.CannotConsent;\r\n\t\t\tcase IInitOptions.AgeGroup.MinorWithParentalConsent:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.CannotConsent;\r\n\t\t\tcase IInitOptions.AgeGroup.Adult:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.CanConsent;\r\n\t\t\tcase IInitOptions.AgeGroup.NotAdult:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.PartialConsent;\r\n\t\t\tcase IInitOptions.AgeGroup.MinorNoParentalConsentRequired:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.CanConsent;\r\n\t\t\tdefault:\r\n\t\t\t\treturn IInitOptions.UserConsentGroup.CannotConsent;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * get FeatureGateProvider\r\n\t */\r\n\tpublic getFeatureGateProvider() {\r\n\t\treturn this.featureGateProvider;\r\n\t}\r\n\r\n\tprivate parseEventSamplingOption(samplingOptions: IInitOptions.ISamplingEvent[]): IInitOptions.ISamplingInitOption {\r\n\t\tconst eventInitSampling: IInitOptions.ISamplingInitOption = { event: {} };\r\n\t\tif (samplingOptions !== undefined) {\r\n\t\t\t// Iterating through init options\r\n\t\t\tfor (const index in samplingOptions) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(samplingOptions, index)) {\r\n\t\t\t\t\t// Check for correct Type\r\n\t\t\t\t\tswitch (samplingOptions[index].type) {\r\n\t\t\t\t\t\tcase \"Event\": {\r\n\t\t\t\t\t\t\t// Parsing the Name and SampleRate\r\n\t\t\t\t\t\t\tconst sampleRate = samplingOptions[index].sampleRate;\r\n\t\t\t\t\t\t\tUtils.expectNumber(sampleRate, \"initOption.EventSampling.SampleRate\");\r\n\t\t\t\t\t\t\tUtils.expectString(samplingOptions[index].name, \"initOption.EventSampling.Name\");\r\n\t\t\t\t\t\t\t// check the range for sampling percentage\r\n\t\t\t\t\t\t\tif (sampleRate < 0 || sampleRate > 1) {\r\n\t\t\t\t\t\t\t\tthrow \"initOption.EventSampling.\" + samplingOptions[index].name + \".SampleRate is out of range\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// finally, save the sampling event\r\n\t\t\t\t\t\t\teventInitSampling.event[samplingOptions[index].name] = sampleRate;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tthrow \"initOption.EventSampling.Type value is not recognized\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn eventInitSampling;\r\n\t}\r\n\r\n\tprivate parseGovernanceServiceConfig(config: IInitOptions.IGovernanceServiceConfig): IInitOptions.IGovernanceServiceConfig {\r\n\t\tconst defaultGovernanceServiceConfig: IInitOptions.IGovernanceServiceConfig = {\r\n\t\t\t// by default, enable triggering surveys in case of GovernanceService call failure\r\n\t\t\tforceServicelessSurveyDisplay: true,\r\n\r\n\t\t\t// by default, no retry\r\n\t\t\tretry: 1,\r\n\r\n\t\t\t// by default, timeout is 1000 miliseconds\r\n\t\t\ttimeout: 1000,\r\n\r\n\t\t\t// SurveyLevelGovernance's default is false\r\n\t\t\tisSurveyLevelGovernanceEnabled: false,\r\n\t\t};\r\n\r\n\t\tif (config.forceServicelessSurveyDisplay !== undefined) {\r\n\t\t\tUtils.expectBoolean(config.forceServicelessSurveyDisplay, \"initOptionsFloodgate.governanceServiceConfig.forceServicelessSurveyDisplay\");\r\n\t\t\tdefaultGovernanceServiceConfig.forceServicelessSurveyDisplay = config.forceServicelessSurveyDisplay;\r\n\t\t}\r\n\r\n\t\tif (config.retry !== undefined) {\r\n\t\t\tUtils.expectNumber(config.retry, \"initOptionsFloodgate.governanceServiceConfig.retry\");\r\n\t\t\tdefaultGovernanceServiceConfig.retry = config.retry;\r\n\t\t}\r\n\r\n\t\tif (config.timeout !== undefined) {\r\n\t\t\tUtils.expectNumber(config.timeout, \"initOptionsFloodgate.governanceServiceConfig.timeout\");\r\n\t\t\tdefaultGovernanceServiceConfig.timeout = config.timeout;\r\n\t\t}\r\n\r\n\t\tif (config.isSurveyLevelGovernanceEnabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(config.isSurveyLevelGovernanceEnabled,\r\n\t\t\t\t\"initOptionsFloodgate.governanceServiceConfig.isSurveyLevelGovernanceEnabled\");\r\n\t\t\tdefaultGovernanceServiceConfig.isSurveyLevelGovernanceEnabled = config.isSurveyLevelGovernanceEnabled;\r\n\t\t}\r\n\r\n\t\treturn defaultGovernanceServiceConfig;\r\n\t}\r\n\r\n\tprivate parseDynamicCampaignConfig(config: IInitOptions.IDynamicCampaignConfig): IInitOptions.IDynamicCampaignConfig {\r\n\t\tconst defaultDynamicCampaignConfig: IInitOptions.IDynamicCampaignConfig = {\r\n\t\t\t// Disabled by default\r\n\t\t\tenabled: false,\r\n\r\n\t\t\tecsClient: undefined,\r\n\t\t};\r\n\r\n\t\tif (config.enabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(config.enabled, \"initOptionsFloodgate.dynamicCampaignConfig.enabled\");\r\n\t\t\tdefaultDynamicCampaignConfig.enabled = config.enabled;\r\n\t\t}\r\n\r\n\t\tif (config.ecsClient !== undefined) {\r\n\t\t\tUtils.expectObject(config.ecsClient, \"initOptionsFloodgate.dynamicCampaignConfig.ecsClient\");\r\n\t\t\tdefaultDynamicCampaignConfig.ecsClient = config.ecsClient;\r\n\t\t}\r\n\r\n\t\treturn defaultDynamicCampaignConfig;\r\n\t}\r\n\r\n\tprivate parseDynamicUxConfig(config: IInitOptions.IDynamicUxConfig): IInitOptions.IDynamicUxConfig {\r\n\t\tconst defaultDynamicUxConfig: IInitOptions.IDynamicUxConfig = {\r\n\t\t\t// Disabled by default\r\n\t\t\tenabled: false,\r\n\r\n\t\t\tdynamicVariables: undefined,\r\n\t\t};\r\n\r\n\t\tif (config.enabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(config.enabled, \"initOptionsFloodgate.dynamicUxConfig.enabled\");\r\n\t\t\tdefaultDynamicUxConfig.enabled = config.enabled;\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxConfig.enabled = false;\r\n\t\t}\r\n\r\n\t\tif (config.dynamicVariables !== undefined) {\r\n\t\t\tUtils.expectObject(config.dynamicVariables, \"initOptionsFloodgate.dynamicUxConfig.dynamicVariables\");\r\n\t\t\tObject.entries(config.dynamicVariables).forEach(([key, value]) => {\r\n\t\t\t\tUtils.expectString(key, \"initOptionsFloodgate.dynamicUxConfig.dynamicVariables.\" + key);\r\n\t\t\t\tUtils.expectSimpleType(value, \"initOptionsFloodgate.dynamicUxConfig.dynamicVariables[\" + key + \"]\");\r\n\t\t\t});\r\n\t\t\tdefaultDynamicUxConfig.dynamicVariables = config.dynamicVariables;\r\n\t\t}\r\n\r\n\t\tif (config.delayLoadingTimeout !== undefined) {\r\n\t\t\tUtils.expectNumber(config.delayLoadingTimeout, \"initOptionsFloodgate.dynamicUxConfig.delayLoadingTimeout\");\r\n\t\t\tdefaultDynamicUxConfig.delayLoadingTimeout = config.delayLoadingTimeout;\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxConfig.delayLoadingTimeout = 0;\r\n\t\t}\r\n\r\n\t\tconst parsedThemeConfig = this.parseDynamicUxThemeConfig({\r\n\t\t\ttheme: config.theme,\r\n\t\t\tcustomTheme: config.customTheme\r\n\t\t});\r\n\t\tdefaultDynamicUxConfig.theme = parsedThemeConfig.theme;\r\n\t\tdefaultDynamicUxConfig.customTheme = parsedThemeConfig.customTheme;\r\n\r\n\t\tif (config.footerButtonsAlignment !== undefined) {\r\n\t\t\tUtils.expectEnum(config.footerButtonsAlignment, AlignmentType, \"initOptionsFloodgate.dynamicUxConfig.footerButtonsAlignment\");\r\n\t\t\tdefaultDynamicUxConfig.footerButtonsAlignment = config.footerButtonsAlignment;\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxConfig.footerButtonsAlignment = AlignmentType.Left;\r\n\t\t}\r\n\r\n\t\tif (config.cdnStringConfig?.uiStringsCdnEnabled !== undefined) {\r\n\t\t\tUtils.expectBoolean(config.cdnStringConfig.uiStringsCdnEnabled, \"initOptionsFloodgate.dynamicUxConfig.cdnStringConfig.uiStringsCdnEnabled\");\r\n\t\t\tdefaultDynamicUxConfig.cdnStringConfig = {\r\n\t\t\t\tuiStringsCdnEnabled: config.cdnStringConfig.uiStringsCdnEnabled\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxConfig.cdnStringConfig = {\r\n\t\t\t\tuiStringsCdnEnabled: true\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (defaultDynamicUxConfig.cdnStringConfig.uiStringsCdnEnabled) {\r\n\t\t\tif (config.cdnStringConfig?.fetchCdnConcurrently !== undefined) {\r\n\t\t\t\tUtils.expectBoolean(config.cdnStringConfig.fetchCdnConcurrently, \"initOptionsFloodgate.dynamicUxConfig.cdnStringConfig.fetchCdnConcurrently\");\r\n\t\t\t\tdefaultDynamicUxConfig.cdnStringConfig.fetchCdnConcurrently = config.cdnStringConfig.fetchCdnConcurrently;\r\n\t\t\t} else {\r\n\t\t\t\tdefaultDynamicUxConfig.cdnStringConfig.fetchCdnConcurrently = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (config.cdnStringConfig?.uiStringsLoadingTimeout !== undefined) {\r\n\t\t\t\tUtils.expectNumber(config.cdnStringConfig.uiStringsLoadingTimeout,\r\n\t\t\t\t\t\"initOptionsFloodgate.dynamicUxConfig.cdnStringConfig.uiStringsLoadingTimeout\");\r\n\t\t\t\tdefaultDynamicUxConfig.cdnStringConfig.uiStringsLoadingTimeout = config.cdnStringConfig.uiStringsLoadingTimeout >= 0 ?\r\n\t\t\t\t\tconfig.cdnStringConfig.uiStringsLoadingTimeout : 3000;\r\n\t\t\t} else {\r\n\t\t\t\tdefaultDynamicUxConfig.cdnStringConfig.uiStringsLoadingTimeout = 3000; // by default, timeout is 3000 miliseconds\r\n\t\t\t}\r\n\r\n\t\t\tif (config.cdnStringConfig?.uiStringCdnRetryLimit !== undefined) {\r\n\t\t\t\tUtils.expectNumber(config.cdnStringConfig.uiStringCdnRetryLimit,\r\n\t\t\t\t\t\"initOptionsFloodgate.dynamicUxConfig.cdnStringConfig.uiStringCdnRetryLimit\");\r\n\t\t\t\tdefaultDynamicUxConfig.cdnStringConfig.uiStringCdnRetryLimit = config.cdnStringConfig.uiStringCdnRetryLimit >= 0 ?\r\n\t\t\t\t\tconfig.cdnStringConfig.uiStringCdnRetryLimit : 0;\r\n\t\t\t} else {\r\n\t\t\t\tdefaultDynamicUxConfig.cdnStringConfig.uiStringCdnRetryLimit = 0; // by default, no retry is neeeded\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (config.hostName !== undefined) {\r\n\t\t\tUtils.expectString(config.hostName, \"initOptionsFloodgate.dynamicUxConfig.hostName\")\r\n\t\t\tdefaultDynamicUxConfig.hostName = config.hostName;\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxConfig.hostName = CentroFloodgateHostName;\r\n\t\t}\r\n\r\n\t\treturn defaultDynamicUxConfig;\r\n\t}\r\n\t/**\r\n\t* function to validate theme config for dynamic ux independently.\r\n\t* @param config theme config\r\n\t*/\r\n\tprivate parseDynamicUxThemeConfig(config: IInitOptions.IDynamicUxThemeConfig): IInitOptions.IDynamicUxThemeConfig {\r\n\t\tconst defaultDynamicUxThemeConfig: IInitOptions.IDynamicUxThemeConfig = {};\r\n\r\n\t\tif (config.theme !== undefined) {\r\n\t\t\tUtils.expectString(config.theme, \"initOptionsFloodgate.dynamicUxConfig.theme\")\r\n\t\t\tdefaultDynamicUxThemeConfig.theme = config.theme;\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxThemeConfig.theme = Constants.CentroDefaultTheme;\r\n\t\t}\r\n\r\n\t\tif (config.customTheme !== undefined) {\r\n\t\t\tUtils.expectObject(config.customTheme, \"initOptionsFloodgate.dynamicUxConfig.customTheme\");\r\n\t\t\tdefaultDynamicUxThemeConfig.customTheme = config.customTheme;\r\n\t\t} else {\r\n\t\t\tdefaultDynamicUxThemeConfig.customTheme = undefined;\r\n\t\t}\r\n\r\n\t\treturn defaultDynamicUxThemeConfig;\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the theme configuration of the SDK.\r\n\t * @param themeConfig The new theme configuration.\r\n\t * @param centroThemeDS The theme data source object.\r\n\t * Throws an error if dynamic UX is not enabled or if themeConfig does not pass validation.\r\n\t */\r\n\tpublic updateTheme(themeConfig: IInitOptions.IDynamicUxThemeConfig, centroThemeDS: CentroThemeDataSource): void {\r\n\t\t// If dynamic UX is not enabled, we indicate an error.\r\n\t\tif (!this.floodgateInitOptions.dynamicUxConfig?.enabled) {\r\n\t\t\tthrow new Error(\"Failed to update theme configuration: dynamicUx not enabled\");\r\n\t\t}\r\n\r\n\t\tlet parsedThemeConfigResult: IInitOptions.IDynamicUxThemeConfig | null = null;\r\n\r\n\t\ttry {\r\n\t\t\t// validate\r\n\t\t\tparsedThemeConfigResult = this.parseDynamicUxThemeConfig(themeConfig);\r\n\t\t\t// update configuration\r\n\t\t\tthis.setDynamicUxThemeConfig(parsedThemeConfigResult);\r\n\r\n\t\t\t// Kick off the theme update on datasource for DynamicUx coupling side\r\n\t\t\tcentroThemeDS.updateThemeState({\r\n\t\t\t\tbaseTheme: parsedThemeConfigResult.theme,\r\n\t\t\t\tcustomTheme: parsedThemeConfigResult.customTheme,\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t} catch (error) {\r\n\t\t\tthrow new Error(\"Failed to update theme configuration: \" + error);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set the telemetry sink\r\n\t * @param sinkObj The new telemetry Sink object\r\n\t * Throws an error if sinkObj is not an object.\r\n\t */\r\n\tpublic updateTelemetrySink(sinkObj: TelemetrySink): void {\r\n\t\tUtils.expectObject(sinkObj, \"TelmetrySink.Object\");\r\n\t\tthis.commonInitOptions.telemetrySink = sinkObj;\r\n\t}\r\n\r\n}\r\n\r\nconst configuration: Configuration = new Configuration();\r\n\r\n/**\r\n * Get the current configuration\r\n */\r\nexport function get(): Configuration {\r\n\treturn configuration;\r\n}\r\n\r\n/**\r\n * Validate feedbackType\r\n * @param feedbackType feedbackType\r\n * @returns {Constants.FeedbackType} the validated feedbackType\r\n */\r\nexport function validateFeedbackType(feedbackType: string): Constants.FeedbackType {\r\n\tUtils.expectString(feedbackType, \"feedbackType\");\r\n\r\n\tif (feedbackType === Constants.FeedbackType[Constants.FeedbackType.Smile]) {\r\n\t\treturn Constants.FeedbackType.Smile;\r\n\t} else if (feedbackType === Constants.FeedbackType[Constants.FeedbackType.Frown]) {\r\n\t\treturn Constants.FeedbackType.Frown;\r\n\t} else if (feedbackType === Constants.FeedbackType[Constants.FeedbackType.Bug]) {\r\n\t\treturn Constants.FeedbackType.Bug;\r\n\t} else {\r\n\t\tthrow \"feedbackType should be one of Smile, Frown or Bug\";\r\n\t}\r\n}\r\n", "import { IFloodgateFeatureStatusCallback } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { safeParseObject } from \"@ms-ofb/officefloodgatecore/dist/src/Utils\";\r\nimport { readFeatureGateOverridesFromCache } from \"../Configuration/ReadCacheOverrides\";\r\n\r\nexport default class FeatureGateProvider implements IFloodgateFeatureStatusCallback {\r\n\t// Calback for retrieving feature gate values from host app to enable experimental features \r\n\tprivate featureStatusCallback?: IFloodgateFeatureStatusCallback;\r\n\r\n\tconstructor(featureStatusCallback?: IFloodgateFeatureStatusCallback) {\r\n\t\tthis.featureStatusCallback = featureStatusCallback ?? null;\r\n\t}\r\n\r\n\tpublic getStringFeatureStatus(featureGateName: string, defaultValue = \"\"): string {\r\n\t\tif (!this.featureStatusCallback) {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst cacheOverride = readFeatureGateOverridesFromCache(featureGateName);\r\n\t\t\tif (cacheOverride) {\r\n\t\t\t\treturn cacheOverride.toString();\r\n\t\t\t}\r\n\t\t\treturn this.featureStatusCallback.getStringFeatureStatus(featureGateName, defaultValue);\r\n\t\t} catch {\r\n\t\t\treturn defaultValue\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getIntFeatureStatus(featureGateName: string, defaultValue = 0): number {\r\n\t\tif (!this.featureStatusCallback) {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst cacheOverride = readFeatureGateOverridesFromCache(featureGateName);\r\n\t\t\tif (cacheOverride) {\r\n\t\t\t\treturn parseInt(cacheOverride.toString());\r\n\t\t\t}\r\n\t\t\treturn this.featureStatusCallback.getIntFeatureStatus(featureGateName, defaultValue);\r\n\t\t} catch {\r\n\t\t\treturn defaultValue\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getBoolFeatureStatus(featureGateName: string, defaultValue = false): boolean {\r\n\t\tif (!this.featureStatusCallback) {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\ttry {\r\n\t\t\tconst cacheOverride = readFeatureGateOverridesFromCache(featureGateName);\r\n\t\t\tif (cacheOverride) {\r\n\t\t\t\treturn cacheOverride.toString() === \"true\";\r\n\t\t\t}\r\n\t\t\treturn this.featureStatusCallback.getBoolFeatureStatus(featureGateName, defaultValue);\r\n\t\t} catch {\r\n\t\t\treturn defaultValue\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getJsonObjectStringFeatureStatus<T>(featureGateName: string, defaultValue: T = null): T {\r\n\t\tif (!this.featureStatusCallback) {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst overrideValue = this.getStringFeatureStatus(featureGateName, \"\");\r\n\t\t\tif (!overrideValue) {\r\n\t\t\t\treturn defaultValue;\r\n\t\t\t}\r\n\r\n\t\t\treturn safeParseObject(overrideValue, defaultValue);\r\n\t\t} catch {\r\n\t\t\treturn defaultValue\r\n\t\t}\r\n\t}\r\n}", "/**\r\n * Implementation of IFloodgateStorageProvider for Web SDK\r\n */\r\n\r\nimport { FloodgateStorageProviderFileType as FileType, IFloodgateStorageProvider } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Window from \"./../Window/Window\";\r\nimport * as Logging from \"./../Logging/Logging\";\r\n\r\nconst fileTypeToKeyMap: { [k in FileType]: string } = {\r\n\t[FileType.CampaignDefinitions]: \"obf-CampaignDefinitions\",\r\n\t[FileType.CampaignStates]: \"obf-CampaignStates\",\r\n\t[FileType.FloodgateSettings]: \"obf-FloodgateSettings\",\r\n\t[FileType.GovernedChannelStates]: \"obf-GovernedChannelStates\",\r\n\t[FileType.SurveyActivationStats]: \"obf-SurveyActivationStats\",\r\n\t[FileType.SurveyEventActivityStats]: \"obf-SurveyEventActivityStats\",\r\n\t[FileType.TmsCache_CampaignContent]: \"obf-TmsCampaignContent\",\r\n\t[FileType.TmsCache_MessageMetadata]: \"obf-TmsMessageMetadata\",\r\n\t[FileType.TmsCache_UserGovernance]: \"obf-TmsUserGovernance\",\r\n\t[FileType.Tms_DynamicSettings]: \"obf-TmsDynamicSettings\",\r\n\t[FileType.LogLevelSettings]: \"obf-LogLevelSettings\",\r\n\t[FileType.UserFacts]: \"obf-UserFacts\",\r\n\t[FileType.DebugOverrides]: \"obf-DebugOverrides\",\r\n\t[FileType.DynamicCampaignDefinitions]: \"obf-DynamicCampaignDefinitions\",\r\n\t[FileType.FeatureGateOverrides]: \"obf-FeatureGateOverrides\",\r\n};\r\n\r\nexport default class FloodgateStorageProvider implements IFloodgateStorageProvider {\r\n\t/**\r\n\t * Code to detect localStorage presence.\r\n\t * Copied from MDN: https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n\t */\r\n\tpublic static isStorageAvailable(): boolean {\r\n\t\ttry {\r\n\t\t\tconst x = \"__storage_test__\";\r\n\t\t\tWindow.getGlobal().localStorage.setItem(x, x);\r\n\t\t\tWindow.getGlobal().localStorage.removeItem(x);\r\n\t\t\treturn true;\r\n\t\t} catch (e) {\r\n\t\t\treturn e instanceof DOMException && (\r\n\t\t\t\t// everything except Firefox\r\n\t\t\t\te.code === 22 ||\r\n\t\t\t\t// Firefox\r\n\t\t\t\te.code === 1014 ||\r\n\t\t\t\t// test name field too, because code might not be present\r\n\t\t\t\t// everything except Firefox\r\n\t\t\t\te.name === \"QuotaExceededError\" ||\r\n\t\t\t\t// Firefox\r\n\t\t\t\te.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\r\n\t\t\t\t// acknowledge QuotaExceededError only if there's something already stored\r\n\t\t\t\tWindow.getGlobal().localStorage.length !== 0;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Safely read an object\r\n\t */\r\n\tpublic static safeReadObject<T>(fileType: FileType, defaultValue: T = undefined): T {\r\n\t\tif (!(fileType in FileType)) {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst storageKey = fileTypeToKeyMap[fileType];\r\n\t\t\tconst result = Window.getGlobal().localStorage.getItem(storageKey);\r\n\t\t\tconst parsedObject = result && (result[0] === \"{\" || result[0] === \"[\") ? JSON.parse(result) : result;\r\n\t\t\treturn parsedObject ?? defaultValue;\r\n\t\t} catch (e) {\r\n\t\t\t// ignore\r\n\t\t}\r\n\r\n\t\treturn defaultValue;\r\n\t}\r\n\r\n\t/**\r\n\t * Lock the file to prevent access from another process.\r\n\t */\r\n\tpublic fileLock(fileType: FileType): void {\r\n\t\t// JS runs on a single thread in the browser.\r\n\t\treturn;\r\n\t}\r\n\r\n\t/**\r\n\t * Unlock the file.\r\n\t */\r\n\tpublic fileUnlock(fileType: FileType): void {\r\n\t\t// JS runs on a single thread in the browser.\r\n\t\treturn;\r\n\t}\r\n\r\n\t/**\r\n\t * Read the file\r\n\t */\r\n\tpublic read(fileType: FileType): string {\r\n\t\tif (!(fileType in FileType)) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\tconst storageKey = fileTypeToKeyMap[fileType];\r\n\t\tlet result: string;\r\n\t\ttry {\r\n\t\t\tresult = Window.getGlobal().localStorage.getItem(storageKey);\r\n\t\t} catch (e) {\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_FLOODGATE_FILEREAD_FAILED,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: e.toString(),\r\n\t\t\t\t\tFileName: storageKey,\r\n\t\t\t\t});\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Write to the file\r\n\t */\r\n\tpublic write(fileType: FileType, content: string): void {\r\n\t\tif (!(fileType in FileType)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst storageKey = fileTypeToKeyMap[fileType];\r\n\t\ttry {\r\n\t\t\tWindow.getGlobal().localStorage.setItem(storageKey, content);\r\n\t\t} catch (e) {\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_FLOODGATE_FILEWRITE_FAILED,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: e.toString(),\r\n\t\t\t\t\tFileName: storageKey,\r\n\t\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n}\r\n", "import { FloodgateStorageProviderFileType as FileType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { getDynamicSetting, SettingKey } from \"@ms-ofb/officepersonalization/dist/lib/Configuration/DynamicConfiguration\";\r\nimport FloodgateStorageProvider from \"../FloodgateCore/FloodgateStorageProvider\";\r\nimport * as Configuration from \"./../Configuration/Configuration\";\r\nimport { IInitOptionsCommon, ISamplingInitOption } from \"./../Configuration/IInitOptions\";\r\nimport { Environment } from \"./../Constants\";\r\nimport * as Utils from \"./../Utils\";\r\nimport { ICustomProperties, IEventId } from \"./Constants\";\r\nimport { App, Browser, Device, Host, Release, Session } from \"./Telemetry/Contracts\";\r\nimport ITelemetryLogger from \"./Telemetry/ITelemetryLogger\";\r\nimport TelemetryLoggerFactory from \"./Telemetry/TelemetryLoggerFactory\";\r\n\r\nexport { EventIds, ICustomProperties, IEventId } from \"./Constants\";\r\n\r\nconst { isNOU } = Utils;\r\nconst FEEDBACK_NAMESPACE = \"Office.Feedback\";\r\nconst ENGAGEMENT_NAMESPACE = \"Office.Engagement\";\r\n\r\nlet logger: ILogger;\r\nlet userFactLogger: IUserFactLogger;\r\nlet env: Environment;\r\n\r\n/**\r\n * Initialize the logging module\r\n * @param initOptionsCommon object contains common init options\r\n * @param appName app name\r\n * @param appVersion app version\r\n * @param logSessionId local SDK session id\r\n */\r\nexport function initialize(initOptionsCommon: IInitOptionsCommon, appName: string, appVersion: string,\r\n\tlogSessionId: string, samplingOption: ISamplingInitOption): void {\r\n\r\n\tconst telemetryGroup = initOptionsCommon.telemetryGroup ? initOptionsCommon.telemetryGroup : {};\r\n\tconst webGroup = initOptionsCommon.webGroup ? initOptionsCommon.webGroup : {};\r\n\r\n\tlogger = new Logger(\r\n\t\tTelemetryLoggerFactory.create(\r\n\t\t\tTokenManager.getTenantToken(initOptionsCommon.environment),\r\n\t\t\tFEEDBACK_NAMESPACE,\r\n\t\t\tinitOptionsCommon.telemetrySink,\r\n\t\t\tnew App(appName, appVersion),\r\n\t\t\tnew Session(logSessionId),\r\n\t\t\tnew Host(initOptionsCommon.appId.toString(), initOptionsCommon.originalLocale, initOptionsCommon.sessionId, initOptionsCommon.build),\r\n\t\t\tnew Release(telemetryGroup.audienceGroup),\r\n\t\t\tnew Browser(webGroup.browser, webGroup.browserVersion),\r\n\t\t\tnew Device(telemetryGroup.deviceId),\r\n\t\t),\r\n\t\tsamplingOption,\r\n\t\tinitOptionsCommon\r\n\t);\r\n\r\n\tuserFactLogger = new UserFactLogger(\r\n\t\tTelemetryLoggerFactory.create(\r\n\t\t\tTokenManager.getTenantTokenByNamespace(ENGAGEMENT_NAMESPACE),\r\n\t\t\tENGAGEMENT_NAMESPACE,\r\n\t\t\tinitOptionsCommon.telemetrySink,\r\n\t\t\tnew App(appName, appVersion),\r\n\t\t\tnew Session(logSessionId),\r\n\t\t\tnew Host(initOptionsCommon.appId.toString(), initOptionsCommon.originalLocale, initOptionsCommon.sessionId, initOptionsCommon.build),\r\n\t\t\tnew Release(telemetryGroup.audienceGroup),\r\n\t\t\tnew Browser(webGroup.browser, webGroup.browserVersion),\r\n\t\t\tnew Device(telemetryGroup.deviceId),\r\n\t\t)\r\n\t);\r\n\r\n\tenv = initOptionsCommon.environment;\r\n}\r\n\r\n/**\r\n * Get the logger object\r\n */\r\nexport function getLogger(): ILogger {\r\n\treturn logger;\r\n}\r\n\r\n/**\r\n * Get the user fact logger object\r\n */\r\nexport function getUserFactLogger(): IUserFactLogger {\r\n\treturn userFactLogger;\r\n}\r\n\r\n/**\r\n * Interface for a logger\r\n */\r\nexport interface ILogger {\r\n\tlogEvent(eventId: IEventId, logSeverity: LogLevel, customProperties?: ICustomProperties, internalSampleRate?: number): void;\r\n\tlogLocal?(logSeverity: LogLevel, ...others: any[]): void;\r\n\tflushQueue?(): void;\r\n}\r\n\r\nexport interface IUserFactLogger {\r\n\tlogUserFact(userFact: string, factValue: string): void;\r\n}\r\n\r\n/**\r\n * Log level settings\r\n */\r\nexport const enum LogLevel {\r\n\tNone,\r\n\tCritical,\r\n\tError,\r\n\tInfo\r\n}\r\n\r\ninterface ILogSettings {\r\n\tconsoleLog?: boolean;\r\n\tisEnabled?: boolean;\r\n\tlogLevel?: LogLevel;\r\n}\r\n\r\ninterface ILogLevelSettings {\r\n\tcontent: ILogSettings;\r\n}\r\n\r\n/**\r\n * Class representing a logger for the feedback SDK\r\n */\r\nexport class Logger implements ILogger {\r\n\tprivate static EVENT_NAME = \"SDK\";\r\n\tprivate static EVENT_ID = \"EventId\";\r\n\tprivate static DEFAULT_SAMPLE_RATE = 1;\r\n\tprivate static IS_DYNAMIC_UX_ENABLED = \"IsDynamicUXEnabled\";\r\n\tprivate static IS_DYNAMIC_CAMPAIGN_ENABLED = \"IsDynamicCampaignEnabled\";\r\n\r\n\tprivate telemetryLogger: ITelemetryLogger;\r\n\tprivate logLevel: LogLevel;\r\n\tprivate isConsoleLogEnabled: boolean;\r\n\tprivate dynamicLogSettings: ILogLevelSettings;\r\n\r\n\tprivate eventSampling: ISamplingInitOption;\r\n\tprivate initOptionsCommon: IInitOptionsCommon;\r\n\r\n\tprivate readonly SAMPLING_RESULT = Math.random();\r\n\r\n\tconstructor(telemetryLogger: ITelemetryLogger, samplingOptions: ISamplingInitOption, initOptionsCommon?: IInitOptionsCommon) {\r\n\t\tif (!telemetryLogger) {\r\n\t\t\tthrow new Error(\"telemetryLogger must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.telemetryLogger = telemetryLogger;\r\n\t\tthis.eventSampling = samplingOptions;\r\n\t\tthis.initOptionsCommon = initOptionsCommon;\r\n\t}\r\n\r\n\t/**\r\n\t * Flush the queue and send all events at once.\r\n\t */\r\n\tpublic flushQueue(): void {\r\n\t\tthis.telemetryLogger.flushQueue();\r\n\t}\r\n\r\n\t/**\r\n\t * Log an event\r\n\t * @param eventId event Id\r\n\t * @param logSeverity the log level severity for the message\r\n\t * @param customProperties custom properties to add to the log\r\n\t * @param internalSampleRate sample rate for this event in decimal (example: 0.05 for 5%). (Does not override host set sampleRate)\r\n\t */\r\n\tpublic logEvent(eventId: IEventId, logSeverity: LogLevel, customProperties?: ICustomProperties, internalSampleRate?: number): boolean {\r\n\t\tif (!eventId) {\r\n\t\t\tthrow new Error(\"eventId must not be null\");\r\n\t\t}\r\n\r\n\t\tlet sampleRate: number;\r\n\r\n\t\t// Host set sample rate has precedence over internalSampleRate.\r\n\t\tif (this.isEventSampled(eventId.name)) {\r\n\t\t\tsampleRate = this.getEventSamplingRate(eventId.name);\r\n\t\t} else if (internalSampleRate !== undefined) {\r\n\t\t\tsampleRate = internalSampleRate;\r\n\t\t}\r\n\r\n\t\tif (isNOU(logSeverity) || logSeverity === LogLevel.None) {\r\n\t\t\tif (env === Environment.Production) {\r\n\t\t\t\tconst errorMessage = \"logSeverity must not be null or none\";\r\n\t\t\t\tif (this.isConsoleLogEnabled && console) {\r\n\t\t\t\t\tconsole.log(\"Floodgate event: \", Logger.EVENT_NAME, errorMessage);\r\n\t\t\t\t}\r\n\t\t\t\tthis.telemetryLogger.logEvent(Logger.EVENT_NAME, { ErrorMessage: errorMessage }, sampleRate);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// add base values for every log event\r\n\t\tcustomProperties = customProperties || {};\r\n\t\t(<any>customProperties)[Logger.EVENT_ID] = eventId.name;\r\n\t\t(<any>customProperties)[Logger.IS_DYNAMIC_UX_ENABLED] = Configuration.get().getFloodgateInitOptions()?.dynamicUxConfig?.enabled ?? false;\r\n\t\t(<any>customProperties)[Logger.IS_DYNAMIC_CAMPAIGN_ENABLED] = Configuration.get().getFloodgateInitOptions()?.dynamicCampaignConfig?.enabled ?? false;\r\n\r\n\t\tif (this.isLoggingEnabled(logSeverity, sampleRate) || this.isEventTelemetryEnabled(eventId.name)) {\r\n\t\t\tsampleRate = sampleRate ?? Logger.DEFAULT_SAMPLE_RATE;\r\n\t\t\tthis.telemetryLogger.logEvent(Logger.EVENT_NAME, customProperties, sampleRate);\r\n\t\t}\r\n\r\n\t\tif (this.isConsoleLogEnabled && console) {\r\n\t\t\tconsole.log(\"Floodgate event: \", Logger.EVENT_NAME, logSeverity, customProperties);\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic logLocal?(logSeverity: LogLevel, ...others: any[]): void {\r\n\t\tif (this.isLoggingEnabled(logSeverity) && this.isConsoleLogEnabled && console) {\r\n\t\t\tconsole.log(\"LPP FG: \", logSeverity, others);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getUserSamplingRate(): number {\r\n\t\treturn this.SAMPLING_RESULT;\r\n\t}\r\n\r\n\tpublic isEventTelemetryEnabled(eventName: string): boolean {\r\n\t\ttry {\r\n\t\t\tif (!this.dynamicLogSettings) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tconst appId = this.initOptionsCommon?.appId?.toString();\r\n\t\t\tconst locale = this.initOptionsCommon?.originalLocale?.toLowerCase();\r\n\t\t\tconst settingName = `content_${eventName}`;\r\n\r\n\t\t\t// try settings from more specific to generic order\r\n\t\t\tconst overrideSettings =\r\n\t\t\t\tthis.dynamicLogSettings[`${settingName}_${appId}_${locale}` as unknown as keyof ILogLevelSettings] ||\r\n\t\t\t\tthis.dynamicLogSettings[`${settingName}_${appId}` as unknown as keyof ILogLevelSettings] ||\r\n\t\t\t\tthis.dynamicLogSettings[`${settingName}_${locale}` as unknown as keyof ILogLevelSettings] ||\r\n\t\t\t\tthis.dynamicLogSettings[settingName as keyof ILogLevelSettings];\r\n\r\n\t\t\treturn overrideSettings?.isEnabled;\r\n\t\t} catch (e) {\r\n\t\t\tif (this.isConsoleLogEnabled) {\r\n\t\t\t\tconsole.log(\"FG: Error checking for dynamic log settings: \", e);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * This method enables logging if either the log severity of the event is less than or equal to the current log level set or if the event\r\n\t * has an inputSampleRate and the current log level is not set to None, and if the sample rate is greater than 0 and the random generated\r\n\t * number is within the sample rate. \r\n\t * \r\n\t * For example, if the log severity of the event is LogLevel.Error and the current log level is set as LogLevel.Critical, then\r\n\t * isLoggingEnabled will return false due to the condition LogLevel.Error <= LogLevel.Critical unless the event has an inputSampleRate. \r\n\t * If the event meets either of these conditions, then a random number will be generated. If the random generated number is less than\r\n\t * the sample rate and the sample rate itself is not full blocking (0 value), the event will be logged. \r\n\t * \r\n\t * If no current log level is set, then log level is set as LogLevel.Error by default. In this case, all events with critical log\r\n\t * severity, events with error log severity, and events with a given sample rate get logged. If the current log level is None, no\r\n\t * events are logged.\r\n\t * \r\n\t * @param inputLogLevel the log severity of the event. This follows the order defined in the LogLevel enum (None < Critical < Error < Info)\r\n\t * @param inputSampleRate the percentage of users allowed to send the event back (given either through the host or the internalSampleRate)\r\n\t */\r\n\tprivate isLoggingEnabled(inputLogLevel: LogLevel, inputSampleRate?: number): boolean {\r\n\t\tif (isNOU(this.logLevel)) {\r\n\t\t\tconst currentLogLevel = this.getCurrentLogLevel();\r\n\t\t\tthis.logLevel = isNOU(currentLogLevel) ? LogLevel.Error : currentLogLevel;\r\n\t\t}\r\n\r\n\t\tconst sampleRate = inputSampleRate ?? Logger.DEFAULT_SAMPLE_RATE;\r\n\r\n\t\treturn ((inputLogLevel <= this.logLevel || (this.logLevel !== LogLevel.None && inputSampleRate !== undefined))\r\n\t\t\t&& this.SAMPLING_RESULT <= sampleRate && sampleRate !== 0);\r\n\t}\r\n\r\n\t/**\r\n\t * This method returns the current log level if it is set in either url query parameters or floodgate local storage.\r\n\t * Following table summarizes whether the log event calls with a log severity will log the events or not according\r\n\t * to the current log level set. For example, the first row in the table demonstrates that when the current log level\r\n\t * enabled is critical, then the log event will log the events only if the log severity is critical.\r\n\t *\r\n\t * Current Log Level Enabled | LogSeverity: Critical\t| LogSeverity: Error\t| LogSeverity: Info\r\n\t * --------------------------------------------------------------------------------------------\r\n\t * Critical Enabled\t\t\t | yes      \t\t\t\t| no    \t\t\t \t| no\r\n\t * Error Enabled       \t\t | yes      \t\t\t\t| yes   \t\t\t \t| no\r\n\t * Info Enabled        \t\t | yes      \t\t\t\t| yes   \t\t\t \t| yes\r\n\t * None Enabled        \t\t | no       \t\t\t\t| no    \t\t\t \t| no\r\n\t *\r\n\t * Console logging will be enabled when the current log level is set through the url query parameters or\r\n\t * when the url query parameter \"obfconsolelog\" is explicitly set to true.\r\n\t */\r\n\tprivate getCurrentLogLevel(): LogLevel {\r\n\t\ttry {\r\n\t\t\t// Check if console log is enabled in local browser session with query parameter overrides\r\n\t\t\tconst urlParams = typeof URLSearchParams !== \"undefined\" && new URLSearchParams(window.location.search) || undefined;\r\n\t\t\tlet consoleLogParam: string | boolean = urlParams && urlParams.get(\"obfconsolelog\");\r\n\t\t\tif (!consoleLogParam) {\r\n\t\t\t\t// for getting iframe host url - eg: WAC\r\n\t\t\t\tconst documentReferrer = typeof document !== \"undefined\" && document.referrer;\r\n\t\t\t\tconsoleLogParam = documentReferrer && documentReferrer.indexOf(\"obfconsolelog\") !== -1;\r\n\t\t\t}\r\n\r\n\t\t\tif (consoleLogParam) {\r\n\t\t\t\tthis.isConsoleLogEnabled = true;\r\n\t\t\t}\r\n\r\n\t\t\t// Check if log level is set in local browser session with query parameter overrides\r\n\t\t\tconst logLevelParam = urlParams && urlParams.get(\"obfloglevel\");\r\n\t\t\tif (!isNOU(logLevelParam)) {\r\n\t\t\t\tthis.isConsoleLogEnabled = true;\r\n\t\t\t\treturn parseInt(logLevelParam, 10);\r\n\t\t\t}\r\n\r\n\t\t\t// Check if log level is set in floodgate local storage (manually or with remotely fetched settings)\r\n\t\t\tif (FloodgateStorageProvider.isStorageAvailable()) {\r\n\t\t\t\tconst floodgateStorageProvider: FloodgateStorageProvider = new FloodgateStorageProvider();\r\n\t\t\t\tlet tempStorageItem: string = floodgateStorageProvider.read(FileType.LogLevelSettings);\r\n\t\t\t\tif (!tempStorageItem) {\r\n\t\t\t\t\ttempStorageItem = getDynamicSetting(SettingKey.logLevelSettings, \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst settingsObj = tempStorageItem && this.parseObject(tempStorageItem);\r\n\t\t\t\tif (settingsObj) {\r\n\t\t\t\t\tthis.dynamicLogSettings = settingsObj;\r\n\t\t\t\t\tlet logSettings = settingsObj.content as ILogSettings;\r\n\r\n\t\t\t\t\tif (this.initOptionsCommon) {\r\n\t\t\t\t\t\tconst appId = this.initOptionsCommon.appId && this.initOptionsCommon.appId.toString();\r\n\t\t\t\t\t\tconst locale = this.initOptionsCommon.originalLocale && this.initOptionsCommon.originalLocale.toLowerCase();\r\n\r\n\t\t\t\t\t\t// log settings from more specific to generic order\r\n\t\t\t\t\t\tlogSettings = settingsObj[`content_${appId}_${locale}`] ||\r\n\t\t\t\t\t\t\tsettingsObj[`content_${appId}`] ||\r\n\t\t\t\t\t\t\tsettingsObj[`content_${locale}`] ||\r\n\t\t\t\t\t\t\tsettingsObj[`content`];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (logSettings) {\r\n\t\t\t\t\t\tif (logSettings.consoleLog) {\r\n\t\t\t\t\t\t\tthis.isConsoleLogEnabled = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn logSettings.logLevel;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tif (this.isConsoleLogEnabled) {\r\n\t\t\t\tconsole.log(\"Error while getting the current log level: \", e);\r\n\t\t\t}\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate parseObject(tempItem: string): any {\r\n\t\ttry {\r\n\t\t\treturn JSON.parse(tempItem);\r\n\t\t} catch (e) {\r\n\t\t\tif (this.isConsoleLogEnabled) {\r\n\t\t\t\tconsole.log(\"Error while parsing the json string for log level: \", e);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getEventSamplingRate(eventId: string): number {\r\n\t\tlet sampleRate = 1;\r\n\t\tif (this.eventSampling.event) {\r\n\t\t\t// If the event is init with sample rate\r\n\t\t\t// check the sampling result against the sample rate\r\n\t\t\tif (eventId in this.eventSampling.event) {\r\n\t\t\t\tsampleRate = this.eventSampling.event[eventId];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn sampleRate;\r\n\t}\r\n\r\n\tprivate isEventSampled(eventId: string): boolean {\r\n\t\tif (this.eventSampling.event) {\r\n\t\t\tif (eventId in this.eventSampling.event) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport class UserFactLogger implements IUserFactLogger {\r\n\tprivate static FACTVALUE_DATA_PROPERTY = \"FactValue\";\r\n\tprivate telemetryLogger: ITelemetryLogger;\r\n\tconstructor(telemetryLogger: ITelemetryLogger) {\r\n\t\tif (!telemetryLogger) {\r\n\t\t\tthrow new Error(\"telemetryLogger must not be null\");\r\n\t\t}\r\n\t\tthis.telemetryLogger = telemetryLogger;\r\n\t}\r\n\r\n\t/**\r\n\t * Log a user fact\r\n\t * @param userFactName user fact name\r\n\t * @param factTime time the user fact occured\r\n\t */\r\n\tpublic logUserFact(userFactName: string, factValue: string): void {\r\n\t\tif (!userFactName) {\r\n\t\t\tthrow new Error(\"user fact must not be null\");\r\n\t\t}\r\n\t\tif (!factValue) {\r\n\t\t\tthrow new Error(\"fact value must not be null\");\r\n\t\t}\r\n\r\n\t\tconst customProperties: ICustomProperties = { [UserFactLogger.FACTVALUE_DATA_PROPERTY]: factValue };\r\n\t\tthis.telemetryLogger.logEvent(userFactName, customProperties);\r\n\r\n\t\t// tslint:disable:no-console\r\n\t\tgetLogger().logLocal(LogLevel.Info, userFactName, customProperties);\r\n\t}\r\n}\r\n\r\nclass TokenManager {\r\n\tpublic static getTenantToken(environment: Environment): string {\r\n\t\tif (environment === Environment.Production) {\r\n\t\t\treturn TokenManager.TENANT_TOKEN_FEEDBACK_PRODUCTION;\r\n\t\t} else {\r\n\t\t\treturn TokenManager.TENANT_TOKEN_FEEDBACK_PRE_PRODUCTION;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static getTenantTokenByNamespace(namespace: string): string {\r\n\t\tif (namespace === ENGAGEMENT_NAMESPACE) {\r\n\t\t\treturn TokenManager.TENANT_TOKEN_ENGAGEMENT;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tprivate static TENANT_TOKEN_ENGAGEMENT =\r\n\t\t\"ceda5b13e30f4f9da3617f64bfcb9a6b-7d7a3ec0-00b0-4642-9986-18cef650aa81-7263\"; // \"Office Engagement\" Prod Aria tenant\r\n\tprivate static TENANT_TOKEN_FEEDBACK_PRODUCTION =\r\n\t\t\"d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360\"; // \"Office Feedback\" Prod Aria tenant\r\n\tprivate static TENANT_TOKEN_FEEDBACK_PRE_PRODUCTION =\r\n\t\t\"2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736\"; // \"Office Feedback\" Sandbox Aria tenant\r\n}\r\n", "import { ContentType } from \"../Common/ContentType\";\r\nimport { ContentTypeToStorageKeyMap } from \"../Common/ContentType\";\r\nimport { EventIds } from \"../Logging/Constants\";\r\nimport * as Logging from \"../Logging/Logger\";\r\nimport * as Caching from \"../Utils/Caching\";\r\nimport * as Storage from \"../Utils/Storage\";\r\nimport * as Utils from \"../Utils/Utils\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nexport const enum SettingKey {\r\n\t// General\r\n\tlogLevelSettings = \"LogLevelSettings\",\r\n\r\n\t// Web surfaces\r\n\tteachingMessageCooldown = \"TeachingMessageCooldown\",\r\n\twebSurfacesIntLink = \"WebSurfacesIntLink\",\r\n\twebSurfacesProdLink = \"WebSurfacesProdLink\",\r\n\r\n\t// TMS settings\r\n\ttmsAppId = \"TmsAppId\",\r\n\ttmsServiceUrl = \"TmsServiceUrl\",\r\n\ttmsActionUrl = \"TmsActionUrl\",\r\n\ttmsLoadTimeout = \"TmsLoadTimeout\",\r\n\ttmsMessageMetadataExpiry = \"TmsMessageMetadataExpiry\",\r\n\ttmsUserGovernanceRulesExpiry = \"TmsUserGovernanceRulesExpiry\",\r\n\ttmsCampaignContentExpiry = \"TmsCampaignContentExpiry\",\r\n\ttmsDynamicSettingsExpiry = \"TmsDynamicSettingsExpiry\",\r\n\ttmsLogLevelSettingsExpiry = \"TmsLogLevelSettingsExpiry\",\r\n\ttmsUserFactsExpiry = \"TmsUserFactsExpiry\",\r\n\r\n\t// Tulips\r\n\ttulipsAppId = \"TulipsAppId\",\r\n\ttulipsLoadTimeout = \"TulipsLoadTimeout\",\r\n\ttulipsServiceUrl = \"TulipsServiceUrl\",\r\n\ttulipsIngestionTimeInterval = \"TulipsIngestionTimeInterval\",\r\n\r\n\t// AugLoop\r\n\ttulipsAugLoopAnnotationName = \"TulipsAugLoopAnnotationName\",\r\n\ttulipsAugLoopPackageDelayLoad = \"TulipsAugLoopPackageDelayLoad\",\r\n\ttulipsAugLoopLoadRetryTimes = \"TulipsAugLoopLoadRetryTimes\",\r\n\ttulipsAugLoopLoadTimeout = \"TulipsAugLoopLoadTimeout\",\r\n}\r\n\r\nlet dynamicSettingsTmsgCache: { [key: string]: Caching.ICacheItem } = {};\r\n\r\nfunction parseObjectFromCache(tempItem: string): Caching.ICacheItem {\r\n\ttry {\r\n\t\tconst tempCacheItem: Caching.ICacheItem = JSON.parse(tempItem);\r\n\t\treturn tempCacheItem;\r\n\t} catch (e) {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport function getDynamicSetting<T>(key: SettingKey, defaultValue: T): T {\r\n\ttry {\r\n\t\tdynamicSettingsTmsgCache = {};\r\n\t\tif (Storage.isStorageAvailable) {\r\n\t\t\tconst tempStorageItem: string = Storage.readObjectFromStorage(ContentTypeToStorageKeyMap[ContentType.dynamicSettings]);\r\n\t\t\tif (!isNOU(tempStorageItem)) {\r\n\t\t\t\tconst tempCacheItem: Caching.ICacheItem = parseObjectFromCache(tempStorageItem);\r\n\t\t\t\tif (!isNOU(tempCacheItem)) {\r\n\t\t\t\t\ttempCacheItem.expiryDate = typeof tempCacheItem.expiryDate === \"string\" ?\r\n\t\t\t\t\t\tnew Date(tempCacheItem.expiryDate) : tempCacheItem.expiryDate;\r\n\t\t\t\t\tdynamicSettingsTmsgCache[tempCacheItem.contentType] = tempCacheItem;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dynamicSettingsTmsgCache.isNOU) {\r\n\t\t\treturn defaultValue;\r\n\t\t}\r\n\r\n\t\tconst settingsObj = (dynamicSettingsTmsgCache[ContentType.dynamicSettings]\r\n\t\t\t&& dynamicSettingsTmsgCache[ContentType.dynamicSettings].content) as Record<string, T>;\r\n\t\tif (!isNOU(settingsObj)\r\n\t\t\t&& Object.prototype.hasOwnProperty.call(settingsObj, key)\r\n\t\t\t&& !isNOU(settingsObj[key])) {\r\n\t\t\tconst settingValue = settingsObj[key];\r\n\r\n\t\t\t// parse types\r\n\t\t\tif (typeof defaultValue === \"number\" && typeof settingValue !== \"number\") {\r\n\t\t\t\tif (typeof settingValue === \"string\") {\r\n\t\t\t\t\tconst returnValue = settingValue.indexOf(\".\") === -1 ? parseInt(settingValue, 10) : parseFloat(settingValue);\r\n\t\t\t\t\treturn isNaN(returnValue) ? defaultValue : returnValue as unknown as T;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn defaultValue;\r\n\t\t\t}\r\n\r\n\t\t\treturn settingValue;\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tLogging.getLogger().error(\r\n\t\t\tEventIds.CommonError,\r\n\t\t\t{\r\n\t\t\t\tErrorMessage: `Error reading dynamic setting ${error && error.message}`,\r\n\t\t\t\tType: key,\r\n\t\t\t});\r\n\t}\r\n\r\n\treturn defaultValue;\r\n}\r\n\r\nexport function resetDynamicSettingsTmsgCache() {\r\n\tdynamicSettingsTmsgCache = {};\r\n}\r\n", "/**\r\n * Contracts enforced by OfficeEventSchema (OES)\r\n */\r\n\r\nexport class App {\r\n\tprivate static PLATFORM = \"Web\";\r\n\r\n\tprivate name: string;\r\n\tprivate version: string;\r\n\r\n\tpublic constructor(name: string, version: string) {\r\n\t\tif (!name) {\r\n\t\t\tthrow new Error(\"name must not be null\");\r\n\t\t}\r\n\t\tif (!version) {\r\n\t\t\tthrow new Error(\"version must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.name = name;\r\n\t\tthis.version = version;\r\n\t}\r\n\r\n\tpublic getName(): string {\r\n\t\treturn this.name;\r\n\t}\r\n\r\n\tpublic getPlatform(): string {\r\n\t\treturn App.PLATFORM;\r\n\t}\r\n\r\n\tpublic getVersion(): string {\r\n\t\treturn this.version;\r\n\t}\r\n}\r\n\r\nexport class Session {\r\n\tprivate id: string;\r\n\r\n\tpublic constructor(id: string) {\r\n\t\tif (!id) {\r\n\t\t\tthrow new Error(\"id must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.id = id;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.id;\r\n\t}\r\n}\r\n\r\nexport class Host {\r\n\tprivate id: string;\r\n\tprivate locale: string;\r\n\tprivate sessionId: string;\r\n\tprivate version: string;\r\n\r\n\tconstructor(id: string, locale: string, sessionId: string, version: string) {\r\n\t\tthis.id = id;\r\n\t\tthis.locale = locale;\r\n\t\tthis.sessionId = sessionId;\r\n\t\tthis.version = version;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.id;\r\n\t}\r\n\r\n\tpublic getLocale(): string {\r\n\t\treturn this.locale;\r\n\t}\r\n\r\n\tpublic getSessionId(): string {\r\n\t\treturn this.sessionId;\r\n\t}\r\n\r\n\tpublic getVersion(): string {\r\n\t\treturn this.version;\r\n\t}\r\n}\r\n\r\nexport class Event {\r\n\t// Id is set to sessionId<DELIMITER>sequence\r\n\tprivate static ID_DELIMITER = \".\";\r\n\tprivate static SOURCE = \"MsoThin\";\r\n\tprivate static SCHEMA_VERSION = 1;\r\n\r\n\tprivate name: string;\r\n\tprivate id: string;\r\n\tprivate sequence: number;\r\n\tprivate sampleRate: number;\r\n\r\n\tpublic constructor(name: string, sessionId: string, sequence: number, sampleRate: number) {\r\n\t\tif (!name) {\r\n\t\t\tthrow new Error(\"name must not be null\");\r\n\t\t}\r\n\t\tif (!sessionId) {\r\n\t\t\tthrow new Error(\"sessionId must not be null\");\r\n\t\t}\r\n\t\tif ((!sequence && sequence !== 0) || sequence < 0) {\r\n\t\t\tthrow new Error(\"sequence must not be negative\");\r\n\t\t}\r\n\r\n\t\tthis.name = name;\r\n\t\tthis.id = sessionId + Event.ID_DELIMITER + sequence;\r\n\t\tthis.sequence = sequence;\r\n\t\tthis.sampleRate = sampleRate;\r\n\t}\r\n\r\n\tpublic getName(): string {\r\n\t\treturn this.name;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.id;\r\n\t}\r\n\r\n\tpublic getSource(): string {\r\n\t\treturn Event.SOURCE;\r\n\t}\r\n\r\n\tpublic getSchemaVersion(): number {\r\n\t\treturn Event.SCHEMA_VERSION;\r\n\t}\r\n\r\n\tpublic getSequence(): number {\r\n\t\treturn this.sequence;\r\n\t}\r\n\r\n\tpublic getSampleRate(): number {\r\n\t\treturn this.sampleRate;\r\n\t}\r\n}\r\n\r\nexport class Release {\r\n\tprivate audienceGroup: string;\r\n\r\n\tpublic constructor(audienceGroup: string) {\r\n\t\tthis.audienceGroup = audienceGroup;\r\n\t}\r\n\r\n\tpublic getAudienceGroup(): string {\r\n\t\treturn this.audienceGroup;\r\n\t}\r\n}\r\n\r\nexport class Browser {\r\n\tprivate name: string;\r\n\tprivate version: string;\r\n\r\n\tpublic constructor(name: string, version: string) {\r\n\t\tthis.name = name;\r\n\t\tthis.version = version;\r\n\t}\r\n\r\n\tpublic getName(): string {\r\n\t\treturn this.name;\r\n\t}\r\n\r\n\tpublic getVersion(): string {\r\n\t\treturn this.version;\r\n\t}\r\n}\r\n\r\nexport class Device {\r\n\tprivate id: string;\r\n\r\n\tpublic constructor(id: string) {\r\n\t\tthis.id = id;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.id;\r\n\t}\r\n}\r\n\r\nexport class User {\r\n\tprivate primaryIdentityHash: string;\r\n\tprivate primaryIdentitySpace: string;\r\n\tprivate tenantId: string;\r\n\r\n\tpublic constructor(primaryIdentityHash: string, tenantId: string) {\r\n\t\tthis.tenantId = tenantId;\r\n\t\tthis.primaryIdentityHash = primaryIdentityHash ? primaryIdentityHash.trim() : primaryIdentityHash;\r\n\t\tthis.primaryIdentitySpace = this.generatePrimaryIdentitySpace();\r\n\t}\r\n\r\n\tpublic getTenantId(): string {\r\n\t\treturn this.tenantId;\r\n\t}\r\n\r\n\tpublic getPrimaryIdentityHash(): string {\r\n\t\treturn this.primaryIdentityHash;\r\n\t}\r\n\r\n\tpublic getPrimaryIdentitySpace(): string {\r\n\t\treturn this.primaryIdentitySpace;\r\n\t}\r\n\r\n\tprivate generatePrimaryIdentitySpace(): string {\r\n\t\tif (this.primaryIdentityHash) {\r\n\t\t\tif (this.primaryIdentityHash.startsWith(\"a:\")) {\r\n\t\t\t\treturn \"UserObjectId\";\r\n\t\t\t}\r\n\t\t\tif (this.primaryIdentityHash.startsWith(\"p:\")) {\r\n\t\t\t\treturn \"MsaPuid\";\r\n\t\t\t}\r\n\t\t\tif (this.primaryIdentityHash.startsWith(\"ap:\")) {\r\n\t\t\t\treturn \"OrgIdPuid\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n}\r\n", "import {\r\n\tDataField,\r\n\tDiagnosticLevel,\r\n\tmakeBooleanDataField,\r\n\tmakeDoubleDataField,\r\n\tmakeStringDataField,\r\n\tSuppressNexus,\r\n\tTelemetryEvent,\r\n\tTelemetryLogger,\r\n\tTelemetrySink,\r\n} from \"@microsoft/oteljs\";\r\nimport { isNOU, scrubContent } from \"./../../Utils\";\r\nimport { App, Browser, Device, Host, Release, Session } from \"./Contracts\";\r\nimport ITelemetryLogger from \"./ITelemetryLogger\";\r\n\r\nexport default class OtelTelemetryLogger implements ITelemetryLogger {\r\n\r\n\tprivate static EVENT_NAME_DELIMITER = \".\";\r\n\tprivate oteljsTelemetryLogger: TelemetryLogger;\r\n\r\n\t// Office Event Schema data contract variables. \r\n\t// Event, User are not used because they're initialized on the TelemetrySink.\r\n\tprivate oesApp: App;\r\n\tprivate oesSession: Session; // This contract is used for the SDK session in this implementation\r\n\tprivate oesHost: Host;\r\n\tprivate oesRelease: Release;\r\n\tprivate oesBrowser: Browser;\r\n\tprivate oesDevice: Device;\r\n\r\n\tprivate namespace: string;\r\n\tprivate sequence: number;\r\n\r\n\tconstructor(ariaTenantId: string, namespace: string, telemetrySink: TelemetrySink, app: App, session: Session,\r\n\t\thost?: Host, release?: Release, browser?: Browser, device?: Device, nexusTenantToken: number = SuppressNexus) {\r\n\t\tif (!ariaTenantId) {\r\n\t\t\tthrow new Error(\"tenantToken must not be null\");\r\n\t\t}\r\n\t\tif (!app) {\r\n\t\t\tthrow new Error(\"app must not be null\");\r\n\t\t}\r\n\t\tif (!telemetrySink) {\r\n\t\t\tthrow new Error(\"telemetrySink must not be null\");\r\n\t\t}\r\n\t\tif (!namespace) {\r\n\t\t\tthrow new Error(\"namespace must not be null\");\r\n\t\t}\r\n\t\tif (!session) {\r\n\t\t\tthrow new Error(\"session must not be null\");\r\n\t\t}\r\n\r\n\t\tthis.namespace = namespace;\r\n\t\tthis.oesApp = app; // static persistent\r\n\t\tthis.oesSession = session; // dynamic persistent\r\n\t\tthis.oesHost = host; // static persistent\r\n\t\tthis.oesRelease = release; // static persistent\r\n\t\tthis.oesBrowser = browser; // static persistent\r\n\t\tthis.oesDevice = device; // static persistent\r\n\t\tthis.sequence = 1; // Sequence starts at 1 not 0\r\n\r\n\t\tthis.oteljsTelemetryLogger = new TelemetryLogger(undefined, this.getStaticPersistentDataFields(this.oesApp, this.oesHost,\r\n\t\t\tthis.oesRelease, this.oesBrowser, this.oesDevice));\r\n\t\tthis.oteljsTelemetryLogger.setTenantToken(namespace, ariaTenantId, nexusTenantToken);\r\n\r\n\t\t// Attach the provided sink. This is what will transport the telemetry.\r\n\t\tthis.oteljsTelemetryLogger.addSink(telemetrySink);\r\n\t}\r\n\r\n\tpublic logEvent(eventName: string, customProperties?: { [customField: string]: any }, sampleRate = 1): void {\r\n\t\tif (!eventName) {\r\n\t\t\tthrow new Error(\"eventName must not be null\");\r\n\t\t}\r\n\r\n\t\t// Translate FG Events into TelemetryEvents\r\n\t\tconst otelTelemetryEvent = this.createOTelTelemetryEvent(eventName, customProperties, sampleRate);\r\n\r\n\t\t// Log the events with the oteljs logger.\r\n\t\tthis.oteljsTelemetryLogger.sendTelemetryEvent(otelTelemetryEvent);\r\n\r\n\t\tthis.sequence++;\r\n\t}\r\n\r\n\tpublic flushQueue(): void {\r\n\t\tthis.oteljsTelemetryLogger.flushQueue();\r\n\t}\r\n\r\n\t// This method adds persistent properties that are dynamic and change for every event (such as sequence)\r\n\tprivate addDynamicPersistentProperties(telemetryEvent: TelemetryEvent, sampleRate: number): void {\r\n\t\t// Floodgate session Id\r\n\t\tif (!isNOU(this.oesSession)) {\r\n\t\t\ttelemetryEvent.dataFields.push(makeStringDataField(\"Session.Id\", this.oesSession.getId()));\r\n\t\t}\r\n\r\n\t\t// Event sequence number\r\n\t\tif (!isNOU(this.sequence)) {\r\n\t\t\ttelemetryEvent.dataFields.push(makeDoubleDataField(\"Event.Sequence\", this.sequence));\r\n\t\t}\r\n\r\n\t\t// Event sample rate\r\n\t\tif (!isNOU(sampleRate)) {\r\n\t\t\ttelemetryEvent.dataFields.push(makeDoubleDataField(\"Event.SampleRate\", sampleRate));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate createOTelTelemetryEvent(eventName: string, customProperties: { [customField: string]: any }, sampleRate: number): TelemetryEvent {\r\n\t\tconst telemetryEvent: TelemetryEvent = {\r\n\t\t\teventName: this.namespace + OtelTelemetryLogger.EVENT_NAME_DELIMITER + eventName,\r\n\t\t\teventFlags: {\r\n\t\t\t\tdiagnosticLevel: DiagnosticLevel.RequiredServiceData,\r\n\t\t\t},\r\n\t\t\tdataFields: [],\r\n\t\t};\r\n\r\n\t\tfor (const key in customProperties) {\r\n\t\t\tif (Object.prototype.hasOwnProperty.call(customProperties, key)) {\r\n\t\t\t\tconst customProperty = customProperties[key];\r\n\r\n\t\t\t\tlet dataField: DataField = undefined;\r\n\r\n\t\t\t\t// Map property types to otel function to make the datafield.\r\n\t\t\t\tswitch (typeof (customProperty)) {\r\n\t\t\t\t\tcase \"string\":\r\n\t\t\t\t\t\tdataField = makeStringDataField(key, scrubContent(customProperty));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"number\":\r\n\t\t\t\t\t\tdataField = makeDoubleDataField(key, customProperty);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"boolean\":\r\n\t\t\t\t\t\tdataField = makeBooleanDataField(key, customProperty);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t// do nothing with other types, break out of loop.\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!isNOU(dataField)) {\r\n\t\t\t\t\ttelemetryEvent.dataFields.push(dataField);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Add properties that should always be added to events.\r\n\t\tthis.addDynamicPersistentProperties(telemetryEvent, sampleRate);\r\n\r\n\t\treturn telemetryEvent;\r\n\t}\r\n\r\n\t// function to create persistent data fields which does not change within session\r\n\tprivate getStaticPersistentDataFields(oesApp: App, oesHost: Host, oesRelease: Release,\r\n\t\toesBrowser: Browser, oesDevice: Device): DataField[] {\r\n\t\tconst dataFields: DataField[] = [];\r\n\r\n\t\tif (!isNOU(oesApp)) {\r\n\t\t\tdataFields.push(makeStringDataField(\"App.Name\", oesApp.getName()));\r\n\t\t\tdataFields.push(makeStringDataField(\"App.Platform\", oesApp.getPlatform()));\r\n\t\t\tdataFields.push(makeStringDataField(\"App.Version\", oesApp.getVersion()));\r\n\t\t}\r\n\r\n\t\tif (!isNOU(oesRelease)) {\r\n\t\t\tdataFields.push(makeStringDataField(\"Release.AudienceGroup\", oesRelease.getAudienceGroup()));\r\n\t\t}\r\n\r\n\t\tif (!isNOU(oesDevice)) {\r\n\t\t\tdataFields.push(makeStringDataField(\"Device.Id\", oesDevice.getId()));\r\n\t\t}\r\n\r\n\t\tif (!isNOU(oesHost)) {\r\n\t\t\tdataFields.push(makeStringDataField(\"Host.Id\", oesHost.getId()));\r\n\t\t\tdataFields.push(makeStringDataField(\"Host.Locale\", oesHost.getLocale()));\r\n\t\t\tdataFields.push(makeStringDataField(\"Host.SessionId2\", oesHost.getSessionId()));\r\n\t\t\tdataFields.push(makeStringDataField(\"Host.Version\", oesHost.getVersion()));\r\n\t\t}\r\n\r\n\t\tif (!isNOU(oesBrowser)) {\r\n\t\t\tdataFields.push(makeStringDataField(\"Browser.Name\", oesBrowser.getName()));\r\n\t\t\tdataFields.push(makeStringDataField(\"Browser.Version\", oesBrowser.getVersion()));\r\n\t\t}\r\n\r\n\t\treturn dataFields;\r\n\t}\r\n}\r\n", "/**\r\n * Factory to return ITelemetryLogger objects\r\n */\r\n\r\nimport { TelemetrySink } from \"@microsoft/oteljs\";\r\nimport { App, Browser, Device, Host, Release, Session } from \"./Contracts\";\r\nimport ITelemetryLogger from \"./ITelemetryLogger\";\r\nimport OtelTelemetryLogger from \"./OtelTelemetryLogger\";\r\n\r\nexport default class TelemetryLoggerFactory {\r\n\tpublic static create(tenantToken: string, namespace: string, telemetrySink: TelemetrySink, app: App, session: Session,\r\n\t\thost: Host, release: Release, browser: Browser, device: Device): ITelemetryLogger {\r\n\t\t\treturn new OtelTelemetryLogger(tenantToken, namespace, telemetrySink, app, session, host, release, browser, device);\r\n\t\t}\r\n}\r\n", "/**\r\n * Constants.ts\r\n *\r\n * Module to hold logging-related constants\r\n */\r\n\r\nexport interface ICustomProperties {\r\n\tCampaignId?: string;\r\n\tChannelType?: number;\r\n\tCorrelationId?: string;\r\n\tCount?: number;\r\n\tData?: string;\r\n\tErrorMessage?: string;\r\n\tFeedbackType?: number;\r\n\tPanelType?: number;\r\n\tFileName?: string;\r\n\tFlights?: string;\r\n\tHttpStatusCode?: number;\r\n\tHttpStatusText?: string;\r\n\tIsBugEnabled?: boolean;\r\n\tIsDiagnosticsIncluded?: boolean;\r\n\tIsEmailIncluded?: boolean;\r\n\tIsEmailPolicyEnabled?: boolean;\r\n\tIsIdeaEnabled?: boolean;\r\n\tIsScreenshotIncluded?: boolean;\r\n\tMessage?: string;\r\n\tSessionId?: string;\r\n\tSurveyId?: string;\r\n\tSurveyType?: number;\r\n\tTimeMilliseconds?: number;\r\n\tTreatmentType?: number;\r\n\tIsFloodgate2?: boolean;\r\n\tIsDynamicUXEnabled?: boolean;\r\n\tIsDynamicCampaignEnabled?: boolean;\r\n\tType?: string;\r\n\tClientFeedbackId?: string;\r\n\tPromptAutoDismiss?: string;\r\n\tAdditionalSurveyInfo?: string;\r\n\tSurveyActivityInfo?: string;\r\n\tPersonalizerUserAction?: number;\r\n\tPersonalizerEventId?: string;\r\n\tGovernanceRequestBody?: string;\r\n\tGovernanceResponseText?: string;\r\n\tActualSetAutoDismissValue?: number;\r\n\tCVFormId?: string;\r\n\tCentroData?: string;\r\n}\r\n\r\nexport interface IEventId {\r\n\tname: string;\r\n}\r\n\r\nexport class EventIds {\r\n\tpublic static InApp = class {\r\n\t\tpublic static UI = class {\r\n\t\t\tpublic static Picker = class {\r\n\t\t\t\tpublic static Shown = class {\r\n\t\t\t\t\tpublic static VALUE: IEventId = { name: \"InApp_UI_Picker_Shown\" };\r\n\t\t\t\t};\r\n\t\t\t};\r\n\r\n\t\t\tpublic static Form = class {\r\n\t\t\t\tpublic static Shown = class {\r\n\t\t\t\t\tpublic static VALUE: IEventId = { name: \"InApp_UI_Form_Shown\" };\r\n\t\t\t\t};\r\n\r\n\t\t\t\tpublic static Submit = class {\r\n\t\t\t\t\tpublic static VALUE: IEventId = { name: \"InApp_UI_Form_Submit\" };\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\r\n\t// This saves ~400 bytes (minified) vs nested classes\r\n\tpublic static SURVEY_FLOODGATE_CAMPAIGNLOAD_FAILED: IEventId = { name: \"Survey_Floodgate_CampaignLoad_Failed\" };\r\n\tpublic static SURVEY_FLOODGATE_FILEREAD_FAILED: IEventId = { name: \"Survey_Floodgate_FileRead_Failed\" };\r\n\tpublic static SURVEY_FLOODGATE_FILEWRITE_FAILED: IEventId = { name: \"Survey_Floodgate_FileWrite_Failed\" };\r\n\tpublic static SURVEY_FLOODGATE_TRIGGERMET: IEventId = { name: \"Survey_Floodgate_TriggerMet\" };\r\n\tpublic static SURVEY_FLOODGATE_USERSELECTED: IEventId = { name: \"Survey_Floodgate_UserSelected\" };\r\n\tpublic static SURVEY_FLOODGATE_SHOWCUSTOMSURVEY_FAILED: IEventId = { name: \"Survey_Floodgate_ShowCustomSurvey_Failed\" };\r\n\tpublic static SURVEY_UI_RENDER_CV_SURVEY_COMPLETED: IEventId = { name: \"Survey_UI_Render_CVSurvey_Completed\" };\r\n\tpublic static SURVEY_UI_FORM_SHOWN: IEventId = { name: \"Survey_UI_Form_Shown\" };\r\n\tpublic static SURVEY_UI_FORM_DISPATCHER_IMPLEMENTED: IEventId = { name: \"Survey_UI_Form_Dispatcher_Implemented\" };\r\n\tpublic static SURVEY_UI_FORM_SUBMIT: IEventId = { name: \"Survey_UI_Form_Submit\" };\r\n\tpublic static SURVEY_UI_FORM_SECONDARY_SUBMIT: IEventId = { name: \"Survey_UI_Form_Secondary_Submit\" };\r\n\tpublic static SURVEY_UI_FORM_SUBMIT_ERROR: IEventId = { name: \"Survey_UI_Form_Submit_Error\" };\r\n\tpublic static SURVEY_UI_FORM_USERCLOSED: IEventId = { name: \"Survey_UI_Form_UserClosed\" };\r\n\tpublic static SURVEY_UI_THANKYOUPAGE_USERCLOSED: IEventId = { name: \"Survey_UI_ThankYouPage_UserClosed\" };\r\n\tpublic static SURVEY_UI_FORM_NO_RETURN_TYPE: IEventId = { name: \"Survey_UI_Form_No_Return_Type\" };\r\n\r\n\tpublic static SURVEY_UI_PROMPT_AUTODISMISSED: IEventId = { name: \"Survey_UI_Prompt_AutoDismissed\" };\r\n\tpublic static SURVEY_UI_THANKYOUPAGE_AUTODISMISSED: IEventId = { name: \"Survey_UI_ThankYouPage_AutoDismissed\" };\r\n\tpublic static SURVEY_UI_PROMPT_SHOWN: IEventId = { name: \"Survey_UI_Prompt_Shown\" };\r\n\tpublic static SURVEY_UI_PROMPT_USERCLOSED: IEventId = { name: \"Survey_UI_Prompt_UserClosed\" };\r\n\tpublic static SURVEY_UI_ADDITIONALPROMPT_USERCLOSED: IEventId = { name: \"Survey_UI_AdditionalPrompt_UserClosed\" };\r\n\tpublic static SURVEY_UI_PROMPT_CLICKED: IEventId = { name: \"Survey_UI_Prompt_Clicked\" };\r\n\tpublic static SURVEY_UI_ADDITIONALPROMPT_CLICKED: IEventId = { name: \"Survey_UI_AdditionalPrompt_Clicked\" };\r\n\tpublic static SURVEY_UI_REDIRECTIONFAILURE: IEventId = { name: \"Survey_UI_RedirectionFailure\" };\r\n\tpublic static GOVERNANCE_SERVICEFAILURE: IEventId = { name: \"Gorvenance_ServiceFailure\" };\r\n\tpublic static GOVERNANCE_SERVICERESULT: IEventId = { name: \"Gorvenance_ServiceResult\" };\r\n\tpublic static DYNAMICTRANSPORT_POST_ERROR: IEventId = { name: \"DynamicTransport_Post_Error\" };\r\n\tpublic static FEEDBACK_SURVEYSDISABLED_AADC: IEventId = { name: \"Feedback_SurveysDisabled_AADC\" };\r\n\tpublic static SURVEY_UI_DISABLED_AADC: IEventId = { name: \"Survey_UI_Prevented_AADC\" };\r\n\tpublic static PERSONALIZER_SERVICEREWARDRESULT: IEventId = { name: \"Personalizer_ServiceRewardResult\" };\r\n\tpublic static PERSONALIZER_CLIENTFAILURE: IEventId = { name: \"Personalizer_ClientFailure\" };\r\n\tpublic static APPDATA_JSON_PARSE_ERROR: IEventId = { name: \"AppData_JSON_Parse_Error\" };\r\n\tpublic static SURVEY_RENDER_OVERRIDE_ERROR: IEventId = { name: \"Survey_Render_Override_Error\" };\r\n\tpublic static SURVEY_RENDER_OVERRIDE_SUCCESS: IEventId = { name: \"Survey_Render_Override_Success\" };\r\n\tpublic static SURVEY_EVENT_KEY_ERROR: IEventId = { name: \"Survey_Event_Key_Error\" };\r\n\tpublic static SURVEY_RENDER_CONTEXT_ERROR: IEventId = { name: \"Survey_Render_Context_Error\" };\r\n\tpublic static DYNAMICUX_INITIALIZATION_FAILURE: IEventId = { name: \"DynamicUx_Intialization_Failure\" };\r\n\tpublic static DYNAMICUX_LOAD_SUCCESS: IEventId = { name: \"DynamicUx_Load_Success\" };\r\n\tpublic static DYNAMICUX_LOAD_FAILURE: IEventId = { name: \"DynamicUx_Load_Failure\" };\r\n\tpublic static DYNAMICUX_LOAD_PRELOAD: IEventId = { name: \"DynamicUx_Load_Preload\" };\r\n\tpublic static DYNAMICUX_BOOSTSTRAPPER_FAILURE: IEventId = { name: \"DynamicUx_BoostStrapper_Failure\" };\r\n\tpublic static SURVEY_TRIGGER_DYNAMICUX_ONLOAD: IEventId = { name: \"Survey_Trigger_DynamicUx_OnLoad\" };\r\n\tpublic static SURVEY_TRIGGER_DYNAMICUX_FAILURE: IEventId = { name: \"Survey_Trigger_DynamicUx_Failure\" };\r\n\tpublic static SURVEY_LAUNCHER_FAILURE: IEventId = { name: \"Survey_Launcher_Failure\" };\r\n\tpublic static SURVEY_LAUNCHER_SHOWSURVEY_FAILURE: IEventId = { name: \"Survey_Launcher_ShowSurvey_Failure\" };\r\n\tpublic static SURVEY_UI_CREATE: IEventId = { name: \"Survey_UI_Create\" };\r\n\tpublic static TRUSTEDTYPES_URL_BLOCKED: IEventId = { name: \"TrustedTypes_Url_Blocked\" };\r\n\r\n\t// Test feature gate callback telemetry\r\n\tpublic static TESTFEATURESTATUSCALLBACK: IEventId = { name: \"Test_FeatureStatus_Callback\" };\r\n\r\n\tpublic static Shared = class {\r\n\t\tpublic static Upload = class {\r\n\t\t\tpublic static Failed = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"Shared_Upload_Failed\" };\r\n\t\t\t};\r\n\t\t\tpublic static Prevented = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"Shared_Upload_Prevented_AADC\" };\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tpublic static Screenshot = class {\r\n\t\t\tpublic static Render = class {\r\n\t\t\t\tpublic static Failed = class {\r\n\t\t\t\t\tpublic static VALUE: IEventId = { name: \"Shared_Screenshot_Render_Failed\" };\r\n\t\t\t\t};\r\n\t\t\t\tpublic static Success = class {\r\n\t\t\t\t\tpublic static VALUE: IEventId = { name: \"Shared_Screenshot_Render_Success\" };\r\n\t\t\t\t};\r\n\t\t\t};\r\n\r\n\t\t\tpublic static GetContent = class {\r\n\t\t\t\tpublic static Failed = class {\r\n\t\t\t\t\tpublic static DefaultImage = class {\r\n\t\t\t\t\t\tpublic static Returned = class {\r\n\t\t\t\t\t\t\tpublic static VALUE: IEventId = { name: \"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned\" };\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static WebSurfaces = class {\r\n\t\tpublic static Common = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"WebSurfaces_Common_Error\" };\r\n\t\t\t};\r\n\t\t\tpublic static Info = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"WebSurfaces_Common_Info\" };\r\n\t\t\t};\r\n\t\t};\r\n\t\tpublic static CampaignMetadataAggregator = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"WebSurfaces_CampaignMetadataAggregator_Error\" };\r\n\t\t\t};\r\n\t\t\tpublic static Requests = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"WebSurfaces_CampaignMetadataAggregator_Requests\" };\r\n\t\t\t};\r\n\t\t};\r\n\t\tpublic static SetCampaignAction = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"WebSurfaces_SetCampaignAction_Error\" };\r\n\t\t\t};\r\n\t\t\tpublic static Requests = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"WebSurfaces_SetCampaignAction_Requests\" };\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static UserFacts = class {\r\n\t\tpublic static Common = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_Common_Error\" };\r\n\t\t\t};\r\n\t\t\tpublic static Info = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_Common_Info\" };\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tpublic static LocalFact = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_LocalFact_Error\" };\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tpublic static Messaging = class {\r\n\t\t\tpublic static Requests = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_Messaging_Requests\" };\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tpublic static AugLoop = class {\r\n\t\t\tpublic static Requests = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_AugLoop_Requests\" };\r\n\t\t\t};\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_AugLoop_Error\" };\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tpublic static Provider = class {\r\n\t\t\tpublic static Info = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"UserFacts_Provider_Summary\" };\r\n\t\t\t};\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static FetchCampaignDefinition = class {\r\n\t\tpublic static Service = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"FetchCampaignDefinition_Service_Error\" };\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tpublic static Common = class {\r\n\t\tpublic static Error = class {\r\n\t\t\tpublic static VALUE: IEventId = { name: \"Common_Error\" };\r\n\t\t};\r\n\t\tpublic static Info = class {\r\n\t\t\tpublic static VALUE: IEventId = { name: \"Common_Info\" };\r\n\t\t};\r\n\t};\r\n\r\n\tpublic static Centro = class {\r\n\t\tpublic static Logging = class {\r\n\t\t\tpublic static Error = class {\r\n\t\t\t\tpublic static VALUE: IEventId = { name: \"Centro_Logging_Error\" };\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n}\r\n", "import FloodgateStorageProvider from \".././FloodgateCore/FloodgateStorageProvider\";\r\nimport { FloodgateStorageProviderFileType } from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nexport let featureGateOverrides: Record<string, any> = null;\r\n\r\n// Feature gate overrides are stored in cache as a JSON string unser the key \"obf-FeatureGateOverrides\"\r\n// These values override feature gate values from host\r\nexport function readFeatureGateOverridesFromCache(featureGateName: string): string {\r\n    if (!featureGateOverrides) {\r\n        const overrides = FloodgateStorageProvider.safeReadObject(FloodgateStorageProviderFileType.FeatureGateOverrides);\r\n        featureGateOverrides = overrides || {};\r\n    }\r\n    return featureGateName && featureGateOverrides?.[featureGateName];\r\n}\r\n\r\nexport function clearFeatureGateOverridesCache(): void {\r\n    featureGateOverrides = null;\r\n}", "import { ICustomLogData, IPersonalizationLogger } from  \"@ms-ofb/officepersonalization/dist/lib/Logging/Logger\";\r\nimport * as Logging from \"../Logging/Logging\";\r\n\r\nexport class PersonalizationLogger implements IPersonalizationLogger {\r\n\tpublic error(message: string, ...data: unknown[]): void {\r\n\t\tLogging.getLogger().logEvent({name: message} as Logging.IEventId, Logging.LogLevel.Error, data as Logging.ICustomProperties);\r\n\t}\r\n\tpublic info(message: string, ...data: unknown[]): void {\r\n\t\tLogging.getLogger().logEvent({name: message} as Logging.IEventId, Logging.LogLevel.Info, data as Logging.ICustomProperties);\r\n\t}\r\n\tpublic warn(message: string, ...data: unknown[]): void {\r\n\t\tLogging.getLogger().logEvent({name: message} as Logging.IEventId, Logging.LogLevel.Info, data as Logging.ICustomProperties);\r\n\t}\r\n\tpublic trace(message: string, ...data: unknown[]): void {\r\n\t\tLogging.getLogger().logEvent({name: message} as Logging.IEventId, Logging.LogLevel.Info, data as Logging.ICustomProperties);\r\n\t}\r\n\tpublic event(eventName: string, customLogData?: ICustomLogData, samplingRatio = 1): void {\r\n\t\tLogging.getLogger().logEvent({name: eventName} as Logging.IEventId, Logging.LogLevel.Critical,\r\n\t\t\tcustomLogData as Logging.ICustomProperties, samplingRatio);\r\n\t}\r\n\tpublic userFactEvent(userFact: string, userFactValue: string): void {\r\n\t\tLogging.getUserFactLogger().logUserFact(userFact, userFactValue);\r\n\t}\r\n}\r\n", "export const CentroUrlProd = 'https://admin.microsoft.com';\r\n\r\nexport const CentroUrlInt = 'https://admin-ignite.microsoft.com';\r\n\r\nexport const CentroFloodgateContainerId = 'obf-FloodgateDynamicUxContainer';\r\n\r\nexport const CentroFloodgateInitOptions = 'centro.hvc.floodgate.initOptions';\r\n\r\nexport const CentroThemeInitOptions = 'centro.hvc.floodgate.theme';\r\n\r\nexport const CentroCommonInitOptions = 'centro.hvc.feature';\r\n\r\nexport const CentroFloodgateFeatureName = 'floodgate';\r\n\r\nexport const CentroFloodgateHostName = 'host-floodgate-websdk';\r\n\r\nexport const CentroFloodgatePerfPrefix = 'FloodgateWebSDK';\r\n\r\nexport const CentroFloodgateLoggerFunc = 'floodgateCentroLogger';\r\n\r\nexport const CentroPreloadLoggingSamplingRate = 0.01; // sampling rate 1%\r\n\r\nexport const CentroPetrolUploadEndpoint = 'petrol';\r\n\r\nexport const FloodgateCentroVersion = 'v1';", "/**\r\n * Constants.ts\r\n *\r\n * A module for all UI constants.\r\n */\r\n\r\n/**\r\n * HTML attribute names\r\n */\r\nexport class AttributeName {\r\n\tpublic static Alt = \"alt\";\r\n\tpublic static AriaLabel = \"aria-label\";\r\n\tpublic static AriaSelected = \"aria-selected\";\r\n\tpublic static AriaOrientation = \"aria-orientation\";\r\n\tpublic static AriaExpanded = \"aria-expanded\";\r\n\tpublic static AriaControls = \"aria-controls\";\r\n\tpublic static AriaHasPopups = \"aria-haspopup\";\r\n\tpublic static AriaModal = \"aria-modal\";\r\n\tpublic static AriaLabelledBy = \"aria-labelledby\";\r\n\tpublic static AriaDescribedBy = \"aria-describedby\";\r\n\tpublic static AriaLevel = \"aria-level\";\r\n\tpublic static Class = \"class\";\r\n\tpublic static DataHtml2CanvasIgnore = \"data-html2canvas-ignore\";\r\n\tpublic static Disabled = \"disabled\";\r\n\tpublic static Fill = \"fill\";\r\n\tpublic static For = \"for\";\r\n\tpublic static Preview = \"preview\";\r\n\tpublic static Form = \"form\";\r\n\tpublic static Height = \"height\";\r\n\tpublic static HRef = \"href\";\r\n\tpublic static Id = \"id\";\r\n\tpublic static MaxLength = \"maxlength\";\r\n\tpublic static Name = \"name\";\r\n\tpublic static Placeholder = \"placeholder\";\r\n\tpublic static Points = \"points\";\r\n\tpublic static Rel = \"rel\";\r\n\tpublic static Role = \"role\";\r\n\tpublic static Source = \"src\";\r\n\tpublic static Stroke = \"stroke\";\r\n\tpublic static Style = \"style\";\r\n\tpublic static TabIndex = \"tabindex\";\r\n\tpublic static Target = \"target\";\r\n\tpublic static Transform = \"transform\";\r\n\tpublic static Type = \"type\";\r\n\tpublic static Value = \"value\";\r\n\tpublic static ViewBox = \"viewBox\";\r\n\tpublic static Width = \"width\";\r\n\tpublic static xlinkHref = \"xlink:href\";\r\n\tpublic static X = \"x\";\r\n\tpublic static Y = \"y\";\r\n}\r\n\r\n/**\r\n * HTML attribute values\r\n */\r\nexport class AttributeValue {\r\n\tpublic static BlankWindow = \"_blank\";\r\n\tpublic static Button = \"button\";\r\n\tpublic static Dialog = \"dialog\";\r\n\tpublic static Tab = \"tab\";\r\n\tpublic static TabList = \"tablist\";\r\n\tpublic static TabPanel = \"tabpanel\";\r\n\tpublic static Checkbox = \"checkbox\";\r\n\tpublic static Checked = \"checked\";\r\n\tpublic static False = \"false\";\r\n\tpublic static Zero = \"0\";\r\n\tpublic static Polite = \"polite\";\r\n\tpublic static Radio = \"radio\";\r\n\tpublic static Submit = \"submit\";\r\n\tpublic static ScreenshotPreview = \"ScreenshotPreview\";\r\n\tpublic static Text = \"text\";\r\n\tpublic static TextAreaMaxLength = \"1000\";\r\n\tpublic static True = \"true\";\r\n\tpublic static Unchecked = \"unchecked\";\r\n\tpublic static NoReferrer = \"noreferrer\";\r\n\tpublic static AriaOrientationValueVertical = \"vertical\";\r\n}\r\n\r\n/**\r\n * URL Parameters\r\n */\r\nexport class UrlParameters {\r\n\tpublic static CLCID = \"CLCID\";\r\n}\r\n\r\n/**\r\n * CSS classes\r\n */\r\nexport class Classes {\r\n\tpublic static AriaLiveTemplate = \"obf-AriaLiveTemplate\";\r\n\tpublic static CheckBox = \"obf-CheckBox\";\r\n\tpublic static FontTitle = \"obf-FontTitle\";\r\n\tpublic static CloseButton = \"obf-CloseButton\";\r\n\tpublic static FontSubtitle = \"obf-FontSubtitle\";\r\n\tpublic static FontText = \"obf-FontText\";\r\n\tpublic static FontSubText = \"obf-FontSubText\";\r\n\tpublic static FontSubSubText = \"obf-FontSubSubText\";\r\n\tpublic static Hidden = \"obf-Hidden\";\r\n\tpublic static Link = \"obf-Link\";\r\n\tpublic static MarginLeft60px = \"obf-MarginLeft60px\";\r\n\tpublic static MarginLeft180px = \"obf-MarginLeft180px\";\r\n\tpublic static NarrowLayout = \"obf-NarrowLayout\";\r\n\tpublic static PrivacyStatementLinkDiv = \"obf-PrivacyStatementLinkDiv\";\r\n\tpublic static PrivacyStatementLinkDivEudbUx = \"obf-PrivacyStatementLinkDivEudbUx\";\r\n\tpublic static Rtl = \"obf-Rtl\";\r\n\tpublic static Spinner = \"obf-Spinner\";\r\n\tpublic static SpinnerCircle = \"obf-SpinnerCircle\";\r\n\tpublic static SubmitButton = \"obf-SubmitButton\";\r\n\tpublic static CancelButton = \"obf-CancelButton\";\r\n\tpublic static TextInput = \"obf-TextInput\";\r\n\tpublic static Visible = \"obf-Visible\";\r\n\tpublic static RequiredAsterisk = \"obf-RequiredAsterisk\";\r\n\r\n\t// rating control\r\n\tpublic static Rating = \"obf-Rating\";\r\n\tpublic static RatingGraphic = \"obf-RatingGraphic\";\r\n\tpublic static RatingGraphicFilled = \"obf-RatingGraphic-Filled\";\r\n\r\n\t// choice group control\r\n\tpublic static ChoiceGroup = \"obf-ChoiceGroup\";\r\n\tpublic static ChoiceGroupIcon = \"obf-ChoiceGroupIcon\";\r\n\r\n\t// region BellyBand\r\n\r\n\tpublic static OverallAnchor = \"obf-OverallAnchor\";\r\n\tpublic static OverallAnchorActive = \"obf-OverallAnchorActive\";\r\n\tpublic static OverallImage = \"obf-OverallImage\";\r\n\tpublic static OverallText = \"obf-OverallText\";\r\n\tpublic static SingleLayout = \"obf-SingleLayout\";\r\n\tpublic static ShowRightBorder = \"obf-ShowRightBorder\";\r\n\tpublic static SlideLeft = \"obf-slideLeft\";\r\n\tpublic static TextAlignLeft = \"obf-TextAlignLeft\";\r\n\tpublic static FormContainer = \"obf-FormContainer\";\r\n\tpublic static FormWideContainer = \"obf-FormWideContainer\";\r\n\r\n\t// region ThanksPanel\r\n\tpublic static ThanksPanelTitle = \"obf-ThanksPanelTitle\";\r\n\tpublic static ThanksPanelMessage = \"obf-ThanksPanelMessage\";\r\n\r\n\t// form classes\r\n\tpublic static FormQuestionMiddleText = \"obf-FormQuestionMiddleText\";\r\n\tpublic static FormMiddleText = \"obf-FormMiddleText\";\r\n\tpublic static FormCategoriesDropdown = \"obf-FormCategoriesDropdown\";\r\n\tpublic static FormComment = \"obf-FormComment\";\r\n\tpublic static FormRatingContainer = \"obf-FormRatingContainer\";\r\n\tpublic static FormRatingLabel = \"obf-FormRatingLabel\";\r\n\tpublic static FormRating = \"obf-FormRating\";\r\n\tpublic static FormEmailContainer = \"obf-FormEmailContainer\";\r\n\tpublic static FormEmailInput = \"obf-FormEmailInput\";\r\n\tpublic static FormEmailTextBox = \"obf-FormEmailTextBox\";\r\n\tpublic static FormEmailCheckBox = \"obf-FormEmailCheckBox\";\r\n\tpublic static FormEmailLabel = \"obf-FormEmailLabel\";\r\n\tpublic static FormBottomContainer = \"obf-FormBottomContainer\";\r\n\tpublic static FormSubmitButtonContainer = \"obf-FormSubmitButtonContainer\";\r\n\tpublic static FormScreenshotContainer = \"obf-FormScreenshotContainer\";\r\n\tpublic static FormScreenshotLabel = \"obf-FormScreenshotLabel\";\r\n\tpublic static FormScreenshotCheckbox = \"obf-FormScreenshotCheckbox\";\r\n\tpublic static FormScreenshotPreview = \"obf-FormScreenshotPreview\";\r\n\tpublic static FormPrivacyConsentText = \"obf-TFormPrivacyConsentText\";\r\n\t// email textbox classes\r\n\tpublic static TFormEmailCheckbox = \"obf-TFormEmailCheckbox\";\r\n\tpublic static TFormEmailLabel = \"obf-TFormEmailLabel \";\r\n\r\n\t// email checkbox classes\r\n\tpublic static EmailCheckBoxLabel = \"obf-EmailCheckBoxLabel\";\r\n\r\n\t// endregion\r\n\r\n\t// region Toast\r\n\r\n\tpublic static Toast = \"obf-Toast\";\r\n\tpublic static ToastZoom = \"obf-ToastZoom\";\r\n\r\n\t// endregion\r\n}\r\n\r\n/**\r\n * HTML element ids\r\n */\r\nexport class IDs {\r\n\t// region BellyBand\r\n\tpublic static CloseButton = \"obf-CloseButton\";\r\n\tpublic static ColumnSeparatorDiv = \"obf-ColumnSeparatorDiv\";\r\n\tpublic static OverallAnchorsContainer = \"obf-OverallAnchorsContainer\";\r\n\tpublic static OverallFrownAnchor = \"obf-OverallFrownAnchor\";\r\n\tpublic static OverallFrownDiv = \"obf-OverallFrownDiv\";\r\n\tpublic static OverallFrownImage = \"obf-OverallFrownImage\";\r\n\tpublic static OverallFrownText = \"obf-OverallFrownText\";\r\n\tpublic static OverallSmileAnchor = \"obf-OverallSmileAnchor\";\r\n\tpublic static OverallSmileDiv = \"obf-OverallSmileDiv\";\r\n\tpublic static OverallSmileImage = \"obf-OverallSmileImage\";\r\n\tpublic static OverallSmileText = \"obf-OverallSmileText\";\r\n\tpublic static OverallIdeaAnchor = \"obf-OverallIdeaAnchor\";\r\n\tpublic static OverallIdeaDiv = \"obf-OverallIdeaDiv\";\r\n\tpublic static OverallIdeaImage = \"obf-OverallIdeaImage\";\r\n\tpublic static OverallIdeaText = \"obf-OverallIdeaText\";\r\n\tpublic static OverallBugAnchor = \"obf-OverallBugAnchor\";\r\n\tpublic static OverallBugDiv = \"obf-OverallBugDiv\";\r\n\tpublic static OverallBugImage = \"obf-OverallBugImage\";\r\n\tpublic static OverallBugText = \"obf-OverallBugText\";\r\n\tpublic static QuestionLeftText = \"obf-QuestionLeftText\";\r\n\tpublic static LeftFormContainer = \"obf-LeftFormContainer\";\r\n\tpublic static LeftPanelContainer = \"obf-LeftPanelContainer\";\r\n\tpublic static MainContainer = \"obf-MainContainer\";\r\n\tpublic static MainContentHolder = \"obf-MainContentHolder\";\r\n\tpublic static MiddleFormContainer = \"obf-MiddleFormContainer\";\r\n\tpublic static OverlayBackground = \"obf-OverlayBackground\";\r\n\tpublic static PrivacyStatementLink = \"obf-PrivacyStatementLink\";\r\n\tpublic static PrivacyConsentText = \"obf-PrivacyConsentText\";\r\n\tpublic static FirstTabbable = \"obf-FirstTabbable\";\r\n\tpublic static LastTabbable = \"obf-LastTabbable\";\r\n\tpublic static EmailCheckBox = \"obf-EmailCheckBox\";\r\n\tpublic static RequiredAsterisk = \"obf-RequiredStar\";\r\n\r\n\t// Single form ids\r\n\tpublic static SingleFormContainer = \"obf-SingleFormContainer\";\r\n\tpublic static SingleFormQuestionMiddleText = \"obf-SingleFormQuestionMiddleText\";\r\n\tpublic static SingleFormCategoriesDropdown = \"obf-SingleFormCategoriesDropdown\";\r\n\tpublic static SingleFormComment = \"obf-SingleFormComment\";\r\n\tpublic static SingleFormEmailInput = \"obf-SingleFormEmailInput\";\r\n\tpublic static SingleFormRating = \"obf-SingleFormRating\";\r\n\tpublic static SingleFormScreenshotCheckbox = \"obf-SingleFormScreenshotCheckbox\";\r\n\tpublic static SingleFormScreenshotPreview = \"obf-SingleFormScreenshotPreview\";\r\n\tpublic static SingleFormSubmitButton = \"obf-SingleFormSubmitButton\";\r\n\tpublic static SingleFormCancelButton = \"obf-SingleFormCancelButton\";\r\n\tpublic static SingleFormSubmitButtonSpinner = \"obf-SingleFormSubmitButtonSpinner\";\r\n\r\n\t// Basic form ids\r\n\tpublic static BasicFormContainer = \"obf-BasicFormContainer\";\r\n\tpublic static BasicFormQuestionMiddleText = \"obf-BasicFormQuestionMiddleText\";\r\n\tpublic static BasicFormCategoriesDropdown = \"obf-BasicFormCategoriesDropdown\";\r\n\tpublic static BasicFormComment = \"obf-BasicFormComment\";\r\n\tpublic static BasicFormEmailInput = \"obf-BasicFormEmailInput\";\r\n\tpublic static BasicFormRating = \"obf-BasicFormRating\";\r\n\tpublic static BasicFormScreenshotCheckbox = \"obf-BasicFormScreenshotCheckbox\";\r\n\tpublic static BasicFormScreenshotPreview = \"obf-BasicFormScreenshotPreview\";\r\n\tpublic static BasicFormSubmitButton = \"obf-BasicFormSubmitButton\";\r\n\tpublic static BasicFormCancelButton = \"obf-BasicFormCancelButton\";\r\n\tpublic static BasicFormSubmitButtonSpinner = \"obf-BasicFormSubmitButtonSpinner\";\r\n\r\n\t// Thanks Panel ids\r\n\tpublic static ThanksPanelContainer = \"obf-ThanksPanelContainer\";\r\n\tpublic static ThanksPanelCloseButton = \"obf-ThanksPanelCloseButton\";\r\n\tpublic static ThanksPanelDiscussion = \"obf-ThanksPanelDiscussion\";\r\n\tpublic static ThanksPanelVerticalContainer = \"obf-ThanksPanelVerticalContainer\";\r\n\tpublic static ThanksPanelInnerContainer = \"obf-ThanksPanelInnerContainer\";\r\n\tpublic static ThanksPanelParagraph = \"obf-ThanksPanelParagraph\";\r\n\r\n\t// Feedback Portal Idea Id\r\n\tpublic static FeedbackPortalIdeaContainer = \"obf-FeedbackPortalIdeaContainer\";\r\n\tpublic static OverallFeedbackPortalIdeaAnchor = \"obf-OverallFeedbackPortalIdeaAnchor\";\r\n\r\n\t// endregion\r\n\r\n\t// region Toast\r\n\tpublic static ToastContainer = \"obf-ToastContainer\";\r\n\tpublic static ToastCancel = \"obf-ToastCancel\";\r\n\r\n\t// Prompt ids\r\n\tpublic static TPromptContainer = \"obf-TPromptContainer\";\r\n\tpublic static TPromptTitle = \"obf-TPromptTitle\";\r\n\tpublic static TPromptText = \"obf-TPromptText\";\r\n\r\n\t// Survey ids\r\n\tpublic static TFormContainer = \"obf-TFormContainer\";\r\n\tpublic static TFormContainerLabel = \"obf-TFormContainerLabel\";\r\n\tpublic static TFormTitle = \"obf-TFormTitle\";\r\n\tpublic static TFormRating = \"obf-TFormRating\";\r\n\tpublic static TFormRatingQuestion = \"obf-TFormRatingQuestion\";\r\n\tpublic static TFormCommentQuestion = \"obf-TFormCommentQuestion\";\r\n\tpublic static TFormComment = \"obf-TFormComment\";\r\n\tpublic static TFormEmailTextBox = \"obf-TFormEmailTextBox\";\r\n\tpublic static TFormEmailCheckBox = \"obf-TFormEmailCheckBox\";\r\n\tpublic static TFormEmailLabel = \"obf-TFormEmailLabel\";\r\n\tpublic static TFormSubmitButton = \"obf-TFormSubmitButton\";\r\n\tpublic static TFormCancelButton = \"obf-TFormCancelButton\";\r\n\tpublic static TFormSubmitButtonSpinner = \"obf-TFormSubmitButtonSpinner\";\r\n\tpublic static TFormSubmitButtonContainer = \"obf-TFormSubmitButtonContainer\";\r\n\r\n\t// endregion\r\n}\r\n\r\n/**\r\n * Keys\r\n */\r\nexport class Keys {\r\n\tpublic static Esc = 27;\r\n\tpublic static Tab = 9;\r\n}\r\n\r\n/**\r\n * HTML tags\r\n */\r\nexport class Tags {\r\n\tpublic static Anchor = \"A\";\r\n\tpublic static Button = \"button\";\r\n\tpublic static Defs = \"defs\";\r\n\tpublic static Div = \"div\";\r\n\tpublic static FieldSet = \"fieldset\";\r\n\tpublic static Form = \"form\";\r\n\tpublic static Img = \"img\";\r\n\tpublic static Input = \"input\";\r\n\tpublic static Label = \"label\";\r\n\tpublic static Legend = \"legend\";\r\n\tpublic static Option = \"option\";\r\n\tpublic static Polygon = \"polygon\";\r\n\tpublic static Select = \"select\";\r\n\tpublic static Span = \"span\";\r\n\tpublic static Svg = \"svg\";\r\n\tpublic static TextArea = \"textarea\";\r\n\tpublic static Use = \"use\";\r\n}\r\n\r\n/**\r\n * HTML roles\r\n */\r\nexport class Roles {\r\n\tpublic static Button = \"Button\";\r\n}\r\n\r\n/**\r\n * URLs\r\n */\r\nexport class Urls {\r\n\t/**\r\n\t * Link to the feedback Privacy Statement\r\n\t */\r\n\tpublic static PrivacyStatementLink = \"https://go.microsoft.com/fwlink/?LinkId=521839\";\r\n}\r\n\r\n/**\r\n * prompt constants\r\n */\r\nexport class PromptConstants {\r\n\tpublic static No = \"1\";\r\n\tpublic static Yes = \"2\";\r\n}\r\n", "export default \"2.10.2\";", "/**\r\n * CommonApp.ts\r\n *\r\n * Common logic for entrypoints.\r\n */\r\n\r\nimport \"./Polyfills/Promise\";\r\n\r\nimport { TelemetrySink } from \"@microsoft/oteljs\";\r\nimport { initialize as personalizationInit } from \"@ms-ofb/officepersonalization/dist/lib/Common/Init\";\r\nimport * as Configuration from \"./Configuration/Configuration\";\r\nimport * as Logging from \"./Logging/Logging\";\r\nimport Version from \"./Version\";\r\nimport * as Window from \"./Window/Window\";\r\n\r\nconst APP_NAME = \"OfficeFeedbackSDK\";\r\n\r\n/**\r\n * Has the SDK been initialized\r\n */\r\nlet initialized = false;\r\n\r\n/**\r\n * Has the SDK allow AADC\r\n */\r\nlet commonPolicyAllowAADC = false;\r\n\r\n/**\r\n * Initialize\r\n */\r\nexport function initialize(): void {\r\n\tif (initialized) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!Window.get().OfficeBrowserFeedback.initOptions) {\r\n\t\tthrow new Error(\"Window.OfficeBrowserFeedback.initOptions not set\");\r\n\t}\r\n\r\n\tWindow.get().OfficeBrowserFeedback.sdkVersion = Version;\r\n\tConfiguration.get().setCommonInitOptions(Window.get().OfficeBrowserFeedback.initOptions);\r\n\tcommonPolicyAllowAADC = Configuration.get().isFeedbackSurveyEnabledByAADC();\r\n\r\n\tLogging.initialize(\r\n\t\tConfiguration.get().getCommonInitOptions(),\r\n\t\tAPP_NAME,\r\n\t\tVersion,\r\n\t\tConfiguration.get().getSdkSessionId(),\r\n\t\tConfiguration.get().getEventSampling()\r\n\t);\r\n\r\n\tpersonalizationInit(Configuration.get().getPersonalizationInitOptions())\r\n\r\n\tinitialized = true;\r\n\r\n\tif (!commonPolicyAllowAADC) {\r\n\t\tLogging.getLogger().logEvent(Logging.EventIds.FEEDBACK_SURVEYSDISABLED_AADC,\r\n\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t{\r\n\t\t\t\tData: JSON.stringify({\r\n\t\t\t\t\tageGroup: Configuration.get().getCommonInitOptions().ageGroup,\r\n\t\t\t\t\tauthenticationType: Configuration.get().getCommonInitOptions().authenticationType,\r\n\t\t\t\t}),\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Reset the module. Used in unit tests.\r\n */\r\nexport function reset() {\r\n\tinitialized = false;\r\n}\r\n\r\n/**\r\n * Return Flag to determine whether Feedback and Survey is enabled by AADC.\r\n * Return true if Feedback and Survey is enabled.\r\n * Otherwise, return false.\r\n */\r\nexport function isFeedbackSurveyEnabledByAADC(): boolean {\r\n\treturn commonPolicyAllowAADC;\r\n}\r\n\r\n/**\r\n * Update the telemetrySink during runtime.\r\n */\r\nexport function updateTelemetrySink(sink: TelemetrySink) {\r\n\ttry {\r\n\t\tConfiguration.get().updateTelemetrySink(sink);\r\n\t\tLogging.getLogger().flushQueue();\r\n\r\n\t\t// Re-init the logger with new sink\r\n\t\tLogging.initialize(\r\n\t\t\tConfiguration.get().getCommonInitOptions(),\r\n\t\t\tAPP_NAME,\r\n\t\t\tVersion,\r\n\t\t\tConfiguration.get().getSdkSessionId(),\r\n\t\t\tConfiguration.get().getEventSampling()\r\n\t\t);\r\n\t} catch (e) {\r\n\t\tthrow new Error(\"Failed to update telemetry sink: \" + e);\r\n\t}\r\n}\r\n\r\n\r\nWindow.setIsFeedbackSurveyEnabledByAADC(isFeedbackSurveyEnabledByAADC);\r\nWindow.setUpdateTelemetrySink(updateTelemetrySink);", "import {\r\n\tApi,\r\n\tGovernanceServiceClientState,\r\n\tGovernanceServiceHostPlatform,\r\n\tGovernanceServiceSurveyPlatform,\r\n\tGovernanceServiceSurveyType,\r\n\tGovernedChannelType,\r\n\tIGovernanceCampaignInfo,\r\n\tIGovernanceCampaignRequest,\r\n\tIGovernanceClientInfo,\r\n\tIGovernanceParameters,\r\n\tIGovernanceServiceResult\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { isDate, isNOU, isNumber, isValidUserId, stringToDate } from \"@ms-ofb/officefloodgatecore/dist/src/Utils\";\r\nimport { Configuration } from \"../Configuration/Configuration\";\r\nimport { DynamicContentTransport } from \"../DynamicContent/DynamicContentTransport\";\r\nimport * as Logging from \"../Logging/Logging\";\r\nimport * as Constants from \"./../Constants\";\r\n\r\nconst govServiceIntURL = \"https://onessppe.microsoft.com/api/v1.0/UserCampaigns\";\r\nconst govServiceProdURL = \"https://oness.microsoft.com/api/v1.0/UserCampaigns\";\r\n\r\nexport class GovernanceServiceClient implements Api.IGovernanceServiceClient {\r\n\r\n\t// making these data public so they can be access for testing\r\n\tpublic dynamicTransport: DynamicContentTransport;\r\n\tpublic clientState: GovernanceServiceClientState;\r\n\r\n\t// Configuration data\r\n\tprivate governanceServiceEnabled: boolean;\r\n\tprivate governanceServiceEnabledChannels: GovernedChannelType[];\r\n\tprivate forceServicelessSurveyDisplay: boolean;\r\n\tprivate retryLimit: number;\r\n\tprivate timeout: number;\r\n\tprivate isProduction: boolean;\r\n\tprivate isSurveyGovernanceEnabled: boolean;\r\n\r\n\t// client info\r\n\tprivate clientInfo: IGovernanceClientInfo;\r\n\tprivate userId: string;\r\n\r\n\t// survey data\r\n\tprivate lastSurveyFailedSync: IGovernanceCampaignInfo;\r\n\tconstructor() {\r\n\t\tthis.governanceServiceEnabledChannels = [];\r\n\t\tthis.forceServicelessSurveyDisplay = false;\r\n\t\tthis.lastSurveyFailedSync = undefined;\r\n\t\tthis.clientState = GovernanceServiceClientState.Disabled;\r\n\t}\r\n\r\n\tpublic setup(configuration: Configuration) {\r\n\t\tthis.governanceServiceEnabled = configuration.getFloodgateInitOptions().governanceServiceEnabled;\r\n\r\n\t\tif (this.governanceServiceEnabled) {\r\n\t\t\t// setup config and client info\r\n\t\t\tthis.clientInfo = {\r\n\t\t\t\tapplicationId: configuration.getCommonInitOptions().appId.toString(),\r\n\t\t\t\tsessionId: configuration.getCommonInitOptions().sessionId,\r\n\t\t\t\tversion: configuration.getCommonInitOptions().build,\r\n\t\t\t\tsurveyPlatform: GovernanceServiceSurveyPlatform.Floodgate,\r\n\t\t\t\thostPlatform: GovernanceServiceHostPlatform.Web,\r\n\t\t\t\ttenantId: configuration.getCommonInitOptions().telemetryGroup.tenantId,\r\n\t\t\t\tdeviceId: configuration.getCommonInitOptions().telemetryGroup.deviceId,\r\n\t\t\t\taudience: configuration.getCommonInitOptions().telemetryGroup.audience,\r\n\t\t\t};\r\n\t\t\tthis.userId = configuration.getCommonInitOptions().telemetryGroup.loggableUserId;\r\n\r\n\t\t\t// Ensure all the client info is needed\r\n\t\t\tif (isNOU(this.clientInfo.sessionId)) {\r\n\t\t\t\tthis.clientState = GovernanceServiceClientState.InitializationFailed;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (isNOU(this.clientInfo.version)) {\r\n\t\t\t\tthis.clientState = GovernanceServiceClientState.InitializationFailed;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!isValidUserId(this.userId)) {\r\n\t\t\t\tthis.clientState = GovernanceServiceClientState.InitializationFailed;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Setup governance service config parameters\r\n\t\t\tthis.forceServicelessSurveyDisplay = configuration.getFloodgateInitOptions().governanceServiceConfig.forceServicelessSurveyDisplay;\r\n\t\t\tthis.retryLimit = configuration.getFloodgateInitOptions().governanceServiceConfig.retry;\r\n\t\t\tthis.timeout = configuration.getFloodgateInitOptions().governanceServiceConfig.timeout;\r\n\t\t\tthis.isProduction = configuration.getCommonInitOptions().environment === Constants.Environment.Production;\r\n\t\t\tthis.clientState = GovernanceServiceClientState.Enabled;\r\n\t\t\tthis.dynamicTransport = new DynamicContentTransport();\r\n\t\t\tthis.isSurveyGovernanceEnabled = configuration.getFloodgateInitOptions().governanceServiceConfig.isSurveyLevelGovernanceEnabled;\r\n\r\n\t\t\t// Get feature gate settings\r\n\t\t\tconst featureGateProvider = configuration.getFeatureGateProvider();\r\n\t\t\tif (!featureGateProvider) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Enable governance for standard and teaching by default, this feature gate will be a master swtich to disable/enable channels \r\n\t\t\tthis.governanceServiceEnabledChannels = featureGateProvider.getJsonObjectStringFeatureStatus(\r\n\t\t\t\tConstants.FeatureGateNames.GovernanceServiceEnabledChannels, \r\n\t\t\t\t[GovernedChannelType.Standard, GovernedChannelType.TeachingMessage, GovernedChannelType.Dialog]);\r\n\r\n\t\t\t// Override userId for local testing\r\n\t\t\tconst userIdOverride = featureGateProvider.getStringFeatureStatus(\r\n\t\t\t\tConstants.FeatureGateNames.GovernanceLocalUserIdOverride, \"\");\r\n\t\t\tif (userIdOverride) {\r\n\t\t\t\tthis.userId = userIdOverride;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic isEnabled(governedChannelType: GovernedChannelType): boolean {\r\n\t\treturn this.clientState === GovernanceServiceClientState.Enabled &&\r\n\t\t\tthis.governanceServiceEnabled && \r\n\t\t\t((this.governanceServiceEnabledChannels ?? []).indexOf(governedChannelType) !== -1);\r\n\t}\r\n\r\n\tpublic isSurveyLevelGovernanceEnabled(): boolean {\r\n\t\treturn this.isSurveyGovernanceEnabled;\r\n\t}\r\n\r\n\tpublic isGovernanceEnabledForChannel(governedChannelType: GovernedChannelType): boolean {\r\n\t\treturn this.isSurveyGovernanceEnabled || governedChannelType !== GovernedChannelType.Standard;\r\n\t}\r\n\r\n\tpublic shouldForceDisplay(): boolean {\r\n\t\treturn this.forceServicelessSurveyDisplay;\r\n\t}\r\n\r\n\tpublic getClientInfo(): IGovernanceClientInfo {\r\n\t\treturn this.clientInfo;\r\n\t}\r\n\r\n\tpublic getClientState(): GovernanceServiceClientState {\r\n\t\treturn this.clientState;\r\n\t}\r\n\r\n\tpublic getLastSurveyFailedSync(): IGovernanceCampaignInfo {\r\n\t\treturn this.lastSurveyFailedSync;\r\n\t}\r\n\r\n\tpublic async checkGovernancePermitAsync(governanceParams: IGovernanceParameters): Promise<IGovernanceServiceResult> {\r\n\r\n\t\t// If the GovernanceService is not enabled, return as allowance\r\n\t\tif (!this.isEnabled(governanceParams.channelType)) {\r\n\t\t\treturn { permission: true, error: false };\r\n\t\t}\r\n\r\n\t\tconst campaignInfo: IGovernanceCampaignInfo = this.buildCampaignInfo(governanceParams)\r\n\t\tconst requestUrl = this.isProduction ? govServiceProdURL : govServiceIntURL;\r\n\t\tconst body = this.buildRequestBody(campaignInfo, governanceParams.userCooldown);\r\n\r\n\t\tconst serviceResult: IGovernanceServiceResult = {\r\n\t\t\tpermission: false,\r\n\t\t\terror: false,\r\n\t\t\tisSurveyGoverned: false,\r\n\t\t\trequestId: this.dynamicTransport.requestId,\r\n\t\t};\r\n\r\n\t\tlet response: Response;\r\n\t\tlet serviceCallTime: number;\r\n\r\n\t\ttry {\r\n\t\t\tconst timeBefore = performance.now();\r\n\t\t\tresponse = await this.dynamicTransport.postRequestWithRetry(requestUrl, body, this.retryLimit, this.timeout);\r\n\t\t\tserviceCallTime = performance.now() - timeBefore;\r\n\r\n\t\t\tlet responseText: string | undefined; /* eslint-disable-line prefer-const */\r\n\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\tthis.lastSurveyFailedSync = campaignInfo;\r\n\t\t\t\tserviceResult.errorMessage = `Server Error, status: ${response.status}, status text: ${response.statusText}`;\r\n\t\t\t\tserviceResult.error = true;\r\n\t\t\t\t// Log the successful post criteria with time\r\n\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.GOVERNANCE_SERVICERESULT,\r\n\t\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\t\tHttpStatusCode: response.status,\r\n\t\t\t\t\t\tHttpStatusText: response.statusText,\r\n\t\t\t\t\t\tAdditionalSurveyInfo: this.buildConfigTelemetryString(),\r\n\t\t\t\t\t\tCorrelationId: this.dynamicTransport.requestId,\r\n\t\t\t\t\t\tGovernanceRequestBody: body,\r\n\t\t\t\t\t\tGovernanceResponseText: responseText,\r\n\t\t\t\t\t\tCampaignId: governanceParams.campaignId,\r\n\t\t\t\t\t\tSurveyId: governanceParams.surveyId,\r\n\t\t\t\t\t\tChannelType: governanceParams.channelType,\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\treturn serviceResult;\r\n\t\t\t}\r\n\r\n\t\t\t// Get the response text\r\n\t\t\tresponseText = await response.text();\r\n\r\n\t\t\t// Log the successful post criteria with time\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.GOVERNANCE_SERVICERESULT,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\tHttpStatusCode: response.status,\r\n\t\t\t\t\tHttpStatusText: response.statusText,\r\n\t\t\t\t\tAdditionalSurveyInfo: this.buildConfigTelemetryString(),\r\n\t\t\t\t\tCorrelationId: this.dynamicTransport.requestId,\r\n\t\t\t\t\tGovernanceRequestBody: body,\r\n\t\t\t\t\tGovernanceResponseText: responseText,\r\n\t\t\t\t\tCampaignId: governanceParams.campaignId,\r\n\t\t\t\t\tSurveyId: governanceParams.surveyId,\r\n\t\t\t\t\tChannelType: governanceParams.channelType,\r\n\t\t\t\t});\r\n\r\n\t\t\t// Parse the response\r\n\t\t\tconst jsonResponse = JSON.parse(responseText);\r\n\r\n\t\t\t// Reparsing the date to correct ISO format\r\n\t\t\tjsonResponse.lastTriggerCampaignTime = stringToDate(new Date(jsonResponse.lastTriggerCampaignTime).toISOString());\r\n\r\n\t\t\t// Check the response integrity\r\n\t\t\tif (\r\n\t\t\t\t!isNumber(jsonResponse.timeUntilNextCampaignAllowed) ||\r\n\t\t\t\t!isDate(jsonResponse.lastTriggerCampaignTime)\r\n\t\t\t) {\r\n\t\t\t\t// Throw error with the response\r\n\t\t\t\tserviceResult.errorMessage = \"Service Response is not formatted correctly: \" + responseText;\r\n\t\t\t\tserviceResult.error = true;\r\n\t\t\t\tthis.lastSurveyFailedSync = campaignInfo;\r\n\t\t\t} else {\r\n\t\t\t\tconst isCampaignGovernanceEnabled = this.isGovernanceEnabledForChannel(governanceParams.channelType);\r\n\r\n\t\t\t\t// Survey level Governance for this survey is enabled on server side.\r\n\t\t\t\t// Any null value (below) from service indicates that this specific survery is not governed.\r\n\t\t\t\t// We should bypass this check and continue the workflow.\r\n\t\t\t\tif (\r\n\t\t\t\t\tisCampaignGovernanceEnabled &&\r\n\t\t\t\t\tisNumber(jsonResponse.timeUntilSameCampaignAllowed) &&\r\n\t\t\t\t\t!isNOU(jsonResponse.lastTriggerSameCampaignTime)\r\n\t\t\t\t) {\r\n\t\t\t\t\tserviceResult.isSurveyGoverned = true;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tjsonResponse.lastTriggerSameCampaignTime = stringToDate(new Date(jsonResponse.lastTriggerSameCampaignTime).toISOString());\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tserviceResult.isSurveyGoverned = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if this is permitted\r\n\t\t\t\tif (\r\n\t\t\t\t\tjsonResponse.timeUntilNextCampaignAllowed === 0 &&\r\n\t\t\t\t\t((isCampaignGovernanceEnabled && serviceResult.isSurveyGoverned) ? jsonResponse.timeUntilSameCampaignAllowed === 0 : true)\r\n\t\t\t\t) {\r\n\t\t\t\t\tserviceResult.permission = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Save the response trigger time\r\n\t\t\t\tserviceResult.lastTriggerSurvey = jsonResponse;\r\n\r\n\t\t\t\t// Clear the last failure\r\n\t\t\t\tthis.lastSurveyFailedSync = undefined;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tthis.lastSurveyFailedSync = campaignInfo;\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.GOVERNANCE_SERVICEFAILURE,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: e.toString(),\r\n\t\t\t\t\tAdditionalSurveyInfo: this.buildConfigTelemetryString(),\r\n\t\t\t\t\tCorrelationId: this.dynamicTransport.requestId,\r\n\t\t\t\t\tHttpStatusCode: response?.status,\r\n\t\t\t\t\tHttpStatusText: response?.statusText,\r\n\t\t\t\t\tGovernanceRequestBody: body,\r\n\t\t\t\t});\r\n\t\t\tserviceResult.error = true;\r\n\t\t\tserviceResult.errorMessage = `Error: ${e.toString()}, Error stack: ${e.stack}`;\r\n\t\t}\r\n\r\n\t\treturn serviceResult;\r\n\t}\r\n\t\r\n\tprivate buildCampaignInfo(governanceParams: IGovernanceParameters): IGovernanceCampaignInfo {\r\n\t\tconst stringType = Api.SurveyType[governanceParams.surveyType];\r\n\t\tconst surveyType: number = GovernanceServiceSurveyType[stringType as keyof typeof GovernanceServiceSurveyType];\r\n\t\tconst newDate = new Date();\r\n\t\treturn {\r\n\t\t\tcampaignId: governanceParams.campaignId,\r\n\t\t\tmaxLaunches: governanceParams.maxLaunches,\r\n\t\t\ttriggerTime: newDate,\r\n\t\t\ttype: surveyType,\r\n\t\t\tcooldown: governanceParams.campaignCooldown,\r\n\t\t\tchannel: governanceParams.channelType,\r\n\r\n\t\t\tlocalOffsetTime: newDate.getTimezoneOffset(),\r\n\t\t\tpersonalizerEnabled: governanceParams.personalizerEnabled,\r\n\t\t\t// Survey Level Governance Enabled/Disabled\r\n\t\t\tsurveyGovernanceEnabled: this.isGovernanceEnabledForChannel(governanceParams.channelType),\r\n\t\t};\r\n\t}\r\n\r\n\tprivate buildRequestBody(campaignInfo: IGovernanceCampaignInfo, userLevelCooldown: number): string {\r\n\t\tconst result: IGovernanceCampaignRequest = {\r\n\t\t\tuserId: this.userId,\r\n\t\t\tcampaign: campaignInfo,\r\n\t\t\tuserLevelCooldown: userLevelCooldown,\r\n\t\t\tclient: this.clientInfo,\r\n\t\t\trequestId: this.dynamicTransport.requestId,\r\n\t\t};\r\n\r\n\t\treturn JSON.stringify(result);\r\n\t}\r\n\r\n\tprivate buildConfigTelemetryString() {\r\n\t\tconst objectTelemetry = {\r\n\t\t\tretry: this.retryLimit,\r\n\t\t\ttimeout: this.timeout,\r\n\t\t};\r\n\t\treturn JSON.stringify(objectTelemetry);\r\n\t}\r\n}\r\n\r\nconst governanceServiceClient: GovernanceServiceClient = new GovernanceServiceClient();\r\n\r\n/**\r\n * Get the current Governance Service Client\r\n */\r\nexport function get(): GovernanceServiceClient {\r\n\treturn governanceServiceClient;\r\n}\r\n", "import { guid, isNOU } from \"@ms-ofb/officefloodgatecore/dist/src/Utils\";\r\nimport * as Logging from \"../Logging/Logging\";\r\nimport \"../Polyfills/Fetch\";\r\n\r\nexport class DynamicContentTransport {\r\n\tpublic requestId: string;\r\n\r\n\tpublic postRequestWithRetry(requestUrl: string, body: string, retry: number, timeout: number): Promise<Response> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.sendPostRequest(requestUrl, body, undefined, undefined, timeout)\r\n\t\t\t\t.then(resolve)\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tLogging.getLogger().logEvent(\r\n\t\t\t\t\t\tLogging.EventIds.DYNAMICTRANSPORT_POST_ERROR,\r\n\t\t\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tErrorMessage: error.toString(),\r\n\t\t\t\t\t\t\tTimeMilliseconds: timeout,\r\n\t\t\t\t\t\t\tCount: retry,\r\n\t\t\t\t\t\t\tCorrelationId: this.requestId,\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (retry <= 1) {\r\n\t\t\t\t\t\treturn reject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.postRequestWithRetry(requestUrl, body, retry - 1, timeout)\r\n\t\t\t\t\t\t.then(resolve)\r\n\t\t\t\t\t\t.catch(reject);\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprotected createHeaders(token?: string): Headers {\r\n\t\tconst headers: Headers = typeof Headers !== \"undefined\" && new Headers();\r\n\r\n\t\tif (headers) {\r\n\t\t\tthis.createNormalHeaders(headers);\r\n\r\n\t\t\t// Governance Service doesn't need to use token for now\r\n\t\t\tif (!isNOU(token)) {\r\n\t\t\t\theaders.append(\"Authorization\", \"Bearer \" + token);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn headers;\r\n\t}\r\n\r\n\tprivate createNormalHeaders(headers: Headers) {\r\n\t\t// Generate a new correlation ID for each request\r\n\t\tthis.requestId = guid();\r\n\t\theaders.append(\"X-Request-ID\", this.requestId);\r\n\t\theaders.append(\"Content-Type\", \"application/json\");\r\n\t}\r\n\r\n\tprivate sendPostRequest(requestUrl: string, body: string, token?: string, headers?: Headers, timeout?: number): Promise<Response> {\r\n\t\t// Create headers for this specific request\r\n\t\tconst requestHeaders = headers || this.createHeaders(token);\r\n\r\n\t\t// Set up fetch options\r\n\t\tconst requestInit: RequestInit = {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: requestHeaders,\r\n\t\t\tbody: body\r\n\t\t};\r\n\r\n\t\t// If no timeout or timeout is 0, just send a regular fetch\r\n\t\tif (!timeout || timeout <= 0) {\r\n\t\t\treturn fetch(requestUrl, requestInit);\r\n\t\t}\r\n\t\t\r\n\t\t// Handle timeout if specified\r\n\t\treturn new Promise<Response>((resolve, reject) => {\r\n\t\t\tconst controller = new AbortController();\r\n\t\t\trequestInit.signal = controller.signal;\r\n\t\t\t\r\n\t\t\tconst timeoutId = setTimeout(() => {\r\n\t\t\t\tcontroller.abort();\r\n\t\t\t\treject(new Error(\"Service request timed out\"));\r\n\t\t\t}, timeout);\r\n\r\n\t\t\tfetch(requestUrl, requestInit)\r\n\t\t\t\t.then((response) => {\r\n\t\t\t\t\tclearTimeout(timeoutId);\r\n\t\t\t\t\tresolve(response);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tclearTimeout(timeoutId);\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n", "import {\r\n\tApi,\r\n\tAutoDismissTimes,\r\n\tEndUserActions,\r\n\tGovernedChannelType,\r\n\tIActionPayload,\r\n\tIGovernanceParameters,\r\n\tIGovernanceServiceResult,\r\n\tIPersonalizerClient,\r\n\tIPersonalizerRewardResponse,\r\n\tSupportedOverrides,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { Utils } from \"@ms-ofb/officefloodgatecore\";\r\nimport { Configuration } from \"../Configuration/Configuration\";\r\nimport * as Constants from \"../Constants\";\r\nimport { DynamicContentTransport } from \"../DynamicContent/DynamicContentTransport\";\r\nimport * as Logging from \"../Logging/Logging\";\r\n\r\nconst govServiceIntReward = \"https://onessppe.microsoft.com/api/v1.0/Reward\";\r\nconst govServiceProdReward = \"https://oness.microsoft.com/api/v1.0/Reward\";\r\n\r\ninterface IPersonalizerSurveyInformation {\r\n\t// variables to track the user's action and personalizer service recommendation\r\n\teventId: string; // Unique ID variable to match rank and reward\r\n\trecommendedAutoDismissValue: Constants.AutoDismissValues;\r\n\tuserAction: EndUserActions | undefined;\r\n}\r\n\r\nexport class PersonalizerClient implements IPersonalizerClient {\r\n\r\n\tpublic dynamicTransport: DynamicContentTransport;\r\n\tprivate personalizerEnabled: boolean;\r\n\r\n\t// --- State Data ---------------\r\n\t// -------\r\n\r\n\t// map of surveyId to IPersonalizerSurveyInformation instance.\r\n\tprivate personalizerSurveyInformationMap: {\r\n\t\t[surveyId: string]: IPersonalizerSurveyInformation,\r\n\t};\r\n\r\n\t// -------\r\n\t// --- State Data (end) ---------------\r\n\r\n\tprivate isProduction: boolean;\r\n\tprivate retryLimit: number;\r\n\tprivate timeout: number;\r\n\tprivate requestUrl: string;\r\n\r\n\tconstructor() {\r\n\t\t// Check if personalizer is enabled, otherwise set personalizerEnabled to false and do nothing (log?)\r\n\t\t// set enabled to false, this we will check in setup.\r\n\t\tthis.personalizerEnabled = false;\r\n\t\tthis.dynamicTransport = new DynamicContentTransport();\r\n\t\tthis.personalizerSurveyInformationMap = {};\r\n\t}\r\n\r\n\tpublic setup(configuration: Configuration): void {\r\n\t\tthis.personalizerEnabled = configuration.getFloodgateInitOptions().governanceServiceEnabled &&\r\n\t\t\tconfiguration.getFloodgateInitOptions().personalizerEnabled;\r\n\r\n\t\tif (this.personalizerEnabled) {\r\n\t\t\tthis.isProduction = configuration.getCommonInitOptions().environment === Constants.Environment.Production;\r\n\t\t\tthis.retryLimit = configuration.getFloodgateInitOptions().governanceServiceConfig.retry;\r\n\t\t\tthis.timeout = configuration.getFloodgateInitOptions().governanceServiceConfig.timeout;\r\n\t\t\tthis.requestUrl = this.isProduction ? govServiceProdReward : govServiceIntReward;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setEventIdAndOverrideValueForSurveyId(eventId: string,\r\n\t\tconfigType: SupportedOverrides,\r\n\t\tconfigValue: string,\r\n\t\tsurveyId: string,\r\n\t\tcampaignId: string): boolean {\r\n\r\n\t\tif (!this.personalizerEnabled || Utils.isNOU(eventId) || Utils.isNOU(surveyId)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (configType !== SupportedOverrides.AutoDismissTime) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst newRecommendedAutoDismissValue = this.validateAndGetAutoDismissTime(configValue);\r\n\r\n\t\tif (Utils.isNOU(newRecommendedAutoDismissValue)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.personalizerSurveyInformationMap[surveyId] = {\r\n\t\t\teventId: eventId,\r\n\t\t\trecommendedAutoDismissValue: newRecommendedAutoDismissValue,\r\n\t\t\tuserAction: undefined,\r\n\t\t};\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic getOverrideValueForSurveyId(configType: SupportedOverrides, surveyId: string): Constants.AutoDismissValues | undefined {\r\n\r\n\t\tif (!this.personalizerEnabled || Utils.isNOU(surveyId) ||\r\n\t\t\t!this.infoExistsForSurveyId(surveyId) || configType !== SupportedOverrides.AutoDismissTime) {\r\n\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\treturn this.personalizerSurveyInformationMap[surveyId].recommendedAutoDismissValue;\r\n\t}\r\n\r\n\tpublic async logUserActionForSurveyAsync(userAction: EndUserActions,\r\n\t\tsurveyId: string,\r\n\t\tcampaignId: string): Promise<IPersonalizerRewardResponse> {\r\n\r\n\t\tif (!Utils.isNOU(userAction) && this.infoExistsForSurveyId(surveyId)) {\r\n\t\t\tthis.personalizerSurveyInformationMap[surveyId].userAction = userAction;\r\n\t\t}\r\n\r\n\t\tconst responseResult: IPersonalizerRewardResponse = {\r\n\t\t\terror: false,\r\n\t\t};\r\n\r\n\t\tconst actionPayload = this.getValidatedActionPayloadForSurveyId(surveyId);\r\n\r\n\t\t// validate the actionPayload. Log and early return with error if it fails.\r\n\t\tif (Utils.isNOU(actionPayload)) {\r\n\t\t\tresponseResult.error = true;\r\n\t\t\tresponseResult.errorMessage = \"Action Payload validation failed.\";\r\n\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.PERSONALIZER_CLIENTFAILURE,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tMessage: \"(PersonalizerClient.logUserActionForSurveyAsync) Error logging personalizer user action: \" + responseResult.errorMessage,\r\n\t\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\t\tSurveyId: surveyId,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\treturn responseResult;\r\n\t\t}\r\n\r\n\t\tlet response: Response;\r\n\r\n\t\ttry {\r\n\t\t\tconst timeBefore = performance.now();\r\n\t\t\tresponse = await this.dynamicTransport.postRequestWithRetry(this.requestUrl,\r\n\t\t\t\tJSON.stringify(actionPayload),\r\n\t\t\t\tthis.retryLimit,\r\n\t\t\t\tthis.timeout);\r\n\r\n\t\t\tconst timeAfter = performance.now();\r\n\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.PERSONALIZER_SERVICEREWARDRESULT,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tTimeMilliseconds: timeAfter - timeBefore,\r\n\t\t\t\t\tHttpStatusCode: response.status,\r\n\t\t\t\t\tHttpStatusText: response.statusText,\r\n\t\t\t\t\tAdditionalSurveyInfo: this.buildConfigTelemetryString(),\r\n\t\t\t\t\tCorrelationId: this.dynamicTransport.requestId,\r\n\t\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\t\tPersonalizerUserAction: actionPayload.UserAction,\r\n\t\t\t\t\tPersonalizerEventId: actionPayload.EventId,\r\n\t\t\t\t\tSurveyId: surveyId,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tif (!response.ok) {\r\n\t\t\t\t// Error on service side.\r\n\t\t\t\tresponseResult.error = true;\r\n\t\t\t\tresponseResult.errorMessage = `Server Error, status: ${response.status}, status text: ${response.statusText}`;\r\n\t\t\t}\r\n\r\n\t\t\treturn responseResult;\r\n\r\n\t\t} catch (error) {\r\n\t\t\tresponseResult.error = true;\r\n\t\t\tresponseResult.errorMessage = `Error: ${error.toString()}, Error stack: ${error.stack}`;\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.PERSONALIZER_CLIENTFAILURE,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tMessage: \"(PersonalizerClient.logUserActionForSurveyAsync) Error logging personalizer user action: \" + responseResult.errorMessage,\r\n\t\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\t\tSurveyId: surveyId,\r\n\t\t\t\t\tPersonalizerUserAction: actionPayload.UserAction,\r\n\t\t\t\t\tPersonalizerEventId: actionPayload.EventId,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\treturn responseResult;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getEventIdForSurveyId(surveyId: string): string | undefined {\r\n\t\tif (!this.infoExistsForSurveyId(surveyId)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\treturn this.personalizerSurveyInformationMap[surveyId].eventId;\r\n\t}\r\n\r\n\tpublic isEnabled(surveyType: Api.SurveyType, launcherType: string, governedChannelType: GovernedChannelType): boolean {\r\n\t\t// Only enabled for:\r\n\t\t// - FPS surveys \r\n\t\t// - No 'customervoice' launcher type.\r\n\t\t// - GovernedChannelType: Standard channel\r\n\r\n\t\tif (surveyType !== Api.SurveyType.Fps\r\n\t\t\t|| launcherType === Constants.customerVoiceLauncherType\r\n\t\t\t|| launcherType === \"customux\"\r\n\t\t\t|| governedChannelType !== GovernedChannelType.Standard) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn this.personalizerEnabled;\r\n\t}\r\n\r\n\tpublic onGovernanceServiceResult(governanceParameters: IGovernanceParameters, serviceResult: IGovernanceServiceResult) {\r\n\t\tif (serviceResult && serviceResult.permission && serviceResult.isSurveyGoverned && \r\n\t\t\t(serviceResult.lastTriggerSurvey?.timeUntilNextCampaignAllowed === 0)) {\r\n\t\t\tif (this.isEnabled(governanceParameters.surveyType, governanceParameters.launcherType, governanceParameters.channelType)) {\r\n\t\t\t\tthis.setEventIdAndOverrideValueForSurveyId(\r\n\t\t\t\t\tserviceResult.requestId,\r\n\t\t\t\t\tSupportedOverrides.AutoDismissTime,\r\n\t\t\t\t\tserviceResult.lastTriggerSurvey.actionId,\r\n\t\t\t\t\tgovernanceParameters.surveyId,\r\n\t\t\t\t\tgovernanceParameters.campaignId);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getValidatedActionPayloadForSurveyId(surveyId: string): IActionPayload | undefined {\r\n\r\n\t\tif (!this.infoExistsForSurveyId(surveyId)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tconst surveyPersonalizerInfo = this.personalizerSurveyInformationMap[surveyId];\r\n\r\n\t\tif (Utils.isNOU(surveyPersonalizerInfo.eventId)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tif (Utils.isNOU(surveyPersonalizerInfo.userAction)\r\n\t\t\t|| (surveyPersonalizerInfo.userAction !== EndUserActions.Accept\r\n\t\t\t\t&& surveyPersonalizerInfo.userAction !== EndUserActions.Cancel\r\n\t\t\t\t&& surveyPersonalizerInfo.userAction !== EndUserActions.Ignore)) {\r\n\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tUserAction: surveyPersonalizerInfo.userAction,\r\n\t\t\tEventId: surveyPersonalizerInfo.eventId,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate validateAndGetAutoDismissTime(configValue: string): undefined | Constants.AutoDismissValues {\r\n\r\n\t\tif (Utils.isNOU(configValue) || typeof (configValue) !== \"string\") {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\t// value should be not null, not undefined; a string that parses to an int; \r\n\t\t// an int that is in the AutoDismissTimes enum and can be mapped to the AutoDismissValues enum.\r\n\r\n\t\tconst parsedConfigValue = parseInt(configValue, 10);\r\n\r\n\t\tswitch (parsedConfigValue) {\r\n\t\t\tcase AutoDismissTimes.NoAutoDismiss:\r\n\t\t\t\treturn Constants.AutoDismissValues.NoAutoDismiss;\r\n\t\t\tcase AutoDismissTimes.SevenSeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.SevenSeconds;\r\n\t\t\tcase AutoDismissTimes.FourteenSeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.FourteenSeconds;\r\n\t\t\tcase AutoDismissTimes.TwentyOneSeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.TwentyOneSeconds;\r\n\t\t\tcase AutoDismissTimes.TwentyEightSeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.TwentyEightSeconds;\r\n\t\t\tcase AutoDismissTimes.SixtySeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.SixtySeconds;\r\n\t\t\tcase AutoDismissTimes.NinetySeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.NinetySeconds;\r\n\t\t\tcase AutoDismissTimes.OneHundredAndTwentySeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.OneHundredAndTwentySeconds;\r\n\t\t\tcase AutoDismissTimes.OneHundredAndFiftySeconds:\r\n\t\t\t\treturn Constants.AutoDismissValues.OneHundredAndFiftySeconds;\r\n\t\t\tdefault:\r\n\t\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate infoExistsForSurveyId(surveyId: string): boolean {\r\n\t\tif (Utils.isNOU(surveyId)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn !Utils.isNOU(this.personalizerSurveyInformationMap[surveyId]);\r\n\t}\r\n\r\n\tprivate buildConfigTelemetryString() {\r\n\t\tconst objectTelemetry = {\r\n\t\t\tretry: this.retryLimit,\r\n\t\t\ttimeout: this.timeout,\r\n\t\t};\r\n\t\treturn JSON.stringify(objectTelemetry);\r\n\t}\r\n}\r\n\r\nconst personalizerClient: PersonalizerClient = new PersonalizerClient();\r\n\r\n/**\r\n * Get the current Personalizer Client\r\n */\r\nexport function get(): PersonalizerClient {\r\n\treturn personalizerClient;\r\n}\r\n", "/**\r\n * CommonFloodgate.ts\r\n *\r\n * Common functionalities shared by App_Floodgate and App_Floodgate_Bare modules.\r\n */\r\n\r\nimport * as Configuration from \"./Configuration/Configuration\";\r\nimport * as GovernanceServiceClient from \"./GovernanceService/GovernanceServiceClient\";\r\nimport * as PersonalizerClient from \"./Personalizer/PersonalizerClient\";\r\nimport * as Window from \"./Window/Window\";\r\n\r\nimport { Api, GovernedChannelType, IFloodgateStorageProvider } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { FloodgateEngine } from \"@ms-ofb/officefloodgatecore\";\r\nimport { DynamicCampaignDefinitionProvider, FilterValidCampaignDefinitions } from \"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider\";\r\nimport { TelemetryEvent } from \"@ms-ofb/officefloodgatecore/dist/src/Constants\";\r\nimport { setFeatureGateProvider as setFloodgateCoreFGProvider } from \"@ms-ofb/officefloodgatecore/dist/src/FeatureGateProvider\";\r\nimport { Governor } from \"@ms-ofb/officefloodgatecore/dist/src/Governor\";\r\nimport SurveyActivityListener from \"@ms-ofb/officefloodgatecore/dist/src/SurveyActivityListener\";\r\nimport { IFloodgateEngineConfig } from \"@ms-ofb/officefloodgatecore/src/Api/IFloodgateEngineConfig\";\r\nimport { SettingKey, getDynamicSetting } from \"@ms-ofb/officepersonalization/dist/lib/Configuration/DynamicConfiguration\";\r\n\r\nimport { TelemetryLogger } from \"@ms-ofb/officefloodgatecore\";\r\nimport AdaptiveSurveyLauncherFactory from \"./FloodgateCore/AdaptiveSurveyLauncherFactory\";\r\nimport FloodgateEnvironmentProvider from \"./FloodgateCore/FloodgateEnvironmentProvider\";\r\nimport FloodgateStorageProvider from \"./FloodgateCore/FloodgateStorageProvider\";\r\nimport FloodgateStringProvider from \"./FloodgateCore/FloodgateStringProvider\";\r\nimport TransporterFactory from \"./FloodgateCore/TransporterFactory\";\r\nimport { TargetedMessagingCampaignDefinitionProvider } from \"./TargetedMessaging/TargetedMessagingCampaignDefinitionProvider\";\r\nimport { UserFactsProvider } from \"./TargetedMessaging/UserFactsProvider\";\r\nimport { CentroThemeDataSource } from \"./UI/DynamicUx/CentroThemeDataSource\";\r\n\r\n/**\r\n * Has floodgate been initialized\r\n */\r\nlet initialized = false;\r\nlet startCount = 0;\r\n\r\nlet dynamicCampaignDataProvider: DynamicCampaignDefinitionProvider<Api.EcsResponseBase>;\r\nlet engine: FloodgateEngine;\r\nlet engineStartPromise: Promise<any> = null;\r\nlet engineTmsProvider: TargetedMessagingCampaignDefinitionProvider = null;\r\nlet userFactsProvider: UserFactsProvider = null;\r\nlet stringProvider: Api.IFloodgateStringProvider;\r\nlet storageProvider: Api.IFloodgateStorageProvider;\r\n\r\nexport function initialize(): void {\r\n\tif (!FloodgateStorageProvider.isStorageAvailable()) {\r\n\t\tthrow new Error(\"window.localStorage is not available.\");\r\n\t}\r\n\r\n\tWindow.get().OfficeBrowserFeedback.floodgate = Window.get().OfficeBrowserFeedback.floodgate || {} as any;\r\n\r\n\tlet floodgateInitOptions = Window.get().OfficeBrowserFeedback.floodgate.initOptions;\r\n\tfloodgateInitOptions = floodgateInitOptions || {} as any;\r\n\r\n\t// Validate and copy campaign definitions to local storage\r\n\tif (floodgateInitOptions.campaignDefinitions !== undefined) {\r\n\t\tconst filteredResult = FilterValidCampaignDefinitions(floodgateInitOptions.campaignDefinitions);\r\n\r\n\t\tif (filteredResult.error) {\r\n\t\t\tthrow new Error(\"floodgate.initOptions.campaignDefinitions error: \" + filteredResult.error);\r\n\t\t}\r\n\r\n\t\t(new FloodgateStorageProvider()).write(\r\n\t\t\tApi.FloodgateStorageProviderFileType.CampaignDefinitions,\r\n\t\t\tJSON.stringify(floodgateInitOptions.campaignDefinitions)\r\n\t\t);\r\n\t}\r\n\r\n\tconst configuration = Configuration.get();\r\n\r\n\tconfiguration.setFloodgateInitOptions(floodgateInitOptions);\r\n\tSurveyActivityListener.resetSessionActivity();\r\n\tPersonalizerClient.get().setup(configuration);\r\n\tGovernanceServiceClient.get().setup(configuration);\r\n\tsetFloodgateCoreFGProvider(Configuration.get().getFeatureGateProvider());\r\n\tsetInitialized(true);\r\n\r\n\tif (!configuration.getFloodgateInitOptions().surveyEnabled) {\r\n\t\tconst telemetryLogger = TelemetryLogger.getTelemetryLogger();\r\n\t\tif (telemetryLogger) {\r\n\t\t\ttelemetryLogger.log_Event(TelemetryEvent.Floodgate.Start.SurveysDisabled,\r\n\t\t\t\t{ Count: startCount, Message: \"Floodgate initialized with surveys disabled (surveyEnabled is false)\" });\r\n\t\t}\r\n\t}\r\n\r\n\tif (!configuration.getFloodgateInitOptions().messagingEnabled) {\r\n\t\tconst telemetryLogger = TelemetryLogger.getTelemetryLogger();\r\n\t\tif (telemetryLogger) {\r\n\t\t\ttelemetryLogger.log_Event(TelemetryEvent.Floodgate.Start.MessagingDisabled,\r\n\t\t\t\t{ Count: startCount, Message: \"Floodgate initialized with messaging disabled (messagingEnabled is false)\" });\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport function setInitialized(initValue: boolean): void {\r\n\tinitialized = initValue;\r\n}\r\n\r\nexport function getInitialized(): boolean {\r\n\treturn initialized;\r\n}\r\n\r\nexport function setEngineStartPromise(startPromise: Promise<any>): any {\r\n\tengineStartPromise = startPromise;\r\n}\r\n\r\nexport function getEngineStartPromise(): Promise<any> {\r\n\treturn engineStartPromise;\r\n}\r\n\r\nexport function setStringProvider(provider: Api.IFloodgateStringProvider): void {\r\n\tstringProvider = provider;\r\n}\r\n\r\n/**\r\n * To support the multi-window scenario on web we need to initialize the engine on each resume.\r\n * Hence this separate method which does make() and start() together.\r\n */\r\nexport function startInternal(loadSynchronously: boolean, customEngine: FloodgateEngine = null): Promise<any> {\r\n\r\n\tstartCount++;\r\n\r\n\tconst rejectAndLogError = (reject: (reason?: any) => void, errorMessage: string, error?: Error, internalSampleRate?: number) => {\r\n\t\tconst telemetryLogger = TelemetryLogger.getTelemetryLogger();\r\n\t\tif (telemetryLogger) {\r\n\t\t\ttelemetryLogger.log_Event(TelemetryEvent.Floodgate.Start.Failed,\r\n\t\t\t\t{ Count: startCount, ErrorMessage: errorMessage, ErrorDetails: error && error.stack },\r\n\t\t\t\tinternalSampleRate);\r\n\t\t}\r\n\r\n\t\treject(errorMessage);\r\n\t};\r\n\r\n\tif (!initialized) {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\trejectAndLogError(reject, \"CommonFloodgate is not initialized.\", undefined /* error */, 0.01 /* internalSampleRate */);\r\n\t\t});\r\n\t}\r\n\r\n\tif (engineStartPromise) {\r\n\t\treturn engineStartPromise;\r\n\t}\r\n\r\n\tconst startPromise = new Promise((resolve, reject) => {\r\n\t\ttry {\r\n\t\t\tconst commonInitOptions = Configuration.get().getCommonInitOptions();\r\n\t\t\tconst campaignDefinitionProviders: Api.ICampaignDefinitionProvider[] = [];\r\n\r\n\t\t\tif (!commonInitOptions) {\r\n\t\t\t\trejectAndLogError(reject, \"Invalid floodgate common init options, state: \" + initialized);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet floodgateInitOptions = Configuration.get().getFloodgateInitOptions();\r\n\t\t\tconst telemetryLogger = TelemetryLogger.getTelemetryLogger();\r\n\t\t\tconst logTelemetryEvent = (eventName: string, properties: Api.ITelemetryProperties, internalSampleRate?: number) => {\r\n\t\t\t\tif (telemetryLogger) {\r\n\t\t\t\t\ttelemetryLogger.log_Event(eventName,\r\n\t\t\t\t\t\tproperties, internalSampleRate);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (!floodgateInitOptions) {\r\n\t\t\t\tlogTelemetryEvent(TelemetryEvent.Floodgate.Start.Warning,\r\n\t\t\t\t\t{ Count: startCount, ErrorMessage: \"Invalid floodgate init options, state: \" + initialized });\r\n\r\n\t\t\t\tConfiguration.get().setFloodgateInitOptions({} as any);\r\n\t\t\t\tfloodgateInitOptions = Configuration.get().getFloodgateInitOptions();\r\n\t\t\t}\r\n\r\n\t\t\tif (!customEngine && !engineTmsProvider) {\r\n\t\t\t\t// AssetsProvider wraps auth callbacks which should not run every time we start()\r\n\t\t\t\tconst authTokenCallback = floodgateInitOptions && floodgateInitOptions.authTokenCallback;\r\n\t\t\t\tif (authTokenCallback) {\r\n\t\t\t\t\tengineTmsProvider = new TargetedMessagingCampaignDefinitionProvider();\r\n\t\t\t\t\tuserFactsProvider = new UserFactsProvider();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (engineTmsProvider) {\r\n\t\t\t\tcampaignDefinitionProviders.push(engineTmsProvider);\r\n\t\t\t}\r\n\r\n\t\t\tif (floodgateInitOptions?.dynamicCampaignConfig?.enabled) {\r\n\t\t\t\tif (floodgateInitOptions?.dynamicCampaignConfig?.ecsClient) {\r\n\t\t\t\t\tlogTelemetryEvent(TelemetryEvent.Floodgate.Start.DynamicCampaignEnabled,\r\n\t\t\t\t\t\t{ Count: startCount }, 0.01);\r\n\r\n\t\t\t\t\tif (!dynamicCampaignDataProvider) {\r\n\t\t\t\t\t\tdynamicCampaignDataProvider = new DynamicCampaignDefinitionProvider(floodgateInitOptions.dynamicCampaignConfig.ecsClient);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcampaignDefinitionProviders.push(dynamicCampaignDataProvider);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlogTelemetryEvent(TelemetryEvent.Floodgate.Start.DynamicCampaignClientUndefined,\r\n\t\t\t\t\t\t{ Count: startCount }, 0.1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst currentTeachingCooldown = Governor.GetChannelCoolDown(GovernedChannelType.TeachingMessage);\r\n\t\t\tconst teachingCooldown = getDynamicSetting(SettingKey.teachingMessageCooldown, currentTeachingCooldown);\r\n\t\t\tGovernor.SetDefaultChannelCoolDown(GovernedChannelType.TeachingMessage, teachingCooldown);\r\n\r\n\t\t\tconst floodgateEngineConfig: IFloodgateEngineConfig = {\r\n\t\t\t\tshouldFetchSurveyCdnConcurrently: floodgateInitOptions?.dynamicUxConfig?.cdnStringConfig.fetchCdnConcurrently,\r\n\t\t\t\tuiStringsCdnEnabled: floodgateInitOptions?.dynamicUxConfig?.cdnStringConfig.uiStringsCdnEnabled,\r\n\t\t\t\tuiStringsLoadingTimeout: floodgateInitOptions?.dynamicUxConfig?.cdnStringConfig.uiStringsLoadingTimeout,\r\n\t\t\t\tuiStringCdnRetryLimit: floodgateInitOptions?.dynamicUxConfig?.cdnStringConfig.uiStringCdnRetryLimit,\r\n\t\t\t\tlocale: commonInitOptions.originalLocale\r\n\t\t\t}\r\n\r\n\t\t\tengine = customEngine || FloodgateEngine.make(\r\n\t\t\t\tcommonInitOptions.build || \"\",\r\n\t\t\t\tAdaptiveSurveyLauncherFactory.make(),\r\n\t\t\t\tfloodgateInitOptions.onSurveyActivatedCallback,\r\n\t\t\t\tgetStorageProvider(),\r\n\t\t\t\tfloodgateInitOptions.settingStorageCallback,\r\n\t\t\t\tstringProvider ? stringProvider : new FloodgateStringProvider(),\r\n\t\t\t\tnew FloodgateEnvironmentProvider(),\r\n\t\t\t\tnew TransporterFactory(),\r\n\t\t\t\tcampaignDefinitionProviders,\r\n\t\t\t\tuserFactsProvider,\r\n\t\t\t\tGovernanceServiceClient.get(),\r\n\t\t\t\tfloodgateInitOptions.isPriorityEnabled,\r\n\t\t\t\tfloodgateEngineConfig,\r\n\t\t\t\tfloodgateInitOptions.appGovernanceProvider,\r\n\t\t\t\tfloodgateInitOptions.logExperimentTrigger,\r\n\t\t\t\tfloodgateInitOptions.campaignTelemetrySamplingConfig,\r\n\t\t\t\tPersonalizerClient.get(),\r\n\t\t\t\tfloodgateInitOptions.messagingEnabled,\r\n\t\t\t\tfloodgateInitOptions.surveyEnabled,\r\n\t\t\t\tengine && engine.getSurveyClient()\r\n\t\t\t);\r\n\r\n\t\t\tif (!engine) {\r\n\t\t\t\tsetEngineStartPromise(null);\r\n\t\t\t\trejectAndLogError(reject, \"Failed to create floodgate engine\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// start subsequent invocations in sync mode\r\n\t\t\tconst shouldStartEngineInSync = loadSynchronously || startCount > 1;\r\n\t\t\tif (shouldStartEngineInSync) {\r\n\t\t\t\tengine.start();\r\n\t\t\t\tresolve(null);\r\n\t\t\t} else {\r\n\t\t\t\tconst enginePromise = engine.startAsync();\r\n\t\t\t\tif (!enginePromise) {\r\n\t\t\t\t\t// ideally this should never happen\r\n\t\t\t\t\tsetEngineStartPromise(null);\r\n\t\t\t\t\trejectAndLogError(reject, \"Failed to get floodgate engine\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tenginePromise.then(\r\n\t\t\t\t\tfunction onFulfilled() {\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t).catch(\r\n\t\t\t\t\tfunction onRejected(startError: Error) {\r\n\t\t\t\t\t\tsetEngineStartPromise(null);\r\n\t\t\t\t\t\trejectAndLogError(reject, \"Failed to start floodgate engine\", startError);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsetEngineStartPromise(null);\r\n\t\t\trejectAndLogError(reject, \"Failed to load floodgate engine: \" + (e && e.toString()), e);\r\n\t\t}\r\n\t});\r\n\r\n\tsetEngineStartPromise(startPromise);\r\n\r\n\t// reset on error\r\n\tstartPromise.catch((error) => {\r\n\t\tsetEngineStartPromise(null);\r\n\t});\r\n\r\n\treturn startPromise;\r\n}\r\n\r\nexport function start(loadSynchronously = false): Promise<any> {\r\n\treturn startInternal(loadSynchronously);\r\n}\r\n\r\n/**\r\n * A proxy for the engine.stop() method for consistency with the start() method.\r\n */\r\nexport function stop() {\r\n\tif (engine) {\r\n\t\tengine.stop();\r\n\t}\r\n\r\n\tsetEngineStartPromise(null);\r\n}\r\n\r\n/**\r\n * Get the engine object\r\n * @returns the engine object\r\n */\r\nexport function getEngine(): FloodgateEngine {\r\n\treturn engine;\r\n}\r\n\r\n/**\r\n * Reset the floodgate engine state. Used in unit tests.\r\n */\r\nexport function resetEngine() {\r\n\tstartCount = 0;\r\n\tengineStartPromise = null;\r\n\tengine = null;\r\n\tengineTmsProvider = null;\r\n\tuserFactsProvider = null;\r\n}\r\n\r\n/**\r\n * Reset the floodgate module. Used in unit tests.\r\n */\r\nexport function reset() {\r\n\tinitialized = false;\r\n\tresetEngine();\r\n}\r\n\r\nexport function getStorageProvider(): IFloodgateStorageProvider {\r\n\tif (!storageProvider) {\r\n\t\tstorageProvider = new FloodgateStorageProvider();\r\n\t}\r\n\treturn storageProvider;\r\n}\r\n\r\nexport function updateThemeInternal(themeConfig: Configuration.IDynamicUxThemeConfig): Promise<any> {\r\n\ttry {\r\n\t\tConfiguration.get().updateTheme(themeConfig, CentroThemeDataSource.get());\r\n\t\treturn Promise.resolve();\r\n\t} catch (error) {\r\n\t\treturn Promise.reject(error);\r\n\t}\r\n}\r\n\r\nWindow.setFloodgateGetEngine(getEngine);\r\nWindow.setFloodgateStart(start);\r\nWindow.setFloodgateStop(stop);\r\nWindow.setStorageProvider(getStorageProvider);\r\nWindow.setFloodgateUpdateTheme(updateThemeInternal);\r\n", "/**\r\n * Survey launcher factory for Web SDK\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { Utils } from \"@ms-ofb/officefloodgatecore\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport GenericMessagingLauncherFactory from \"./GenericMessagingLauncherFactory\";\r\nimport RudeSurveyLauncherFactory from \"./RudeSurveyLauncherFactory\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nexport default class AdaptiveSurveyLauncherFactory implements Api.ISurveyLauncherFactory {\r\n\tpublic static make(): Api.ISurveyLauncherFactory {\r\n\t\treturn new AdaptiveSurveyLauncherFactory(\r\n\t\t\tnew RudeSurveyLauncherFactory(),\r\n\t\t\tnew GenericMessagingLauncherFactory());\r\n\t}\r\n\r\n\tprivate rudeSurveyLauncherFactory: RudeSurveyLauncherFactory;\r\n\tprivate genericMessagingLauncherFactory: GenericMessagingLauncherFactory;\r\n\r\n\tprivate constructor(rudeSurveyLauncherFactory: RudeSurveyLauncherFactory,\r\n\t\tgenericMessagingLauncherFactory: GenericMessagingLauncherFactory) {\r\n\t\tthis.rudeSurveyLauncherFactory = rudeSurveyLauncherFactory;\r\n\t\tthis.genericMessagingLauncherFactory = genericMessagingLauncherFactory;\r\n\t}\r\n\r\n\tpublic makeSurveyLauncher(survey: Api.ISurvey): Api.ISurveyLauncher {\r\n\t\tif (isNOU(survey)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tswitch (survey.getLauncherType().toLocaleLowerCase()) {\r\n\t\t\tcase GenericMessagingLauncherFactory.COACHINGUX_LAUNCHER_TYPE:\r\n\t\t\tcase GenericMessagingLauncherFactory.DIALOG_LAUNCHER_TYPE:\r\n\t\t\t\treturn this.makeGenericMessagingSurfaceLauncher(survey);\r\n\t\t\tcase RudeSurveyLauncherFactory.LAUNCHER_TYPE:\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.makeRudeSurveyLauncher(survey);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic AcceptsSurvey(survey: Api.ISurvey): boolean {\r\n\t\tif (isNOU(survey)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tswitch (survey.getType()) {\r\n\t\t\tcase Api.SurveyType.Dialog:\r\n\t\t\tcase Api.SurveyType.GenericMessagingSurface:\r\n\t\t\t\treturn (Configuration.get().checkIfMessagingEnabled() &&\r\n\t\t\t\t\t\t!isNOU(this.genericMessagingLauncherFactory) &&\r\n\t\t\t\t\t\tthis.genericMessagingLauncherFactory.AcceptsSurvey(survey));\r\n\t\t\tdefault:\r\n\t\t\t\treturn Configuration.get().checkIfSurveysEnabled() &&\r\n\t\t\t\t\t!isNOU(this.rudeSurveyLauncherFactory) &&\r\n\t\t\t\t\tthis.rudeSurveyLauncherFactory.AcceptsSurvey(survey);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate makeGenericMessagingSurfaceLauncher(survey: Api.ISurvey): Api.ISurveyLauncher {\r\n\t\tif (!isNOU(this.genericMessagingLauncherFactory)) {\r\n\t\t\treturn this.genericMessagingLauncherFactory.makeSurveyLauncher(survey);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate makeRudeSurveyLauncher(survey: Api.ISurvey): Api.ISurveyLauncher {\r\n\t\tif (!isNOU(this.rudeSurveyLauncherFactory)) {\r\n\t\t\treturn this.rudeSurveyLauncherFactory.makeSurveyLauncher(survey);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n}\r\n", "/**\r\n * CoachingUX launcher factory for Web SDK\r\n */\r\nimport { Api, ISurveyParams } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { SettingKey, getDynamicSetting } from \"@ms-ofb/officepersonalization/dist/lib/Configuration/DynamicConfiguration\";\r\n\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport * as Constants from \"../Constants\";\r\nimport * as Logging from \"../Logging/Logging\";\r\nimport * as AssetsProvider from \"../TargetedMessaging/AssetsProvider\";\r\nimport * as DomUtils from \"../Window/DomUtils\";\r\nimport * as Window from \"../Window/Window\";\r\n\r\nimport { IInitOptionsCommon } from \"../Configuration/Configuration\";\r\nimport { isNOU } from \"../Utils\";\r\n\r\nexport interface IBeaconParameters {\r\n\tactionName: string;\r\n\tactionUrl: string;\r\n}\r\n\r\nexport interface IOfficeWebSurfaces {\r\n\tInitialize(intOptions: IInitOptionsCommon): void;\r\n\tRenderSurface(\r\n\t\tsurfaceParams: any,\r\n\t\ttargetElementId?: string,\r\n\t\tsurfaceId?: string): void;\r\n\tRemoveSurface(): void;\r\n\tGetSurfaceContainerId(): string;\r\n}\r\n\r\ndeclare module \"../Window/Window\" {\r\n\tinterface IWindow {\r\n\t\tOfficeWebSurfaces: IOfficeWebSurfaces;\r\n\t}\r\n}\r\n\r\nfunction getFirstCalendarDateOfWeek(input?: Date): Date {\r\n\tconst inputDate = input ?? new Date();\r\n    const day = inputDate.getDay();\r\n\tinputDate.setHours(-24 * day); \r\n\treturn inputDate;\r\n}\r\n\r\n// returns a checksum with year, month and first day of week - eg: 2023-4-16\r\nexport function getWeeklyDateStamp(inputDate?: Date): string {\r\n\tconst firstDateOfweek = getFirstCalendarDateOfWeek(inputDate);\r\n\treturn `${firstDateOfweek.getFullYear()}-${firstDateOfweek.getMonth()+1}-${firstDateOfweek.getDate()}`;\r\n}\r\n\r\nexport function getWebSurfacesLink(timeStampDate?: Date) {\r\n\tconst internalEnvs = [\"dogfood\", \"edog\", \"int\", \"microsoft\"];\r\n\tconst commonInitOptions = Configuration.get().getCommonInitOptions();\r\n\tconst audience = commonInitOptions.telemetryGroup?.audienceGroup || commonInitOptions.telemetryGroup?.audience;\r\n\tconst isInternalEnv = audience && internalEnvs.indexOf(audience.toLowerCase()) !== -1;\r\n\tconst webSurfacesConfigLink = isInternalEnv ?\r\n\t\tcommonInitOptions.webSurfacesSettings?.webSurfacesIntUrl : commonInitOptions.webSurfacesSettings?.webSurfacesProdUrl;\r\n\tconst webSurfacesDefaultLink = isInternalEnv ?\r\n\t\tConstants.DynamicScriptUrls.WebSurfacesIntLink : Constants.DynamicScriptUrls.WebSurfacesProdLink;\r\n\tconst settingKey = isInternalEnv ? SettingKey.webSurfacesIntLink : SettingKey.webSurfacesProdLink;\r\n\tconst webSurfacesLink = webSurfacesConfigLink || getDynamicSetting(settingKey, webSurfacesDefaultLink);\r\n\r\n\tconst weekDateStamp = getWeeklyDateStamp(timeStampDate);\r\n\treturn `${webSurfacesLink}?wds=${weekDateStamp}`;\r\n}\r\n\r\n// web surfaces script url load promise\r\nlet WebSurfacesScriptPromise: Promise<void>;\r\nfunction createwebSurfacesScriptPromise() {\r\n\tif (!WebSurfacesScriptPromise) {\r\n\t\tWebSurfacesScriptPromise = DomUtils.loadScript(getWebSurfacesLink(), null);\r\n\t}\r\n}\r\n\r\nexport default class GenericMessagingLauncherFactory implements Api.ISurveyLauncherFactory {\r\n\tpublic static readonly COACHINGUX_LAUNCHER_TYPE: string = \"coachingux\";\r\n\tpublic static readonly DIALOG_LAUNCHER_TYPE: string = \"dialog\";\r\n\r\n\tpublic static readonly SUPPORTED_SURVEY_TYPES: Api.SurveyType[] = [Api.SurveyType.GenericMessagingSurface, Api.SurveyType.Dialog];\r\n\r\n\tpublic static readonly SUPPORTED_LAUNCHER_TYPE: string[] = [\r\n\t\tGenericMessagingLauncherFactory.COACHINGUX_LAUNCHER_TYPE,\r\n\t\tGenericMessagingLauncherFactory.DIALOG_LAUNCHER_TYPE,\r\n\t];\r\n\r\n\tpublic makeSurveyLauncher(survey: Api.ISurvey): Api.ISurveyLauncher {\r\n\t\tif (this.AcceptsSurvey(survey)) {\r\n\t\t\tswitch (survey.getLauncherType().toLocaleLowerCase()) {\r\n\t\t\t\tcase GenericMessagingLauncherFactory.COACHINGUX_LAUNCHER_TYPE:\r\n\t\t\t\tcase GenericMessagingLauncherFactory.DIALOG_LAUNCHER_TYPE:\r\n\t\t\t\t\treturn new CoachingUXLauncher(survey);\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\"Unsupported launcher type: \" + survey.getLauncherType());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic AcceptsSurvey(survey: Api.ISurvey): boolean {\r\n\t\tif (!isNOU(survey) && GenericMessagingLauncherFactory.SUPPORTED_SURVEY_TYPES.includes(survey.getType()) &&\r\n\t\t\tGenericMessagingLauncherFactory.SUPPORTED_LAUNCHER_TYPE.includes(survey.getLauncherType().toLocaleLowerCase())) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport class CoachingUXLauncher implements Api.ISurveyLauncher {\r\n\tprivate survey: Api.ISurvey;\r\n\r\n\tconstructor(survey: Api.ISurvey) {\r\n\t\tthis.survey = survey;\r\n\r\n\t\t// pre-load web surface package if there are any critical campaigns\r\n\t\tif (!WebSurfacesScriptPromise &&\r\n\t\t\tsurvey && survey.getSurveyInfo &&\r\n\t\t\tsurvey.getSurveyInfo()?.getBusinessLevel() === Api.SurveyInfoBusinessLevel.Critical) {\r\n\t\t\tsetTimeout(createwebSurfacesScriptPromise, 1000);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic launch(surveyParams?: ISurveyParams): void {\r\n\r\n\t\tif (this.survey.getLauncherType() != GenericMessagingLauncherFactory.COACHINGUX_LAUNCHER_TYPE) {\r\n\t\t\tthrow new Error(`Invalid launcher type: '${this.survey.getLauncherType()}'. \r\n\t\t\t\tSupported launcher type is: '${GenericMessagingLauncherFactory.COACHINGUX_LAUNCHER_TYPE}'.`);\r\n\t\t}\r\n\r\n\t\tconst surveyInfo = this.survey && this.survey.getSurveyInfo();\r\n\t\tconst surveyMetadata = surveyInfo && surveyInfo.getMetadata();\r\n\t\tconst treatmentType = surveyInfo && surveyInfo.getTreatmentType();\r\n\t\tconst contentMetadata = surveyMetadata && surveyMetadata.getContentMetadata();\r\n\t\tif (!contentMetadata) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst startTime = new Date();\r\n\t\tconst getWebSurfacesInstance = () => {\r\n\t\t\tconst windowInstance = Window.getGlobal();\r\n\t\t\treturn windowInstance && windowInstance.OfficeWebSurfaces;\r\n\t\t};\r\n\r\n\t\tconst renderWebSurface = (uxInitOptions?: any) => {\r\n\t\t\tconst officeWebSurfaces = getWebSurfacesInstance();\r\n\t\t\tif (uxInitOptions) {\r\n\t\t\t\tofficeWebSurfaces.Initialize(uxInitOptions);\r\n\t\t\t}\r\n\r\n\t\t\tofficeWebSurfaces.RemoveSurface();\r\n\r\n\t\t\tconst surfaceParams = {\r\n\t\t\t\t...contentMetadata,\r\n\t\t\t\tsurfaceContext: {\r\n\t\t\t\t\tsurveyForm: this.survey,\r\n\t\t\t\t\tsurveyParams,\r\n\t\t\t\t},\r\n\t\t\t\ttreatmentType: treatmentType,\r\n\t\t\t};\r\n\t\t\tofficeWebSurfaces.RenderSurface(\r\n\t\t\t\tsurfaceParams,\r\n\t\t\t\tnull /* targetElementId */,\r\n\t\t\t\tsurveyInfo.getBackEndId());\r\n\t\t};\r\n\r\n\t\tconst logErrorEvent = (error?: Error) => {\r\n\t\t\tLogging.getLogger().logEvent(\r\n\t\t\t\tLogging.EventIds.WebSurfaces.Common.Error.VALUE,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: \"Error loading websurfaces\" + (error && error.message ? \": \" + error.message : \"\"),\r\n\t\t\t\t\tTimeMilliseconds: Date.now() - (+startTime),\r\n\t\t\t\t});\r\n\t\t};\r\n\r\n\t\ttry {\r\n\t\t\tif (getWebSurfacesInstance()) {\r\n\t\t\t\trenderWebSurface();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcreatewebSurfacesScriptPromise();\r\n\r\n\t\t\t// if UX package isn't already loaded, download package and render surface\r\n\t\t\tWebSurfacesScriptPromise\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tconst initOptions = Configuration.get().getCommonInitOptions();\r\n\t\t\t\t\tconst floodgateInitOptions = Configuration.get().getFloodgateInitOptions();\r\n\t\t\t\t\tconst surveyActivatedCallback = floodgateInitOptions && floodgateInitOptions.onSurveyActivatedCallback;\r\n\r\n\t\t\t\t\tconst beaconCallback = (beaconParameters: IBeaconParameters): Promise<boolean> => {\r\n\t\t\t\t\t\tif (beaconParameters) {\r\n\t\t\t\t\t\t\treturn AssetsProvider.get().setCampaignAction(beaconParameters);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst uxOptions = {\r\n\t\t\t\t\t\t...initOptions,\r\n\t\t\t\t\t\t...floodgateInitOptions,\r\n\t\t\t\t\t\tbeaconCallback,\r\n\t\t\t\t\t\tsurfaceInitTime: startTime,\r\n\t\t\t\t\t\tsurfaceId: surveyInfo.getBackEndId(),\r\n\t\t\t\t\t\tlogSessionId: Configuration.get().getSdkSessionId(),\r\n\t\t\t\t\t\tlogSettings: getDynamicSetting(SettingKey.logLevelSettings, undefined),\r\n\t\t\t\t\t\trenderer: surveyActivatedCallback,\r\n\t\t\t\t\t\trenderCallback: surveyActivatedCallback && surveyActivatedCallback.onTeachingCampaignRender,\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\trenderWebSurface(uxOptions);\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\tlogErrorEvent(error);\r\n\t\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tlogErrorEvent(error);\r\n\t\t}\r\n\t}\r\n}\r\n", "/*\r\n * UrlUtils.ts\r\n */\r\n\r\nexport interface IQueryParams {\r\n\t[key: string]: any;\r\n}\r\n\r\nexport function buildQueryParameters(keyAndValues: IQueryParams, encodeValueAsURI = true): string {\r\n\tlet queryParamsString = \"\";\r\n\tfor (const key in keyAndValues || []) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(keyAndValues, key)) {\r\n\t\t\tconst value = keyAndValues[key];\r\n\t\t\tif (value !== null && value !== undefined && typeof value !== \"object\") {\r\n\t\t\t\tconst prefix = !queryParamsString ? \"\" : \"&\";\r\n\t\t\t\tconst encodedValue = encodeValueAsURI ? encodeURIComponent(value) : value;\r\n\t\t\t\tconst queryParamItem = `${key}=${encodedValue}`;\r\n\t\t\t\tqueryParamsString += prefix + queryParamItem;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn queryParamsString;\r\n}\r\n", "export const CACHE_EXPIRY_MESSAGEMETADATA = 14400000; // expiry in ms - 4hrs\r\nexport const CACHE_EXPIRY_USERGOVERNANCERULES = 14400000; // expiry in ms - 4hrs\r\nexport const CACHE_EXPIRY_CAMPAIGNCONTENT = 14400000; // expiry in ms - 4hrs\r\nexport const CACHE_EXPIRY_DYNAMICSETTINGS = 14400000; // expiry in ms - 4hrs\r\nexport const CACHE_EXPIRY_LOGLEVELSETTINGS = 14400000; // expiry in ms - 4hrs\r\nexport const CACHE_EXPIRY_USERFACTS = 86400000; // expiry in ms - 24hrs\r\n\r\nexport const TMS_CAMPAIGNMETADATAAGGREGATOR_ENDPOINT = \"campaignmetadataaggregator\";\r\nexport const TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_EDOG = \"https://messaging.engagement.office.com/\";\r\nexport const TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_PROD = \"https://messaging.engagement.office.com/\";\r\n\r\nexport const TMS_CAMPAIGN_LOAD_TIMEOUT = 3000;\r\n\r\nexport const TMS_FETCH_TIMEOUT = 5000; // timeout for fetching tms service requests\r\n\r\nexport const TMS_SETCAMPAIGNACTION_ENDPOINT = \"setcampaignaction\";\r\nexport const TMS_SETCAMPAIGNACTION_PREFIX_EDOG = \"https://messaging.action.office.com/\";\r\nexport const TMS_SETCAMPAIGNACTION_PREFIX_PROD = \"https://messaging.action.office.com/\";\r\n\r\nexport const TULIPS_SERVICEURL =\r\n\t\"https://substrate.office.com/OfficePersonalizationUserLifecycle/api/facts\";\r\n\r\nexport const TULIPS_LOAD_TIMEOUT = 3000;\r\n\r\nexport const TULIPS_FETCH_TIMEOUT = 5000; // timeout for fetching tulips service requests\r\n\r\nexport const TULIPS_INGESTION_TIME = 24 * 60 * 60 * 1000; // Tulips ingestion time\r\n\r\nexport const AUGLOOP_INIT_CHECK_RETRY_TIMES = 5;\r\n\r\n/**\r\n * Constant GUIDs\r\n */\r\nexport class GUIDs {\r\n\tpublic static TMSAppID = \"4c4f550b-42b2-4a16-93f9-fdb9e01bb6ed\";\r\n\tpublic static TULIPSSubstrateAppID = \"05c88d91-956e-46b4-91b0-77a33cc21a4d\";\r\n}\r\n", "import { ContentType } from \"./ContentType\";\r\n\r\nexport class ContentResponse {\r\n\tpublic contentType: ContentType;\r\n\tpublic content: any;\r\n}\r\n", "import {\r\n\tICampaignDefinition,\r\n\tIFloodgateAuthTokenCallback,\r\n\tIMessageSpec,\r\n} from \"@ms-ofb/floodgate-shared-typings\";\r\n\r\nimport { AgeGroup, AuthenticationType, IBeaconParameters, IMessagingServiceSettings, IUserFact } from \"../Common/Models\";\r\n\r\nimport { ContentType, ContentTypeToStorageKeyMap } from \"../Common/ContentType\";\r\nimport {addClientIngestionTimeAndNormalizeKeys} from \"../Facts/UserFactsClient\";\r\nimport * as Caching from \"../Utils/Caching\";\r\nimport * as Storage from \"../Utils/Storage\";\r\nimport * as Transport from \"../Utils/Transport\";\r\n\r\nimport { buildQueryParameters, IQueryParams } from \"../Utils/UrlUtils\";\r\n\r\nimport * as Logging from \"../Logging/Logger\";\r\nimport * as TmsgConstants from \"./TargetedMessagingConstants\";\r\n\r\nimport { getDynamicSetting, SettingKey } from \"../Configuration/DynamicConfiguration\";\r\n\r\nimport { ContentResponse } from \"../Common/ContentResponse\";\r\nimport { EventIds, ICustomProperties } from \"../Logging/Constants\";\r\nimport { IAuthTokenConfig } from \"@ms-ofb/floodgate-shared-typings/dist/src/Core/Api/IFloodgateAuthTokenCallback\";\r\nimport { getUserFactList, getUserFacts } from \"../Facts/UserFacts\";\r\nimport { getSamplingRate } from \"../Common/Settings\";\r\nimport { mergeLocalUserFacts } from \"../Facts/CachedUserFacts\";\r\nimport { getErrorMessage } from \"../Utils/Utils\";\r\n\r\ninterface ITmsServiceResponse {\r\n\tMessageMetadata: IMessageSpec;\r\n\tUserGovernanceRules: any;\r\n\tCampaignContent: any;\r\n\tDynamicSettings: any;\r\n\tLogLevelSettings: ILogLevelSettings;\r\n}\r\n\r\nconst enum LogLevel {\r\n\tNone,\r\n\tCritical,\r\n\tError,\r\n\tInfo,\r\n}\r\n\r\ninterface ILogLevelSettings {\r\n\tlogLevel: LogLevel;\r\n}\r\n\r\ninterface IDebugOverrides {\r\n\taddTmsQueryParams?: Record<string, string>;\r\n\treplaceTmsQueryParams?: Record<string, string>;\r\n\ttmsResponse?: ITmsServiceResponse;\r\n\tuserFactsResponse?: ITmsServiceResponse;\r\n}\r\n\r\nexport function getDebugCampaignDefinitions(): ContentResponse {\r\n\tconst debugOverrides = Storage.readObjectFromStorage<IDebugOverrides>(\"obf-DebugOverrides\", {});\r\n\treturn debugOverrides && debugOverrides.tmsResponse && debugOverrides.tmsResponse.CampaignContent && {\r\n\t\tcontentType: ContentType.campaignContent,\r\n\t\tcontent: debugOverrides.tmsResponse.CampaignContent,\r\n\t};\r\n}\r\n\r\nexport function getDebugUserFacts(): ContentResponse {\r\n\tconst debugOverrides = Storage.readObjectFromStorage<IDebugOverrides>(\"obf-DebugOverrides\", {});\r\n\treturn debugOverrides && debugOverrides.userFactsResponse && {\r\n\t\tcontentType: ContentType.userFacts,\r\n\t\tcontent: debugOverrides.userFactsResponse,\r\n\t};\r\n}\r\n\r\nexport class TargetedMessagingClient {\r\n\tprivate locale = \"en-us\";\r\n\tprivate country = \"US\";\r\n\tprivate authTokenCallback: IFloodgateAuthTokenCallback;\r\n\tprivate app: string;\r\n\tprivate platform: string;\r\n\tprivate version: string;\r\n\tprivate packageVersion: string;\r\n\tprivate sessionId: string;\r\n\tprivate campaignFlights: string;\r\n\tprivate campaignParameters: string;\r\n\tprivate ageGroup: AgeGroup;\r\n\tprivate authType: AuthenticationType;\r\n\tprivate campaignMetadataAggregatorPrefix: string;\r\n\tprivate setCampaignActionPrefix: string;\r\n\tprivate messagingServiceSettings: IMessagingServiceSettings;\r\n\r\n\tconstructor(\r\n\t\tapp: string,\r\n\t\tplatform: string,\r\n\t\tversion: string,\r\n\t\tlocale: string,\r\n\t\tcountry: string,\r\n\t\tsessionId: string,\r\n\t\tauthTokenCallback: IFloodgateAuthTokenCallback,\r\n\t\tcampaignFlights?: string,\r\n\t\tcampaignParameters?: string,\r\n\t\tageGroup?: AgeGroup,\r\n\t\tauthType?: AuthenticationType,\r\n\t\taudience?: string,\r\n\t\tmessagingServiceSettings?: IMessagingServiceSettings,\r\n\t\tpackageVersion?: string,\r\n\t\t) {\r\n\t\tthis.locale = locale;\r\n\t\tthis.country = country;\r\n\t\tthis.authTokenCallback = authTokenCallback;\r\n\t\tthis.app = app;\r\n\t\tthis.platform = platform;\r\n\t\tthis.version = version;\r\n\t\tthis.packageVersion = packageVersion;\r\n\t\tthis.sessionId = sessionId;\r\n\t\tthis.campaignFlights = campaignFlights;\r\n\t\tthis.campaignParameters = campaignParameters;\r\n\t\tthis.ageGroup = ageGroup;\r\n\t\tthis.authType = authType;\r\n\t\tthis.messagingServiceSettings = messagingServiceSettings;\r\n\r\n\t\tconst internalEnvs = [\"dogfood\", \"edog\", \"int\", \"microsoft\"];\r\n\t\tconst isInternalEnv = audience && internalEnvs.indexOf(audience.toLowerCase()) !== -1;\r\n\t\tconst campaignMetadataAggregatorConfig = isInternalEnv ? this.messagingServiceSettings?.campaignMetadataAggregatorInt\r\n\t\t: this.messagingServiceSettings?.campaignMetadataAggregatorProd;\r\n\t\tconst setCampaignActionConfig = isInternalEnv ? this.messagingServiceSettings?.setCampaignActionInt\r\n\t\t: this.messagingServiceSettings?.setCampaignActionProd;\r\n\r\n\t\tconst cmaDefaultBaseUrlPrefix = isInternalEnv ? TmsgConstants.TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_EDOG\r\n\t\t: TmsgConstants.TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_PROD;\r\n\t\tconst scaDefaultBaseUrlPrefix = isInternalEnv ? TmsgConstants.TMS_SETCAMPAIGNACTION_PREFIX_EDOG\r\n\t\t: TmsgConstants.TMS_SETCAMPAIGNACTION_PREFIX_PROD;\r\n\r\n\t\tthis.campaignMetadataAggregatorPrefix = campaignMetadataAggregatorConfig || cmaDefaultBaseUrlPrefix;\r\n\t\tthis.setCampaignActionPrefix = setCampaignActionConfig || scaDefaultBaseUrlPrefix;\r\n\r\n\t\t// bind getAuthToken function to avoid losing context after passing the function as param\r\n\t\tthis.getAuthToken = this.getAuthToken.bind(this);\r\n\t}\r\n\r\n\tpublic async getContent(\r\n\t\trequestedContent: ContentType): Promise<ContentResponse> {\r\n\t\tif (Caching.isCachedTypeExpired(ContentTypeToStorageKeyMap[requestedContent])) {\r\n\t\t\tawait this.refreshItemsInCacheFromTmsService([requestedContent]);\r\n\t\t}\r\n\r\n\t\tconst response: ContentResponse = this.retrieveCacheItemAndCreateContentResponse(requestedContent);\r\n\t\treturn response;\r\n\t}\r\n\r\n\tpublic async getMultipleContents(\r\n\t\trequestedContent: ContentType[]): Promise<ContentResponse[]> {\r\n\t\tawait this.refreshItemsInCacheFromTmsService(requestedContent);\r\n\r\n\t\tconst contentResponses: ContentResponse[] = new Array<ContentResponse>();\r\n\t\tconst bulkRefreshList: ContentType[] = new Array<ContentType>();\r\n\t\tfor (const contentType of requestedContent) {\r\n\t\t\tconst responseItem = this.createCachedContentResponse(contentType);\r\n\t\t\tcontentResponses.push(responseItem);\r\n\t\t}\r\n\r\n\t\tthis.refreshItemsInCacheFromTmsService(bulkRefreshList);\r\n\r\n\t\treturn contentResponses;\r\n\t}\r\n\r\n\tpublic async getUserFactsContent(\r\n\t\trequestedContent: ContentType): Promise<ContentResponse> {\r\n\t\tawait this.refreshItemsInCacheFromSubstrateTulipsService(requestedContent);\r\n\t\tconst response: ContentResponse = this.retrieveCacheItemAndCreateContentResponse(requestedContent);\r\n\t\treturn response;\r\n\t}\r\n\r\n\tpublic async sendBeaconRequestToService(\r\n\t\tapp: string,\r\n\t\tbeaconParameters: IBeaconParameters,\r\n\t\tplatform: string,\r\n\t\tversion: string,\r\n\t\tlocale: string,\r\n\t\tcountry: string,\r\n\t\tsessionId: string,\r\n\t\tauthTokenCallback: IFloodgateAuthTokenCallback,\r\n\t\t): Promise<boolean> {\r\n\t\tthis.sessionId = sessionId;\r\n\t\tthis.authTokenCallback = authTokenCallback;\r\n\r\n\t\tconst authTokenConfig: IAuthTokenConfig = {\r\n\t\t\tscenario: 'TMS',\r\n\t\t\tappId: getDynamicSetting(SettingKey.tulipsAppId, TmsgConstants.GUIDs.TMSAppID)\r\n\t\t};\r\n\r\n\t\tconst authToken = await this.getAuthToken(authTokenConfig);\r\n\t\tlet puid: string;\r\n\t\tif (!authToken) {\r\n\t\t\tpuid = this.authTokenCallback.getUserPuid && await this.authTokenCallback.getUserPuid();\r\n\t\t}\r\n\r\n\t\tconst requestStartTime = +new Date();\r\n\t\ttry {\r\n\t\t\tconst tmsQueryParams: IQueryParams = {\r\n\t\t\t\tapp,\r\n\t\t\t\tcountry,\r\n\t\t\t\tlocale,\r\n\t\t\t\tplatform,\r\n\t\t\t\tpuid,\r\n\t\t\t\tversion,\r\n\t\t\t};\r\n\r\n\t\t\tconst requestBody = JSON.stringify({\r\n\t\t\t\tactionName: beaconParameters.actionName,\r\n\t\t\t\tactionUrl: beaconParameters.actionUrl,\r\n\t\t\t});\r\n\r\n\t\t\tconst header: Record<string, string> = {\r\n\t\t\t\t\"Content-Type\": \"application/json;charset=utf-8\",\r\n\t\t\t};\r\n\r\n\t\t\tconst response: Response = await this.sendRequest(\r\n\t\t\t\ttmsQueryParams,\r\n\t\t\t\tauthToken,\r\n\t\t\t\tSettingKey.tmsActionUrl,\r\n\t\t\t\tthis.setCampaignActionPrefix + TmsgConstants.TMS_SETCAMPAIGNACTION_ENDPOINT + \"?\",\r\n\t\t\t\theader,\r\n\t\t\t\trequestBody,\r\n\t\t\t\t\"POST\");\r\n\r\n\t\t\tif (!response || response.status !== 200) {\r\n\t\t\t\tLogging.getLogger().event(\r\n\t\t\t\t\tEventIds.SetCampaignActionError,\r\n\t\t\t\t\tthis.createTelemetryData(requestStartTime, response, `Beacon${beaconParameters.actionName}`) as Logging.ICustomLogData);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tLogging.getLogger().info(\r\n\t\t\t\tEventIds.SetCampaignActionRequests,\r\n\t\t\t\tthis.createTelemetryData(requestStartTime, response, `Beacon${beaconParameters.actionName}`), .01);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tLogging.getLogger().event(\r\n\t\t\t\tEventIds.SetCampaignActionError,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage:\r\n\t\t\t\t\t\t\"Error fetching from TMS SetCampaignAction endpoint:\" + getErrorMessage(error),\r\n\t\t\t\t\t...this.createTelemetryData(requestStartTime, null, `Beacon${beaconParameters.actionName}`),\r\n\t\t\t\t});\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async getTulipsServiceUserFactsContent(): Promise<IUserFact[]> {\r\n\t\treturn getUserFactList(null, this.getAuthToken);\r\n\t}\r\n\r\n\tprivate parseCampaignIdFromResponse(response: ICampaignDefinition[]): string {\r\n\t\tconst campaignIds: string[] = response?.map((campaign: any) => campaign.CampaignId);\r\n\t\treturn campaignIds?.toString();\r\n\t}\r\n\r\n\tprivate createTelemetryData(requestStartTimestamp: number, response: Response, type: string, campaignIds?: string): ICustomProperties {\r\n\t\tconst { headers, status, statusText } = response || {} as Response;\r\n\t\tconst serverSessionId = headers && headers.get(\"X-UserSessionId\");\r\n\t\tconst serverCorrelationId = headers && headers.get(\"X-CorrelationId\");\r\n\t\treturn {\r\n\t\t\tType: type,\r\n\t\t\tTimeMilliseconds: +new Date() - requestStartTimestamp,\r\n\t\t\tSessionId: serverSessionId || this.sessionId,\r\n\t\t\tCorrelationId: serverCorrelationId || undefined,\r\n\t\t\tHttpStatusCode: status || undefined,\r\n\t\t\tHttpStatusText: statusText || undefined,\r\n\r\n\t\t\tFlights: this.campaignFlights,\r\n\t\t\tCampaignId: campaignIds || undefined,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate sendRequest(\r\n\t\ttmsgQueryParams: IQueryParams,\r\n\t\tauthToken: string,\r\n\t\tkey: SettingKey,\r\n\t\tdefaultBaseUrl: string,\r\n\t\trequestHeaders?: Record<string, string>,\r\n\t\trequestBody?: string,\r\n\t\tverb?: string): Promise<Response> {\r\n\t\tconst queryParamStr = buildQueryParameters(tmsgQueryParams);\r\n\t\tconst tmsgBaseUrl = getDynamicSetting(key, defaultBaseUrl);\r\n\t\tconst requestPromise = verb === \"POST\" ?\r\n\t\t\tTransport.sendPostRequest(tmsgBaseUrl + queryParamStr, requestBody, authToken, requestHeaders, this.sessionId) :\r\n\t\t\tTransport.sendGetRequest(tmsgBaseUrl + queryParamStr, authToken, this.sessionId);\r\n\t\treturn requestPromise;\r\n\t}\r\n\r\n\tprivate retrieveCacheItemAndCreateContentResponse(contentType: ContentType): ContentResponse {\r\n\t\tconst responseItem: ContentResponse = this.createCachedContentResponse(contentType);\r\n\t\tif (Caching.isCachedTypeExpired(ContentTypeToStorageKeyMap[contentType])) {\r\n\t\t\tif (contentType === ContentType.userFacts) {\r\n\t\t\t\tthis.refreshItemsInCacheFromSubstrateTulipsService(contentType);\r\n\t\t\t} else {\r\n\t\t\t\tthis.refreshItemsInCacheFromTmsService([contentType]);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse { // cache is not expired\r\n\t\t\tif (contentType === ContentType.campaignContent) {\r\n\t\t\t\tLogging.getLogger().event(\r\n\t\t\t\t\tEventIds.CampaignRetrievedCache, { campaignIds: this.parseCampaignIdFromResponse(responseItem?.content?.campaigns) }, getSamplingRate());\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn responseItem;\r\n\t}\r\n\r\n\tprivate createCachedContentResponse(requestedContent: ContentType): ContentResponse {\r\n\t\tconst contentResponse: ContentResponse = new ContentResponse();\r\n\t\tcontentResponse.content = Caching.getCachedContent(ContentTypeToStorageKeyMap[requestedContent]);\r\n\t\tcontentResponse.contentType = requestedContent;\r\n\r\n\t\treturn contentResponse;\r\n\t}\r\n\r\n\tprivate async getAuthToken(authTokenConfig: IAuthTokenConfig): Promise<string> {\r\n\t\tif (!this.authTokenCallback || !this.authTokenCallback.getAuthToken || !authTokenConfig) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst startTime = +new Date();\r\n\t\tconst getDuration = () => +new Date() - startTime;\r\n\t\tconst samplingRate = getSamplingRate();\r\n\r\n\t\tconst createAuthTelemetryLogData = (message: string, tokenLength = -1): Logging.ICustomLogData => {\r\n\t\t\treturn {\r\n\t\t\t\tMessage: message,\r\n\t\t\t\tSamplingRate: samplingRate,\r\n\t\t\t\tScenario: authTokenConfig.scenario,\r\n\t\t\t\tSessionId: this.sessionId,\r\n\t\t\t\tTimeMilliseconds: getDuration(),\r\n\t\t\t\tTokenLegth: tokenLength,\r\n\t\t\t\tType: authTokenConfig.appId,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst retVal = await this.authTokenCallback.getAuthToken(authTokenConfig);\r\n\t\t\tLogging.getLogger().event(\r\n\t\t\t\tEventIds.EngagementAuthSuccessful,\r\n\t\t\t\tcreateAuthTelemetryLogData(\"getAuthToken Successful\", retVal?.length), samplingRate);\r\n\r\n\t\t\treturn retVal;\r\n\t\t} catch (error) {\r\n\t\t\tLogging.getLogger().event(\r\n\t\t\t\tEventIds.EngagementAuthError,\r\n\t\t\t\tcreateAuthTelemetryLogData(\"Error getting token:\" + getErrorMessage(error))\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate async refreshItemsInCacheFromTmsService(contentTypes: ContentType[]): Promise<void> {\r\n\t\tif (contentTypes.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// check if touched items are actually due for refresh or are still valid\r\n\t\tconst bulkRefreshList: ContentType[] = new Array<ContentType>();\r\n\t\tfor (const contentType of contentTypes) {\r\n\t\t\tif (Caching.isCachedTypeExpired(ContentTypeToStorageKeyMap[contentType])) {\r\n\t\t\t\tbulkRefreshList.push(contentType);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (bulkRefreshList.length === 0) {\r\n\t\t\t// exit out if all items in cache are still valid to avoid unnecessary service roundtrips\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// always request for dynamic settings\r\n\t\tif (contentTypes.indexOf(ContentType.dynamicSettings) === -1) {\r\n\t\t\tcontentTypes.push(ContentType.dynamicSettings);\r\n\t\t}\r\n\r\n\t\t// get auth token or user id\r\n\t\tconst authTokenConfig: IAuthTokenConfig = {\r\n\t\t\tscenario: 'TMS',\r\n\t\t\tappId: getDynamicSetting(SettingKey.tulipsAppId, TmsgConstants.GUIDs.TMSAppID)\r\n\t\t};\r\n\r\n\t\tconst authToken = await this.getAuthToken(authTokenConfig);\r\n\t\tlet userPuid: string;\r\n\t\tif (!authToken) {\r\n\t\t\tuserPuid = this.authTokenCallback.getUserPuid && await this.authTokenCallback.getUserPuid();\r\n\t\t}\r\n\r\n\t\tconst requestStartTime = +new Date();\r\n\r\n\t\t// make service call for expired or uncached items\r\n\t\ttry {\r\n\t\t\t// capture browser data to perform additional filters on IRIS\r\n\t\t\t// this is to avoid showing bad UI experience on unsupported browsers/dimensions\r\n\t\t\tconst documentElement = document && (document.documentElement || document.getElementsByTagName(\"body\")[0]);\r\n\t\t\tconst browserParams: IQueryParams = {\r\n\t\t\t\tpageWidth: window.innerWidth || documentElement.clientWidth,\r\n\t\t\t\tpageHeight: window.innerHeight || documentElement.clientHeight,\r\n\t\t\t\tscreenWidth: screen ? screen.width : undefined,\r\n\t\t\t\tscreenHeight: screen ? screen.height : undefined,\r\n\t\t\t\tcolorDepth: screen ? screen.colorDepth : undefined,\r\n\t\t\t};\r\n\r\n\t\t\t// allow testing with query param overrides with key obf-DebugOverrides\r\n\t\t\t// eg: {\"addTmsQueryParams\":{\"key1\":\"key1value\"},\"replaceTmsQueryParams\":{\"key2\":\"key2value\"}, \"tmsResponse\": {}}\r\n\t\t\tconst debugOverrides = Storage.readObjectFromStorage<IDebugOverrides>(\"obf-DebugOverrides\", {});\r\n\t\t\tconst tmsQueryParams: IQueryParams = debugOverrides.replaceTmsQueryParams || {\r\n\t\t\t\tcountry: this.country,\r\n\t\t\t\tlocale: this.locale,\r\n\t\t\t\tapp: this.app,\r\n\t\t\t\tplatform: this.platform,\r\n\t\t\t\tversion: this.version,\r\n\t\t\t\tcampaignParams: buildQueryParameters(browserParams) + \"&more=true&\" + (this.campaignParameters || \"\"),\r\n\t\t\t\tcontentType: contentTypes.join(\";\"),\r\n\t\t\t\tpuid: userPuid,\r\n\t\t\t\tOFC_FLIGHTS: this.campaignFlights,\r\n\t\t\t\t...(debugOverrides.addTmsQueryParams || {}),\r\n\t\t\t\tageGroup: this.ageGroup,\r\n\t\t\t\tsessionUserType: this.authType,\r\n\t\t\t\tpackageVersion: this.packageVersion,\r\n\t\t\t};\r\n\r\n\t\t\tconst response: Response = await this.sendRequest(\r\n\t\t\t\ttmsQueryParams,\r\n\t\t\t\tauthToken,\r\n\t\t\t\tSettingKey.tmsServiceUrl,\r\n\t\t\t\tthis.campaignMetadataAggregatorPrefix + TmsgConstants.TMS_CAMPAIGNMETADATAAGGREGATOR_ENDPOINT + \"?\");\r\n\t\t\tif (response.status === 200) {\r\n\t\t\t\tconst tmsServiceResponse: ITmsServiceResponse = await response.json();\r\n\r\n\t\t\t\tif (contentTypes.indexOf(ContentType.messageMetadata) !== -1\r\n\t\t\t\t\t&& tmsServiceResponse.MessageMetadata !== undefined) {\r\n\t\t\t\t\tCaching.saveToCache(\r\n\t\t\t\t\t\tContentType.messageMetadata,\r\n\t\t\t\t\t\ttmsServiceResponse.MessageMetadata,\r\n\t\t\t\t\t\tgetDynamicSetting(SettingKey.tmsMessageMetadataExpiry, TmsgConstants.CACHE_EXPIRY_MESSAGEMETADATA),\r\n\t\t\t\t\t\tContentTypeToStorageKeyMap[ContentType.messageMetadata]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (contentTypes.indexOf(ContentType.userGovernanceRules) !== -1\r\n\t\t\t\t\t&& tmsServiceResponse.UserGovernanceRules !== undefined) {\r\n\t\t\t\t\tCaching.saveToCache(\r\n\t\t\t\t\t\tContentType.userGovernanceRules,\r\n\t\t\t\t\t\ttmsServiceResponse.UserGovernanceRules,\r\n\t\t\t\t\t\tgetDynamicSetting(SettingKey.tmsUserGovernanceRulesExpiry, TmsgConstants.CACHE_EXPIRY_USERGOVERNANCERULES),\r\n\t\t\t\t\t\tContentTypeToStorageKeyMap[ContentType.userGovernanceRules]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (contentTypes.indexOf(ContentType.campaignContent) !== -1\r\n\t\t\t\t\t&& tmsServiceResponse.CampaignContent !== undefined) {\r\n\t\t\t\t\tCaching.saveToCache(\r\n\t\t\t\t\t\tContentType.campaignContent,\r\n\t\t\t\t\t\ttmsServiceResponse.CampaignContent,\r\n\t\t\t\t\t\tgetDynamicSetting(SettingKey.tmsCampaignContentExpiry, TmsgConstants.CACHE_EXPIRY_CAMPAIGNCONTENT),\r\n\t\t\t\t\t\tContentTypeToStorageKeyMap[ContentType.campaignContent]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// There is no explicit request for the next set of ContentTypes in the code\r\n\t\t\t\t// If the server responds with these types save and use them later\r\n\t\t\t\tif (tmsServiceResponse.DynamicSettings !== undefined) {\r\n\t\t\t\t\tCaching.saveToCache(\r\n\t\t\t\t\t\tContentType.dynamicSettings,\r\n\t\t\t\t\t\ttmsServiceResponse.DynamicSettings,\r\n\t\t\t\t\t\tgetDynamicSetting(SettingKey.tmsDynamicSettingsExpiry, TmsgConstants.CACHE_EXPIRY_DYNAMICSETTINGS),\r\n\t\t\t\t\t\tContentTypeToStorageKeyMap[ContentType.dynamicSettings]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tmsServiceResponse.LogLevelSettings !== undefined) {\r\n\t\t\t\t\tCaching.saveToCache(\r\n\t\t\t\t\t\tContentType.logLevelSettings,\r\n\t\t\t\t\t\ttmsServiceResponse.LogLevelSettings,\r\n\t\t\t\t\t\tgetDynamicSetting(SettingKey.tmsLogLevelSettingsExpiry, TmsgConstants.CACHE_EXPIRY_LOGLEVELSETTINGS),\r\n\t\t\t\t\t\tContentTypeToStorageKeyMap[ContentType.logLevelSettings]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tLogging.getLogger().event(\r\n\t\t\t\t\tEventIds.CampaignMetadataAggregatorRequests,\r\n\t\t\t\t\tthis.createTelemetryData(requestStartTime, response, contentTypes.join(\";\"), \r\n\t\t\t\t\t\tthis.parseCampaignIdFromResponse(tmsServiceResponse?.CampaignContent?.campaigns)) as Logging.ICustomLogData,\r\n\t\t\t\t\t0.01);\r\n\t\t\t} else {\r\n\t\t\t\tLogging.getLogger().event(\r\n\t\t\t\t\tEventIds.CampaignMetadataAggregatorError,\r\n\t\t\t\t\tthis.createTelemetryData(requestStartTime, response, contentTypes.join(\";\")) as Logging.ICustomLogData);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tLogging.getLogger().event(\r\n\t\t\t\tEventIds.CampaignMetadataAggregatorError,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: \"Error fetching from TMS:\" + getErrorMessage(error),\r\n\t\t\t\t\t...this.createTelemetryData(requestStartTime, null, contentTypes.join(\";\")),\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async refreshItemsInCacheFromSubstrateTulipsService(contentType: ContentType): Promise<void> {\r\n\t\t// check if touched item is actually due for refresh or is still valid\r\n\t\tif (!Caching.isCachedTypeExpired(ContentTypeToStorageKeyMap[contentType])) {\r\n\t\t\t// exit out if the cache is still valid to avoid unnecessary service roundtrips\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst authTokenConfig: IAuthTokenConfig = {\r\n\t\t\tscenario: 'TulipsSubstrate',\r\n\t\t\tappId: getDynamicSetting(SettingKey.tulipsAppId, TmsgConstants.GUIDs.TULIPSSubstrateAppID)\r\n\t\t};\r\n\r\n\t\tconst authToken = await this.getAuthToken(authTokenConfig);\r\n\t\tif (!authToken) {\r\n\t\t\t// if authToken is null then exit out since service call cannot be made without authToken\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst requestStartTime = +new Date();\r\n\r\n\t\t// make service call for expired or uncached item\r\n\t\ttry {\r\n\t\t\tconst response: Response = await this.sendRequest(\r\n\t\t\t\t{},\r\n\t\t\t\tauthToken,\r\n\t\t\t\tSettingKey.tulipsServiceUrl,\r\n\t\t\t\tTmsgConstants.TULIPS_SERVICEURL);\r\n\t\t\tif (response.status === 200 || response.status === 204) {\r\n\t\t\t\tconst tulipsServiceResponse = await response.json();\r\n\r\n\t\t\t\tif (contentType.indexOf(ContentType.userFacts) !== -1\r\n\t\t\t\t\t&& tulipsServiceResponse !== undefined) {\r\n\t\t\t\t\tconst normalizedUserFacts = addClientIngestionTimeAndNormalizeKeys(tulipsServiceResponse);\r\n\t\t\t\t\tCaching.saveToCache(\r\n\t\t\t\t\t\t\tContentType.userFacts,\r\n\t\t\t\t\t\t\tnormalizedUserFacts,\r\n\t\t\t\t\t\t\tTmsgConstants.CACHE_EXPIRY_USERFACTS,\r\n\t\t\t\t\t\t\tContentTypeToStorageKeyMap[ContentType.userFacts]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tLogging.getLogger().event(\r\n\t\t\t\t\tEventIds.UserFactsMessagingRequests,\r\n\t\t\t\t\tthis.createTelemetryData(requestStartTime, response, contentType) as Logging.ICustomLogData, .01);\r\n\t\t\t} else {\r\n\t\t\t\tLogging.getLogger().event(\r\n\t\t\t\t\tEventIds.UserFactsCommonError,\r\n\t\t\t\t\tthis.createTelemetryData(requestStartTime, response, contentType) as Logging.ICustomLogData);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tLogging.getLogger().event(\r\n\t\t\t\tEventIds.UserFactsCommonError,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: \"Error fetching from TULIPS:\" + getErrorMessage(error),\r\n\t\t\t\t\t...this.createTelemetryData(requestStartTime, null, contentType),\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n", "/**\r\n * Module that provides campaign definitions,\r\n * governance rules & message metadata from\r\n * targeted messaging service.\r\n */\r\n\r\nimport { Api, ICampaignDefinitions } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { MessageSpec } from \"@ms-ofb/officefloodgatecore/dist/src/Governance/MessageMetadata\";\r\nimport { UserGovernanceRules } from \"@ms-ofb/officefloodgatecore/dist/src/Governance/UserGovernanceRules\";\r\n\r\nimport { ContentResponse } from \"@ms-ofb/officepersonalization/dist/lib/Common/ContentResponse\";\r\nimport { ContentType } from \"@ms-ofb/officepersonalization/dist/lib/Common/ContentType\";\r\nimport { IUserFact } from \"@ms-ofb/officepersonalization/dist/lib/Common/Models\";\r\nimport { getDynamicSetting, SettingKey } from \"@ms-ofb/officepersonalization/dist/lib/Configuration/DynamicConfiguration\";\r\nimport { setLogger } from \"@ms-ofb/officepersonalization/dist/lib/Logging/Logger\";\r\nimport { \r\n\tgetDebugCampaignDefinitions, \r\n\tgetDebugUserFacts, \r\n\tTargetedMessagingClient \r\n} from \"@ms-ofb/officepersonalization/dist/lib/TargetedMessaging/TargetedMessagingClient\";\r\nimport { TULIPS_LOAD_TIMEOUT } from \"@ms-ofb/officepersonalization/dist/lib/TargetedMessaging/TargetedMessagingConstants\";\r\nimport { getCachedContent } from \"@ms-ofb/officepersonalization/dist/lib/Utils/Caching\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport { IBeaconParameters } from \"../FloodgateCore/GenericMessagingLauncherFactory\";\r\nimport { createTimeoutPromise } from \"../Utils\";\r\nimport { PersonalizationLogger } from \"./PersonalizationLogger\";\r\n\r\nexport class AssetsProvider implements Api.IAssetsProvider {\r\n\tprivate configuration: Configuration.Configuration;\r\n\tprivate tmsgClient: TargetedMessagingClient;\r\n\r\n\tpublic constructor() {\r\n\t\tthis.configuration = Configuration.get();\r\n\t\tsetLogger(new PersonalizationLogger());\r\n\t\t// Enable TargetedMessaging client only if authCallback is provided\r\n\t\t// This is for cases where existing Floodgate hosts are not yet on-boarded into web surfaces flow\r\n\t\tconst floodgateInitOptions = this.configuration && this.configuration.getFloodgateInitOptions();\r\n\t\tconst commonInitOptions = this.configuration && this.configuration.getCommonInitOptions();\r\n\t\tconst authTokenCallback = floodgateInitOptions && floodgateInitOptions.authTokenCallback;\r\n\t\tif (authTokenCallback && (authTokenCallback.getAuthToken || authTokenCallback.getUserPuid)) {\r\n\t\t\tconst initOptions = this.configuration.getCommonInitOptions();\r\n\t\t\tthis.tmsgClient = new TargetedMessagingClient(\r\n\t\t\t\tinitOptions.appId.toString(),\r\n\t\t\t\t\"Web\" /*platform*/,\r\n\t\t\t\tinitOptions.build,\r\n\t\t\t\tinitOptions.originalLocale,\r\n\t\t\t\tthis.extractCountryFromLocale(initOptions.originalLocale),\r\n\t\t\t\tthis.configuration.getSdkSessionId(),\r\n\t\t\t\tfloodgateInitOptions.authTokenCallback,\r\n\t\t\t\tfloodgateInitOptions.campaignFlights,\r\n\t\t\t\tfloodgateInitOptions.campaignQueryParameters,\r\n\t\t\t\tcommonInitOptions.ageGroup,\r\n\t\t\t\tcommonInitOptions.authenticationType,\r\n\t\t\t\tcommonInitOptions.telemetryGroup?.audienceGroup || commonInitOptions.telemetryGroup?.audience,\r\n\t\t\t\tfloodgateInitOptions.messagingServiceSettings\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get campaign definitions from TMS\r\n\t */\r\n\tpublic getCampaignDefinitions(): Promise<ICampaignDefinitions> {\r\n\t\tconst debugResponse = getDebugCampaignDefinitions();\r\n\t\tif (debugResponse && debugResponse.content) {\r\n\t\t\treturn Promise.resolve(debugResponse.content);\r\n\t\t}\r\n\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn Promise.resolve(null);\r\n\t\t}\r\n\r\n\t\treturn this.tmsgClient.getContent(ContentType.campaignContent)\r\n\t\t\t.then(({ content }: ContentResponse) => content);\r\n\t}\r\n\r\n\tpublic getCachedCampaignDefinitions(): ICampaignDefinitions {\r\n\t\treturn getCachedContent(ContentType.campaignContent);\r\n\t}\r\n\r\n\tpublic getUserGovernanceRules(): Promise<UserGovernanceRules> {\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn Promise.resolve(null);\r\n\t\t}\r\n\r\n\t\treturn this.tmsgClient.getContent(ContentType.userGovernanceRules)\r\n\t\t\t.then(({ content }: ContentResponse) => content);\r\n\t}\r\n\r\n\tpublic getMessageMetadata(): Promise<MessageSpec> {\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn Promise.resolve(null);\r\n\t\t}\r\n\r\n\t\treturn this.tmsgClient.getContent(ContentType.messageMetadata)\r\n\t\t\t.then(({ content }: ContentResponse) => content);\r\n\t}\r\n\r\n\t/**\r\n\t * Get TULIPS user facts from GWS endpoint\r\n\t */\r\n\tpublic getUserFacts(): Promise<IUserFact[]> {\r\n\t\tconst debugResponse = getDebugUserFacts();\r\n\t\tif (debugResponse && debugResponse.content) {\r\n\t\t\treturn Promise.resolve(debugResponse.content);\r\n\t\t}\r\n\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn Promise.resolve(null);\r\n\t\t}\r\n\r\n\t\t// Try to get facts from TMS\r\n\t\tif (this.isTulipsServiceEnabled()) {\r\n\t\t\tconst timeoutMilliseconds = getDynamicSetting(SettingKey.tulipsLoadTimeout, TULIPS_LOAD_TIMEOUT);\r\n\t\t\tconst timeoutPromise = createTimeoutPromise(timeoutMilliseconds, this.getTulipsServiceUserFacts());\r\n\t\t\treturn timeoutPromise\r\n\t\t\t\t.then(userFacts => userFacts)\r\n\t\t\t\t.catch(() => this.getSubstrateUserFacts());\r\n\t\t}\r\n\r\n\t\treturn this.getSubstrateUserFacts();\r\n\t}\r\n\r\n\tpublic setCampaignAction(beaconParameters: IBeaconParameters): Promise<boolean> {\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst initOptions = this.configuration.getCommonInitOptions();\r\n\t\tconst floodgateInitOptions = this.configuration.getFloodgateInitOptions();\r\n\t\treturn this.tmsgClient.sendBeaconRequestToService(\r\n\t\t\tinitOptions.appId.toString(),\r\n\t\t\tbeaconParameters,\r\n\t\t\t\"Web\" /*platform*/,\r\n\t\t\tinitOptions.build,\r\n\t\t\tinitOptions.originalLocale,\r\n\t\t\tthis.extractCountryFromLocale(initOptions.originalLocale),\r\n\t\t\tthis.configuration.getSdkSessionId(),\r\n\t\t\tfloodgateInitOptions.authTokenCallback);\r\n\t}\r\n\r\n\t// Floodgate doesn't have country, so we have to use locale as a proxy and extract the country code\r\n\tprivate extractCountryFromLocale(locale?: string): string {\r\n\t\tif (!locale) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tconst splitLocale = locale.split(\"-\");\r\n\t\tif (splitLocale.length === 2) {\r\n\t\t\treturn splitLocale[1];\r\n\t\t} else {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSubstrateUserFacts(): Promise<IUserFact[]> {\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn Promise.resolve(null);\r\n\t\t}\r\n\r\n\t\treturn this.tmsgClient.getUserFactsContent(ContentType.userFacts)\r\n\t\t\t.then(({ content }: ContentResponse) => content);\r\n\t}\r\n\r\n\tprivate getTulipsServiceUserFacts(): Promise<IUserFact[]> {\r\n\t\tif (!this.tmsgClient) {\r\n\t\t\treturn Promise.resolve(null);\r\n\t\t}\r\n\r\n\t\treturn this.tmsgClient.getTulipsServiceUserFactsContent();\r\n\t}\r\n\r\n\tprivate isTulipsServiceEnabled(): boolean {\r\n\t\treturn this.configuration?.getFloodgateInitOptions()?.userFactsReadConfig?.enabled;\r\n\t}\r\n}\r\n\r\nlet assetsProvider: AssetsProvider;\r\n\r\nexport function get() {\r\n\tif (!assetsProvider) {\r\n\t\tassetsProvider = new AssetsProvider();\r\n\t}\r\n\r\n\treturn assetsProvider;\r\n}\r\n", "const {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n} = Object;\n\nlet { freeze, seal, create } = Object; // eslint-disable-line import/no-mutable-exports\nlet { apply, construct } = typeof Reflect !== 'undefined' && Reflect;\n\nif (!freeze) {\n  freeze = function (x) {\n    return x;\n  };\n}\n\nif (!seal) {\n  seal = function (x) {\n    return x;\n  };\n}\n\nif (!apply) {\n  apply = function (fun, thisValue, args) {\n    return fun.apply(thisValue, args);\n  };\n}\n\nif (!construct) {\n  construct = function (Func, args) {\n    return new Func(...args);\n  };\n}\n\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayIndexOf = unapply(Array.prototype.indexOf);\nconst arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySlice = unapply(Array.prototype.slice);\nconst arraySplice = unapply(Array.prototype.splice);\n\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\n\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\n\nconst regExpTest = unapply(RegExp.prototype.test);\n\nconst typeErrorCreate = unconstruct(TypeError);\n\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param func - The function to be wrapped and called.\n * @returns A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply<T>(\n  func: (thisArg: any, ...args: any[]) => T\n): (thisArg: any, ...args: any[]) => T {\n  return (thisArg: any, ...args: any[]): T => {\n    if (thisArg instanceof RegExp) {\n      thisArg.lastIndex = 0;\n    }\n\n    return apply(func, thisArg, args);\n  };\n}\n\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param func - The constructor function to be wrapped and called.\n * @returns A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct<T>(func: (...args: any[]) => T): (...args: any[]) => T {\n  return (...args: any[]): T => construct(func, args);\n}\n\n/**\n * Add properties to a lookup table\n *\n * @param set - The set to which elements will be added.\n * @param array - The array containing elements to be added to the set.\n * @param transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns The modified set with added elements.\n */\nfunction addToSet(\n  set: Record<string, any>,\n  array: readonly any[],\n  transformCaseFunc: ReturnType<typeof unapply<string>> = stringToLowerCase\n): Record<string, any> {\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          (array as any[])[l] = lcElement;\n        }\n\n        element = lcElement;\n      }\n    }\n\n    set[element] = true;\n  }\n\n  return set;\n}\n\n/**\n * Clean up an array to harden against CSPP\n *\n * @param array - The array to be cleaned.\n * @returns The cleaned version of the array\n */\nfunction cleanArray<T>(array: T[]): Array<T | null> {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n\n  return array;\n}\n\n/**\n * Shallow clone an object\n *\n * @param object - The object to be cloned.\n * @returns A new object that copies the original.\n */\nfunction clone<T extends Record<string, any>>(object: T): T {\n  const newObject = create(null);\n\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (\n        value &&\n        typeof value === 'object' &&\n        value.constructor === Object\n      ) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n\n  return newObject;\n}\n\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param object - The object to look up the getter function in its prototype chain.\n * @param prop - The property name for which to find the getter function.\n * @returns The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter<T extends Record<string, any>>(\n  object: T,\n  prop: string\n): ReturnType<typeof unapply<any>> | (() => null) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n\n    object = getPrototypeOf(object);\n  }\n\n  function fallbackValue(): null {\n    return null;\n  }\n\n  return fallbackValue;\n}\n\nexport {\n  // Array\n  arrayForEach,\n  arrayIndexOf,\n  arrayLastIndexOf,\n  arrayPop,\n  arrayPush,\n  arraySlice,\n  arraySplice,\n  // Object\n  entries,\n  freeze,\n  getPrototypeOf,\n  getOwnPropertyDescriptor,\n  isFrozen,\n  setPrototypeOf,\n  seal,\n  clone,\n  create,\n  objectHasOwnProperty,\n  // RegExp\n  regExpTest,\n  // String\n  stringIndexOf,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringTrim,\n  // Errors\n  typeErrorCreate,\n  // Other\n  lookupGetter,\n  addToSet,\n  // Reflect\n  unapply,\n  unconstruct,\n};\n", "import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'a',\n  'abbr',\n  'acronym',\n  'address',\n  'area',\n  'article',\n  'aside',\n  'audio',\n  'b',\n  'bdi',\n  'bdo',\n  'big',\n  'blink',\n  'blockquote',\n  'body',\n  'br',\n  'button',\n  'canvas',\n  'caption',\n  'center',\n  'cite',\n  'code',\n  'col',\n  'colgroup',\n  'content',\n  'data',\n  'datalist',\n  'dd',\n  'decorator',\n  'del',\n  'details',\n  'dfn',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'element',\n  'em',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'font',\n  'footer',\n  'form',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hgroup',\n  'hr',\n  'html',\n  'i',\n  'img',\n  'input',\n  'ins',\n  'kbd',\n  'label',\n  'legend',\n  'li',\n  'main',\n  'map',\n  'mark',\n  'marquee',\n  'menu',\n  'menuitem',\n  'meter',\n  'nav',\n  'nobr',\n  'ol',\n  'optgroup',\n  'option',\n  'output',\n  'p',\n  'picture',\n  'pre',\n  'progress',\n  'q',\n  'rp',\n  'rt',\n  'ruby',\n  's',\n  'samp',\n  'section',\n  'select',\n  'shadow',\n  'small',\n  'source',\n  'spacer',\n  'span',\n  'strike',\n  'strong',\n  'style',\n  'sub',\n  'summary',\n  'sup',\n  'table',\n  'tbody',\n  'td',\n  'template',\n  'textarea',\n  'tfoot',\n  'th',\n  'thead',\n  'time',\n  'tr',\n  'track',\n  'tt',\n  'u',\n  'ul',\n  'var',\n  'video',\n  'wbr',\n] as const);\n\nexport const svg = freeze([\n  'svg',\n  'a',\n  'altglyph',\n  'altglyphdef',\n  'altglyphitem',\n  'animatecolor',\n  'animatemotion',\n  'animatetransform',\n  'circle',\n  'clippath',\n  'defs',\n  'desc',\n  'ellipse',\n  'filter',\n  'font',\n  'g',\n  'glyph',\n  'glyphref',\n  'hkern',\n  'image',\n  'line',\n  'lineargradient',\n  'marker',\n  'mask',\n  'metadata',\n  'mpath',\n  'path',\n  'pattern',\n  'polygon',\n  'polyline',\n  'radialgradient',\n  'rect',\n  'stop',\n  'style',\n  'switch',\n  'symbol',\n  'text',\n  'textpath',\n  'title',\n  'tref',\n  'tspan',\n  'view',\n  'vkern',\n] as const);\n\nexport const svgFilters = freeze([\n  'feBlend',\n  'feColorMatrix',\n  'feComponentTransfer',\n  'feComposite',\n  'feConvolveMatrix',\n  'feDiffuseLighting',\n  'feDisplacementMap',\n  'feDistantLight',\n  'feDropShadow',\n  'feFlood',\n  'feFuncA',\n  'feFuncB',\n  'feFuncG',\n  'feFuncR',\n  'feGaussianBlur',\n  'feImage',\n  'feMerge',\n  'feMergeNode',\n  'feMorphology',\n  'feOffset',\n  'fePointLight',\n  'feSpecularLighting',\n  'feSpotLight',\n  'feTile',\n  'feTurbulence',\n] as const);\n\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nexport const svgDisallowed = freeze([\n  'animate',\n  'color-profile',\n  'cursor',\n  'discard',\n  'font-face',\n  'font-face-format',\n  'font-face-name',\n  'font-face-src',\n  'font-face-uri',\n  'foreignobject',\n  'hatch',\n  'hatchpath',\n  'mesh',\n  'meshgradient',\n  'meshpatch',\n  'meshrow',\n  'missing-glyph',\n  'script',\n  'set',\n  'solidcolor',\n  'unknown',\n  'use',\n] as const);\n\nexport const mathMl = freeze([\n  'math',\n  'menclose',\n  'merror',\n  'mfenced',\n  'mfrac',\n  'mglyph',\n  'mi',\n  'mlabeledtr',\n  'mmultiscripts',\n  'mn',\n  'mo',\n  'mover',\n  'mpadded',\n  'mphantom',\n  'mroot',\n  'mrow',\n  'ms',\n  'mspace',\n  'msqrt',\n  'mstyle',\n  'msub',\n  'msup',\n  'msubsup',\n  'mtable',\n  'mtd',\n  'mtext',\n  'mtr',\n  'munder',\n  'munderover',\n  'mprescripts',\n] as const);\n\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nexport const mathMlDisallowed = freeze([\n  'maction',\n  'maligngroup',\n  'malignmark',\n  'mlongdiv',\n  'mscarries',\n  'mscarry',\n  'msgroup',\n  'mstack',\n  'msline',\n  'msrow',\n  'semantics',\n  'annotation',\n  'annotation-xml',\n  'mprescripts',\n  'none',\n] as const);\n\nexport const text = freeze(['#text'] as const);\n", "import { freeze } from './utils.js';\n\nexport const html = freeze([\n  'accept',\n  'action',\n  'align',\n  'alt',\n  'autocapitalize',\n  'autocomplete',\n  'autopictureinpicture',\n  'autoplay',\n  'background',\n  'bgcolor',\n  'border',\n  'capture',\n  'cellpadding',\n  'cellspacing',\n  'checked',\n  'cite',\n  'class',\n  'clear',\n  'color',\n  'cols',\n  'colspan',\n  'controls',\n  'controlslist',\n  'coords',\n  'crossorigin',\n  'datetime',\n  'decoding',\n  'default',\n  'dir',\n  'disabled',\n  'disablepictureinpicture',\n  'disableremoteplayback',\n  'download',\n  'draggable',\n  'enctype',\n  'enterkeyhint',\n  'face',\n  'for',\n  'headers',\n  'height',\n  'hidden',\n  'high',\n  'href',\n  'hreflang',\n  'id',\n  'inputmode',\n  'integrity',\n  'ismap',\n  'kind',\n  'label',\n  'lang',\n  'list',\n  'loading',\n  'loop',\n  'low',\n  'max',\n  'maxlength',\n  'media',\n  'method',\n  'min',\n  'minlength',\n  'multiple',\n  'muted',\n  'name',\n  'nonce',\n  'noshade',\n  'novalidate',\n  'nowrap',\n  'open',\n  'optimum',\n  'pattern',\n  'placeholder',\n  'playsinline',\n  'popover',\n  'popovertarget',\n  'popovertargetaction',\n  'poster',\n  'preload',\n  'pubdate',\n  'radiogroup',\n  'readonly',\n  'rel',\n  'required',\n  'rev',\n  'reversed',\n  'role',\n  'rows',\n  'rowspan',\n  'spellcheck',\n  'scope',\n  'selected',\n  'shape',\n  'size',\n  'sizes',\n  'span',\n  'srclang',\n  'start',\n  'src',\n  'srcset',\n  'step',\n  'style',\n  'summary',\n  'tabindex',\n  'title',\n  'translate',\n  'type',\n  'usemap',\n  'valign',\n  'value',\n  'width',\n  'wrap',\n  'xmlns',\n  'slot',\n] as const);\n\nexport const svg = freeze([\n  'accent-height',\n  'accumulate',\n  'additive',\n  'alignment-baseline',\n  'amplitude',\n  'ascent',\n  'attributename',\n  'attributetype',\n  'azimuth',\n  'basefrequency',\n  'baseline-shift',\n  'begin',\n  'bias',\n  'by',\n  'class',\n  'clip',\n  'clippathunits',\n  'clip-path',\n  'clip-rule',\n  'color',\n  'color-interpolation',\n  'color-interpolation-filters',\n  'color-profile',\n  'color-rendering',\n  'cx',\n  'cy',\n  'd',\n  'dx',\n  'dy',\n  'diffuseconstant',\n  'direction',\n  'display',\n  'divisor',\n  'dur',\n  'edgemode',\n  'elevation',\n  'end',\n  'exponent',\n  'fill',\n  'fill-opacity',\n  'fill-rule',\n  'filter',\n  'filterunits',\n  'flood-color',\n  'flood-opacity',\n  'font-family',\n  'font-size',\n  'font-size-adjust',\n  'font-stretch',\n  'font-style',\n  'font-variant',\n  'font-weight',\n  'fx',\n  'fy',\n  'g1',\n  'g2',\n  'glyph-name',\n  'glyphref',\n  'gradientunits',\n  'gradienttransform',\n  'height',\n  'href',\n  'id',\n  'image-rendering',\n  'in',\n  'in2',\n  'intercept',\n  'k',\n  'k1',\n  'k2',\n  'k3',\n  'k4',\n  'kerning',\n  'keypoints',\n  'keysplines',\n  'keytimes',\n  'lang',\n  'lengthadjust',\n  'letter-spacing',\n  'kernelmatrix',\n  'kernelunitlength',\n  'lighting-color',\n  'local',\n  'marker-end',\n  'marker-mid',\n  'marker-start',\n  'markerheight',\n  'markerunits',\n  'markerwidth',\n  'maskcontentunits',\n  'maskunits',\n  'max',\n  'mask',\n  'media',\n  'method',\n  'mode',\n  'min',\n  'name',\n  'numoctaves',\n  'offset',\n  'operator',\n  'opacity',\n  'order',\n  'orient',\n  'orientation',\n  'origin',\n  'overflow',\n  'paint-order',\n  'path',\n  'pathlength',\n  'patterncontentunits',\n  'patterntransform',\n  'patternunits',\n  'points',\n  'preservealpha',\n  'preserveaspectratio',\n  'primitiveunits',\n  'r',\n  'rx',\n  'ry',\n  'radius',\n  'refx',\n  'refy',\n  'repeatcount',\n  'repeatdur',\n  'restart',\n  'result',\n  'rotate',\n  'scale',\n  'seed',\n  'shape-rendering',\n  'slope',\n  'specularconstant',\n  'specularexponent',\n  'spreadmethod',\n  'startoffset',\n  'stddeviation',\n  'stitchtiles',\n  'stop-color',\n  'stop-opacity',\n  'stroke-dasharray',\n  'stroke-dashoffset',\n  'stroke-linecap',\n  'stroke-linejoin',\n  'stroke-miterlimit',\n  'stroke-opacity',\n  'stroke',\n  'stroke-width',\n  'style',\n  'surfacescale',\n  'systemlanguage',\n  'tabindex',\n  'tablevalues',\n  'targetx',\n  'targety',\n  'transform',\n  'transform-origin',\n  'text-anchor',\n  'text-decoration',\n  'text-rendering',\n  'textlength',\n  'type',\n  'u1',\n  'u2',\n  'unicode',\n  'values',\n  'viewbox',\n  'visibility',\n  'version',\n  'vert-adv-y',\n  'vert-origin-x',\n  'vert-origin-y',\n  'width',\n  'word-spacing',\n  'wrap',\n  'writing-mode',\n  'xchannelselector',\n  'ychannelselector',\n  'x',\n  'x1',\n  'x2',\n  'xmlns',\n  'y',\n  'y1',\n  'y2',\n  'z',\n  'zoomandpan',\n] as const);\n\nexport const mathMl = freeze([\n  'accent',\n  'accentunder',\n  'align',\n  'bevelled',\n  'close',\n  'columnsalign',\n  'columnlines',\n  'columnspan',\n  'denomalign',\n  'depth',\n  'dir',\n  'display',\n  'displaystyle',\n  'encoding',\n  'fence',\n  'frame',\n  'height',\n  'href',\n  'id',\n  'largeop',\n  'length',\n  'linethickness',\n  'lspace',\n  'lquote',\n  'mathbackground',\n  'mathcolor',\n  'mathsize',\n  'mathvariant',\n  'maxsize',\n  'minsize',\n  'movablelimits',\n  'notation',\n  'numalign',\n  'open',\n  'rowalign',\n  'rowlines',\n  'rowspacing',\n  'rowspan',\n  'rspace',\n  'rquote',\n  'scriptlevel',\n  'scriptminsize',\n  'scriptsizemultiplier',\n  'selection',\n  'separator',\n  'separators',\n  'stretchy',\n  'subscriptshift',\n  'supscriptshift',\n  'symmetric',\n  'voffset',\n  'width',\n  'xmlns',\n]);\n\nexport const xml = freeze([\n  'xlink:href',\n  'xml:id',\n  'xlink:title',\n  'xml:space',\n  'xmlns:xlink',\n] as const);\n", "import { seal } from './utils.js';\n\n// eslint-disable-next-line unicorn/better-regex\nexport const MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nexport const ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nexport const TMPLIT_EXPR = seal(/\\$\\{[\\w\\W]*/gm); // eslint-disable-line unicorn/better-regex\nexport const DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]+$/); // eslint-disable-line no-useless-escape\nexport const ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nexport const IS_ALLOWED_URI = seal(\n  /^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nexport const IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nexport const ATTR_WHITESPACE = seal(\n  /[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nexport const DOCTYPE_NAME = seal(/^html$/i);\nexport const CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n", "/* eslint-disable @typescript-eslint/indent */\n\nimport type { TrustedHTML, TrustedTypesWindow } from 'trusted-types/lib';\nimport type { Config, UseProfilesConfig } from './config';\nimport * as TAGS from './tags.js';\nimport * as ATTRS from './attrs.js';\nimport * as EXPRESSIONS from './regexp.js';\nimport {\n  addToSet,\n  clone,\n  entries,\n  freeze,\n  arrayForEach,\n  arrayLastIndexOf,\n  arrayPop,\n  arrayPush,\n  arraySplice,\n  stringMatch,\n  stringReplace,\n  stringToLowerCase,\n  stringToString,\n  stringIndexOf,\n  stringTrim,\n  regExpTest,\n  typeErrorCreate,\n  lookupGetter,\n  create,\n  objectHasOwnProperty,\n} from './utils.js';\n\nexport type { Config } from './config';\n\ndeclare const VERSION: string;\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\nconst NODE_TYPE = {\n  element: 1,\n  attribute: 2,\n  text: 3,\n  cdataSection: 4,\n  entityReference: 5, // Deprecated\n  entityNode: 6, // Deprecated\n  progressingInstruction: 7,\n  comment: 8,\n  document: 9,\n  documentType: 10,\n  documentFragment: 11,\n  notation: 12, // Deprecated\n};\n\nconst getGlobal = function (): WindowLike {\n  return typeof window === 'undefined' ? null : window;\n};\n\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param trustedTypes The policy factory.\n * @param purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function (\n  trustedTypes: TrustedTypePolicyFactory,\n  purifyHostElement: HTMLScriptElement\n) {\n  if (\n    typeof trustedTypes !== 'object' ||\n    typeof trustedTypes.createPolicy !== 'function'\n  ) {\n    return null;\n  }\n\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      },\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn(\n      'TrustedTypes policy ' + policyName + ' could not be created.'\n    );\n    return null;\n  }\n};\n\nconst _createHooksMap = function (): HooksMap {\n  return {\n    afterSanitizeAttributes: [],\n    afterSanitizeElements: [],\n    afterSanitizeShadowDOM: [],\n    beforeSanitizeAttributes: [],\n    beforeSanitizeElements: [],\n    beforeSanitizeShadowDOM: [],\n    uponSanitizeAttribute: [],\n    uponSanitizeElement: [],\n    uponSanitizeShadowNode: [],\n  };\n};\n\nfunction createDOMPurify(window: WindowLike = getGlobal()): DOMPurify {\n  const DOMPurify: DOMPurify = (root: WindowLike) => createDOMPurify(root);\n\n  DOMPurify.version = VERSION;\n\n  DOMPurify.removed = [];\n\n  if (\n    !window ||\n    !window.document ||\n    window.document.nodeType !== NODE_TYPE.document ||\n    !window.Element\n  ) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n\n    return DOMPurify;\n  }\n\n  let { document } = window;\n\n  const originalDocument = document;\n  const currentScript: HTMLScriptElement =\n    originalDocument.currentScript as HTMLScriptElement;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || (window as any).MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes,\n  } = window;\n\n  const ElementPrototype = Element.prototype;\n\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const remove = lookupGetter(ElementPrototype, 'remove');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName,\n  } = document;\n  const { importNode } = originalDocument;\n\n  let hooks = _createHooksMap();\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported =\n    typeof entries === 'function' &&\n    typeof getParentNode === 'function' &&\n    implementation &&\n    implementation.createHTMLDocument !== undefined;\n\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT,\n  } = EXPRESSIONS;\n\n  let { IS_ALLOWED_URI } = EXPRESSIONS;\n\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [\n    ...TAGS.html,\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.mathMl,\n    ...TAGS.text,\n  ]);\n\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [\n    ...ATTRS.html,\n    ...ATTRS.svg,\n    ...ATTRS.mathMl,\n    ...ATTRS.xml,\n  ]);\n\n  /*\n   * Configure how DOMPurify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(\n    create(null, {\n      tagNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      attributeNameCheck: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: null,\n      },\n      allowCustomizedBuiltInElements: {\n        writable: true,\n        configurable: false,\n        enumerable: true,\n        value: false,\n      },\n    })\n  );\n\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (7.3.3)\n   *   - DOM Tree Accessors (3.1.5)\n   *   - Form Element Parent-Child Relations (4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (4.8.5)\n   *   - HTMLCollection (4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES: UseProfilesConfig | false = {};\n\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, [\n    'annotation-xml',\n    'audio',\n    'colgroup',\n    'desc',\n    'foreignobject',\n    'head',\n    'iframe',\n    'math',\n    'mi',\n    'mn',\n    'mo',\n    'ms',\n    'mtext',\n    'noembed',\n    'noframes',\n    'noscript',\n    'plaintext',\n    'script',\n    'style',\n    'svg',\n    'template',\n    'thead',\n    'title',\n    'video',\n    'xmp',\n  ]);\n\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, [\n    'audio',\n    'video',\n    'img',\n    'source',\n    'image',\n    'track',\n  ]);\n\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, [\n    'alt',\n    'class',\n    'for',\n    'id',\n    'label',\n    'name',\n    'pattern',\n    'placeholder',\n    'role',\n    'summary',\n    'title',\n    'value',\n    'style',\n    'xmlns',\n  ]);\n\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet(\n    {},\n    [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE],\n    stringToString\n  );\n\n  let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, [\n    'mi',\n    'mo',\n    'mn',\n    'ms',\n    'mtext',\n  ]);\n\n  let HTML_INTEGRATION_POINTS = addToSet({}, ['annotation-xml']);\n\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, [\n    'title',\n    'style',\n    'font',\n    'a',\n    'script',\n  ]);\n\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE: null | DOMParserSupportedType = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc: null | Parameters<typeof addToSet>[2] = null;\n\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG: Config | null = null;\n\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n\n  const formElement = document.createElement('form');\n\n  const isRegexOrFunction = function (\n    testValue: unknown\n  ): testValue is Function | RegExp {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n\n  /**\n   * _parseConfig\n   *\n   * @param cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function (cfg: Config = {}): void {\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n\n    PARSER_MEDIA_TYPE =\n      // eslint-disable-next-line unicorn/prefer-includes\n      SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1\n        ? DEFAULT_PARSER_MEDIA_TYPE\n        : cfg.PARSER_MEDIA_TYPE;\n\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc =\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml'\n        ? stringToString\n        : stringToLowerCase;\n\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS')\n      ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc)\n      : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR')\n      ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc)\n      : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES')\n      ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString)\n      : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR')\n      ? addToSet(\n          clone(DEFAULT_URI_SAFE_ATTRIBUTES),\n          cfg.ADD_URI_SAFE_ATTR,\n          transformCaseFunc\n        )\n      : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS')\n      ? addToSet(\n          clone(DEFAULT_DATA_URI_TAGS),\n          cfg.ADD_DATA_URI_TAGS,\n          transformCaseFunc\n        )\n      : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS')\n      ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc)\n      : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS')\n      ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc)\n      : clone({});\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR')\n      ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc)\n      : clone({});\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES')\n      ? cfg.USE_PROFILES\n      : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI = cfg.ALLOWED_URI_REGEXP || EXPRESSIONS.IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    MATHML_TEXT_INTEGRATION_POINTS =\n      cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;\n    HTML_INTEGRATION_POINTS =\n      cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;\n\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)\n    ) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck =\n        cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n\n    if (\n      cfg.CUSTOM_ELEMENT_HANDLING &&\n      typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements ===\n        'boolean'\n    ) {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements =\n        cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, TAGS.text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, TAGS.html);\n        addToSet(ALLOWED_ATTR, ATTRS.html);\n      }\n\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, TAGS.svgFilters);\n        addToSet(ALLOWED_ATTR, ATTRS.svg);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, TAGS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.mathMl);\n        addToSet(ALLOWED_ATTR, ATTRS.xml);\n      }\n    }\n\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n        ALLOWED_TAGS = clone(ALLOWED_TAGS);\n      }\n\n      addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n    }\n\n    if (cfg.ADD_ATTR) {\n      if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n        ALLOWED_ATTR = clone(ALLOWED_ATTR);\n      }\n\n      addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate(\n          'TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.'\n        );\n      }\n\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate(\n          'TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.'\n        );\n      }\n\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(\n          trustedTypes,\n          currentScript\n        );\n      }\n\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n\n    CONFIG = cfg;\n  };\n\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [\n    ...TAGS.svg,\n    ...TAGS.svgFilters,\n    ...TAGS.svgDisallowed,\n  ]);\n  const ALL_MATHML_TAGS = addToSet({}, [\n    ...TAGS.mathMl,\n    ...TAGS.mathMlDisallowed,\n  ]);\n\n  /**\n   * @param element a DOM element whose namespace is being checked\n   * @returns Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function (element: Element): boolean {\n    let parent = getParentNode(element);\n\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template',\n      };\n    }\n\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return (\n          tagName === 'svg' &&\n          (parentTagName === 'annotation-xml' ||\n            MATHML_TEXT_INTEGRATION_POINTS[parentTagName])\n        );\n      }\n\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (\n        parent.namespaceURI === SVG_NAMESPACE &&\n        !HTML_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      if (\n        parent.namespaceURI === MATHML_NAMESPACE &&\n        !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]\n      ) {\n        return false;\n      }\n\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return (\n        !ALL_MATHML_TAGS[tagName] &&\n        (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName])\n      );\n    }\n\n    // For XHTML and XML documents that support custom namespaces\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      ALLOWED_NAMESPACES[element.namespaceURI]\n    ) {\n      return true;\n    }\n\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n\n  /**\n   * _forceRemove\n   *\n   * @param node a DOM node\n   */\n  const _forceRemove = function (node: Node): void {\n    arrayPush(DOMPurify.removed, { element: node });\n\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      getParentNode(node).removeChild(node);\n    } catch (_) {\n      remove(node);\n    }\n  };\n\n  /**\n   * _removeAttribute\n   *\n   * @param name an Attribute name\n   * @param element a DOM node\n   */\n  const _removeAttribute = function (name: string, element: Element): void {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: element.getAttributeNode(name),\n        from: element,\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: element,\n      });\n    }\n\n    element.removeAttribute(name);\n\n    // We void attribute values for unremovable \"is\" attributes\n    if (name === 'is') {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(element);\n        } catch (_) {}\n      } else {\n        try {\n          element.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n\n  /**\n   * _initDocument\n   *\n   * @param dirty - a string of dirty markup\n   * @return a DOM, filled with the dirty markup\n   */\n  const _initDocument = function (dirty: string): Document {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n\n    if (\n      PARSER_MEDIA_TYPE === 'application/xhtml+xml' &&\n      NAMESPACE === HTML_NAMESPACE\n    ) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty =\n        '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' +\n        dirty +\n        '</body></html>';\n    }\n\n    const dirtyPayload = trustedTypesPolicy\n      ? trustedTypesPolicy.createHTML(dirty)\n      : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT\n          ? emptyHTML\n          : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n\n    const body = doc.body || doc.documentElement;\n\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(\n        document.createTextNode(leadingWhitespace),\n        body.childNodes[0] || null\n      );\n    }\n\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(\n        doc,\n        WHOLE_DOCUMENT ? 'html' : 'body'\n      )[0];\n    }\n\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param root The root element or node to start traversing on.\n   * @return The created NodeIterator\n   */\n  const _createNodeIterator = function (root: Node): NodeIterator {\n    return createNodeIterator.call(\n      root.ownerDocument || root,\n      root,\n      // eslint-disable-next-line no-bitwise\n      NodeFilter.SHOW_ELEMENT |\n        NodeFilter.SHOW_COMMENT |\n        NodeFilter.SHOW_TEXT |\n        NodeFilter.SHOW_PROCESSING_INSTRUCTION |\n        NodeFilter.SHOW_CDATA_SECTION,\n      null\n    );\n  };\n\n  /**\n   * _isClobbered\n   *\n   * @param element element to check for clobbering attacks\n   * @return true if clobbered, false if safe\n   */\n  const _isClobbered = function (element: Element): boolean {\n    return (\n      element instanceof HTMLFormElement &&\n      (typeof element.nodeName !== 'string' ||\n        typeof element.textContent !== 'string' ||\n        typeof element.removeChild !== 'function' ||\n        !(element.attributes instanceof NamedNodeMap) ||\n        typeof element.removeAttribute !== 'function' ||\n        typeof element.setAttribute !== 'function' ||\n        typeof element.namespaceURI !== 'string' ||\n        typeof element.insertBefore !== 'function' ||\n        typeof element.hasChildNodes !== 'function')\n    );\n  };\n\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param value object to check whether it's a DOM node\n   * @return true is object is a DOM node\n   */\n  const _isNode = function (value: unknown): value is Node {\n    return typeof Node === 'function' && value instanceof Node;\n  };\n\n  function _executeHooks<\n    T extends\n      | NodeHook\n      | ElementHook\n      | DocumentFragmentHook\n      | UponSanitizeElementHook\n      | UponSanitizeAttributeHook\n  >(hooks: T[], currentNode: Parameters<T>[0], data: Parameters<T>[1]): void {\n    arrayForEach(hooks, (hook) => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  }\n\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   * @param currentNode to check for permission to exist\n   * @return true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function (currentNode: any): boolean {\n    let content = null;\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeElements, currentNode, null);\n\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.uponSanitizeElement, currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS,\n    });\n\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (\n      SAFE_FOR_XML &&\n      currentNode.hasChildNodes() &&\n      !_isNode(currentNode.firstElementChild) &&\n      regExpTest(/<[/\\w!]/g, currentNode.innerHTML) &&\n      regExpTest(/<[/\\w!]/g, currentNode.textContent)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove any occurrence of processing instructions */\n    if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove any kind of possibly harmful comments */\n    if (\n      SAFE_FOR_XML &&\n      currentNode.nodeType === NODE_TYPE.comment &&\n      regExpTest(/<[/\\w]/g, currentNode.data)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Remove element if anything forbids its presence */\n    if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n          regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)\n        ) {\n          return false;\n        }\n\n        if (\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n          CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)\n        ) {\n          return false;\n        }\n      }\n\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n\n          for (let i = childCount - 1; i >= 0; --i) {\n            const childClone = cloneNode(childNodes[i], true);\n            childClone.__removalCount = (currentNode.__removalCount || 0) + 1;\n            parentNode.insertBefore(childClone, getNextSibling(currentNode));\n          }\n        }\n      }\n\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if (\n      (tagName === 'noscript' ||\n        tagName === 'noembed' ||\n        tagName === 'noframes') &&\n      regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)\n    ) {\n      _forceRemove(currentNode);\n      return true;\n    }\n\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr) => {\n        content = stringReplace(content, expr, ' ');\n      });\n\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, { element: currentNode.cloneNode() });\n        currentNode.textContent = content;\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeElements, currentNode, null);\n\n    return false;\n  };\n\n  /**\n   * _isValidAttribute\n   *\n   * @param lcTag Lowercase tag name of containing element.\n   * @param lcName Lowercase attribute name.\n   * @param value Attribute value.\n   * @return Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function (\n    lcTag: string,\n    lcName: string,\n    value: string\n  ): boolean {\n    /* Make sure attribute cannot clobber */\n    if (\n      SANITIZE_DOM &&\n      (lcName === 'id' || lcName === 'name') &&\n      (value in document || value in formElement)\n    ) {\n      return false;\n    }\n\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (\n      ALLOW_DATA_ATTR &&\n      !FORBID_ATTR[lcName] &&\n      regExpTest(DATA_ATTR, lcName)\n    ) {\n      // This attribute is safe\n    } else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) {\n      // This attribute is safe\n      /* Otherwise, check the name is permitted */\n    } else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n        // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n        // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n        (_isBasicCustomElement(lcTag) &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag))) &&\n          ((CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName)) ||\n            (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName)))) ||\n        // Alternative, second condition checks if it's an `is`-attribute, AND\n        // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n        (lcName === 'is' &&\n          CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements &&\n          ((CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp &&\n            regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value)) ||\n            (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function &&\n              CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))))\n      ) {\n        // If user has supplied a regexp or function in CUSTOM_ELEMENT_HANDLING.tagNameCheck, we need to also allow derived custom elements using the same tagName test.\n        // Additionally, we need to allow attributes passing the CUSTOM_ELEMENT_HANDLING.attributeNameCheck user has configured, as custom elements can define these at their own discretion.\n      } else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) {\n      // This attribute is safe\n      /* Check no script, data or unknown possibly unsafe URI\n        unless we know URI values are safe for that attribute */\n    } else if (\n      regExpTest(IS_ALLOWED_URI, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Keep image data URIs alive if src/xlink:href is allowed */\n      /* Further prevent gadget XSS for dynamically built script tags */\n    } else if (\n      (lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') &&\n      lcTag !== 'script' &&\n      stringIndexOf(value, 'data:') === 0 &&\n      DATA_URI_TAGS[lcTag]\n    ) {\n      // This attribute is safe\n      /* Allow unknown protocols: This provides support for links that\n        are handled by protocol handlers which may be unknown ahead of\n        time, e.g. fb:, spotify: */\n    } else if (\n      ALLOW_UNKNOWN_PROTOCOLS &&\n      !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))\n    ) {\n      // This attribute is safe\n      /* Check for binary attributes */\n    } else if (value) {\n      return false;\n    } else {\n      // Binary attributes are safe at this point\n      /* Anything else, presume unsafe, do not add it back */\n    }\n\n    return true;\n  };\n\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param tagName name of the tag of the node to sanitize\n   * @returns Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function (tagName: string): RegExpMatchArray {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param currentNode to sanitize\n   */\n  const _sanitizeAttributes = function (currentNode: Element): void {\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);\n\n    const { attributes } = currentNode;\n\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes || _isClobbered(currentNode)) {\n      return;\n    }\n\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n      forceKeepAttr: undefined,\n    };\n    let l = attributes.length;\n\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const { name, namespaceURI, value: attrValue } = attr;\n      const lcName = transformCaseFunc(name);\n\n      const initValue = attrValue;\n      let value = name === 'value' ? initValue : stringTrim(initValue);\n\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);\n      value = hookEvent.attrValue;\n\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n\n      /* Work around a security issue with comments inside attributes */\n      if (SAFE_FOR_XML && regExpTest(/((--!?|])>)|<\\/(style|title)/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr) => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n\n      /* Handle attributes that require Trusted Types */\n      if (\n        trustedTypesPolicy &&\n        typeof trustedTypes === 'object' &&\n        typeof trustedTypes.getAttributeType === 'function'\n      ) {\n        if (namespaceURI) {\n          /* Namespaces are not yet supported, see https://bugs.chromium.org/p/chromium/issues/detail?id=1305293 */\n        } else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML': {\n              value = trustedTypesPolicy.createHTML(value);\n              break;\n            }\n\n            case 'TrustedScriptURL': {\n              value = trustedTypesPolicy.createScriptURL(value);\n              break;\n            }\n\n            default: {\n              break;\n            }\n          }\n        }\n      }\n\n      /* Handle invalid data-* attribute set by try-catching it */\n      if (value !== initValue) {\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n\n          if (_isClobbered(currentNode)) {\n            _forceRemove(currentNode);\n          } else {\n            arrayPop(DOMPurify.removed);\n          }\n        } catch (_) {\n          _removeAttribute(name, currentNode);\n        }\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);\n  };\n\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function (fragment: DocumentFragment): void {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);\n\n    while ((shadowNode = shadowIterator.nextNode())) {\n      /* Execute a hook if present */\n      _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);\n\n      /* Sanitize tags and elements */\n      _sanitizeElements(shadowNode);\n\n      /* Check attributes next */\n      _sanitizeAttributes(shadowNode);\n\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n    }\n\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);\n  };\n\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty, cfg = {}) {\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if ((dirty as Node).nodeName) {\n        const tagName = transformCaseFunc((dirty as Node).nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate(\n            'root node is forbidden and cannot be sanitized in-place'\n          );\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (\n        importedNode.nodeType === NODE_TYPE.element &&\n        importedNode.nodeName === 'BODY'\n      ) {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (\n        !RETURN_DOM &&\n        !SAFE_FOR_TEMPLATES &&\n        !WHOLE_DOCUMENT &&\n        // eslint-disable-next-line unicorn/prefer-includes\n        dirty.indexOf('<') === -1\n      ) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n          ? trustedTypesPolicy.createHTML(dirty)\n          : dirty;\n      }\n\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n\n    /* Now start iterating over the created document */\n    while ((currentNode = nodeIterator.nextNode())) {\n      /* Sanitize tags and elements */\n      _sanitizeElements(currentNode);\n\n      /* Check attributes next */\n      _sanitizeAttributes(currentNode);\n\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n    }\n\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n\n      return returnNode;\n    }\n\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n\n    /* Serialize doctype if allowed */\n    if (\n      WHOLE_DOCUMENT &&\n      ALLOWED_TAGS['!doctype'] &&\n      body.ownerDocument &&\n      body.ownerDocument.doctype &&\n      body.ownerDocument.doctype.name &&\n      regExpTest(EXPRESSIONS.DOCTYPE_NAME, body.ownerDocument.doctype.name)\n    ) {\n      serializedHTML =\n        '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], (expr) => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE\n      ? trustedTypesPolicy.createHTML(serializedHTML)\n      : serializedHTML;\n  };\n\n  DOMPurify.setConfig = function (cfg = {}) {\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n\n  DOMPurify.removeHook = function (entryPoint, hookFunction) {\n    if (hookFunction !== undefined) {\n      const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);\n\n      return index === -1\n        ? undefined\n        : arraySplice(hooks[entryPoint], index, 1)[0];\n    }\n\n    return arrayPop(hooks[entryPoint]);\n  };\n\n  DOMPurify.removeHooks = function (entryPoint) {\n    hooks[entryPoint] = [];\n  };\n\n  DOMPurify.removeAllHooks = function () {\n    hooks = _createHooksMap();\n  };\n\n  return DOMPurify;\n}\n\nexport default createDOMPurify();\n\nexport interface DOMPurify {\n  /**\n   * Creates a DOMPurify instance using the given window-like object. Defaults to `window`.\n   */\n  (root?: WindowLike): DOMPurify;\n\n  /**\n   * Version label, exposed for easier checks\n   * if DOMPurify is up to date or not\n   */\n  version: string;\n\n  /**\n   * Array of elements that DOMPurify removed during sanitation.\n   * Empty if nothing was removed.\n   */\n  removed: Array<RemovedElement | RemovedAttribute>;\n\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  isSupported: boolean;\n\n  /**\n   * Set the configuration once.\n   *\n   * @param cfg configuration object\n   */\n  setConfig(cfg?: Config): void;\n\n  /**\n   * Removes the configuration.\n   */\n  clearConfig(): void;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized TrustedHTML.\n   */\n  sanitize(\n    dirty: string | Node,\n    cfg: Config & { RETURN_TRUSTED_TYPE: true }\n  ): TrustedHTML;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty DOM node\n   * @param cfg object\n   * @returns Sanitized DOM node.\n   */\n  sanitize(dirty: Node, cfg: Config & { IN_PLACE: true }): Node;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized DOM node.\n   */\n  sanitize(dirty: string | Node, cfg: Config & { RETURN_DOM: true }): Node;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized document fragment.\n   */\n  sanitize(\n    dirty: string | Node,\n    cfg: Config & { RETURN_DOM_FRAGMENT: true }\n  ): DocumentFragment;\n\n  /**\n   * Provides core sanitation functionality.\n   *\n   * @param dirty string or DOM node\n   * @param cfg object\n   * @returns Sanitized string.\n   */\n  sanitize(dirty: string | Node, cfg?: Config): string;\n\n  /**\n   * Checks if an attribute value is valid.\n   * Uses last set config, if any. Otherwise, uses config defaults.\n   *\n   * @param tag Tag name of containing element.\n   * @param attr Attribute name.\n   * @param value Attribute value.\n   * @returns Returns true if `value` is valid. Otherwise, returns false.\n   */\n  isValidAttribute(tag: string, attr: string, value: string): boolean;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(entryPoint: BasicHookName, hookFunction: NodeHook): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(entryPoint: ElementHookName, hookFunction: ElementHook): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(\n    entryPoint: DocumentFragmentHookName,\n    hookFunction: DocumentFragmentHook\n  ): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(\n    entryPoint: 'uponSanitizeElement',\n    hookFunction: UponSanitizeElementHook\n  ): void;\n\n  /**\n   * Adds a DOMPurify hook.\n   *\n   * @param entryPoint entry point for the hook to add\n   * @param hookFunction function to execute\n   */\n  addHook(\n    entryPoint: 'uponSanitizeAttribute',\n    hookFunction: UponSanitizeAttributeHook\n  ): void;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: BasicHookName,\n    hookFunction?: NodeHook\n  ): NodeHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: ElementHookName,\n    hookFunction?: ElementHook\n  ): ElementHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: DocumentFragmentHookName,\n    hookFunction?: DocumentFragmentHook\n  ): DocumentFragmentHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: 'uponSanitizeElement',\n    hookFunction?: UponSanitizeElementHook\n  ): UponSanitizeElementHook | undefined;\n\n  /**\n   * Remove a DOMPurify hook at a given entryPoint\n   * (pops it from the stack of hooks if hook not specified)\n   *\n   * @param entryPoint entry point for the hook to remove\n   * @param hookFunction optional specific hook to remove\n   * @returns removed hook\n   */\n  removeHook(\n    entryPoint: 'uponSanitizeAttribute',\n    hookFunction?: UponSanitizeAttributeHook\n  ): UponSanitizeAttributeHook | undefined;\n\n  /**\n   * Removes all DOMPurify hooks at a given entryPoint\n   *\n   * @param entryPoint entry point for the hooks to remove\n   */\n  removeHooks(entryPoint: HookName): void;\n\n  /**\n   * Removes all DOMPurify hooks.\n   */\n  removeAllHooks(): void;\n}\n\n/**\n * An element removed by DOMPurify.\n */\nexport interface RemovedElement {\n  /**\n   * The element that was removed.\n   */\n  element: Node;\n}\n\n/**\n * An element removed by DOMPurify.\n */\nexport interface RemovedAttribute {\n  /**\n   * The attribute that was removed.\n   */\n  attribute: Attr | null;\n\n  /**\n   * The element that the attribute was removed.\n   */\n  from: Node;\n}\n\ntype BasicHookName =\n  | 'beforeSanitizeElements'\n  | 'afterSanitizeElements'\n  | 'uponSanitizeShadowNode';\ntype ElementHookName = 'beforeSanitizeAttributes' | 'afterSanitizeAttributes';\ntype DocumentFragmentHookName =\n  | 'beforeSanitizeShadowDOM'\n  | 'afterSanitizeShadowDOM';\ntype UponSanitizeElementHookName = 'uponSanitizeElement';\ntype UponSanitizeAttributeHookName = 'uponSanitizeAttribute';\n\ninterface HooksMap {\n  beforeSanitizeElements: NodeHook[];\n  afterSanitizeElements: NodeHook[];\n  beforeSanitizeShadowDOM: DocumentFragmentHook[];\n  uponSanitizeShadowNode: NodeHook[];\n  afterSanitizeShadowDOM: DocumentFragmentHook[];\n  beforeSanitizeAttributes: ElementHook[];\n  afterSanitizeAttributes: ElementHook[];\n  uponSanitizeElement: UponSanitizeElementHook[];\n  uponSanitizeAttribute: UponSanitizeAttributeHook[];\n}\n\nexport type HookName =\n  | BasicHookName\n  | ElementHookName\n  | DocumentFragmentHookName\n  | UponSanitizeElementHookName\n  | UponSanitizeAttributeHookName;\n\nexport type NodeHook = (\n  this: DOMPurify,\n  currentNode: Node,\n  hookEvent: null,\n  config: Config\n) => void;\n\nexport type ElementHook = (\n  this: DOMPurify,\n  currentNode: Element,\n  hookEvent: null,\n  config: Config\n) => void;\n\nexport type DocumentFragmentHook = (\n  this: DOMPurify,\n  currentNode: DocumentFragment,\n  hookEvent: null,\n  config: Config\n) => void;\n\nexport type UponSanitizeElementHook = (\n  this: DOMPurify,\n  currentNode: Node,\n  hookEvent: UponSanitizeElementHookEvent,\n  config: Config\n) => void;\n\nexport type UponSanitizeAttributeHook = (\n  this: DOMPurify,\n  currentNode: Element,\n  hookEvent: UponSanitizeAttributeHookEvent,\n  config: Config\n) => void;\n\nexport interface UponSanitizeElementHookEvent {\n  tagName: string;\n  allowedTags: Record<string, boolean>;\n}\n\nexport interface UponSanitizeAttributeHookEvent {\n  attrName: string;\n  attrValue: string;\n  keepAttr: boolean;\n  allowedAttributes: Record<string, boolean>;\n  forceKeepAttr: boolean | undefined;\n}\n\n/**\n * A `Window`-like object containing the properties and types that DOMPurify requires.\n */\nexport type WindowLike = Pick<\n  typeof globalThis,\n  | 'DocumentFragment'\n  | 'HTMLTemplateElement'\n  | 'Node'\n  | 'Element'\n  | 'NodeFilter'\n  | 'NamedNodeMap'\n  | 'HTMLFormElement'\n  | 'DOMParser'\n> & {\n  document?: Document;\n  MozNamedAttrMap?: typeof window.NamedNodeMap;\n} & Pick<TrustedTypesWindow, 'trustedTypes'>;\n", "import DOMPurify from 'dompurify';\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport * as Logging from \"../Logging/Logging\";\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\r\ninterface TrustedScriptURL { }\r\n\r\ninterface TrustedTypePolicyFactory {\r\n    createPolicy: (\r\n        name: string,\r\n        rules: {\r\n            createScriptURL: (str: string) => TrustedScriptURL;\r\n            createHTML: (str: string) => string;\r\n        }\r\n    ) => TrustedTypePolicy;\r\n}\r\n\r\ninterface TrustedTypePolicy {\r\n    createScriptURL: (str: string) => TrustedScriptURL;\r\n    createHTML: (str: string) => string;\r\n}\r\n\r\ndeclare global {\r\n    interface Window {\r\n        trustedTypes: TrustedTypePolicyFactory;\r\n    }\r\n}\r\n\r\nlet ofbTrustedTypeInstance = undefined;\r\n\r\nexport const domUtilsTrustedTypePolicy = () => {\r\n    if (!ofbTrustedTypeInstance) {\r\n        ofbTrustedTypeInstance = window.trustedTypes?.createPolicy(\"officebrowserfeedback#domUtils\", {\r\n            createScriptURL: (scriptUrlString: string) => {\r\n                // If it is an absolute URL, we need to check if it is from the same origin.\r\n                if (scriptUrlString.indexOf(\"://\") > 0 || scriptUrlString.indexOf(\"//\") === 0) {\r\n                    const scriptUrl = new URL(scriptUrlString);\r\n                    if (scriptUrl?.protocol !== 'https:') {\r\n                        throw new Error(`Only https protocol is allowed for script url ${scriptUrlString}`)\r\n                    }\r\n\r\n                    const trustedOrigins = Configuration.get().getCommonInitOptions().allowedDomains;\r\n                    const currentOrigin = getUrlDomain(document.location.hostname);\r\n                    const scriptOrigin = getUrlDomain(scriptUrl.origin);\r\n                    if (scriptUrl.origin !== document.location.origin && !trustedOrigins.includes(scriptOrigin) && currentOrigin !== scriptOrigin) {\r\n                        Logging.getLogger().logEvent(Logging.EventIds.TRUSTEDTYPES_URL_BLOCKED,\r\n                            Logging.LogLevel.Critical,\r\n                            {\r\n                                Data: JSON.stringify({\r\n                                    scriptUrl: scriptUrlString,\r\n                                    currentHostname: document.location.hostname,\r\n                                    currentOrigin: document.location.origin,\r\n                                    scriptOrigin: scriptUrl.origin,\r\n                                }),\r\n                            });\r\n                        return `about:blank#blocked`;\r\n                    }\r\n                    return scriptUrl.href;\r\n                }\r\n\r\n                // If it is a relative URL, we are sure it is from the same domain.\r\n                return scriptUrlString;\r\n            },\r\n            createHTML: (htmlString: string) => { return sanitizeHtmlString(htmlString) },\r\n        });\r\n    }\r\n    return ofbTrustedTypeInstance;\r\n}\r\n\r\nexport function sanitizeHtmlString(htmlString: string) {\r\n    return DOMPurify.sanitize(htmlString, { ADD_ATTR: [\"focusable\"] })\r\n}\r\n\r\nexport function sanitizeOutputString(inputString: string) {\r\n    return DOMPurify.sanitize(inputString, { USE_PROFILES: { html: true } })\r\n}\r\n\r\nconst getUrlDomain = (url: string) => {\r\n    return url.split('.').splice(-2).join('.');\r\n}", "/*\r\n * DomUtils.ts\r\n *\r\n * Module for page document utility functions\r\n */\r\nimport { domUtilsTrustedTypePolicy } from './TrustedTypesPolicyUtils';\r\n\r\n/**\r\n * Load the script and callback after it is loaded\r\n * @param url The url of the script\r\n * @param pageOrigin Optional - Origin of the page\r\n */\r\nexport function loadScript(url: string, pageOrigin: string = (window as any).origin): Promise<void> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tconst script: any = document.createElement(\"script\");\r\n\t\tscript.async = true;\r\n\r\n\t\tif (script.readyState) { // IE\r\n\t\t\tscript.onreadystatechange = function () {\r\n\t\t\t\tif (script.readyState === \"loaded\" || script.readyState === \"complete\") {\r\n\t\t\t\t\tscript.onreadystatechange = null;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t} else {  // Others\r\n\t\t\tscript.onload = function () {\r\n\t\t\t\tresolve();\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tscript.onerror = function () {\r\n\t\t\treject();\r\n\t\t};\r\n\r\n\t\tscript.src = domUtilsTrustedTypePolicy()?.createScriptURL(url) ?? url;\r\n\r\n\t\t// don't add if origin is not available or when containing \"null\". This is to mitigate possible\r\n\t\t// unexpected behavior with Chrome when a page hosting this SDK is being tested as a local file.\r\n\t\t// The behavior depends on Chrome.exe's --allow-file-access-from-files setting.\r\n\t\tif (pageOrigin && pageOrigin !== \"null\") {\r\n\t\t\tscript.crossOrigin = \"anonymous\";\r\n\t\t}\r\n\r\n\t\tconst entry: HTMLScriptElement = document.getElementsByTagName(\"script\")[0];\r\n\t\tentry.parentNode.insertBefore(script, entry);\r\n\t});\r\n}\r\n", "/**\r\n * Rude survey launcher factory for Web SDK\r\n */\r\n\r\nimport { Api, DynamicUxClientState } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { Utils } from \"@ms-ofb/officefloodgatecore\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport * as Logging from \"../Logging/Logging\";\r\nimport * as DynamicUxClient from \"../UI/DynamicUx/DynamicUxClient\";\r\nimport UISurvey from \"./../FloodgateCore/UISurvey/UISurvey\";\r\nimport * as Window from \"./../Window/Window\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nexport default class RudeSurveyLauncherFactory implements Api.ISurveyLauncherFactory {\r\n\tpublic static readonly LAUNCHER_TYPE: string = Api.LAUNCHER_TYPE_DEFAULT;\r\n\r\n\tpublic makeSurveyLauncher(survey: Api.ISurvey): Api.ISurveyLauncher {\r\n\t\tif (this.AcceptsSurvey(survey)) {\r\n\t\t\treturn new RudeSurveyLauncher(survey);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic AcceptsSurvey(survey: Api.ISurvey): boolean {\r\n\t\t// This factory should accept any type that is not of type GenericMessagingSurface\r\n\t\t// This will ensure that a rude survey launcher is returned for any survey type old or new\r\n\t\t// as a launcher is needed to invoke survey activated callback\r\n\t\tif (!isNOU(survey) &&\r\n\t\t\tsurvey.getType() !== Api.SurveyType.GenericMessagingSurface &&\r\n\t\t\tsurvey.getType() !== Api.SurveyType.Dialog) {\r\n\t\t\t// Check for dynamic UX state if the survey is using UxSchema,\r\n\t\t\t// whether the status is success/failure, or is loading and no result yet\r\n\t\t\tif (survey.getUxSchema()) {\r\n\t\t\t\tif (Configuration.get().getDynamicUxConfig().enabled) {\r\n\t\t\t\t\tconst dynamicUxClient = DynamicUxClient.get();\r\n\t\t\t\t\tconst dynamicUxState = dynamicUxClient.getStatus();\r\n\r\n\t\t\t\t\t// reject only if the survey has only UxSchema and DynamicUx is failed to download\r\n\t\t\t\t\tif (dynamicUxState === DynamicUxClientState.Failure && !survey.isContentValid()) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn survey.isContentValid();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport class RudeSurveyLauncher implements Api.ISurveyLauncher {\r\n\tprivate survey: Api.ISurvey;\r\n\r\n\tconstructor(survey: Api.ISurvey) {\r\n\t\tthis.survey = survey;\r\n\t}\r\n\r\n\tpublic launch(): void {\r\n\t\ttry {\r\n\t\t\tWindow.get().OfficeBrowserFeedback.floodgate.showSurvey(new UISurvey(this.survey)).catch((error) => {\r\n\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_LAUNCHER_SHOWSURVEY_FAILURE,\r\n\t\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tCampaignId: this.survey.getCampaignId(),\r\n\t\t\t\t\t\tSurveyId: this.survey.getSurveyInfo().getId(),\r\n\t\t\t\t\t\tSurveyType: this.survey.getType(),\r\n\t\t\t\t\t\tErrorMessage: error && error.toString(),\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_LAUNCHER_FAILURE,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tCampaignId: this.survey.getCampaignId(),\r\n\t\t\t\t\tSurveyId: this.survey.getSurveyInfo().getId(),\r\n\t\t\t\t\tSurveyType: this.survey.getType(),\r\n\t\t\t\t\tErrorMessage: error && error.toString(),\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n", "import { DynamicUxClientState } from '@ms-ofb/floodgate-shared-typings';\r\nimport { Utils } from '@ms-ofb/officefloodgatecore';\r\nimport { IAdapterProviderV3, IPreConfig } from '@ms/centro-hvc-loader';\r\nimport { BackendTarget, IRequestOptionsCombined } from '@ms/centro-hvc-loader/dist/runtime/data/requestFunction.types';\r\nimport * as Configuration from \"../../Configuration/Configuration\";\r\nimport { IDynamicUxConfig } from \"../../Configuration/IInitOptions\";\r\nimport IUISurvey from '../../FloodgateCore/UISurvey/IUISurvey';\r\nimport * as Logging from \"../../Logging/Logging\";\r\nimport { getOrCreateDiv } from '../Utils';\r\nimport {\r\n\tCentroCommonInitOptions,\r\n\tCentroFloodgateContainerId,\r\n\tCentroFloodgateFeatureName,\r\n\tCentroFloodgateHostName,\r\n\tCentroFloodgateInitOptions,\r\n\tCentroFloodgatePerfPrefix,\r\n\tCentroPetrolUploadEndpoint,\r\n\tCentroPreloadLoggingSamplingRate,\r\n\tCentroThemeInitOptions,\r\n\tCentroUrlProd,\r\n\tFloodgateCentroVersion\r\n} from './CentroConstants';\r\nimport { CentroCoreDataSource } from './CentroCoreDataSource';\r\nimport { CentroLoaderWrapper } from './CentroLoaderWrapper';\r\nimport { centroLogging } from './CentroLogger';\r\nimport { CentroThemeDataSource } from './CentroThemeDataSource';\r\n\r\n\r\nexport class DynamicUxClient {\r\n\r\n\t// making these data public so they can be access for testing\r\n\tpublic clientState: DynamicUxClientState;\r\n\r\n\t// Configuration data\r\n\tprivate dynamicUxConfig: IDynamicUxConfig;\r\n\tprivate userSurveyCallback: (status: DynamicUxClientState) => void;\r\n\tprivate systemSurveyCallback: (status: DynamicUxClientState) => void;\r\n\tprivate boostStrapper;\r\n\tprivate unmountFunc;\r\n\tprivate elementToMount: HTMLElement;\r\n\r\n\tconstructor() {\r\n\t\tthis.dynamicUxConfig = {};\r\n\t\tthis.clientState = DynamicUxClientState.NotStarted;\r\n\t\tconst surveyContainer = Configuration.get().getFloodgateInitOptions().surveyContainer;\r\n\r\n\t\tif (Utils.isNOU(surveyContainer)) {\r\n\t\t\t// Can't use surveyContainer since it's null or undefined, so use default element\r\n\t\t\tthis.elementToMount = getOrCreateDiv(CentroFloodgateContainerId, true, false);\r\n\t\t} else if (typeof surveyContainer === 'string') {\r\n\t\t\t// Element ID is provided\r\n\t\t\tthis.elementToMount = getOrCreateDiv(surveyContainer, true, false);\r\n\t\t} else if (typeof surveyContainer == 'object') { // TypeOf surveyContainer is \"Object\" when HtmlElement is passed, so checking for instanceOf\r\n\t\t\t// HtmlElement is provided\r\n\t\t\tthis.elementToMount = surveyContainer;\r\n\t\t} else {\r\n\t\t\t// Can't use surveyContainer, so use default element\r\n\t\t\tthis.elementToMount = getOrCreateDiv(CentroFloodgateContainerId, true, false);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setup(config: IDynamicUxConfig) {\r\n\t\tthis.dynamicUxConfig = config;\r\n\t}\r\n\r\n\tpublic isEnabled(): boolean {\r\n\t\treturn !!this.dynamicUxConfig.enabled;\r\n\t}\r\n\r\n\tpublic getStatus(): DynamicUxClientState {\r\n\t\treturn this.clientState;\r\n\t}\r\n\r\n\tpublic delayLoadCentroUx() {\r\n\t\tif (this.dynamicUxConfig.delayLoadingTimeout === 0) {\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.DYNAMICUX_LOAD_PRELOAD,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tTimeMilliseconds: 0\r\n\t\t\t\t},\r\n\t\t\t\tCentroPreloadLoggingSamplingRate\r\n\t\t\t);\r\n\t\t\tthis.loadCentroUx();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst timeBefore = performance.now();\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tconst waitingTime = performance.now() - timeBefore;\r\n\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.DYNAMICUX_LOAD_PRELOAD,\r\n\t\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tTimeMilliseconds: waitingTime\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCentroPreloadLoggingSamplingRate\r\n\t\t\t\t);\r\n\t\t\t\tthis.loadCentroUx();\r\n\t\t\t}, this.dynamicUxConfig.delayLoadingTimeout);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * This function should only be called prior to the DynamicUxClient status check\r\n\t *  to be Starting, so it can set the callback to be performed once the loading is done\r\n\t */\r\n\tpublic setOnSurveyActivatedCallback(callback: (status: DynamicUxClientState) => void, survey: IUISurvey) {\r\n\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_TRIGGER_DYNAMICUX_ONLOAD,\r\n\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t{\r\n\t\t\t\tCampaignId: survey.getCampaignId(),\r\n\t\t\t\tSurveyId: survey.getId(),\r\n\t\t\t\tSurveyType: survey.getSurveyType(),\r\n\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\tDynamicUxClientState: this.clientState,\r\n\t\t\t\t\tisUserInitiatedSurvey: survey.isUserInitiatedSurvey()\r\n\t\t\t\t}),\r\n\t\t\t}\r\n\t\t);\r\n\t\tif (survey.isUserInitiatedSurvey()) {\r\n\t\t\tthis.userSurveyCallback = callback;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.systemSurveyCallback = callback;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic async boostStrapSurvey() {\r\n\t\tif (this.clientState !== DynamicUxClientState.Success) {\r\n\t\t\treturn Promise.reject(\"DynamicUx is not loaded successfully\");\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tthis.unmountFunc = await this.boostStrapper.main(this.elementToMount);\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\treturn Promise.reject(`Error: ${error.toString()}, Error stack: ${error.stack}`);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic unmountSurvey() {\r\n\t\tif (this.unmountSurvey) {\r\n\t\t\tthis.unmountFunc();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async loadCentroUx() {\r\n\t\t// If the Centro is already loaded successfully,\r\n\t\t// or previous load failed or is loading,\r\n\t\t// return right away.\r\n\t\tif (this.clientState === DynamicUxClientState.Success || this.clientState === DynamicUxClientState.Starting ||\r\n\t\t\tthis.clientState === DynamicUxClientState.Failure) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.clientState = DynamicUxClientState.Starting;\r\n\t\tconst timeBefore = performance.now();\r\n\t\ttry {\r\n\t\t\tconst preConfig: IPreConfig = {\r\n\t\t\t\thostName: Configuration.get().getFloodgateInitOptions().dynamicUxConfig.hostName || CentroFloodgateHostName,\r\n\t\t\t\tlocale: Configuration.get().getCommonInitOptions().locale,\r\n\t\t\t\t// All perf log will be prefixed with this string.\r\n\t\t\t\t// So that when we analysis perf logs, we know that those logs are coming from HVC running in your environment.\r\n\t\t\t\tperfPrefix: CentroFloodgatePerfPrefix,\r\n\t\t\t\tadditionalLoggers: { CentroFloodgateLoggerFunc: centroLogging },\r\n\t\t\t\tkustoEndpoint: '',\r\n\t\t\t\t// Disable Centro aria logger due to the issue with it setting unsecure cookie.\r\n\t\t\t\tdisableAriaLogging: true,\r\n\t\t\t};\r\n\r\n\t\t\tconst centroParams = {\r\n\t\t\t\t// Please use Centro Prod Url even for development to get the latest released of the HVC\r\n\t\t\t\t// Centro CI Url can also be used for testing unreleased features\r\n\t\t\t\tcentroEnvironmentBaseUrl: CentroUrlProd,\r\n\t\t\t\tpreConfig,\r\n\t\t\t\ttargetHtmlElement: this.elementToMount,\r\n\t\t\t\tforHostVersion: FloodgateCentroVersion // using Floodgate Centro version since Centro only support exact match\r\n\t\t\t};\r\n\r\n\t\t\tawait CentroLoaderWrapper.initialize(centroParams);\r\n\r\n\t\t\tconst dataSources = sd => {\r\n\t\t\t\tsd(CentroCommonInitOptions, CentroLoaderWrapper.createStaticDataSource({ theme: 'M365Light' })), // unused but required by Centro\r\n\t\t\t\t\tsd(CentroFloodgateInitOptions, CentroCoreDataSource.get())\r\n\t\t\t\tsd(CentroThemeInitOptions, CentroThemeDataSource.get())\r\n\t\t\t};\r\n\r\n\t\t\t// Adapter for custom request in Centro. However, we don't have any.\r\n\t\t\t// So this is basically return empty object or original URL\r\n\t\t\tconst centroAdapters: IAdapterProviderV3 = {\r\n\t\t\t\trequest: {\r\n\t\t\t\t\tgetAuthToken: () => Promise.resolve(null),\r\n\t\t\t\t\turlResolveHandler: (reqOpt: IRequestOptionsCombined) => {\r\n\t\t\t\t\t\tif (reqOpt.url.includes(CentroPetrolUploadEndpoint)) {\r\n\t\t\t\t\t\t\treturn reqOpt.url;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (reqOpt.backend === BackendTarget.M365AdminCenter) {\r\n\t\t\t\t\t\t\treturn CentroUrlProd + reqOpt.url;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn reqOpt.url;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tawait CentroLoaderWrapper.preloadFeature({\r\n\t\t\t\tfeatureName: CentroFloodgateFeatureName,\r\n\t\t\t\tadapters: { ...centroAdapters, dataSources },\r\n\t\t\t});\r\n\r\n\t\t\tthis.boostStrapper = await CentroLoaderWrapper.bootstrapFeature({\r\n\t\t\t\tfeatureName: CentroFloodgateFeatureName\r\n\t\t\t});\r\n\r\n\t\t\tthis.clientState = DynamicUxClientState.Success;\r\n\t\t\tconst serviceCallTime = performance.now() - timeBefore;\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.DYNAMICUX_LOAD_SUCCESS,\r\n\t\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t\t{\r\n\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\tcatch (error) {\r\n\t\t\tthis.clientState = DynamicUxClientState.Failure;\r\n\t\t\tconst serviceCallTime = performance.now() - timeBefore;\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.DYNAMICUX_LOAD_FAILURE,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tTimeMilliseconds: serviceCallTime,\r\n\t\t\t\t\tErrorMessage: `Error: ${error.toString()}, Error stack: ${error.stack}`,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tConfiguration.get().getCommonInitOptions().onError(`Failed to download Dynamic survey UX: ${error}`);\r\n\t\t}\r\n\r\n\t\t// Perform the callback if there is any survey waiting\r\n\t\t// The user-initiated-survey has higher priority than system-initated-survey\r\n\t\tif (this.userSurveyCallback) {\r\n\t\t\tthis.userSurveyCallback(this.clientState);\r\n\t\t\tthis.userSurveyCallback = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.systemSurveyCallback) {\r\n\t\t\tthis.systemSurveyCallback(this.clientState);\r\n\t\t\tthis.systemSurveyCallback = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlet dynamicUxClient;\r\n\r\n/**\r\n * Get the current Dynamic Ux Client\r\n */\r\nexport function get(): DynamicUxClient {\r\n\treturn dynamicUxClient;\r\n}\r\n\r\n/**\r\n * Setup the Dynamic Ux Client\r\n */\r\nexport function setup(config: IDynamicUxConfig) {\r\n\tif (!dynamicUxClient) {\r\n\t\tdynamicUxClient = new DynamicUxClient();\r\n\t}\r\n\tdynamicUxClient.setup(config);\r\n}\r\n", "/**\n * The Verb used for the HTTP request\n */\nexport var RequestVerb;\n(function (RequestVerb) {\n    /**\n     * HTTP GET method\n     */\n    RequestVerb[\"GET\"] = \"GET\";\n    /**\n     * HTTP PUT method\n     */\n    RequestVerb[\"PUT\"] = \"PUT\";\n    /**\n     * HTTP POST method\n     */\n    RequestVerb[\"POST\"] = \"POST\";\n    /**\n     * HTTP DELETE method\n     */\n    RequestVerb[\"DELETE\"] = \"DELETE\";\n    /**\n     * HTTP PATCH method\n     */\n    RequestVerb[\"PATCH\"] = \"PATCH\";\n})(RequestVerb || (RequestVerb = {}));\n/**\n * The target of the HTTP call\n */\nexport var BackendTarget;\n(function (BackendTarget) {\n    BackendTarget[\"M365AdminCenter\"] = \"MAC\";\n    BackendTarget[\"Mover\"] = \"Mover\";\n    BackendTarget[\"ExchangeAdminCenter\"] = \"EAC\";\n    BackendTarget[\"SharepointAdminCenter\"] = \"SPO\";\n    BackendTarget[\"TeamsAdminCenter\"] = \"TAC\";\n    BackendTarget[\"ComplianceAdminCenter\"] = \"CAC\";\n    BackendTarget[\"SecurityAdminCenter\"] = \"SAC\";\n    BackendTarget[\"ProductivityAdminCenter\"] = \"PAC\";\n    BackendTarget[\"GraphApi\"] = \"Graph\";\n    BackendTarget[\"VRoomApi\"] = \"VRoom\";\n    BackendTarget[\"DeviceCareApi\"] = \"DeviceCare\";\n    BackendTarget[\"RecommendationApi\"] = \"Reco\";\n    BackendTarget[\"M365AoboApi\"] = \"M365Aobo\";\n    BackendTarget[\"Assist\"] = \"Assist\";\n    BackendTarget[\"BusinessApplicationPlatform\"] = \"PPACBap\";\n    BackendTarget[\"PowerPlatformConfigService\"] = \"PPACConfigService\";\n    BackendTarget[\"PowerPlatformAPITenantLevel\"] = \"ppapi-tenant-level\";\n    BackendTarget[\"PowerPlatformAPIEnvironmentLevel\"] = \"ppapi-environment-level\";\n    BackendTarget[\"PowerPlatformAPITenantLevelPreProd\"] = \"ppapi-tenant-level-preprod\";\n    BackendTarget[\"PowerPlatformAPIEnvironmentLevelPreProd\"] = \"ppapi-environment-level-preprod\";\n    BackendTarget[\"DynamicsCRM\"] = \"dynamics-crm\";\n    BackendTarget[\"LicensingAPI\"] = \"LicAPI\";\n    BackendTarget[\"PPApiTenantLevel\"] = \"PPApiTenantLevel\";\n    BackendTarget[\"Fusion\"] = \"Fusion\";\n    BackendTarget[\"VivaPulse\"] = \"VivaPulse\";\n    BackendTarget[\"CloudPolicyServiceApi\"] = \"OCPS\";\n    BackendTarget[\"ECS\"] = \"ECS\";\n    BackendTarget[\"O365ShellServices\"] = \"O365Shell\";\n    BackendTarget[\"ProfileService\"] = \"ProfileService\";\n    BackendTarget[\"VsbHub\"] = \"VsbHub\";\n    BackendTarget[\"Augloop\"] = \"Augloop\";\n    BackendTarget[\"EmbeddedFinanceService\"] = \"EmbeddedFinanceService\";\n    BackendTarget[\"AzureResourceManager\"] = \"ARM\";\n    BackendTarget[\"SubstrateSearchService\"] = \"3S\";\n    BackendTarget[\"Tulips\"] = \"Tulips\";\n    BackendTarget[\"M365Rewards\"] = \"M365Rewards\";\n    BackendTarget[\"DevicesMgmtApi\"] = \"DevicesMgmtApi\";\n    BackendTarget[\"Recommender\"] = \"Recommender\";\n    BackendTarget[\"UnifiedAdminApp\"] = \"UnifiedAdminApp\";\n})(BackendTarget || (BackendTarget = {}));\n/**\n * When this is used as request URL, then a token response should be sent\n */\nexport var TokenOnlyRequestUrl = '__token__';\n", "/**\r\n * Utils.ts\r\n *\r\n * Module for utility functions\r\n */\r\n\r\nimport { Classes, Tags } from \"./UiConstants\";\r\n\r\n/**\r\n * Set HTML element visibility\r\n * @param {string} id The Id of the HTML element\r\n * @param {any} vis The visibility to be set (true or false)\r\n * @return {void}\r\n */\r\nexport function setElementVisibility(id: string, vis: boolean): void {\r\n\tconst oldClassName: string = vis ? Classes.Hidden : Classes.Visible;\r\n\tconst newClassName: string = vis ? Classes.Visible : Classes.Hidden;\r\n\r\n\treplaceClassesById(id, oldClassName, newClassName);\r\n}\r\n\r\n/**\r\n * Delete HTML element by Id\r\n * @param {string} id The Id of the HTML element\r\n * @return {void}\r\n */\r\nexport function deleteElementById(id: string): void {\r\n\tconst element: HTMLElement = document.getElementById(id);\r\n\tif (element != null && element.parentNode != null) {\r\n\t\telement.parentNode.removeChild(element);\r\n\t}\r\n}\r\n\r\n/**\r\n * Add a CSS class to an HTML element by Id\r\n * @param {string} id The Id of the HTML element\r\n * @param {string} newClassName The name of CSS class to be added\r\n * @return {void}\r\n */\r\nexport function addClassById(id: string, newClass: string): void {\r\n\tconst element: HTMLElement = document.getElementById(id);\r\n\r\n\tif (!element) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// check is the class already exists, if not add it\r\n\tif (!element.className.match(new RegExp(\"\\\\b\" + newClass + \"\\\\b\"))) {\r\n\t\t// we use className instead of classList to support IE9\r\n\t\telement.className = element.className + \" \" + newClass;\r\n\t}\r\n}\r\n\r\n/**\r\n * Delete a CSS class of an HTML element by Id\r\n * @param {string} id The Id of the HTML element\r\n * @param {string} oldClassName The name of CSS class to be deleted\r\n * @return {void}\r\n */\r\nexport function deleteClassById(id: string, oldClass: string): void {\r\n\tconst element: HTMLElement = document.getElementById(id);\r\n\r\n\tif (!element) {\r\n\t\treturn;\r\n\t}\r\n\r\n\t// we use className instead of classList to support IE9\r\n\t// get rid of any occurrences of the class we don\"t want\r\n\telement.className = element.className.split(new RegExp(\"\\\\b\" + oldClass + \"\\\\b\", \"i\")).join(\" \");\r\n\r\n\t// get rid of extra whitespaces\r\n\telement.className = element.className.split(/\\s+/).join(\" \");\r\n}\r\n\r\n/**\r\n * Delete an CSS class and (or) add an CSS class to an HTML element by Id\r\n * @param {string} id The Id of the HTML element\r\n * @param {string} oldClassName The name of CSS class to be deleted\r\n * @param {string} newClassName The name of CSS class to be added\r\n * @return {void}\r\n */\r\nexport function replaceClassesById(id: string, oldClassName?: string, newClassName?: string): void {\r\n\tdeleteClassById(id, oldClassName);\r\n\taddClassById(id, newClassName);\r\n}\r\n\r\n/**\r\n * Set attribute on an HTML element\r\n * @param {string} id The Id of the HTML element\r\n * @param {string} attriName The attribute name\r\n * @param {string} attriValue The attribute value\r\n * @return {void}\r\n */\r\nexport function setAttributeOnHtmlElement(id: string, attriName: string, attriValue: string): void {\r\n\tconst htmlElement: HTMLElement = <HTMLElement>document.getElementById(id);\r\n\tif (htmlElement) {\r\n\t\thtmlElement.setAttribute(attriName, attriValue);\r\n\t}\r\n}\r\n\r\n/**\r\n * Add event listener helper function (wrapper) that deals with IE 8 compatability\r\n * @param object The object to add event listener to\r\n * @param type The event type\r\n * @param listener The listener function\r\n */\r\nexport function addEventListenerHelper(object: any, type: string, listener: (event: Event) => void): void {\r\n\tif (object.addEventListener) {\r\n\t\tobject.addEventListener(type, listener, false);\r\n\t} else if (object.attachEvent) {\r\n\t\tobject.attachEvent(\"on\" + type, listener);\r\n\t}\r\n}\r\n\r\n/**\r\n * Remove event listener helper function (wrapper) that deals with IE 8 compatability\r\n * @param object The object to remove event listener from\r\n * @param type The event type\r\n * @param listener The listener function\r\n */\r\nexport function removeEventListenerHelper(object: any, type: string, listener: (event: Event) => void): void {\r\n\tif (object.removeEventListener) {\r\n\t\tobject.removeEventListener(type, listener, false);\r\n\t} else if (object.detachEvent) {\r\n\t\tobject.detachEvent(\"on\" + type, listener);\r\n\t}\r\n}\r\n\r\n/**\r\n * Register event listener\r\n * @param id The Id of the HTML element\r\n * @param type The event type\r\n * @param listener The listener function\r\n */\r\nexport function registerListener(id: string, type: string, listener: (event: Event) => void): void {\r\n\tconst element: HTMLElement = document.getElementById(id);\r\n\tif (element) {\r\n\t\taddEventListenerHelper(element, type, listener);\r\n\t}\r\n}\r\n\r\n/**\r\n * Register event listener\r\n * @param element The HTML element\r\n * @param type The event type\r\n * @param listener The listener function\r\n */\r\nexport function registerListenerToElement(element: HTMLElement, type: string, listener: (event: Event) => void): void {\r\n\tif (element) {\r\n\t\taddEventListenerHelper(element, type, listener);\r\n\t}\r\n}\r\n\r\n/**\r\n * Un-register event listener\r\n * @param id The Id of the HTML element\r\n * @param type The event type\r\n * @param listener The listener function\r\n */\r\nexport function unregisterListener(id: string, type: string, listener: (event: Event) => void): void {\r\n\tconst element: HTMLElement = document.getElementById(id);\r\n\tif (element) {\r\n\t\tremoveEventListenerHelper(element, type, listener);\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns the version of Internet Explorer or -1 for non-IE browser\r\n * @return {number} The IE version\r\n */\r\nexport function getInternetExplorerVersion(): number {\r\n\tlet rv = -1;\r\n\tconst ua = window.navigator.userAgent;\r\n\r\n\t// since IE 11, 'MSIE' is not a keyword in its user agent string anymore\r\n\t// determine whether the browser is IE or not, and the version of IE based on Trident keyword and its version\r\n\tif (ua.indexOf(\"Trident\") > -1) {\r\n\t\tconst re = new RegExp(\"Trident/([0-9]{1,}[\\.0-9]{0,})\"); /* eslint-disable-line no-useless-escape */\r\n\t\tif (re.exec(ua) != null) {\r\n\t\t\trv = parseFloat(RegExp.$1);\r\n\t\t\trv += 4; // trident version + 4 is the IE version\r\n\t\t}\r\n\t}\r\n\treturn rv;\r\n}\r\n\r\n/**\r\n * Check if the current text direction is right to left\r\n */\r\nexport function isRightToLeft(): boolean {\r\n\treturn getComputedStyle(document.documentElement).direction === \"rtl\";\r\n}\r\n\r\n/**\r\n * Get the DIV by given ID. If the DIV does not exist, create one and append it to the body.\r\n * @param {string} divId The Id of the DIV\r\n * @param {boolean} appendToBody Whether to append the DIV to the body\r\n * @param {boolean} appendAsFirstChild Whether to append the DIV as the first child of the body, otherwise it appends as last child.\r\n *  This parameter is only valid when appendToBody is true.\r\n * @return {HTMLElement} The Div HtmlELement\r\n */\r\nexport function getOrCreateDiv(divId: string, appendToBody = true, appendAsFirstChild = true): HTMLElement {\r\n\tlet divElement;\r\n\r\n\tif (divId) {\r\n\t\tdivElement = document.getElementById(divId);\r\n\t}\r\n\r\n\tif (!divElement) {\r\n\t\tdivElement = document.createElement(Tags.Div);\r\n\t\tdivElement.id = divId;\r\n\t\tif (appendToBody) {\r\n\t\t\tif (appendAsFirstChild) {\r\n\t\t\t\tdocument.body.insertBefore(divElement, document.body.firstChild);\r\n\t\t\t} else {\r\n\t\t\t\tdocument.body.appendChild(divElement);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn divElement;\r\n}", "/**\r\n * CentroCoreDataSource.ts\r\n *\r\n * Module for all initialization options for Centro\r\n */\r\n\r\nimport { IFloodgateHostPlatform } from '@ms-ofb/floodgate-shared-typings';\r\nimport { ConfigUpdatedListener } from \"@ms/centro-hvc-loader\";\r\nimport * as Configuration from \"../../Configuration/Configuration\";\r\nimport { AgeGroup, AuthenticationType } from \"../../Configuration/Configuration\";\r\nimport * as Constants from \"../../Constants\";\r\nimport { SDK_VERSION_PREFIX } from \"../../Constants\";\r\nimport { convertAutoDismissToTimeInMs, ocpsBooleanToString, ocpsEnumToString } from \"../../Utils\";\r\nimport Version from \"../../Version\";\r\nimport * as Window from \"./../../Window/Window\";\r\nimport { ICentroDataOptions, ICentroInitOptions, ICentroLaunchOptions } from \"./CentroInterfaces\";\r\n\r\n// This is the object which is used to open/close/update data to Floodgate Centro\r\nexport class CentroCoreDataSource {\r\n\t/* Centro Init options which are not changing */\r\n\tpublic centroInitOptions: ICentroInitOptions;\r\n\r\n\t/* Centro Launch options which are subjective to be changed per survey triggering */\r\n\tpublic centroLaunchOptions: ICentroLaunchOptions;\r\n\r\n\t/* This is the list of listeners need to be invoked when the initOptions change */\r\n\tprivate listeners: ConfigUpdatedListener<ICentroDataOptions>[] = [];\r\n\r\n\tprivate static instance: CentroCoreDataSource;\r\n\r\n\tpublic static get() {\r\n\t\tif (!this.instance) {\r\n\t\t\tthis.instance = new CentroCoreDataSource();\r\n\t\t}\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tconst complianceChecks = {\r\n\t\t\tauthenticationType: AuthenticationType[(Configuration.get().getCommonInitOptions()?.authenticationType) ??\r\n\t\t\t\tAuthenticationType.Unauthenticated],\r\n\t\t\tageGroup: AgeGroup[(Configuration.get().getCommonInitOptions()?.ageGroup) ?? AgeGroup.Undefined],\r\n\t\t\tpolicyAllowFeedback: ocpsEnumToString(Configuration.get().getInAppFeedbackInitOptions()?.sendFeedbackPolicyValue),\r\n\t\t\tpolicyAllowSurvey: ocpsBooleanToString(Configuration.get().getFloodgateInitOptions()?.surveyEnabled),\r\n\t\t\tpolicyAllowScreenshot: ocpsEnumToString(Configuration.get().getCommonInitOptions()?.screenshotPolicyValue),\r\n\t\t\tpolicyAllowContact: ocpsEnumToString(Configuration.get().getCommonInitOptions()?.emailPolicyValue),\r\n\t\t};\r\n\r\n\t\tthis.centroInitOptions = {\r\n\t\t\t// common init options\r\n\t\t\tcommonInitOptions: {\r\n\t\t\t\tappId: Configuration.get().getCommonInitOptions().appId,\r\n\t\t\t\tapplication: Configuration.get().getCommonInitOptions().applicationGroup,\r\n\t\t\t\tcomplianceChecks: complianceChecks,\r\n\t\t\t\tisProduction: Configuration.get().getCommonInitOptions().environment === Constants.Environment.Production,\r\n\t\t\t\tretentionDurationDays: Configuration.get().getCommonInitOptions().retentionDurationDays,\r\n\t\t\t\tsdkVersion: SDK_VERSION_PREFIX + (Window.get().OfficeBrowserFeedback.sdkVersion !== undefined ?\r\n\t\t\t\t\tWindow.get().OfficeBrowserFeedback.sdkVersion : Version),\r\n\t\t\t\ttelemetry: Configuration.get().getCommonInitOptions().telemetryGroup,\r\n\t\t\t\tweb: Configuration.get().getCommonInitOptions().webGroup,\r\n\t\t\t\tlocale: Configuration.get().getCommonInitOptions().originalLocale,\r\n\t\t\t\tuserEmail: Configuration.get().getCommonInitOptions().userEmail,\r\n\t\t\t\tshowEmailAddress: Configuration.get().getFloodgateInitOptions().showEmailAddress,\r\n\t\t\t},\r\n\r\n\t\t\tautoDismissValues: {\r\n\t\t\t\tpromptAutoDismissTimeInMs: convertAutoDismissToTimeInMs(Configuration.get().getFloodgateInitOptions().autoDismiss),\r\n\t\t\t},\r\n\t\t\thostPlatform: IFloodgateHostPlatform.Web,\r\n\t\t};\r\n\t}\r\n\r\n\t/*\r\n\tRegister and Unregister is part of the boilerplate code to enable dynamic data passing\r\n\t*/\r\n\tpublic register(\r\n\t\tlistener?: ConfigUpdatedListener<ICentroDataOptions>\r\n\t): Readonly<Partial<ICentroDataOptions>> {\r\n\t\tif (listener) {\r\n\t\t\tthis.listeners.push(listener);\r\n\t\t}\r\n\t\tconst centroDataOptions: ICentroDataOptions = {\r\n\t\t\t...this.centroInitOptions,\r\n\t\t\t...this.centroLaunchOptions\r\n\t\t}\r\n\t\treturn centroDataOptions;\r\n\t}\r\n\r\n\tpublic unregister(listener: ConfigUpdatedListener<ICentroDataOptions>): void {\r\n\t\tconst index = this.listeners.indexOf(listener);\r\n\t\tif (index > -1) {\r\n\t\t\tthis.listeners.splice(index, 1);\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tUpdate function to update the data source with the current survey\r\n\t */\r\n\tpublic updateFloodgateSurvey(onClose: () => void) {\r\n\t\t// Update the CentroLaunchOptions with new survey info\r\n\t\tthis.centroLaunchOptions = {\r\n\t\t\tuxSchema: Configuration.get().getFloodgateSurvey().getUxSchema(),\r\n\t\t\tclientFeedbackId: Configuration.get().getFloodgateSurvey().getPreGeneratedClientFeedbackId(),\r\n\t\t\tcampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\tsurveyId: Configuration.get().getFloodgateSurvey().getId(),\r\n\t\t\tsurveyType: Configuration.get().getFloodgateSurvey().getSurveyType(),\r\n\t\t\tisUserInitiatedSurvey: Configuration.get().getFloodgateSurvey().isUserInitiatedSurvey(),\r\n\t\t\tcallbackFunctions: {\r\n\t\t\t\tonDismiss: (submitted: boolean) => {\r\n\t\t\t\t\tConfiguration.get().getFloodgateInitOptions().onDismiss(\r\n\t\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\t\t\t\tsubmitted,\r\n\t\t\t\t\t);\r\n\t\t\t\t\tonClose();\r\n\t\t\t\t},\r\n\t\t\t\tonError: (errorMessage: string) => {\r\n\t\t\t\t\tConfiguration.get().getCommonInitOptions().onError(errorMessage);\r\n\t\t\t\t\tonClose();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst centroDataOptions: ICentroDataOptions = {\r\n\t\t\t...this.centroInitOptions,\r\n\t\t\t...this.centroLaunchOptions\r\n\t\t};\r\n\r\n\t\t// we need to inform the existing listeners\r\n\t\tthis.listeners.forEach((listener: ConfigUpdatedListener<ICentroDataOptions>) => listener(centroDataOptions));\r\n\t}\r\n}\r\n", "export var LogKind;\n(function (LogKind) {\n    LogKind[\"Info\"] = \"Info\";\n    LogKind[\"Error\"] = \"Error\";\n    /**\n     * Engagement/Analytics logging\n     */\n    LogKind[\"Analytics\"] = \"Analytics\";\n    /**\n     * Performance related logging\n     */\n    LogKind[\"Performance\"] = \"Performance\";\n    /**\n     * Interface kind is dedicated for module's logging of interfacing informations.\n     * To improve interoperability and debugging.\n     */\n    LogKind[\"Interface\"] = \"Interface\";\n    /**\n     * Logs dedicated to availability.\n     */\n    LogKind[\"Availability\"] = \"Availability\";\n    /**\n     * Logs dedicated to availability.\n     */\n    LogKind[\"Reliability\"] = \"Reliability\";\n    /**\n     * Centro Framework level logging.\n     */\n    LogKind[\"Framework\"] = \"Framework\";\n    /**\n     * Flight related logging.\n     */\n    LogKind[\"Flight\"] = \"Flight\";\n})(LogKind || (LogKind = {}));\n/*\nthis enumeration is used to categorize client logs in kusto to help with data mining, reporting and querying logs\n*/\nexport var LogCategory;\n(function (LogCategory) {\n    LogCategory[\"ClientInfo\"] = \"ClientInfo\";\n    LogCategory[\"ClientError\"] = \"ClientError\";\n    /**\n     * logs related to Engagement/Analytics\n     */\n    LogCategory[\"ClientAnalytics\"] = \"ClientAnalytics\";\n    /**\n     * Logs related to Performance\n     */\n    LogCategory[\"ClientPerformance\"] = \"ClientPerformance\";\n    /**\n     * Logs related to availability.\n     */\n    LogCategory[\"ClientAvailability\"] = \"ClientAvailability\";\n    /*\n    Logs related to reliability\n    */\n    LogCategory[\"ClientReliability\"] = \"ClientReliability\";\n    /*\n    Logs related to Centro framework\n    */\n    LogCategory[\"ClientFramework\"] = \"ClientFramework\";\n})(LogCategory || (LogCategory = {}));\n/*\nprefixes for PLT perf markers\n*/\nexport var PerfMarkerPrefix;\n(function (PerfMarkerPrefix) {\n    PerfMarkerPrefix[\"Microsoft365AdminCenter\"] = \"@ms/mac\";\n})(PerfMarkerPrefix || (PerfMarkerPrefix = {}));\n/**\n * A type guard to check if the log is a info log\n *\n * @param option a ILogOptions\n */\nexport function isInfo(option) {\n    return option.type === LogKind.Info || option.type === LogKind.Interface;\n}\n/**\n * A type guard to check if the log is a error log\n *\n * @param option a ILogOptions\n */\nexport function isError(option) {\n    return option.type === LogKind.Error;\n}\n/**\n * A type guard to check if the log is a analytics log\n *\n * @param option a ILogOptions\n */\nexport function isAnalytics(option) {\n    return option.type === LogKind.Analytics;\n}\n/**\n * A type guard to check if the log is a performance log\n *\n * @param option a ILogOptions\n */\nexport function isPerformance(option) {\n    return option.type === LogKind.Performance;\n}\n/**\n * A type guard to check if the log is an availability log\n *\n * @param option a ILogOptions\n */\nexport function isAvailability(option) {\n    return option.type === LogKind.Availability;\n}\n/**\n * A type guard to check if the log is an reliability log\n *\n * @param option a ILogOptions\n */\nexport function isReliability(option) {\n    return option.type === LogKind.Reliability;\n}\n/**\n * A type guard to check if the log is a framework log\n *\n * @param option a ILogOptions\n */\nexport function isFramework(option) {\n    return option.type === LogKind.Framework;\n}\n/**\n * A type guard to check if the log is a flight log\n *\n * @param option a ILogOptions\n */\nexport function isFlight(option) {\n    return option.type === LogKind.Flight;\n}\n", "import { LogCategory, LogKind } from './log.types';\nvar registeredLoggers = new Map();\nexport function addLogger(name, loggerObj) {\n    if (registeredLoggers.has(name)) {\n        throw new Error(\"Logger \" + name + \" already exists\");\n    }\n    registeredLoggers.set(name, loggerObj);\n}\nexport function removeLogger(name) {\n    registeredLoggers.delete(name);\n}\nexport function broadcastLogger(options) {\n    broadCastTo(options, registeredLoggers);\n}\nexport function addAdditionalLoggers(additionalLoggers) {\n    if (additionalLoggers) {\n        Object.keys(additionalLoggers).forEach(function (key) {\n            addLogger(key, { logger: additionalLoggers[key] });\n        });\n    }\n}\nexport function flush() {\n    var flushArray = [];\n    registeredLoggers.forEach(function (loggerObj) {\n        if (loggerObj.flush) {\n            flushArray.push(loggerObj.flush());\n        }\n    });\n    return Promise.all(flushArray);\n}\nfunction broadCastTo(options, loggers) {\n    // eslint-disable-next-line @typescript-eslint/typedef\n    loggers.forEach(function (loggerObj, name) {\n        try {\n            loggerObj.logger(options);\n        }\n        catch (error) {\n            var restLoggers = new Map(loggers);\n            restLoggers.delete(name);\n            broadCastTo({\n                id: '500294',\n                type: LogKind.Error,\n                logCategory: LogCategory.ClientError,\n                message: \"Failure in logger: \" + name,\n                error: error,\n            }, restLoggers);\n        }\n    });\n}\n/**\n * Log messages\n */\nexport var log = broadcastLogger;\n", "import { __awaiter, __generator, __values } from \"tslib\";\nimport { log } from '../logging/broadcastLogger';\nimport { LogKind } from '../logging/log.types';\nfunction decorateElement(element, attributes) {\n    if (!attributes) {\n        return;\n    }\n    for (var attr in attributes) {\n        if (attributes.hasOwnProperty(attr)) {\n            // this can be any attributes\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            ;\n            element[attr] = attributes[attr];\n        }\n    }\n}\nfunction loadScriptUrl(leaf, sourceDOM, trustedTypePolicy) {\n    return __awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return __generator(this, function (_a) {\n            // @ts-ignore TODO: TS Bug, remove once upgrade\n            return [2 /*return*/, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                    function attemptToLoadScript(retry) {\n                        return __awaiter(this, void 0, void 0, function () {\n                            var scriptElement, scriptUrl;\n                            var _this = this;\n                            return __generator(this, function (_a) {\n                                scriptElement = sourceDOM.createElement('script');\n                                scriptUrl = (trustedTypePolicy === null || trustedTypePolicy === void 0 ? void 0 : trustedTypePolicy.createScriptURL)\n                                    ? trustedTypePolicy.createScriptURL(leaf.content)\n                                    : leaf.content;\n                                scriptElement.src = scriptUrl;\n                                scriptElement.onload = function () {\n                                    if (!retry) {\n                                        log({\n                                            type: LogKind.Info,\n                                            message: \"Script successfully loaded after retry: \" + scriptUrl,\n                                            id: '536622',\n                                            data: {\n                                                script: scriptUrl,\n                                            },\n                                        });\n                                    }\n                                    resolve();\n                                };\n                                scriptElement.onerror = function () { return __awaiter(_this, void 0, void 0, function () {\n                                    var response, contentTypeHeader, requestIdHeader, cdnProviderHeader, err_1;\n                                    return __generator(this, function (_a) {\n                                        switch (_a.label) {\n                                            case 0:\n                                                scriptElement.remove();\n                                                _a.label = 1;\n                                            case 1:\n                                                _a.trys.push([1, 6, , 7]);\n                                                return [4 /*yield*/, fetch(scriptUrl)];\n                                            case 2:\n                                                response = _a.sent();\n                                                contentTypeHeader = response.headers.get('content-type');\n                                                requestIdHeader = response.headers.get('x-ms-request-id');\n                                                cdnProviderHeader = response.headers.get('x-cdn-provider');\n                                                if (!retry) return [3 /*break*/, 4];\n                                                log({\n                                                    type: LogKind.Info,\n                                                    message: \"Retrying to load script: \" + scriptUrl + \". Status: \" + response.status,\n                                                    id: '536623',\n                                                    data: {\n                                                        script: scriptUrl,\n                                                        status: response.status,\n                                                        contentType: contentTypeHeader,\n                                                        requestId: requestIdHeader,\n                                                        cdnProvider: cdnProviderHeader,\n                                                    },\n                                                });\n                                                return [4 /*yield*/, attemptToLoadScript(false)];\n                                            case 3:\n                                                _a.sent();\n                                                return [3 /*break*/, 5];\n                                            case 4:\n                                                log({\n                                                    type: LogKind.Info,\n                                                    message: \"Failed to load script after retry: \" + scriptUrl + \". Status: \" + response.status,\n                                                    id: '536624',\n                                                    data: {\n                                                        script: scriptUrl,\n                                                        status: response.status,\n                                                        contentType: contentTypeHeader,\n                                                        requestId: requestIdHeader,\n                                                        cdnProvider: cdnProviderHeader,\n                                                    },\n                                                });\n                                                reject(new Error(\"Dynamically loading script \" + scriptUrl + \" failed. Status: \" + response.status + \", content-type: \" + contentTypeHeader + \", x-ms-request-id: \" + requestIdHeader + \", x-cdn-provider: \" + cdnProviderHeader));\n                                                _a.label = 5;\n                                            case 5: return [3 /*break*/, 7];\n                                            case 6:\n                                                err_1 = _a.sent();\n                                                reject(new Error(\"Dynamically loading script \" + scriptUrl + \" failed: \" + err_1));\n                                                return [3 /*break*/, 7];\n                                            case 7: return [2 /*return*/];\n                                        }\n                                    });\n                                }); };\n                                decorateElement(scriptElement, leaf.attributes);\n                                sourceDOM.body.appendChild(scriptElement);\n                                return [2 /*return*/];\n                            });\n                        });\n                    }\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0: return [4 /*yield*/, attemptToLoadScript(true)];\n                            case 1:\n                                _a.sent();\n                                return [2 /*return*/];\n                        }\n                    });\n                }); })];\n        });\n    });\n}\nfunction loadScript(leaf, sourceDOM) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // @ts-ignore TODO: TS Bug, remove once upgrade\n            return [2 /*return*/, new Promise(function (resolve) {\n                    var scriptElement = sourceDOM.createElement('script');\n                    var inlineScript = sourceDOM.createTextNode(leaf.content);\n                    scriptElement.appendChild(inlineScript);\n                    decorateElement(scriptElement, leaf.attributes);\n                    sourceDOM.body.appendChild(scriptElement);\n                    resolve();\n                })];\n        });\n    });\n}\nfunction loadStyleUrl(leaf) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // @ts-ignore TODO: TS Bug, remove once upgrade\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n                    var linkElement = document.createElement('link');\n                    linkElement.rel = 'stylesheet';\n                    linkElement.type = 'text/css';\n                    linkElement.href = leaf.content;\n                    linkElement.onload = function () {\n                        resolve();\n                    };\n                    linkElement.onerror = function () {\n                        reject(new Error(\"Dynamically loading style \" + leaf.content + \" failed\"));\n                    };\n                    decorateElement(linkElement, leaf.attributes);\n                    document.head.appendChild(linkElement);\n                })];\n        });\n    });\n}\nfunction loadStyle(leaf) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // @ts-ignore TODO: TS Bug, remove once upgrade\n            return [2 /*return*/, new Promise(function (resolve) {\n                    var linkElement = document.createElement('link');\n                    linkElement.rel = 'stylesheet';\n                    linkElement.type = 'text/css';\n                    var inlineStyle = document.createTextNode(leaf.content);\n                    linkElement.appendChild(inlineStyle);\n                    decorateElement(linkElement, leaf.attributes);\n                    document.head.appendChild(linkElement);\n                    resolve();\n                })];\n        });\n    });\n}\nexport function dynamicLoader(node, trustedTypePolicy, targetHtmlElementDom) {\n    if (targetHtmlElementDom === void 0) { targetHtmlElementDom = document; }\n    return __awaiter(this, void 0, void 0, function () {\n        var _a, err_2, _b, _c, script, e_1_1, err_3;\n        var e_1, _d;\n        return __generator(this, function (_e) {\n            switch (_e.label) {\n                case 0:\n                    _a = node.type;\n                    switch (_a) {\n                        case 'parallel': return [3 /*break*/, 1];\n                        case 'sequential': return [3 /*break*/, 5];\n                        case 'scriptUrl': return [3 /*break*/, 16];\n                        case 'script': return [3 /*break*/, 18];\n                        case 'styleUrl': return [3 /*break*/, 20];\n                        case 'style': return [3 /*break*/, 22];\n                    }\n                    return [3 /*break*/, 24];\n                case 1:\n                    _e.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, Promise.all(node.children.map(function (n) {\n                            return dynamicLoader(n, trustedTypePolicy);\n                        }))];\n                case 2:\n                    _e.sent();\n                    return [3 /*break*/, 4];\n                case 3:\n                    err_2 = _e.sent();\n                    if (node.optional) {\n                        console.log('Dynamic loading of optional script failed', err_2);\n                    }\n                    else {\n                        throw err_2;\n                    }\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n                case 5:\n                    _e.trys.push([5, 14, , 15]);\n                    _e.label = 6;\n                case 6:\n                    _e.trys.push([6, 11, 12, 13]);\n                    _b = __values(node.children), _c = _b.next();\n                    _e.label = 7;\n                case 7:\n                    if (!!_c.done) return [3 /*break*/, 10];\n                    script = _c.value;\n                    return [4 /*yield*/, dynamicLoader(script, trustedTypePolicy)];\n                case 8:\n                    _e.sent();\n                    _e.label = 9;\n                case 9:\n                    _c = _b.next();\n                    return [3 /*break*/, 7];\n                case 10: return [3 /*break*/, 13];\n                case 11:\n                    e_1_1 = _e.sent();\n                    e_1 = { error: e_1_1 };\n                    return [3 /*break*/, 13];\n                case 12:\n                    try {\n                        if (_c && !_c.done && (_d = _b.return)) _d.call(_b);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                    return [7 /*endfinally*/];\n                case 13: return [3 /*break*/, 15];\n                case 14:\n                    err_3 = _e.sent();\n                    if (node.optional) {\n                        console.log('Dynamic loading of optional script failed', err_3);\n                    }\n                    else {\n                        throw err_3;\n                    }\n                    return [3 /*break*/, 15];\n                case 15: return [2 /*return*/];\n                case 16: return [4 /*yield*/, loadScriptUrl(node, targetHtmlElementDom, trustedTypePolicy)];\n                case 17:\n                    _e.sent();\n                    return [2 /*return*/];\n                case 18: return [4 /*yield*/, loadScript(node, targetHtmlElementDom)];\n                case 19:\n                    _e.sent();\n                    return [2 /*return*/];\n                case 20: return [4 /*yield*/, loadStyleUrl(node)];\n                case 21:\n                    _e.sent();\n                    return [2 /*return*/];\n                case 22: return [4 /*yield*/, loadStyle(node)];\n                case 23:\n                    _e.sent();\n                    return [2 /*return*/];\n                case 24: throw new Error(\"Invalid script loader object \" + JSON.stringify(node));\n            }\n        });\n    });\n}\n", "// This should be the same as Microsoft.Online.BOX.Util.HostApp\nexport var SupportedHostingApps;\n(function (SupportedHostingApps) {\n    SupportedHostingApps[\"M365AdminPortal\"] = \"M365AdminPortal\";\n    SupportedHostingApps[\"SPOAdminPortal\"] = \"SPOAdminPortal\";\n    // This is not the same as SPOAdminPortal - this is for HVCs that will be used in SharePoint Sites.\n    SupportedHostingApps[\"SPOPortal\"] = \"SPOPortal\";\n    SupportedHostingApps[\"EXOAdminPortal\"] = \"EXOAdminPortal\";\n    SupportedHostingApps[\"TeamsAdminPortal\"] = \"TeamsAdminPortal\";\n    SupportedHostingApps[\"SecurityPortal\"] = \"SecurityPortal\";\n    SupportedHostingApps[\"CompliancePortal\"] = \"CompliancePortal\";\n    SupportedHostingApps[\"M365SCCPortal\"] = \"M365SCCPortal\";\n    SupportedHostingApps[\"SupportCentral\"] = \"SupportCentral\";\n    SupportedHostingApps[\"IbizaMTMPortal\"] = \"IbizaMTMPortal\";\n    SupportedHostingApps[\"CloudCostManagementPortal\"] = \"CloudCostManagementPortal\";\n    SupportedHostingApps[\"Rave\"] = \"Rave\";\n    SupportedHostingApps[\"DynamicsPortal\"] = \"DynamicsPortal\";\n    SupportedHostingApps[\"TeamsApp\"] = \"TeamsApp\";\n    SupportedHostingApps[\"M365DefenderSMB\"] = \"M365DefenderSMB\";\n    // Windows 365 Portal is also called as Cloud PC Portal\n    SupportedHostingApps[\"Windows365Portal\"] = \"Windows365Portal\";\n    SupportedHostingApps[\"PPACAdminPortal\"] = \"PPACAdminPortal\";\n    SupportedHostingApps[\"VivaGoals\"] = \"VivaGoals\";\n    SupportedHostingApps[\"VivaPulse\"] = \"VivaPulse\";\n    SupportedHostingApps[\"VivaInsights\"] = \"VivaInsights\";\n    SupportedHostingApps[\"FireSurveysHost\"] = \"FireSurveysHost\";\n    SupportedHostingApps[\"AEM\"] = \"AEM\";\n    SupportedHostingApps[\"ExcelPythonAddon\"] = \"ExcelPythonAddon\";\n    SupportedHostingApps[\"AdminAppMetaOSTeams\"] = \"AdminAppMetaOSTeams\";\n    SupportedHostingApps[\"AdminAppMetaOSOffice\"] = \"AdminAppMetaOSOffice\";\n    SupportedHostingApps[\"AdminAppMetaOSOutlook\"] = \"AdminAppMetaOSOutlook\";\n    SupportedHostingApps[\"Project\"] = \"Project\";\n    SupportedHostingApps[\"Planner\"] = \"Planner\";\n    SupportedHostingApps[\"Visio\"] = \"Visio\";\n    SupportedHostingApps[\"Clipchamp\"] = \"Clipchamp\";\n})(SupportedHostingApps || (SupportedHostingApps = {}));\n// NOTE: those names should be globally unique among all admin centers.\nexport var RuntimeDataSources;\n(function (RuntimeDataSources) {\n    RuntimeDataSources[\"Static\"] = \"centro.runtime.static\";\n    RuntimeDataSources[\"Error\"] = \"centro.hvc.error\";\n    RuntimeDataSources[\"CentroHvcLoader\"] = \"centro.hvc.loader-data\";\n})(RuntimeDataSources || (RuntimeDataSources = {}));\n", "import { __read } from \"tslib\";\nimport { SupportedHostingApps } from '../configuration/runtimeDataSources';\nvar history = undefined;\nexport var parseUrls = function (urlJsonString) {\n    var urlMap = new Map();\n    if (urlJsonString) {\n        var urls = JSON.parse(urlJsonString);\n        Object.entries(urls).forEach(function (_a) {\n            var _b = __read(_a, 2), key = _b[0], value = _b[1];\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            try {\n                urlMap.set(SupportedHostingApps[key], new URL(value));\n            }\n            catch (_c) {\n                // ignore if URL is not valid\n            }\n        });\n    }\n    return urlMap;\n};\nexport function setHistory(newHistory) {\n    history = newHistory;\n}\nexport function getHistory() {\n    if (history === undefined) {\n        throw new Error('History object has not been set');\n    }\n    return history;\n}\n", "import { __read, __spreadArray } from \"tslib\";\nimport { log } from './broadcastLogger';\nimport { LogKind } from './log.types';\n// The wrapper intend to handle any function\n/* eslint-disable @typescript-eslint/no-explicit-any */\nexport function handlerWithAnalytics(onInvoke, hint, payload, payloadCallback) {\n    return function wrappedHandler() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (payloadCallback !== undefined) {\n            payload = payloadCallback.call.apply(payloadCallback, __spreadArray([this, payload], __read(args)));\n        }\n        log({ id: hint, type: LogKind.Analytics, data: JSON.stringify(payload) });\n        if (typeof onInvoke === 'function') {\n            return onInvoke.call.apply(onInvoke, __spreadArray([this], __read(args)));\n        }\n        return;\n    };\n}\nexport function logAnalytics(id, data) {\n    if (data === void 0) { data = ''; }\n    log({\n        id: id,\n        type: LogKind.Analytics,\n        data: data,\n    });\n}\nexport function scrubMessage(message) {\n    // scrub the message, if it is a string\n    var scrubbedMessage = message;\n    try {\n        if (typeof message === 'string') {\n            // replace UPN, %40 is an encoded @\n            scrubbedMessage = scrubbedMessage\n                .replaceAll(/[a-zA-Z0-9_\\-'.]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-]+/g, '<upn>')\n                .replaceAll(/[a-zA-Z0-9_\\-'.]+%40[a-zA-Z0-9-]+\\.[a-zA-Z0-9-]+/g, '<upn>');\n            // replace tokens\n            scrubbedMessage = scrubbedMessage\n                .replaceAll(/eyJ0eX[A-Za-z0-9-_]+\\.+[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=/]+/g, '<token>')\n                .replaceAll(/eyJhbG[A-Za-z0-9-_]+\\.+[A-Za-z0-9-_=]+\\.[A-Za-z0-9-_=/]+/g, '<token>');\n        }\n    }\n    catch (_a) {\n        // do nothing\n    }\n    return scrubbedMessage;\n}\nexport function logError(id, error, message, data) {\n    log({\n        id: id,\n        data: data,\n        type: LogKind.Error,\n        error: error,\n        message: message || error.message,\n    });\n}\nvar ariaLoggerId;\nexport function setAriaLoggerId(ariaLogId) {\n    ariaLoggerId = ariaLogId;\n}\nexport function getAriaLoggerId() {\n    return ariaLoggerId;\n}\nexport function getErrorMessage(error) {\n    return JSON.stringify(error);\n}\n", "import { __awaiter, __generator } from \"tslib\";\nimport { getHistory } from '../routing/history';\nimport { isAnalytics, isError, isFlight, isFramework, isPerformance, LogCategory, } from './log.types';\nimport { scrubMessage } from './loggingUtils';\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"Trace\"] = 0] = \"Trace\";\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\n    LogLevel[LogLevel[\"Comment\"] = 2] = \"Comment\";\n    LogLevel[LogLevel[\"Warning\"] = 3] = \"Warning\";\n    LogLevel[LogLevel[\"Error\"] = 4] = \"Error\";\n    LogLevel[LogLevel[\"Critical\"] = 5] = \"Critical\";\n})(LogLevel || (LogLevel = {}));\n// This is the same id used in backend - /libs/SuiteShared/Server/Util/Logging/Log.cs\nvar UnifiedFlightTagID = 526460;\nvar loggingQueueLocked = true;\nexport function makeMacKustoLogger(appIdStr, kustoEndpointStr, hostNameStr, versionInfoStr) {\n    var loggingQueueInterval = 1000;\n    var queue = [];\n    var xhrPromise = Promise.resolve();\n    var remoteLoggerSequenceNumber = 0;\n    var appId = appIdStr;\n    var kustoEndpoint = kustoEndpointStr;\n    var hostName = hostNameStr;\n    var versionInfo = versionInfoStr;\n    var isNextSendLogScheduled = false;\n    /**\n     * Type confirms with server-side contract\n     */\n    var scheduleNextSend = function () {\n        // Schedule the next send if there are still items in the queue and queue is not locked to unnecesary executions\n        if (queue.length === 0 || loggingQueueLocked) {\n            isNextSendLogScheduled = false;\n            return;\n        }\n        isNextSendLogScheduled = true;\n        setTimeout(function () {\n            sendInstrumentRequest().catch(function () {\n                // do nothing as this is invoked from setTimeout needs to be safe\n            });\n        }, loggingQueueInterval);\n    };\n    /**\n     * Http request used exclusively for talking with /api/instrument\n     */\n    var sendInstrumentRequest = function () {\n        if (queue.length === 0 || loggingQueueLocked) {\n            scheduleNextSend();\n            return Promise.resolve();\n        }\n        // TODO: sendBeacon() is broken right now in Chrome:\n        // http://crbug.com/490015\n        xhrPromise = new Promise(function (resolve, reject) {\n            var req = new XMLHttpRequest();\n            req.open('POST', kustoEndpoint, true);\n            req.setRequestHeader('Content-Type', 'application/json');\n            // Set common headers\n            req.setRequestHeader('x-ms-mac-hostingapp', hostName);\n            req.setRequestHeader('x-ms-mac-appid', appId);\n            req.setRequestHeader('x-ms-mac-version', versionInfo);\n            req.onreadystatechange = function () {\n                if (req.readyState === XMLHttpRequest.DONE) {\n                    if (req.status !== 204) {\n                        var err = new Error(\"Request to /api/instrument/logclient failed, server responseCode: \" + req.status + \" body: \" + req.response);\n                        console.log(err);\n                        reject(err);\n                        return;\n                    }\n                    resolve();\n                }\n            };\n            var data = queue.splice(0, queue.length);\n            req.send(JSON.stringify(data));\n        });\n        return xhrPromise.then(scheduleNextSend);\n    };\n    scheduleNextSend();\n    var queueLog = function (data) {\n        queue.push(data);\n        // Schedule the next send on demand\n        if (!isNextSendLogScheduled) {\n            scheduleNextSend();\n        }\n    };\n    function flush() {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, Promise.all([xhrPromise, sendInstrumentRequest()]).then(function () {\n                        return;\n                    })];\n            });\n        });\n    }\n    function macKustoLogger(options) {\n        // only log anything that is not analytics, perf, or framework\n        if (isAnalytics(options) || isPerformance(options) || isFramework(options)) {\n            return;\n        }\n        remoteLoggerSequenceNumber += 1;\n        var pathName = '', flyoutName = '';\n        try {\n            pathName = getHistory().location.pathname;\n            if (pathName !== null && pathName.indexOf(':') !== -1) {\n                var pathArray = pathName.split(':');\n                pathName = pathArray[0];\n                flyoutName = pathArray[1];\n            }\n        }\n        catch (error) {\n            pathName = '';\n            flyoutName = '';\n        }\n        if (isFlight(options)) {\n            // Flight log: AdHoc0=flightName, AdHoc1=flight data\n            queueLog({\n                TagId: UnifiedFlightTagID,\n                LogLevel: LogLevel.Info,\n                LogCategory: LogCategory.ClientAnalytics,\n                Message: \"UI Flight: \" + options.flightName,\n                Adhoc0: options.flightName,\n                Adhoc1: JSON.stringify(options.flightData),\n                Adhoc2: scrubMessage(JSON.stringify(options.data)),\n                Adhoc3: remoteLoggerSequenceNumber.toString(),\n                Adhoc5: scrubMessage(flyoutName),\n                PageName: scrubMessage(pathName),\n            });\n        }\n        else {\n            var tagId = parseInt(options.id, 10);\n            queueLog({\n                TagId: tagId,\n                LogLevel: LogLevel.Info,\n                LogCategory: options.logCategory || LogCategory.ClientInfo,\n                Message: scrubMessage(options.message || ''),\n                Adhoc0: appId,\n                Adhoc1: remoteLoggerSequenceNumber.toString(),\n                Adhoc2: scrubMessage(JSON.stringify({\n                    data: options.data,\n                })),\n                Adhoc5: scrubMessage(flyoutName),\n                PageName: scrubMessage(pathName),\n            });\n            if (isError(options)) {\n                var stack = options.error.stack || '';\n                // log the stack under 500781\n                queueLog({\n                    TagId: 500781,\n                    LogLevel: LogLevel.Error,\n                    LogCategory: options.logCategory || LogCategory.ClientError,\n                    Message: scrubMessage(\"UI Exception: \" + (options.error.message || '')),\n                    Adhoc0: appId,\n                    Adhoc1: remoteLoggerSequenceNumber.toString(),\n                    Adhoc2: scrubMessage(JSON.stringify({\n                        version: versionInfo,\n                        stack: stack,\n                    })),\n                    Adhoc3: tagId.toString(),\n                    Adhoc5: scrubMessage(flyoutName),\n                    PageName: scrubMessage(pathName),\n                });\n            }\n        }\n    }\n    return { logger: macKustoLogger, flush: flush };\n}\nexport function unlockLoggingQueue() {\n    loggingQueueLocked = false;\n}\n/**\n * Use this only for test purposes\n */\nexport function lockLoggingQueue() {\n    loggingQueueLocked = true;\n}\n", "/* eslint-disable no-bitwise */\n/**\n * Create a UUID\n */\nexport function createUUID() {\n    return (1e7 + '' + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function (c) {\n        return (c ^\n            (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (c / 4)))).toString(16);\n    });\n}\n", "export var createTrustedTypesPolicy = function (policyName) {\n    var _a;\n    var ttWindow = window;\n    var trustedTypePolicy;\n    var validCdnUrls = [\n        'https://res.sdf.cdn.office.net',\n        'https://res-3.cdn.partner.office365.cn',\n        'https://res-1-gcch.cdn.office.net',\n        'https://res-1-dod.cdn.office.net',\n        'https://res-1-cdn.azureedge.microsoft.scloud',\n        'https://res-1-cdn.azureedge.eaglex.ic.gov',\n        'https://res-2-dev.cdn.officeppe.net',\n        'https://res-2-h3.sdf.cdn.office.net',\n        'https://res-2-h3.public.cdn.office.net',\n        'https://res-2-gcch.cdn.office.net',\n        'https://res-2-dod.cdn.office.net',\n        'https://res-4.cdn.partner.office365.cn',\n        'https://res-dev.cdn.officeppe.net',\n        'https://res.cdn.office.net',\n        'https://localcdn.centro-dev.com:5555',\n        // OCDI urls\n        'https://res.public.onecdn.static.microsoft',\n        'https://res.df.onecdn.static.microsoft',\n        'https://res-cn.cdn.partner.office365.cn',\n        'https://res-dod.cdn.office.net',\n        'https://res-gcc.cdn.office.net',\n        'https://res-gcch.cdn.office.net',\n        'https://res-1-cdn.azureedge.microsoft.scloud',\n        'https://res-1-cdn.azureedge.eaglex.ic.gov',\n    ];\n    if ((_a = ttWindow === null || ttWindow === void 0 ? void 0 : ttWindow.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy) {\n        try {\n            trustedTypePolicy = ttWindow.trustedTypes.createPolicy(policyName, {\n                createScriptURL: function (url) {\n                    var parseUrl;\n                    try {\n                        parseUrl = new URL(url);\n                    }\n                    catch (error) {\n                        throw new Error(\"Invalid script url \" + url);\n                    }\n                    if ((parseUrl === null || parseUrl === void 0 ? void 0 : parseUrl.protocol) !== 'https:') {\n                        throw new Error(\"Only https protocol is allowed for script url \" + url);\n                    }\n                    if ((parseUrl === null || parseUrl === void 0 ? void 0 : parseUrl.origin) && !validCdnUrls.includes(parseUrl === null || parseUrl === void 0 ? void 0 : parseUrl.origin)) {\n                        throw new Error(\"Loading a script from \" + url + \" is not allowed because the domain is not in the list of trusted domains\");\n                    }\n                    return url;\n                },\n                createScript: undefined,\n                createHTML: undefined,\n            });\n        }\n        catch (error) {\n            console.error('Failed to create trusted type policy', error);\n        }\n    }\n    return trustedTypePolicy;\n};\n", "import { __awaiter, __generator, __read, __spreadArray, __values } from \"tslib\";\nimport { dynamicLoader } from '../runtime/bootstrap/scriptLoader';\nimport { addLogger, log } from '../runtime/logging/broadcastLogger';\nimport { LogKind } from '../runtime/logging/log.types';\nimport { makeMacKustoLogger, unlockLoggingQueue } from '../runtime/logging/macKustoLogger';\nimport { createUUID } from '../runtime/public/utils/uuid';\nimport { createTrustedTypesPolicy } from '../runtime/bootstrap/trustedTypesPolicy';\nexport var hvcTrustedTypePolicy = createTrustedTypesPolicy('@centro/hvc-loader');\nvar globalWindow = window;\nfunction assert(condition, message) {\n    if (!condition) {\n        var error = new Error(message);\n        log({ type: LogKind.Error, message: message, id: '508371', error: error });\n        throw error;\n    }\n}\nfunction getFeatureLoadingState(featureName) {\n    if (globalWindow === undefined) {\n        log({ type: LogKind.Info, message: 'window is undefined', id: '512105' });\n        return false;\n    }\n    if (globalWindow.m365_admin_features === undefined) {\n        log({ type: LogKind.Info, message: 'window.m365_admin_features is undefined', id: '512108' });\n        return false;\n    }\n    if (globalWindow.m365_admin_features.initializers !== undefined &&\n        globalWindow.m365_admin_features.initializers[featureName] !== undefined) {\n        return true;\n    }\n    return false;\n}\nfunction getDbgState(featureName) {\n    var _a, _b;\n    return !!((_b = (_a = globalWindow.m365_admin_features) === null || _a === void 0 ? void 0 : _a.locDbg) === null || _b === void 0 ? void 0 : _b[featureName]);\n}\nvar centroConfigUrl = 'https://cdn.config.centro.core.microsoft/uxversion';\nvar centroBaseUrl = undefined;\nvar uxVersionData = undefined;\nvar loaderInitialized = false;\nvar loggersInitialized = false;\nvar uxVersionDebugData = undefined;\nvar enableQueryParam = false;\nvar consumerAdapters = new Map();\nvar instanceVersionInfo = undefined;\nvar consumerPreConfig = undefined;\nfunction normalizeCasingForUxVersionData(mixedCaseUxVersionData) {\n    if (mixedCaseUxVersionData !== undefined && mixedCaseUxVersionData.hasOwnProperty('__hostApp_config')) {\n        for (var hvcProp in mixedCaseUxVersionData) {\n            if (!hvcProp.startsWith('__')) {\n                mixedCaseUxVersionData[hvcProp.toLowerCase()] = mixedCaseUxVersionData[hvcProp];\n                if (hvcProp.toLowerCase() !== hvcProp) {\n                    delete mixedCaseUxVersionData[hvcProp];\n                }\n            }\n        }\n    }\n    return JSON.stringify(mixedCaseUxVersionData);\n}\n/**\n * Adds a query parameter to a URL.\n *\n * @param versionUrl - The URL to add the query parameter to.\n * @param param - The name of the query parameter.\n * @param value - The value of the query parameter.\n * @returns The updated URL with the added query parameter.\n */\nexport function addQueryParam(versionUrl, param, value) {\n    var url = new URL(versionUrl);\n    url.searchParams.append(param, value);\n    return url.toString();\n}\n/**\n * Retrieves the UX version data from the server.\n * @param queryParams - Optional query parameters to be appended to the URL.\n * @param useCentroConfig - Indicates whether to use the Centro configuration.\n * @param vectors - Optional key-value pairs of vectors to be added to the URL.\n * @returns A Promise that resolves to the UX version data as a string.\n * @throws An error if attempting to get UX version data before preConfig is provided.\n */\nfunction getUxVersionData(queryParams, useCentroConfig, vectors, enableSubFeatures) {\n    if (queryParams === void 0) { queryParams = ''; }\n    if (useCentroConfig === void 0) { useCentroConfig = false; }\n    if (enableSubFeatures === void 0) { enableSubFeatures = false; }\n    return __awaiter(this, void 0, void 0, function () {\n        var error, versionUrl;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (consumerPreConfig === undefined) {\n                        error = new Error('attempting to getUxVersionData before preConfig were provided');\n                        log({ type: LogKind.Error, message: error.message, error: error, id: '508373' });\n                        throw error;\n                    }\n                    versionUrl = \"\" + (useCentroConfig ? centroConfigUrl : centroBaseUrl + '/admin/api/uxversion') + queryParams;\n                    if (enableQueryParam) {\n                        versionUrl = addQueryParam(versionUrl, 'locale', consumerPreConfig.locale);\n                        versionUrl = addQueryParam(versionUrl, useCentroConfig ? 'featureconsumer' : 'hostingapp', consumerPreConfig.hostName);\n                    }\n                    if (enableSubFeatures) {\n                        versionUrl = addQueryParam(versionUrl, 'enableSubFeatures', enableSubFeatures.toString());\n                    }\n                    if (vectors && useCentroConfig) {\n                        Object.entries(vectors).forEach(function (_a) {\n                            var _b = __read(_a, 2), key = _b[0], value = _b[1];\n                            versionUrl = addQueryParam(versionUrl, key, value);\n                        });\n                    }\n                    return [4 /*yield*/, new Promise(function (resolve, reject) {\n                            var req = new XMLHttpRequest();\n                            req.open('GET', versionUrl, true);\n                            if (!enableQueryParam && !useCentroConfig) {\n                                req.setRequestHeader('x-ms-mac-locale', consumerPreConfig.locale);\n                                req.setRequestHeader('x-ms-mac-hostingapp', consumerPreConfig.hostName);\n                            }\n                            req.onreadystatechange = function () {\n                                if (req.readyState === XMLHttpRequest.DONE) {\n                                    var correlationId = req.getResponseHeader('x-ms-correlation-id');\n                                    if (req.status !== 200) {\n                                        var errorMsg = \"Request to \" + versionUrl + \" failed, server responseCode: \" + req.status + \" body: \" + req.response + \" correlationId: \" + correlationId;\n                                        var err = new Error(errorMsg);\n                                        reject(err);\n                                        return;\n                                    }\n                                    try {\n                                        resolve(normalizeCasingForUxVersionData(JSON.parse(req.response)));\n                                    }\n                                    catch (error) {\n                                        var errorMsg = \"Failed to parse JSON response: \" + error.message;\n                                        var err = new Error(errorMsg);\n                                        reject(err);\n                                    }\n                                }\n                            };\n                            req.send();\n                        })];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    });\n}\nfunction getUxVersionDebugData() {\n    return __awaiter(this, void 0, void 0, function () {\n        var _a, _b;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    if (uxVersionDebugData) {\n                        return [2 /*return*/];\n                    }\n                    _b = (_a = JSON).parse;\n                    return [4 /*yield*/, getUxVersionData(\"?locdbg=true\")];\n                case 1:\n                    uxVersionDebugData = _b.apply(_a, [_c.sent()]);\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction getApplicableFeaturesFromUxData(subFeatures) {\n    var e_1, _a, e_2, _b;\n    var res = {};\n    var uxData = uxVersionData;\n    if (!uxData)\n        return res;\n    try {\n        for (var subFeatures_1 = __values(subFeatures), subFeatures_1_1 = subFeatures_1.next(); !subFeatures_1_1.done; subFeatures_1_1 = subFeatures_1.next()) {\n            var currSubFeature = subFeatures_1_1.value;\n            try {\n                for (var _c = (e_2 = void 0, __values(Object.entries(uxData))), _d = _c.next(); !_d.done; _d = _c.next()) {\n                    var _e = __read(_d.value, 2), feature = _e[0], featureData = _e[1];\n                    // This is not feature data skip\n                    if (typeof featureData !== 'object')\n                        continue;\n                    if (feature === 'ariaLoggerId')\n                        continue;\n                    if (feature === 'hostingAppUrls')\n                        continue;\n                    if (feature === '__hostApp_config')\n                        continue;\n                    if ('hostingAppUrls' in featureData)\n                        continue;\n                    if (featureData.subFeatures && featureData.subFeatures.includes(currSubFeature)) {\n                        // Check if feature was already added, if it is, then append otherwise create new entry\n                        if (feature in res) {\n                            res[feature] = __spreadArray(__spreadArray([], __read(res[feature])), [currSubFeature]);\n                        }\n                        else {\n                            res[feature] = [currSubFeature];\n                        }\n                    }\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (subFeatures_1_1 && !subFeatures_1_1.done && (_a = subFeatures_1.return)) _a.call(subFeatures_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    log({\n        type: LogKind.Info,\n        message: 'hvcloader subFeatures was requested',\n        id: '532977',\n        data: {\n            eventName: 'hvcLoader_applicable_features',\n            applicableFeatures: JSON.stringify(res),\n        },\n    });\n    return res;\n}\n/**\n * Initialize the HVC loader.\n *\n * This should be called before calling any other hvc-loader functions\n */\nexport function initialize(params) {\n    return __awaiter(this, void 0, void 0, function () {\n        var baseUrl, preConfig, uxData, enableUxVersionQueryParam, subFeatures, targetHtmlElement, appId, hostName, applicableFeatures, versionInfo, kustoEndpoint, hvcLoaderInitializeStartTime, queryParam, uxDataFromAPI, error_1, applicableFeatures;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    baseUrl = params.centroEnvironmentBaseUrl, preConfig = params.preConfig, uxData = params.centroHvcData, enableUxVersionQueryParam = params.enableUxVersionQueryParam, subFeatures = params.subFeatures, targetHtmlElement = params.targetHtmlElement;\n                    // Note: user might not call us from TypeScript environment, so assert on all non-optional params.\n                    assert(!!baseUrl, 'centroEnvironmentBaseUrl is missing');\n                    assert(!!preConfig, 'preConfig is missing');\n                    if (targetHtmlElement) {\n                        globalWindow = targetHtmlElement.ownerDocument.defaultView || window;\n                    }\n                    consumerPreConfig = preConfig;\n                    if (!consumerPreConfig.appId) {\n                        consumerPreConfig.appId = createUUID();\n                    }\n                    appId = consumerPreConfig.appId;\n                    hostName = consumerPreConfig.hostName;\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 5, , 6]);\n                    if (loaderInitialized) {\n                        log({\n                            type: LogKind.Info,\n                            message: 'initialize() is called but loader is already previously initialized',\n                            id: '508375',\n                        });\n                        if (!!subFeatures) {\n                            applicableFeatures = getApplicableFeaturesFromUxData(subFeatures);\n                            return [2 /*return*/, { applicableFeatures: applicableFeatures }];\n                        }\n                        return [2 /*return*/];\n                    }\n                    centroBaseUrl = baseUrl.substring(baseUrl.length - 1) === '/' ? baseUrl.substring(0, baseUrl.length - 1) : baseUrl;\n                    versionInfo = require('../../package.json');\n                    instanceVersionInfo = versionInfo.version;\n                    kustoEndpoint = centroBaseUrl + \"/api/instrument/logclient\";\n                    if (!loggersInitialized) {\n                        // do this first\n                        addLogger('hvcLoaderKustoLogger', makeMacKustoLogger(appId, kustoEndpoint, hostName, versionInfo.name + '_' + versionInfo.version));\n                        unlockLoggingQueue();\n                        if (consumerPreConfig.additionalLoggers !== undefined) {\n                            Object.keys(consumerPreConfig.additionalLoggers).forEach(function (key) {\n                                addLogger(key, { logger: consumerPreConfig.additionalLoggers[key] });\n                            });\n                        }\n                        loggersInitialized = true;\n                    }\n                    hvcLoaderInitializeStartTime = performance.now();\n                    if (!!!uxData) return [3 /*break*/, 2];\n                    log({ type: LogKind.Info, message: 'uxVersion Data is provided thru parameter', id: '508372', data: uxData });\n                    uxVersionData = JSON.parse(uxData);\n                    return [3 /*break*/, 4];\n                case 2:\n                    if (params.forHostVersion && params.hvcVersion) {\n                        throw new Error('cannot specify both forHostVersion and hvcVersion');\n                    }\n                    // do not use polyfill-required API (URLSearchParams)\n                    enableQueryParam = !!enableUxVersionQueryParam;\n                    queryParam = '';\n                    if (params.forHostVersion && !consumerPreConfig.useCentroConfig) {\n                        queryParam = \"?bldVer=\" + encodeURIComponent(params.forHostVersion);\n                    }\n                    else if (params.hvcVersion) {\n                        queryParam = \"?pkgver=\" + encodeURIComponent(params.hvcVersion);\n                    }\n                    return [4 /*yield*/, getUxVersionData(queryParam, consumerPreConfig.useCentroConfig, consumerPreConfig.vectors, !!subFeatures)];\n                case 3:\n                    uxDataFromAPI = _a.sent();\n                    log({\n                        type: LogKind.Info,\n                        message: 'uxVersion Data is provided thru parameter',\n                        id: '508372',\n                        data: uxDataFromAPI,\n                    });\n                    uxVersionData = JSON.parse(uxDataFromAPI);\n                    _a.label = 4;\n                case 4:\n                    loaderInitialized = true;\n                    log({\n                        type: LogKind.Info,\n                        message: 'hvcloader initialze() step has succeeded',\n                        id: '513574',\n                        data: {\n                            eventName: 'hvcLoader_Initialize_step',\n                            fromStart: performance.now() - hvcLoaderInitializeStartTime,\n                            UA: navigator.userAgent,\n                            enableQueryParam: enableQueryParam,\n                        },\n                    });\n                    return [3 /*break*/, 6];\n                case 5:\n                    error_1 = _a.sent();\n                    log({ type: LogKind.Error, message: 'hvcloader initialze() step has failed ' + error_1.message, id: '508376', error: error_1 });\n                    throw error_1;\n                case 6:\n                    if (!!subFeatures) {\n                        applicableFeatures = getApplicableFeaturesFromUxData(subFeatures);\n                        return [2 /*return*/, { applicableFeatures: applicableFeatures }];\n                    }\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\n/**\n * Preload HVC to prepare for its bootstrapping.\n *\n * This should be called before attempting to bootstrap a HVC\n *\n * To preload multiple features in parallel: Promise.all([preloadFeature(), preloadFeature(), ...])\n *\n * The returning Promise resolves to [boolean, Record<string, any> | undefined], indicating if the preload has happened, with or without static additional objects\n * If the HVC is not enabled for your app in the Centro versioning server the promise resolves to false.\n */\nexport function preloadFeature(params) {\n    return __awaiter(this, void 0, void 0, function () {\n        var uxData, preloadFeatureStartTime, lowerCaseFeatureName, staticAdditionalObjects, foreignEnvMainVersion, error_2;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    uxData = uxVersionData;\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 7, , 8]);\n                    if (!loaderInitialized) {\n                        throw new Error('initialize() needs to be invoked before calling preloadFeature()');\n                    }\n                    preloadFeatureStartTime = performance.now();\n                    if (!params.localMode) return [3 /*break*/, 3];\n                    return [4 /*yield*/, getUxVersionDebugData()];\n                case 2:\n                    _a.sent();\n                    uxData = uxVersionDebugData;\n                    _a.label = 3;\n                case 3:\n                    if (!uxData) {\n                        throw new Error('uxVersionData is not populated');\n                    }\n                    lowerCaseFeatureName = params.featureName.toLowerCase();\n                    if (!uxData[lowerCaseFeatureName]) {\n                        log({\n                            type: LogKind.Info,\n                            message: \"HVC \" + lowerCaseFeatureName + \" is not enabled for this host\",\n                            id: '508419',\n                        });\n                        return [2 /*return*/, [false, undefined]];\n                    }\n                    if (!(getFeatureLoadingState(lowerCaseFeatureName) &&\n                        getDbgState(lowerCaseFeatureName) === !!params.localMode &&\n                        !params.enableMultiplePreload)) return [3 /*break*/, 4];\n                    log({\n                        type: LogKind.Info,\n                        message: \"preloadFeature() feature \" + lowerCaseFeatureName + \" already loaded previously\",\n                        id: '508465',\n                        data: { hvc: lowerCaseFeatureName },\n                    });\n                    return [3 /*break*/, 6];\n                case 4:\n                    if (getFeatureLoadingState(lowerCaseFeatureName) && getDbgState(lowerCaseFeatureName) === !!params.localMode) {\n                        log({\n                            type: LogKind.Info,\n                            message: \"preloadFeature() feature \" + lowerCaseFeatureName + \" already loaded previously, but enableMultiplePreload is set to true, so attempt to load it again\",\n                            id: '533107',\n                            data: { hvc: lowerCaseFeatureName },\n                        });\n                    }\n                    return [4 /*yield*/, dynamicLoader(uxData[lowerCaseFeatureName].loaderSpec, hvcTrustedTypePolicy, globalWindow.document)];\n                case 5:\n                    _a.sent();\n                    if (!getFeatureLoadingState(lowerCaseFeatureName)) {\n                        throw new Error(\"preloadFeature(): global is not populated after loading for \" + lowerCaseFeatureName);\n                    }\n                    if (globalWindow.m365_admin_features.locDbg === undefined) {\n                        globalWindow.m365_admin_features.locDbg = {};\n                    }\n                    globalWindow.m365_admin_features.locDbg[lowerCaseFeatureName] = !!params.localMode;\n                    _a.label = 6;\n                case 6:\n                    if (params.adapters) {\n                        // store adapters\n                        consumerAdapters.set(lowerCaseFeatureName, params.adapters);\n                    }\n                    staticAdditionalObjects = void 0;\n                    // to get more detailed info of which hvc feature causes trouble, adding this extra log\n                    try {\n                        staticAdditionalObjects = globalWindow.m365_admin_features.staticAdditionalObjects[lowerCaseFeatureName];\n                    }\n                    catch (error) {\n                        foreignEnvMainVersion = globalWindow.m365_admin_features.foreignEnvMainVersion;\n                        log({\n                            type: LogKind.Error,\n                            message: foreignEnvMainVersion\n                                ? \"using v3 Hvc \" + lowerCaseFeatureName + \", error when trying to retrieve staticAdditionalObjects, error: \" + error.message\n                                : \"using v2 Hvc \" + lowerCaseFeatureName + \", staticAdditionalObjects is not supported, error: \" + error.message,\n                            id: '521848',\n                            error: error,\n                        });\n                        throw error;\n                    }\n                    log({\n                        type: LogKind.Info,\n                        message: 'preloadFeatures() step has succeeded',\n                        id: '513585',\n                        data: {\n                            hvc: lowerCaseFeatureName,\n                            uxdata: JSON.stringify(uxData),\n                            eventName: 'preloadFeature_step',\n                            fromStart: performance.now() - preloadFeatureStartTime,\n                            UA: navigator.userAgent,\n                        },\n                    });\n                    return [2 /*return*/, [true, staticAdditionalObjects]];\n                case 7:\n                    error_2 = _a.sent();\n                    log({\n                        type: LogKind.Error,\n                        message: 'error in preloadFeatures() step ' + error_2.message,\n                        id: '508417',\n                        data: { uxdata: JSON.stringify(uxData) },\n                        error: error_2,\n                    });\n                    throw error_2;\n                case 8: return [2 /*return*/];\n            }\n        });\n    });\n}\n/**\n * Bootstrap the HVC.\n *\n * This will return a function which you could use to bootstrap the HVC, the return result\n * of the function can be used to unmount the HVC\n */\nexport function bootstrapFeature(params) {\n    return __awaiter(this, void 0, void 0, function () {\n        var bootStrapFeatureStartTime, uxData, lowerCaseFeatureName, loaderData, bootstrapper, error_3, foreignEnvMainVersion, error_4;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 7, , 8]);\n                    if (!loaderInitialized) {\n                        throw new Error('initialize() needs to be invoked before calling bootstrapFeature()');\n                    }\n                    bootStrapFeatureStartTime = performance.now();\n                    uxData = uxVersionData;\n                    lowerCaseFeatureName = params.featureName.toLowerCase();\n                    if (getDbgState(lowerCaseFeatureName)) {\n                        uxData = uxVersionDebugData;\n                    }\n                    if (!uxData) {\n                        throw new Error('uxVersionData is not populated');\n                    }\n                    if (!getFeatureLoadingState(lowerCaseFeatureName)) return [3 /*break*/, 5];\n                    loaderData = {\n                        centroBaseUrl: centroBaseUrl,\n                        cdnUrl: uxData[lowerCaseFeatureName].cdnUrl,\n                        ariaLoggerId: uxData.__hostApp_config.ariaLoggerId,\n                        targetAppUrls: uxData.__hostApp_config.hostingAppUrls,\n                        versionInfo: instanceVersionInfo,\n                    };\n                    bootstrapper = void 0;\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, globalWindow.m365_admin_features.initializers[lowerCaseFeatureName](consumerAdapters.get(lowerCaseFeatureName), loaderData, consumerPreConfig)];\n                case 2:\n                    bootstrapper = _a.sent();\n                    log({\n                        type: LogKind.Info,\n                        message: 'bootstrapFeature() step has succeeded',\n                        id: '513586',\n                        data: {\n                            hvc: lowerCaseFeatureName,\n                            eventName: 'bootstrapFeature_step',\n                            fromStart: performance.now() - bootStrapFeatureStartTime,\n                            UA: navigator.userAgent,\n                        },\n                    });\n                    return [3 /*break*/, 4];\n                case 3:\n                    error_3 = _a.sent();\n                    foreignEnvMainVersion = globalWindow.m365_admin_features.foreignEnvMainVersion;\n                    log({\n                        type: LogKind.Error,\n                        message: foreignEnvMainVersion\n                            ? \"using v3 Hvc \" + lowerCaseFeatureName + \", error when running foreignFeatureInitializeRuntime, error: \" + error_3.message\n                            : \"using v2 Hvc \" + lowerCaseFeatureName + \" is not supported, error: \" + error_3.message,\n                        id: '521851',\n                        error: error_3,\n                    });\n                    throw error_3;\n                case 4: return [2 /*return*/, bootstrapper];\n                case 5: throw new Error(\"bootstrapFeature(): preloadFeature() was not called before bootstraping \" + lowerCaseFeatureName);\n                case 6: return [3 /*break*/, 8];\n                case 7:\n                    error_4 = _a.sent();\n                    log({\n                        type: LogKind.Error,\n                        message: 'error in bootstrapFeature() step ' + error_4.message,\n                        id: '508481',\n                        error: error_4,\n                    });\n                    throw error_4;\n                case 8: return [2 /*return*/];\n            }\n        });\n    });\n}\n", "export function createStaticDataSource(config) {\n    return {\n        register: function () { return config; },\n        unregister: function () {\n            // do nothing\n        },\n    };\n}\n", "import { createStaticDataSource } from './staticDataSource';\nvar dataSources = {};\nvar emptyDataSource = createStaticDataSource({});\nexport function setDataSource(name, dataSource) {\n    dataSources[name] = dataSource;\n}\n/**\n * Set the dataSource under a name if not already set\n * @param name name of the dataSource\n * @param dataSource the dataSource to be set\n * @returns true if the dataSource is set successfully\n */\nexport function trySetDataSource(name, dataSource) {\n    if (!dataSources[name]) {\n        dataSources[name] = dataSource;\n        return true;\n    }\n    return false;\n}\nexport function getDataSource(name) {\n    if (!dataSources.hasOwnProperty(name)) {\n        throw new Error(\"dataSource '\" + name + \"' was not set yet\");\n    }\n    return dataSources[name];\n}\nexport function tryGetDataSource(name, fallbackDataSource) {\n    if (!dataSources.hasOwnProperty(name)) {\n        if (fallbackDataSource) {\n            return fallbackDataSource;\n        }\n        else {\n            return emptyDataSource;\n        }\n    }\n    return dataSources[name];\n}\n/**\n * Try to get RICE data source. This approach is technically applicable to all HVCs, but\n * due to it being a workaround, we are scoping it to RICE for now\n * @param name data source name,\n * @param dataHvcId\n * @param fallbackDataSource\n * @returns\n */\nexport function tryGetRiceDataSource(dataHvcId, fallbackDataSource) {\n    var dataSourceName = \"centro.hvc.riceData\";\n    if (dataHvcId) {\n        dataSourceName = 'centro.hvc.riceData' + \"_\" + dataHvcId;\n    }\n    return tryGetDataSource(dataSourceName, fallbackDataSource);\n}\n", "/**\n * The adapter provider parties\n */\nexport var AdapterProvider;\n(function (AdapterProvider) {\n    AdapterProvider[\"Centro\"] = \"Centro\";\n    AdapterProvider[\"Hvc\"] = \"Hvc\";\n    AdapterProvider[\"Consumer\"] = \"Consumer\";\n})(AdapterProvider || (AdapterProvider = {}));\n/**\n * The adapter types\n */\nexport var AdapterType;\n(function (AdapterType) {\n    AdapterType[\"Request\"] = \"Request\";\n    AdapterType[\"History\"] = \"History\";\n    AdapterType[\"DataSources\"] = \"DataSources\";\n    AdapterType[\"SetTitleImpl\"] = \"SetTitleImpl\";\n})(AdapterType || (AdapterType = {}));\n", "\r\n\r\n/**\r\n * CentroLoaderWrapper to wrap around the centro-hvc-loader function such as bootstrapFeature, createStaticDataSource, initialize, preloadFeature\r\n * Therefore, we can mock those function by Jasmine for testing\r\n */\r\nimport { bootstrapFeature, createStaticDataSource, initialize, preloadFeature } from \"@ms/centro-hvc-loader\"\r\n\r\n\r\nexport class CentroLoaderWrapper {\r\n\tstatic readonly bootstrapFeature = bootstrapFeature;\r\n\tstatic readonly createStaticDataSource = createStaticDataSource;\r\n\tstatic readonly initialize = initialize;\r\n\tstatic readonly preloadFeature = preloadFeature;\r\n}\r\n", "/**\r\n * CentroLogger.ts\r\n *\r\n * Module for the Centro logging\r\n */\r\n\r\nimport { ILogOptions, ILogPayloadData, isError, isFlight } from '@ms/centro-hvc-loader/dist/runtime/logging/log.types';\r\nimport * as Configuration from \"../../Configuration/Configuration\";\r\nimport * as Logging from \"../../Logging/Logging\";\r\n\r\nconst NONFLOODGATE_SPECIFIC_CENTRO_EVENT_SAMPLING_RATE = 0.01;\r\n\r\n// This is the object which is used to open/close/update data to Floodgate Centro\r\nexport function centroLogging(options: ILogOptions) {\r\n\tif (isFlight(options)) { return }\r\n\ttry {\r\n\t\tconst configuration = Configuration.get();\r\n\t\tconst { data, id, ...rest } = options;\r\n\t\tconst persistData: Logging.ICustomProperties = {\r\n\t\t\tPromptAutoDismiss: configuration.getFloodgateInitOptions().autoDismiss?.toString(),\r\n\t\t\tIsEmailPolicyEnabled: configuration.getFloodgateInitOptions().showEmailAddress,\r\n\t\t\tData: JSON.stringify(scrubCentroUrlData(data)),\r\n\t\t\tCentroData: JSON.stringify(rest),\r\n\t\t};\r\n\r\n\t\tif (configuration.getFloodgateSurvey()) {\r\n\t\t\tpersistData.CampaignId = configuration.getFloodgateSurvey().getCampaignId();\r\n\t\t\tpersistData.SurveyId = configuration.getFloodgateSurvey().getId();\r\n\t\t\tpersistData.SurveyType = configuration.getFloodgateSurvey().getSurveyType();\r\n\t\t\tpersistData.ClientFeedbackId = configuration.getFloodgateSurvey().getPreGeneratedClientFeedbackId();\r\n\t\t}\r\n\r\n\t\t// Sample Centro side events that are not Floodgate specific. These have a numeric ID.\r\n\t\tif (isNumericString(id)) {\r\n\t\t\tLogging.getLogger().logEvent({\r\n\t\t\t\tname: id\r\n\t\t\t}, convertCentroLogType(options, persistData), persistData, NONFLOODGATE_SPECIFIC_CENTRO_EVENT_SAMPLING_RATE);\r\n\t\t} else {\r\n\t\t\tLogging.getLogger().logEvent({ name: id }, convertCentroLogType(options, persistData), persistData);\r\n\t\t}\r\n\r\n\t}\r\n\tcatch (error) {\r\n\t\tLogging.getLogger().logEvent(\r\n\t\t\tLogging.EventIds.Centro.Logging.Error.VALUE,\r\n\t\t\tLogging.LogLevel.Error,\r\n\t\t\t{\r\n\t\t\t\tErrorMessage: \"Error logging centro data\" + (error && error.message ? \": \" + error.message : \"\")\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst convertCentroLogType = (options: ILogOptions, persistData: Logging.ICustomProperties) => {\r\n\tlet message = '';\r\n\tif (Object.prototype.hasOwnProperty.call(options, 'message') && typeof options['message'] === \"string\") {\r\n\t\tmessage = options['message']\r\n\t}\r\n\r\n\tif (isError(options)) {\r\n\t\tpersistData.ErrorMessage = message\r\n\t\treturn Logging.LogLevel.Error;\r\n\t}\r\n\r\n\tpersistData.Message = message\r\n\t// Anything from Centro is considered as Critical\r\n\treturn Logging.LogLevel.Critical;\r\n}\r\n\r\nconst scrubCentroUrlData = (data: ILogPayloadData) => {\r\n\r\n\tif (data === undefined || data === null || typeof data !== \"object\") {\r\n\t\treturn data;\r\n\t}\r\n\r\n\t// scrub out the properties that can be sensitive.\r\n\tdata[\"location\"] = undefined;\r\n\tdata[\"locationAncestors\"] = undefined;\r\n\r\n\treturn data;\r\n}\r\n\r\nconst isNumericString = (value: string) => {\r\n\tif (value === undefined || value === null || typeof value !== \"string\") {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tlet valueIsNumeric = false;\r\n\r\n\tif (!Number.isNaN(Number(value))) {\r\n\t\tvalueIsNumeric = true;\r\n\t}\r\n\r\n\treturn valueIsNumeric;\r\n}", "/**\r\n * CentroThemeDataSource.ts\r\n *\r\n * Module for Theme options for Centro\r\n */\r\n\r\nimport { ConfigUpdatedListener } from \"@ms/centro-hvc-loader\";\r\nimport * as Configuration from \"../../Configuration/Configuration\";\r\nimport { ICentroThemeOptions } from \"./CentroInterfaces\";\r\n\r\n// This is the object which is used to open/close/update data to Floodgate Centro\r\nexport class CentroThemeDataSource {\r\n\t/* Centro Theme options */\r\n\tpublic centroThemeOptions: ICentroThemeOptions;\r\n\r\n\t/* This is the list of listeners need to be invoked when the initOptions change */\r\n\tprivate listeners: ConfigUpdatedListener<ICentroThemeOptions>[] = [];\r\n\r\n\tprivate static instance: CentroThemeDataSource;\r\n\r\n\tpublic static get() {\r\n\t\tif (!this.instance) {\r\n\t\t\tthis.instance = new CentroThemeDataSource();\r\n\t\t}\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tthis.centroThemeOptions = {\r\n\t\t\tbaseTheme: Configuration.get().getDynamicUxConfig().theme,\r\n\t\t\tcustomTheme: Configuration.get().getDynamicUxConfig().customTheme,\r\n\t\t\tsurveyUxCSSParams: Configuration.get().getFloodgateInitOptions().surveyCSSParams,\r\n\t\t\tfooterButtonsAlignment: Configuration.get().getDynamicUxConfig().footerButtonsAlignment\r\n\t\t};\r\n\t}\r\n\r\n\t/*\r\n\tRegister and Unregister is part of the boilerplate code to enable dynamic data passing\r\n\t*/\r\n\tpublic register(\r\n\t\tlistener?: ConfigUpdatedListener<ICentroThemeOptions>\r\n\t): Readonly<Partial<ICentroThemeOptions>> {\r\n\t\tif (listener) {\r\n\t\t\tthis.listeners.push(listener);\r\n\t\t}\r\n\t\treturn this.centroThemeOptions;\r\n\t}\r\n\r\n\tpublic unregister(listener: ConfigUpdatedListener<ICentroThemeOptions>): void {\r\n\t\tconst index = this.listeners.indexOf(listener);\r\n\t\tif (index > -1) {\r\n\t\t\tthis.listeners.splice(index, 1);\r\n\t\t}\r\n\t}\r\n\r\n\t// Update function if the init options change in runtime\r\n\tpublic updateThemeState(updatedstate: Partial<ICentroThemeOptions>): void {\r\n\t\tthis.centroThemeOptions = {...this.centroThemeOptions, ...updatedstate}; // Note that this is a shallow copy\r\n\r\n\t\t// we need to inform the existing listeners\r\n\t\tthis.listeners.forEach((listener: ConfigUpdatedListener<ICentroThemeOptions>) => listener(this.centroThemeOptions));\r\n\t}\r\n}\r\n", "/**\r\n * An implementation of IUISurvey based on floodgate.core INpsSurvey\r\n */\r\n\r\nimport { Api, GovernedChannelType, IUxSchema } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport IUISurvey from \"./IUISurvey\";\r\nimport { customerVoiceLauncherType } from \"../../Constants\";\r\n\r\nexport default class UISurvey implements IUISurvey {\r\n\tpublic showPrompt = true;\r\n\r\n\tpublic showEmailRequest = false;\r\n\r\n\tprivate isIntercept: boolean;\r\n\r\n\tprivate survey: Api.ISurvey;\r\n\tprivate prompt: Api.IPromptComponent;\r\n\tprivate comment: Api.ICommentComponent;\r\n\tprivate rating: Api.IRatingComponent;\r\n\tprivate intercept: Api.IInterceptComponent;\r\n\tprivate cvSurvey: Api.ICVSurveyComponent;\r\n\r\n\tconstructor(survey: Api.ISurvey) {\r\n\t\tif (!survey) {\r\n\t\t\tthrow Error(\"survey must not be null\");\r\n\t\t} else {\r\n\t\t\tthis.survey = survey;\r\n\t\t}\r\n\r\n\t\tif (survey.getType() === Api.SurveyType.Intercept) {\r\n\t\t\tthis.isIntercept = true;\r\n\r\n\t\t\tconst interceptComponent: Api.ISurveyComponent = survey.getComponent(Api.SurveyComponentType.Intercept);\r\n\r\n\t\t\tif (interceptComponent) {\r\n\t\t\t\tthis.intercept = (interceptComponent as Api.IInterceptComponent);\r\n\t\t\t} else {\r\n\t\t\t\tthrow Error(\"intercept component must not be null\");\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tthis.isIntercept = false;\r\n\r\n\t\t\t// If the survey has only UxSchema (no valid Content), return here for no need further extracting/validation\r\n\t\t\tif (survey.getUxSchema() && !survey.isContentValid()) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst promptComponent: Api.ISurveyComponent = survey.getComponent(Api.SurveyComponentType.Prompt);\r\n\t\t\tconst commentComponent: Api.ISurveyComponent = survey.getComponent(Api.SurveyComponentType.Comment);\r\n\t\t\tconst ratingComponent: Api.ISurveyComponent = survey.getComponent(Api.SurveyComponentType.Rating);\r\n\t\t\tconst cvSurveyComponent: Api.ISurveyComponent = survey.getComponent(Api.SurveyComponentType.CVSurvey);\r\n\r\n\t\t\tif (promptComponent) {\r\n\t\t\t\tthis.prompt = (promptComponent as Api.IPromptComponent);\r\n\t\t\t} else {\r\n\t\t\t\tthrow Error(\"prompt component must not be null\");\r\n\t\t\t}\r\n\r\n\t\t\t// Check for additonalDataRequested options\r\n\t\t\tthis.showEmailRequest = survey.getSurveyInfo().isAdditionalDataRequested(\r\n\t\t\t\tApi.SurveyInfoAdditionalDataType.EmailAddress);\r\n\r\n\t\t\tif (commentComponent) {\r\n\t\t\t\tthis.comment = (commentComponent as Api.ICommentComponent);\r\n\t\t\t} else {\r\n\t\t\t\tthrow Error(\"comment component must not be null\");\r\n\t\t\t}\r\n\r\n\t\t\tif (ratingComponent) {\r\n\t\t\t\tthis.rating = (ratingComponent as Api.IRatingComponent);\r\n\t\t\t} else {\r\n\t\t\t\tthrow Error(\"rating component must not be null\");\r\n\t\t\t}\r\n\r\n\t\t\tif (cvSurveyComponent) {\r\n\t\t\t\tthis.cvSurvey = (cvSurveyComponent as Api.ICVSurveyComponent);\r\n\t\t\t\tif (this.getLauncherType() === customerVoiceLauncherType && !this.getCVSurveyFormId()) {\r\n\t\t\t\t\tthrow Error(\"CvSurveyId should not be null\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getLauncherType(): string {\r\n\t\treturn this.isIntercept ? undefined : this.survey.getLauncherType();\r\n\t}\r\n\r\n\tpublic getCVSurveyFormId(): string {\r\n\t\treturn this.isIntercept ? undefined : this.cvSurvey.getFormId();\r\n\t}\r\n\r\n\tpublic getPreGeneratedClientFeedbackId(): string {\r\n\t\treturn this.survey.getPreGeneratedClientFeedbackId();\r\n\t}\r\n\r\n\tpublic getPromptQuestion(): string {\r\n\t\treturn this.isIntercept ? undefined : this.prompt.getQuestion();\r\n\t}\r\n\r\n\tpublic getTitle(): string {\r\n\t\treturn this.isIntercept ? undefined : this.prompt.getTitle();\r\n\t}\r\n\r\n\tpublic getPromptYesButtonText(): string {\r\n\t\treturn this.isIntercept ? undefined : this.prompt.getYesButtonText();\r\n\t}\r\n\r\n\tpublic getPromptNoButtonText(): string {\r\n\t\treturn this.isIntercept ? undefined : this.prompt.getNoButtonText();\r\n\t}\r\n\r\n\tpublic getRatingValuesAscending(): string[] {\r\n\t\treturn this.isIntercept ? undefined : this.rating.getRatingValuesAscending();\r\n\t}\r\n\r\n\tpublic getRatingQuestion(): string {\r\n\t\treturn this.isIntercept ? undefined : this.rating.getQuestion();\r\n\t}\r\n\r\n\tpublic getCommentQuestion(): string {\r\n\t\treturn this.isIntercept ? undefined : this.comment.getQuestion();\r\n\t}\r\n\r\n\tpublic getInterceptTitle(): string {\r\n\t\treturn this.isIntercept ? this.intercept.getTitle() : undefined;\r\n\t}\r\n\r\n\tpublic getInterceptQuestion(): string {\r\n\t\treturn this.isIntercept ? this.intercept.getQuestion() : undefined;\r\n\t}\r\n\r\n\tpublic getInterceptUrl(): string {\r\n\t\treturn this.isIntercept ? this.intercept.getUrl() : undefined;\r\n\t}\r\n\r\n\tpublic setValues(selectedIndex: number, comment: string): void {\r\n\t\tif (!this.isIntercept) {\r\n\t\t\tthis.rating.setSelectedRatingIndex(selectedIndex);\r\n\t\t\tthis.comment.setSubmittedText(comment);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getJsonElements(): any {\r\n\t\treturn this.survey.getJsonElements();\r\n\t}\r\n\r\n\tpublic getSurveyType(): Api.SurveyType {\r\n\t\treturn this.survey.getType();\r\n\t}\r\n\r\n\tpublic getCampaignId(): string {\r\n\t\treturn this.survey.getSurveyInfo().getBackEndId();\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.survey.getSurveyInfo().getId();\r\n\t}\r\n\r\n\tpublic getGoverenedChannelType(): GovernedChannelType {\r\n\t\treturn this.survey.getSurveyInfo().getGovernedChannelType();\r\n\t}\r\n\t\r\n\tpublic getUxSchema(): IUxSchema {\r\n\t\treturn this.survey.getUxSchema();\r\n\t}\r\n\r\n\tpublic isContentValid(): boolean {\r\n\t\treturn this.survey.isContentValid();\r\n\t}\r\n\r\n\tpublic isUserInitiatedSurvey(): boolean {\r\n\t\treturn false;\r\n\t}\r\n}\r\n", "/**\r\n * Implementation for IFloodgateEnvironmentProvider for web SDK.\r\n * We pass the SDK's internal locale here and not the one which the host app specifies.\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Configuration from \"./../Configuration/Configuration\";\r\n\r\nexport default class FloodgateEnvironmentProvider implements Api.IFloodgateEnvironmentProvider {\r\n\tpublic getLanguage(): string {\r\n\t\treturn Configuration.get().getCommonInitOptions().originalLocale;\r\n\t}\r\n}\r\n", "/**\r\n * UIStrings.ts\r\n *\r\n * Module for the strings to display\r\n */\r\n\r\nexport interface IUIStrings {\r\n\tFeedbackSubtitle: string;\r\n\tPrivacyStatement: string;\r\n\r\n\tForm: {\r\n\t\tCommentPlaceholder: string;\r\n\t\tCategoryPlaceholder: string;\r\n\t\tEmailPlaceholder: string;\r\n\t\tRatingLabel: string;\r\n\t\tScreenshotLabel: string;\r\n\t\tEmailCheckBoxLabel: string;\r\n\t\tSubmit: string;\r\n\t\tBasicFormTitle: string;\r\n\t\tCancel: string;\r\n\t\tScreenshotImgAltText: string;\r\n\t\tPrivacyLabel: string;\r\n\t\tPrivacyConsent: string;\r\n\t};\r\n\r\n\tSingleForm: {\r\n\t\tTitle: string;\r\n\t};\r\n\r\n\tSmileForm: {\r\n\t\tAnchor: string;\r\n\t\tTitle: string;\r\n\t};\r\n\r\n\tFrownForm: {\r\n\t\tAnchor: string;\r\n\t\tTitle: string;\r\n\t};\r\n\r\n\tIdeaForm: {\r\n\t\tAnchor: string;\r\n\t\tTitle: string;\r\n\t};\r\n\r\n\tBugForm: {\r\n\t\tAnchor: string;\r\n\t\tTitle: string;\r\n\t};\r\n\r\n\tThanksPanel: {\r\n\t\tTitle: string;\r\n\t\tAppreciateText: string;\r\n\t\tMyFeedbackDescription: string;\r\n\t\tMyFeedbackLinkText: string;\r\n\t\tFeedbackPortalDescription: string;\r\n\t\tFeedbackPortalLinkText: string;\r\n\t\tClose: string;\r\n\t};\r\n\r\n\tFloodgate: {\r\n\t\tForm: {\r\n\t\t\tTitle: string;\r\n\t\t},\r\n\t\tNps: {\r\n\t\t\tPrompt: {\r\n\t\t\t\tTitle: string;\r\n\t\t\t\tQuestion: string;\r\n\t\t\t\tYes: string;\r\n\t\t\t\tNo: string;\r\n\t\t\t};\r\n\r\n\t\t\tComment: {\r\n\t\t\t\tQuestion: string;\r\n\t\t\t};\r\n\r\n\t\t\tRating: {\r\n\t\t\t\tQuestion: string;\r\n\t\t\t\tPoints11Value0: string;\r\n\t\t\t\tPoints11Value1: string;\r\n\t\t\t\tPoints11Value2: string;\r\n\t\t\t\tPoints11Value3: string;\r\n\t\t\t\tPoints11Value4: string;\r\n\t\t\t\tPoints11Value5: string;\r\n\t\t\t\tPoints11Value6: string;\r\n\t\t\t\tPoints11Value7: string;\r\n\t\t\t\tPoints11Value8: string;\r\n\t\t\t\tPoints11Value9: string;\r\n\t\t\t\tPoints11Value10: string;\r\n\t\t\t\tPoints5Value1: string;\r\n\t\t\t\tPoints5Value2: string;\r\n\t\t\t\tPoints5Value3: string;\r\n\t\t\t\tPoints5Value4: string;\r\n\t\t\t\tPoints5Value5: string;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tCloseLabel: string;\r\n}\r\n\r\n/**\r\n * Localized UI strings\r\n */\r\nlet uIStrings: IUIStrings;\r\n\r\n/**\r\n * Set UI strings\r\n * @param {string} data List of localized UI strings\r\n */\r\nexport function setUIStrings(data: IUIStrings) {\r\n\tuIStrings = data;\r\n}\r\n\r\n/**\r\n * Get UI strings\r\n * @returns the UIStrings\r\n */\r\nexport function getUIStrings(): IUIStrings {\r\n\treturn uIStrings;\r\n}\r\n", "/**\r\n * Implementation of IFloodgateStringProvider for Web SDK\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as UIStrings from \"./../UIStrings/UIStrings\";\r\nimport * as Configuration from \"./../Configuration/Configuration\";\r\n\r\n\r\nexport default class FloodgateStringProvider implements Api.IFloodgateStringProvider {\r\n\tpublic loadStringResource(stringId: Api.FloodgateStringProviderStringType): string {\r\n\t\tconst uiStrings = UIStrings.getUIStrings();\r\n\r\n\t\tswitch (stringId) {\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue0): return uiStrings.Floodgate.Nps.Rating.Points11Value0;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue1): return uiStrings.Floodgate.Nps.Rating.Points11Value1;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue2): return uiStrings.Floodgate.Nps.Rating.Points11Value2;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue3): return uiStrings.Floodgate.Nps.Rating.Points11Value3;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue4): return uiStrings.Floodgate.Nps.Rating.Points11Value4;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue5): return uiStrings.Floodgate.Nps.Rating.Points11Value5;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue6): return uiStrings.Floodgate.Nps.Rating.Points11Value6;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue7): return uiStrings.Floodgate.Nps.Rating.Points11Value7;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue8): return uiStrings.Floodgate.Nps.Rating.Points11Value8;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue9): return uiStrings.Floodgate.Nps.Rating.Points11Value9;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps11RatingValue10): return uiStrings.Floodgate.Nps.Rating.Points11Value10;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps5RatingValue1): return uiStrings.Floodgate.Nps.Rating.Points5Value1;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps5RatingValue2): return uiStrings.Floodgate.Nps.Rating.Points5Value2;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps5RatingValue3): return uiStrings.Floodgate.Nps.Rating.Points5Value3;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps5RatingValue4): return uiStrings.Floodgate.Nps.Rating.Points5Value4;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.Nps5RatingValue5): return uiStrings.Floodgate.Nps.Rating.Points5Value5;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.NpsRatingQuestion): return uiStrings.Floodgate.Nps.Rating.Question;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.NpsCommentQuestion): return uiStrings.Floodgate.Nps.Comment.Question;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.NpsPromptNotNowLabel): return uiStrings.Floodgate.Nps.Prompt.No;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.NpsPromptQuestion): return uiStrings.Floodgate.Nps.Prompt.Question;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.NpsPromptTitle): return uiStrings.Floodgate.Nps.Prompt.Title;\r\n\t\t\tcase (Api.FloodgateStringProviderStringType.NpsPromptYesLabel): return uiStrings.Floodgate.Nps.Prompt.Yes;\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getCustomString(str: string): string {\r\n\t\treturn Configuration.get().getFloodgateInitOptions().uIStringGetter(str);\r\n\t}\r\n}\r\n", "import * as Configuration from \"../Configuration/Configuration\";\r\n\r\nconst HTTP_TIMEOUT = 8000; // timeout in milliseconds\r\n/**\r\n * Make an http request with retries\r\n * @param method the http method \"GET\", \"POST\" etc\r\n * @param url the url\r\n * @param requestBody the request body\r\n * @param maxRetries the maximum number of retries\r\n * @param onLoad the onload handler\r\n */\r\nfunction makeHttpRequest<T>(method: string, url: string, requestBody: any, maxRetries: number,\r\n\tonLoad: (xhr: XMLHttpRequest, resolve: (value?: T) => void, reject: (error?: any) => void) => void\r\n): Promise<T> {\r\n\tconst makeRequest: (retries: number, timeout: number) => Promise<T> =\r\n\t\t(retries: number, timeout: number) => {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst xhr: XMLHttpRequest = new XMLHttpRequest();\r\n\t\t\t\txhr.open(method, url, true);\r\n\t\t\t\txhr.timeout = timeout;\r\n\t\t\t\txhr.onload = () => { onLoad(xhr, resolve, reject); };\r\n\t\t\t\txhr.ontimeout = () => {\r\n\t\t\t\t\tif (retries > 0) {\r\n\t\t\t\t\t\t// double the timeout and retry it\r\n\t\t\t\t\t\tmakeRequest(retries - 1, timeout * 2).then(resolve, reject);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error(`Request to '${url}' timed out. timeout: ${xhr.timeout}`));\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\txhr.onerror = () => {\r\n\t\t\t\t\tif (retries > 0) {\r\n\t\t\t\t\t\tmakeRequest(retries - 1, timeout).then(resolve, reject);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treject(new Error(`Request to '${url}' errored. ${xhr.status} - ${xhr.statusText} : ${xhr.responseText}`));\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\txhr.send(requestBody);\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t// get the input timeout or using the default value if timeout is not defined\r\n\tconst httpTimeout = Configuration.get().getCommonInitOptions().petrolTimeout\r\n\t\t\t\t\t\t? Configuration.get().getCommonInitOptions().petrolTimeout\r\n\t\t\t\t\t\t: HTTP_TIMEOUT;\r\n\r\n\treturn makeRequest(maxRetries, httpTimeout);\r\n}\r\n\r\nconst uploadEndpointInt = \"https://petrol-int.office.microsoft.com/v1/feedback\";\r\nconst uploadEndpointProd = \"https://petrol.office.microsoft.com/v1/feedback\";\r\n\r\n/**\r\n * Send a payload to Petrol\r\n * @param isProduction is production?\r\n * @param manifest manifest content\r\n * @param screenshot screenshot content\r\n * @param diagnostics diagnostics content\r\n */\r\nexport function send(isProduction: boolean, manifest: Blob, screenshot?: Blob, diagnostics?: Blob): Promise<any> {\r\n\tif (manifest === undefined) {\r\n\t\treturn Promise.reject(new Error(\"Manifest cannot be undefined\"));\r\n\t}\r\n\r\n\tconst formData = new FormData();\r\n\tformData.append(\"Manifest\", manifest);\r\n\r\n\tif (screenshot) {\r\n\t\tformData.append(\"Screenshot\", screenshot);\r\n\t}\r\n\r\n\tif (diagnostics) {\r\n\t\tformData.append(\"Diagnostics\", diagnostics);\r\n\t}\r\n\r\n\treturn makeHttpRequest<any>(\"POST\", isProduction ? uploadEndpointProd : uploadEndpointInt, formData, 2,\r\n\t\tfunction (\r\n\t\t\txhr: XMLHttpRequest,\r\n\t\t\tresolve: (value?: any) => void,\r\n\t\t\treject: (error?: any) => void\r\n\t\t): void {\r\n\t\t\tif (xhr.status !== 200) {\r\n\t\t\t\treject(new Error(\"Non-200 response with status code: \" + xhr.status + \", response: \" + xhr.responseText));\r\n\t\t\t}\r\n\t\t\tresolve();\r\n\t\t});\r\n}\r\n", "/**\r\n * Screenshot.ts\r\n * Module for managing the screenshot file\r\n */\r\n\r\nimport {IFile} from \"./IFile\";\r\nimport * as Logging from \"./../../Logging/Logging\";\r\n\r\nexport class Screenshot implements IFile {\r\n\tprivate screenshot: HTMLCanvasElement;\r\n\r\n\tconstructor (screenshot: HTMLCanvasElement) {\r\n\t\tthis.screenshot = screenshot;\r\n\t}\r\n\r\n\tpublic getContent(): Blob {\r\n\t\tlet imgString: string;\r\n\t\ttry {\r\n\t\t\timgString = this.screenshot.toDataURL(\"image/jpeg\").split(\",\")[1];\r\n\t\t} catch (e) {\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,\r\n\t\t\t\tLogging.LogLevel.Error, { ErrorMessage: e.toString() });\r\n\r\n\t\t\t// return an image with \"Screenshot cannot be captured\" message\r\n\t\t\timgString = \"iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSF\"+\r\n\t\t\t\"lzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg\"+\r\n\t\t\t\"8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsv\"+\r\n\t\t\t\"wXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQ\"+\r\n\t\t\t\"JZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw\"+\r\n\t\t\t\"0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPd\"+\r\n\t\t\t\"sswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0Cb\"+\r\n\t\t\t\"qaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII=\";\r\n\t\t}\r\n\r\n\t\tconst blobBin = atob(imgString);\r\n\t\tconst array = [];\r\n\t\tfor (let i = 0; i < blobBin.length; i++) {\r\n\t\t\tarray.push(blobBin.charCodeAt(i));\r\n\t\t}\r\n\t\tconst file: Blob = new Blob([new Uint8Array(array)], {type: \"image/jpeg\"});\r\n\r\n\t\treturn file;\r\n\t}\r\n}\r\n", "/**\r\n * Manifest.ts\r\n * Module for managing the manifest file\r\n */\r\n\r\nimport { FeedbackType, SDK_VERSION_PREFIX } from \"./../../Constants\";\r\nimport * as Utils from \"./../../Utils\";\r\nimport Version from \"./../../Version\";\r\nimport * as Window from \"./../../Window/Window\";\r\nimport { IFile } from \"./IFile\";\r\n\r\nexport class Manifest implements IFile {\r\n\tprivate manifestData: IManifestData;\r\n\r\n\tpublic constructor(manifestType: string, appId: number, submitTime: string, type: ManifestFeedbackType,\r\n\t\tclientFeedbackId: string, applicationGroup: IManifestDataApplication, telemetryGroup: IManifestDataTelemetry,\r\n\t\twebGroup: IManifestDataWeb, retentionDurationDays: number) {\r\n\t\tthis.manifestData = {\r\n\t\t\tappId: appId,\r\n\t\t\tapplication: applicationGroup,\r\n\t\t\tclientFeedbackId: clientFeedbackId,\r\n\t\t\tmanifestType: manifestType,\r\n\t\t\tsource: \"Client\",\r\n\t\t\tsubmitTime: submitTime,\r\n\t\t\ttelemetry: telemetryGroup,\r\n\t\t\ttype: sanitizeType(type),\r\n\t\t\tweb: webGroup,\r\n\t\t\tsdkVersion: SDK_VERSION_PREFIX\r\n\t\t\t\t+ (Window.get().OfficeBrowserFeedback.sdkVersion !== undefined ?\r\n\t\t\t\t\tWindow.get().OfficeBrowserFeedback.sdkVersion : Version),\r\n\t\t\tretentionDurationDays: retentionDurationDays,\r\n\t\t};\r\n\t}\r\n\r\n\tpublic getExtendedManifestData(): string {\r\n\t\treturn this.manifestData.application.extendedManifestData;\r\n\t}\r\n\r\n\tpublic setComment(comment: string) {\r\n\t\tthis.manifestData.comment = comment;\r\n\t}\r\n\r\n\tpublic setEmail(email: string) {\r\n\t\tthis.manifestData.email = email;\r\n\t}\r\n\r\n\tpublic setCategory(category: string) {\r\n\t\tthis.manifestData.telemetry = this.manifestData.telemetry || {};\r\n\t\tthis.manifestData.telemetry.featureArea = category;\r\n\t}\r\n\r\n\tpublic setAppData(appData: string) {\r\n\t\tthis.manifestData.application = this.manifestData.application || {};\r\n\t\tthis.manifestData.application.appData = appData;\r\n\t}\r\n\r\n\tpublic setExtendedManifestData(extendedManifestData: string) {\r\n\t\tthis.manifestData.application = this.manifestData.application || {};\r\n\t\tthis.manifestData.application.extendedManifestData = extendedManifestData;\r\n\t}\r\n\r\n\tpublic setClientFeedbackId(clientFeedbackId: string) {\r\n\t\tthis.manifestData.clientFeedbackId = clientFeedbackId;\r\n\t}\r\n\r\n\tpublic getClientFeedbackId(): string {\r\n\t\treturn this.manifestData.clientFeedbackId;\r\n\t}\r\n\r\n\tpublic setComplianceInformation(authenticationType: string, ageGroup: string, sendFeedbackPolicyValue: string,\r\n\t\tsendSurveyPolicyValue: string, screenshotPolicyValue: string, emailPolicyValue: string) {\r\n\t\tthis.manifestData.complianceChecks = {\r\n\t\t\tauthenticationType: authenticationType,\r\n\t\t\tageGroup: ageGroup,\r\n\t\t\tpolicyAllowFeedback: sendFeedbackPolicyValue,\r\n\t\t\tpolicyAllowSurvey: sendSurveyPolicyValue,\r\n\t\t\tpolicyAllowScreenshot: screenshotPolicyValue,\r\n\t\t\tpolicyAllowContact: emailPolicyValue,\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Set freeform custom values in manifest. Throws if values are already set.\r\n\t * @param values the values as a JS object\r\n\t */\r\n\tpublic setValues(values: object) {\r\n\t\tif (values) {\r\n\t\t\tfor (const field in values) {\r\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(values, field)) {\r\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(this.manifestData, field)) {\r\n\t\t\t\t\t\t(<any> this.manifestData)[field] = Utils.overrideValues((<any> values)[field], (<any> this.manifestData)[field]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t(<any> this.manifestData)[field] = (<any> values)[field];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getContent(): Blob {\r\n\t\treturn new Blob([JSON.stringify(this.manifestData)], { type: \"application/json\" });\r\n\t}\r\n\r\n\tpublic appendUxId(UxId: string): void {\r\n\t\tif (!Utils.isNOU(UxId) && Utils.isString(UxId) && UxId !== \"\") {\r\n\t\t\tthis.manifestData.sdkVersion = this.manifestData.sdkVersion + \",\" + UxId;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction sanitizeType(type: ManifestFeedbackType): string {\r\n\tif (type === \"Survey\") {\r\n\t\treturn type;\r\n\t} else {\r\n\t\treturn FeedbackType[type];\r\n\t}\r\n}\r\n\r\nexport type ManifestFeedbackType = FeedbackType | \"Survey\";\r\n\r\n/**\r\n * Interface for the manifest data\r\n */\r\nexport interface IManifestData {\r\n\t// #region \"Required properties\"\r\n\tmanifestType: string;\r\n\tappId: number;\r\n\tsubmitTime: string;\r\n\tsource: string;\r\n\ttype: string;\r\n\tclientFeedbackId: string;\r\n\tsdkVersion: string;\r\n\t// #endregion \"Required properties\"\r\n\tcomment?: string;\r\n\temail?: string;\r\n\trating?: number;\r\n\tsurvey?: IManifestDataSurvey;\r\n\tweb?: IManifestDataWeb;\r\n\tapplication?: IManifestDataApplication;\r\n\ttelemetry?: IManifestDataTelemetry;\r\n\tcomplianceChecks?: IManifestComplianceChecks;\r\n\tretentionDurationDays?: number;\r\n}\r\n\r\n/**\r\n * Interface for survey related properties in manifest\r\n */\r\nexport interface IManifestDataSurvey {\r\n\tsurveyId: string;\r\n}\r\n\r\n/**\r\n * Interface for application related properties in manifest\r\n */\r\nexport interface IManifestDataApplication {\r\n\tappData?: string;\r\n\textendedManifestData?: string;\r\n\tfeedbackTenant?: string;\r\n}\r\n\r\n/**\r\n * Interface for telemetry related properties in manifest\r\n */\r\nexport interface IManifestDataTelemetry {\r\n\tappVersion?: string;\r\n\taudience?: string;\r\n\taudienceGroup?: string;\r\n\tchannel?: string;\r\n\tdeviceId?: string;\r\n\tdeviceType?: string;\r\n\terrorClassification?: string;\r\n\terrorCode?: string;\r\n\terrorName?: string;\r\n\tfeatureArea?: string;\r\n\tflights?: string;\r\n\tflightSource?: string;\r\n\tfundamentalArea?: string;\r\n\tinstallationType?: string;\r\n\tisLogIncluded?: boolean;\r\n\tisUserSubscriber?: boolean;\r\n\tloggableUserId?: string;\r\n\tofficeArchitecture?: string;\r\n\tofficeBuild?: string;\r\n\tofficeEditingLang?: number;\r\n\tofficeUILang?: number;\r\n\tosBitness?: number;\r\n\tosBuild?: string;\r\n\tosUserLang?: number;\r\n\tplatform?: string;\r\n\tprocessSessionId?: string;\r\n\tringId?: number;\r\n\tsku?: string;\r\n\tsourceContext?: string;\r\n\tsystemProductName?: string;\r\n\tsystemManufacturer?: string;\r\n\ttenantId?: string;\r\n}\r\n\r\n/**\r\n * Interface for web related properties in manifest\r\n */\r\nexport interface IManifestDataWeb {\r\n\tbrowser?: string;\r\n\tbrowserVersion?: string;\r\n\tdataCenter?: string;\r\n\tsourcePageName?: string;\r\n\tsourcePageURI?: string;\r\n}\r\n\r\n/**\r\n * Interface for compliance checks related properties in manifest\r\n */\r\nexport interface IManifestComplianceChecks {\r\n\tauthenticationType?: string;\r\n\tageGroup?: string;\r\n\tpolicyAllowFeedback?: string;\r\n\tpolicyAllowSurvey?: string;\r\n\tpolicyAllowScreenshot?: string;\r\n\tpolicyAllowContact?: string;\r\n}\r\n", "/**\r\n * Feedback.ts\r\n *\r\n * Module for payload transport.\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Constants from \"./../Constants\";\r\nimport * as Utils from \"./../Utils\";\r\nimport * as Logging from \"./../Logging/Logging\";\r\nimport * as Petrol from \"./Petrol\";\r\nimport { Screenshot } from \"./Files/Screenshot\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport { Manifest, ManifestFeedbackType, IManifestDataApplication, IManifestDataTelemetry, IManifestDataWeb }\r\n\tfrom \"./Files/Manifest\";\r\n\r\nimport { AgeGroup, AuthenticationType } from \"../Configuration/Configuration\";\r\nimport { ocpsBooleanToString, ocpsEnumToString } from \"./../Utils\";\r\n\r\nexport { IManifestDataApplication, IManifestDataTelemetry, IManifestDataWeb } from \"./Files/Manifest\"\r\n\r\nexport class Transporter implements Api.ITransporter {\r\n\tprivate manifest: Manifest;\r\n\tprivate screenshot: Screenshot;\r\n\tprivate environment: Constants.Environment;\r\n\tprivate clientFeedbackId: string;\r\n\r\n\tpublic constructor(environment: Constants.Environment, manifestType: string, appId: number, type: ManifestFeedbackType,\r\n\t\tapplicationGroup: IManifestDataApplication, telemetryGroup: IManifestDataTelemetry, webGroup: IManifestDataWeb) {\r\n\r\n\t\tthis.clientFeedbackId = Utils.guid();\r\n\t\tthis.manifest = new Manifest(manifestType, appId, new Date().toISOString(), type,\r\n\t\t\tthis.clientFeedbackId, { ...applicationGroup }, { ...telemetryGroup }, { ...webGroup },\r\n\t\t\tConfiguration.get().getCommonInitOptions().retentionDurationDays);\r\n\t\tthis.environment = environment;\r\n\r\n\t\tthis.manifest.setComplianceInformation(AuthenticationType[(Configuration.get().getCommonInitOptions()?.authenticationType) ??\r\n\t\t\tAuthenticationType.Unauthenticated],\r\n\t\t\tAgeGroup[(Configuration.get().getCommonInitOptions()?.ageGroup) ?? AgeGroup.Undefined],\r\n\t\t\tocpsEnumToString(Configuration.get().getInAppFeedbackInitOptions()?.sendFeedbackPolicyValue),\r\n\t\t\tocpsBooleanToString(Configuration.get().getFloodgateInitOptions()?.surveyEnabled),\r\n\t\t\tocpsEnumToString(Configuration.get().getCommonInitOptions()?.screenshotPolicyValue),\r\n\t\t\tocpsEnumToString(Configuration.get().getCommonInitOptions()?.emailPolicyValue));\r\n\t}\r\n\r\n\tpublic getClientFeedbackId(): string {\r\n\t\treturn this.clientFeedbackId;\r\n\t}\r\n\r\n\tpublic getExtendedManifestData(): string {\r\n\t\treturn this.manifest.getExtendedManifestData();\r\n\t}\r\n\r\n\tpublic setComment(comment: string) {\r\n\t\tthis.manifest.setComment(comment);\r\n\t}\r\n\r\n\tpublic setEmail(email: string) {\r\n\t\tthis.manifest.setEmail(email);\r\n\t}\r\n\r\n\tpublic setCategory(category: string) {\r\n\t\tthis.manifest.setCategory(category);\r\n\t}\r\n\r\n\tpublic setAppData(appData: string) {\r\n\t\tthis.manifest.setAppData(appData);\r\n\t}\r\n\r\n\tpublic setExtendedManifestData(extendedManifestData: string) {\r\n\t\tthis.manifest.setExtendedManifestData(extendedManifestData);\r\n\t}\r\n\r\n\tpublic setScreenshot(screenshot: HTMLCanvasElement) {\r\n\t\tthis.screenshot = new Screenshot(screenshot);\r\n\t}\r\n\r\n\tpublic setClientFeedbackId(clientFeedbackId: string) {\r\n\t\tthis.manifest.setClientFeedbackId(clientFeedbackId);\r\n\t}\r\n\r\n\tpublic appendUxId(UxId: string): void {\r\n\t\tthis.manifest.appendUxId(UxId);\r\n\t}\r\n\r\n\tpublic getManifest(): Manifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\t/**\r\n\t * Set freeform custom values in manifest. Throws if values are already set.\r\n\t * @param values the values as a JS object\r\n\t */\r\n\tpublic setManifestValues(values: object) {\r\n\t\tthis.manifest.setValues(values);\r\n\t}\r\n\r\n\t/**\r\n\t * Submit the payload\r\n\t */\r\n\tpublic submit(): Promise<any> {\r\n\t\tif (!Configuration.get().isFeedbackSurveyEnabledByAADC()) {\r\n\t\t\tLogging.getLogger().logEvent(\r\n\t\t\t\tLogging.EventIds.Shared.Upload.Prevented.VALUE,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tData: JSON.stringify({\r\n\t\t\t\t\t\tageGroup: Configuration.get().getCommonInitOptions().ageGroup,\r\n\t\t\t\t\t\tauthenticationType: Configuration.get().getCommonInitOptions().authenticationType,\r\n\t\t\t\t\t}),\r\n\t\t\t\t});\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\r\n\t\tconst manifestContent: Blob = this.manifest.getContent();\r\n\t\tlet screenshotContent: Blob = undefined;\r\n\t\tconst clientFeedbackId: string = this.clientFeedbackId;\r\n\r\n\t\tif (this.screenshot) {\r\n\t\t\tscreenshotContent = this.screenshot.getContent();\r\n\t\t}\r\n\r\n\t\treturn Petrol.send(this.environment === Constants.Environment.Production, manifestContent, screenshotContent)\r\n\t\t\t.catch(\r\n\t\t\t\tfunction onRejected(err: Error) {\r\n\t\t\t\t\tConfiguration.get().setFeedbackSubmitted(false);\r\n\t\t\t\t\tConfiguration.get().getCommonInitOptions().onError(\"Payload submission failed: \" + err.message +\r\n\t\t\t\t\t\t\". ClientFeedbackId: \" + clientFeedbackId);\r\n\t\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.Shared.Upload.Failed.VALUE,\r\n\t\t\t\t\t\tLogging.LogLevel.Error, { ErrorMessage: err.message, ClientFeedbackId: clientFeedbackId });\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t}\r\n}\r\n", "/**\r\n * Implementation of Transporter Factory Interface for calling submit directly to petrol\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { Transporter } from \"./../Transport/Transport\";\r\nimport * as Configuration from \"./../Configuration/Configuration\";\r\n\r\nexport default class TransporterFactory implements Api.ITransporterFactory {\r\n\tpublic makeTransporter(surveyType: string): Api.ITransporter {\r\n\t\treturn new Transporter(\r\n\t\t\tConfiguration.get().getCommonInitOptions().environment,\r\n\t\t\tsurveyType,\r\n\t\t\tConfiguration.get().getCommonInitOptions().appId,\r\n\t\t\t\"Survey\",\r\n\t\t\tConfiguration.get().getCommonInitOptions().applicationGroup,\r\n\t\t\tConfiguration.get().getCommonInitOptions().telemetryGroup,\r\n\t\t\tConfiguration.get().getCommonInitOptions().webGroup\r\n\t\t);\r\n\t}\r\n}\r\n", "/**\r\n * TargetedMessagingProvider.ts\r\n *\r\n * Module for targeted messaging campaign definition provider.\r\n */\r\n\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { FilterValidCampaignDefinitions } from \"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider\";\r\nimport { CampaignDefinitions } from \"@ms-ofb/officefloodgatecore/dist/src/Governance/CampaignDefinitions\";\r\nimport { getDynamicSetting, SettingKey } from \"@ms-ofb/officepersonalization/dist/lib/Configuration/DynamicConfiguration\";\r\nimport { TMS_CAMPAIGN_LOAD_TIMEOUT } from \"@ms-ofb/officepersonalization/dist/lib/TargetedMessaging/TargetedMessagingConstants\";\r\nimport * as Logging from \"../Logging/Logging\";\r\nimport { createTimeoutPromise } from \"../Utils\";\r\n\r\nimport * as AssetsProvider from \"./AssetsProvider\";\r\n\r\nexport class TargetedMessagingCampaignDefinitionProvider implements Api.ICampaignDefinitionProvider {\r\n\tprivate loadAsyncTriggered = false;\r\n\tprivate campaignDefinitions: Api.ICampaignDefinition[] = [];\r\n\r\n\tpublic load(): Api.ICampaignDefinition[] {\r\n\t\tif (!this.loadAsyncTriggered) {\r\n\t\t\tthis.loadAsync();\r\n\t\t\tthis.loadAsyncTriggered = true;\r\n\t\t}\r\n\r\n\t\treturn this.campaignDefinitions || [];\r\n\t}\r\n\r\n\tpublic loadAsync(): Promise<Api.ICampaignDefinition[]> {\r\n\t\tconst requestStartTime = Date.now();\r\n\t\tconst campaignDefinitionsPromise = AssetsProvider.get().getCampaignDefinitions();\r\n\t\tcampaignDefinitionsPromise.then((response) => {\r\n\t\t\tthis.loadCampaignDefinitions(response);\r\n\t\t\tthis.loadAsyncTriggered = true;\r\n\t\t});\r\n\r\n\t\tconst timeoutMilliseconds = getDynamicSetting(SettingKey.tmsLoadTimeout, TMS_CAMPAIGN_LOAD_TIMEOUT);\r\n\t\tconst timeoutPromise = createTimeoutPromise(timeoutMilliseconds, campaignDefinitionsPromise);\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ttimeoutPromise.then((response) => {\r\n\t\t\t\t\tthis.loadCampaignDefinitions(response);\r\n\t\t\t\t\tthis.loadAsyncTriggered = true;\r\n\t\t\t\t\tresolve(this.campaignDefinitions);\r\n\t\t\t\t}\r\n\t\t\t).catch(\r\n\t\t\t\t// might have timed out or getCampaignDefinitions might have failed\r\n\t\t\t\t// In either case we resolve with cached content\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tconst requestTimeElapsed = Date.now() - requestStartTime;\r\n\t\t\t\t\tif (this.campaignDefinitions.length <= 0) { //get campaign def failed\r\n\t\t\t\t\t\tthis.loadCampaignDefinitions(AssetsProvider.get().getCachedCampaignDefinitions());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tLogging.getLogger().logEvent(\r\n\t\t\t\t\t\tLogging.EventIds.FetchCampaignDefinition.Service.Error.VALUE,\r\n\t\t\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tErrorMessage: error?.toString(),\r\n\t\t\t\t\t\t\tTimeMilliseconds: requestTimeElapsed,\r\n\t\t\t\t\t\t\tCount: this.campaignDefinitions.length,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\tresolve(this.campaignDefinitions);\r\n\t\t\t\t}\r\n\t\t\t).catch(\r\n\t\t\t\t// handle any errors from catch block\r\n\t\t\t\t(error) => {\r\n\t\t\t\t\tresolve(this.campaignDefinitions);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\t\r\n\tpublic hasDataChanged() {\r\n\t\t// Not implemented - return false\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate loadCampaignDefinitions(response: CampaignDefinitions) {\r\n\t\tconst definitions = response && response.campaigns;\r\n\t\tif (definitions) {\r\n\t\t\tthis.campaignDefinitions = FilterValidCampaignDefinitions(definitions).result;\r\n\t\t}\r\n\t}\r\n}\r\n", "/*\r\n * LocalUserFactHelper.ts\r\n */\r\n\r\nimport { IUserFact } from \"../Common/Models\";\r\nimport { EventIds } from \"../Logging/Constants\";\r\nimport * as Logging from \"../Logging/Logger\";\r\nimport * as Utils from \"../Utils/Utils\";\r\nimport { getErrorMessage } from \"../Utils/Utils\";\r\n\r\nfunction getBrowserSettings() {\r\n\ttry {\r\n\t\t// Screen dimensions\r\n\t\tconst documentElement = document && (document.documentElement || document.getElementsByTagName(\"body\")[0]);\r\n\t\tconst browserSettings = {\r\n\t\t\tpageWidth: window?.innerWidth || documentElement?.clientWidth,\r\n\t\t\tpageHeight: window?.innerHeight || documentElement?.clientHeight,\r\n\t\t\tpageTop: window?.pageYOffset || documentElement?.scrollTop,\r\n\t\t\tpageLeft: window?.pageXOffset || documentElement?.scrollLeft,\r\n\t\t\tscreenWidth: screen ? screen.width : 0,\r\n\t\t\tscreenHeight: screen ? screen.height : 0,\r\n\t\t\tcolorDepth: screen ? screen.colorDepth : 0,\r\n\t\t\tuserAgent: navigator?.userAgent,\r\n\t\t};\r\n\r\n\t\treturn browserSettings;\r\n\t} catch (error) {\r\n\t\t// ignore\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n// Currently used for AADC but can be extended to any other settings\r\nfunction getCustomSettings(userConsentGroup: number, feedbackEnabledByAADC: boolean): Record<string, any>  {\r\n\t// Custom settings\r\n\tconst customSettings = {\r\n\t\t// AADC related values\r\n\t\tuserConsentGroup,\r\n\t\tfeedbackEnabledByAADC,\r\n\r\n\t\t// Other values\r\n\t};\r\n\r\n\treturn customSettings;\r\n}\r\n\r\n// input userFactName is expected to be of form window__obj1___obj2\r\nfunction getBrowserLocalFact(userFactName: string): IUserFact {\r\n\tconst factNameValues = userFactName && userFactName.split(\"__\");\r\n\tif (!factNameValues || factNameValues.length <= 1) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet userFact: IUserFact = null;\r\n\tconst objectName = factNameValues[0];\r\n\tconst propertyName = factNameValues.pop();\r\n\r\n\t// common top level objects eg: window__status\r\n\tif (propertyName && factNameValues.length === 1) {\r\n\t\tuserFact = createUserFact(window[objectName as any] || window, propertyName);\r\n\t}\r\n\r\n\t// handle names like window__navigator__userAgent__length\r\n\tif (!userFact && propertyName && factNameValues.length > 1) {\r\n\t\tif (objectName === \"window\") {\r\n\t\t\t// remove the window object.. it will be used as first/default\r\n\t\t\tfactNameValues.shift();\r\n\t\t}\r\n\r\n\t\t// try getting target as object path eg: window['navigator']['userAgent']\r\n\t\tconst globalObject = factNameValues.reduce((prev, curr) => prev && prev[curr as any], window);\r\n\t\tif (globalObject) {\r\n\t\t\t// get the fact value eg: 'length'\r\n\t\t\tuserFact = createUserFact(globalObject, propertyName);\r\n\t\t}\r\n\t}\r\n\r\n\tif (userFact) {\r\n\t\tuserFact.userFactName = userFactName;\r\n\t}\r\n\r\n\treturn userFact;\r\n}\r\n\r\n// For consistency, fact names should match %SRCROOT%\\personalization\\common\\LocalUserFactsDataProvider.cpp\r\nexport function createUserFact(targetObject: Record<string, any>, factName: string): IUserFact {\r\n\tif (!targetObject) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// get fact value\r\n\tlet factValue = targetObject[factName];\r\n\tif (!factValue) {\r\n\t\t// try looking up with case insensitive key\r\n\t\tconst loweCaseFactName = factName.toLowerCase();\r\n\t\tconst caseInsensitiveKey = Object.keys(targetObject).find((key) => key.toLowerCase() === loweCaseFactName);\r\n\t\tfactValue = targetObject[caseInsensitiveKey];\r\n\t}\r\n\r\n\tif (Utils.isNOU(factValue)) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// ignore object and function type values\r\n\tif (!Utils.isArray(factValue) && (Utils.isObject(factValue) || Utils.isFunction(factValue))) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Handle serialized values\r\n\tconst currentDateTime = new Date().toISOString();\r\n\treturn {\r\n\t\tuserFactType: \"Local\",\r\n\t\tuserFactName: factName,\r\n\t\tuserFactValue: factValue.toString(),\r\n\t\tsourceDateTime: currentDateTime,\r\n\t\tstorageDateTime: currentDateTime,\r\n\t\tclientIngestionDateTime: currentDateTime,\r\n\t};\r\n}\r\n\r\nlet localFactTargetObjects: Array<Record<string, any>>;\r\nexport function getLocalUserFact<T>(userFactName: string, commonInitOptions: Record<string, any>, configuration: any): IUserFact {\r\n\ttry {\r\n\t\tif (!localFactTargetObjects) {\r\n\t\t\tlocalFactTargetObjects = [\r\n\t\t\t\tcommonInitOptions,\r\n\t\t\t\tcommonInitOptions?.applicationSettings,\r\n\t\t\t\tcommonInitOptions?.telemetryGroup,\r\n\t\t\t\tcommonInitOptions?.applicationGroup,\r\n\t\t\t\tcommonInitOptions?.webGroup,\r\n\t\t\t\tconfiguration.getFloodgateInitOptions(),\r\n\t\t\t\tconfiguration,\r\n\t\t\t\tgetBrowserSettings(),\r\n\t\t\t\tgetCustomSettings(configuration.getUserConsentGroup(),\r\n\t\t\t\tconfiguration.isFeedbackSurveyEnabledByAADC()),\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\t// lookup in target objects and create fact\r\n\t\tlet userFact = localFactTargetObjects.reduce<IUserFact>(\r\n\t\t\t(generatedFact, targetObject) => generatedFact || createUserFact(targetObject, userFactName), null);\r\n\r\n\t\t// lookup global browser objects for names like navigator__userAgent or location__href\r\n\t\tif (!userFact) {\r\n\t\t\tuserFact = getBrowserLocalFact(userFactName);\r\n\t\t}\r\n\r\n\t\treturn userFact;\r\n\t} catch (error) {\r\n\t\tLogging.getLogger().event(\r\n\t\t\tEventIds.UserFactsLocalFactError,\r\n\t\t\t{\r\n\t\t\t\tErrorMessage: `Error getting local fact - ${userFactName} ${getErrorMessage(error)} `,\r\n\t\t\t});\r\n\r\n\t\treturn null;\r\n\t}\r\n}\r\n", "/**\r\n * UserFactsProvider.ts\r\n *\r\n * Module for user facts provider.\r\n */\r\n\r\nimport { getDynamicSetting, SettingKey } from \"@ms-ofb/officepersonalization/dist/lib/Configuration/DynamicConfiguration\";\r\nimport { TULIPS_INGESTION_TIME, TULIPS_LOAD_TIMEOUT }\r\n\tfrom \"@ms-ofb/officepersonalization/dist/lib/TargetedMessaging/TargetedMessagingConstants\";\r\nimport { IUserFactProvider } from \"@ms-ofb/officefloodgatecore/dist/src/Api/IUserFactProvider\";\r\nimport * as AssetsProvider from \"./AssetsProvider\";\r\nimport * as Logging from \"../Logging/Logging\";\r\n\r\nimport { getCachedUserFacts } from \"@ms-ofb/officepersonalization/dist/lib/Facts/CachedUserFacts\";\r\nimport { IUserFact } from \"@ms-ofb/officepersonalization/dist/lib/Common/Models\";\r\n\r\nimport { createTimeoutPromise } from \"../Utils\";\r\nimport { getLocalUserFact } from \"@ms-ofb/officepersonalization/dist/lib/TargetedMessaging/LocalUserFactHelper\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\n\r\nexport class UserFactsProvider implements IUserFactProvider {\r\n\tprivate loadAsyncTriggered = false;\r\n\tprivate userFacts: IUserFact[] = [];\r\n\tprivate nameAndUserFactMap: Record<string, IUserFact> = {};\r\n\r\n\tpublic load(): IUserFact[] {\r\n\t\tif (!this.loadAsyncTriggered) {\r\n\t\t\tthis.loadAsync();\r\n\t\t\tthis.loadAsyncTriggered = true;\r\n\t\t}\r\n\r\n\t\treturn this.userFacts || [];\r\n\t}\r\n\r\n\tpublic loadAsync(): Promise<IUserFact[]> {\r\n\t\tconst userFactsPromise = AssetsProvider.get().getUserFacts().then(userFacts => {\r\n\t\t\tthis.loadUserFacts(userFacts);\r\n\t\t});\r\n\r\n\t\tconst timeoutMilliseconds = getDynamicSetting(SettingKey.tulipsLoadTimeout, TULIPS_LOAD_TIMEOUT);\r\n\t\tconst timeoutPromise = createTimeoutPromise(timeoutMilliseconds, userFactsPromise);\r\n\t\treturn timeoutPromise.then(() => this.userFacts).catch(() => {\r\n\t\t\tif (!this.userFacts || this.userFacts.length <= 0) {\r\n\t\t\t\tthis.loadUserFacts(getCachedUserFacts());\r\n\t\t\t}\r\n\r\n\t\t\treturn this.userFacts;\r\n\t\t}).catch(() => this.userFacts);\r\n\t}\r\n\r\n\tpublic getUserFact(userFactName: string) {\r\n\t\tlet userFact = this.nameAndUserFactMap[userFactName];\r\n\t\tif (userFact || Object.prototype.hasOwnProperty.call(this.nameAndUserFactMap, userFactName)) {\r\n\t\t\treturn userFact;\r\n\t\t}\r\n\r\n\t\tuserFact = this.nameAndUserFactMap[userFactName] =\r\n\t\t\tgetLocalUserFact(userFactName, Configuration.get().getCommonInitOptions, Configuration.get());\r\n\t\treturn userFact;\r\n\t}\r\n\r\n\tprivate loadUserFacts(response: IUserFact[]) {\r\n\t\tif (response) {\r\n\t\t\tthis.userFacts = response || [];\r\n\t\t\tthis.userFacts.map((userFact) => {\r\n\t\t\t\tthis.nameAndUserFactMap[userFact.userFactName] = userFact;\r\n\t\t\t});\r\n\t\t\tthis.loadAsyncTriggered = true;\r\n\t\t\tthis.logUserFactInfo(this.userFacts);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate logUserFactInfo(userFacts: IUserFact[]) {\r\n\t\tif (!userFacts || userFacts.length <= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst tulipsIngestionTimeInterval = getDynamicSetting(SettingKey.tulipsIngestionTimeInterval, TULIPS_INGESTION_TIME);\r\n\t\tif (tulipsIngestionTimeInterval <= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet userFactProperties: Logging.ICustomProperties;\r\n\t\ttry {\r\n\t\t\tconst nowDate = Date.now();\r\n\t\t\tconst isExpired = (rawItemDate: string): boolean => {\r\n\t\t\t\tconst itemDate = Date.parse(rawItemDate);\r\n\t\t\t\treturn !isNaN(itemDate) ? nowDate - itemDate > tulipsIngestionTimeInterval : true;\r\n\t\t\t};\r\n\r\n\t\t\tconst factInfo = {\r\n\t\t\t\tCount: userFacts.length,\r\n\t\t\t\tRefreshTime: tulipsIngestionTimeInterval,\r\n\t\t\t\tIngestionTime: userFacts[0].clientIngestionDateTime,\r\n\t\t\t\tSourcesExpired: userFacts.filter(userFact => userFact && isExpired(userFact.sourceDateTime)).length || undefined,\r\n\t\t\t\tStoragesExpired: userFacts.filter(userFact => userFact && isExpired(userFact.storageDateTime)).length || undefined,\r\n\t\t\t\tIngestionsExpired: userFacts.filter(userFact => userFact && isExpired(userFact.clientIngestionDateTime)).length || undefined,\r\n\t\t\t};\r\n\r\n\t\t\tuserFactProperties = {\r\n\t\t\t\tMessage: \"UserFacts\",\r\n\t\t\t\tData: JSON.stringify(factInfo),\r\n\t\t\t};\r\n\t\t} catch (error) {\r\n\t\t\tuserFactProperties = {\r\n\t\t\t\tErrorMessage: \"Error getting UserFact info\",\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tLogging.getLogger().logEvent(\r\n\t\t\tLogging.EventIds.UserFacts.Provider.Info.VALUE,\r\n\t\t\tLogging.LogLevel.Info,\r\n\t\t\tuserFactProperties);\r\n\t}\r\n}\r\n", "import { TelemetryEvent } from \"@microsoft/oteljs\";\r\nimport  * as UserFacts from \"@ms-ofb/officepersonalization/dist/lib/Facts/UserFacts\";\r\n\r\nexport function processTelemetryEvent(telemetryEvent: TelemetryEvent): void {\r\n    UserFacts.processTelemetryEvent(telemetryEvent);\r\n}", "import  * as UserFacts from \"@ms-ofb/officepersonalization/dist/lib/Facts/UserFacts\";\r\n\r\nexport function sendUserFact(userFactName: string): void {\r\n    UserFacts.processUserFactEvent(userFactName, new Date());\r\n}\r\n", "/**\r\n * Theme.ts\r\n *\r\n * Module for the UI Theme\r\n */\r\n\r\nimport { Classes, IDs } from \"./UI/UiConstants\";\r\n\r\nconst defaultPrimaryColour = \"#0167B0\";\r\nconst defaultSecondaryColour = \"#194789\";\r\n\r\n/**\r\n * Init\r\n * @param {string} primaryColour Primary Colour\r\n * @param {string} secondaryColour Secondary Colour\r\n */\r\nexport function initialize(primaryColour: string = undefined, secondaryColour: string = undefined) {\r\n\tif (!primaryColour) {\r\n\t\tprimaryColour = defaultPrimaryColour;\r\n\t}\r\n\r\n\tif (!secondaryColour) {\r\n\t\tsecondaryColour = defaultSecondaryColour;\r\n\t}\r\n\r\n\tconst sheet = document.createElement(\"style\");\r\n\r\n\tsheet.textContent =\r\n\t\t`.${Classes.OverallAnchor}:focus { background-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.OverallAnchor}:hover { background-color: ${secondaryColour} } ` +\r\n\t\t`.${Classes.OverallAnchorActive} { background-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.SpinnerCircle} { background-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.ChoiceGroup} input[type=radio]:checked+label>.${Classes.ChoiceGroupIcon} { border-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.ChoiceGroup} input[type=radio]:hover+label>.${Classes.ChoiceGroupIcon} { border-color: ${secondaryColour} } ` +\r\n\t\t`.${Classes.ChoiceGroup} input[type=radio]:checked+label>.${Classes.ChoiceGroupIcon}>span { background-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.SubmitButton} { background-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.SubmitButton}:hover { background-color: ${secondaryColour} } ` +\r\n\t\t`.${Classes.CancelButton} { background-color: ${primaryColour} } ` +\r\n\t\t`.${Classes.CancelButton}:hover { background-color: ${secondaryColour} } ` +\r\n\t\t`.${Classes.Link} { color: ${primaryColour} } ` +\r\n\t\t`.${Classes.Link}:hover { color: ${secondaryColour} } ` +\r\n\t\t`.${Classes.ThanksPanelTitle} { color: ${primaryColour} } ` +\r\n\t\t`#${IDs.TPromptTitle} { color: ${primaryColour} } ` +\r\n\t\t`#${IDs.TFormTitle} { color: ${primaryColour} } `;\r\n\r\n\tdocument.body.appendChild(sheet);\r\n}\r\n", "/**\r\n * CommonUI.ts\r\n *\r\n * Common logic for UI.\r\n */\r\n\r\nimport * as Configuration from \"./Configuration/Configuration\";\r\nimport * as Logging from \"./Logging/Logging\";\r\nimport { processTelemetryEvent } from \"./TargetedMessaging/ProcessTelemetryEvent\";\r\nimport { sendUserFact } from \"./TargetedMessaging/SendUserFact\";\r\nimport * as Theme from \"./Theme\";\r\nimport * as UIStrings from \"./UIStrings/UIStrings\";\r\nimport { loadScript } from \"./Window/DomUtils\";\r\nimport * as Window from \"./Window/Window\";\r\n\r\nimport \"../../styles/officebrowserfeedback.css\";\r\n\r\n/**\r\n * Has the SDK been initialized\r\n */\r\nlet initialized = false;\r\n\r\n/**\r\n * Set ui Strings.\r\n * @param data the ui strings\r\n */\r\nfunction setUIStrings(data: any): void {\r\n\tUIStrings.setUIStrings(data);\r\n}\r\n\r\n/**\r\n * Initialize\r\n */\r\nexport function initialize(): Promise<any> {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tif (!initialized) {\r\n\t\t\tconst initOptionsCommon = Configuration.get().getCommonInitOptions();\r\n\t\t\tif (!initOptionsCommon) {\r\n\t\t\t\treject(\"initOptionsCommon is null\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif((initOptionsCommon.customResourcesSetExternally & Configuration.CustomResources.Css) === Configuration.CustomResources.Css || \t\r\n\t\t\t\tinitOptionsCommon.stylesUrl) {\r\n\t\t\t\tLogging.getLogger().logEvent(Logging.EventIds.Common.Info.VALUE,\r\n\t\t\t\t\tLogging.LogLevel.Info,\r\n\t\t\t\t\t{ Data: `App ${initOptionsCommon.appId} tried to initialize with stylesURL under soft depreciation version` },\r\n\t\t\t\t\t0.01\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tTheme.initialize(initOptionsCommon.primaryColour, initOptionsCommon.secondaryColour);\r\n\r\n\t\t\t// Check if custom strings are being passed.\r\n\t\t\tif ((initOptionsCommon.customResourcesSetExternally & Configuration.CustomResources.Strings) === Configuration.CustomResources.Strings) {\r\n\t\t\t\tif (!UIStrings.getUIStrings()) {\r\n\t\t\t\t\treject(\"Expected custom strings to be set by host but UIStrings.getUIStrings() is null or undefined\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinitialized = true;\r\n\t\t\t\tresolve(null);\r\n\t\t\t} else {\r\n\t\t\t\tconst intlFileUrl = initOptionsCommon.intlUrl + initOptionsCommon.locale.toLowerCase() + \"/\" +\r\n\t\t\t\t\tinitOptionsCommon.intlFilename;\r\n\r\n\t\t\t\tloadScript(intlFileUrl)\r\n\t\t\t\t\t.then(\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (!UIStrings.getUIStrings()) {\r\n\t\t\t\t\t\t\t\treject(\"UiStrings were not loaded from \" + intlFileUrl);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tinitialized = true;\r\n\t\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t).catch(\r\n\t\t\t\t\t\t(err) => {\r\n\t\t\t\t\t\t\treject(\"Script load failed for \" + intlFileUrl + \". \" + err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresolve(null);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Reset the module. Used in unit tests.\r\n */\r\nexport function reset() {\r\n\tinitialized = false;\r\n}\r\n\r\n/* Make the the following methods available globally */\r\nWindow.setProcessTelemetryEvent(processTelemetryEvent);\r\nWindow.setSendUserFact(sendUserFact);\r\nWindow.setSetUiStrings(setUIStrings);\r\n", "import { DynamicUxClientState } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Configuration from \"../Configuration/Configuration\";\r\nimport * as DynamicUxClient from \"../UI/DynamicUx/DynamicUxClient\";\r\n\r\n// helper method for determining whether session is Floodgate2\r\nexport function isFloodgate2(isUxSchemaPresent: boolean): boolean {\r\n    const isDynamicUXEnabled = Configuration.get().getFloodgateInitOptions()?.dynamicUxConfig?.enabled ?? false;\r\n\r\n    const dynamicUXClientState = DynamicUxClient?.get()?.getStatus();\r\n\r\n    if (isDynamicUXEnabled)\r\n    {\r\n        // corner case where dynUXClient didn't succeed, but dynamic UX is enabled\r\n        if (dynamicUXClientState !== DynamicUxClientState.Success){\r\n            return false;\r\n        }\r\n        else {\r\n            return isUxSchemaPresent;\r\n        }\r\n    }\r\n    else {\r\n        return false;\r\n    }\t\t\r\n}", "/**\r\n * Implementation of IFloodgateTelemetryLogger for Web SDK\r\n */\r\n\r\nimport { Api, TreatmentType } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Logging from \"../Logging/Logging\";\r\nimport { isFloodgate2 } from \"../Logging/utils\";\r\n\r\nexport default class IFloodgateTelemetryLogger implements Api.IFloodgateTelemetryLogger {\r\n\r\n\t/**\r\n\t * Log that a survey's trigger was met.\r\n\t * @param campaignId Id of the campaign the survey belongs to.\r\n\t * @param surveyId Id of the survey.\r\n\t * @param surveyType Type of the survey.\r\n\t * @param surveyActivityInfo The survey's activities' information such as names, counts, isAggregate and if the list is ordered.\r\n\t * @param additionalSurveyInfo additional survey info in a stringified json object:\r\n\t * \t\t- surveyLauncherType: LauncherType of the survey.\r\n\t * \t\t- channelType: The channel type of the survey's campaign.\r\n\t * \t\t- surveyPercentageNumerator: Percentage numerator of the survey's Campaign.\r\n\t * \t\t- surveyPercentageDenominator: Percentage denominator of the survey's Campaign.\r\n\t * \t\t- surveyNominationPeriodNumber: The Nomination Period of the survey's Campaign in seconds, -1 if not applicable.\r\n\t * \t\t- surveyCooldownPeriodNumber: The Cooldown Period of the survey's Campaign in seconds, -1 if not applicable.\r\n\t * \t\t- allCandidateCampaignDefinitionIDs: The list of campaign definition IDs that have corresponding surveys which are candidates.\r\n\t * \t\t- allCampaignDefinitionIDs: The list of all campaign definition IDs.\r\n\t * @param treatmentType Type of campaign the user was selected for (ex. Control, TreatmentA, TreatmentB, etc). Default is type none.\r\n\t * @param isUxSchemaPresent Whether UxSchema is present for this session\r\n\t */\r\n\tpublic log_TriggerMet(campaignId: string, surveyId: string, surveyType: Api.SurveyType, surveyActivityInfo: string,\r\n\t\tadditionalSurveyInfo: string, treatmentType: TreatmentType, isUxSchemaPresent: boolean): void {\r\n\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_FLOODGATE_TRIGGERMET,\r\n\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t{\r\n\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\tSurveyId: surveyId,\r\n\t\t\t\tSurveyType: surveyType,\r\n\t\t\t\tSurveyActivityInfo: surveyActivityInfo,\r\n\t\t\t\tAdditionalSurveyInfo : additionalSurveyInfo,\r\n\t\t\t\tTreatmentType: treatmentType,\r\n\t\t\t\tIsFloodgate2: isFloodgate2(isUxSchemaPresent),\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Log that a user was selected(nominated) for a survey if it's not sampled\r\n\t * @param campaignId Id of the campaign the survey belongs to.\r\n\t * @param surveyId Id of the survey.\r\n\t * @param surveyType Type of the survey.\r\n\t * @param additionalSurveyInfo additional survey info in a stringified json object:\r\n\t * \t\t- surveyLauncherType LauncherType of the survey.\r\n\t * \t\t- channelType The channel type of the survey's campaign.\r\n\t * \t\t- surveyPercentageNumerator Percentage numerator of the survey's Campaign.\r\n\t * \t\t- surveyPercentageDenominator Percentage denominator of the survey's Campaign.\r\n\t * \t\t- surveyNominationPeriodNumber The Nomination Period of the survey's Campaign in seconds, -1 if not applicable.\r\n\t * \t\t- surveyCooldownPeriodNumber The Cooldown Period of the survey's Campaign in seconds, -1 if not applicable.\r\n\t * \t\t- allCandidateCampaignDefinitionIDs: The list of campaign definition IDs that have corresponding surveys which are candidates.\r\n\t * \t\t- allCampaignDefinitionIDs: The list of all campaign definition IDs.\r\n\t * @param treatmentType Type of campaign the user was selected for (ex. Control, TreatmentA, TreatmentB, etc). Default is type none.\r\n\t */\r\n\tpublic log_UserSelected(campaignId: string, surveyId: string, surveyType: Api.SurveyType, additionalSurveyInfo: string,\r\n\t\ttreatmentType: TreatmentType): void {\r\n\r\n\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_FLOODGATE_USERSELECTED,\r\n\t\t\tLogging.LogLevel.Critical,\r\n\t\t\t{\r\n\t\t\t\tCampaignId: campaignId,\r\n\t\t\t\tSurveyId: surveyId,\r\n\t\t\t\tSurveyType: surveyType,\r\n\t\t\t\tAdditionalSurveyInfo : additionalSurveyInfo,\r\n\t\t\t\tTreatmentType: treatmentType,\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Log that campaign definitions failed to load.\r\n\t * @param errorMessage error message\r\n\t */\r\n\tpublic log_CampaignLoad_Failed(errorMessage: string): void {\r\n\t\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_FLOODGATE_CAMPAIGNLOAD_FAILED,\r\n\t\t\tLogging.LogLevel.Error,\r\n\t\t\t{\r\n\t\t\t\tErrorMessage: errorMessage,\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Log an event with error message\r\n\t * @param eventId event id\r\n\t * @param errorMessage error message\r\n\t */\r\n\tpublic log_Error(eventId: string, errorMessage: string): void {\r\n\t\tconst event: Logging.IEventId = { name: eventId };\r\n\t\tLogging.getLogger().logEvent(event,\r\n\t\t\tLogging.LogLevel.Error,\r\n\t\t\t{\r\n\t\t\t\tErrorMessage: errorMessage,\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Log an event with properties\r\n\t * @param eventId event id\r\n\t * @param properties telemetry event properties\r\n\t * @param internalSampleRate sample rate for this event in decimal (example: 0.05 for 5%). (Does not override host set sampleRate)\r\n\t */\r\n\tpublic log_Event(eventId: string, properties: Api.ITelemetryProperties, internalSampleRate?: number): void {\r\n\t\tconst event: Logging.IEventId = { name: eventId };\r\n\t\tLogging.getLogger().logEvent(event, Logging.LogLevel.Critical, properties, internalSampleRate);\r\n\t}\r\n\r\n\t/**\r\n\t * Log message locally\r\n\t * @param message message\r\n\t * @param data message data\r\n\t */\r\n\tpublic log_LocalError(message: string, ...data: any[]): void {\r\n\t\tthis.log_Local(Logging.LogLevel.Error, message, data);\r\n\t}\r\n\r\n\tprivate log_Local(logSeverity: Logging.LogLevel, message: string, ...others: any[]): void {\r\n\t\tLogging.getLogger().logLocal(logSeverity, others);\r\n\t}\r\n}\r\n", "/**\r\n * IUISurvey implementation based on an ICustomSurvey object\r\n */\r\n\r\nimport { Api , GovernedChannelType, IUxSchema} from \"@ms-ofb/floodgate-shared-typings\";\r\nimport ICustomSurvey from \"../ICustomSurvey\";\r\nimport * as Utils from \"../../Utils\";\r\nimport IUISurvey from \"./IUISurvey\";\r\n\r\nexport default class CustomUISurvey implements IUISurvey {\r\n\tpublic showPrompt: boolean;\r\n\r\n\tpublic showEmailRequest: boolean;\r\n\r\n\tprivate comment = \"\";\r\n\tprivate ratingIndex = -1;\r\n\tprivate survey: ICustomSurvey;\r\n\r\n\tpublic constructor(survey: ICustomSurvey) {\r\n\t\tthis.showPrompt = survey.showPrompt;\r\n\t\tthis.showEmailRequest =  Utils.isBoolean(survey.showEmailRequest) ? survey.showEmailRequest : false;\r\n\t\tthis.survey = survey;\r\n\t}\r\n\r\n\tpublic getLauncherType(): string {\r\n\t\treturn this.survey.launcherType;\r\n\t}\r\n\r\n\tpublic getCVSurveyFormId(): string {\r\n\t\treturn this.survey.customerVoiceFormId;\r\n\t}\r\n\r\n\tpublic getPreGeneratedClientFeedbackId(): string {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic getPromptQuestion(): string {\r\n\t\treturn this.survey.promptQuestion;\r\n\t}\r\n\r\n\tpublic getTitle(): string {\r\n\t\treturn this.survey.title;\r\n\t}\r\n\r\n\tpublic getPromptYesButtonText(): string {\r\n\t\treturn this.survey.promptYesButtonText;\r\n\t}\r\n\r\n\tpublic getPromptNoButtonText(): string {\r\n\t\treturn this.survey.promptNoButtonText;\r\n\t}\r\n\r\n\tpublic getRatingValuesAscending(): string[] {\r\n\t\treturn this.survey.ratingValuesAscending;\r\n\t}\r\n\r\n\tpublic getRatingQuestion(): string {\r\n\t\treturn this.survey.ratingQuestion;\r\n\t}\r\n\r\n\tpublic getCommentQuestion(): string {\r\n\t\treturn this.survey.commentQuestion;\r\n\t}\r\n\r\n\tpublic getInterceptTitle(): string {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic getInterceptQuestion(): string {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic getInterceptUrl(): string {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic setValues(ratingIndex: number, comment: string): void {\r\n\t\tthis.comment = comment;\r\n\t\tif (this.isRatingIndexValid(ratingIndex)) {\r\n\t\t\tthis.ratingIndex = ratingIndex;\r\n\t\t} else {\r\n\t\t\tthis.ratingIndex = -1;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getJsonElements(): any {\r\n\t\tconst result: any = {};\r\n\r\n\t\tresult.comment = this.comment;\r\n\t\tresult.rating = this.getNormalizedRatingScore();\r\n\t\tresult.survey = {\r\n\t\t\tsurveyId: this.getCampaignId(),\r\n\t\t};\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic getSurveyType(): Api.SurveyType {\r\n\t\treturn this.survey.surveyType;\r\n\t}\r\n\r\n\tpublic getCampaignId(): string {\r\n\t\treturn this.survey.campaignId;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.getCampaignId();\r\n\t}\r\n\r\n\tpublic getGoverenedChannelType(): GovernedChannelType {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic getUxSchema(): IUxSchema {\r\n\t\treturn this.survey.uxSchema;\r\n\t}\r\n\t\r\n\tpublic isContentValid(): boolean {\r\n\t\treturn (!Utils.isNOU(this.survey.promptQuestion) && !Utils.isNOU(this.survey.title) || !this.survey.showPrompt) &&\r\n\t\t!Utils.isNOU(this.survey.ratingValuesAscending) && !Utils.isNOU(this.survey.ratingQuestion) &&\r\n\t\t!Utils.isNOU(this.survey.commentQuestion);\r\n\t}\r\n\r\n\tpublic isUserInitiatedSurvey(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate isRatingIndexValid(index: number): boolean {\r\n\t\treturn (index >= 0 && index < this.survey.ratingValuesAscending.length);\r\n\t}\r\n\r\n\tprivate getNormalizedRatingScore(): number {\r\n\t\tif (!this.isRatingIndexValid(this.ratingIndex)) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\r\n\t\tif (this.survey.isZeroBased) {\r\n\t\t\treturn (this.ratingIndex) / (this.survey.ratingValuesAscending.length - 1);\r\n\t\t} else {\r\n\t\t\treturn (this.ratingIndex + 1.0) / this.survey.ratingValuesAscending.length;\r\n\t\t}\r\n\t}\r\n}\r\n", "/**\r\n * Dummy IUISurvey implementation without dependancy on officefloodgatecore\r\n */\r\n\r\nimport { Api, GovernedChannelType, IUxSchema } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport IUISurvey from \"./IUISurvey\";\r\nimport * as Utils from \"../../Utils\";\r\n\r\nexport default class DummySurvey implements IUISurvey {\r\n\tpublic showPrompt = true;\r\n\r\n\tpublic showEmailRequest = true;\r\n\r\n\tprivate comment = \"\";\r\n\tprivate rating: number;\r\n\r\n\tpublic getCVSurveyFormId(): string {\r\n\t\treturn \"Form ID\";\r\n\t}\r\n\r\n\tpublic getLauncherType(): string {\r\n\t\treturn \"Launcher Type\";\r\n\t}\r\n\r\n\tpublic getPromptQuestion(): string {\r\n\t\treturn \"Prompt question?\";\r\n\t}\r\n\r\n\tpublic getTitle(): string {\r\n\t\treturn \"Title\";\r\n\t}\r\n\r\n\tpublic getPromptYesButtonText(): string {\r\n\t\treturn \"Yes\";\r\n\t}\r\n\r\n\tpublic getPromptNoButtonText(): string {\r\n\t\treturn \"No\";\r\n\t}\r\n\r\n\tpublic getRatingValuesAscending(): string[] {\r\n\t\treturn [\"worst\", \"worse\", \"ok\", \"better\", \"best\"];\r\n\t}\r\n\r\n\tpublic getRatingQuestion(): string {\r\n\t\treturn \"Rating question?\";\r\n\t}\r\n\r\n\tpublic getCommentQuestion(): string {\r\n\t\treturn \"Comment question?\";\r\n\t}\r\n\r\n\tpublic getInterceptTitle(): string {\r\n\t\treturn \"Intercept Title\";\r\n\t}\r\n\r\n\tpublic getInterceptQuestion(): string {\r\n\t\treturn \"Intercept question?\";\r\n\t}\r\n\r\n\tpublic getInterceptUrl(): string {\r\n\t\treturn \"https://example.com\";\r\n\t}\r\n\r\n\tpublic setValues(selectedIndex: number, comment: string): void {\r\n\t\tif (comment) { this.comment = comment; }\r\n\t\tif (Utils.isInteger(selectedIndex) && selectedIndex >= 0 && selectedIndex <= 4) {\r\n\t\t\tthis.rating = selectedIndex / 4.0;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getJsonElements(): any {\r\n\t\tconst result: any = {};\r\n\r\n\t\tif (this.comment) { result.comment = this.comment; }\r\n\t\tif (this.rating) { result.rating = this.rating; }\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic getSurveyType(): Api.SurveyType {\r\n\t\treturn Api.SurveyType.Nps;\r\n\t}\r\n\r\n\tpublic getCampaignId(): string {\r\n\t\treturn \"10000000-0000-0000-0000-000000000000\";\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn \"00000000-0000-0000-0000-000000000000\";\r\n\t}\r\n\r\n\tpublic getGoverenedChannelType(): GovernedChannelType {\r\n\t\treturn GovernedChannelType.Standard;\r\n\t}\r\n\r\n\tpublic getPreGeneratedClientFeedbackId(): string {\r\n\t\treturn \"00000000-0000-0000-0000-000000000000\";\r\n\t}\r\n\t\r\n\tpublic getUxSchema(): IUxSchema {\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\tpublic isContentValid(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic isUserInitiatedSurvey(): boolean {\r\n\t\treturn false;\r\n\t}\r\n}\r\n", "import { isNOU } from \"@ms-ofb/officefloodgatecore/dist/src/Utils\";\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { IDs, PromptConstants } from \"./../UiConstants\";\r\nimport * as Configuration from \"./../../Configuration/Configuration\";\r\nimport {\r\n\trenderCVSurvey,\r\n\tISurveyPayloadAdditionalInfo, EventType,\r\n\tQuestionType, ISurveyQuestionAnswer,\r\n} from \"gatecrash\";\r\nimport { Transporter } from \"./../../Transport/Transport\";\r\nimport * as Logging from \"./../../Logging/Logging\";\r\nimport { customerVoiceSurveyUX } from \"../../Constants\";\r\nimport { IOnDismissDelegate } from \"../../IOnDismissDelegate\";\r\nimport { IContextParams, ISurveyOptionalConfigParams, ISurveyRenderContext } from \"../../IRenderSurvey\";\r\nimport { IHandleSurveyEvent, ISurveyEventData, SurveyEventKey } from \"../../IHandleSurveyEvent\";\r\nimport { IOverrideRenderCallback } from \"../../IOverrideRenderCallback\";\r\n\r\n/**\r\n * Callback when the CV Survey dialog is dismissed\r\n */\r\nlet onDismiss: IOnDismissDelegate;\r\nlet onDismissFlag = false;\r\nlet isPromptResponseLogValidated = false;\r\nlet isAdditionalPromptResponseLogValidated = false;\r\nlet hasSubmittedData = false;\r\nconst SurveyUIFormSecondarySubmitName = \"Survey_UI_Form_Secondary_Submit_Page_Number_\";\r\nconst SurveyUIFormUserClosedName = \"Survey_UI_Form_UserClosed_Page_Number_\";\r\nlet firstCommentResponse: string = null;\r\nlet firstCommentTitle = \"\";\r\n\r\n/**\r\n * Function to show Customer Voice survey experience\r\n */\r\nexport function createCVSurvey(\r\n\tcontextParams: IContextParams,\r\n\tonClose: () => void,\r\n\tcvSurveyOptionalConfigParams?: ISurveyOptionalConfigParams,\r\n\toverrideUXRenderCallbackAsync?: IOverrideRenderCallback,\r\n): ISurveyRenderContext {\r\n\tonDismiss = function (submitted: boolean) {\r\n\t\tConfiguration.get().getFloodgateInitOptions().onDismiss(\r\n\t\t\tConfiguration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\tsubmitted\r\n\t\t);\r\n\t\tonClose();\r\n\t};\r\n\r\n\tif (overrideUXRenderCallbackAsync) {\r\n\t\tconst logCustomProps: Logging.ICustomProperties = {\r\n\t\t\tCampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\tSurveyId: Configuration.get().getFloodgateSurvey().getId(),\r\n\t\t\tSurveyType: Configuration.get().getFloodgateSurvey().getSurveyType(),\r\n\t\t};\r\n\r\n\t\toverrideUXRenderCallbackAsync(contextParams)\r\n\t\t\t.then(() => {\r\n\t\t\t\tinternal.logTelemetryEvent(Logging.EventIds.SURVEY_RENDER_OVERRIDE_SUCCESS, logCustomProps);\r\n\t\t\t}).catch((ex) => {\r\n\t\t\t\tlogCustomProps.ErrorMessage = ex;\r\n\t\t\t\tinternal.logTelemetryEvent(Logging.EventIds.SURVEY_RENDER_OVERRIDE_ERROR, logCustomProps);\r\n\t\t\t});\r\n\t\treturn {\r\n\t\t\tupdateStyling: () => { return; },\r\n\t\t};\r\n\t} else {\r\n\t\tconst renderContext: ISurveyRenderContext = renderCVSurvey(\r\n\t\t\tIDs.ToastContainer,\r\n\t\t\thandleSurveyEvent,\r\n\t\t\tcontextParams,\r\n\t\t\tcvSurveyOptionalConfigParams\r\n\t\t);\r\n\r\n\t\tinternal.logTelemetryEvent(Logging.EventIds.SURVEY_UI_RENDER_CV_SURVEY_COMPLETED);\r\n\t\treturn renderContext;\r\n\t}\r\n}\r\n\r\n/**\r\n * The default handler of events emitted by custom survey tools.\r\n * @param key an identifier for the event\r\n * @param data all data needed to process the event\r\n */\r\nexport const handleSurveyEvent: IHandleSurveyEvent = (\r\n\tkey: SurveyEventKey,\r\n\tdata: ISurveyEventData,\r\n): void => {\r\n\tlet keyPrefix: string;\r\n\tlet keyBase: string;\r\n\tlet err = false;\r\n\r\n\tconst splitKey: string[] = key.split(\"_\");\r\n\tif (splitKey.length > 1) {\r\n\t\tkeyPrefix = splitKey[0];\r\n\t\tkeyBase = splitKey[1];\r\n\t} else {\r\n\t\tkeyPrefix = \"Other\";\r\n\t\tkeyBase = splitKey[0];\r\n\t}\r\n\r\n\tswitch (keyPrefix) {\r\n\t\tcase \"CV\":\r\n\t\t\tswitch (keyBase) {\r\n\t\t\t\tcase \"OnSubmit\": return onCVSubmit(data);\r\n\t\t\t\tcase \"OnCancel\": return onCVCancel(data);\r\n\t\t\t\tcase \"OnLoaded\": return onCVLoaded(data);\r\n\t\t\t\tcase \"OnLog\": return logGatecrashEvent(data);\r\n\t\t\t\tdefault: err = true;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tdefault: err = true;\r\n\t}\r\n\r\n\tif (err) {\r\n\t\tconst logCustomProps: Logging.ICustomProperties = {\r\n\t\t\tCampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\tSurveyId: Configuration.get().getFloodgateSurvey().getId(),\r\n\t\t\tSurveyType: Configuration.get().getFloodgateSurvey().getSurveyType(),\r\n\t\t};\r\n\t\tinternal.logTelemetryEvent(Logging.EventIds.SURVEY_EVENT_KEY_ERROR, logCustomProps);\r\n\t}\r\n};\r\n\r\n// Setting Rating field for SubmitData\r\nexport function getRating(values: ISurveyQuestionAnswer): number {\r\n\treturn parseInt(values?.answerValue[0], 10) - 1;\r\n}\r\n\r\n// Setting QuestionValue field for SubmitData\r\nexport function getQuestionValue(values: ISurveyQuestionAnswer): string {\r\n\treturn values?.questionValue;\r\n}\r\n\r\n// Setting AnswerValue field for SubmitData\r\nexport function getAnswerValue(values: ISurveyQuestionAnswer): string {\r\n\treturn isNOU(values?.answerValue[0]) ? values?.answerValue[0] : `${values?.answerValue[0]}`;\r\n}\r\n\r\n// Setting InsightfulOptions for insightful field for SubmitData\r\nexport function getInsightfulOptions(values: ISurveyQuestionAnswer): string[] { // Evaluate\r\n\treturn values?.insightfulQuestionOptions;\r\n}\r\n\r\n// Setting InsightfulAnswers for insightful field for SubmitData\r\nexport function getInsightfulAnswers(values: ISurveyQuestionAnswer): boolean[] { // Evaluate\r\n\treturn values?.insightfulQuestionAnswers;\r\n}\r\n\r\nexport interface IFormattedData {\r\n\trating: number;\r\n\tcommentsCollection?: string[];\r\n\temail?: string;\r\n\tratingQuestion?: string;\r\n\tratingsListLength: number;\r\n\tpromptQuestion?: string;\r\n\tpromptResponse?: string;\r\n\tcommentTitlesCollection?: { question: string }[];\r\n\tadditionalPromptQuestion?: string;\r\n\tadditionalPromptResponse?: string;\r\n\tinsightfulQuestionOptionsCollection?: { question: string, options: string[] }[];\r\n\tinsightfulQuestionAnswersCollection?: boolean[][];\r\n}\r\n\r\n/* Traverses the CV Survey response object array and creates props for OCV Payload; \r\n * on the face of it though it is O(N^2) runtime complexity, \r\n * given the number of pages are only in finite number \r\n * (wouldn't expect more than 10 pages at most), this should still run in constant time. \r\n */\r\nexport function formatSubmitData(submitData: ISurveyEventData): IFormattedData {\r\n\r\n\tlet rating: number;\r\n\tconst commentsCollection: string[] = [];\r\n\tlet email: string;\r\n\tlet ratingQuestion: string;\r\n\tlet ratingsListLength: number;\r\n\tlet promptQuestion: string;\r\n\tlet promptResponse: string;\r\n\tconst commentTitlesCollection: { question: string }[] = [];\r\n\tlet additionalPromptQuestion: string;\r\n\tlet additionalPromptResponse: string;\r\n\tconst insightfulQuestionOptionsCollection: { question: string, options: string[] }[] = [];\r\n\tconst insightfulQuestionAnswersCollection: boolean[][] = [];\r\n\tlet isFirstCommentValidated = false;\r\n\tlet isFirstEmptyCommentAdded = false;\r\n\r\n\tsubmitData.pageInfo?.forEach(currentPage => {\r\n\r\n\t\tcurrentPage.questionAnswers.forEach(values => {\r\n\r\n\t\t\tswitch (values?.questionType) {\r\n\r\n\t\t\t\tcase QuestionType.Rating:\r\n\r\n\t\t\t\t\trating = getRating(values);\r\n\t\t\t\t\tratingQuestion = getQuestionValue(values);\r\n\t\t\t\t\tratingsListLength = values.ratingsListLength;\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase QuestionType.Prompt:\r\n\r\n\t\t\t\t\tpromptQuestion = getQuestionValue(values);\r\n\t\t\t\t\tpromptResponse = getAnswerValue(values);\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase QuestionType.Verbatim: {\r\n\t\t\t\t\tconst commentResponse = getAnswerValue(values);\r\n\t\t\t\t\tconst commentTitle = getQuestionValue(values);\r\n\t\t\t\t\tconst cvSurveyHasPromptPage = !isNOU(promptResponse);\r\n\t\t\t\t\tlet setCommentTitleAndValue = false;\r\n\r\n\t\t\t\t\t// This is a workaround because the OCV schema presents issues in the comments values section\r\n\t\t\t\t\t// when we send an array of null in the extended manifest data.\r\n\t\t\t\t\t// We will update this logic once the OCV team delivers the fix.\r\n\t\t\t\t\tif (isFirstCommentValidated) {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t!cvSurveyHasPromptPage &&\r\n\t\t\t\t\t\t\tsubmitData.pageNumber !== \"1\" &&\r\n\t\t\t\t\t\t\tisNOU(firstCommentResponse) &&\r\n\t\t\t\t\t\t\t!isFirstEmptyCommentAdded\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tcommentTitlesCollection.push({ question: firstCommentTitle });\r\n\t\t\t\t\t\t\tcommentsCollection.push(\" \");\r\n\t\t\t\t\t\t\tisFirstEmptyCommentAdded = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsetCommentTitleAndValue = cvSurveyHasPromptPage || submitData.pageNumber !== \"1\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfirstCommentResponse = commentResponse;\r\n\t\t\t\t\t\tfirstCommentTitle = commentTitle;\r\n\t\t\t\t\t\tisFirstCommentValidated = true;\r\n\t\t\t\t\t\tsetCommentTitleAndValue = cvSurveyHasPromptPage || !isNOU(firstCommentResponse);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (setCommentTitleAndValue) {\r\n\t\t\t\t\t\tcommentTitlesCollection.push({ question: commentTitle });\r\n\t\t\t\t\t\tcommentsCollection.push(isNOU(commentResponse) ? \" \" : commentResponse);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase QuestionType.Email:\r\n\t\t\t\t\temail = getAnswerValue(values);\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase QuestionType.AdditionalQuestion:\r\n\r\n\t\t\t\t\tadditionalPromptQuestion = getQuestionValue(values);\r\n\t\t\t\t\tadditionalPromptResponse = getAnswerValue(values);\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase QuestionType.ContactMe:\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tinsightfulQuestionOptionsCollection.push(\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tquestion: (values?.questionType === QuestionType.ContactMe) ? QuestionType.ContactMe : getQuestionValue(values),\r\n\t\t\t\t\t\t\toptions: getInsightfulOptions(values),\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tinsightfulQuestionAnswersCollection.push(getInsightfulAnswers(values));\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t});\r\n\r\n\tconst formattedData: IFormattedData = {\r\n\t\trating,\r\n\t\tratingQuestion,\r\n\t\tratingsListLength,\r\n\t\temail,\r\n\t\tcommentsCollection,\r\n\t\tcommentTitlesCollection,\r\n\t\tpromptQuestion,\r\n\t\tpromptResponse,\r\n\t\tadditionalPromptQuestion,\r\n\t\tadditionalPromptResponse,\r\n\t\tinsightfulQuestionOptionsCollection,\r\n\t\tinsightfulQuestionAnswersCollection,\r\n\t};\r\n\r\n\treturn formattedData;\r\n}\r\n\r\nfunction updateExtendedManifestData(transporter: Transporter, formattedData: IFormattedData): string {\r\n\tlet commentValues: string[];\r\n\tlet commentTitles: { question: string }[] = [];\r\n\r\n\tif (formattedData.commentsCollection.length > 0) {\r\n\t\tcommentValues = formattedData.commentsCollection;\r\n\t\tcommentTitles = formattedData.commentTitlesCollection;\r\n\t}\r\n\r\n\t/* Titles */\r\n\tconst extendedManifestData = JSON.parse(transporter.getExtendedManifestData()) as any;\r\n\textendedManifestData.surveyStrings = JSON.stringify({\r\n\t\tprompt: { title: \"\", question: formattedData?.promptQuestion, yesButtonText: \"YES\", noButtonText: \"NO\" },\r\n\t\trating: [{ question: formattedData?.ratingQuestion, options: [] }],\r\n\t\tcomment: commentTitles,\r\n\t\tmultipleChoice: formattedData.insightfulQuestionOptionsCollection,\r\n\t});\r\n\t/* Values */\r\n\textendedManifestData.surveySpecificData = JSON.stringify({\r\n\t\trating: [{ numberOfOptions: formattedData.ratingsListLength, selectedRating: formattedData.rating }],\r\n\t\tcomment: commentValues,\r\n\t\tmultipleChoice: formattedData.insightfulQuestionAnswersCollection,\r\n\t});\r\n\ttransporter.setExtendedManifestData(JSON.stringify(extendedManifestData));\r\n\treturn extendedManifestData;\r\n}\r\n\r\nfunction updateAppData(): string {\r\n\tconst appData = Configuration.get().getCommonInitOptions().applicationGroup.appData;\r\n\tconst appDataValues: unknown[] = [];\r\n\r\n\t// To differentiate CV survey responses from other surveys given the flight object in OCV gets trimmed, this is a workaround for now.\r\n\tconst cvSurveyInfo: ISurveyPayloadAdditionalInfo = {\r\n\t\tadditionalInfo: {\r\n\t\t\tSurveyDescription: customerVoiceSurveyUX,\r\n\t\t\tFlight: Configuration.get().getCVSurveyFlights(),\r\n\t\t\tIsCopilotLicenseEnabled: Configuration.get().isCopilotLicenseEnabled().toString()\r\n\t\t},\r\n\t};\r\n\r\n\tif (isNOU(appData)) {\r\n\t\tappDataValues.push({});\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tappDataValues.push(JSON.parse(appData));\r\n\t\t} catch (ex) {\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.APPDATA_JSON_PARSE_ERROR);\r\n\t\t\tappDataValues.push({});\r\n\t\t}\r\n\t}\r\n\r\n\tappDataValues.push(cvSurveyInfo);\r\n\treturn JSON.stringify(appDataValues);\r\n}\r\n\r\nfunction setTransporterValues(transporter: Transporter, formattedData: IFormattedData): Transporter {\r\n\ttransporter.setManifestValues(Configuration.get().getFloodgateSurvey().getJsonElements());\r\n\tupdateExtendedManifestData(transporter, formattedData);\r\n\r\n\tif (formattedData.email) {\r\n\t\ttransporter.setEmail(formattedData.email);\r\n\t}\r\n\tconst appData = updateAppData();\r\n\ttransporter.setAppData(appData);\r\n\r\n\tconst preGeneratedId = Configuration.get().getFloodgateSurvey().getPreGeneratedClientFeedbackId();\r\n\tif (preGeneratedId) {\r\n\t\ttransporter.setClientFeedbackId(preGeneratedId);\r\n\t}\r\n\r\n\treturn transporter;\r\n}\r\n\r\n/**\r\n * Call-back function when user sends feedback from Customer Voice survey experience.\r\n * \r\n * IMPORTANT: This callback should contain no references to any survey UI\r\n * nor DOM elements. This restriction supports multi-window environments\r\n * where rendering is happening in a different context than these callbacks.\r\n *\r\n * View the design document explaining multi-window support changes here:\r\n * https://microsoft-my.sharepoint.com/:w:/p/joshdunning/EWghU_fNcrpAseOemGqOO2QBBNaRz_wZDyEL0ZewuXwKtw?e=gi7P1a\r\n */\r\nfunction onCVSubmit(data: ISurveyEventData): void {\r\n\ttry {\r\n\r\n\t\tconst formattedData = formatSubmitData(data);\r\n\t\tconst { rating, promptResponse, additionalPromptResponse } = formattedData;\r\n\r\n\t\tconst isPromptAnswerLogMandatory: boolean = validateLogPromptAnswer(promptResponse, additionalPromptResponse);\r\n\t\t// onCVSubmit is called twice when the user clicks NotNow an ICM was created for the CV team to avoid this behavior\r\n\t\tif (isPromptAnswerLogMandatory) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// clientfeedback id to overwrite\r\n\t\tconst transporter: Transporter = new Transporter(\r\n\t\t\tConfiguration.get().getCommonInitOptions().environment,\r\n\t\t\tApi.SurveyType[Configuration.get().getFloodgateSurvey().getSurveyType()],\r\n\t\t\tConfiguration.get().getCommonInitOptions().appId,\r\n\t\t\t\"Survey\",\r\n\t\t\tConfiguration.get().getCommonInitOptions().applicationGroup,\r\n\t\t\tConfiguration.get().getCommonInitOptions().telemetryGroup,\r\n\t\t\tConfiguration.get().getCommonInitOptions().webGroup,\r\n\t\t);\r\n\r\n\t\tconst comment = isNOU(firstCommentResponse) ? null : firstCommentResponse;\r\n\t\tConfiguration.get().getFloodgateSurvey().setValues(Number(rating), comment ? comment : null);\r\n\t\tsetTransporterValues(transporter, formattedData);\r\n\t\ttransporter.submit();\r\n\r\n\t\tif (\r\n\t\t\tdata.eventType === EventType.FormPartialResponseSubmitted ||\r\n\t\t\tdata.eventType === EventType.FormResponseSubmitted\r\n\t\t) {\r\n\t\t\t// Toggle OnDismissFlag when data is submitted to OCV\r\n\t\t\tonDismissFlag = true;\r\n\t\t\tif (hasSubmittedData) {\r\n\t\t\t\tLogging.EventIds.SURVEY_UI_FORM_SECONDARY_SUBMIT.name =\r\n\t\t\t\t\tSurveyUIFormSecondarySubmitName + data.pageNumber;\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SECONDARY_SUBMIT);\r\n\t\t\t} else {\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SUBMIT);\r\n\t\t\t\thasSubmittedData = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} catch (ex) {\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SUBMIT_ERROR);\r\n\t}\r\n}\r\n\r\nfunction validateLogPromptAnswer(promptResponse: string, additionalPromptResponse: string): boolean {\r\n\tlet isPromptAnswerLogNeeded = false;\r\n\tlet isPromptAnswerNo = false;\r\n\tif (!isNOU(promptResponse)) {\r\n\t\tisPromptAnswerLogNeeded = LogPromptAnswer(promptResponse, QuestionType.Prompt, isPromptResponseLogValidated);\r\n\t\tisPromptAnswerNo = promptResponse === PromptConstants.No;\r\n\t}\r\n\r\n\tif (!isNOU(additionalPromptResponse)) {\r\n\t\tisPromptAnswerLogNeeded = LogPromptAnswer(additionalPromptResponse,\r\n\t\t\tQuestionType.AdditionalQuestion, isAdditionalPromptResponseLogValidated);\r\n\t\tisPromptAnswerNo = additionalPromptResponse === PromptConstants.No;\r\n\t}\r\n\r\n\treturn isPromptAnswerLogNeeded || isPromptAnswerNo;\r\n}\r\n\r\nfunction LogPromptAnswer(promptResponse: string, questionType: string, isPromptAnswerLogged: boolean): boolean {\r\n\r\n\tif (!isPromptAnswerLogged) {\r\n\r\n\t\tlet promptMessageClicked;\r\n\t\tlet promptMessageClosed;\r\n\t\tif (questionType === QuestionType.Prompt) {\r\n\t\t\tisPromptResponseLogValidated = true;\r\n\t\t\tpromptMessageClicked = Logging.EventIds.SURVEY_UI_PROMPT_CLICKED;\r\n\t\t\tpromptMessageClosed = Logging.EventIds.SURVEY_UI_PROMPT_USERCLOSED;\r\n\t\t\tif ((promptResponse === PromptConstants.Yes)) {\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SHOWN);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tisAdditionalPromptResponseLogValidated = true;\r\n\t\t\tpromptMessageClicked = Logging.EventIds.SURVEY_UI_ADDITIONALPROMPT_CLICKED;\r\n\t\t\tpromptMessageClosed = Logging.EventIds.SURVEY_UI_ADDITIONALPROMPT_USERCLOSED;\r\n\t\t}\r\n\r\n\t\tlogTelemetryEvent(promptResponse === PromptConstants.No ? promptMessageClosed : promptMessageClicked);\r\n\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * Call-back function when user cancels feedback from Customer Voice survey experience.\r\n * \r\n * IMPORTANT: This callback should contain no references to any survey UI\r\n * nor DOM elements. This restriction supports multi-window environments\r\n * where rendering is happening in a different context than these callbacks.\r\n *\r\n * View the design document explaining multi-window support changes here:\r\n * https://microsoft-my.sharepoint.com/:w:/p/joshdunning/EWghU_fNcrpAseOemGqOO2QBBNaRz_wZDyEL0ZewuXwKtw?e=gi7P1a\r\n */\r\nfunction onCVCancel(data: ISurveyEventData): void {\r\n\tswitch (data.eventType) {\r\n\t\tcase EventType.FormClosed:\r\n\t\t\tif (isNOU(data.pageNumber)) {\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_USERCLOSED);\r\n\t\t\t} else {\r\n\t\t\t\tLogging.EventIds.SURVEY_UI_FORM_USERCLOSED.name = SurveyUIFormUserClosedName + data.pageNumber.charAt(data.pageNumber.length - 1);\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_USERCLOSED);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase EventType.ThankYouPageClosed:\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_THANKYOUPAGE_USERCLOSED);\r\n\t\t\tbreak;\r\n\t\tcase EventType.PromptClosed:\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_USERCLOSED);\r\n\t\t\tbreak;\r\n\t\tcase EventType.AdditionalPromptClosed:\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_ADDITIONALPROMPT_USERCLOSED);\r\n\t\t\tbreak;\r\n\t\tcase EventType.FormAutoDismissed:\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_AUTODISMISSED);\r\n\t\t\tbreak;\r\n\t\tcase EventType.ThankYouPageAutoDismissed:\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_THANKYOUPAGE_AUTODISMISSED);\r\n\t\t\tbreak;\r\n\t\tcase EventType.FormResponseCanceled:\r\n\t\t\tif (isNOU(data.pageNumber)) {\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_USERCLOSED);\r\n\t\t\t} else {\r\n\t\t\t\tLogging.EventIds.SURVEY_UI_FORM_USERCLOSED.name = SurveyUIFormUserClosedName + data.pageNumber?.charAt(data.pageNumber.length - 1);\r\n\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_USERCLOSED);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_NO_RETURN_TYPE);\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tonDismiss(onDismissFlag);\r\n}\r\n\r\n/**\r\n * Call-back function when user Customer Voice survey is loaded and ready for showing to the user.\r\n * Here we are going to hide the survey if the current survey is the dispatcher survey.\r\n * First if the dispacther survey is called, the hasSurveyDispatcher parameter will be true.\r\n * And second, dispatcher survey will be the first survey in the survey dispatcher logic. So, we using \r\n * hasLoadedDispatcher to make sure we will only hide the first survey in the whole survey dispatcher logic\r\n * which is the dispatcher survey.\r\n * \r\n * IMPORTANT: This callback should contain no references to any survey UI\r\n * nor DOM elements. This restriction supports multi-window environments\r\n * where rendering is happening in a different context than these callbacks.\r\n *\r\n * View the design document explaining multi-window support changes here:\r\n * https://microsoft-my.sharepoint.com/:w:/p/joshdunning/EWghU_fNcrpAseOemGqOO2QBBNaRz_wZDyEL0ZewuXwKtw?e=gi7P1a\r\n */\r\nfunction onCVLoaded(data: ISurveyEventData): void {\r\n\tdata.eventId = Logging.EventIds.SURVEY_UI_FORM_SHOWN;\r\n\r\n\tif (data.hasSurveyDispatcher) {\r\n\t\tdata.eventId = Logging.EventIds.SURVEY_UI_FORM_DISPATCHER_IMPLEMENTED;\r\n\t} else if (data.hasSurveyPromptShown) {\r\n\t\tdata.eventId = Logging.EventIds.SURVEY_UI_PROMPT_SHOWN;\r\n\t}\r\n\r\n\tlogGatecrashEvent(data);\r\n}\r\n\r\n/**\r\n * Call-back logging function for gatecrash errors and gatecrash events.\r\n * \r\n * IMPORTANT: This callback should contain no references to any survey UI\r\n * nor DOM elements. This restriction supports multi-window environments\r\n * where rendering is happening in a different context than these callbacks.\r\n *\r\n * View the design document explaining multi-window support changes here:\r\n * https://microsoft-my.sharepoint.com/:w:/p/joshdunning/EWghU_fNcrpAseOemGqOO2QBBNaRz_wZDyEL0ZewuXwKtw?e=gi7P1a\r\n */\r\nfunction logGatecrashEvent(data: ISurveyEventData): void {\r\n\tconst configuration = Configuration.get();\r\n\tconst logCustomProps: Logging.ICustomProperties = {\r\n\t\tTimeMilliseconds: data.TimeMilliseconds,\r\n\t\tCampaignId: configuration.getFloodgateSurvey().getCampaignId(),\r\n\t\tSurveyId: configuration.getFloodgateSurvey().getId(),\r\n\t\tSurveyType: configuration.getFloodgateSurvey().getSurveyType(),\r\n\t\tErrorMessage: data.customProperties?.ErrorMessage ? data.customProperties?.ErrorMessage : null,\r\n\t\tMessage: data.customProperties?.Message ? data.customProperties?.Message : null,\r\n\t};\r\n\r\n\tlogTelemetryEvent(data.eventId, logCustomProps);\r\n}\r\n\r\n// Log Telemetry for Customer Voice survey funnel.\r\nfunction logTelemetryEvent(eventId: Logging.IEventId, customProperties?: Logging.ICustomProperties): void {\r\n\tconst configuration = Configuration.get();\r\n\tlet logCustomProps: Logging.ICustomProperties;\r\n\tif (!customProperties) {\r\n\t\tlogCustomProps = {\r\n\t\t\tCampaignId: configuration.getFloodgateSurvey().getCampaignId(),\r\n\t\t\tSurveyId: configuration.getFloodgateSurvey().getId(),\r\n\t\t\tSurveyType: configuration.getFloodgateSurvey().getSurveyType(),\r\n\t\t\tClientFeedbackId: Configuration.get().getFloodgateSurvey().getPreGeneratedClientFeedbackId(),\r\n\t\t\tCVFormId: configuration.getFloodgateSurvey().getCVSurveyFormId(),\r\n\t\t};\r\n\t} else {\r\n\t\tlogCustomProps = customProperties;\r\n\t}\r\n\r\n\tLogging.getLogger().logEvent(\r\n\t\teventId,\r\n\t\tLogging.LogLevel.Critical,\r\n\t\tlogCustomProps\r\n\t);\r\n}\r\n\r\n/**\r\n * Take a dictionary of CSS variables or HTML data attributes and pass them to the CV iframe for injection.\r\n * This allows dynamic CSS changes within CV survey at runtime.\r\n * \r\n * NOTE: All \"runtime\" CSS variable keys must be prefixed with \"--rt\", and HTML data attributes must be prefixed\r\n * with \"data-rt\", otherwise CV will reject them.\r\n *\r\n * Example - CSS Variables\r\n * -----------------------\r\n *    Input dict:\r\n *        { \"--rt-background-color\": \"black\" }\r\n *\r\n *    Result (in CV CSS file):\r\n *        :root {\r\n *          --rt-background-color: black;\r\n *        }\r\n *\r\n *    Usage (in CV CSS file):\r\n *        .some-css-selector {\r\n *          background-color: var(--rt-background-color);\r\n *        }\r\n * \r\n * Example - HTML Data Attributes\r\n * ------------------------------\r\n *    Input dict:\r\n *        { \"data-rt-theme-color\": \"dark\" }\r\n *\r\n *    Result (in CV HTML):\r\n *        <html data-rt-theme-color=\"dark\"> ... </html>\r\n *\r\n *    Usage (in CV CSS file):\r\n *        [data-rt-theme-color=\"dark\"].some-css-selector {\r\n *          background-color: black;\r\n *          color: white;\r\n *          border; 2px solid white;\r\n *        }\r\n *\r\n * @param {{ [key: string]: string }} cssVars       - Dictionary of HTML data attributes (key: val) to be injected\r\n *                                                    Leave empty ({}) if only injecting HTML data attributes\r\n * @param {{ [key: string]: string }} htmlDataAttrs - Dictionary of HTML data attributes (key: val) to be injected\r\n *                                                    Leave empty ({}) if only injecting CSS vars\r\n */\r\nexport function updateSurveyStyling(cssVars: { [key: string]: string }, htmlDataAttrs: { [key: string]: string }): void {\r\n\tconst renderContext: ISurveyRenderContext | null = Configuration.get().getCVRenderContext();\r\n\tif (renderContext) {\r\n\t\trenderContext.updateStyling(cssVars, htmlDataAttrs);\r\n\t} else {\r\n\t\tconst logCustomProps: Logging.ICustomProperties = {\r\n\t\t\tCampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\tSurveyId: Configuration.get().getFloodgateSurvey().getId(),\r\n\t\t\tSurveyType: Configuration.get().getFloodgateSurvey().getSurveyType(),\r\n\t\t};\r\n\r\n\t\tinternal.logTelemetryEvent(Logging.EventIds.SURVEY_RENDER_CONTEXT_ERROR, logCustomProps);\r\n\t}\r\n}\r\n\r\nconst internal = {\r\n\tlogTelemetryEvent,\r\n};\r\n\r\nexport const { internal: unitTestExports } = { internal };\r\n", "/**\r\n * Events.ts\r\n *\r\n * A module for all Event handling.\r\n */\r\n\r\nimport { Api, EndUserActions, SupportedOverrides } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as PersonalizerClient from \"../../Personalizer/PersonalizerClient\";\r\nimport * as Utils from \"../../Utils\";\r\nimport { sanitizeOutputString } from \"../../Window/TrustedTypesPolicyUtils\";\r\nimport * as Configuration from \"./../../Configuration/Configuration\";\r\nimport { AutoDismissValues, SDK_UXID_VERSION } from \"./../../Constants\";\r\nimport { IOnDismissDelegate } from \"./../../IOnDismissDelegate\";\r\nimport * as Logging from \"./../../Logging/Logging\";\r\nimport { Transporter } from \"./../../Transport/Transport\";\r\nimport { Spinner } from \"./../SpinnerControl\";\r\nimport { Classes, IDs, Keys } from \"./../UiConstants\";\r\nimport * as UiUtils from \"./../Utils\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\n/**\r\n * Callback for when the feedback dialog is dismissed\r\n */\r\nlet onDismiss: IOnDismissDelegate;\r\n\r\n/**\r\n * Is the prompt up\r\n */\r\nlet isPromptUp: boolean;\r\n\r\n/**\r\n * timer function to auto dismiss\r\n */\r\nlet timerAutoDismiss: number;\r\n\r\n/**\r\n * The AutoDismissValue that was set for the prompt.\r\n */\r\nlet autoDismissValue: AutoDismissValues;\r\n\r\n/**\r\n * Dismiss all, including networking, UI, and events\r\n * @param submitted Was the control submitted (true), or cancelled (false)?\r\n */\r\nfunction dismissAll(submitted: boolean): void {\r\n\tunregister();\r\n\tonDismiss(submitted);\r\n}\r\n\r\n/**\r\n * Listener un-registration\r\n */\r\nfunction unregister(): void {\r\n\tremoveListeners();\r\n}\r\n\r\n/**\r\n * List of listeners and the ids they are attached to. This ensures all events are correctly unregistered.\r\n */\r\nlet listenersList: { id: string, event: string, listener: (event: Event) => void }[] = [];\r\n\r\nfunction addListener(id: string, event: string, listener: (event: Event) => void): void {\r\n\tUiUtils.registerListener(id, event, listener);\r\n\tlistenersList.push({ event: event, id: id, listener: listener });\r\n}\r\n\r\nfunction removeListeners(): void {\r\n\tfor (const listener of listenersList) {\r\n\t\tUiUtils.unregisterListener(listener.id, listener.event, listener.listener);\r\n\t}\r\n\tlistenersList = [];\r\n}\r\n\r\nfunction logTelemetryEvent(eventId: Logging.IEventId, clientFeedbackId?: string, isEmailPolicyEnabled?: boolean,\r\n\t\taction?: EndUserActions, PersonalizerEventId?: string, actualSetAutoDismissValue?: AutoDismissValues): void {\r\n\r\n\tconst configuration = Configuration.get();\r\n\tLogging.getLogger().logEvent(\r\n\t\teventId,\r\n\t\tLogging.LogLevel.Critical,\r\n\t\t{\r\n\t\t\tCampaignId: configuration.getFloodgateSurvey().getCampaignId(),\r\n\t\t\tSurveyId: configuration.getFloodgateSurvey().getId(),\r\n\t\t\tSurveyType: configuration.getFloodgateSurvey().getSurveyType(),\r\n\t\t\tPromptAutoDismiss: configuration.getFloodgateInitOptions().autoDismiss.toString(),\r\n\t\t\tClientFeedbackId: clientFeedbackId,\r\n\t\t\tIsEmailPolicyEnabled: isEmailPolicyEnabled,\r\n\t\t\tPersonalizerUserAction: action,\r\n\t\t\tPersonalizerEventId: PersonalizerEventId,\r\n\t\t\tActualSetAutoDismissValue: actualSetAutoDismissValue,\r\n\t\t}\r\n\t);\r\n}\r\n\r\n/**\r\n * Register events for toast\r\n */\r\nexport function register(ON_DISMISS: IOnDismissDelegate = function (submitted: boolean) { return; }) {\r\n\tonDismiss = ON_DISMISS;\r\n\tisPromptUp = true;\r\n\r\n\taddListener(IDs.ToastContainer, \"keyup\", toastKeyEventHandler);\r\n\taddListener(IDs.ToastCancel, \"click\", toastCancelHandler);\r\n\taddListener(IDs.TFormCancelButton, \"click\", toastCancelHandler);\r\n\taddListener(IDs.TPromptContainer, \"click\", promptContainerHandler);\r\n\taddListener(IDs.TFormSubmitButton, \"click\", submitButtonHandler);\r\n\taddListener(IDs.TFormEmailCheckBox, \"click\", emailCheckBoxHandler);\r\n\temailCheckBoxHandler(null); // call the checkbox handler to process the initial state\r\n\r\n\tconst ratingElements = document.querySelectorAll(\"input[name=\\\"\" + IDs.TFormRating + \"\\\"]\");\r\n\tfor (let i = 0; i < ratingElements.length; ++i) {\r\n\t\tUiUtils.registerListenerToElement(ratingElements[i] as HTMLElement, \"click\", ratingInputHandler);\r\n\t}\r\n\r\n\tconst isIntercept = Configuration.get().getFloodgateSurvey().getSurveyType() === Api.SurveyType.Intercept;\r\n\r\n\tlet autoDismiss = Configuration.get().getFloodgateInitOptions().autoDismiss;\r\n\tconst isPersonalizerEnabled = isPersonalizerEnabledHelper();\r\n\r\n\t// switch true pattern for clarity\r\n\tswitch (true) {\r\n\t\tcase isIntercept:\r\n\t\t\tautoDismiss = AutoDismissValues.NoAutoDismiss;\r\n\t\t\tbreak;\r\n\r\n\t\tcase isPersonalizerEnabled: {\r\n\t\t\t// Get override value and set it if it exists.\r\n\t\t\tconst overrideValue = PersonalizerClient.get().getOverrideValueForSurveyId(SupportedOverrides.AutoDismissTime,\r\n\t\t\t\tConfiguration.get().getFloodgateSurvey().getId());\r\n\r\n\t\t\tif (!isNOU(overrideValue)) {\r\n\t\t\t\tautoDismiss = overrideValue;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tdefault:\r\n\t\t\t// Get the autoDismiss specified in the init options.\r\n\t\t\tautoDismiss = Configuration.get().getFloodgateInitOptions().autoDismiss;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\t// Set module variable for autoDismiss\r\n\tautoDismissValue = autoDismiss;\r\n\r\n\tif (!Configuration.get().getFloodgateSurvey().showPrompt && !isIntercept) {\r\n\t\tshowSurveyScreen();\r\n\t} else {\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_SHOWN, undefined /* clientFeedbackId */, undefined /* isEmailPolicyEnabled */,\r\n\t\t\tundefined /* action */, PersonalizerClient.get().getEventIdForSurveyId(Configuration.get().getFloodgateSurvey().getId()),\r\n\t\t\tautoDismiss);\r\n\t}\r\n\r\n\tif (autoDismiss !== AutoDismissValues.NoAutoDismiss) {\r\n\t\tconst autoDismissDuration = Utils.convertAutoDismissToTimeInMs(autoDismiss);\r\n\r\n\t\tif (autoDismissDuration !== 0) {\r\n\t\t\ttimerAutoDismiss = window.setTimeout(\r\n\t\t\t\tfunction () {\r\n\t\t\t\t\tif (isPromptUp) {\r\n\t\t\t\t\t\tdismissAll(false);\r\n\t\t\t\t\t\tif (isPersonalizerEnabled) {\r\n\t\t\t\t\t\t\t// If personalizer is enabled, call to notify that the prompt has autodismissed (which means it has been ignored).\r\n\t\t\t\t\t\t\tPersonalizerClient.get().logUserActionForSurveyAsync(EndUserActions.Ignore,\r\n\t\t\t\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getId(),\r\n\t\t\t\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getCampaignId());\r\n\r\n\t\t\t\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_AUTODISMISSED, undefined /* clientFeedbackId */,\r\n\t\t\t\t\t\t\t\tundefined /* isEmailPolicyEnabled */,\r\n\t\t\t\t\t\t\t\tEndUserActions.Ignore,\r\n\t\t\t\t\t\t\t\tPersonalizerClient.get().getEventIdForSurveyId(Configuration.get().getFloodgateSurvey().getId()),\r\n\t\t\t\t\t\t\t\tautoDismiss);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_AUTODISMISSED, undefined /* clientFeedbackId */,\r\n\t\t\t\t\t\t\t\tundefined /* isEmailPolicyEnabled */, undefined /* action */, undefined /* PersonalizerEventId */, autoDismissValue);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tautoDismissDuration\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction emailCheckBoxHandler(event: Event): void {\r\n\t// show email if checked and show default string if unchecked\r\n\tconst emailCheckBox: HTMLInputElement = <HTMLInputElement> document.getElementById(IDs.TFormEmailCheckBox);\r\n\tif (emailCheckBox) {\r\n\t\tconst emailTextBox: HTMLInputElement = <HTMLInputElement> document.getElementById(IDs.TFormEmailTextBox);\r\n\t\temailTextBox.value = emailCheckBox.checked ? Configuration.get().getCommonInitOptions().userEmail : null;\r\n\t\temailTextBox.disabled = !emailCheckBox.checked;\r\n\t}\r\n}\r\n\r\nfunction toastKeyEventHandler(event: Event): void {\r\n\t// dismiss upon pressing the escape key\r\n\tif ((<KeyboardEvent> event).keyCode === Keys.Esc) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t\tdismissAll(false);\r\n\t\tonCancelLoggingRoutine();\r\n\t\tclearAutoDismiss();\r\n\t}\r\n}\r\n\r\nfunction toastCancelHandler(event: Event): void {\r\n\tevent.preventDefault();\r\n\tevent.stopPropagation();\r\n\tdismissAll(false);\r\n\tonCancelLoggingRoutine();\r\n\tclearAutoDismiss();\r\n}\r\n\r\nfunction onCancelLoggingRoutine(): void {\r\n\tif (isPromptUp && isPersonalizerEnabledHelper()) {\r\n\t\tPersonalizerClient.get().logUserActionForSurveyAsync(EndUserActions.Cancel, Configuration.get().getFloodgateSurvey().getId(),\r\n\t\tConfiguration.get().getFloodgateSurvey().getCampaignId());\r\n\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_USERCLOSED, undefined /* clientFeedbackId */, undefined /* isEmailPolicyEnabled */,\r\n\t\t\tEndUserActions.Cancel, PersonalizerClient.get().getEventIdForSurveyId(Configuration.get().getFloodgateSurvey().getId()),\r\n\t\t\tautoDismissValue);\r\n\r\n\t\treturn;\r\n\t}\r\n\r\n\tlogTelemetryEvent(isPromptUp ? Logging.EventIds.SURVEY_UI_PROMPT_USERCLOSED : Logging.EventIds.SURVEY_UI_FORM_USERCLOSED,\r\n\t\tundefined /* clientFeedbackId */, undefined /* isEmailPolicyEnabled */,\r\n\t\tundefined /* action */, undefined /* PersonalizerEventId */, autoDismissValue);\r\n}\r\n\r\nfunction clearAutoDismiss(): void {\r\n\tif (timerAutoDismiss) {\r\n\t\tclearTimeout(timerAutoDismiss);\r\n\t\ttimerAutoDismiss = 0;\r\n\t}\r\n}\r\n\r\nfunction promptContainerHandler(event: Event): void {\r\n\tevent.preventDefault();\r\n\tevent.stopPropagation();\r\n\r\n\tif (Configuration.get().getFloodgateSurvey().getSurveyType() === Api.SurveyType.Intercept) {\r\n\t\tinterceptHandler();\r\n\t} else {\r\n\t\tshowSurveyScreen();\r\n\t}\r\n}\r\n\r\nfunction interceptHandler(): void {\r\n\tconst success = openInNewTab(Configuration.get().getFloodgateSurvey().getInterceptUrl());\r\n\tdismissAll(false);\r\n\r\n\t// Logging according to if opening the tab is successful. \r\n\tif (success) {\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_PROMPT_CLICKED);\r\n\t} else {\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_REDIRECTIONFAILURE);\r\n\t}\r\n}\r\n\r\nfunction openInNewTab(url: string): boolean {\r\n\tconst win = window.open(url, \"_blank\");\r\n\tif (isNOU(win)) {\r\n\t\treturn false;\r\n\t}\r\n\twin.focus();\r\n\treturn true;\r\n}\r\n\r\nfunction showSurveyScreen(): void {\r\n\tisPromptUp = false;\r\n\r\n\tUiUtils.setElementVisibility(IDs.TPromptContainer, false);\r\n\tUiUtils.setElementVisibility(IDs.TFormContainer, true);\r\n\r\n\t// Adding ToastZoom class to toastContainer. This handles zoom and small screen accesibility.\r\n\t// It is added here so that it doesn't apply to the prompt.\r\n\tUiUtils.addClassById(IDs.ToastContainer, Classes.ToastZoom);\r\n\r\n\t// Do the following:\r\n\t// 1. remove toast container's alert attribute when after the user click toast and form is shown, so screen readers\r\n\t// like JAWS doesn't repeat all components on the form.\r\n\t// \r\n\t// 2. Add the dialog role to the toast container and set aria-labelledby to the form title.\r\n\t// This makes the screen reader announce that the form is a dialog and the title of the form.\r\n\tif ((\" \" + document.getElementById(IDs.TFormContainer).className + \" \").indexOf(\" \" + Classes.Visible + \" \") > -1) {\r\n\t\tdocument.getElementById(IDs.ToastContainer).setAttribute(\"role\", \"dialog\"); // sets role to dialog, this effectively removes the previous 'alert' role.\r\n\t\tdocument.getElementById(IDs.ToastContainer).setAttribute(\"aria-labelledby\", IDs.TFormTitle);\r\n\t}\r\n\r\n\t// Focus should always be set to first rating item since all supported surveys showing form have rating items so far.\r\n\tconst formRating = document.getElementsByName(IDs.TFormRating);\r\n\tif (formRating && formRating.length > 0) {\r\n\t\tformRating[0].focus();\r\n\t}\r\n\r\n\tif (isPersonalizerEnabledHelper()) {\r\n\t\t// If personalizer is enabled, call to notify that the prompt has been clicked (which means user has accepted).\r\n\t\tPersonalizerClient.get().logUserActionForSurveyAsync(EndUserActions.Accept, Configuration.get().getFloodgateSurvey().getId(),\r\n\t\t\tConfiguration.get().getFloodgateSurvey().getCampaignId());\r\n\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SHOWN, undefined /* clientFeedbackId */, undefined /* isEmailPolicyEnabled */,\r\n\t\t\tEndUserActions.Accept, PersonalizerClient.get().getEventIdForSurveyId(Configuration.get().getFloodgateSurvey().getId()),\r\n\t\t\tautoDismissValue);\r\n\t} else {\r\n\t\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SHOWN, undefined /* clientFeedbackId */, undefined /* isEmailPolicyEnabled */,\r\n\t\t\tundefined /* action */, undefined /* PersonalizerEventId */, autoDismissValue);\r\n\t}\r\n}\r\n\r\nfunction ratingInputHandler(event: Event): void {\r\n\t(document.getElementById(IDs.TFormSubmitButton) as HTMLButtonElement).disabled = false;\r\n}\r\n\r\nfunction submitButtonHandler(event: Event): void {\r\n\tevent.preventDefault();\r\n\tevent.stopPropagation();\r\n\r\n\tUiUtils.setElementVisibility(IDs.TFormSubmitButton, false);\r\n\tconst spinner = new Spinner(IDs.TFormSubmitButtonSpinner);\r\n\r\n\tconst transporter: Transporter = new Transporter(\r\n\t\tConfiguration.get().getCommonInitOptions().environment,\r\n\t\tApi.SurveyType[Configuration.get().getFloodgateSurvey().getSurveyType()],\r\n\t\tConfiguration.get().getCommonInitOptions().appId,\r\n\t\t\"Survey\",\r\n\t\tConfiguration.get().getCommonInitOptions().applicationGroup,\r\n\t\tConfiguration.get().getCommonInitOptions().telemetryGroup,\r\n\t\tConfiguration.get().getCommonInitOptions().webGroup\r\n\t);\r\n\r\n\tconst commentElement: HTMLTextAreaElement = <HTMLTextAreaElement> document.getElementById(IDs.TFormComment);\r\n\tconst commentEntered: boolean = (commentElement && !!commentElement.value);\r\n\r\n\tconst selectedRating: HTMLInputElement =\r\n\t\tdocument.querySelector(\"input[name=\\\"\" + IDs.TFormRating + \"\\\"]:checked\") as HTMLInputElement;\r\n\r\n\tConfiguration.get().getFloodgateSurvey().setValues(\r\n\t\tNumber(selectedRating.value),\r\n\t\tcommentEntered ? sanitizeOutputString(commentElement.value) : \"\"\r\n\t);\r\n\r\n\t// Add survey-specific data to manifest\r\n\ttransporter.setManifestValues(Configuration.get().getFloodgateSurvey().getJsonElements());\r\n\r\n\t// Send email address if user gives consent\r\n\tconst emailCheckBox: HTMLInputElement = <HTMLInputElement> document.getElementById(IDs.TFormEmailCheckBox);\r\n\tconst emailTextBox: HTMLInputElement = <HTMLInputElement> document.getElementById(IDs.TFormEmailTextBox);\r\n\r\n\tif (emailCheckBox && emailCheckBox.checked && emailTextBox.value !== \"\") {\r\n\t\ttransporter.setEmail(sanitizeOutputString(emailTextBox.value));\r\n\t}\r\n\r\n\t// Append UxId string to the sdkVersion property in the manifest.\r\n\t// This is disabled when using EUDB non-compliant UX to ensure that UX version can be tracked properly\r\n\tif (Configuration.get().getFloodgateInitOptions().isEudbUxEnabled) {\r\n\t\ttransporter.appendUxId(SDK_UXID_VERSION);\r\n\t}\r\n\r\n\ttransporter.submit();\r\n\tspinner.destroy();\r\n\tdismissAll(true);\r\n\tlogTelemetryEvent(Logging.EventIds.SURVEY_UI_FORM_SUBMIT, transporter.getClientFeedbackId(),\r\n\t\tConfiguration.get().getFloodgateInitOptions().showEmailAddress);\r\n}\r\n\r\nfunction isPersonalizerEnabledHelper(): boolean {\r\n\treturn PersonalizerClient.get().isEnabled(Configuration.get().getFloodgateSurvey().getSurveyType(),\r\n\t\tConfiguration.get().getFloodgateSurvey().getLauncherType(),\r\n\t\tConfiguration.get().getFloodgateSurvey().getGoverenedChannelType());\r\n}\r\n", "/**\r\n * Spinner.ts\r\n *\r\n * A module for a spinner.\r\n */\r\n\r\nimport { Classes } from \"./UiConstants\";\r\nimport * as Utils from \"./Utils\";\r\n\r\ninterface ICircleObject {\r\n\telement: HTMLDivElement;\r\n\tj: number;\r\n}\r\n\r\nconst animationSpeed = 90;\r\nconst numCircles = 8;\r\nconst offsetSize = 0.2;\r\nconst parentSize = 34;\r\nconst fadeIncrement = 1 / numCircles;\r\n\r\nexport class Spinner {\r\n\tprivate circleObjects: ICircleObject[] = [];\r\n\tprivate interval: ReturnType<typeof setInterval>;\r\n\tprivate spinnerId: string;\r\n\tprivate spinner: HTMLElement;\r\n\r\n\t/**\r\n\t * Constructor\r\n\t * @param id id of the element to attach the spinner to\r\n\t */\r\n\tconstructor(id: string) {\r\n\t\tthis.spinnerId = id;\r\n\t\tthis.spinner = document.getElementById(this.spinnerId);\r\n\t\tthis.createCirclesAndArrange();\r\n\t\tthis.initializeOpacities();\r\n\t\tthis.start();\r\n\t\tUtils.setElementVisibility(id, true);\r\n\t}\r\n\r\n\t/**\r\n\t * Destroys the spinner\r\n\t */\r\n\tpublic destroy() {\r\n\t\tUtils.setElementVisibility(this.spinnerId, false);\r\n\t\tthis.stop();\r\n\t}\r\n\r\n\t/**\r\n\t * Starts the animation\r\n\t */\r\n\tprivate start() {\r\n\t\tthis.stop();\r\n\t\tthis.interval = setInterval(() => {\r\n\t\t\tlet i = this.circleObjects.length;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tfade(this.circleObjects[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\tanimationSpeed);\r\n\t}\r\n\r\n\t/**\r\n\t * Stops the animation\r\n\t */\r\n\tprivate stop() {\r\n\t\tclearInterval(this.interval);\r\n\t}\r\n\r\n\tprivate createCirclesAndArrange() {\r\n\t\tlet angle = 0;\r\n\t\tconst offset = parentSize * offsetSize;\r\n\t\tconst step = (2 * Math.PI) / numCircles;\r\n\t\tlet i = numCircles;\r\n\t\tlet circleObject: ICircleObject;\r\n\t\tconst radius = (parentSize - offset) * 0.5;\r\n\r\n\t\twhile (i--) {\r\n\t\t\tconst circle: HTMLDivElement = createCircle();\r\n\t\t\tconst x = Math.round(parentSize * 0.5 + radius * Math.cos(angle) - circle.clientWidth * 0.5) - offset * 0.5;\r\n\t\t\tconst y = Math.round(parentSize * 0.5 + radius * Math.sin(angle) - circle.clientHeight * 0.5) - offset * 0.5;\r\n\t\t\tthis.spinner.appendChild(circle);\r\n\t\t\tcircle.style.left = x + \"px\";\r\n\t\t\tcircle.style.top = y + \"px\";\r\n\t\t\tangle += step;\r\n\t\t\tcircleObject = { element: circle, j: i };\r\n\t\t\tthis.circleObjects.push(circleObject);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initializeOpacities() {\r\n\t\tlet i = 0;\r\n\t\tlet j = 1;\r\n\t\tlet opacity: number;\r\n\r\n\t\tfor (i; i < numCircles; i++) {\r\n\t\t\tconst circleObject = this.circleObjects[i];\r\n\t\t\topacity = (fadeIncrement * j++);\r\n\t\t\tsetOpacity(circleObject.element, opacity);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fade(circleObject: any) {\r\n\tlet opacity = getOpacity(circleObject.element) - fadeIncrement;\r\n\r\n\tif (opacity <= 0) {\r\n\t\topacity = 1;\r\n\t}\r\n\r\n\tsetOpacity(circleObject.element, opacity);\r\n}\r\n\r\nfunction getOpacity(element: HTMLDivElement) {\r\n\treturn parseFloat(window.getComputedStyle(element).getPropertyValue(\"opacity\"));\r\n}\r\n\r\nfunction setOpacity(element: HTMLDivElement, opacity: number) {\r\n\telement.style.opacity = opacity.toString();\r\n}\r\n\r\nfunction createCircle(): HTMLDivElement {\r\n\tconst circle: HTMLDivElement = document.createElement(\"div\");\r\n\tcircle.classList.add(Classes.SpinnerCircle);\r\n\tcircle.style.width = circle.style.height = parentSize * offsetSize + \"px\";\r\n\treturn circle;\r\n}\r\n", "/**\r\n * Layout.ts\r\n *\r\n * Module for the layout\r\n */\r\nimport { Api } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport * as Renderer from \"./../Renderer\";\r\nimport * as ChoiceGroupControl from \"./../ChoiceGroupControl\";\r\nimport * as Configuration from \"./../../Configuration/Configuration\";\r\nimport { AttributeName, AttributeValue, Classes, IDs, Tags } from \"./../UiConstants\";\r\nimport * as UIStrings from \"./../../UIStrings/UIStrings\";\r\nimport * as Utils from \"./../Utils\";\r\nimport { isTenantIdCommercial } from \"./../../Utils\";\r\n\r\n/**\r\n * Generates the toast\r\n *\r\n * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object\r\n */\r\nexport function generate(): Renderer.IUIAsJson {\r\n\tconst schema: Renderer.IUIAsJson = {\r\n\t\tattributes: [\r\n\t\t\t{ name: AttributeName.DataHtml2CanvasIgnore, value: AttributeValue.True },\r\n\t\t\t{ name: AttributeName.Role, value: \"alert\" },\r\n\t\t\t{ name: AttributeName.Style, value: Configuration.get().getCSSVarString() },\r\n\t\t],\r\n\t\tchildren: [\r\n\t\t\tgeneratePrompt(),\r\n\t\t\t{\r\n\t\t\t\tattributes: [\r\n\t\t\t\t\t{ name: AttributeName.Type, value: AttributeValue.Button },\r\n\t\t\t\t\t{ name: AttributeName.AriaLabel, value: UIStrings.getUIStrings().CloseLabel },\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.ToastCancel,\r\n\t\t\t\tinnerHTML: '<svg viewBox=\"4 4 16 16\" width=\"16px\" height=\"16px\" focusable=\"false\">'+\r\n\t\t\t\t'<path d=\"M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z\"/></svg>',\r\n\t\t\t\ttag: Tags.Button,\r\n\t\t\t},\r\n\t\t\t(Configuration.get().getFloodgateSurvey().getSurveyType() !== Api.SurveyType.Intercept)\r\n\t\t\t\t? generateForm(Configuration.get().getFloodgateInitOptions().isEudbUxEnabled)\r\n\t\t\t\t: {},\r\n\t\t],\r\n\t\tclasses: [Classes.Toast, Utils.isRightToLeft() ? Classes.Rtl : \"\"],\r\n\t\tid: IDs.ToastContainer,\r\n\t};\r\n\treturn schema;\r\n}\r\n\r\nfunction generatePrompt(): Renderer.IUIAsJson {\r\n\t// Checking if the campaign is an intercept one to render the relevant prompt strings.\r\n\tconst isIntercept = (Configuration.get().getFloodgateSurvey().getSurveyType() === Api.SurveyType.Intercept);\r\n\r\n\tconst promptSchema: Renderer.IUIAsJson = {\r\n\t\tchildren: [\r\n\t\t\t{\r\n\t\t\t\tclasses: [\r\n\t\t\t\t\tClasses.FontText,\r\n\t\t\t\t\tClasses.TextAlignLeft,\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.TPromptTitle,\r\n\t\t\t\tinnerText: isIntercept ?\r\n\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getInterceptTitle() :\r\n\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getTitle(),\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tclasses: [\r\n\t\t\t\t\tClasses.FontSubText,\r\n\t\t\t\t\tClasses.TextAlignLeft,\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.TPromptText,\r\n\t\t\t\tinnerText: isIntercept ?\r\n\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getInterceptQuestion() :\r\n\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getPromptQuestion(),\r\n\t\t\t},\r\n\t\t],\r\n\t\tid: IDs.TPromptContainer,\r\n\t\ttag: Tags.Button,\r\n\t};\r\n\r\n\treturn promptSchema;\r\n}\r\n\r\n/**\r\n * Switches between rending the old EUDB non-compliant UX,\r\n * or the updated EUDB compliant UX. Needed temporarily for\r\n * maintaining experiment baseline - after experiment is complete,\r\n * can remove the non-compliant function\r\n *\r\n * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object\r\n */\r\nfunction generateForm(eudbCompliant: boolean): Renderer.IUIAsJson {\r\n\treturn eudbCompliant ? generateFormEudbCompliant() : generateFormEudbNonCompliant();\r\n}\r\n\r\nfunction generateFormEudbCompliant(): Renderer.IUIAsJson {\r\n\tconst formSchema: Renderer.IUIAsJson = {\r\n\t\tchildren: [\r\n\t\t\tgenerateFormContainerLabel(UIStrings.getUIStrings().Floodgate.Form.Title),\r\n\t\t\t{\r\n\t\t\t\tclasses: [\r\n\t\t\t\t\tClasses.FontText,\r\n\t\t\t\t\tClasses.TextAlignLeft,\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.TFormTitle,\r\n\t\t\t\tinnerText: UIStrings.getUIStrings().Floodgate.Form.Title,\r\n\t\t\t\tattributes : [\r\n\t\t\t\t\t{\t// heading role for screen readers.\r\n\t\t\t\t\t\tname: AttributeName.Role,\r\n\t\t\t\t\t\tvalue: \"heading\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.AriaLevel,\r\n\t\t\t\t\t\tvalue: \"1\"\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\tgenerateRatingControl(),\r\n\t\t\t{ // Comment question label.\r\n\t\t\t\tattributes: [\r\n\t\t\t\t\t{ // Note: It's important that this label is specified for the comment TextArea for acessibility and screen readers.\r\n\t\t\t\t\t\tname: AttributeName.For,\r\n\t\t\t\t\t\tvalue: IDs.TFormComment,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.AriaLabel,\r\n\t\t\t\t\t\tvalue: Configuration.get().getFloodgateSurvey().getCommentQuestion(),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.MaxLength,\r\n\t\t\t\t\t\tvalue: AttributeValue.TextAreaMaxLength,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tinnerText: Configuration.get().getFloodgateSurvey().getCommentQuestion(),\r\n\t\t\t\tclasses: [Classes.FontSubText],\r\n\t\t\t\tid: IDs.TFormCommentQuestion,\r\n\t\t\t\ttag: Tags.Label,\r\n\t\t\t},\r\n\t\t\t{ // Comment questions response text area with personal information warning placeholder\r\n\t\t\t\tattributes: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.Placeholder,\r\n\t\t\t\t\t\tvalue: UIStrings.getUIStrings().Form.CommentPlaceholder,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.MaxLength,\r\n\t\t\t\t\t\tvalue: AttributeValue.TextAreaMaxLength,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tclasses: [Classes.FontSubText, Classes.TextInput],\r\n\t\t\t\tid: IDs.TFormComment,\r\n\t\t\t\ttag: Tags.TextArea,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbrs: Configuration.get().getFloodgateInitOptions().showEmailAddress && Configuration.get().getFloodgateSurvey().showEmailRequest,\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Type,\r\n\t\t\t\t\t\t\t\tvalue: AttributeValue.Checkbox,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tclasses: [Classes.TFormEmailCheckbox, Classes.CheckBox],\r\n\t\t\t\t\t\tid: IDs.TFormEmailCheckBox,\r\n\t\t\t\t\t\ttag: Tags.Input,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [{ name: AttributeName.For, value: IDs.TFormEmailCheckBox }],\r\n\t\t\t\t\t\tclasses: [Classes.FontSubText, Classes.TextAlignLeft, Classes.TFormEmailLabel],\r\n\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().Form.EmailCheckBoxLabel,\r\n\t\t\t\t\t\ttag: Tags.Label,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Type,\r\n\t\t\t\t\t\t\t\tvalue: AttributeValue.Text,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Placeholder,\r\n\t\t\t\t\t\t\t\tvalue: UIStrings.getUIStrings().Form.EmailPlaceholder,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.AriaLabel,\r\n\t\t\t\t\t\t\t\tvalue: UIStrings.getUIStrings().Form.EmailPlaceholder,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Name,\r\n\t\t\t\t\t\t\t\tvalue: IDs.BasicFormEmailInput,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.MaxLength,\r\n\t\t\t\t\t\t\t\tvalue: AttributeValue.TextAreaMaxLength,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Value,\r\n\t\t\t\t\t\t\t\tvalue: \"\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tclasses: [Classes.FontSubText, Classes.FormEmailInput, Classes.TextInput],\r\n\t\t\t\t\t\tid: IDs.TFormEmailTextBox,\r\n\t\t\t\t\t\ttag: Tags.Input,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tchildren:\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tclasses: [Classes.FontSubSubText, Classes.TextAlignLeft, Classes.FormPrivacyConsentText],\r\n\t\t\t\t\t\t\tinnerText: privacyLabelHelper(),\r\n\t\t\t\t\t\t\ttag: Tags.Label,\r\n\t\t\t\t\t\t\tid: IDs.PrivacyConsentText,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: AttributeName.HRef,\r\n\t\t\t\t\t\t\t\t\tvalue: Configuration.get().getCommonInitOptions().privacyUrl,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: AttributeName.Target,\r\n\t\t\t\t\t\t\t\t\tvalue: AttributeValue.BlankWindow,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: AttributeName.Rel,\r\n\t\t\t\t\t\t\t\t\tvalue: AttributeValue.NoReferrer,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\tclasses: [Classes.Link],\r\n\t\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().PrivacyStatement,\r\n\t\t\t\t\t\t\ttag: Tags.Anchor,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\tclasses: [Classes.FontSubSubText, Classes.TextAlignLeft, Classes.PrivacyStatementLinkDivEudbUx],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t{ name: AttributeName.Disabled, value: AttributeValue.True },\r\n\t\t\t\t\t\t\t{ name: AttributeName.AriaDescribedBy, value: IDs.PrivacyConsentText },\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tclasses: [\r\n\t\t\t\t\t\t\tClasses.FontSubText,\r\n\t\t\t\t\t\t\tClasses.SubmitButton,\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tid: IDs.TFormSubmitButton,\r\n\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().Form.Submit,\r\n\t\t\t\t\t\ttag: Tags.Button,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclasses: [Classes.Spinner, Classes.Hidden],\r\n\t\t\t\t\t\tid: IDs.TFormSubmitButtonSpinner,\r\n\t\t\t\t\t\ttag: Tags.Div,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclasses: [\r\n\t\t\t\t\t\t\tClasses.FontSubText,\r\n\t\t\t\t\t\t\tClasses.CancelButton,\r\n\t\t\t\t\t\t\tUtils.isRightToLeft() ? Classes.Rtl : \"\",\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tid: IDs.TFormCancelButton,\r\n\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().Form.Cancel,\r\n\t\t\t\t\t\ttag: Tags.Button,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.TFormSubmitButtonContainer,\r\n\t\t\t},\r\n\t\t],\r\n\t\tclasses: [Classes.Hidden],\r\n\t\tid: IDs.TFormContainer,\r\n\t\tattributes: [\r\n\t\t\t{ name: AttributeName.AriaLabelledBy, value: IDs.TFormContainerLabel },\r\n\t\t],\r\n\t};\r\n\r\n\treturn formSchema;\r\n}\r\n\r\nfunction generateFormEudbNonCompliant(): Renderer.IUIAsJson {\r\n\tconst formSchema: Renderer.IUIAsJson = {\r\n\t\tchildren: [\r\n\t\t\tgenerateFormContainerLabel(Configuration.get().getFloodgateSurvey().getTitle()),\r\n\t\t\t{\r\n\t\t\t\tclasses: [\r\n\t\t\t\t\tClasses.FontText,\r\n\t\t\t\t\tClasses.TextAlignLeft,\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.TFormTitle,\r\n\t\t\t\tinnerText: Configuration.get().getFloodgateSurvey().getTitle(),\r\n\t\t\t},\r\n\t\t\tgenerateRatingControl(),\r\n\t\t\t{\r\n\t\t\t\tattributes: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.Placeholder,\r\n\t\t\t\t\t\tvalue: Configuration.get().getFloodgateSurvey().getCommentQuestion(),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.AriaLabel,\r\n\t\t\t\t\t\tvalue: Configuration.get().getFloodgateSurvey().getCommentQuestion(),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: AttributeName.MaxLength,\r\n\t\t\t\t\t\tvalue: AttributeValue.TextAreaMaxLength,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tclasses: [Classes.FontSubText, Classes.TextInput],\r\n\t\t\t\tid: IDs.TFormComment,\r\n\t\t\t\ttag: Tags.TextArea,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tbrs: Configuration.get().getFloodgateInitOptions().showEmailAddress && Configuration.get().getFloodgateSurvey().showEmailRequest,\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Type,\r\n\t\t\t\t\t\t\t\tvalue: AttributeValue.Checkbox,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tclasses: [Classes.TFormEmailCheckbox, Classes.CheckBox],\r\n\t\t\t\t\t\tid: IDs.TFormEmailCheckBox,\r\n\t\t\t\t\t\ttag: Tags.Input,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [{ name: AttributeName.For, value: IDs.TFormEmailCheckBox }],\r\n\t\t\t\t\t\tclasses: [Classes.FontSubText, Classes.TextAlignLeft, Classes.TFormEmailLabel],\r\n\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().Form.EmailCheckBoxLabel,\r\n\t\t\t\t\t\ttag: Tags.Label,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Type,\r\n\t\t\t\t\t\t\t\tvalue: AttributeValue.Text,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Placeholder,\r\n\t\t\t\t\t\t\t\tvalue: UIStrings.getUIStrings().Form.EmailPlaceholder,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.AriaLabel,\r\n\t\t\t\t\t\t\t\tvalue: UIStrings.getUIStrings().Form.EmailPlaceholder,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Name,\r\n\t\t\t\t\t\t\t\tvalue: IDs.BasicFormEmailInput,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.MaxLength,\r\n\t\t\t\t\t\t\t\tvalue: AttributeValue.TextAreaMaxLength,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tname: AttributeName.Value,\r\n\t\t\t\t\t\t\t\tvalue: \"\",\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tclasses: [Classes.FontSubText, Classes.FormEmailInput, Classes.TextInput],\r\n\t\t\t\t\t\tid: IDs.TFormEmailTextBox,\r\n\t\t\t\t\t\ttag: Tags.Input,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tchildren:\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tattributes: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: AttributeName.HRef,\r\n\t\t\t\t\t\t\t\t\tvalue: Configuration.get().getCommonInitOptions().privacyUrl,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: AttributeName.Target,\r\n\t\t\t\t\t\t\t\t\tvalue: AttributeValue.BlankWindow,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tname: AttributeName.Rel,\r\n\t\t\t\t\t\t\t\t\tvalue: AttributeValue.NoReferrer,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\tclasses: [Classes.Link],\r\n\t\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().PrivacyStatement,\r\n\t\t\t\t\t\t\ttag: Tags.Anchor,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\tclasses: [Classes.FontSubSubText, Classes.TextAlignLeft, Classes.PrivacyStatementLinkDiv],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tattributes: [{ name: AttributeName.Disabled, value: AttributeValue.True }],\r\n\t\t\t\t\t\tclasses: [\r\n\t\t\t\t\t\t\tClasses.FontSubText,\r\n\t\t\t\t\t\t\tClasses.SubmitButton,\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\tid: IDs.TFormSubmitButton,\r\n\t\t\t\t\t\tinnerText: UIStrings.getUIStrings().Form.Submit,\r\n\t\t\t\t\t\ttag: Tags.Button,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclasses: [Classes.Spinner, Classes.Hidden],\r\n\t\t\t\t\t\tid: IDs.TFormSubmitButtonSpinner,\r\n\t\t\t\t\t\ttag: Tags.Div,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t\tid: IDs.TFormSubmitButtonContainer,\r\n\t\t\t},\r\n\t\t],\r\n\t\tclasses: [Classes.Hidden],\r\n\t\tid: IDs.TFormContainer,\r\n\t\tattributes: [\r\n\t\t\t{ name: AttributeName.AriaLabelledBy, value: IDs.TFormContainerLabel },\r\n\t\t],\r\n\t};\r\n\r\n\treturn formSchema;\r\n}\r\n\r\nfunction generateRatingControl(): Renderer.IUIAsJson {\r\n\tconst choices: [number, string][] = [];\r\n\r\n\tconst ratingValues: string[] = Configuration.get().getFloodgateSurvey().getRatingValuesAscending();\r\n\tlet index = 0;\r\n\r\n\tfor (const ratingValue of ratingValues) {\r\n\t\tchoices.push([index, ratingValue]);\r\n\t\tindex++;\r\n\t}\r\n\r\n\t// Ratings need to be shown in descending order\r\n\treturn ChoiceGroupControl.generateRadioGroup(IDs.TFormRating,\r\n\t\tConfiguration.get().getFloodgateSurvey().getRatingQuestion()?.trim(),\r\n\t\tchoices.reverse());\r\n}\r\n\r\n// The PrivacyConsent text is concatenated to the PrivacyLabel if the user is commercial.\r\nfunction privacyLabelHelper(): string {\r\n\tif (isTenantIdCommercial(Configuration.get().getCommonInitOptions().telemetryGroup.tenantId)) {\r\n\t\treturn UIStrings.getUIStrings().Form.PrivacyLabel + UIStrings.getUIStrings().Form.PrivacyConsent + \" \";\r\n\t} else {\r\n\t\treturn UIStrings.getUIStrings().Form.PrivacyLabel;\r\n\t}\r\n}\r\n\r\nfunction generateFormContainerLabel(label: string): Renderer.IUIAsJson {\r\n\tconst formSchema: Renderer.IUIAsJson = {\r\n\t\tclasses: [Classes.Hidden],\r\n\t\tid: IDs.TFormContainerLabel,\r\n\t\tinnerText: label,\r\n\t}\r\n\treturn formSchema;\r\n}", "/**\r\n * ChoiceGroupControl.ts\r\n *\r\n * A module for rendering a choice group.\r\n */\r\n\r\nimport { AttributeName, AttributeValue, Classes, IDs, Tags } from \"./UiConstants\";\r\nimport * as Renderer from \"./Renderer\";\r\nimport * as Utils from \"../Utils\";\r\n\r\nconst { isNOU } = Utils;\r\n\r\nexport function generateRadioGroup(id: string, question: string, choices: [number, string][]): Renderer.IUIAsJson {\r\n\tconst fieldSet: Renderer.IUIAsJson = {\r\n\t\t\tchildren: [],\r\n\t\t\ttag: Tags.FieldSet,\r\n\t\t\tattributes: [{ name: \"required\", value: \"true\" }],\r\n\t\t};\r\n\r\n\tif (!isNOU(question)) {\r\n\t\tArray.prototype.push.apply(\r\n\t\t\tfieldSet.children,\r\n\t\t\t[\r\n\t\t\t\t{\r\n\t\t\t\t\tclasses: [Classes.FontSubText],\r\n\t\t\t\t\tid: IDs.TFormRatingQuestion,\r\n\t\t\t\t\tinnerText: question,\r\n\t\t\t\t\ttag: Tags.Legend,\r\n\t\t\t\t\t// Legacy Edge need aria-label for accessibility\r\n\t\t\t\t\tattributes: [{ name: AttributeName.AriaLabel, value: question }],\r\n\t\t\t\t\tchildren: [{\r\n\t\t\t\t\t\tclasses: [Classes.RequiredAsterisk],\r\n\t\t\t\t\t\tid: IDs.RequiredAsterisk,\r\n\t\t\t\t\t\tinnerText: \"*\",\r\n\t\t\t\t\t\ttag: Tags.Span,\r\n\t\t\t\t\t}],\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t);\r\n\t}\r\n\r\n\tfor (const choice of choices) {\r\n\t\tArray.prototype.push.apply(fieldSet.children, generateRadioButton(choice[0].toString(), choice[1], id));\r\n\t}\r\n\r\n\treturn {\r\n\t\tchildren: [fieldSet],\r\n\t\tclasses: [Classes.ChoiceGroup],\r\n\t\tid: id,\r\n\t};\r\n}\r\n\r\nfunction generateRadioButton(value: string, label: string, id: string): Renderer.IUIAsJson[] {\r\n\treturn [\r\n\t\t{\r\n\t\t\tattributes: [\r\n\t\t\t\t{ name: AttributeName.Type, value: AttributeValue.Radio },\r\n\t\t\t\t{ name: AttributeName.Value, value: value },\r\n\t\t\t\t{ name: AttributeName.Name, value: id },\r\n\t\t\t],\r\n\t\t\tid: value,\r\n\t\t\ttag: Tags.Input,\r\n\t\t},\r\n\t\t{\r\n\t\t\tattributes: [{ name: AttributeName.For, value: value }],\r\n\t\t\tchildren: [\r\n\t\t\t\t{\r\n\t\t\t\t\tchildren: [{ tag: Tags.Span }],\r\n\t\t\t\t\tclasses: [Classes.ChoiceGroupIcon],\r\n\t\t\t\t\ttag: Tags.Span,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tclasses: [\"obf-ChoiceGroupLabel\"],\r\n\t\t\t\t\tinnerHTML: label,\r\n\t\t\t\t\ttag: Tags.Span,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t\tclasses: [Classes.FontSubText],\r\n\t\t\ttag: Tags.Label,\r\n\t\t},\r\n\t];\r\n}\r\n", "/* eslint @microsoft/sdl/no-inner-html: \"off\" */\r\n\r\n/**\r\n * Renderer.ts\r\n *\r\n * Module for rendering the markup\r\n */\r\n\r\nimport { domUtilsTrustedTypePolicy, sanitizeHtmlString } from \"../Window/TrustedTypesPolicyUtils\";\r\nimport { AttributeName, Tags } from \"./UiConstants\";\r\n\r\n/**\r\n * Interface for an attribute\r\n */\r\nexport interface IAttribute {\r\n\tname: string;\r\n\tvalue: string;\r\n}\r\n\r\n/**\r\n * Interface for UI(HTML markup) as json\r\n */\r\nexport interface IUIAsJson {\r\n\tid?: string;\r\n\ttag?: string; // div by default\r\n\tclasses?: string[]; // CSS class\r\n\tattributes?: IAttribute[];\r\n\tchildren?: IUIAsJson[];\r\n\tinnerText?: string;\r\n\tinnerHTML?: string;\r\n\tbrs?: any; // should the element and its children be created? true by default\r\n}\r\n\r\n/**\r\n * Create DOM elements from Json structure\r\n * @param {UiAsJson} schema The Json structure\r\n * @param {boolean} svg Create svg element instead of html?\r\n * @return {HTMLElement} HTML elements with tree structure\r\n */\r\nexport function elementFromJson(schema: IUIAsJson, svg?: boolean): Element {\r\n\tif (typeof schema.brs === \"undefined\") {\r\n\t\tschema.brs = true;\r\n\t}\r\n\r\n\tif (!schema.brs) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (!schema.tag) {\r\n\t\tschema.tag = Tags.Div;\r\n\t}\r\n\r\n\tlet element: Element;\r\n\r\n\tif (schema.tag === Tags.Svg) {\r\n\t\tsvg = true;\r\n\t}\r\n\r\n\tif (svg) {\r\n\t\telement = document.createElementNS(\"http://www.w3.org/2000/svg\", schema.tag);\r\n\t} else {\r\n\t\telement = document.createElement(schema.tag);\r\n\t}\r\n\r\n\tif (schema.attributes) {\r\n\t\tlet attribute: IAttribute;\r\n\t\tfor (let i = 0; i < schema.attributes.length; i++) {\r\n\t\t\tattribute = schema.attributes[i];\r\n\t\t\tif (attribute.name === AttributeName.xlinkHref) {\r\n\t\t\t\telement.setAttributeNS(\"http://www.w3.org/1999/xlink\", AttributeName.HRef, attribute.value);\r\n\t\t\t} else {\r\n\t\t\t\telement.setAttribute(attribute.name, attribute.value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (schema.id) {\r\n\t\telement.id = schema.id;\r\n\t}\r\n\r\n\tif (schema.classes) {\r\n\t\tconst concatClasses: string = schema.classes.join(\" \");\r\n\t\tif (svg) {\r\n\t\t\telement.setAttribute(AttributeName.Class, concatClasses);\r\n\t\t} else {\r\n\t\t\telement.className = concatClasses;\r\n\t\t}\r\n\t}\r\n\r\n\tif (schema.innerText && !svg) {\r\n\t\telement.textContent = schema.innerText;\r\n\t}\r\n\r\n\tif (schema.innerHTML && !svg) {\r\n\t\telement.innerHTML = domUtilsTrustedTypePolicy()?.createHTML(schema.innerHTML) ?? sanitizeHtmlString(schema.innerHTML);\r\n\t}\r\n\r\n\tif (schema.children) {\r\n\t\tfor (let i = 0; i < schema.children.length; i++) {\r\n\t\t\t// Sometimes IE mis-reports length\r\n\t\t\tconst cur: IUIAsJson = schema.children[i];\r\n\r\n\t\t\tif (cur) {\r\n\t\t\t\tconst child: Element = elementFromJson(cur, svg);\r\n\r\n\t\t\t\tif (child) {\r\n\t\t\t\t\telement.appendChild(child);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n", "/**\r\n * Toast.ts\r\n *\r\n * Module for the Toast UI\r\n */\r\n\r\nimport { IDs } from \"./../UiConstants\";\r\nimport * as Events from \"./Events\";\r\nimport * as Layout from \"./Layout\";\r\nimport * as Renderer from \"./../Renderer\";\r\nimport * as Utils from \"./../Utils\";\r\nimport * as Configuration from \"./../../Configuration/Configuration\";\r\nimport * as DynamicUxClient from \"../DynamicUx/DynamicUxClient\";\r\nimport * as Logging from \"../../Logging/Logging\";\r\nimport { DynamicUxClientState } from \"@ms-ofb/floodgate-shared-typings\";\r\nimport { CentroCoreDataSource } from \"../DynamicUx/CentroCoreDataSource\";\r\n\r\n/**\r\n * UI initialization for toast\r\n */\r\nexport function createSurvey(onClose: () => void) {\r\n\tconst dxEnabled = Configuration.get().getDynamicUxConfig().enabled;\r\n\tLogging.getLogger().logEvent(Logging.EventIds.SURVEY_UI_CREATE,\r\n\t\tLogging.LogLevel.Critical,\r\n\t\t{\r\n\t\t\tCampaignId: Configuration.get().getFloodgateSurvey()?.getCampaignId(),\r\n\t\t\tSurveyId: Configuration.get().getFloodgateSurvey()?.getId(),\r\n\t\t\tSurveyType: Configuration.get().getFloodgateSurvey()?.getSurveyType(),\r\n\t\t\tMessage: JSON.stringify({\r\n\t\t\t\tDynamicUxClientState: dxEnabled && DynamicUxClient.get()?.getStatus(),\r\n\t\t\t\tDynamicUxEnabled: dxEnabled,\r\n\t\t\t\tSurveyEnabled: Configuration.get().checkIfSurveysEnabled()\r\n\t\t\t}),\r\n\t\t}\r\n\t);\r\n\r\n\tif (Configuration.get().getFloodgateSurvey().getUxSchema() &&\r\n\t\tdxEnabled && DynamicUxClient.get().getStatus() === DynamicUxClientState.Success) {\r\n\t\tCentroCoreDataSource.get().updateFloodgateSurvey(() => {\r\n\t\t\tDynamicUxClient.get().unmountSurvey();\r\n\t\t\tonClose();\r\n\t\t});\r\n\t\tDynamicUxClient.get().boostStrapSurvey().catch((error) => {\r\n\t\t\tLogging.getLogger().logEvent(Logging.EventIds.DYNAMICUX_BOOSTSTRAPPER_FAILURE,\r\n\t\t\t\tLogging.LogLevel.Error,\r\n\t\t\t\t{\r\n\t\t\t\t\tErrorMessage: error,\r\n\t\t\t\t\tMessage: JSON.stringify({\r\n\t\t\t\t\t\tDynamicUxClientState: DynamicUxClient.get().getStatus(),\r\n\t\t\t\t\t}),\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t// Call onError to let host app know.\r\n\t\t\tConfiguration.get().getCommonInitOptions().onError(`Failed to bootstrap Dynamic survey UX: ${error}`);\r\n\t\t});\r\n\t}\r\n\telse {\r\n\t\tcreate(Renderer.elementFromJson(Layout.generate()));\r\n\t\tEvents.register(\r\n\t\t\tfunction (submitted: boolean) {\r\n\t\t\t\tUtils.setElementVisibility(IDs.ToastContainer, false);\r\n\t\t\t\tUtils.deleteElementById(IDs.ToastContainer);\r\n\t\t\t\tConfiguration.get().getFloodgateInitOptions().onDismiss(\r\n\t\t\t\t\tConfiguration.get().getFloodgateSurvey().getCampaignId(),\r\n\t\t\t\t\tsubmitted\r\n\t\t\t\t);\r\n\t\t\t\tonClose();\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nfunction create(userInterface: Element) {\r\n\tconst surveyContainer = Configuration.get().getFloodgateInitOptions().surveyContainer;\r\n\tif (typeof surveyContainer === 'string') {\r\n\t\t// Element ID is provided\r\n\t\tconst surveyContainerElement = Utils.getOrCreateDiv(surveyContainer);\r\n\t\t// Insert the survey UI as the first child of the survey container\r\n\t\tsurveyContainerElement.insertBefore(userInterface, surveyContainerElement.firstChild);\r\n\t} else if (surveyContainer instanceof HTMLElement) { // TypeOf surveyContainer is \"Object\" when HtmlElement is passed, so checking for instanceOf\r\n\t\t// HtmlElement is provided\r\n\t\tsurveyContainer.insertBefore(userInterface, surveyContainer.firstChild);\r\n\t} else {\r\n\t\t// Fallback to current drawing mechanism\r\n\t\tdocument.body.insertBefore(userInterface, document.body.firstChild);\r\n\t}\r\n\r\n\tUtils.setElementVisibility(IDs.ToastContainer, true);\r\n}\r\n", "/**\r\n * Main entry point for only Floodgate with UI support\r\n * By using makeFloodgate, it will return the Floodgate object.\r\n */\r\n\r\n///<reference path=\"./typings/OfficeBrowserFeedback.d.ts\"/>\r\n\r\nimport * as Window from \"./scripts/app/Window/Window\";\r\nimport \"./scripts/app/App_Floodgate\";\r\n\r\nexport function makeFloodgate() {\r\n    return Window.get().OfficeBrowserFeedback;\r\n}\r\n", "// Application Configuration Constants\r\nexport const APP_CONSTANTS = {\r\n    // Basic App Information\r\n    APP: {\r\n        ID: 2931,\r\n        NAME: \"Microsoft Fabric\",\r\n        VERSION: \"18.0.1234.0\",\r\n        BUILD_VERSION: \"18.0.1234.0\",\r\n        PLATFORM: \"Web\"\r\n    },\r\n\r\n    // Environment Configuration\r\n    ENVIRONMENT: {\r\n        TYPE: \"Production\", // \"Production\", \"Pre-Production\", \"Development\"\r\n        LOCALE: \"en-us\",\r\n        LANGUAGE: \"en\",\r\n        IS_PRODUCTION: true\r\n    },\r\n\r\n    // Floodgate SDK Configuration\r\n    FLOODGATE: {\r\n        APP_ID: 2931, // 50378 = Pre-Production - 2931 = Production\r\n        ENVIRONMENT: 0, // 0 = Production, 1 = Integration\r\n        AUTO_DISMISS: 2,\r\n        RETENTION_DAYS: 90,\r\n        SURVEY_CONTAINER: \"nps-display\",\r\n        THEME: \"TeamsLightV2\",\r\n        FOOTER_ALIGNMENT: 0\r\n    },\r\n\r\n    // Authentication Configuration\r\n    AUTH: {\r\n        TYPE: {\r\n            MSA: 0,\r\n            AAD: 1,\r\n            UNAUTHENTICATED: 2\r\n        },\r\n        IS_COMMERCIAL_HOST: true,\r\n        SHOW_EMAIL_ADDRESS: true,\r\n        GOVERNANCE_ENABLED: false\r\n    },\r\n\r\n    // Telemetry Configuration\r\n    TELEMETRY: {\r\n        AUDIENCE_GROUP: \"TestAudienceGroup\",\r\n        DEVICE_ID: \"TestDeviceId\",\r\n        CUSTOM_RESOURCES_EXTERNALLY: 2\r\n    },\r\n\r\n    // Dynamic Campaign Configuration\r\n    DYNAMIC_CAMPAIGN: {\r\n        ENABLED: true,\r\n        HOST: \"https://config.edge.skype.com\", // PPE ECS endpoint https://config.edge.skype.net // Production ECS endpoint https://config.edge.skype.com\r\n        AGENT: \"ChillMicrosoftFabric\",\r\n        AUDIENCE: \"Internal\",\r\n        SURVEY_VALIDATION: \"true\",\r\n        FILTERS: {\r\n            agent: \"ChillMicrosoftFabric\",\r\n            Environment: \"External\",\r\n            Audience: \"Internal\",\r\n            SurveyValidation: \"true\"\r\n        }\r\n    },\r\n\r\n    // UI Configuration\r\n    UI: {\r\n        CDN_STRINGS_ENABLED: true,\r\n        FETCH_CDN_CONCURRENTLY: false,\r\n        COMPLIANCE_CHECK: true,\r\n        SURVEY_ENABLED: true\r\n    },\r\n\r\n    // Error Messages\r\n    ERROR_MESSAGES: {\r\n        SDK_ERROR: \"SDK encountered an error\",\r\n        INIT_FAILED: \"Floodgate initialization failed\",\r\n        TARGET_NOT_FOUND: \"Target element not found\",\r\n        AUTH_REQUIRED: \"SSO Authentication Required\",\r\n        RENDER_FAILED: \"Failed to render app\"\r\n    },\r\n\r\n    // Success Messages\r\n    SUCCESS_MESSAGES: {\r\n        APP_RENDERED: \"App successfully rendered\",\r\n        SDK_INITIALIZED: \"Floodgate SDK initialized successfully\",\r\n        USER_AUTHENTICATED: \"User authenticated with SSO\",\r\n        DYNAMIC_CAMPAIGN_STARTED: \"Dynamic Campaign client started\"\r\n    }\r\n    \r\n};\r\n\r\n// Environment-specific configurations\r\nexport const ENV_CONFIG = {\r\n    PRODUCTION: {\r\n        FLOODGATE_ENV: 0,\r\n        LOG_LEVEL: \"error\",\r\n        DEBUG_ENABLED: false\r\n    },\r\n    PRE_PRODUCTION: {\r\n        FLOODGATE_ENV: 1,\r\n        LOG_LEVEL: \"warn\",\r\n        DEBUG_ENABLED: true\r\n    },\r\n    DEVELOPMENT: {\r\n        FLOODGATE_ENV: 1,\r\n        LOG_LEVEL: \"debug\",\r\n        DEBUG_ENABLED: true\r\n    }\r\n};\r\n\r\n// Export helper functions\r\nexport const getEnvironmentConfig = (envType = APP_CONSTANTS.ENVIRONMENT.TYPE) => {\r\n    return ENV_CONFIG[envType.toUpperCase().replace(\"-\", \"_\")] || ENV_CONFIG.DEVELOPMENT;\r\n};\r\n\r\nexport const isProduction = () => {\r\n    return APP_CONSTANTS.ENVIRONMENT.TYPE === \"Production\";\r\n};\r\n\r\nexport const isDevelopment = () => {\r\n    return APP_CONSTANTS.ENVIRONMENT.TYPE === \"Pre-Production\" || APP_CONSTANTS.ENVIRONMENT.TYPE === \"Development\";\r\n};\r\n\r\n\r\n// OCV configurations and variables\r\nexport const OCVStateLocalStorageKeys = [\r\n    \"obf-GovernedChannelStates\",\r\n    \"obf-CampaignStates\",\r\n    \"obf-SurveyActivationStats\",\r\n    \"obf-SurveyEventActivityStats\"\r\n];\r\n\r\n\r\n// Internal Logging Constants\r\nexport const FLOODGATE_ACTIVITIES = {\r\n    APP_USAGE_TIME: \"AppUsageTime\",\r\n    READY_TO_PROMPT: \"ReadytoPrompt\"\r\n};\r\n\r\n// Utility function to clear OCV state storage\r\nexport const clearOCVStateStorage = () => {\r\n    OCVStateLocalStorageKeys.forEach(key => {\r\n        try {\r\n            localStorage.removeItem(key);\r\n            console.log(`Cleared localStorage key: ${key}`);\r\n        } catch (error) {\r\n            console.warn(`Failed to clear localStorage key: ${key}`, error);\r\n        }\r\n    });\r\n    console.log(\"OCV state storage cleared for testing\");\r\n};\r\n\r\n// Check if we're in testing mode\r\nexport const isTestingMode = () => {\r\n    return APP_CONSTANTS.ENVIRONMENT.TYPE !== \"Production\" && \r\n           (window.location.hostname === 'localhost' || \r\n            window.location.hostname.includes('dev') ||\r\n            process.env.NODE_ENV === 'development');\r\n};\r\n\r\n// Use constants\r\nexport const AppUsageTimeout = 5 * 60 * 1000; // 5 minutes\r\nexport const OCV_CLEAR_DELAY = 1000; // 1 second\r\n", "\uFEFFimport { IDynamicCampaignConfig } from \"@ms-ofb/officebrowserfeedbacknpm/scripts/app/Configuration/IInitOptions\";\r\nimport { TelemetrySinkProvider } from \"../logging/TelemetrySinkProvider\";\r\nimport { Client as DynamicCampaignClient } from \"@ms-ofb/officebrowserfeedback-ext-dynamic-campaign\";\r\nimport { makeFloodgate } from '@ms-ofb/officebrowserfeedbacknpm/Floodgate'\r\nimport { OfficeBrowserFeedback } from \"@ms-ofb/officebrowserfeedbacknpm/scripts/app/Window/Window\";\r\nimport { APP_CONSTANTS, getEnvironmentConfig, isProduction,clearOCVStateStorage, isTestingMode } from \"../utils/app-constants.js\";\r\n\r\nexport async function loadAndInitialize(userDetails?: {\r\n    userId?: string;    \r\n    ssoId?: string;\r\n}): Promise<OfficeBrowserFeedback> {\r\n\r\n    const officeBrowserFeedback = makeFloodgate();\r\n    const telemetrySinkProvider = new TelemetrySinkProvider(userDetails);\r\n    const envConfig = getEnvironmentConfig();\r\n\r\n    // Get locale\r\n    const locale: string = document.documentElement.getAttribute(\"lang\") ?? APP_CONSTANTS.ENVIRONMENT.LANGUAGE;\r\n\r\n    // Generate session ID\r\n    let sessionId = sessionStorage.getItem(APP_CONSTANTS.STORAGE_KEYS.SESSION_ID);\r\n    if (!sessionId) {\r\n        sessionId = (typeof crypto !== \"undefined\" && crypto.randomUUID)\r\n            ? crypto.randomUUID()\r\n            : ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\r\n                (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\r\n            );\r\n        sessionStorage.setItem(APP_CONSTANTS.STORAGE_KEYS.SESSION_ID, sessionId);\r\n    }\r\n\r\n    officeBrowserFeedback.initOptions = {\r\n        appId: APP_CONSTANTS.FLOODGATE.APP_ID,\r\n        complianceCheck: APP_CONSTANTS.UI.COMPLIANCE_CHECK,\r\n        surveyEnabled: APP_CONSTANTS.UI.SURVEY_ENABLED,\r\n        environment: APP_CONSTANTS.FLOODGATE.ENVIRONMENT,\r\n        locale: locale,\r\n        onError: (error: string) => { \r\n            if (!isProduction()) console.error(APP_CONSTANTS.ERROR_MESSAGES.SDK_ERROR + \":\", error); \r\n        },\r\n        applicationGroup: {\r\n            appData: JSON.stringify({\r\n                \"AppId\": APP_CONSTANTS.APP.ID,\r\n                \"AppName\": APP_CONSTANTS.APP.NAME,\r\n                \"AppVersion\": APP_CONSTANTS.APP.VERSION,\r\n                \"Environment\": APP_CONSTANTS.ENVIRONMENT.TYPE,\r\n                \"Language\": APP_CONSTANTS.ENVIRONMENT.LOCALE,                \r\n                \"SsoId\": userDetails?.ssoId\r\n            })\r\n        },\r\n        telemetryGroup: {\r\n            audienceGroup: APP_CONSTANTS.TELEMETRY.AUDIENCE_GROUP,\r\n            deviceId: APP_CONSTANTS.TELEMETRY.DEVICE_ID,\r\n            loggableUserId: userDetails?.ssoId,\r\n        },\r\n        telemetrySink: telemetrySinkProvider.getTelemetrySink(),\r\n        customResourcesSetExternally: APP_CONSTANTS.TELEMETRY.CUSTOM_RESOURCES_EXTERNALLY,\r\n        sessionId: sessionId,\r\n        build: APP_CONSTANTS.APP.BUILD_VERSION,\r\n        authenticationType: userDetails?.ssoId ? APP_CONSTANTS.AUTH.TYPE.AAD : APP_CONSTANTS.AUTH.TYPE.UNAUTHENTICATED,\r\n        isCommercialHost: APP_CONSTANTS.AUTH.IS_COMMERCIAL_HOST,\r\n        retentionDurationDays: APP_CONSTANTS.FLOODGATE.RETENTION_DAYS,\r\n    };\r\n\r\n    officeBrowserFeedback.setUiStrings({});\r\n\r\n    // Initialize Dynamic Campaign Extension\r\n    let dynamicCampaignExtension;\r\n    let floodgateDynamicCampaignConfig: IDynamicCampaignConfig = {\r\n        enabled: APP_CONSTANTS.DYNAMIC_CAMPAIGN.ENABLED,\r\n        ecsClient: undefined,\r\n    };\r\n\r\n    // Setup Dynamic Campaign filters using constants\r\n    const dynamicCampaignFilters = new Map();\r\n    Object.entries(APP_CONSTANTS.DYNAMIC_CAMPAIGN.FILTERS).forEach(([key, value]) => {\r\n        dynamicCampaignFilters.set(key, value);\r\n    });\r\n\r\n    try {\r\n        dynamicCampaignExtension = new DynamicCampaignClient({\r\n            appName: APP_CONSTANTS.APP.NAME,\r\n            appVersion: APP_CONSTANTS.APP.VERSION,\r\n            language: APP_CONSTANTS.ENVIRONMENT.LOCALE,\r\n            host: APP_CONSTANTS.DYNAMIC_CAMPAIGN.HOST,\r\n            filters: dynamicCampaignFilters,\r\n            localStorageProvider: officeBrowserFeedback.floodgate.getStorageProvider(),\r\n        });\r\n\r\n        await dynamicCampaignExtension.start();\r\n        floodgateDynamicCampaignConfig.ecsClient = dynamicCampaignExtension;\r\n        \r\n        if (!isProduction()) {\r\n            console.log(APP_CONSTANTS.SUCCESS_MESSAGES.DYNAMIC_CAMPAIGN_STARTED);\r\n        }\r\n        \r\n    } catch (e) {\r\n        if (!isProduction()) {\r\n            console.error('Dynamic Campaign Error:', e);\r\n        }\r\n        floodgateDynamicCampaignConfig.enabled = false;\r\n    }\r\n\r\n    const onSurveyActivated = (launcher: any, survey: any) => {\r\n        launcher.launch();\r\n    };\r\n\r\n    officeBrowserFeedback.floodgate.initOptions = {\r\n        autoDismiss: APP_CONSTANTS.FLOODGATE.AUTO_DISMISS,\r\n        complianceCheck: APP_CONSTANTS.UI.COMPLIANCE_CHECK,\r\n        userId: userDetails?.ssoId,\r\n        userLogin: userDetails?.ssoId,\r\n        ssoId: userDetails?.ssoId,\r\n        onDismiss: (campaignId: string, submitted: boolean) => {\r\n            // Minimal logging for production\r\n        },\r\n        governanceServiceEnabled: APP_CONSTANTS.AUTH.GOVERNANCE_ENABLED,\r\n        dynamicCampaignConfig: floodgateDynamicCampaignConfig,\r\n        dynamicUxConfig: {\r\n            enabled: true,\r\n            cdnStringConfig: {\r\n                uiStringsCdnEnabled: APP_CONSTANTS.UI.CDN_STRINGS_ENABLED,\r\n                fetchCdnConcurrently: APP_CONSTANTS.UI.FETCH_CDN_CONCURRENTLY\r\n            },\r\n            footerButtonsAlignment: APP_CONSTANTS.FLOODGATE.FOOTER_ALIGNMENT,\r\n            theme: APP_CONSTANTS.FLOODGATE.THEME,\r\n        },\r\n        onSurveyActivatedCallback: { onSurveyActivated },\r\n        surveyEnabled: APP_CONSTANTS.UI.SURVEY_ENABLED,\r\n        showEmailAddress: APP_CONSTANTS.AUTH.SHOW_EMAIL_ADDRESS,\r\n        surveyContainer: APP_CONSTANTS.FLOODGATE.SURVEY_CONTAINER,\r\n    };\r\n\r\n    try {\r\n        await officeBrowserFeedback.floodgate.initialize();\r\n        if (!isProduction()) {\r\n            console.log(APP_CONSTANTS.SUCCESS_MESSAGES.SDK_INITIALIZED);\r\n        }\r\n\r\n         // Clear OCV state storage again after initialization in testing mode\r\n        if (isTestingMode()) {\r\n            setTimeout(() => {\r\n                clearOCVStateStorage();\r\n            }, 1000); // Small delay to ensure initialization is complete\r\n        }\r\n    } catch (error) {\r\n        console.error(APP_CONSTANTS.ERROR_MESSAGES.INIT_FAILED + \":\", error);\r\n        throw new Error(APP_CONSTANTS.ERROR_MESSAGES.INIT_FAILED + \": \" + error);\r\n    }\r\n\r\n    return officeBrowserFeedback;\r\n}", "\r\nexport const global_variables = {\r\n   \r\n    // @ts-ignore\r\n    sso_id: typeof nps_sso_id !== 'undefined' ? nps_sso_id : \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\r\n\r\n};\r\n", "import React, { useEffect, useState } from \"react\";\r\nimport { useFloodgate } from \"../providers/FloodgateProvider\";\r\nimport { global_variables } from \"../freemarker-variables\";\r\nimport { FLOODGATE_ACTIVITIES, isProduction } from \"../utils/app-constants.js\";\r\n\r\n/**\r\n * FloodgateTrigger Component\r\n * \r\n * Automatically triggers Floodgate activities when the user is authenticated\r\n * and the Floodgate SDK is initialized. This component doesn't render any UI.\r\n * \r\n * Triggered Activities:\r\n * - AppUsageTime: Indicates user is actively using the app\r\n * - ReadyToPrompt: Indicates the app is ready to show surveys\r\n * \r\n * @returns {null} This component doesn't render any UI elements\r\n */\r\nexport const FloodgateTrigger = () => {\r\n    const { logActivity, isInitialized } = useFloodgate();\r\n    const [hasTriggeredSurvey, setHasTriggeredSurvey] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!isProduction()) {\r\n            console.log('FloodgateTrigger: isInitialized =', isInitialized);\r\n            console.log('FloodgateTrigger: hasSSO =', !!global_variables?.sso_id);\r\n            console.log('FloodgateTrigger: hasTriggered =', hasTriggeredSurvey);\r\n        }\r\n\r\n        const logFloodgateActivities = async () => {\r\n            try {\r\n                if (isInitialized && global_variables?.sso_id && !hasTriggeredSurvey) {\r\n                    // Log initial app usage\r\n                    await logActivity(FLOODGATE_ACTIVITIES.APP_USAGE_TIME);\r\n                    \r\n                    // Log ReadyToPrompt to indicate app is ready for surveys\r\n                    await logActivity(FLOODGATE_ACTIVITIES.READY_TO_PROMPT);\r\n                    \r\n                    setHasTriggeredSurvey(true);\r\n                    \r\n                    if (!isProduction()) {\r\n                        console.log('Floodgate activities logged: AppUsageTime and ReadyToPrompt');\r\n                    }\r\n                    \r\n                } else if (!global_variables?.sso_id) {\r\n                    if (!isProduction()) {\r\n                        console.log(\"User is not logged in with SSO, floodgate will not be triggered\");\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                console.error('Failed to log Floodgate activities:', error);\r\n            }\r\n        };\r\n\r\n        logFloodgateActivities();\r\n    }, [isInitialized, logActivity, hasTriggeredSurvey]);\r\n\r\n    // Return null since we don't need to render anything\r\n    return null;\r\n};"],
  "mappings": "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CA,iBACA,mBACA,SACA,QACA,UACA,mBACA,qBACA,sBACA,UACA,iBACA,SACA,gBACA,WACA,UACA,WACA,SACA,UACA,YACA,mBACA,aACA,UACA,UACA,YACA,mBACA,mBACA,YACA,cACA,UACA,eACA,mBACA,cACA,UACA,SACA,YACA,aACA,eACA,WACA,YACA,YACA,YACA,eACA,iBACA,YACA,UACA,iBACA,gBACA,gBACA,SACA,YACA,cACA,aACA,cACA,aACA,cACA,SACA,cACA,qBACA,eACA,eACA,cACA,aACA,cACA,YACA,mBACA,WACA,gBACA,aACA,cACA,eACA,WACA,UACA,kBACA,gBACA,iBACA,iBACA,gBACA,eACA,gBACA,cACA,sBACA,sBACJ,CAAC,EAKgBO,GAAwBP,GAAY,CACjD,YACA,WACA,YACA,kBACA,MACA,YACA,SACA,UACA,KACA,OACA,MACA,OACA,QACA,WACA,QACA,YACA,aACA,MACJ,CAAC,EAKgBQ,GAAsBR,GAAY,CAC/C,SACA,WACA,UACA,YACA,UACJ,CAAC,EAKgBS,GAAwBT,GAAYO,GAAuBD,GAAmBE,EAAmB,EAKjGE,GAAkBV,GAAYS,GAAuB,CAClE,MACJ,CAAC,EAKgBE,GAAkBX,GAAYS,GAAuB,CAClE,SACA,OACA,QACA,UACA,MACA,OACJ,CAAC,EAKgBG,GAAkBZ,GAAYW,GAAiB,CAC5D,QACJ,CAAC,EAKgBE,GAAeb,GAAYS,GAAuB,CAC/D,OACJ,CAAC,EAKgBK,GAAed,GAAYS,GAAuB,CAC/D,OACJ,CAAC,EAKgBM,GAAmBf,GAAYS,GAAuB,CACnE,WACA,OACA,WACA,QACA,MACA,SACA,MACJ,CAAC,EAKgBO,GAAiBhB,GAAYS,GAAuB,CACjE,UACJ,CAAC,EAKgBQ,GAAmBjB,GAAYS,GAAuB,CACnE,YACA,WACA,OACA,aACA,cACA,aACA,iBACA,aACA,OACA,OACJ,CAAC,EAKgBS,GAAkBlB,GAAYiB,GAAkB,CAC7D,SACA,MACA,cACA,iBACA,eACA,UACA,UACA,OACA,SACA,YACA,OACA,MACA,YACA,MACA,YAC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CA,QACA,MACA,OACA,KACA,WACA,SACA,SACA,IACA,UACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,UACA,SACA,SACA,QACA,SACA,SACA,OACA,SACA,SACA,QACA,MACA,UACA,MACA,QACA,QACA,KACA,WACA,WACA,QACA,KACA,QACA,OACA,KACA,QACA,KACA,IACA,KACA,MACA,QACA,KAAK,CACG,EAEG4E,GAAM5E,GAAO,CACxB,MACA,IACA,WACA,cACA,eACA,eACA,gBACA,mBACA,SACA,WACA,OACA,OACA,UACA,SACA,OACA,IACA,QACA,WACA,QACA,QACA,OACA,iBACA,SACA,OACA,WACA,QACA,OACA,UACA,UACA,WACA,iBACA,OACA,OACA,QACA,SACA,SACA,OACA,WACA,QACA,OACA,QACA,OACA,OAAO,CACC,EAEG6E,GAAa7E,GAAO,CAC/B,UACA,gBACA,sBACA,cACA,mBACA,oBACA,oBACA,iBACA,eACA,UACA,UACA,UACA,UACA,UACA,iBACA,UACA,UACA,cACA,eACA,WACA,eACA,qBACA,cACA,SACA,cAAc,CACN,EAMG8E,GAAgB9E,GAAO,CAClC,UACA,gBACA,SACA,UACA,YACA,mBACA,iBACA,gBACA,gBACA,gBACA,QACA,YACA,OACA,eACA,YACA,UACA,gBACA,SACA,MACA,aACA,UACA,KAAK,CACG,EAEG+E,GAAS/E,GAAO,CAC3B,OACA,WACA,SACA,UACA,QACA,SACA,KACA,aACA,gBACA,KACA,KACA,QACA,UACA,WACA,QACA,OACA,KACA,SACA,QACA,SACA,OACA,OACA,UACA,SACA,MACA,QACA,MACA,SACA,aACA,aAAa,CACL,EAIGgF,GAAmBhF,GAAO,CACrC,UACA,cACA,aACA,WACA,YACA,UACA,UACA,SACA,SACA,QACA,YACA,aACA,iBACA,cACA,MAAM,CACE,EAEGiF,GAAOjF,GAAO,CAAC,OAAO,CAAU,ECpRhC2E,GAAO3E,GAAO,CACzB,SACA,SACA,QACA,MACA,iBACA,eACA,uBACA,WACA,aACA,UACA,SACA,UACA,cACA,cACA,UACA,OACA,QACA,QACA,QACA,OACA,UACA,WACA,eACA,SACA,cACA,WACA,WACA,UACA,MACA,WACA,0BACA,wBACA,WACA,YACA,UACA,eACA,OACA,MACA,UACA,SACA,SACA,OACA,OACA,WACA,KACA,YACA,YACA,QACA,OACA,QACA,OACA,OACA,UACA,OACA,MACA,MACA,YACA,QACA,SACA,MACA,YACA,WACA,QACA,OACA,QACA,UACA,aACA,SACA,OACA,UACA,UACA,cACA,cACA,UACA,gBACA,sBACA,SACA,UACA,UACA,aACA,WACA,MACA,WACA,MACA,WACA,OACA,OACA,UACA,aACA,QACA,WACA,QACA,OACA,QACA,OACA,UACA,QACA,MACA,SACA,OACA,QACA,UACA,WACA,QACA,YACA,OACA,SACA,SACA,QACA,QACA,OACA,QACA,MAAM,CACE,EAEG4E,GAAM5E,GAAO,CACxB,gBACA,aACA,WACA,qBACA,YACA,SACA,gBACA,gBACA,UACA,gBACA,iBACA,QACA,OACA,KACA,QACA,OACA,gBACA,YACA,YACA,QACA,sBACA,8BACA,gBACA,kBACA,KACA,KACA,IACA,KACA,KACA,kBACA,YACA,UACA,UACA,MACA,WACA,YACA,MACA,WACA,OACA,eACA,YACA,SACA,cACA,cACA,gBACA,cACA,YACA,mBACA,eACA,aACA,eACA,cACA,KACA,KACA,KACA,KACA,aACA,WACA,gBACA,oBACA,SACA,OACA,KACA,kBACA,KACA,MACA,YACA,IACA,KACA,KACA,KACA,KACA,UACA,YACA,aACA,WACA,OACA,eACA,iBACA,eACA,mBACA,iBACA,QACA,aACA,aACA,eACA,eACA,cACA,cACA,mBACA,YACA,MACA,OACA,QACA,SACA,OACA,MACA,OACA,aACA,SACA,WACA,UACA,QACA,SACA,cACA,SACA,WACA,cACA,OACA,aACA,sBACA,mBACA,eACA,SACA,gBACA,sBACA,iBACA,IACA,KACA,KACA,SACA,OACA,OACA,cACA,YACA,UACA,SACA,SACA,QACA,OACA,kBACA,QACA,mBACA,mBACA,eACA,cACA,eACA,cACA,aACA,eACA,mBACA,oBACA,iBACA,kBACA,oBACA,iBACA,SACA,eACA,QACA,eACA,iBACA,WACA,cACA,UACA,UACA,YACA,mBACA,cACA,kBACA,iBACA,aACA,OACA,KACA,KACA,UACA,SACA,UACA,aACA,UACA,aACA,gBACA,gBACA,QACA,eACA,OACA,eACA,mBACA,mBACA,IACA,KACA,KACA,QACA,IACA,KACA,KACA,IACA,YAAY,CACJ,EAEG+E,GAAS/E,GAAO,CAC3B,SACA,cACA,QACA,WACA,QACA,eACA,cACA,aACA,aACA,QACA,MACA,UACA,eACA,WACA,QACA,QACA,SACA,OACA,KACA,UACA,SACA,gBACA,SACA,SACA,iBACA,YACA,WACA,cACA,UACA,UACA,gBACA,WACA,WACA,OACA,WACA,WACA,aACA,UACA,SACA,SACA,cACA,gBACA,uBACA,YACA,YACA,aACA,WACA,iBACA,iBACA,YACA,UACA,QACA,OAAO,CACR,EAEYkF,GAAMlF,GAAO,CACxB,aACA,SACA,cACA,YACA,aAAa,CACL,EC/WGmF,GAAgBlF,GAAK,2BAA2B,EAChDmF,GAAWnF,GAAK,uBAAuB,EACvCoF,GAAcpF,GAAK,eAAe,EAClCqF,GAAYrF,GAAK,8BAA8B,EAC/CsF,GAAYtF,GAAK,gBAAgB,EACjCuF,GAAiBvF,GAC5B,oGAEWwF,GAAoBxF,GAAK,uBAAuB,EAChDyF,GAAkBzF,GAC7B,+DAEW0F,GAAe1F,GAAK,SAAS,EAC7B2F,GAAiB3F,GAAK,0BAA0B,uMCmBvD4F,GAAY,CAChBlC,QAAS,EACTmC,UAAW,EACXb,KAAM,EACNc,aAAc,EACdC,gBAAiB,EACjBC,WAAY,EACZC,uBAAwB,EACxBC,QAAS,EACTC,SAAU,EACVC,aAAc,GACdC,iBAAkB,GAClBC,SAAU,IAGNC,GAAY,UAAA,CAChB,OAAO,OAAOC,OAAW,IAAc,KAAOA,MAChD,EAUMC,GAA4B,SAChCC,EACAC,EAAoC,CAE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",
  "names": ["require_object_assign", "__commonJSMin", "exports", "module", "getOwnPropertySymbols", "hasOwnProperty", "propIsEnumerable", "toObject", "val", "shouldUseNative", "test1", "test2", "i", "order2", "n", "test3", "letter", "err", "target", "source", "from", "to", "symbols", "s", "key", "require_react_production_min", "__commonJSMin", "exports", "l", "n", "p", "q", "r", "t", "u", "v", "w", "x", "y", "a", "z", "b", "c", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "e", "d", "k", "h", "g", "f", "m", "K", "L", "escape", "M", "N", "O", "P", "Q", "R", "S", "T", "require_react", "__commonJSMin", "exports", "module", "require_scheduler_production_min", "__commonJSMin", "exports", "f", "g", "h", "k", "l", "p", "q", "t", "u", "w", "a", "b", "x", "y", "z", "A", "B", "C", "D", "E", "F", "G", "H", "c", "d", "e", "I", "J", "K", "m", "n", "v", "r", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "require_scheduler", "__commonJSMin", "exports", "module", "require_react_dom_production_min", "__commonJSMin", "exports", "aa", "m", "r", "y", "a", "b", "c", "ba", "ca", "da", "ea", "fa", "ha", "ia", "ja", "ka", "la", "ma", "d", "na", "B", "e", "f", "g", "D", "oa", "pa", "qa", "ra", "sa", "ta", "ua", "wa", "xa", "ya", "za", "Aa", "Ba", "Ca", "Da", "Ea", "Fa", "Ga", "Ha", "Ia", "Ja", "E", "Ka", "La", "Ma", "Na", "Oa", "Pa", "k", "h", "Qa", "Ra", "Sa", "Ta", "Ua", "Va", "Wa", "Xa", "Ya", "Za", "$a", "ab", "bb", "cb", "db", "eb", "fb", "gb", "hb", "ib", "jb", "kb", "lb", "mb", "nb", "ob", "pb", "qb", "rb", "sb", "tb", "ub", "vb", "wb", "xb", "yb", "zb", "Ab", "Bb", "Cb", "Db", "Eb", "Fb", "Gb", "Hb", "Ib", "Jb", "Kb", "Lb", "Mb", "Nb", "Ob", "Pb", "Qb", "Rb", "n", "Sb", "Tb", "Ub", "Vb", "Wb", "Xb", "Yb", "Zb", "$b", "ac", "bc", "cc", "dc", "ec", "fc", "gc", "hc", "ic", "jc", "kc", "lc", "mc", "nc", "oc", "pc", "qc", "rc", "sc", "tc", "uc", "vc", "wc", "xc", "yc", "zc", "Ac", "Bc", "Cc", "Dc", "Ec", "Fc", "Gc", "Hc", "Ic", "Jc", "Kc", "Lc", "Mc", "Nc", "Oc", "Pc", "Qc", "F", "Rc", "Sc", "Tc", "Uc", "Vc", "Wc", "Xc", "Yc", "Zc", "$c", "ad", "bd", "cd", "dd", "ed", "fd", "gd", "hd", "id", "jd", "kd", "ld", "md", "nd", "od", "pd", "qd", "rd", "sd", "td", "ud", "vd", "wd", "xd", "yd", "Ad", "zd", "Bd", "Cd", "Dd", "Ed", "Fd", "Gd", "Hd", "Id", "Jd", "Kd", "Ld", "Md", "Nd", "Od", "Pd", "Qd", "Rd", "Sd", "Td", "Ud", "Vd", "Wd", "Xd", "Yd", "Zd", "$d", "ae", "be", "ce", "de", "ee", "fe", "ge", "he", "ie", "je", "ke", "le", "me", "ne", "oe", "pe", "qe", "re", "se", "te", "ue", "ve", "we", "ye", "ze", "xe", "Ae", "Be", "Ce", "De", "Ee", "Fe", "Ge", "He", "Ie", "Je", "Ke", "Le", "Me", "Ne", "Oe", "Pe", "Qe", "Re", "Se", "Te", "Ue", "Ve", "We", "Xe", "Ye", "Ze", "G", "$e", "af", "bf", "cf", "df", "x", "w", "z", "u", "t", "q", "v", "ef", "ff", "gf", "hf", "J", "K", "Q", "L", "jf", "kf", "lf", "mf", "nf", "of", "pf", "qf", "rf", "sf", "tf", "uf", "vf", "wf", "xf", "yf", "zf", "Af", "Bf", "H", "I", "Cf", "M", "N", "Df", "Ef", "Ff", "Gf", "Hf", "If", "Jf", "Kf", "Lf", "Mf", "Nf", "Of", "Pf", "Qf", "Rf", "Sf", "Tf", "Uf", "Vf", "Wf", "Xf", "Yf", "Zf", "$f", "ag", "bg", "cg", "dg", "O", "eg", "fg", "gg", "hg", "ig", "jg", "kg", "lg", "mg", "ng", "og", "pg", "qg", "rg", "sg", "tg", "ug", "vg", "wg", "xg", "yg", "zg", "Ag", "Bg", "Cg", "A", "p", "C", "Dg", "Eg", "Fg", "Gg", "Kg", "Hg", "Ig", "Jg", "Lg", "Mg", "Ng", "Og", "Pg", "Qg", "Rg", "Sg", "Tg", "Ug", "Vg", "Wg", "Xg", "l", "Yg", "Zg", "$g", "ah", "bh", "ch", "dh", "eh", "fh", "gh", "hh", "P", "ih", "jh", "kh", "lh", "mh", "nh", "oh", "ph", "qh", "rh", "sh", "th", "uh", "vh", "wh", "xh", "R", "S", "T", "yh", "zh", "Ah", "Bh", "Ch", "Dh", "Eh", "Fh", "Gh", "Hh", "Ih", "Jh", "Kh", "Lh", "Mh", "Nh", "U", "Oh", "Ph", "Qh", "Rh", "Sh", "Th", "Uh", "Vh", "Wh", "Xh", "Yh", "Zh", "$h", "ai", "bi", "ci", "di", "ei", "fi", "gi", "hi", "ii", "ji", "ki", "li", "mi", "ni", "oi", "pi", "qi", "ri", "si", "ti", "ui", "vi", "wi", "xi", "yi", "zi", "Ai", "Bi", "Ci", "Di", "Ei", "Fi", "Gi", "V", "Hi", "Ii", "W", "Ji", "Ki", "Li", "Mi", "Ni", "Oi", "Pi", "Qi", "Ri", "Si", "Ti", "Ui", "Vi", "Wi", "Xi", "Yi", "Zi", "$i", "aj", "bj", "cj", "dj", "ej", "fj", "gj", "hj", "ij", "jj", "kj", "lj", "mj", "nj", "oj", "pj", "X", "Y", "qj", "rj", "sj", "tj", "uj", "vj", "wj", "Z", "xj", "yj", "zj", "Aj", "Bj", "Cj", "Dj", "Ej", "Fj", "Gj", "Hj", "Ij", "Jj", "Kj", "Lj", "Mj", "Nj", "Oj", "Pj", "Qj", "Rj", "Sj", "Tj", "Uj", "Vj", "Wj", "Xj", "Yj", "Zj", "va", "ak", "bk", "ck", "dk", "ek", "fk", "gk", "hk", "ik", "jk", "kk", "lk", "mk", "nk", "ok", "pk", "qk", "rk", "sk", "tk", "uk", "vk", "wk", "xk", "yk", "require_react_dom", "__commonJSMin", "exports", "module", "checkDCE", "err", "require_react_jsx_runtime_production_min", "__commonJSMin", "exports", "f", "g", "h", "m", "n", "p", "q", "c", "a", "k", "b", "d", "e", "l", "require_jsx_runtime", "__commonJSMin", "exports", "module", "require_ISurveyInfo", "__commonJSMin", "exports", "SurveyInfoBusinessLevel", "require_IActivityListener", "__commonJSMin", "exports", "ActivityName", "require_ISurvey", "__commonJSMin", "exports", "SurveyType", "require_ISurveyComponent", "__commonJSMin", "exports", "require_IEcsAdapter", "__commonJSMin", "exports", "require_IFloodgateSettingIdMap", "__commonJSMin", "exports", "require_IFloodgateStorageProvider", "__commonJSMin", "exports", "FloodgateStorageProviderFileType", "require_IFloodgateStringProvider", "__commonJSMin", "exports", "require_IMultipleChoiceComponent", "__commonJSMin", "exports", "require_IPrompt", "__commonJSMin", "exports", "require_INlqsSurvey", "__commonJSMin", "exports", "require_INpsSurvey", "__commonJSMin", "exports", "require_ICVSurvey", "__commonJSMin", "exports", "require_IDynamicUxClient", "__commonJSMin", "exports", "require_IGovernanceServiceClient", "__commonJSMin", "exports", "GovernanceServiceSurveyType", "GovernanceServiceClientState", "require_IModels", "__commonJSMin", "exports", "EcsConfigType", "require_Api", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "__exportStar", "p", "require_ISurveyEvent", "__commonJSMin", "exports", "require_IUxSchema", "__commonJSMin", "exports", "require_IQuestion", "__commonJSMin", "exports", "QuestionType", "require_IBranchingRules", "__commonJSMin", "exports", "ConditionType", "ConditionSourceType", "BranchingTargetType", "require_IUxSchemaAdditionalCapabilities", "__commonJSMin", "exports", "IUxSchemaAdditionalCapabilitiesTypes", "require_SurveyRestrictions", "__commonJSMin", "exports", "_a", "ISurvey_1", "require_UxSchema", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "__exportStar", "p", "require_CampaignDefinitions", "__commonJSMin", "exports", "ICampaignDefinitions", "require_GovernedChannel", "__commonJSMin", "exports", "GovernedChannelType", "getDefault", "require_IDynamicUxCommonInitOptions", "__commonJSMin", "exports", "require_IFloodgateHostPlatform", "__commonJSMin", "exports", "IFloodgateHostPlatform", "require_AlignmentType", "__commonJSMin", "exports", "AlignmentType", "require_ISurveyCSSParams", "__commonJSMin", "exports", "require_ManifestType", "__commonJSMin", "exports", "AuthenticationType", "require_dist", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "__exportStar", "p", "CampaignDefinitions_1", "GovernedChannel_1", "IFloodgateHostPlatform_1", "require_SyncTasks", "__commonJSMin", "exports", "err", "fromThenable", "thenable", "deferred", "Defer", "value", "x", "isThenable", "object", "isCancelable", "run", "trier", "catcher", "e", "asyncCallbacks", "useSetImmediate", "asyncCallback", "callback", "resolveAsyncCallbacks", "savedCallbacks", "i", "Internal", "SyncTask", "set", "callbackWillChain", "_this", "task", "context", "successFunc", "errorFunc", "func", "enabled", "obj", "resolve", "message", "rejectedTasks", "rejectedTask", "callbacks", "promise", "ret", "r", "reject", "all", "items", "Resolved", "outTask", "countRemaining", "foundError", "results", "val", "item", "checkFinish", "index", "res", "Rejected", "race", "hasSettled", "raceTimer", "timeMs", "timerDef", "token", "adaptedPromise", "resp", "require_SubscribableEvent", "__commonJSMin", "exports", "SubscriptionToken", "_event", "_callback", "SubscribableEvent", "_allowStopPropagation", "_this", "args", "_i", "subs", "i", "ret", "callback", "value", "require_AllowBackgroundFetchData", "__commonJSMin", "exports", "SyncTasks", "AllowBackgroundFetchData", "isAllowed", "deferral", "require_AppActiveData", "__commonJSMin", "exports", "SyncTasks", "AppActiveData", "isActive", "deferral", "require_Models", "__commonJSMin", "exports", "EcsConfigType", "require_Cache", "__commonJSMin", "exports", "subscribableevent_1", "SyncTasks", "Models_1", "Cache", "_config", "_this", "_a", "databaseInterface", "configsToFetch", "dbFetchPromises", "_loop_1", "configType", "this_1", "ecsConfig", "_i", "configsToFetch_1", "oldEcsConfig", "currentEcsConfig", "require_Config", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "Config", "config", "configsToFetch", "fetchTimeout", "require_utils", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "cond", "message", "value", "func", "args", "_i", "e", "array", "res", "key", "_a", "require_ExponentialTime", "__commonJSMin", "exports", "utils_1", "ExponentialTime", "_initialTime", "_maxTime", "_growFactor", "_jitterFactor", "delay", "res", "require_SimpleWebRequest", "__commonJSMin", "exports", "__extends", "extendStatics", "d", "b", "p", "__", "__assign", "t", "s", "i", "SyncTasks", "utils_1", "ExponentialTime_1", "WebRequestPriority", "ErrorHandlingType", "isJsonContentType", "ct", "isFormContentType", "isFormDataContentType", "callback", "timeoutMs", "id", "DefaultErrorHandler", "webRequest", "errResp", "requestQueue", "blockedList", "executingList", "hungRequestCleanupTimer", "onLoadErrorSupportStatus", "timeoutSupportStatus", "SimpleWebRequestBase", "_action", "_url", "options", "_getHeaders", "_blockRequestUntil", "_loop_1", "req", "blockPromise", "SimpleWebRequest", "err", "expression", "message", "_this", "openError", "timeoutSupported_1", "onLoadErrorSupported", "acceptType", "responseType", "responseTypeError", "nextHeaders", "headersCheck", "key", "value", "headerLower", "contentType", "sendData", "xhr", "xhrRequestHeaders", "val", "params_1", "param", "formData_1", "params_2", "newUrl", "headers", "newPriority", "index", "request", "_super", "action", "url", "getHeaders", "blockRequestUntil", "errorStatusText", "statusCode", "statusText", "e", "body", "responseParsingException", "headerLines", "line", "check", "ex", "resp", "handleResponse", "retry", "require_GenericRestClient", "__commonJSMin", "exports", "__assign", "t", "s", "i", "p", "utils_1", "SimpleWebRequest_1", "GenericRestClient", "endpointUrl", "apiPath", "action", "objToPost", "givenOptions", "_this", "options", "finalUrl", "response", "resp", "objToPatch", "objToPut", "objToDelete", "require_SimpleRestClients", "__commonJSMin", "exports", "__export", "m", "p", "require_simplerestclients", "__commonJSMin", "exports", "module", "require_TelemetryEventBase", "__commonJSMin", "exports", "TelemetryEventBase", "attributes", "require_TelemetryEvents", "__commonJSMin", "exports", "__extends", "extendStatics", "d", "b", "p", "__", "TelemetryEventBase_1", "EcsConfigFetchResponse", "_super", "_responseTime", "_responseCode", "_fetchAttempts", "_hasValidToken", "_serverEndpoint", "_fetchDurationValid", "_cacheAvailable", "_responseSize", "_configAge", "_configExpired", "_fetchStart", "_fetchEnd", "_isUserConfig", "_etag", "_timedOut", "_responseParsingException", "_errorMessage", "_this", "attributes", "require_RestClient", "__commonJSMin", "exports", "__extends", "extendStatics", "d", "b", "p", "__", "__assign", "t", "s", "i", "simplerestclients_1", "SyncTasks", "Models_1", "TelemetryEvents", "ForceFetchTimeout", "EcsExpirationFallbackDuration", "EcsFetchDurationLimit", "EcsMinFetchTimeout", "lastResponseTime", "currentRequestTime", "EcsFetcher", "_super", "url", "_config", "_skypeTokenData", "_appActiveData", "_allowBackgroundFetchData", "_etag", "_getUserConfig", "parameters", "_this", "config", "paramList", "key", "options", "configType", "headers", "timeout", "EcsClient", "_telemetryManager", "oldConfig", "userConfig", "urls", "deferred", "fetchAttempts", "callConfigServer", "etag", "fetcher", "res", "eTagHeader", "expirationHeader", "responseTimeInfo", "updatedExpiration", "ecsData", "e", "errorInfo", "maxRefetchAttempts", "forceFetchTime", "responseDate", "clockSkew", "headerExpirationTime", "match", "fetchDelayMs", "err", "require_Scheduler", "__commonJSMin", "exports", "Models_1", "RestClient_1", "Scheduler", "_config", "_skypeTokenData", "_cache", "appActiveData", "allowBackgroundFetchData", "telemetryManager", "_this", "configType", "_a", "config", "cachedConfig", "configExpirationMs", "bypassPause", "parameters", "ecsConfig", "_b", "_i", "_c", "cachedData", "require_SkypeTokenData", "__commonJSMin", "exports", "subscribableevent_1", "SyncTasks", "SkypeTokenData", "initialData", "deferral", "tokenData", "token", "mem", "next", "require_TelemetryManager", "__commonJSMin", "exports", "subscribableevent_1", "TelemetryManager", "_cache", "event", "eventName", "eventData", "telemetryEnabled", "clientTelemetryConfig", "ecsConfig", "config", "require_EcsClient", "__commonJSMin", "exports", "AllowBackgroundFetchData_1", "AppActiveData_1", "Cache_1", "Config_1", "Models", "Scheduler_1", "SkypeTokenData_1", "TelemetryManager_1", "EcsClient", "config", "_this", "_a", "cacheConfig", "allowBackgroundFetch", "skypeToken", "skypeTokenExpiration", "active", "types", "fetchTimeout", "timeAdd", "date", "interval", "units", "exports", "isDate", "input", "isEnumValue", "value", "isNumber", "isNOU", "isObject", "isFunction", "isArray", "isString", "isBoolean", "getDistantPast", "getDistantFuture", "addSecondsWithoutOverflow", "seconds", "subtractSecondsWithoutOverflow", "milliseconds", "LANGUAGE_AND_SCRIPT_TAG_PATTERN", "isValidLanguageSubTag", "subTag", "extractedSubTag", "extractLanguageSubtag", "language", "matches", "guid", "randomHex4", "makeArrayFromObjectValuesSortedByKeyString", "object", "keys", "values", "id", "key", "stringToDate", "newDate", "overrideValues", "sourceObject", "targetobject", "result", "field", "isUtcDatetimeString", "supportedUtcRegex", "dateToShortUtcString", "pad", "n", "fyShuffle", "arrIn", "lastNonShuffledElement", "pickIndex", "temp", "isValidUserId", "supportedUserIdRegex", "safeParseObject", "serializedValue", "defaultValue", "parsedObject", "e", "findHighestPriorityDefinition", "definitions", "hasLowerPriorityDefinitions", "maxPriorityDefinition", "prev", "cur", "curPriority", "prevPriority", "TelemetryEvent", "_a", "class_1", "_b", "class_2", "_c", "class_3", "_d", "class_4", "_e", "class_5", "_f", "class_6", "_g", "class_7", "_h", "class_8", "_j", "class_9", "_k", "class_10", "_l", "class_11", "_m", "class_12", "_o", "class_13", "_p", "class_14", "_q", "class_15", "_r", "class_16", "_s", "class_17", "_t", "class_18", "_u", "class_19", "_v", "class_20", "_w", "class_21", "_x", "class_22", "_y", "class_23", "_z", "class_24", "_0", "class_25", "_1", "class_26", "_2", "class_27", "_3", "class_28", "_4", "class_29", "_5", "class_30", "_6", "class_31", "_7", "class_32", "_8", "class_33", "_9", "class_34", "_10", "class_35", "_11", "class_36", "_12", "class_37", "_13", "class_38", "_14", "class_39", "_15", "class_40", "_16", "class_41", "_17", "class_42", "_18", "class_43", "_19", "class_44", "_20", "class_45", "_21", "class_46", "_22", "class_47", "_23", "class_48", "_24", "class_49", "exports", "DefaultFloodgateTelemetryLogger", "campaignId", "surveyId", "surveyType", "surveyActivityInfo", "additionalSurveyInfo", "treatmentType", "isUxSchemaPresent", "errorMessage", "eventId", "properties", "message", "data", "_i", "TelemetryLogger", "logger", "exports", "Constants_1", "Utils", "TelemetryLogger_1", "isNOU", "isNumber", "isArray", "commonComparatorTypes", "UserFact", "input", "rawUserFactSpec", "supportedComparatorTypes", "isComparatorTypeSupported", "userFactType", "assertNever", "latency", "factType", "rawUserFact", "compareBooleanValues", "compareDateTimeUTCValues", "compareNumberValues", "compareStringValues", "compareTimeIntervalValues", "compareListValues", "error", "evaluateFactCandidacy", "exports", "latencyType", "latencyDurationInSeconds", "userFact", "userFactTime", "userFactTimeInMilliseconds", "currentTimeInMilliseconds", "userFactSpecValue", "comparator", "rawUserFactValueInBoolean", "compareValues", "rawUserFactValueInMilliseconds", "isAValidNumber", "userFactSpecValueInMilliseconds", "rawUserFactValueInNumber", "intervalType", "currentDateDiff", "secondInMilliseconds", "userFactRawValue", "isFactValueInTargetItem", "_", "userFactTargetValues", "factValue_1", "specValues", "specValue", "numberValue", "value", "rawUserFactName", "errorMessage", "UserFact_1", "exports", "input", "userFacts", "key", "userFactInput", "floodgate_shared_typings_1", "Constants_1", "UserFactHelper_1", "Utils", "TelemetryLogger_1", "getDistantFuture", "isBoolean", "isNOU", "isNumber", "isString", "isUtcDatetimeString", "stringToDate", "dynamicUxSchemaVariables", "CampaignLanguageRange", "input", "result", "CampaignLanguageRangeLanguageSubtag", "exports", "_super", "__extends", "language", "extractedLanguageSubTag", "CampaignScope", "CampaignScopeAny", "CampaignScopeEnvironmentCrossProduct", "CampaignScopeUserFactAny", "CampaignScopeUserFactAll", "languageRanges", "key", "readRange", "environmentProvider", "range", "userFactsProvider", "_this", "userFact", "rawUserFact", "mismatchedFacts", "mismatchedNames", "CampaignDuration", "CampaignDurationTimeInterval", "CampaignDurationSingleBuildChange", "CampaignAdditionalDataRequested", "additionalDataRequested", "_i", "additionalDataRequested_1", "additionalData", "CampaignDistribution", "CampaignDistributionRamp", "CampaignNominationScheme", "CampaignNominationSchemeRatioPercentage", "nominationTimIntervalSeconds", "soonestStartTime", "surveyStartTime", "didUserActivateSurvey", "rand", "CampaignSurveyEvent", "CampaignSurveyEventCountedActivity", "CampaignSurveyEventCountedActivitySequence", "sequence", "readActivity", "CampaignSurveyContent", "optionalComponents", "CampaignSurveyContentPrompt", "CampaignSurveyContentRating", "CampaignSurveyContentComment", "CampaignSurveyContentMultipleChoice", "CampaignSurveyContentIntercept", "CampaignSurveyContentCVSurvey", "CampaignSurveyMetadata", "CampaignSurveyTemplate", "validationError", "_a", "CampaignSurveyTemplateNps5PointStatic", "_b", "CampaignSurveyTemplateNps11PointStatic", "_c", "CampaignSurveyTemplateFps", "_d", "CampaignSurveyTemplateNlqs", "_e", "CampaignSurveyTemplateNps", "_f", "CampaignSurveyTemplateGenericMessagingSurface", "_g", "CampaignSurveyTemplateIntercept", "_h", "CampaignSurveyTemplateDialog", "pagesValidityError", "targetPage", "rule", "condition", "this_1", "questionIndex", "question", "likertQuestion", "target", "pageTarget", "index", "overrideTarget_1", "this_2", "overrideTargetQuestion", "_j", "_k", "schemaPages", "schemaPages_1", "page", "questionError", "CampaignDefinition", "FilterValidCampaignDefinitions", "campaignDefinitions", "badIndexes", "i", "definition", "newDefinition", "error", "FileSystemCampaignDefinitionProvider", "storage", "definitionString", "readDefinitions", "e", "definitions", "resolve", "reject", "DynamicCampaignDefinitionProvider", "storageProvider", "ecsResponse", "newEtag", "ecsCampaignDefinitions", "val", "filteredEcsCampaignDefinitions", "lastFetchTokenHash", "loggableEcsResponse", "__rest", "setDynamicUxSchemaVariables", "dynamicVariables", "SurveyStatCollection", "surveyId", "stats", "exports", "floodgate_shared_typings_1", "Constants_1", "StateProviderHelpers", "SurveyStatCollection_1", "Utils", "TelemetryLogger_1", "SurveyStatCollectionActivation", "_super", "__extends", "json", "statCollection", "readStats", "e", "object", "other", "stats", "key", "input", "rawStats", "now", "newStat", "SurveyActivationStats", "exports", "SurveyActivationStatsProviderFactory", "fileBasedStorage", "hostBasedStorage", "HostBasedSurveyActivationStatsProvider", "FileBasedSurveyActivationStatsProvider", "fileBasedStorageProvider", "surveyStatsFromHost", "surveyStatsFromFile", "surveyStatsCollections", "statsFromHost", "toBeUpdatedStats", "mergedStates", "toBeUpdatedStatsDictionary", "surveyId", "item", "statsCollection", "itemData", "dataString", "newStats", "storage", "readString", "surveyStatCollectionActivation", "writeString", "_a", "_b", "SurveyStatCollectionActivation_1", "ItemCollection", "key", "value", "item", "exports", "extractSettingItemValueSubString", "itemValue", "beginPos", "SETTING_DATA_OPEN_TAG", "endPos", "SETTING_DATA_CLOSE_TAG", "makeSettingItemValue", "MergeAndUpdateGovernedChannelStates", "previousStates", "currentStates", "stateCollections", "mergedStates", "toBeUpdatedStates", "previousState", "pos", "currentState", "i", "MergeAndUpdateCampaignStates", "current", "MergeAndUpdateSurveyActivationStats", "previousStats", "currentStats", "statsCollections", "mergedStats", "toBeUpdatedStats", "previousStatsDictionary", "currentStatsDictionary", "surveyId", "currentActivationStats", "previousActivationStats", "toBeUpdatedStatsDictionary", "toBeUpdated", "floodgate_shared_typings_1", "Constants_1", "StateProviderHelpers", "Utils", "TelemetryLogger_1", "GovernedChannelState", "type", "cooldownStartTime", "input", "result", "e", "exports", "GovernedChannelStateProviderFactory", "fileBasedStorage", "hostBasedStorage", "HostBasedGovernedChannelStateProvider", "FileBasedGovernedChannelStateProvider", "FileData", "statesFromHost", "statesFromFile", "StateCollections", "states", "_this", "toBeUpdatedStates", "mergedStates", "state", "stateValue", "settings", "key", "value", "dataString", "itemObject", "newState", "storage", "readString", "fileData", "result_1", "writeString", "Constants_1", "SurveyStatCollection_1", "Utils", "TelemetryLogger_1", "SurveyStatCollectionEventActivity", "_super", "__extends", "json", "statCollection", "readStats", "e", "object", "other", "stats", "key", "ourStats", "SurveyEventActivityStats", "resizedCounts", "i", "input", "rawStats", "now", "newStat", "exports", "val", "floodgate_shared_typings_1", "Utils_1", "isMultiLaunchSurvey", "surveyInfo", "maxLaunches", "exports", "isBusinessCriticalSurvey", "businessLevel", "isCriticalSurvey", "hasSurveyReachedMaxLaunchesPerSession", "surveyActivationStats", "surveyLaunchCountInSession", "_a", "maxLaunchesPerSession", "hasSurveyReachedMaxLaunches", "surveyLaunchCount", "ActivityTrackingContract", "surveyId", "trackingSet", "exports", "floodgate_shared_typings_1", "Constants_1", "StateProviderHelpers", "Utils", "TelemetryLogger_1", "getDistantPast", "isBoolean", "isDate", "isNOU", "isString", "isUtcDatetimeString", "stringToDate", "CampaignState", "campaignId", "lastNominationTime", "lastNominationBuildNumber", "deleteAfterSecondsWhenStale", "ForceCandidacy", "isCandidate", "didCandidateTriggerSurvey", "lastSurveyActivatedTime", "lastSurveyId", "lastSurveyStartTime", "lastSurveyExpirationTime", "lastCooldownEndTimeUtc", "input", "result", "e", "date", "cooldownSeconds", "isSurveyComplete", "exports", "CampaignStateProviderFactory", "fileBasedStorage", "hostBasedStorage", "HostBasedCampaignStateProvider", "FileBasedCampaignStateProvider", "FileData", "statesFromHost", "statesFromFile", "StateCollections", "campaignStates", "_this", "toBeUpdatedStates", "mergedStates", "state", "stateValue", "states", "settings", "key", "value", "dataString", "itemObject", "newState", "storage", "readString", "fileData", "result_1", "writeString", "ActivityTrackingData", "activity", "count", "isAggregate", "exports", "Utils_1", "ActivityTrackingSet", "isOrdered", "list", "activityListener", "surveyId", "activitiesInfoObject", "_i", "_a", "trackingData", "actualCount", "tempActivities", "exports", "ActivityTrackingData_1", "ActivityTrackingSet_1", "CountedActivityEvent", "data", "e", "trackingDataList", "exports", "CountedActivityEventData", "CountedActivitySequenceEvent", "_i", "_a", "countedActivityEventData", "countedActivityEvent", "CountedActivitySequenceEventData", "Utils", "SurveyMetadata", "data", "e", "exports", "Metadata", "floodgate_shared_typings_1", "FloodgateEngine_1", "Utils", "Survey", "surveyType", "transporter", "inputSchema", "exports", "floodgate_shared_typings_1", "Utils", "getDistantFuture", "getDistantPast", "isNOU", "isDate", "SurveyDataSource", "data", "parsed", "date", "additionalDataToCheck", "_i", "_a", "additionalData", "doc", "typeElement", "idElement", "surveyObject", "result", "SurveyDataSourceData", "exports", "floodgate_shared_typings_1", "Utils", "Survey_1", "SurveyDataSource_1", "isNOU", "DialogSurvey", "_super", "__extends", "data", "_this", "e", "baseData", "_componentType", "_doc", "DialogSurveyData", "exports", "floodgate_shared_typings_1", "CommentComponent", "data", "e", "userComment", "doc", "element", "result", "_a", "CommentComponentData", "exports", "floodgate_shared_typings_1", "CVSurveyComponent", "data", "e", "doc", "element", "result", "_a", "CVSurveyComponentData", "exports", "floodgate_shared_typings_1", "MultipleChoiceComponent", "data", "option", "i", "e", "selectedStates", "result", "element", "doc", "_a", "MultipleChoiceComponentData", "exports", "floodgate_shared_typings_1", "PromptComponent", "data", "e", "selected", "doc", "element", "result", "_a", "value", "PromptComponentData", "exports", "floodgate_shared_typings_1", "RatingComponent", "data", "rating", "e", "selected", "doc", "element", "result", "_a", "index", "RatingComponentData", "exports", "floodgate_shared_typings_1", "CommentComponent_1", "CVSurveyComponent_1", "MultipleChoiceComponent_1", "PromptComponent_1", "RatingComponent_1", "Utils", "Survey_1", "SurveyDataSource_1", "isNOU", "FpsSurvey", "_super", "__extends", "data", "_this", "_a", "_b", "_c", "_d", "_e", "e", "baseData", "sp", "surveyModel", "ratingValuesAscending", "availableOptions", "content", "contentValid", "_i", "value", "customString", "componentType", "doc", "element", "child", "result", "response", "actualStrings", "FpsSurveyData", "exports", "floodgate_shared_typings_1", "Utils", "Survey_1", "SurveyDataSource_1", "isNOU", "GenericMessagingSurfaceSurvey", "_super", "__extends", "data", "_this", "e", "baseData", "componentType", "doc", "GenericMessagingSurfaceSurveyData", "exports", "floodgate_shared_typings_1", "InterceptComponent", "data", "e", "doc", "_a", "InterceptComponentData", "exports", "floodgate_shared_typings_1", "InterceptComponent_1", "Utils", "Survey_1", "SurveyDataSource_1", "isNOU", "InterceptSurvey", "_super", "__extends", "data", "_this", "e", "baseData", "sp", "surveyModel", "content", "componentType", "doc", "InterceptSurveyData", "exports", "floodgate_shared_typings_1", "CommentComponent_1", "PromptComponent_1", "RatingComponent_1", "Utils", "Survey_1", "SurveyDataSource_1", "isNOU", "overrideValues", "NlqsSurvey", "_super", "__extends", "data", "_this", "e", "baseData", "sp", "surveyModel", "ratingValuesAscending", "content", "_i", "_a", "value", "customString", "componentType", "doc", "element", "child", "result", "NlqsSurveyData", "exports", "floodgate_shared_typings_1", "CommentComponent_1", "CVSurveyComponent_1", "PromptComponent_1", "RatingComponent_1", "Utils", "Survey_1", "SurveyDataSource_1", "isNOU", "overrideValues", "NpsSurvey", "_super", "__extends", "data", "_this", "_a", "_b", "_c", "_d", "_e", "e", "baseData", "sp", "surveyModel", "ratingValuesAscending", "content", "contentValid", "_i", "value", "customString", "componentType", "doc", "element", "child", "result", "actualStrings", "NpsSurveyData", "exports", "floodgate_shared_typings_1", "SurveyEvents_1", "SurveyMetadata_1", "DialogSurvey_1", "FpsSurvey_1", "GenericMessagingSurfaceSurvey_1", "InterceptSurvey_1", "NlqsSurvey_1", "NpsSurvey_1", "SurveyDataSource_1", "Utils", "CampaignDefinitionProvider_1", "dateToShortUtcString", "isNOU", "CampaignSurveyFactory", "state", "definition", "stringProvider", "surveyDataSource", "surveyModel", "surveyData", "eventModel", "eventData", "sequenceEventData", "_i", "_a", "event_1", "metadataModel", "metadata", "exports", "featureGateProvider", "setFeatureGateProvider", "provider", "exports", "getFeatureGateProvider", "Utils", "floodgate_shared_typings_1", "CampaignDefinitionProvider_1", "CampaignStateProvider_1", "CampaignSurveyFactory_1", "Constants_1", "FeatureGateProvider_1", "TelemetryLogger_1", "getDistantFuture", "getDistantPast", "isArray", "isNOU", "CampaignManager", "stateProvider", "definitionProviders", "stringProvider", "environmentProvider", "currentBuildNumber", "currentDate", "isPriorityEnabled", "userFactsProvider", "surveyCandidacyChecker", "logExperimentTrigger", "campaignTelemetrySamplingConfig", "messagingEnabled", "surveyEnabled", "_a", "_b", "state", "definition", "date", "buildNumber", "campaignCooldownDuration", "startDate", "endDate", "duration", "startBuild", "build", "triggerDetails", "error", "surveys", "prioritizedCampaigns", "activeCampaignIds", "key", "survey", "currentCampaignStates", "payload", "campaignId", "takenDate", "isSurveyComplete", "cooldownSeconds", "surveyInfo", "channelTypes", "_this", "resolve", "reject", "errReason", "states", "loadedDefinitions", "promises", "userFactsPromise", "_i", "i", "provider", "promise", "values", "campaignDefinitions", "setUserFacts", "userFacts", "loadMethod", "initialLoadSamplingRate", "loggedDefinitions", "_c", "governedChannelType", "isCampaignTypeEnabled", "index", "definitions", "disabledCampaigns", "channelCleared", "inScope", "nominated", "triggerDetail", "eventInfo", "samplingRate", "v", "loadedDefinitionsMap", "campaignTypeDisabledCampaigns", "loadedStates", "staleLoadedStates", "shouldRemove", "matchingTagCampaigns", "definitionTags", "tagId", "mapKey", "maxPriorityDefinition", "hasLowerPriorityDefinitions", "maxPriority", "current", "currentPriority", "lastSurveyId", "lastSurveyStartTime", "lastSurveyExpirationTime", "lastSurveyActivatedTime", "lastCooldownEndTimeUtc", "isCandidate", "newState", "updateNeeded", "exports", "FloodgateSettings", "object", "json", "exports", "ActivityTracker", "trackingSet", "i", "index", "sessionCount", "baselineCounts", "otherTrackers", "wasAlreadyActivatedThisSession", "indexList", "current", "increment", "startedLessThanThreshold", "startTime", "stopTime", "deltaMS", "diff", "ActivityIndex", "exports", "IndexedTracker", "exports", "ActivityTracker_1", "Constants_1", "IndexedTracker_1", "SurveyStatCollectionEventActivity_1", "Utils_1", "queuedActivities", "pendingActivityCount", "previousTrackedActivityMap", "SurveyActivityListener", "callback", "loggerCallback", "activityName", "increment", "context", "startTime", "stopTime", "activityTrackingContracts", "baseline", "duplicateCounter", "newMap", "trackedSurveyIds", "_i", "activityTrackingContracts_1", "activityTrackingContract", "trackingSet", "baselineStats", "baselineCounts", "currentIndexedTrackers", "currentBaselineIndex", "currentIndex", "_a", "_b", "trackingData", "_c", "_d", "tracker", "newTracker", "_e", "_f", "activityIndex", "indexedTracker", "telemetryLogger", "_this", "key", "activity", "surveyId", "indexedTrackers", "surveyIds", "surveyList", "indexedTrackers_1", "logType", "timestamp", "activityNames", "queuedActivity", "indices", "i", "indices_1", "index", "trackerSurveyId", "result", "target", "source", "exports", "Constants_1", "Utils_1", "TelemetryLogger_1", "HTTP_TRANSPORT_DEFAULT_TIMEOUT", "HttpTransport", "requestUrl", "retry", "timeout", "simpleRequestEnabled", "_this", "resolve", "reject", "timeBefore", "response", "serviceCallTime", "error", "headers", "useTimeout", "requestInit", "input", "init", "controller", "timeoutId", "exports", "floodgate_shared_typings_1", "Utils_1", "HttpTransport_1", "Constants_1", "TelemetryLogger_1", "isTranslationRequired", "survey", "locale", "currentLocale", "_a", "exports", "FloodgateSurveyCdnClient", "uiStringsLoadingTimeout", "retryLimit", "simpleRequestEnabled", "requestUrl", "httpTransport", "success", "timeBefore", "response", "serviceCallTime", "responseText", "jsonResponse", "e_1", "uiStringMap", "uxSchema", "promiseList", "errorList", "translatedResult", "__assign", "__spreadArrays", "index", "this_1", "result", "translatedRules", "indexRule", "rule", "translatedRule", "target", "translatedTarget_1", "overrideTargetQuestion", "question", "this_2", "schemaPage", "pageKey", "this_3", "translateObject", "questionType", "questionKey", "stringArray", "keyArray", "translatedString", "keyString", "resolve", "_reject", "GovernanceDecision", "exports", "CampaignBusinessLevel", "floodgate_shared_typings_1", "Utils", "GovernedChannel", "type", "name", "cooldownSeconds", "cooldownStartTime", "date", "exports", "floodgate_shared_typings_1", "GovernedChannel_1", "GovernedChannelStateProvider_1", "Utils", "isNOU", "DefaultChannelData", "name", "cooldownSeconds", "Governor", "channelStateProvider", "channelType", "channelData", "key", "channel", "type", "date", "channelStates", "channelState", "item", "defaultData", "newChannel", "_a", "exports", "Governor_1", "Api_1", "OrchestrationEngine", "governanceServiceClient", "governedChannelStateProvider", "appGovernanceProvider", "businessLevel", "governanceParams", "defaultDecision", "serviceResult", "_a", "governanceDecision", "campaignForm", "channels", "channelTypes", "channel", "governedChannelType", "refreshData", "channelType", "dateTime", "exports", "CampaignDefinitionProvider_1", "floodgate_shared_typings_1", "GovernedChannelStateProvider_1", "SurveyStatCollectionActivation_1", "SurveyStatCollectionEventActivity_1", "GovernanceUtils_1", "ActivityTrackingContract_1", "CampaignManager_1", "CampaignStateProvider_1", "FloodgateSettings_1", "SurveyActivityListener_1", "Constants_1", "Utils_1", "FloodgateSurveyCdnClient_1", "FeatureGateProvider_1", "Api_1", "OrchestrationEngine_1", "TelemetryLogger_1", "defaultSurveyActivityListener", "survey", "activityName", "globalSessionSurveyActivationCounts", "FloodgateEngine", "surveyClient", "activityListener", "launcherFactory", "onSurveyActivatedCallback", "storage", "orchestrationEngine", "surveyActivationStatsProvider", "transporterFactory", "campaignTelemetrySamplingConfig", "floodgateEngineConfig", "personalizerClient", "thisObj", "surveyId", "contextInfo", "buildVersion", "fileBasedStorageProvider", "hostBasedStorageProvider", "stringProvider", "environmentProvider", "campaignDefinitionProviders", "userFactsProvider", "governanceServiceClient", "isPriorityEnabled", "appGovernanceProvider", "logExperimentTrigger", "messagingEnabled", "surveyEnabled", "governedChannelStateProvider", "campaignStateProvider", "orchestrationEngine_1", "getSurveyCandidacyChecker", "surveyForm", "surveyCandidacyChecker", "client", "e", "channelTypes", "_this", "channelTypes_1", "resolve", "reject", "error", "status", "stats", "key", "surveyInfo", "statCollection", "previousStats", "updateCollection", "now", "this_1", "allActivities", "aggregateActivities_1", "nonAggregateActivities_2", "data", "i", "_i", "nonAggregateActivities_1", "activity", "pendingSurveys", "rejectCampaigns", "acceptCampaigns", "payload", "surveyList", "allCampaignDefinitionIDs", "allCandidateCampaignDefinitionIDs", "allCampaignDefinitions", "isSurveyAllowed", "surveyActivationStats", "campaignDefinition", "additionalSurveyInfo", "correspondingCampaignDefinition", "nominationPeriodNumber", "cooldownPeriodNumber", "percentageNumerator", "percentageDenominator", "candidateSurvey", "definitionsKey", "definition", "trackingContractList", "surveyList_1", "trackingContract", "activeSurveys", "surveys", "surveys_1", "tempSurvey", "initialTriggerSamplingRate", "_b", "_a", "governedChannelType", "launchSurvey", "refreshedSurveyActivationStats", "triggeredSurvey", "activityTrackingString", "isSurveyComplete", "surveyLevelCooldown", "governanceDecision", "_c", "serviceResult", "e_1", "governanceResponseTelemetry", "nextSurvey", "nextContextInfo", "fileType", "str", "launcher", "campaignId", "channel", "isLoadingSurveyCdnRequired", "governanceParams", "businessLevel", "cdnSimpleRequestEnabled", "floodgateSurveyCdnClient", "loadCdnPromise", "checkPermission", "cdnLoadResult", "mopResult", "isEnabled", "exports", "floodgate_shared_typings_1", "exports", "Utils", "FloodgateEngine_1", "TelemetryLogger_1", "require_types", "__commonJSMin", "exports", "exports", "CVSurveyPositionDefaults", "CVSurveySizeDefaults", "SmallScreenPosition", "getUserAgent", "isMobile", "userAgent", "exports", "isTestEnv", "parentElement", "SafeUtilFuncs", "keyValDictToString", "dict", "key", "arr", "searchTarget", "i", "str", "matchingSoFar", "j", "stringOrArray", "target", "_a", "Constants", "Util_1", "SurveyEmbed", "form_id", "base_url", "parent_element", "contextParams", "onCVEvent", "cancelButtonEnabled", "surveyIFrame", "iframeUrl", "url", "enableCancel", "urlParams", "_a", "queryParams", "__assign", "e", "additionalUrlParams", "paramKey", "name", "value", "exports", "Constants", "Util_1", "BaseStyleManager", "parentContainer", "cvSurveyOptionalConfigParams", "initialUiHostTheme", "alternateStyleTagId", "position", "_a", "zIndex", "_b", "bottom", "_c", "right", "_d", "newTheme", "targetHeight", "targetWidth", "oldStyleTag", "newStyleTag", "styleTag", "isDark", "theme", "NonResponsiveStyleManager", "_super", "__extends", "exports", "ResponsiveStyleManager", "SurveyEmbed_1", "Constants", "Util_1", "SurveyStyleManager_1", "surveyFocus", "surveyDispatcherTimeout", "pageWidthsStore", "pageIdsStore", "visitedPagesWidths", "registeredEventHandlers", "isPromptValueNo", "isAdditionalPromptValueNo", "isThankyouPageClosed", "pageNumber", "isMainContext", "subscribeEventHandler", "eventKey", "eventElement", "eventName", "eventHandler", "once", "internal", "unsubscribeEventHandler", "handlerInfo", "exports", "parentElementOrId", "onCVEvent", "contextParams", "cvSurveyOptionalConfigParams", "optionalIsMainContext", "renderCVSurveyTimeBefore", "wrappedOnCvEvent", "renderContext", "parent", "shouldContainerBeResponsive", "_a", "styleManagerArgs", "styleManager", "__spreadArrays", "setCVEventHandlers", "iframeElement", "createCloseButton", "error", "result", "safeWrapHandleSurveyEvent", "onSurveyEvent", "wrappedOnSurveyEvent", "key", "data", "formattedError", "nestedError", "formattedNestedError", "_b", "isNOU", "value", "createSurveyContainer", "parentDivName", "parentContainer", "parentElement", "contextParam", "windowMessageHandler", "iFrameEventHandler", "formatPages", "configString", "headerComponents", "pageWidths", "parsedWidths", "currWidth", "parsedPageIds", "handleCvVarInjection", "cssVars", "htmlDataAttrs", "injectRuntimeCssVars", "cssVarString", "injectRuntimeHtmlDataAttrs", "htmlDataAttrString", "getEventType", "eventData", "getIframeElement", "event", "timeOutEnabled", "setPageWidth", "isFormResponseBack", "targetWidth", "eventType", "surveyHeight", "surveyIFrame", "_d", "errorMsg", "_c", "hasSurveyDispatcher", "autoDismiss", "closeTriggerEvent", "closeCVSurvey", "e", "surveyDiv", "closeButton", "setCloseButtonEvents", "mouseEnterHandler", "mouseLeaveHandler", "clickHandler", "removeCloseButtonEvents", "callBack", "onCancelEventData", "updateOnCancelEventData", "pageId", "renderSurvey", "cancelButtonEnabled", "isSuccessful", "se", "renderInlineTimeBefore", "isThankyouPage", "closeTriggerEvent_1", "timeOutSeconds", "timerID_1", "iFrame", "surveyFocusHandler", "getPageInfo", "messages", "pages", "i", "questionAnswers", "pageType", "page", "pageHasResponse", "msg", "qa", "lastRespondedPage", "seenPages", "validatePromptValue", "subtitle", "answer", "shouldIncludeSurveyQuestionAnswer", "_currentQA", "getQuestionList", "currentMessage", "qaList", "j", "currentQA", "getSurveyQuestionAnswer", "getQuestionAnswers", "questionOptions", "opt", "__exportStar", "exports", "require_es6_promise", "__commonJSMin", "exports", "module", "objectOrFunction", "x", "type", "isFunction", "_isArray", "isArray", "len", "vertxNext", "customSchedulerFn", "asap", "callback", "arg", "queue", "flush", "scheduleFlush", "setScheduler", "scheduleFn", "setAsap", "asapFn", "browserWindow", "browserGlobal", "BrowserMutationObserver", "isNode", "isWorker", "useNextTick", "useVertxTimer", "useSetTimeout", "useMutationObserver", "iterations", "observer", "node", "useMessageChannel", "channel", "globalSetTimeout", "i", "attemptVertx", "vertx", "e", "__require", "then", "onFulfillment", "onRejection", "parent", "child", "noop", "PROMISE_ID", "makePromise", "_state", "invokeCallback", "subscribe", "resolve", "object", "Constructor", "promise", "_resolve", "PENDING", "FULFILLED", "REJECTED", "selfFulfillment", "cannotReturnOwn", "tryThen", "value", "fulfillmentHandler", "rejectionHandler", "handleForeignThenable", "thenable", "sealed", "error", "fulfill", "reason", "reject", "handleOwnThenable", "handleMaybeThenable", "maybeThenable", "originalThen", "originalResolve", "publishRejection", "publish", "_subscribers", "length", "subscribers", "settled", "detail", "hasCallback", "succeeded", "initializePromise", "resolver", "id", "nextId", "validationError", "Enumerator", "input", "entry", "c", "_then", "didError", "Promise", "state", "enumerator", "all", "entries", "race", "_", "_reject", "needsResolver", "needsNew", "constructor", "Promise$1", "Resolve", "Reject", "polyfill", "local", "P", "promiseToString", "require_auto", "__commonJSMin", "exports", "module", "require_package", "__commonJSMin", "exports", "module", "import_react", "import_react_dom", "import_react", "__GLOBAL__", "window", "global", "__NAMESPACE_PREFIX__", "getGlobalVar", "name", "defaultValue", "Symbol", "for", "DEFINITION_LOOKUP_TABLE", "getGlobalVar", "DATA_BUCKET_ATTR", "DATA_PRIORITY_ATTR", "SEQUENCE_HASH_LENGTH", "SEQUENCE_PREFIX", "DEBUG_SEQUENCE_SEPARATOR", "SEQUENCE_SIZE", "length", "LOOKUP_DEFINITIONS_INDEX", "LOOKUP_DIR_INDEX", "murmur2", "str", "h", "k", "i", "len", "padEndHash", "value", "hashLength", "length", "SEQUENCE_HASH_LENGTH", "i", "hashSequence", "classes", "dir", "sequenceIds", "SEQUENCE_PREFIX", "hash", "reduceToClassName", "classMap", "dir", "classString", "hashString", "propertyHash", "classNameMapping", "hasRTLClassName", "Array", "isArray", "className", "slice", "reduceToClassNameForSlots", "classesMapBySlot", "classNamesForSlots", "slotName", "slotClasses", "slotClassesHash", "sequenceHash", "hashSequence", "resultSlotClasses", "DEFINITION_LOOKUP_TABLE", "mergeClassesCachedResults", "mergeClasses", "dir", "resultClassName", "sequenceMatch", "sequencesIds", "Array", "arguments", "length", "containsResetClassName", "i", "className", "sequenceIndex", "indexOf", "SEQUENCE_PREFIX", "sequenceId", "substr", "SEQUENCE_SIZE", "slice", "mergeClassesResult", "undefined", "sequenceMappings", "sequenceMapping", "DEFINITION_LOOKUP_TABLE", "push", "LOOKUP_DEFINITIONS_INDEX", "LOOKUP_DIR_INDEX", "resultClassesMap", "Object", "assign", "apply", "concat", "atomicClasses", "classesMapHash", "reduceToClassName", "newSequenceHash", "hashSequence", "newClassName", "normalizeCSSBucketEntry", "entry", "Array", "isArray", "createIsomorphicStyleSheet", "styleElement", "bucketName", "priority", "elementAttributes", "__cssRulesForSSR", "DATA_BUCKET_ATTR", "DATA_PRIORITY_ATTR", "String", "attrName", "setAttribute", "insertRule", "rule", "sheet", "cssRules", "length", "push", "element", "Array", "from", "map", "cssRule", "cssText", "styleBucketOrdering", "styleBucketOrderingMap", "reduce", "acc", "cur", "j", "getStyleSheetKey", "bucketName", "media", "priority", "getStyleSheetForBucket", "bucketName", "targetDocument", "insertionPoint", "renderer", "metadata", "isMediaBucket", "media", "_a", "priority", "_b", "stylesheetKey", "getStyleSheetKey", "stylesheets", "tag", "createElement", "stylesheet", "createIsomorphicStyleSheet", "Object", "assign", "styleElementAttributes", "head", "insertBefore", "findInsertionPoint", "isSameInsertionKey", "element", "targetKey", "elementKey", "getAttribute", "DATA_BUCKET_ATTR", "targetBucket", "targetOrder", "styleBucketOrderingMap", "comparer", "el", "styleElements", "querySelectorAll", "mediaElements", "length", "compareMediaQueries", "comparerWithPriority", "Number", "index", "styleElement", "item", "nextSibling", "ignoreSuffixes", "join", "ignoreSuffixesRegex", "RegExp", "safeInsertRule", "sheet", "ruleCSS", "insertRule", "e", "lastIndex", "defaultCompareMediaQueries", "a", "b", "createDOMRenderer", "targetDocument", "document", "undefined", "options", "classNameHashSalt", "unstable_filterCSSRule", "insertionPoint", "styleElementAttributes", "compareMediaQueries", "renderer", "insertionCache", "stylesheets", "Object", "freeze", "id", "insertCSSRules", "cssRules", "styleBucketName", "cssRulesForBucket", "i", "l", "length", "ruleCSS", "metadata", "normalizeCSSBucketEntry", "sheet", "getStyleSheetForBucket", "safeInsertRule", "insertionFactory", "insertionCache", "renderer", "cssRules", "id", "undefined", "insertCSSRules", "__styles", "classesMapBySlot", "cssRules", "factory", "insertionFactory", "insertStyles", "ltrClassNamesForSlots", "rtlClassNamesForSlots", "sourceURL", "computeClasses", "options", "dir", "renderer", "isLTR", "reduceToClassNameForSlots", "RendererContext", "createContext", "createDOMRenderer", "useRenderer", "useContext", "RendererContext", "TextDirectionContext", "createContext", "TextDirectionProvider", "children", "dir", "createElement", "Provider", "value", "createCSSRuleFromTheme", "selector", "theme", "cssVarsAsString", "cssVarRule", "cssVar", "React", "slot_exports", "__export", "always", "optional", "resolveShorthand", "React", "SLOT_RENDER_FUNCTION_SYMBOL", "SLOT_ELEMENT_TYPE_SYMBOL", "SLOT_CLASS_NAME_PROP_SYMBOL", "always", "value", "options", "defaultProps", "elementType", "props", "resolveShorthand", "propsWithMetadata", "__spreadProps", "__spreadValues", "SLOT_ELEMENT_TYPE_SYMBOL", "SLOT_CLASS_NAME_PROP_SYMBOL", "SLOT_RENDER_FUNCTION_SYMBOL", "optional", "isIterable", "isSlot", "element", "SLOT_ELEMENT_TYPE_SYMBOL", "React", "React", "toObjectMap", "items", "result", "item", "keys", "key", "baseElementEvents", "baseElementProperties", "microdataProperties", "htmlElementProperties", "labelProperties", "audioProperties", "videoProperties", "olProperties", "liProperties", "anchorProperties", "timeProperties", "buttonProperties", "inputProperties", "textAreaProperties", "selectProperties", "optionProperties", "tableProperties", "trProperties", "thProperties", "tdProperties", "colGroupProperties", "colProperties", "fieldsetProperties", "formProperties", "iframeProperties", "imgProperties", "dialogProperties", "getNativeProps", "props", "allowedPropNames", "excludedPropNames", "isArray", "result", "keys", "key", "nativeElementMap", "labelProperties", "audioProperties", "videoProperties", "olProperties", "liProperties", "anchorProperties", "buttonProperties", "inputProperties", "textAreaProperties", "selectProperties", "optionProperties", "tableProperties", "trProperties", "thProperties", "tdProperties", "colGroupProperties", "colProperties", "fieldsetProperties", "formProperties", "iframeProperties", "imgProperties", "timeProperties", "dialogProperties", "getNativeElementProps", "tagName", "props", "excludedPropNames", "allowedPropNames", "htmlElementProperties", "getNativeProps", "getIntrinsicElementProps", "tagName", "props", "excludedPropNames", "_props_as", "getNativeElementProps", "React", "ThemeContext", "ThemeProvider", "React", "ThemeClassNameContext", "ThemeClassNameProvider", "ThemeClassNameContext", "React", "TooltipVisibilityContext", "TooltipVisibilityProvider", "TooltipVisibilityContext", "React", "ProviderContext", "providerContextDefaultValue", "Provider", "useFluent", "_React_useContext", "React", "OverridesContext", "OverridesProvider", "useOverrides", "_React_useContext", "React", "CustomStyleHooksContext", "CustomStyleHooksProvider", "CustomStyleHooksContext", "React", "canUseDOM", "React", "defaultSSRContextValue", "SSRContext", "useSSRContext", "_React_useContext", "useIsomorphicLayoutEffect", "canUseDOM", "React", "IdPrefixContext", "IdPrefixProvider", "useIdPrefix", "useId", "prefix", "providedId", "contextValue", "useSSRContext", "idPrefix", "useIdPrefix", "_useId", "generatedId", "escapedId", "React", "useMergedRefs", "refs", "mergedCallback", "value", "ref", "isHTMLElement", "element", "options", "_typedElement_ownerDocument", "typedElement", "_options_constructorName", "React", "React", "createCompatSlotComponent", "type", "props", "__spreadProps", "__spreadValues", "SLOT_ELEMENT_TYPE_SYMBOL", "createJSX", "runtime", "slotRuntime", "type", "overrideProps", "key", "source", "self", "isSlot", "createCompatSlotComponent", "React", "getMetadataFromSlotComponent", "type", "_a", "_b", "_c", "_d", "as", "SLOT_CLASS_NAME_PROP_SYMBOL", "_classNameProp", "SLOT_ELEMENT_TYPE_SYMBOL", "baseElementType", "SLOT_RENDER_FUNCTION_SYMBOL", "renderFunction", "props", "__objRest", "__restKey", "elementType", "ReactRuntime", "Runtime", "jsxSlot", "type", "overrideProps", "key", "elementType", "renderFunction", "slotProps", "getMetadataFromSlotComponent", "props", "__spreadValues", "Runtime", "React", "jsxsSlot", "type", "overrideProps", "key", "elementType", "renderFunction", "slotProps", "getMetadataFromSlotComponent", "props", "__spreadValues", "Runtime", "__spreadProps", "import_react", "jsx", "createJSX", "Runtime", "jsxSlot", "jsxs", "jsxsSlot", "React", "IconDirectionContext", "IconDirectionContextProvider", "IconDirectionContext", "renderFluentProvider_unstable", "state", "contextValues", "jsx", "Provider", "ThemeProvider", "ThemeClassNameProvider", "CustomStyleHooksProvider", "TooltipVisibilityProvider", "TextDirectionProvider", "IconDirectionContextProvider", "OverridesProvider", "jsxs", "canUseDOM", "__spreadValues", "_canUseWeakRef", "WeakRefInstance", "instance", "_a", "_b", "KEYBORG_FOCUSIN", "KEYBORG_FOCUSOUT", "canOverrideNativeFocus", "win", "HTMLElement", "origFocus", "isCustomFocusCalled", "_canOverrideNativeFocus", "setupFocusEvent", "win", "kwin", "_canOverrideNativeFocus", "canOverrideNativeFocus", "origFocus", "focus", "shadowTargets", "focusOutHandler", "e", "target", "event", "KEYBORG_FOCUSOUT", "focusInHandler", "node", "currentShadows", "shadowRootWeakRef", "shadowRoot", "onFocusIn", "relatedTarget", "originalEvent", "_a", "WeakRefInstance", "details", "KEYBORG_FOCUSIN", "data", "keyborgNativeFocusEvent", "activeElement", "disposeFocusEvent", "proto", "_dismissTimeout", "_lastId", "KeyborgCore", "win", "props", "e", "details", "doc", "triggerKeys", "dismissKeys", "KEYBORG_FOCUSIN", "setupFocusEvent", "val", "disposeFocusEvent", "_a", "_b", "keyborgs", "id", "Keyborg", "activeElement", "isTriggerKey", "isEditable", "was", "cur", "_Keyborg", "current", "instance", "isNavigatingWithKeyboard", "callback", "index", "createKeyborg", "disposeKeyborg", "React", "KEYBOARD_NAV_ATTRIBUTE", "KEYBOARD_NAV_SELECTOR", "FOCUS_VISIBLE_ATTR", "applyFocusVisiblePolyfill", "scope", "targetWindow", "alreadyInScope", "state", "keyborg", "createKeyborg", "registerElementIfNavigating", "el", "isHTMLElement", "FOCUS_VISIBLE_ATTR", "disposeCurrentElement", "isNavigatingWithKeyboard", "keyborgListener", "e", "target", "blurListener", "KEYBORG_FOCUSIN", "disposeKeyborg", "useFocusVisible", "options", "contextValue", "useFluent", "scopeRef", "_options_targetDocument", "targetDocument", "applyFocusVisiblePolyfill", "grey", "whiteAlpha", "blackAlpha", "white", "black", "darkRed", "cranberry", "red", "darkOrange", "pumpkin", "orange", "peach", "marigold", "yellow", "gold", "brass", "brown", "forest", "seafoam", "lightGreen", "green", "darkGreen", "lightTeal", "teal", "steel", "blue", "royalBlue", "cornflower", "navy", "lavender", "purple", "grape", "berry", "lilac", "pink", "magenta", "plum", "beige", "mink", "platinum", "anchor", "statusSharedColors", "red", "green", "darkOrange", "yellow", "berry", "lightGreen", "marigold", "personaSharedColors", "darkRed", "cranberry", "pumpkin", "peach", "gold", "brass", "brown", "forest", "seafoam", "darkGreen", "lightTeal", "teal", "steel", "blue", "royalBlue", "cornflower", "navy", "lavender", "purple", "grape", "lilac", "pink", "magenta", "plum", "beige", "mink", "platinum", "anchor", "mappedStatusColors", "orange", "statusSharedColorNames", "personaSharedColorNames", "statusColorMapping", "statusColorPaletteTokens", "statusSharedColorNames", "acc", "sharedColor", "color", "sharedColorTokens", "statusSharedColors", "personaColorPaletteTokens", "personaSharedColorNames", "personaSharedColors", "colorPaletteTokens", "__spreadValues", "colorStatusTokens", "statusColorMapping", "statusColor", "statusColorTokens", "mappedStatusColors", "generateColorTokens", "brand", "grey", "whiteAlpha", "white", "blackAlpha", "black", "borderRadius", "curves", "durations", "fontSizes", "lineHeights", "fontWeights", "fontFamilies", "spacings", "horizontalSpacings", "verticalSpacings", "strokeWidths", "createShadowTokens", "ambientColor", "keyColor", "tokenSuffix", "createLightTheme", "brand", "colorTokens", "generateColorTokens", "__spreadValues", "borderRadius", "fontSizes", "lineHeights", "fontFamilies", "fontWeights", "strokeWidths", "horizontalSpacings", "verticalSpacings", "durations", "curves", "colorPaletteTokens", "colorStatusTokens", "createShadowTokens", "brandWeb", "webLightTheme", "createLightTheme", "brandWeb", "React", "React", "fluentProviderClassNames", "useStyles", "__styles", "useFluentProviderStyles_unstable", "state", "renderer", "useRenderer", "styles", "mergeClasses", "useInsertionEffect", "useIsomorphicLayoutEffect", "createStyleTag", "target", "elementAttributes", "tag", "attrName", "insertSheet", "rule", "sheet", "useFluentProviderThemeStyleTag", "options", "targetDocument", "theme", "rendererAttributes", "styleTag", "styleTagId", "useId", "fluentProviderClassNames", "styleElementAttributes", "createCSSRuleFromTheme", "useHandleSSRStyleElements", "ssrStyleElement", "__spreadProps", "__spreadValues", "_styleTag_current", "themeStyleElement", "DEFAULT_STYLE_HOOKS", "DEFAULT_RENDERER_ATTRIBUTES", "useFluentProvider_unstable", "props", "ref", "parentContext", "useFluent", "parentTheme", "useTheme", "parentOverrides", "useOverrides", "parentCustomStyleHooks", "CustomStyleHooksContext", "applyStylesToPortals", "customStyleHooks_unstable", "dir", "targetDocument", "theme", "overrides", "mergedTheme", "shallowMerge", "mergedOverrides", "mergedCustomStyleHooks", "renderer", "useRenderer", "_renderer_styleElementAttributes", "styleTagId", "rule", "useFluentProviderThemeStyleTag", "slot_exports", "getIntrinsicElementProps", "__spreadProps", "__spreadValues", "useMergedRefs", "useFocusVisible", "a", "b", "ThemeContext", "React", "useFluentProviderContextValues_unstable", "state", "applyStylesToPortals", "customStyleHooks_unstable", "dir", "root", "targetDocument", "theme", "themeClassName", "overrides_unstable", "provider", "tooltip", "iconDirection", "FluentProvider", "props", "ref", "state", "useFluentProvider_unstable", "useFluentProviderStyles_unstable", "contextValues", "useFluentProviderContextValues_unstable", "renderFluentProvider_unstable", "import_react", "get", "w", "getGlobal", "setSendUserFact", "sendUserFact", "officeBrowserFeedback", "setProcessTelemetryEvent", "processTelemetryEvent", "setSetUiStrings", "setUiStrings", "globalWindow", "setIsFeedbackSurveyEnabledByAADC", "isFeedbackSurveyEnabledByAADC", "officeBrowserFeedback", "setFloodgateCustomUXHandler", "floodgateCustomUXHandler", "floodgate", "setFloodgateShowSurvey", "floodgateShowSurvey", "setFloodgateShowFormSurvey", "floodgateShowFormSurvey", "setFloodgateShowCustomSurvey", "floodgateShowCustomSurvey", "setFloodgateInitialize", "floodgateInitialize", "setFloodgateStart", "floodgateStart", "setFloodgateStop", "floodgateStop", "setFloodgateGetEngine", "floodgateGetEngine", "setFloodgateUpdateTheme", "floodgateUpdateTheme", "setUpdateTelemetrySink", "updateSink", "getSettingIdMap", "floodgateSettingIdMap", "setStorageProvider", "getStorageProvider", "Floodgate", "OfficeBrowserFeedback", "officeBrowserFeedback", "OfficeBrowserFeedback", "floodgate", "w", "makeBooleanDataField", "name", "value", "classification", "makeDataField", "makeInt64DataField", "makeDoubleDataField", "makeStringDataField", "makeDataField", "name", "dataType", "value", "classification", "getFullFieldName", "instanceName", "fieldName", "addStringDataField", "dataFields", "value", "dataClassification", "makeStringDataField", "addBooleanDataField", "makeBooleanDataField", "addInt64DataField", "intValue", "makeInt64DataField", "Result", "contract", "instanceName", "contractName", "dataFields", "addInt64DataField", "addStringDataField", "addBooleanDataField", "makeStringDataField", "Activity", "User", "Platform", "App", "contract", "instanceName", "dataFields", "addStringDataField", "Session", "AudienceGroup", "Release", "contract", "instanceName", "dataFields", "addStringDataField", "Copilot", "contractName", "FeatureActionType", "Capability", "EntryPoint", "Verb", "getFields", "addBooleanDataField", "makeStringDataField", "Asha", "EventType", "Module", "ContentIdentifier", "extendStatics", "d", "b", "p", "__extends", "__", "__assign", "s", "i", "n", "__rest", "e", "t", "__awaiter", "thisArg", "_arguments", "P", "generator", "adopt", "value", "resolve", "reject", "fulfilled", "step", "e", "rejected", "result", "__generator", "body", "_", "t", "f", "y", "g", "verb", "n", "v", "op", "__values", "o", "s", "m", "i", "__read", "n", "r", "ar", "e", "error", "__spreadArray", "to", "from", "pack", "i", "l", "ar", "getNotificationHandler", "_listeners", "args", "listener", "notificationHandler", "logNotification", "level", "category", "message", "notificationHandler", "logError", "error", "errorMessage", "NAMESPACE_SEPARATOR", "tenantTokens", "setTenantTokens", "namespace", "telemetryProperties", "logNotification", "fillTenantTokens", "eventName", "indexOfCharacterAfterNamespace", "namespaceCandidate", "storedTelemetryProperties", "INT64_MAX", "INT64_MIN", "MaxEventNameLength", "EventNameRegex", "DataFieldRegex", "validateTelemetryEvent", "telemetryEvent", "isEventNameValid", "raiseNameValidationError", "eventContract", "isNameValid", "validateDataFields", "eventName", "name", "dataFields", "dataField", "validateInt", "value", "type", "regex", "maxLength", "oteljsVersion", "CUSTOMER_CONTENT_VERSION", "MAX_EVENT_QUEUE_LENGTH", "SuppressNexus", "cloneEvent", "telemetryEvent", "localEvent", "__assign", "SimpleTelemetryLogger", "parent", "persistentDataFields", "config", "_a", "_b", "_c", "dataFields", "eventContentType", "makeInt64DataField", "clonedEvent", "telemetryProperties", "ariaTenantToken", "success", "fillTenantTokens", "logNotification", "eventType", "customerContentEvent", "customerContentVersion", "directNumericEvent", "error", "logError", "telemetrySink", "_e", "makeStringDataField", "oteljsVersion", "eventContract", "validateTelemetryEvent", "sink", "eventQueue", "_i", "eventQueue_1", "namespace", "nexusTenantToken", "setTenantTokens", "dnmToken", "ACTIVITY_COUNT", "ACTIVITY_AGGMODE", "getCurrentMilliseconds", "createActivity", "activityProperties", "_startTime", "_ended", "clonedEvent", "cloneEvent", "__assign", "telemetryEvent", "code", "type", "tag", "_this", "logNotification", "endTime", "durationInMicroseconds", "activity", "newDataFields", "_b", "_a", "Activity", "baseCv", "CV", "value", "getBaseCv", "baseCv", "characters", "hashLength", "result", "i", "CV", "Error", "contract", "instanceName", "dataFields", "makeStringDataField", "makeInt64DataField", "TelemetryLogger", "_super", "__extends", "parent", "persistentDataFields", "config", "_this", "getBaseCv", "telemetryEvent", "createActivity", "activityName", "activity", "dataFields", "eventFlags", "Activity", "error", "Error", "customerContentEvent", "SimpleTelemetryLogger", "OneDSEndpoint", "strShimFunction", "strShimObject", "strShimUndefined", "strShimPrototype", "strShimHasOwnProperty", "ObjClass", "ObjProto", "strShimPrototype", "ObjAssign", "ObjCreate", "ObjDefineProperty", "ObjHasOwnProperty", "strShimHasOwnProperty", "_cachedGlobal", "getGlobal", "useCached", "result", "strShimUndefined", "throwTypeError", "message", "objCreateFn", "obj", "func", "ObjCreate", "type", "strShimObject", "strShimFunction", "tmpFunc", "strShimPrototype", "SymbolObj", "getGlobal", "ReflectObj", "extendStaticsFn", "d", "b", "ObjClass", "p", "strShimHasOwnProperty", "__extendsFn", "strShimFunction", "throwTypeError", "__", "strShimPrototype", "objCreateFn", "__spreadArrayFn", "to", "from", "i", "il", "j", "_DYN_INITIALIZE", "_DYN_NAME", "_DYN_GET_NOTIFY_MGR", "_DYN_IDENTIFIER", "_DYN_PUSH", "_DYN_IS_INITIALIZED", "_DYN_CONFIG", "_DYN_INSTRUMENTATION_KEY", "_DYN_LOGGER", "_DYN_LENGTH", "_DYN_TIME", "_DYN_PROCESS_NEXT", "_DYN_GET_PROCESS_TEL_CONT0", "_DYN_ADD_NOTIFICATION_LIS1", "_DYN_REMOVE_NOTIFICATION_2", "_DYN_STOP_POLLING_INTERNA3", "_DYN_ON_COMPLETE", "_DYN_GET_PLUGIN", "_DYN_FLUSH", "_DYN__EXTENSIONS", "_DYN_SPLICE", "_DYN_TEARDOWN", "_DYN_MESSAGE_ID", "_DYN_MESSAGE", "_DYN_IS_ASYNC", "_DYN__DO_TEARDOWN", "_DYN_UPDATE", "_DYN_GET_NEXT", "_DYN_DIAG_LOG", "_DYN_SET_NEXT_PLUGIN", "_DYN_CREATE_NEW", "_DYN_COOKIE_CFG", "_DYN_INDEX_OF", "_DYN_SUBSTRING", "_DYN_USER_AGENT", "_DYN_SPLIT", "_DYN_SET_ENABLED", "_DYN_SUBSTR", "_DYN_NODE_TYPE", "_DYN_APPLY", "_DYN_REPLACE", "_DYN_ENABLE_DEBUG_EXCEPTI4", "_DYN_LOG_INTERNAL_MESSAGE", "_DYN_TO_LOWER_CASE", "_DYN_CALL", "_DYN_TYPE", "_DYN_HANDLER", "_DYN_LISTENERS", "_DYN_IS_CHILD_EVT", "_DYN_GET_CTX", "_DYN_SET_CTX", "_DYN_COMPLETE", "_DYN_TRACE_ID", "_DYN_SPAN_ID", "_DYN_TRACE_FLAGS", "STR_EMPTY", "STR_CHANNELS", "STR_CORE", "STR_CREATE_PERF_MGR", "STR_DISABLED", "STR_EXTENSION_CONFIG", "STR_EXTENSIONS", "STR_PROCESS_TELEMETRY", "STR_PRIORITY", "STR_EVENTS_SENT", "STR_EVENTS_DISCARDED", "STR_EVENTS_SEND_REQUEST", "STR_PERF_EVENT", "STR_ERROR_TO_CONSOLE", "STR_WARN_TO_CONSOLE", "STR_GET_PERF_MGR", "strToISOString", "cStrEndsWith", "cStrStartsWith", "strIndexOf", "cStrTrim", "strToString", "str__Proto", "strConstructor", "_objDefineProperty", "ObjDefineProperty", "_objFreeze", "ObjClass", "_objSeal", "_objKeys", "StringProto", "strShimPrototype", "_strTrim", "_strEndsWith", "cStrEndsWith", "_strStartsWith", "cStrStartsWith", "DateProto", "_dataToISOString", "strToISOString", "_isArray", "_objToString", "ObjProto", "_fnToString", "ObjHasOwnProperty", "_objFunctionString", "_DYN_CALL", "rCamelCase", "rNormalizeInvalid", "rLeadingNumeric", "_objGetPrototypeOf", "_getObjProto", "target", "newProto", "isUndefined", "value", "strShimUndefined", "isNullOrUndefined", "value", "isUndefined", "isNotNullOrUndefined", "hasOwnProperty", "obj", "prop", "ObjHasOwnProperty", "_DYN_CALL", "isObject", "strShimObject", "isFunction", "strShimFunction", "normalizeJsName", "name", "value", "isString", "_DYN_REPLACE", "rCamelCase", "_all", "letter", "rNormalizeInvalid", "rLeadingNumeric", "match", "objForEachKey", "target", "callbackfn", "prop", "ObjHasOwnProperty", "_DYN_CALL", "strEndsWith", "search", "result", "_strEndsWith", "cStrEndsWith", "_strEndsWithPoly", "searchLen", "_DYN_LENGTH", "valLen", "pos", "lp", "strStartsWith", "checkValue", "_strStartsWith", "cStrStartsWith", "_strStartsWithPoly", "chkLen", "strContains", "_DYN_INDEX_OF", "isArray", "_isArray", "_isArrayPoly", "obj", "_objToString", "_DYN_CALL", "isError", "isString", "value", "isNumber", "isBoolean", "isPlainObject", "value", "result", "proto", "_objGetPrototypeOf", "_getObjProto", "strConstructor", "ObjHasOwnProperty", "_DYN_CALL", "strShimFunction", "_fnToString", "_objFunctionString", "toISOString", "date", "_dataToISOString", "strToISOString", "_toISOStringPoly", "pad", "num", "r", "_DYN_LENGTH", "arrForEach", "arr", "callbackfn", "thisArg", "len", "idx", "e", "arrIndexOf", "searchElement", "fromIndex", "strIndexOf", "from", "lp", "strTrim", "str", "_strTrim", "cStrTrim", "_DYN_REPLACE", "STR_EMPTY", "_objKeysHasDontEnumBug", "_objKeysDontEnums", "objKeys", "obj", "objType", "strShimFunction", "strShimObject", "throwTypeError", "_objKeys", "result", "prop", "ObjHasOwnProperty", "_DYN_CALL", "_DYN_PUSH", "dontEnumsLength", "_DYN_LENGTH", "lp", "objDefineAccessors", "target", "getProp", "setProp", "_objDefineProperty", "descriptor", "e", "_doNothing", "value", "deepFreeze", "_objFreeze", "objForEachKey", "name", "isArray", "isObject", "objFreeze", "dateNow", "dt", "getExceptionName", "object", "isError", "_DYN_NAME", "STR_EMPTY", "setValue", "target", "field", "value", "valChk", "srcChk", "theValue", "getSetValue", "defValue", "isNullOrUndefined", "isUndefined", "getCfgValue", "defaultValue", "isTruthy", "value", "throwError", "message", "_createProxyFunction", "source", "funcName", "srcFunc", "src", "isFunction", "originalArguments", "_DYN_APPLY", "proxyFunctionAs", "target", "name", "source", "theFunc", "overwriteTarget", "isUndefined", "_createProxyFunction", "proxyFunctions", "functionsToProxy", "isObject", "isArray", "arrForEach", "theFuncName", "isString", "optimizeObject", "theObject", "ObjAssign", "ObjClass", "objExtend", "obj1", "obj2", "obj3", "obj4", "obj5", "obj6", "theArgs", "extended", "argLen", "_DYN_LENGTH", "deep", "idx", "isBoolean", "isObject", "arg", "isArgArray", "isArray", "isArgObj", "prop", "propOk", "ObjHasOwnProperty", "_DYN_CALL", "newValue", "isNewArray", "isPlainObject", "clone", "createEnumStyle", "values", "enumClass", "objForEachKey", "field", "value", "deepFreeze", "EventsDiscardedReason", "createEnumStyle", "_a", "UNDEFINED", "Constructor", "Prototype", "strFunction", "DynInstFuncTable", "DynProxyTag", "DynClassName", "DynClassNamePrefix", "DynInstChkTag", "DynAllowInstChkTag", "DynProtoDefaultOptions", "UnknownValue", "str__Proto", "DynProtoBaseProto", "DynProtoGlobalSettings", "DynProtoCurrent", "strUseBaseInst", "strSetInstFuncs", "Obj", "_objGetPrototypeOf", "_objGetOwnProps", "_getGlobal", "result", "_gbl", "_gblInst", "_hasOwnProperty", "obj", "prop", "_isObjectOrArrayPrototype", "target", "_isObjectArrayOrFunctionPrototype", "_getObjProto", "newProto", "curProto", "_forEachProp", "func", "props", "name_1", "lp", "_isDynamicCandidate", "funcName", "skipOwn", "_throwTypeError", "message", "_newObject", "type", "tmpFunc", "_getInstanceFuncs", "thisTarget", "instFuncs", "name", "_hasVisited", "values", "value", "_getBaseFuncs", "classProto", "useBaseInst", "_instFuncProxy", "funcHost", "theFunc", "instFuncTable", "baseFuncs", "baseProto", "visited", "_getInstFunc", "proto", "currentDynProtoProxy", "instFunc", "canAddInst", "objProto", "protoFunc", "e", "_getProtoFunc", "_populatePrototype", "className", "baseInstFuncs", "setInstanceFunc", "_createDynamicPrototype", "dynProtoProxy", "instFuncs_1", "_checkPrototype", "thisProto", "_getObjName", "unknownValue", "dynamicProto", "theClass", "delegateFunc", "options", "perfOptions", "strWindow", "strDocument", "strNavigator", "strLocation", "strConsole", "strPerformance", "strJSON", "strCrypto", "strMsCrypto", "strReactNative", "strMsie", "strTrident", "strXMLHttpRequest", "_isTrident", "_navUserAgentCheck", "_enableMocks", "_useXDomainRequest", "_beaconsSupported", "_hasProperty", "theClass", "property", "supported", "proto", "strShimPrototype", "e", "tmp", "isUndefined", "getGlobalInst", "name", "gbl", "getGlobal", "strWindow", "hasWindow", "strShimObject", "getWindow", "hasDocument", "getDocument", "strDocument", "hasNavigator", "getNavigator", "strNavigator", "getLocation", "checkForMock", "_enableMocks", "mockLocation", "getGlobalInst", "strShimObject", "strLocation", "getConsole", "strShimUndefined", "strConsole", "getPerformance", "strPerformance", "hasJSON", "strJSON", "getJSON", "getCrypto", "strCrypto", "getMsCrypto", "strMsCrypto", "isReactNative", "nav", "getNavigator", "strReactNative", "isIE", "_DYN_USER_AGENT", "_navUserAgentCheck", "_isTrident", "userAgent", "STR_EMPTY", "_DYN_TO_LOWER_CASE", "strContains", "strMsie", "strTrident", "dumpObj", "object", "objectTypeDump", "strShimPrototype", "_DYN_CALL", "propertyValueDump", "STR_EMPTY", "_DYN_NAME", "hasJSON", "getJSON", "isBeaconsSupported", "_beaconsSupported", "hasNavigator", "getNavigator", "isFetchSupported", "withKeepAlive", "isSupported", "getGlobalInst", "request", "_hasProperty", "e", "useXDomainRequest", "_useXDomainRequest", "strShimUndefined", "isXhrSupported", "strXMLHttpRequest", "xmlHttpRequest", "listenerFuncs", "_aiNamespace", "_debugListener", "_listenerProxyFunc", "name", "config", "args", "dbgExt", "getDebugExt", "listener", "_DYN_APPLY", "_getExtensionNamespace", "target", "getGlobalInst", "ns", "getDebugListener", "lp", "_DYN_LENGTH", "AiNonUserActionablePrefix", "AiUserActionablePrefix", "AIInternalMessagePrefix", "_sanitizeDiagnosticText", "text", "_DYN_REPLACE", "STR_EMPTY", "_logToConsole", "func", "message", "theConsole", "getConsole", "logFunc", "isFunction", "_InternalLogMessage", "msgId", "msg", "isUserAct", "properties", "_self", "_DYN_MESSAGE_ID", "_DYN_MESSAGE", "strProps", "hasJSON", "getJSON", "diagnosticText", "safeGetLogger", "core", "config", "_DYN_LOGGER", "DiagnosticLogger", "_messageCount", "_messageLogged", "_loggingLevelConsole", "_loggingLevelTelemetry", "_maxInternalMessageLimit", "_enableDebug", "dynamicProto", "_self", "_setDefaultsFromConfig", "_DYN_ENABLE_DEBUG_EXCEPTI4", "severity", "msgId", "msg", "properties", "isUserAct", "message", "_InternalLogMessage", "dumpObj", "logFunc", "STR_ERROR_TO_CONSOLE", "STR_WARN_TO_CONSOLE", "isUndefined", "_DYN_MESSAGE", "_debugExtMsg", "messageKey", "_DYN_MESSAGE_ID", "_logInternalMessage", "_logToConsole", "_DYN_LOG_INTERNAL_MESSAGE", "_areInternalMessagesThrottled", "logMessage", "AIInternalMessagePrefix", "_DYN_PUSH", "throttleLimitMessage", "throttleMessage", "getCfgValue", "name", "data", "dbgExt", "getDebugExt", "_DYN_DIAG_LOG", "_getLogger", "logger", "DiagnosticLogger", "_throwInternal", "severity", "msgId", "msg", "properties", "isUserAct", "_warnToConsole", "message", "STR_WARN_TO_CONSOLE", "strExecutionContextKey", "strParentContextKey", "strChildrenContextKey", "_defaultPerfManager", "PerfEvent", "name", "payloadDetails", "isAsync", "_self", "accessorDefined", "dateNow", "_DYN_NAME", "_DYN_IS_ASYNC", "_DYN_IS_CHILD_EVT", "isFunction", "theDetails_1", "objDefineAccessors", "_DYN_GET_CTX", "key", "_DYN_SET_CTX", "value", "ctx", "_DYN_COMPLETE", "childTime", "childEvts", "isArray", "lp", "_DYN_LENGTH", "childEvt", "_DYN_TIME", "PerfManager", "manager", "dynamicProto", "_self", "src", "payloadDetails", "isAsync", "PerfEvent", "perfEvent", "_DYN_COMPLETE", "isFunction", "STR_PERF_EVENT", "_DYN_SET_CTX", "key", "value", "ctx", "strExecutionContextKey", "_DYN_GET_CTX", "doPerfActiveKey", "doPerf", "mgrSource", "getSource", "func", "details", "isAsync", "perfMgr", "STR_GET_PERF_MGR", "perfEvt", "currentActive", "_DYN_GET_CTX", "_DYN_SET_CTX", "PerfEvent", "strParentContextKey", "children", "strChildrenContextKey", "_DYN_PUSH", "ex", "getGblPerfMgr", "_defaultPerfManager", "UInt32Mask", "MaxUInt32", "_mwcSeeded", "_mwcW", "_mwcZ", "_mwcSeed", "seedValue", "_autoSeedMwc", "now", "dateNow", "e", "random32", "signed", "value", "c", "getCrypto", "getMsCrypto", "MaxUInt32", "isIE", "_mwcSeeded", "_autoSeedMwc", "mwcRandom32", "UInt32Mask", "mwcRandom32", "signed", "_mwcZ", "MaxUInt32", "_mwcW", "value", "newId", "maxLength", "base64chars", "number", "random32", "chars", "result", "STR_EMPTY", "_DYN_LENGTH", "_objDefineProperty", "ObjDefineProperty", "version", "instanceName", "newId", "_dataUid", "_createAccessor", "target", "prop", "value", "e", "_canAcceptData", "_DYN_NODE_TYPE", "_getCache", "data", "theCache", "createUniqueNamespace", "name", "includeVersion", "normalizeJsName", "STR_EMPTY", "createElmNodeData", "defValue", "addDefault", "strToGMTString", "strToUTCString", "strCookie", "strExpires", "strEnabled", "strIsCookieUseDisabled", "strDisableCookiesUsage", "strConfigCookieMgr", "_supportsCookies", "_allowUaSameSite", "_parsedCookieValue", "_doc", "getDocument", "_cookieCache", "_globalCookieConfig", "_isMgrEnabled", "cookieMgr", "_createCookieMgrConfig", "rootConfig", "cookieMgrCfg", "_DYN_COOKIE_CFG", "setValue", "isNotNullOrUndefined", "isNullOrUndefined", "strEnabled", "cookieEnabled", "isUndefined", "strIsCookieUseDisabled", "strDisableCookiesUsage", "_isIgnoredCookie", "name", "isArray", "_DYN_INDEX_OF", "_isBlockedCookie", "createCookieMgr", "rootConfig", "logger", "_a", "cookieMgrConfig", "_createCookieMgrConfig", "_globalCookieConfig", "_path", "_domain", "_enabled", "strEnabled", "cookieMgr", "enabled", "areCookiesSupported", "gblManager", "strConfigCookieMgr", "_isMgrEnabled", "_DYN_SET_ENABLED", "value", "name", "maxAgeSec", "domain", "path", "result", "_isBlockedCookie", "values", "theValue", "strTrim", "STR_EMPTY", "idx", "_DYN_INDEX_OF", "_DYN_SUBSTRING", "_extractParts", "setValue", "isTruthy", "isUndefined", "isNullOrUndefined", "_isIE", "isIE", "strExpires", "nowMs", "dateNow", "expireMs", "expiry", "_formatDate", "strToGMTString", "strToUTCString", "location_1", "getLocation", "_allowUaSameSite", "uaDisallowsSameSiteNone", "getNavigator", "_DYN_USER_AGENT", "setCookieFn", "_setCookieValue", "_formatCookieValue", "_isIgnoredCookie", "_getCookieValue", "delCookie", "_supportsCookies", "doc", "_doc", "strCookie", "e", "_throwInternal", "getExceptionName", "dumpObj", "_DYN_LENGTH", "parts", "_DYN_SPLIT", "arrForEach", "thePart", "theDate", "func", "isFunction", "cookieValue", "objForEachKey", "theCookie", "_parsedCookieValue", "_cookieCache", "userAgent", "isString", "strContains", "strEndsWith", "strOnPrefix", "strAttachEvent", "strAddEventHelper", "strDetachEvent", "strRemoveEventListener", "strEvents", "strVisibilityChangeEvt", "strPageHide", "strPageShow", "strUnload", "strBeforeUnload", "strPageHideNamespace", "createUniqueNamespace", "strPageShowNamespace", "rRemoveEmptyNs", "rRemoveTrailingEmptyNs", "_guid", "elmNodeData", "createElmNodeData", "eventNamespace", "_normalizeNamespace", "name", "_DYN_REPLACE", "STR_EMPTY", "_getEvtNamespace", "eventName", "evtNamespace", "_a", "theNamespace_1", "isArray", "arrForEach", "parsedEvent", "_DYN_TYPE", "_DYN_SPLIT", "_getRegisteredEvents", "target", "evtName", "addDefault", "aiEvts", "elmNodeData", "strEvents", "registeredEvents", "_doDetach", "obj", "handlerRef", "useCapture", "_DYN_TYPE", "strRemoveEventListener", "strDetachEvent", "strOnPrefix", "_doAttach", "result", "strAddEventHelper", "strAttachEvent", "_doUnregister", "events", "unRegFn", "idx", "_DYN_LENGTH", "theEvent", "_DYN_HANDLER", "_DYN_SPLICE", "_unregisterEvents", "eventCache", "objForEachKey", "evtType", "objKeys", "mergeEvtNamespace", "theNamespace", "namespaces", "newNamespaces", "isArray", "_getEvtNamespace", "_DYN_SPLIT", "eventOn", "eventName", "evtNamespace", "_a", "registeredEvent", "_guid", "_DYN_PUSH", "e", "eventOff", "evtName_1", "found_1", "regEvent", "addEventHandler", "eventName", "callback", "evtNamespace", "result", "w", "getWindow", "eventOn", "doc", "getDocument", "removeEventHandler", "eventOff", "_addEventListeners", "events", "listener", "excludeEvents", "added", "_DYN_LENGTH", "arrForEach", "name", "arrIndexOf", "addEventListeners", "isArray", "removeEventListeners", "addPageUnloadEventListener", "strBeforeUnload", "strUnload", "strPageHide", "removePageUnloadEventListener", "addPageHideEventListener", "_handlePageVisibility", "evt", "newNamespaces", "mergeEvtNamespace", "strPageHideNamespace", "pageUnloadAdded", "strVisibilityChangeEvt", "removePageHideEventListener", "addPageShowEventListener", "strPageShowNamespace", "pageShowAdded", "strPageShow", "removePageShowEventListener", "newGuid", "uuid", "generateW3CId", "_DYN_SUBSTRING", "perfNow", "perf", "getPerformance", "dateNow", "generateW3CId", "hexValues", "oct", "STR_EMPTY", "tmp", "a", "random32", "clockSequenceHi", "_DYN_SUBSTR", "INVALID_TRACE_ID", "INVALID_SPAN_ID", "_isValid", "value", "len", "invalidValue", "_DYN_LENGTH", "isValidTraceId", "value", "_isValid", "INVALID_TRACE_ID", "isValidSpanId", "INVALID_SPAN_ID", "pluginStateData", "createElmNodeData", "_getPluginState", "plugin", "initializePlugins", "processContext", "extensions", "initPlugins", "lastPlugin", "proxy", "_DYN_GET_NEXT", "pluginState", "thePlugin", "_DYN_GET_PLUGIN", "isFunction", "_DYN_SET_NEXT_PLUGIN", "STR_PROCESS_TELEMETRY", "isInitialized", "_DYN_IS_INITIALIZED", "_DYN_PUSH", "arrForEach", "core", "STR_CORE", "_DYN_INITIALIZE", "_DYN_TEARDOWN", "sortPlugins", "plugins", "extA", "extB", "result", "bHasProcess", "STR_PRIORITY", "createDistributedTraceContext", "parentCtx", "trace", "_DYN_NAME", "newValue", "_DYN_TRACE_ID", "isValidTraceId", "_DYN_SPAN_ID", "isValidSpanId", "_DYN_TRACE_FLAGS", "newTraceFlags", "strTelemetryPluginChain", "strHasRunFlags", "strGetTelCtx", "_chainId", "_getNextProxyStart", "proxy", "core", "startAt", "_DYN_GET_PLUGIN", "_DYN_GET_NEXT", "createTelemetryProxyChain", "_DYN_CONFIG", "_createInternalContext", "telemetryChain", "config", "_nextProxy", "_onComplete", "context", "_moveNext", "safeGetLogger", "_getExtCfg", "_getConfig", "nextPlugin", "_iterateChain", "_addOnComplete", "onComplete", "that", "args", "_i", "_DYN_PUSH", "isUndefined", "nextProxy", "_DYN_LENGTH", "arrForEach", "completeDetails", "_DYN_CALL", "e", "_throwInternal", "_DYN_LOGGER", "dumpObj", "identifier", "defaultValue", "mergeDefault", "theConfig", "extConfig", "STR_EXTENSION_CONFIG", "isObject", "newConfig_1", "objExtend", "objForEachKey", "field", "isNullOrUndefined", "cfgValue", "theValue", "cb", "plugin", "createProcessTelemetryContext", "internalContext", "_processNext", "env", "STR_PROCESS_TELEMETRY", "_createNew", "plugins", "isArray", "_DYN_PROCESS_NEXT", "_DYN_CREATE_NEW", "createProcessTelemetryUnloadContext", "unloadState", "createProcessTelemetryUpdateContext", "updateState", "isFunction", "_DYN_UPDATE", "firstProxy", "add", "lastProxy_1", "thePlugin", "newProxy", "createTelemetryPluginProxy", "hasProcessTelemetry", "hasSetNext", "_DYN_SET_NEXT_PLUGIN", "chainId", "_DYN_IDENTIFIER", "STR_PRIORITY", "proxyChain", "_processTelemetry", "_unloadPlugin", "_updatePlugin", "_getTelCtx", "itemCtx", "_processChain", "processPluginFn", "name", "details", "isAsync", "hasRun", "hasRunContext", "doPerf", "STR_CORE", "nextId", "STR_EMPTY", "error", "hasNextRun", "_DYN_DIAG_LOG", "_callProcessTelemetry", "pluginState", "_getPluginState", "_DYN_TEARDOWN", "STR_DISABLED", "unloadCtx", "_callTeardown", "pluginCore", "_DYN_IS_INITIALIZED", "_DYN_IS_ASYNC", "updateCtx", "_callUpdate", "objFreeze", "ChannelControllerPriority", "ChannelValidationMessage", "_addChannelQueue", "channelQueue", "queue", "core", "isArray", "_DYN_LENGTH", "a", "b", "STR_PRIORITY", "arrForEach", "queueItem", "throwError", "_DYN_IDENTIFIER", "_DYN_PUSH", "objFreeze", "createTelemetryProxyChain", "_DYN_CONFIG", "createChannelControllerPlugin", "_getTelCtx", "createProcessTelemetryContext", "_processChannelQueue", "theChannels", "itemCtx", "processFn", "onComplete", "waiting", "_runChainOnComplete", "channels", "channelChain", "chainCtx", "_DYN_CREATE_NEW", "_DYN_ON_COMPLETE", "_doUpdate", "updateCtx", "updateState", "theUpdateState", "_DYN_PROCESS_NEXT", "_doTeardown", "unloadCtx", "unloadState", "theUnloadState", "isInitialized", "_getChannel", "pluginIdentifier", "thePlugin", "ext", "channelController", "config", "extensions", "pluginChain", "initializePlugins", "item", "plugin", "isAsync", "callBack", "sendReason", "cbTimeout", "doneIterating", "cbTimer", "doCallback", "_DYN_FLUSH", "handled_1", "createChannelQueues", "extensionQueue_1", "createUnloadHandlerContainer", "handlers", "_addHandler", "handler", "_DYN_PUSH", "_runHandlers", "unloadCtx", "unloadState", "arrForEach", "e", "_throwInternal", "_DYN_DIAG_LOG", "dumpObj", "strGetPlugin", "BaseTelemetryPlugin", "_self", "_isinitialized", "_rootCtx", "_nextPlugin", "_unloadHandlerContainer", "_hooks", "_initDefaults", "dynamicProto", "_DYN_INITIALIZE", "config", "core", "extensions", "pluginChain", "_setDefaults", "_DYN_TEARDOWN", "unloadCtx", "unloadState", "_a", "STR_CORE", "result", "unloadDone", "theUnloadCtx", "createProcessTelemetryUnloadContext", "theUnloadState", "_DYN_IS_ASYNC", "_unloadCallback", "oldHooks", "arrForEach", "fn", "_DYN_PROCESS_NEXT", "_DYN__DO_TEARDOWN", "_DYN_UPDATE", "updateCtx", "updateState", "updateDone", "theUpdateCtx", "createProcessTelemetryUpdateContext", "theUpdateState", "_updateCallback", "_DYN_GET_NEXT", "hooks", "isArray", "_DYN_PUSH", "proxyFunctionAs", "_DYN_DIAG_LOG", "itemCtx", "_getTelCtx", "_DYN_IS_INITIALIZED", "isInitialized", "_DYN_SET_NEXT_PLUGIN", "next", "env", "isFunction", "STR_PROCESS_TELEMETRY", "currentCtx", "rootCtx", "createProcessTelemetryContext", "_DYN_CREATE_NEW", "setValue", "STR_EXTENSION_CONFIG", "isNullOrUndefined", "_DYN_GET_PROCESS_TEL_CONT0", "nextPlugin", "createUnloadHandlerContainer", "TelemetryInitializerPlugin", "_super", "__extendsFn", "_this", "_id", "_initializers", "_initDefaults", "dynamicProto", "_self", "_base", "telemetryInitializer", "theInitializer", "_DYN_PUSH", "handler", "arrForEach", "initializer", "idx", "_DYN_SPLICE", "STR_PROCESS_TELEMETRY", "item", "itemCtx", "doNotSendItem", "telemetryInitializersCount", "_DYN_LENGTH", "i", "_DYN_APPLY", "e", "_throwInternal", "_DYN_DIAG_LOG", "getExceptionName", "dumpObj", "_DYN_PROCESS_NEXT", "_DYN__DO_TEARDOWN", "BaseTelemetryPlugin", "strValidationError", "strNotificationManager", "strSdkUnloadingError", "strSdkNotInitialized", "defaultInitConfig", "_createPerfManager", "core", "notificationMgr", "PerfManager", "_validateExtensions", "logger", "channelPriority", "allExtensions", "_a", "coreExtensions", "extPriorities", "arrForEach", "ext", "isNullOrUndefined", "_DYN_INITIALIZE", "throwError", "extPriority", "STR_PRIORITY", "identifier", "_DYN_IDENTIFIER", "_warnToConsole", "_DYN_PUSH", "STR_CORE", "_isPluginPresent", "thePlugin", "plugins", "exists", "plugin", "_createDummyNotificationManager", "objCreateFn", "_DYN_ADD_NOTIFICATION_LIS1", "listener", "_DYN_REMOVE_NOTIFICATION_2", "STR_EVENTS_SENT", "events", "STR_EVENTS_DISCARDED", "reason", "STR_EVENTS_SEND_REQUEST", "sendReason", "isAsync", "BaseCore", "_config", "_isInitialized", "_eventQueue", "_notificationManager", "_perfManager", "_cfgPerfManager", "_cookieManager", "_pluginChain", "_configExtensions", "_coreExtensions", "_channelControl", "_channelConfig", "_channelQueue", "_isUnloading", "_telemetryInitializerPlugin", "_internalLogsEventName", "_evtNamespace", "_unloadHandlers", "_debugListener", "_traceCtx", "_internalLogPoller", "_forceStopInternalLogPoller", "dynamicProto", "_self", "_initDefaults", "_DYN_IS_INITIALIZED", "config", "extensions", "notificationManager", "_DYN_CONFIG", "_DYN_INSTRUMENTATION_KEY", "_initDebugListener", "_initPerfManager", "_initExtConfig", "_DYN_LOGGER", "cfgExtensions", "getSetValue", "STR_EXTENSIONS", "__spreadArrayFn", "STR_CHANNELS", "_initPluginChain", "_DYN_LENGTH", "controls", "channels", "objFreeze", "telemetryItem", "_DYN_TIME", "toISOString", "_createTelCtx", "_DYN_PROCESS_NEXT", "_DYN_GET_PROCESS_TEL_CONT0", "_DYN_GET_NOTIFY_MGR", "createCookieMgr", "cookieMgr", "STR_GET_PERF_MGR", "getCfgValue", "createPerfMgr", "STR_CREATE_PERF_MGR", "isFunction", "getGblPerfMgr", "perfMgr", "eventQueue", "event", "eventName", "_startInternalLogTimer", "alwaysStart", "shouldStart", "interval", "_flushInternalLogs", "_DYN_STOP_POLLING_INTERNA3", "proxyFunctions", "unloadComplete", "cbTimeout", "unloadState", "_DYN_IS_ASYNC", "processUnloadCtx", "createProcessTelemetryUnloadContext", "_getPluginChain", "_DYN_ON_COMPLETE", "_doUnload", "flushComplete", "_flushChannels", "_DYN_GET_PLUGIN", "_getPlugin", "replaceExisting", "addCb", "_logOrThrowError", "existingPlugin", "updateState", "_addPlugin", "removed", "removedPlugins_1", "_removePlugins", "_DYN_FLUSH", "createNew", "createDistributedTraceContext", "traceCtx", "proxyFunctionAs", "objExtend", "DiagnosticLogger", "_DYN__EXTENSIONS", "TelemetryInitializerPlugin", "createUniqueNamespace", "createUnloadHandlerContainer", "theCtx", "createProcessTelemetryContext", "theExtensions", "ChannelControllerPriority", "createChannelQueues", "idx", "arrIndexOf", "_DYN_SPLICE", "createChannelControllerPlugin", "sortPlugins", "initCtx", "initializePlugins", "_doUpdate", "pluginIdentifier", "theExt", "_DYN_SET_ENABLED", "enabled", "_getPluginState", "STR_DISABLED", "pluginState", "_DYN_TEARDOWN", "removeCb", "pluginsToRemove", "createTelemetryProxyChain", "thePlugins", "removeComplete", "unloadChain", "unloadCtx", "newConfigExtensions", "newChannelConfig", "queue", "newQueue", "channel", "logMessage", "item", "_DYN_NAME", "_DYN_MESSAGE_ID", "_InternalLogMessage", "_DYN_MESSAGE", "callBack", "disableDbgExt", "getDebugListener", "enablePerfMgr", "extConfig", "STR_EXTENSION_CONFIG", "updateCtx", "createProcessTelemetryUpdateContext", "message", "_throwInternal", "_runListeners", "listeners", "name", "isAsync", "callback", "arrForEach", "listener", "e", "NotificationManager", "config", "perfEvtsSendAll", "dynamicProto", "_self", "_DYN_ADD_NOTIFICATION_LIS1", "_DYN_PUSH", "_DYN_REMOVE_NOTIFICATION_2", "index", "arrIndexOf", "_DYN_LISTENERS", "_DYN_SPLICE", "STR_EVENTS_SENT", "events", "STR_EVENTS_DISCARDED", "reason", "STR_EVENTS_SEND_REQUEST", "sendReason", "STR_PERF_EVENT", "perfEvent", "_DYN_IS_CHILD_EVT", "_DYN_IS_ASYNC", "AppInsightsCore", "_super", "__extendsFn", "_this", "dynamicProto", "_self", "_base", "_DYN_INITIALIZE", "config", "extensions", "logger", "notificationManager", "DiagnosticLogger", "NotificationManager", "telemetryItem", "doPerf", "STR_GET_PERF_MGR", "_notifyInvalidEvent", "throwError", "_validateTelemetryItem", "isNullOrUndefined", "_DYN_NAME", "manager", "_DYN_GET_NOTIFY_MGR", "STR_EVENTS_DISCARDED", "BaseCore", "STR_EMPTY", "STR_DEFAULT_ENDPOINT_URL", "STR_PLUGIN_VERSION_STRING", "STR_PLUGIN_VERSION_STRING_ARR", "STR_VERSION", "STR_PROPERTIES", "_a", "Version", "FullVersionString", "strDisabledPropertyName", "strWithCredentials", "strTimeout", "_fieldTypeEventPropMap", "isDocumentObjectAvailable", "getDocument", "isWindowObjectAvailable", "getWindow", "isValueAssigned", "value", "STR_EMPTY", "isNullOrUndefined", "getTenantId", "apiKey", "indexTenantId", "isLatency", "value", "isNumber", "sanitizeProperty", "name", "property", "stringifyObjects", "isValueAssigned", "propType", "isArray", "ObjHasOwnProperty", "isNullOrUndefined", "STR_EMPTY", "isString", "isBoolean", "isArrayValid", "isValueKind", "getCommonSchemaMetaData", "kind", "type", "encodedTypeValue", "isUndefined", "isDataType", "_fieldTypeEventPropMap", "getFieldValueType", "extend", "obj", "obj2", "obj3", "obj4", "obj5", "extended", "deep", "i", "length", "objProto", "strShimPrototype", "theArgs", "objForEachKey", "prop", "value", "isObject", "isArray", "arrForEach", "arrayValue", "arrayIndex", "getTime", "perfNow", "isValueKind", "isDataType", "isArrayValid", "value", "setProcessTelemetryTimings", "event", "identifier", "evt", "getTime", "getFieldValueType", "theType", "objType", "strShimObject", "isArray", "ObjHasOwnProperty", "isChromium", "getGlobalInst", "openXhr", "method", "urlString", "withCredentials", "disabled", "isSync", "timeout", "_wrapSetXhrProp", "xhr", "prop", "value", "e", "strDisabledPropertyName", "strWithCredentials", "strTimeout", "AppInsightsCore", "_super", "__extendsFn", "_this", "dynamicProto", "_self", "_base", "DiagnosticLogger", "config", "extensions", "logger", "notificationManager", "doPerf", "_pluginVersionStringArr", "STR_DEFAULT_ENDPOINT_URL", "propertyStorageOverride", "throwError", "arrForEach", "channels", "channel", "ver", "ext", "e", "logger_1", "message", "dumpObj", "_throwInternal", "item", "telemetryItem", "getTime", "isLatency", "itemExt", "FullVersionString", "baseData", "STR_PROPERTIES", "itemProperties", "STR_VERSION", "STR_EMPTY", "AppInsightsCore_default", "DATA_TOKEN", "CONTRACT_TOKEN", "RELEASE_AUDIENCEGROUP", "APP_NAME", "APP_PLATFORM", "APP_VERSION", "USER_PRIMARYIDENTITYHASH", "USER_PRIMARYIDENTITYSPACE", "USER_TENANTID", "USER_ISANONYMOUS", "USER_ISSIGNEDIN", "SESSION_ID", "ARIA_OFFICE_TELEMETRY_TOKEN", "CUSTOMER_CONTENT_TENANT_TOKEN", "voidValue", "addOneDSFields", "data", "fields", "prependDataToken", "eventType", "validEvent", "field", "fieldClassification", "fieldDataType", "fieldName", "logNotification", "modifiedFieldName", "CONTRACT_TOKEN", "DATA_TOKEN", "eventPropertyType", "eventProperty", "_i", "fields_1", "tryCatch", "func", "errorReturn", "error", "logError", "preprocessEvent", "telemetryEvent", "preprocessors", "i", "preprocessor", "logInvalidField", "isNonEmptyString", "value", "isString", "matchesEnum", "enumType", "isValidAppPlatform", "Platform", "isValidReleaseAudienceGroup", "AudienceGroup", "isValidPrimaryIdentitySpace", "isOtherIfDefined", "areCoreFieldsValid", "strict", "isValid", "validateField", "validate", "isValidGuid", "regexpFlags", "guid", "RELEASE_AUDIENCEGROUP", "isBoolean", "isNullOrUndefined", "getTimestamp", "event", "MAX_CUSTOMER_CONTENT_MAJOR_VERSION", "OneDSHelper", "persistentDataFields", "oneDSHelperProperties", "_this", "_preprocessors", "_optionalEventsEnabled", "_isEnabled", "_diagnosticLevelChecker", "telemetryEvent", "diagnosticLevel", "_helperPersistentOneDSDataFields", "_oneDSSinkSessionId", "newGuid", "_disableSinkOnInvalidCoreFields", "areCoreFieldsValid", "getOneDSEventInternal", "customerContentVersion", "MAX_CUSTOMER_CONTENT_MAJOR_VERSION", "getTenantToken", "eventType", "CUSTOMER_CONTENT_TENANT_TOKEN", "logNotification", "eventProperties", "internalEvent", "cloneEvent", "preprocessEvent", "eventTime", "getTimestamp", "data", "fieldName", "addOneDSFields", "baseType", "token", "oneDSEvent", "preprocessor", "addPersistentDataFields", "dataFields", "enabled", "coreFields", "App", "User", "Session", "release", "Release", "RT_PROFILE", "NRT_PROFILE", "BE_PROFILE", "STR_EMPTY", "STR_POST_METHOD", "STR_DISABLED_PROPERTY_NAME", "STR_DROPPED", "STR_SENDING", "STR_REQUEUE", "STR_RESPONSE_FAIL", "STR_OTHER", "DEFAULT_CACHE_CONTROL", "DEFAULT_CONTENT_TYPE", "STR_CACHE_CONTROL", "STR_CONTENT_TYPE_HEADER", "STR_KILL_TOKENS_HEADER", "STR_KILL_DURATION_HEADER", "STR_KILL_DURATION_SECONDS_HEADER", "STR_TIME_DELTA_HEADER", "STR_CLIENT_VERSION", "STR_CLIENT_ID", "STR_TIME_DELTA_TO_APPLY", "STR_UPLOAD_TIME", "STR_API_KEY", "STR_MSA_DEVICE_TICKET", "STR_AUTH_XTOKEN", "STR_NO_RESPONSE_BODY", "STR_MSFPC", "STR_TRACE", "STR_USER", "_getEventMsfpc", "theEvent", "intWeb", "isValueAssigned", "STR_MSFPC", "_getMsfpc", "theEvents", "msfpc", "lp", "EventBatch", "iKey", "addEvents", "events", "_self", "_msfpc", "STR_EMPTY", "fromEvent", "numEvents", "cnt", "isNullOrUndefined", "ClockSkewManager", "_allowRequestSending", "_shouldAddClockSkewHeaders", "_isFirstRequest", "_clockSkewHeaderValue", "_clockSkewSet", "dynamicProto", "_self", "timeDeltaInMillis", "ClockSkewManager_default", "SecToMsMultiplier", "KillSwitch", "_killedTokenDictionary", "_normalizeTenants", "values", "result", "arrForEach", "value", "strTrim", "dynamicProto", "_self", "killTokens", "killDuration", "killedTokens", "durationMs", "i", "dateNow", "ex", "tenantToken", "killDictionary", "name", "KillSwitch_default", "RandomizationLowerThreshold", "RandomizationUpperThreshold", "BaseBackoff", "MaxBackoff", "retryPolicyShouldRetryForStatus", "httpStatusCode", "retryPolicyGetMillisToBackoffForRetry", "retriesSoFar", "waitDuration", "minBackoff", "maxBackoff", "randomBackoff", "_MAX_STRING_JOINS", "RequestSizeLimitBytes", "BeaconRequestSizeLimitBytes", "MaxRecordSize", "MaxBeaconRecordSize", "metadata", "f", "rCheckDot", "Serializer", "perfManager", "valueSanitizer", "stringifyObjects", "enableCompoundKey", "strData", "strBaseData", "strExt", "_checkForCompoundkey", "_processSubMetaData", "_theSanitizer", "_isReservedCache", "dynamicProto", "_self", "retryCnt", "isTeardown", "isSync", "isReducedPayload", "sendReason", "sendType", "STR_EMPTY", "payload", "theBatch", "maxEventsPerBatch", "canAddEvents", "doPerf", "theEvents", "payloadBlob", "payloadEvents", "eventsAdded", "sizeExceeded", "failedEvts", "isBeaconPayload", "requestMaxSize", "recordMaxSize", "lp", "joinCount", "theEvent", "eventBlob", "blobLength", "currentSize", "EventBatch", "apiKey", "arrIndexOf", "eventData", "serializedEvent", "getTenantId", "serializedExt", "eventExt", "objForEachKey", "key", "value", "data", "_processPathKeys", "serializedData", "serializedBaseData", "pathKeys", "name", "_addJSONPropertyMetaData", "e", "_isReservedField", "path", "result", "strStartsWith", "srcObj", "target", "thePath", "checkReserved", "metadataPathKeys", "metadataCallback", "processSubKeys", "srcValue", "prop", "isValueAssigned", "name_1", "theMetaPathKeys", "destObj", "subKeys", "keyLen", "subKey", "isReserved", "sanitizeProperty", "newValue", "isArray", "newPath", "_addJSONPropertyMetaData", "json", "propKeys", "name", "propertyValue", "encodedTypeValue", "getCommonSchemaMetaData", "metaData", "metadata", "metaTarget", "f", "lp", "key", "newTarget", "isArray", "_a", "strSendAttempt", "_noResponseQs", "STR_NO_RESPONSE_BODY", "_eventActionMap", "STR_REQUEUE", "STR_DROPPED", "_collectorQsHeaders", "_collectorHeaderToQs", "_addCollectorHeaderQsMapping", "qsName", "headerName", "allowQs", "STR_MSA_DEVICE_TICKET", "STR_CLIENT_VERSION", "STR_CLIENT_ID", "STR_API_KEY", "STR_TIME_DELTA_TO_APPLY", "STR_UPLOAD_TIME", "STR_AUTH_XTOKEN", "_getResponseText", "xhr", "e", "STR_EMPTY", "_hasHeader", "headers", "header", "hasHeader", "keys", "objKeys", "lowerHeader", "lp", "value", "hasOwnProperty", "_addRequestDetails", "details", "name", "useHeaders", "_prependTransports", "theTransports", "newTransports", "isNumber", "isArray", "HttpManager", "maxEventsPerBatch", "maxConnections", "maxRequestRetriesBeforeBackoff", "actions", "timeoutOverride", "_urlString", "STR_CONTENT_TYPE_HEADER", "DEFAULT_CONTENT_TYPE", "_killSwitch", "KillSwitch_default", "_paused", "_clockSkewManager", "ClockSkewManager_default", "_useBeacons", "_outstandingRequests", "_postManager", "_logger", "_sendInterfaces", "_core", "_customHttpInterface", "_queryStringParameters", "_headers", "_batchQueue", "_serializer", "_enableEventTimings", "_cookieMgr", "_isUnloading", "_useHeaders", "_xhrTimeout", "_disableXhrSync", "_disableFetchKeepAlive", "_canHaveReducedPayload", "_addNoResponse", "dynamicProto", "_self", "_sendCredentials", "endpointUrl", "core", "postChannel", "httpInterface", "channelConfig", "isUndefined", "enableCompoundKey", "valueSanitizer", "stringifyObjects", "isReactNative", "Serializer", "isNullOrUndefined", "syncHttpInterface", "beaconHttpInterface", "fetchSyncHttpInterface", "beaconUnloadTransports", "location_1", "getLocation", "_getSenderInterface", "_warnToConsole", "isBeaconsSupported", "isFetchSupported", "transports", "syncSupport", "transportType", "sendPostFunc", "useXDomainRequest", "_xdrSendPost", "isXhrSupported", "_xhrSendPost", "_fetchSendPost", "_beaconSendPost", "payload", "oncomplete", "sync", "xdr", "STR_POST_METHOD", "response", "_doOnComplete", "_handleCollectorResponse", "theUrl", "ignoreResponse", "responseHandled", "requestInit", "STR_DISABLED_PROPERTY_NAME", "headerMap", "responseText", "text", "error", "_appendHeader", "theHeaders", "strTrim", "_getAllResponseHeaders", "_convertAllHeadersToMap", "STR_TIME_DELTA_HEADER", "STR_KILL_DURATION_HEADER", "STR_KILL_DURATION_SECONDS_HEADER", "xhrComplete", "responseTxt", "xhrRequest", "openXhr", "objForEachKey", "status", "_throwInternal", "dumpObj", "internalPayloadData", "thePayload", "nav_1", "getNavigator", "droppedBatches_1", "arrForEach", "theBatch", "theEvents", "_sendBatchesNotification", "ex", "_isBeaconPayload", "sendType", "_adjustSendType", "i", "_hasIdleConnection", "sendReason", "_canSendPayload", "_sendBatches", "_clearQueue", "batch", "theQueue", "theBatches", "retryCnt", "result", "_createDebugBatches", "values", "idx", "retryCount", "isTeardown", "orgBatches_1", "isSynchronous_1", "doPerf", "perfEvt", "droppedBatches", "serializationStart", "getTime", "sendInterface", "sendTransport", "isReducedPayload", "_doPayloadSend", "_buildRequestDetails", "requestDetails", "extend", "FullVersionString", "apiQsKeys", "apiKey", "dateNow", "msfpc", "_getMsfpc", "isValueAssigned", "wParam", "_setTimingValue", "timings", "serializationCompleted", "useSendHook_1", "sendInterface_1", "useHeaders_1", "requestDetails_1", "sendEventStart_1", "batchLp", "evtLp", "telemetryItem", "orgPayloadData", "STR_CACHE_CONTROL", "DEFAULT_CACHE_CONTROL", "sender", "onComplete", "_retryRequestIfNeeded", "isSync", "hookData_1", "senderCalled_1", "_addEventCompletedTimings", "sendEventCompleted", "theEvent", "reason", "isRetrying", "backOffTrans", "shouldRetry", "strShimUndefined", "killDuration", "STR_KILL_TOKENS_HEADER", "killToken", "removedEvents", "retryPolicyShouldRetryForStatus", "retryCount_1", "_doAction", "retryPolicyGetMillisToBackoffForRetry", "_handleRequestFinished", "batchReason", "_addCompleteTimings", "sendEventCompleted_1", "cb", "interval", "headersString", "isString", "headersArray", "headerEntry", "responseHandlers", "STR_MSFPC", "sendSync", "theAction_1", "_getNotificationAction", "isSyncRequest_1", "action", "STR_OTHER", "STR_RESPONSE_FAIL", "STR_SENDING", "defaultSetTimeout", "callback", "ms", "args", "_i", "defaultClearTimeout", "timeoutId", "createTimeoutWrapper", "argSetTimeout", "argClearTimeout", "FlushCheckTimer", "MaxNumberEventPerBatch", "EventsDroppedAtOneTime", "MaxSendAttempts", "MaxSyncUnloadSendAttempts", "MaxBackoffCount", "MaxConnections", "MaxRequestRetriesBeforeBackoff", "strEventsDiscarded", "strOverrideInstrumentationKey", "strMaxEventRetryAttempts", "strMaxUnloadEventRetryAttempts", "strAddUnloadCb", "PostChannel", "_super", "__extendsFn", "_this", "_config", "_isTeardownCalled", "_flushCallbackQueue", "_flushCallbackTimerId", "_paused", "_immediateQueueSize", "_immediateQueueSizeLimit", "_queueSize", "_queueSizeLimit", "_profiles", "_currentProfile", "RT_PROFILE", "_scheduledTimerId", "_immediateTimerId", "_currentBackoffCount", "_timerCount", "_xhrOverride", "_httpManager", "_batchQueues", "_autoFlushEventsLimit", "_autoFlushBatchLimit", "_delayedBatchSendLatency", "_delayedBatchReason", "_optimizeObject", "_isPageUnloadTriggered", "_maxEventSendAttempts", "_maxUnloadEventSendAttempts", "_evtNamespace", "_timeoutWrapper", "dynamicProto", "_self", "_base", "_initDefaults", "coreConfig", "core", "extensions", "doPerf", "extendedCore", "hasAddUnloadCb", "mergeEvtNamespace", "createUniqueNamespace", "ctx", "createTimeoutWrapper", "isChromium", "_hookWParam", "isNumber", "_setAutoLimits", "isValueAssigned", "endpointUrl", "excludePageUnloadEvents", "addPageUnloadEventListener", "_handleUnloadEvents", "addPageHideEventListener", "addPageShowEventListener", "_handleShowEvents", "e", "ev", "itemCtx", "setProcessTelemetryTimings", "channelConfig", "disableTelemetry", "event", "_addEventToQueues", "_releaseAllQueues", "_scheduleTimer", "unloadCtx", "unloadState", "removePageUnloadEventListener", "removePageHideEventListener", "removePageShowEventListener", "existingGetWParamMethod", "wparam", "evt", "theEvt", "getWindow", "append", "STR_TRACE", "STR_USER", "optimizeObject", "EventBatch", "evtLatency", "queueSize", "queueLimit", "eventDropped", "_addEventToProperQueue", "dropLatency", "dropNumber", "_dropEventWithLatencyOrLess", "_notifyEvents", "EventsDiscardedReason", "eventLimit", "autoFlushLimit", "doFlush", "latency", "batchQueue", "arrForEach", "theBatch", "_performAutoFlush", "_clearScheduledTimer", "responseHandler", "profiles", "_resetTransmitProfiles", "objForEachKey", "profileName", "profileValue", "profLen", "directValue", "timerMultiplier", "async", "callback", "sendReason", "_queueBatches", "_createTimer", "_flushImpl", "cleared", "_sendEventsForLatencyAndAbove", "ticket", "STR_MSA_DEVICE_TICKET", "_hasEvents", "sendType", "queued", "immediateTimeOut", "timeOut", "HttpManager", "_requeueEvents", "_sendingEvent", "_eventsSentEvent", "_eventsDropped", "_eventsResponseFail", "_otherEvent", "_initializeProfiles", "_clearQueues", "theTimerFunc", "retryPolicyGetMillisToBackoffForRetry", "_getEventBatch", "iKey", "create", "eventBatch", "isAsync", "currentLatency", "droppedEvents", "droppedCount", "_notifyBatchEvents", "_resetQueueCounts", "immediateQueue", "normalQueue", "_loop_1", "eventsQueued", "latencyToProcess", "_waitForIdleManager", "NRT_PROFILE", "BE_PROFILE", "batches", "reason", "maxSendAttempts", "theEvent", "_callNotification", "evtName", "theArgs", "manager", "notifyFunc", "_throwInternal", "theEvents", "extraArgs", "_i", "isSyncRequest", "objDefineAccessors", "value", "BaseTelemetryPlugin", "PostChannel_default", "SEND_BATCHES_EVENT", "PRIVACY_GUARD_PROCESSING_TIME_EVENT", "PerfEvent", "name", "payload", "isAsync", "getCurrentMilliseconds", "PerfManager", "callbacks", "src", "payload", "isAsync", "SEND_BATCHES_EVENT", "PRIVACY_GUARD_PROCESSING_TIME_EVENT", "evt", "PerfEvent", "perfEvent", "_key", "_value", "eventCount", "index", "getAppInsights", "oneDSSinkProperties", "instrumentationKey", "httpXHROverride", "appInsightsConfig", "__assign", "originalPayload", "modifiedPayload", "actualPayload", "_a", "applicationInsights", "ApplicationInsights", "PerfManager", "hookUp1DSNotifications", "oneDSSink", "events", "logNotification", "reason", "EventsDiscardedReason", "_super", "__extends", "config", "extensions", "PostChannel_default", "plugins", "error", "uploadFrequency", "normalLatencyFrequency", "realtimeLatencyFrequency", "customProfiles", "async", "AppInsightsCore_default", "OneDSSink", "_super", "__extends", "persistentDataFields", "oneDSSinkProperties", "_this", "_applicationInsights", "telemetryEvent", "tryCatch", "event", "voidValue", "_customerContentEvent", "eventType", "isHandled", "nonStandardEventHandlers", "handler", "logNotification", "async", "e", "getAppInsights", "ARIA_OFFICE_TELEMETRY_TOKEN", "hookUp1DSNotifications", "OneDSHelper", "TelemetrySinkProvider", "__publicField", "isEUDBUser", "persistentDataFields", "User", "App", "Session", "OneDSSink", "OneDSEndpoint", "telemetryEvent", "timestamp", "_a", "_b", "_c", "eventId", "field", "message", "errorMessage", "floodgateLogString", "import_floodgate_shared_typings", "SyncTasks", "import_subscribableevent", "import_ecsclient", "isNOU", "value", "import_floodgate_shared_typings", "SyncTasks", "StorageProvider", "storageProvider", "config", "e", "resolve", "_type", "package_default", "filters", "DefaultFloodgateECSOptions", "package_default", "DefaultConfig_default", "TelemetryEvents", "EcsClient", "dynamicCampaignOptions", "_storageProvider", "SubscribableEvent", "isNOU", "StorageProvider_default", "__spreadArray", "__read", "DefaultConfig_default", "_b", "_a", "floodgateEcsOptions", "__assign", "parameters", "__values", "_c", "key", "SkypeEcsClient", "x", "eventName", "eventData", "_this", "TelemetryEvents", "e_2", "import_floodgate_shared_typings", "import_officefloodgatecore", "import_CampaignDefinitionProvider", "import_Constants", "import_gatecrash", "import_auto", "globalLogger", "message", "data", "_i", "eventName", "customLogData", "samplingRatio", "userFactValue", "getLogger", "setLogger", "logger", "Configuration", "sessionId", "userFactRules", "configuration", "Configuration", "get", "PERSONALIZATION_DEFAULT_CACHE_EXPIRATION", "defaultSettingsProd", "defaultSettingsInt", "defaultSettingsEdog", "customSettings", "initSettings", "inputSettings", "defaultSettings", "environment", "_a", "__assign", "getSetting", "name", "getSamplingRate", "rate", "w", "getGlobal", "w", "isStorageAvailable", "x", "getGlobal", "e", "readObjectFromStorage", "storageKey", "defaultValue", "result", "parsedObject", "writeToStorage", "content", "contentString", "saveToCache", "contentType", "content", "expiryTime", "storageKey", "cacheItem", "createItem", "setItem", "updateCache", "getItem", "getCachedContent", "getValidCachedContent", "defaultValue", "isCacheItemExpired", "isCachedTypeExpired", "writeToStorage", "cachedItem", "readObjectFromStorage", "AppUsageUserFactType", "ComparatorType", "AppLastUsedEventNames", "CompareDataPropertyToDataField", "prop", "dataField", "ComparatorType", "CompareDataPropertyToTelemetryEvent", "event", "property", "eventContractData", "EvaluateEvent", "manifest", "eventTime", "lastSourceTime", "dedupPassed", "HasDedupIntervalPassed", "getLogger", "getSamplingRate", "EvaluateTelemetryEvent", "m", "dedupIntervalSeconds", "g", "support", "isDataView", "obj", "viewClasses", "isArrayBufferView", "normalizeName", "name", "normalizeValue", "value", "iteratorFor", "items", "iterator", "Headers", "headers", "header", "oldValue", "callback", "thisArg", "consumed", "body", "fileReaderReady", "reader", "resolve", "reject", "readBlobAsArrayBuffer", "blob", "promise", "readBlobAsText", "match", "encoding", "readArrayBufferAsText", "buf", "view", "chars", "i", "bufferClone", "Body", "rejected", "isConsumed", "decode", "methods", "normalizeMethod", "method", "upcased", "Request", "input", "options", "ctrl", "reParamSearch", "reQueryString", "form", "bytes", "split", "parseHeaders", "rawHeaders", "preProcessedHeaders", "line", "parts", "key", "error", "Response", "bodyInit", "response", "redirectStatuses", "url", "status", "DOMException", "err", "message", "fetch", "init", "request", "xhr", "abortXhr", "fixUrl", "e", "names", "createTimeoutPromise", "ms", "promise", "timeout", "resolve", "reject", "id", "getErrorMessage", "value", "_c", "_b", "_a", "isNOU", "guid", "randomHex4", "isArray", "isFunction", "isObject", "FETCH_TIMEOUT", "sendGetRequest", "requestUrl", "token", "sessionId", "useTimeout", "timeout", "requestInit", "createHeaders", "timeoutFetch", "sendPostRequest", "requestBody", "requestHeaders", "headers", "isNOU", "key", "guid", "input", "init", "resolve", "reject", "ContentTypeToStorageKeyMap", "_a", "UserFactLocalStorageKey", "ContentTypeToStorageKeyMap", "getCachedUserFacts", "userId", "getCachedContent", "getUnExpiredCachedUserFacts", "getValidCachedContent", "mergeLocalUserFacts", "inputUserFacts", "localUserFacts", "localFact", "localSourcedFact", "matchingInputFact", "inputFact", "createStringOfFactNames", "factNames", "getUserFactNames", "userFacts", "uf", "createTelemetryData", "requestStartTimestamp", "response", "count", "samplingRate", "_a", "headers", "status", "statusText", "serverSessionId", "serverCorrelationId", "fetchUserFacts", "authToken", "requestStartTime", "serviceUrl", "getSetting", "getSamplingRate", "sendGetRequest", "get", "userFactsResponse", "updateAndSaveUserFacts", "getLogger", "__assign", "getErrorMessage", "error_1", "fetchUserFactsWithTimeout", "userFactsPromise", "requestTimeout", "createTimeoutPromise", "normalizedUserFacts", "addClientIngestionTimeAndNormalizeKeys", "mergeLocalUserFacts", "cacheExpiration", "saveToCache", "UserFactLocalStorageKey", "tulipsResponseFacts", "currentDateTime", "responseFact", "fact", "normalizeKeys", "addOrUpdateAppUsageUserFact", "userFactName", "newSourceDateTime", "newFact", "AppUsageUserFactType", "userFact", "normalizedUserFact", "_i", "key", "normalizedKey", "authTokenConfigProd", "mapUserFacts", "userFacts", "userFactMap", "uf", "getUserFactList", "userId", "authCallback", "getUnExpiredCachedUserFacts", "_a", "_c", "authToken", "_b", "fetchUserFactsWithTimeout", "getLogger", "getErrorMessage", "exception_1", "createTelemetryDataForCacheRead", "getUserFactNames", "getSamplingRate", "getUserFactManifest", "get", "sendAppLastUsed", "appId", "lastUsedTime", "AppLastUsedEventNames", "processUserFactEvent", "processTelemetryEvent", "telemetryEvent", "userFactRules", "getLogger", "getSamplingRate", "manifest", "cachedFactLastSourceTime", "readLastSourceTimeFromCache", "userFactTime", "EvaluateTelemetryEvent", "sendUserFact", "error", "getErrorMessage", "eventName", "EvaluateEvent", "userFactName", "writeFactToCache", "factKey", "cachedUserFacts", "mapUserFacts", "getCachedUserFacts", "lastSourceTime", "factTime", "cacheExpiration", "getSetting", "mergedFacts", "addOrUpdateAppUsageUserFact", "updateCache", "UserFactLocalStorageKey", "createTelemetryDataForCacheRead", "count", "factNames", "createStringOfFactNames", "initialize", "config", "setLogger", "initSettings", "get", "_a", "currentDateTime", "filteredRules", "filterDisabledUserFactRules", "getLogger", "getSamplingRate", "_b", "sendAppLastUsed", "disabledUserFacts", "userFactRules", "enabledRulesMap", "key", "fact", "customerVoiceLauncherType", "customerVoiceSurveyUX", "FeedbackType", "DynamicScriptUrls", "GUIDs", "SDK_VERSION_PREFIX", "SDK_UXID_VERSION", "SDK_DEFAULT_PERSONALIZATIONSAMPLINGRATE", "CentroDefaultTheme", "FeatureGateNames", "supportedLocales", "localeVariantToSupportedlocaleMap", "validate", "locale", "localeUpperCase", "supportedLocale", "localePartOne", "Utils_exports", "__export", "convertAutoDismissToTimeInMs", "createTimeoutPromise", "expectArray", "expectBoolean", "expectEnum", "expectFunction", "expectGuid", "expectNumber", "expectObject", "expectSimpleType", "expectString", "guid", "isBoolean", "isInteger", "isNOU", "isObject", "isString", "isTenantIdCommercial", "ocpsBooleanToString", "ocpsEnumToString", "overrideValues", "scrubContent", "import_officefloodgatecore", "isEnumValue", "isNumber", "value", "isInteger", "isGuid", "isString", "expectObject", "name", "isObject", "expectNumber", "expectString", "expectBoolean", "isBoolean", "expectGuid", "expectArray", "expectEnum", "enumType", "isEnumValue", "expectSimpleType", "expectFunction", "isNOU", "createTimeoutPromise", "ms", "promise", "timeout", "resolve", "reject", "id", "isTenantIdCommercial", "tenantId", "lowerTenantId", "ocpsBooleanToString", "policyValue", "ocpsEnumToString", "convertAutoDismissToTimeInMs", "autoDismiss", "autoDismissDuration", "scrubContent", "input", "tagPatterns", "scrubbedContent", "pattern", "CustomResources", "AgeGroup", "AuthenticationType", "import_floodgate_shared_typings", "import_Utils", "import_floodgate_shared_typings", "import_floodgate_shared_typings", "isNOU", "dynamicSettingsTmsgCache", "parseObjectFromCache", "tempItem", "tempCacheItem", "e", "getDynamicSetting", "key", "defaultValue", "isStorageAvailable", "tempStorageItem", "readObjectFromStorage", "ContentTypeToStorageKeyMap", "settingsObj", "settingValue", "returnValue", "error", "getLogger", "App", "_App", "name", "version", "Session", "id", "Host", "locale", "sessionId", "Event", "_Event", "sequence", "sampleRate", "Release", "audienceGroup", "Browser", "Device", "OtelTelemetryLogger", "_OtelTelemetryLogger", "ariaTenantId", "namespace", "telemetrySink", "app", "session", "host", "release", "browser", "device", "nexusTenantToken", "SuppressNexus", "TelemetryLogger", "eventName", "customProperties", "sampleRate", "otelTelemetryEvent", "telemetryEvent", "isNOU", "makeStringDataField", "makeDoubleDataField", "key", "customProperty", "dataField", "scrubContent", "makeBooleanDataField", "oesApp", "oesHost", "oesRelease", "oesBrowser", "oesDevice", "dataFields", "TelemetryLoggerFactory", "tenantToken", "namespace", "telemetrySink", "app", "session", "host", "release", "browser", "device", "OtelTelemetryLogger", "EventIds", "_a", "_b", "_c", "_d", "_e", "_f", "_g", "_h", "_j", "_k", "_l", "_m", "_o", "_p", "_q", "_r", "_s", "_t", "_u", "_v", "_w", "_x", "_y", "_z", "_0", "_1", "_2", "_3", "_4", "_5", "_6", "_7", "_8", "_9", "_10", "_11", "_12", "_13", "_14", "_15", "_16", "_17", "_18", "_19", "_20", "_21", "_22", "_23", "_24", "_25", "_26", "isNOU", "Utils_exports", "FEEDBACK_NAMESPACE", "ENGAGEMENT_NAMESPACE", "logger", "userFactLogger", "env", "initialize", "initOptionsCommon", "appName", "appVersion", "logSessionId", "samplingOption", "telemetryGroup", "webGroup", "Logger", "TelemetryLoggerFactory", "TokenManager", "App", "Session", "Host", "Release", "Browser", "Device", "UserFactLogger", "getLogger", "getUserFactLogger", "_Logger", "telemetryLogger", "samplingOptions", "eventId", "logSeverity", "customProperties", "internalSampleRate", "sampleRate", "errorMessage", "_c", "_b", "_a", "get", "_f", "_e", "_d", "others", "eventName", "appId", "locale", "settingName", "overrideSettings", "e", "inputLogLevel", "inputSampleRate", "currentLogLevel", "urlParams", "consoleLogParam", "documentReferrer", "logLevelParam", "FloodgateStorageProvider", "tempStorageItem", "FileType", "getDynamicSetting", "settingsObj", "logSettings", "tempItem", "_UserFactLogger", "userFactName", "factValue", "_TokenManager", "environment", "namespace", "fileTypeToKeyMap", "FileType", "FloodgateStorageProvider", "x", "getGlobal", "e", "fileType", "defaultValue", "storageKey", "result", "parsedObject", "getLogger", "EventIds", "content", "import_floodgate_shared_typings", "featureGateOverrides", "readFeatureGateOverridesFromCache", "featureGateName", "FloodgateStorageProvider", "FeatureGateProvider", "featureStatusCallback", "featureGateName", "defaultValue", "cacheOverride", "readFeatureGateOverridesFromCache", "_a", "overrideValue", "PersonalizationLogger", "message", "data", "getLogger", "eventName", "customLogData", "samplingRatio", "userFact", "userFactValue", "getUserFactLogger", "CentroUrlProd", "CentroFloodgateContainerId", "CentroFloodgateInitOptions", "CentroThemeInitOptions", "CentroCommonInitOptions", "CentroFloodgateFeatureName", "CentroFloodgateHostName", "CentroFloodgatePerfPrefix", "CentroPetrolUploadEndpoint", "FloodgateCentroVersion", "AttributeName", "AttributeValue", "UrlParameters", "Classes", "IDs", "Keys", "Tags", "Roles", "Urls", "PromptConstants", "Configuration", "_Configuration", "categories", "expectBoolean", "expectArray", "customCategory", "expectString", "value", "guid", "passedInitOptions", "expectObject", "initOptions", "Urls", "expectNumber", "expectedValues", "CustomResources", "hexColourRegex", "validate", "err", "expectEnum", "AuthenticationType", "AgeGroup", "submitted", "launchOptions", "overrideValues", "campaignId", "defaultOnSurveyActivatedCallback", "launcher", "survey", "surveyParams", "str", "isNOU", "expectFunction", "e", "_a", "_b", "FeatureGateProvider", "samplingRate", "SDK_DEFAULT_PERSONALIZATIONSAMPLINGRATE", "personalizationSettings", "PersonalizationLogger", "context", "_c", "styleSubstrings", "themeConfig", "authenticationType", "ageGroup", "samplingOptions", "eventInitSampling", "index", "sampleRate", "config", "defaultGovernanceServiceConfig", "defaultDynamicCampaignConfig", "defaultDynamicUxConfig", "key", "expectSimpleType", "parsedThemeConfig", "_d", "CentroFloodgateHostName", "defaultDynamicUxThemeConfig", "CentroDefaultTheme", "centroThemeDS", "parsedThemeConfigResult", "error", "sinkObj", "configuration", "get", "Version_default", "APP_NAME", "initialized", "commonPolicyAllowAADC", "initialize", "get", "Version_default", "getLogger", "EventIds", "isFeedbackSurveyEnabledByAADC", "commonPolicyAllowAADC", "updateTelemetrySink", "sink", "get", "getLogger", "initialize", "APP_NAME", "Version_default", "e", "setIsFeedbackSurveyEnabledByAADC", "setUpdateTelemetrySink", "import_floodgate_shared_typings", "import_Utils", "import_Utils", "DynamicContentTransport", "requestUrl", "body", "retry", "timeout", "resolve", "reject", "error", "getLogger", "EventIds", "token", "headers", "requestInit", "controller", "timeoutId", "response", "govServiceIntURL", "govServiceProdURL", "GovernanceServiceClient", "configuration", "DynamicContentTransport", "featureGateProvider", "FeatureGateNames", "userIdOverride", "governedChannelType", "_a", "governanceParams", "campaignInfo", "requestUrl", "body", "serviceResult", "response", "serviceCallTime", "timeBefore", "responseText", "getLogger", "EventIds", "jsonResponse", "isCampaignGovernanceEnabled", "e", "stringType", "surveyType", "newDate", "userLevelCooldown", "result", "objectTelemetry", "governanceServiceClient", "get", "import_floodgate_shared_typings", "import_officefloodgatecore", "govServiceIntReward", "govServiceProdReward", "PersonalizerClient", "DynamicContentTransport", "configuration", "eventId", "configType", "configValue", "surveyId", "campaignId", "newRecommendedAutoDismissValue", "userAction", "responseResult", "actionPayload", "getLogger", "EventIds", "response", "timeBefore", "timeAfter", "error", "surveyType", "launcherType", "governedChannelType", "customerVoiceLauncherType", "governanceParameters", "serviceResult", "_a", "surveyPersonalizerInfo", "objectTelemetry", "personalizerClient", "get", "import_floodgate_shared_typings", "import_officefloodgatecore", "import_CampaignDefinitionProvider", "import_Constants", "import_FeatureGateProvider", "import_Governor", "import_SurveyActivityListener", "import_officefloodgatecore", "import_floodgate_shared_typings", "import_officefloodgatecore", "import_floodgate_shared_typings", "buildQueryParameters", "keyAndValues", "encodeValueAsURI", "queryParamsString", "key", "value", "prefix", "encodedValue", "queryParamItem", "CACHE_EXPIRY_MESSAGEMETADATA", "CACHE_EXPIRY_USERGOVERNANCERULES", "CACHE_EXPIRY_CAMPAIGNCONTENT", "CACHE_EXPIRY_DYNAMICSETTINGS", "CACHE_EXPIRY_LOGLEVELSETTINGS", "CACHE_EXPIRY_USERFACTS", "TMS_CAMPAIGNMETADATAAGGREGATOR_ENDPOINT", "TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_EDOG", "TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_PROD", "TMS_CAMPAIGN_LOAD_TIMEOUT", "TMS_SETCAMPAIGNACTION_ENDPOINT", "TMS_SETCAMPAIGNACTION_PREFIX_EDOG", "TMS_SETCAMPAIGNACTION_PREFIX_PROD", "TULIPS_SERVICEURL", "TULIPS_LOAD_TIMEOUT", "TULIPS_INGESTION_TIME", "GUIDs", "ContentResponse", "getDebugCampaignDefinitions", "debugOverrides", "readObjectFromStorage", "getDebugUserFacts", "TargetedMessagingClient", "app", "platform", "version", "locale", "country", "sessionId", "authTokenCallback", "campaignFlights", "campaignParameters", "ageGroup", "authType", "audience", "messagingServiceSettings", "packageVersion", "internalEnvs", "isInternalEnv", "campaignMetadataAggregatorConfig", "_a", "_b", "setCampaignActionConfig", "_c", "_d", "cmaDefaultBaseUrlPrefix", "TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_EDOG", "TMS_CAMPAIGNMETADATAAGGREGATOR_PREFIX_PROD", "scaDefaultBaseUrlPrefix", "TMS_SETCAMPAIGNACTION_PREFIX_EDOG", "TMS_SETCAMPAIGNACTION_PREFIX_PROD", "requestedContent", "isCachedTypeExpired", "ContentTypeToStorageKeyMap", "response", "contentResponses", "bulkRefreshList", "_i", "requestedContent_1", "contentType", "responseItem", "beaconParameters", "authTokenConfig", "getDynamicSetting", "GUIDs", "authToken", "puid", "requestStartTime", "tmsQueryParams", "requestBody", "header", "TMS_SETCAMPAIGNACTION_ENDPOINT", "getLogger", "__assign", "getErrorMessage", "error_1", "getUserFactList", "campaignIds", "campaign", "requestStartTimestamp", "type", "headers", "status", "statusText", "serverSessionId", "serverCorrelationId", "tmsgQueryParams", "key", "defaultBaseUrl", "requestHeaders", "verb", "queryParamStr", "buildQueryParameters", "tmsgBaseUrl", "requestPromise", "sendPostRequest", "sendGetRequest", "getSamplingRate", "contentResponse", "ContentResponse", "getCachedContent", "startTime", "getDuration", "samplingRate", "createAuthTelemetryLogData", "message", "tokenLength", "_this", "retVal", "error_2", "contentTypes", "contentTypes_1", "userPuid", "documentElement", "browserParams", "TMS_CAMPAIGNMETADATAAGGREGATOR_ENDPOINT", "tmsServiceResponse", "saveToCache", "CACHE_EXPIRY_MESSAGEMETADATA", "CACHE_EXPIRY_USERGOVERNANCERULES", "CACHE_EXPIRY_CAMPAIGNCONTENT", "CACHE_EXPIRY_DYNAMICSETTINGS", "CACHE_EXPIRY_LOGLEVELSETTINGS", "error_3", "TULIPS_SERVICEURL", "tulipsServiceResponse", "normalizedUserFacts", "addClientIngestionTimeAndNormalizeKeys", "CACHE_EXPIRY_USERFACTS", "error_4", "AssetsProvider", "get", "setLogger", "PersonalizationLogger", "floodgateInitOptions", "commonInitOptions", "authTokenCallback", "initOptions", "TargetedMessagingClient", "_a", "_b", "debugResponse", "getDebugCampaignDefinitions", "content", "getCachedContent", "getDebugUserFacts", "timeoutMilliseconds", "getDynamicSetting", "TULIPS_LOAD_TIMEOUT", "createTimeoutPromise", "userFacts", "beaconParameters", "locale", "splitLocale", "_c", "assetsProvider", "entries", "setPrototypeOf", "isFrozen", "getPrototypeOf", "getOwnPropertyDescriptor", "Object", "freeze", "seal", "create", "apply", "construct", "Reflect", "x", "fun", "thisValue", "args", "Func", "arrayForEach", "unapply", "Array", "prototype", "forEach", "arrayLastIndexOf", "lastIndexOf", "arrayPop", "pop", "arrayPush", "push", "arraySplice", "splice", "stringToLowerCase", "String", "toLowerCase", "stringToString", "toString", "stringMatch", "match", "stringReplace", "replace", "stringIndexOf", "indexOf", "stringTrim", "trim", "objectHasOwnProperty", "hasOwnProperty", "regExpTest", "RegExp", "test", "typeErrorCreate", "unconstruct", "TypeError", "func", "thisArg", "lastIndex", "_len", "arguments", "length", "_key", "_len2", "_key2", "addToSet", "set", "array", "transformCaseFunc", "l", "element", "lcElement", "cleanArray", "index", "clone", "object", "newObject", "property", "value", "isArray", "constructor", "lookupGetter", "prop", "desc", "get", "fallbackValue", "html", "svg", "svgFilters", "svgDisallowed", "mathMl", "mathMlDisallowed", "text", "xml", "MUSTACHE_EXPR", "ERB_EXPR", "TMPLIT_EXPR", "DATA_ATTR", "ARIA_ATTR", "IS_ALLOWED_URI", "IS_SCRIPT_OR_DATA", "ATTR_WHITESPACE", "DOCTYPE_NAME", "CUSTOM_ELEMENT", "NODE_TYPE", "attribute", "cdataSection", "entityReference", "entityNode", "progressingInstruction", "comment", "document", "documentType", "documentFragment", "notation", "getGlobal", "window", "_createTrustedTypesPolicy", "trustedTypes", "purifyHostElement", "createPolicy", "suffix", "ATTR_NAME", "hasAttribute", "getAttribute", "policyName", "createHTML", "createScriptURL", "scriptUrl", "_", "console", "warn", "_createHooksMap", "afterSanitizeAttributes", "afterSanitizeElements", "afterSanitizeShadowDOM", "beforeSanitizeAttributes", "beforeSanitizeElements", "beforeSanitizeShadowDOM", "uponSanitizeAttribute", "uponSanitizeElement", "uponSanitizeShadowNode", "createDOMPurify", "undefined", "DOMPurify", "root", "version", "VERSION", "removed", "nodeType", "Element", "isSupported", "originalDocument", "currentScript", "DocumentFragment", "HTMLTemplateElement", "Node", "NodeFilter", "NamedNodeMap", "MozNamedAttrMap", "HTMLFormElement", "DOMParser", "ElementPrototype", "cloneNode", "remove", "getNextSibling", "getChildNodes", "getParentNode", "template", "createElement", "content", "ownerDocument", "trustedTypesPolicy", "emptyHTML", "implementation", "createNodeIterator", "createDocumentFragment", "getElementsByTagName", "importNode", "hooks", "createHTMLDocument", "EXPRESSIONS", "ALLOWED_TAGS", "DEFAULT_ALLOWED_TAGS", "TAGS", "ALLOWED_ATTR", "DEFAULT_ALLOWED_ATTR", "ATTRS", "CUSTOM_ELEMENT_HANDLING", "tagNameCheck", "writable", "configurable", "enumerable", "attributeNameCheck", "allowCustomizedBuiltInElements", "FORBID_TAGS", "FORBID_ATTR", "ALLOW_ARIA_ATTR", "ALLOW_DATA_ATTR", "ALLOW_UNKNOWN_PROTOCOLS", "ALLOW_SELF_CLOSE_IN_ATTR", "SAFE_FOR_TEMPLATES", "SAFE_FOR_XML", "WHOLE_DOCUMENT", "SET_CONFIG", "FORCE_BODY", "RETURN_DOM", "RETURN_DOM_FRAGMENT", "RETURN_TRUSTED_TYPE", "SANITIZE_DOM", "SANITIZE_NAMED_PROPS", "SANITIZE_NAMED_PROPS_PREFIX", "KEEP_CONTENT", "IN_PLACE", "USE_PROFILES", "FORBID_CONTENTS", "DEFAULT_FORBID_CONTENTS", "DATA_URI_TAGS", "DEFAULT_DATA_URI_TAGS", "URI_SAFE_ATTRIBUTES", "DEFAULT_URI_SAFE_ATTRIBUTES", "MATHML_NAMESPACE", "SVG_NAMESPACE", "HTML_NAMESPACE", "NAMESPACE", "IS_EMPTY_INPUT", "ALLOWED_NAMESPACES", "DEFAULT_ALLOWED_NAMESPACES", "MATHML_TEXT_INTEGRATION_POINTS", "HTML_INTEGRATION_POINTS", "COMMON_SVG_AND_HTML_ELEMENTS", "PARSER_MEDIA_TYPE", "SUPPORTED_PARSER_MEDIA_TYPES", "DEFAULT_PARSER_MEDIA_TYPE", "CONFIG", "formElement", "isRegexOrFunction", "testValue", "Function", "_parseConfig", "cfg", "ADD_URI_SAFE_ATTR", "ADD_DATA_URI_TAGS", "ALLOWED_URI_REGEXP", "ADD_TAGS", "ADD_ATTR", "table", "tbody", "TRUSTED_TYPES_POLICY", "ALL_SVG_TAGS", "ALL_MATHML_TAGS", "_checkValidNamespace", "parent", "tagName", "namespaceURI", "parentTagName", "Boolean", "_forceRemove", "node", "removeChild", "_removeAttribute", "name", "getAttributeNode", "from", "removeAttribute", "setAttribute", "_initDocument", "dirty", "doc", "leadingWhitespace", "matches", "dirtyPayload", "parseFromString", "documentElement", "createDocument", "innerHTML", "body", "insertBefore", "createTextNode", "childNodes", "call", "_createNodeIterator", "SHOW_ELEMENT", "SHOW_COMMENT", "SHOW_TEXT", "SHOW_PROCESSING_INSTRUCTION", "SHOW_CDATA_SECTION", "_isClobbered", "nodeName", "textContent", "attributes", "hasChildNodes", "_isNode", "_executeHooks", "currentNode", "data", "hook", "_sanitizeElements", "allowedTags", "firstElementChild", "_isBasicCustomElement", "parentNode", "childCount", "i", "childClone", "__removalCount", "expr", "_isValidAttribute", "lcTag", "lcName", "_sanitizeAttributes", "hookEvent", "attrName", "attrValue", "keepAttr", "allowedAttributes", "forceKeepAttr", "attr", "initValue", "getAttributeType", "setAttributeNS", "_sanitizeShadowDOM", "fragment", "shadowNode", "shadowIterator", "nextNode", "sanitize", "importedNode", "returnNode", "appendChild", "firstChild", "nodeIterator", "shadowroot", "shadowrootmode", "serializedHTML", "outerHTML", "doctype", "setConfig", "clearConfig", "isValidAttribute", "tag", "addHook", "entryPoint", "hookFunction", "removeHook", "removeHooks", "removeAllHooks", "purify", "ofbTrustedTypeInstance", "domUtilsTrustedTypePolicy", "_a", "scriptUrlString", "scriptUrl", "trustedOrigins", "get", "currentOrigin", "getUrlDomain", "scriptOrigin", "getLogger", "EventIds", "htmlString", "sanitizeHtmlString", "purify", "sanitizeOutputString", "inputString", "url", "loadScript", "url", "pageOrigin", "resolve", "reject", "script", "_b", "_a", "domUtilsTrustedTypePolicy", "entry", "getFirstCalendarDateOfWeek", "input", "inputDate", "day", "getWeeklyDateStamp", "firstDateOfweek", "getWebSurfacesLink", "timeStampDate", "internalEnvs", "commonInitOptions", "get", "audience", "_a", "_b", "isInternalEnv", "webSurfacesConfigLink", "_c", "_d", "webSurfacesDefaultLink", "DynamicScriptUrls", "webSurfacesLink", "getDynamicSetting", "weekDateStamp", "WebSurfacesScriptPromise", "createwebSurfacesScriptPromise", "loadScript", "GenericMessagingLauncherFactory", "_GenericMessagingLauncherFactory", "survey", "CoachingUXLauncher", "isNOU", "surveyParams", "surveyInfo", "surveyMetadata", "treatmentType", "contentMetadata", "startTime", "getWebSurfacesInstance", "windowInstance", "getGlobal", "renderWebSurface", "uxInitOptions", "officeWebSurfaces", "surfaceParams", "logErrorEvent", "error", "getLogger", "EventIds", "initOptions", "floodgateInitOptions", "surveyActivatedCallback", "beaconCallback", "beaconParameters", "uxOptions", "import_floodgate_shared_typings", "import_officefloodgatecore", "import_officefloodgatecore", "RequestVerb", "BackendTarget", "setElementVisibility", "id", "vis", "oldClassName", "Classes", "newClassName", "replaceClassesById", "deleteElementById", "element", "addClassById", "newClass", "deleteClassById", "oldClass", "addEventListenerHelper", "object", "type", "listener", "removeEventListenerHelper", "registerListener", "id", "element", "registerListenerToElement", "unregisterListener", "isRightToLeft", "getOrCreateDiv", "divId", "appendToBody", "appendAsFirstChild", "divElement", "Tags", "import_floodgate_shared_typings", "CentroCoreDataSource", "_CentroCoreDataSource", "complianceChecks", "AuthenticationType", "_b", "_a", "get", "AgeGroup", "_d", "_c", "ocpsEnumToString", "_e", "ocpsBooleanToString", "_f", "_g", "_h", "SDK_VERSION_PREFIX", "Version_default", "convertAutoDismissToTimeInMs", "listener", "index", "onClose", "submitted", "errorMessage", "centroDataOptions", "LogKind", "LogCategory", "PerfMarkerPrefix", "isError", "option", "LogKind", "isAnalytics", "isPerformance", "isFramework", "option", "LogKind", "isFlight", "registeredLoggers", "addLogger", "name", "loggerObj", "broadcastLogger", "options", "broadCastTo", "registeredLoggers", "broadCastTo", "options", "loggers", "loggerObj", "name", "error", "restLoggers", "LogKind", "LogCategory", "log", "broadcastLogger", "decorateElement", "element", "attributes", "attr", "loadScriptUrl", "leaf", "sourceDOM", "trustedTypePolicy", "__awaiter", "_this", "__generator", "_a", "resolve", "reject", "attemptToLoadScript", "retry", "scriptElement", "scriptUrl", "log", "LogKind", "response", "contentTypeHeader", "requestIdHeader", "cdnProviderHeader", "err_1", "loadScript", "inlineScript", "loadStyleUrl", "linkElement", "loadStyle", "inlineStyle", "dynamicLoader", "node", "targetHtmlElementDom", "err_2", "_b", "_c", "script", "e_1_1", "err_3", "e_1", "_d", "_e", "n", "__values", "SupportedHostingApps", "RuntimeDataSources", "history", "getHistory", "history", "scrubMessage", "message", "scrubbedMessage", "_a", "LogLevel", "UnifiedFlightTagID", "loggingQueueLocked", "makeMacKustoLogger", "appIdStr", "kustoEndpointStr", "hostNameStr", "versionInfoStr", "loggingQueueInterval", "queue", "xhrPromise", "remoteLoggerSequenceNumber", "appId", "kustoEndpoint", "hostName", "versionInfo", "isNextSendLogScheduled", "scheduleNextSend", "sendInstrumentRequest", "resolve", "reject", "req", "err", "data", "queueLog", "flush", "__awaiter", "__generator", "_a", "macKustoLogger", "options", "isAnalytics", "isPerformance", "isFramework", "pathName", "flyoutName", "getHistory", "pathArray", "error", "isFlight", "LogCategory", "scrubMessage", "tagId", "isError", "stack", "unlockLoggingQueue", "createUUID", "c", "createTrustedTypesPolicy", "policyName", "_a", "ttWindow", "trustedTypePolicy", "validCdnUrls", "url", "parseUrl", "error", "hvcTrustedTypePolicy", "createTrustedTypesPolicy", "globalWindow", "assert", "condition", "message", "error", "log", "LogKind", "getFeatureLoadingState", "featureName", "getDbgState", "_a", "_b", "centroConfigUrl", "centroBaseUrl", "uxVersionData", "loaderInitialized", "loggersInitialized", "uxVersionDebugData", "enableQueryParam", "consumerAdapters", "instanceVersionInfo", "consumerPreConfig", "normalizeCasingForUxVersionData", "mixedCaseUxVersionData", "hvcProp", "addQueryParam", "versionUrl", "param", "value", "url", "getUxVersionData", "queryParams", "useCentroConfig", "vectors", "enableSubFeatures", "__awaiter", "__generator", "__read", "key", "resolve", "reject", "req", "correlationId", "errorMsg", "err", "getUxVersionDebugData", "_c", "getApplicableFeaturesFromUxData", "subFeatures", "e_1", "e_2", "res", "uxData", "subFeatures_1", "__values", "subFeatures_1_1", "currSubFeature", "_d", "_e", "feature", "featureData", "__spreadArray", "e_2_1", "e_1_1", "initialize", "params", "baseUrl", "preConfig", "enableUxVersionQueryParam", "targetHtmlElement", "appId", "hostName", "applicableFeatures", "versionInfo", "kustoEndpoint", "hvcLoaderInitializeStartTime", "queryParam", "uxDataFromAPI", "error_1", "createUUID", "addLogger", "makeMacKustoLogger", "unlockLoggingQueue", "preloadFeature", "preloadFeatureStartTime", "lowerCaseFeatureName", "staticAdditionalObjects", "foreignEnvMainVersion", "error_2", "dynamicLoader", "bootstrapFeature", "bootStrapFeatureStartTime", "loaderData", "bootstrapper", "error_3", "error_4", "createStaticDataSource", "config", "emptyDataSource", "createStaticDataSource", "AdapterProvider", "AdapterType", "CentroLoaderWrapper", "bootstrapFeature", "createStaticDataSource", "initialize", "preloadFeature", "NONFLOODGATE_SPECIFIC_CENTRO_EVENT_SAMPLING_RATE", "centroLogging", "options", "isFlight", "configuration", "get", "data", "id", "rest", "__rest", "persistData", "_a", "scrubCentroUrlData", "isNumericString", "getLogger", "convertCentroLogType", "error", "EventIds", "message", "isError", "value", "valueIsNumeric", "CentroThemeDataSource", "_CentroThemeDataSource", "get", "listener", "index", "updatedstate", "DynamicUxClient", "surveyContainer", "get", "getOrCreateDiv", "CentroFloodgateContainerId", "config", "getLogger", "EventIds", "timeBefore", "waitingTime", "callback", "survey", "error", "preConfig", "CentroFloodgateHostName", "CentroFloodgatePerfPrefix", "centroLogging", "centroParams", "CentroUrlProd", "FloodgateCentroVersion", "CentroLoaderWrapper", "dataSources", "sd", "CentroCommonInitOptions", "CentroFloodgateInitOptions", "CentroCoreDataSource", "CentroThemeInitOptions", "CentroThemeDataSource", "centroAdapters", "reqOpt", "CentroPetrolUploadEndpoint", "BackendTarget", "CentroFloodgateFeatureName", "serviceCallTime", "dynamicUxClient", "setup", "import_floodgate_shared_typings", "UISurvey", "survey", "interceptComponent", "promptComponent", "commentComponent", "ratingComponent", "cvSurveyComponent", "customerVoiceLauncherType", "selectedIndex", "comment", "isNOU", "RudeSurveyLauncherFactory", "survey", "RudeSurveyLauncher", "get", "UISurvey", "error", "getLogger", "EventIds", "isNOU", "AdaptiveSurveyLauncherFactory", "_AdaptiveSurveyLauncherFactory", "rudeSurveyLauncherFactory", "genericMessagingLauncherFactory", "RudeSurveyLauncherFactory", "GenericMessagingLauncherFactory", "survey", "get", "FloodgateEnvironmentProvider", "get", "uIStrings", "setUIStrings", "data", "getUIStrings", "FloodgateStringProvider", "stringId", "uiStrings", "getUIStrings", "str", "get", "HTTP_TIMEOUT", "makeHttpRequest", "method", "url", "requestBody", "maxRetries", "onLoad", "makeRequest", "retries", "timeout", "resolve", "reject", "xhr", "httpTimeout", "get", "uploadEndpointInt", "uploadEndpointProd", "send", "isProduction", "manifest", "screenshot", "diagnostics", "formData", "Screenshot", "screenshot", "imgString", "e", "getLogger", "EventIds", "blobBin", "array", "i", "Manifest", "manifestType", "appId", "submitTime", "type", "clientFeedbackId", "applicationGroup", "telemetryGroup", "webGroup", "retentionDurationDays", "sanitizeType", "SDK_VERSION_PREFIX", "get", "Version_default", "comment", "email", "category", "appData", "extendedManifestData", "authenticationType", "ageGroup", "sendFeedbackPolicyValue", "sendSurveyPolicyValue", "screenshotPolicyValue", "emailPolicyValue", "values", "field", "overrideValues", "UxId", "isNOU", "isString", "FeedbackType", "Transporter", "environment", "manifestType", "appId", "type", "applicationGroup", "telemetryGroup", "webGroup", "guid", "Manifest", "get", "AuthenticationType", "_b", "_a", "AgeGroup", "_d", "_c", "ocpsEnumToString", "_e", "ocpsBooleanToString", "_f", "_g", "_h", "comment", "email", "category", "appData", "extendedManifestData", "screenshot", "Screenshot", "clientFeedbackId", "UxId", "values", "getLogger", "EventIds", "manifestContent", "screenshotContent", "send", "err", "TransporterFactory", "surveyType", "Transporter", "get", "import_CampaignDefinitionProvider", "TargetedMessagingCampaignDefinitionProvider", "requestStartTime", "campaignDefinitionsPromise", "get", "response", "timeoutMilliseconds", "getDynamicSetting", "TMS_CAMPAIGN_LOAD_TIMEOUT", "timeoutPromise", "createTimeoutPromise", "resolve", "reject", "error", "requestTimeElapsed", "getLogger", "EventIds", "definitions", "getBrowserSettings", "documentElement", "browserSettings", "error", "getCustomSettings", "userConsentGroup", "feedbackEnabledByAADC", "customSettings", "getBrowserLocalFact", "userFactName", "factNameValues", "userFact", "objectName", "propertyName", "createUserFact", "globalObject", "prev", "curr", "targetObject", "factName", "factValue", "loweCaseFactName_1", "caseInsensitiveKey", "key", "isNOU", "isArray", "isObject", "isFunction", "currentDateTime", "localFactTargetObjects", "getLocalUserFact", "commonInitOptions", "configuration", "generatedFact", "getLogger", "getErrorMessage", "UserFactsProvider", "userFactsPromise", "get", "userFacts", "timeoutMilliseconds", "getDynamicSetting", "TULIPS_LOAD_TIMEOUT", "createTimeoutPromise", "getCachedUserFacts", "userFactName", "userFact", "getLocalUserFact", "response", "tulipsIngestionTimeInterval", "TULIPS_INGESTION_TIME", "userFactProperties", "nowDate", "isExpired", "rawItemDate", "itemDate", "factInfo", "error", "getLogger", "EventIds", "initialized", "startCount", "dynamicCampaignDataProvider", "engine", "engineStartPromise", "engineTmsProvider", "userFactsProvider", "stringProvider", "storageProvider", "initialize", "FloodgateStorageProvider", "get", "floodgateInitOptions", "filteredResult", "configuration", "SurveyActivityListener", "setFloodgateCoreFGProvider", "setInitialized", "telemetryLogger", "initValue", "getInitialized", "setEngineStartPromise", "startPromise", "startInternal", "loadSynchronously", "customEngine", "startCount", "rejectAndLogError", "reject", "errorMessage", "error", "internalSampleRate", "telemetryLogger", "initialized", "resolve", "engineStartPromise", "startPromise", "commonInitOptions", "get", "campaignDefinitionProviders", "floodgateInitOptions", "logTelemetryEvent", "eventName", "properties", "engineTmsProvider", "TargetedMessagingCampaignDefinitionProvider", "userFactsProvider", "UserFactsProvider", "_a", "_b", "dynamicCampaignDataProvider", "currentTeachingCooldown", "teachingCooldown", "getDynamicSetting", "floodgateEngineConfig", "_c", "_d", "_e", "_f", "engine", "AdaptiveSurveyLauncherFactory", "getStorageProvider", "stringProvider", "FloodgateStringProvider", "FloodgateEnvironmentProvider", "TransporterFactory", "setEngineStartPromise", "enginePromise", "startError", "e", "start", "stop", "getEngine", "getStorageProvider", "storageProvider", "FloodgateStorageProvider", "updateThemeInternal", "themeConfig", "get", "CentroThemeDataSource", "error", "setFloodgateGetEngine", "getEngine", "setFloodgateStart", "start", "setFloodgateStop", "stop", "setStorageProvider", "setFloodgateUpdateTheme", "processTelemetryEvent", "telemetryEvent", "sendUserFact", "userFactName", "processUserFactEvent", "defaultPrimaryColour", "defaultSecondaryColour", "initialize", "primaryColour", "secondaryColour", "sheet", "Classes", "IDs", "initialized", "setUIStrings", "data", "initialize", "resolve", "reject", "initOptionsCommon", "get", "CustomResources", "getLogger", "EventIds", "getUIStrings", "intlFileUrl", "loadScript", "err", "setProcessTelemetryEvent", "processTelemetryEvent", "setSendUserFact", "sendUserFact", "setSetUiStrings", "setUIStrings", "isFloodgate2", "isUxSchemaPresent", "isDynamicUXEnabled", "_c", "_b", "_a", "get", "dynamicUXClientState", "_d", "DynamicUxClient_exports", "IFloodgateTelemetryLogger", "campaignId", "surveyId", "surveyType", "surveyActivityInfo", "additionalSurveyInfo", "treatmentType", "isUxSchemaPresent", "getLogger", "EventIds", "isFloodgate2", "errorMessage", "eventId", "event", "properties", "internalSampleRate", "message", "data", "logSeverity", "others", "CustomUISurvey", "survey", "isBoolean", "ratingIndex", "comment", "result", "isNOU", "index", "import_floodgate_shared_typings", "DummySurvey", "selectedIndex", "comment", "isInteger", "result", "import_Utils", "import_floodgate_shared_typings", "import_gatecrash", "onDismiss", "onDismissFlag", "isPromptResponseLogValidated", "isAdditionalPromptResponseLogValidated", "hasSubmittedData", "SurveyUIFormSecondarySubmitName", "SurveyUIFormUserClosedName", "firstCommentResponse", "firstCommentTitle", "createCVSurvey", "contextParams", "onClose", "cvSurveyOptionalConfigParams", "overrideUXRenderCallbackAsync", "submitted", "get", "logCustomProps", "internal", "EventIds", "ex", "renderContext", "IDs", "handleSurveyEvent", "key", "data", "keyPrefix", "keyBase", "err", "splitKey", "onCVSubmit", "onCVCancel", "onCVLoaded", "logGatecrashEvent", "getRating", "values", "getQuestionValue", "getAnswerValue", "getInsightfulOptions", "getInsightfulAnswers", "formatSubmitData", "submitData", "rating", "commentsCollection", "email", "ratingQuestion", "ratingsListLength", "promptQuestion", "promptResponse", "commentTitlesCollection", "additionalPromptQuestion", "additionalPromptResponse", "insightfulQuestionOptionsCollection", "insightfulQuestionAnswersCollection", "isFirstCommentValidated", "isFirstEmptyCommentAdded", "_a", "currentPage", "commentResponse", "commentTitle", "cvSurveyHasPromptPage", "setCommentTitleAndValue", "updateExtendedManifestData", "transporter", "formattedData", "commentValues", "commentTitles", "extendedManifestData", "updateAppData", "appData", "appDataValues", "cvSurveyInfo", "customerVoiceSurveyUX", "logTelemetryEvent", "setTransporterValues", "preGeneratedId", "validateLogPromptAnswer", "Transporter", "comment", "isPromptAnswerLogNeeded", "isPromptAnswerNo", "LogPromptAnswer", "PromptConstants", "questionType", "isPromptAnswerLogged", "promptMessageClicked", "promptMessageClosed", "configuration", "_b", "_c", "_d", "eventId", "customProperties", "getLogger", "updateSurveyStyling", "cssVars", "htmlDataAttrs", "unitTestExports", "import_floodgate_shared_typings", "animationSpeed", "numCircles", "offsetSize", "parentSize", "fadeIncrement", "Spinner", "id", "setElementVisibility", "i", "fade", "angle", "offset", "step", "circleObject", "radius", "circle", "createCircle", "x", "y", "j", "opacity", "setOpacity", "getOpacity", "element", "Classes", "isNOU", "Utils_exports", "onDismiss", "isPromptUp", "timerAutoDismiss", "autoDismissValue", "dismissAll", "submitted", "unregister", "removeListeners", "listenersList", "addListener", "id", "event", "listener", "registerListener", "unregisterListener", "logTelemetryEvent", "eventId", "clientFeedbackId", "isEmailPolicyEnabled", "action", "PersonalizerEventId", "actualSetAutoDismissValue", "configuration", "get", "getLogger", "register", "ON_DISMISS", "IDs", "toastKeyEventHandler", "toastCancelHandler", "promptContainerHandler", "submitButtonHandler", "emailCheckBoxHandler", "ratingElements", "i", "registerListenerToElement", "ratingInputHandler", "isIntercept", "autoDismiss", "isPersonalizerEnabled", "isPersonalizerEnabledHelper", "overrideValue", "showSurveyScreen", "EventIds", "autoDismissDuration", "convertAutoDismissToTimeInMs", "emailCheckBox", "emailTextBox", "Keys", "onCancelLoggingRoutine", "clearAutoDismiss", "interceptHandler", "success", "openInNewTab", "url", "win", "setElementVisibility", "addClassById", "Classes", "formRating", "spinner", "Spinner", "transporter", "Transporter", "commentElement", "commentEntered", "selectedRating", "sanitizeOutputString", "SDK_UXID_VERSION", "import_floodgate_shared_typings", "isNOU", "Utils_exports", "generateRadioGroup", "id", "question", "choices", "fieldSet", "Tags", "Classes", "IDs", "AttributeName", "choice", "generateRadioButton", "value", "label", "AttributeValue", "generate", "AttributeName", "AttributeValue", "get", "generatePrompt", "getUIStrings", "IDs", "Tags", "generateForm", "Classes", "isRightToLeft", "isIntercept", "eudbCompliant", "generateFormEudbCompliant", "generateFormEudbNonCompliant", "generateFormContainerLabel", "generateRatingControl", "privacyLabelHelper", "choices", "ratingValues", "index", "ratingValue", "generateRadioGroup", "_a", "isTenantIdCommercial", "label", "elementFromJson", "schema", "svg", "Tags", "element", "attribute", "i", "AttributeName", "concatClasses", "_b", "_a", "domUtilsTrustedTypePolicy", "sanitizeHtmlString", "cur", "child", "createSurvey", "onClose", "dxEnabled", "get", "getLogger", "EventIds", "_a", "_b", "_c", "_d", "CentroCoreDataSource", "error", "create", "elementFromJson", "generate", "register", "submitted", "setElementVisibility", "IDs", "deleteElementById", "userInterface", "surveyContainer", "surveyContainerElement", "getOrCreateDiv", "opened", "initialize", "resolve", "reject", "rejectAndLogError", "errorMessage", "telemetryLogger", "getInitialized", "err", "IFloodgateTelemetryLogger", "initializeDynamicUx", "get", "setup", "getLogger", "EventIds", "showSurvey", "survey", "overrideUXRenderCallbackAsync", "dynamicUxClient", "status", "showSurveyPromise", "error", "dynamicUxStatus", "DummySurvey", "customerVoiceLauncherType", "contextParams", "getContextParams", "optionalConfigParams", "getOptionalConfigParams", "renderContext", "createCVSurvey", "createSurvey", "urlParams", "showFormSurvey", "genericSurvey", "formattedSurvey", "UISurvey", "showCustomSurvey", "CustomUISurvey", "renderSurvey", "parentElement", "onSurveyEvent", "surveyOptionalConfigParams", "isMainContext", "getSettingIdMap", "setFloodgateCustomUXHandler", "renderSurvey", "handleSurveyEvent", "updateSurveyStyling", "setFloodgateShowSurvey", "showSurvey", "setFloodgateShowFormSurvey", "showFormSurvey", "setFloodgateShowCustomSurvey", "showCustomSurvey", "setFloodgateInitialize", "initialize", "makeFloodgate", "get", "APP_CONSTANTS", "ENV_CONFIG", "getEnvironmentConfig", "envType", "isProduction", "OCVStateLocalStorageKeys", "FLOODGATE_ACTIVITIES", "clearOCVStateStorage", "key", "error", "isTestingMode", "APP_CONSTANTS", "AppUsageTimeout", "OCV_CLEAR_DELAY", "loadAndInitialize", "userDetails", "_a", "officeBrowserFeedback", "makeFloodgate", "telemetrySinkProvider", "TelemetrySinkProvider", "envConfig", "getEnvironmentConfig", "locale", "APP_CONSTANTS", "sessionId", "c", "error", "isProduction", "dynamicCampaignExtension", "floodgateDynamicCampaignConfig", "dynamicCampaignFilters", "key", "value", "EcsClient_default", "e", "onSurveyActivated", "launcher", "survey", "campaignId", "submitted", "isTestingMode", "clearOCVStateStorage", "global_variables", "FloodgateContext", "FloodgateProvider", "children", "officeBrowserFeedback", "setOfficeBrowserFeedback", "loading", "setLoading", "error", "setError", "isInitialized", "setIsInitialized", "start", "err", "stop", "isTestingMode", "clearOCVStateStorage", "global_variables", "userDetails", "obfObject", "loadAndInitialize", "OCV_CLEAR_DELAY", "errorMessage", "handleFocus", "handleBlur", "appUsageTimer", "AppUsageTimeout", "handleVisibilityChange", "contextValue", "activity", "React", "useFloodgate", "context", "import_react", "FloodgateTrigger", "logActivity", "isInitialized", "useFloodgate", "hasTriggeredSurvey", "setHasTriggeredSurvey", "_a", "isProduction", "global_variables", "_b", "FLOODGATE_ACTIVITIES", "error", "App", "React", "FluentProvider", "webLightTheme", "FloodgateProvider", "FloodgateTrigger", "App_default", "initializeApp", "_a", "global_variables", "target", "APP_CONSTANTS", "ReactDOM", "React", "App_default", "isProduction", "error"]
}
